===============================================================

Tag name: cam5_3_36
Originator(s): cacraig, goldy
Date: May 5, 2014
One-line Summary: Bug fixes to subcolumns

Purpose of changes: Bug fixes and cleanup for subcolumns

Bugs fixed (include bugzilla ID):1952 (incorrect allocation of state_sc)

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/physics/cam/subcol_utils.F90
M       models/atm/cam/src/physics/cam/subcol_utils.F90.in
         - Changed all state intents to in from inout
         - Allocation of state_sc was incorrect and decided it should be an endrun instead
          
M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
         - Bug in setting of dimsizes(:) and then overwriting dimsizes(1) when threading
           in pbuf1d_field_by_index.  Corrected to set only dimsizes(2:).
         - Cleanup of logic when using optional start/count in get_pbuf1d_field_by_index
         - Corrected spelling of persistence

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All BFB

goldbach/nag: All BFB

goldbach/pgi or jaguar/pgi: All BFB

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_35
Originator(s): fvitt, tilmes
Date: 02 May 2014
One-line Summary: Improve performance of satellite history output
 and bug fix in modal aerosol surface area routine

Purpose of changes:

 - It has been observed that CAM's run-time performance is degraded
   when satellite history output is turned on, especially when running
   on higher resolution grids.  The sat_hist_write method was spending
   the bulk of its time doing a "find nearest neighbor" operation to
   determine the nearest column(s) to output.  Each PE was searching the
   entire global grid (both dynamics grid and physics grid). Modifications
   here parallelizes the find nearest neighbor operation and performance
   is greatly improved.

 - Fix a bug in modal aerosol surface area routine used for heterogeneous
   chemistry reactions.

 - Build-namelist use case changes to be consistent with 1.2.2 release.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M   models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_strat_soa.xml
M   models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam3.xml
M   models/atm/cam/bld/namelist_files/use_cases/sd_cam4_trop_strat_soa.xml
M   models/atm/cam/bld/namelist_files/use_cases/sd_cam5_trop_strat_mam3.xml
Changes to be consistent with 1.2.2 release

M   models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
The use of dgnumwet in MODAL version of surfarea needs to be converted from "m" to "cm"

M   models/atm/cam/src/control/sat_hist.F90
M   models/atm/cam/src/dynamics/sld/dyn_grid.F90
M   models/atm/cam/src/dynamics/eul/dyn_grid.F90
M   models/atm/cam/src/dynamics/se/dyn_grid.F90
M   models/atm/cam/src/dynamics/fv/dyn_grid.F90
Improve performance of sat_hist

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
060 bl430 TBL.sh fm1.9c5dh outfrq3s_NEUwetdep 9s ..........................FAIL! rc= 7 at Thu May  1 19:07:34 MDT 2014
 - expected failure due to the bug fix in surfarea

goldbach/nag: all pass

goldbach/pgi: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_34
Originator(s): cacraig, eaton, gettelman 
Date: April 25, 2014
One-line Summary: Fix broken COSP, namelist defaults, ideal physics, PGI on hopper, micro_mg_cam

Purpose of changes:

- COSP had include files with .f instead of .inc.  Use the new COSP external to allow CESM to compile it
 
- CAM standalone whn running SE ne16np4 was broken - updated namelist defaults to fix problem

- ideal physics with threading was broken.  Eliminated ptend as a thread private variable and made
  it an array with a chunk index

- Fixed PGI compilation on hopper

- Andrew provided a bug fix for micro_mg_cam for vprao, vprco, and racau

Bugs fixed (include bugzilla ID): 1894

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/configure
          - fix PGI compilation on hopper

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
          - fix namelist defaults for CAM SE ne16np4 in CAM standalone

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
          - use updated COSP build which allows CESM to compile it directly with their new mods

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
          - Changes from Andrew for vprco, vprao and racau

M       models/atm/cam/src/physics/cam/physpkg.F90
          - Fix for running ideal physics using threading


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB

goldbach/nag: all BFB

goldbach/pgi or jaguar/pgi: all BFB

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_33
Originator(s): fvitt
Date: 22 Apr 2014
One-line Summary: Chemistry bug fixes and use case changes

Purpose of changes:
 Correction to aerosol surface area used in heterogeneous chemical
 reactions, O1D+O2 reaction rate update, and updates to build-namelist
 use cases

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

A     models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp45_bgc.xml
A     models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85_bgc.xml
A     models/atm/cam/bld/namelist_files/use_cases/sd_cam4_trop_strat_soa.xml
A     models/atm/cam/bld/namelist_files/use_cases/sd_cam5_trop_strat_mam3.xml
 - new build-namelist use cases

List all existing files that have been modified, and describe the changes:

M     models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_strat_soa.xml
M     models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam3.xml
 - updates to build-namelist use cases

M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.in
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.in
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mech.in
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.in
M     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_soa/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_soa/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_strat_soa/chem_mech.in
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.in
 - corrected rate constants for O1D + O2 reaction
 - added SO4 to external forcing list

M     models/atm/cam/src/chemistry/modal_aero/aero_model.F90
M     models/atm/cam/src/chemistry/bulk_aero/aero_model.F90
M     models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - correction to aerosol surface area used in heterogeneous chemical
   reactions when using prognostic modal aerosols


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
051 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Tue Apr 22 10:44:29 MDT 2014
055 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Tue Apr 22 10:53:13 MDT 2014
060 bl430 TBL.sh fm1.9c5dh outfrq3s_NEUwetdep 9s ..........................FAIL! rc= 7 at Tue Apr 22 11:10:20 MDT 2014
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s+soa_chem_megan_emis 9s ..............FAIL! rc= 7 at Tue Apr 22 11:27:14 MDT 2014
 - these failures are expected due to changes in O1D+O2 reaction rate and
   changes to aerosol surface area used in heterogeneous chemical reactions

goldbach/nag: All Pass

goldbach/pgi: All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_32
Originator(s): olson, cacraig
Date: 4/18/14
One-line Summary: Bug fixes for bugzilla 1958

Purpose of changes: Fix computation of the diagnostic term "DTCORE" - total dynamics T-tendency

Bugs fixed (include bugzilla ID): 1958

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton, olson

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/physics/cam/check_energy.F90
M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
         - bug fix for DTCORE


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: 
036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Thu Apr 17 20:45:09 MDT 2014
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Thu Apr 17 22:40:06 MDT 2014
      Failed due to differences with DTCORE.  Jerry Olson approved the new numbers

goldbach/nag: all BFB

goldbach/pgi or jaguar/pgi: all BFB

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_31
Originator(s): santos, Marcus Wagner, cacraig 
Date: 04/14/2014
One-line Summary: Bug fixes for bugzilla 1954 and 1919

Purpose of changes:
- Fix write outside array bounds in pilgrim code (1919)
- Fix lon-lat history file from multi-instance CAM-SE (1954)

Bugs fixed (include bugzilla ID): 1919 and 1954

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by:

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/utils/pilgrim/parutilitiesmodule.F90
         - bug fix from Marcus Wagner for bugzilla 1919 (write outside array bounds in pilgrim code)

M       models/atm/cam/src/dynamics/se/interp_mod.F90
         - bug fix from Sean Santos for bugzilla 1954 (lon-lat history file from multi-instance CAM-SE: bug and fix)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS

goldbach/nag: All PASS

goldbach/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_3_30
Originator(s): cacraig, eaton
Date: 04/04/2014
One-line Summary: Changed compiler settings to match CESM to fix failing TEQ test

Purpose of changes:
- Fix failing TEQ test by changing compiler settings

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/test/system/test_driver.sh
        - Updated modules for yellowstone to match CESM modules

M       models/atm/cam/bld/Makefile.in
        - Updated compiler flags for yellowstone to match CESM modules
        - handful of routines have -O3 optimization

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS except:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Thu Apr  3 19:59:46 MDT 2014
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Thu Apr  3 21:19:13 MDT 2014
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Thu Apr  3 22:39:16 MDT 2014
- Answers changed due to modified compiler settings

goldbach/nag: All PASS

goldbach/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_3_29
Originator(s): cacraig
Date: 03/31/2014
One-line Summary: Update to cesm1_3beta08 externals 

Purpose of changes:
- Updated to cesm1_3beta08 externals
- Needed to update to CLM branch to eliminate some introduced bugs

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: 

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/test/system/test_driver.sh
          - need to "module load perlmods" for yellowstone

M       SVN_EXTERNAL_DIRECTORIES
          - updated to beta08 externals
	  - Needed to upgrade to CLM branch tag to correct several bugs discovered during CAM testing

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS except:
036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Fri Mar 28 14:04:13 MDT 2014
051 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Mar 28 14:56:53 MDT 2014
055 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Fri Mar 28 15:06:36 MDT 2014
058 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Fri Mar 28 15:14:36 MDT 2014
060 bl430 TBL.sh fm1.9c5dh outfrq3s_NEUwetdep 9s ..........................FAIL! rc= 7 at Fri Mar 28 15:24:34 MDT 2014
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s+soa_chem_megan_emis 9s ..............FAIL! rc= 7 at Fri Mar 28 15:42:57 MDT 2014
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Fri Mar 28 16:06:52 MDT 2014
  - Jobs with cam_chempkg='trop_mozart', 'waccm_mozart', 'super_fast_llnl', 'trop_mozart_mam3', 'trop_mozart_soa' all
    have answer changes due to CLM mods

088 eq993 TEQ_ccsm.sh ne30_ne30 FC5 h30c5h fcase 2d .......................FAIL! rc= 7 at Fri Mar 28 18:11:41 MDT 2014
  - Machines compiler updates on yellowstone cause answer changes.  Will change in next tag as may be answer changing to
    other tests as well.

goldbach/nag: All PASS except
001 fm001 TFM.sh ..........................................................FAIL! rc= 2 at Thu Mar 27 13:56:02 MDT 2014
Failed because checked out on yellowstone which is using an older svn repository.  Will check out next version on 
goldbach for this test.


goldbach/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_3_28
Originator(s): cacraig, goldy (with input from many others)
Date: 03/06/2014
One-line Summary: Routines to support sub-columns introduced and sub-columninzation of microphysics

Purpose of changes:

- Last checkin of initial subcolumn development work
- Introduces the subcolumn interface and utility routines
- microphysics is now subcolumnized
- when subcolumns are not specified, no changes

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton, plus numerous group reviews

List all subroutines eliminated: none
D       models/atm/cam/src/utils/grid_flag_utils.F90
         - Got rid of confusing bit_field_kind and its supporting routines as no longer needed
         - Moved col_type parameters to physics_buffer.F90
         - Removed obsolete module

List all subroutines added and what they do: none
A       models/atm/cam/test/system/config_files/f10c5t5mdmsc
A       models/atm/cam/test/system/nl_files/outfrq3s_subcol
         - Added regression testing for subcolumns

A  +    models/atm/cam/src/physics/cam/subcol.F90
         - interface layer for subcolumns
         - Has the ability to redirect subcolumn-scheme specific routines
         - public routines:
             subcol_register     ! Read scheme from namelist and initialize any scheme-global variables
             subcol_init         ! Initialize any variables or fields specific to the active scheme
             subcol_gen          ! Generate subcol fields from GBA fields
             subcol_field_avg    ! Average subcol fields back into GBA fields
             subcol_ptend_avg    ! Average sub-column ptend to grid ptend
             subcol_readnl       ! Namelist reader for subcolumns
             subcol_init_restart ! Initialize restart with subcolumn specific fields
             subcol_read_restart ! Read subcolumn specific fields from restart
             subcol_write_restart ! Write subcolumn specific fields for restart

A  +    models/atm/cam/src/physics/cam/subcol_utils.F90.in
A  +    models/atm/cam/src/physics/cam/subcol_utils.F90
         - Utilities layer for subcolumns
         - public routines:
             subcol_utils_init       ! Initialize module data (e.g., nsubcol2d)
             subcol_get_nsubcol      ! Copy chunk from nsubcol2d
             subcol_set_nsubcol      ! Copy chunk to nsubcol2d
             subcol_get_indcol       ! Copy chunk from indcol2d
             subcol_get_filter       ! return the filter values
             subcol_set_filter       ! set the filter values
             subcol_get_weight       ! return the weight values
             subcol_set_weight       ! set the weight values
             subcol_field_copy       ! copy a physics buffer field into one with subcolumn dimensions
             subcol_ptend_copy       ! copy a physics_ptend object into one with subcolumn dimensions
             subcol_set_subcols      ! set nsubcols and copy state & tend objects into one with subcolumn dimensions
             subcol_field_avg_shr    ! Average subcol fields back into GBA fields
             subcol_ptend_avg_shr    ! average subcolumn ptend to grid ptend
             subcol_field_get_firstsubcol  ! Retrieve the first subcolumn and assign to grid
             subcol_ptend_get_firstsubcol  ! retrieve the first subcolumn from the ptend fields and assign to grid ptend
             subcol_unpack           ! Unpack a subcolumn field
             subcol_pack             ! Pack a subcolumn field
             subcol_utils_init_restart     ! Initialize restart with subcolumn specific fields
             subcol_utils_read_restart     ! Read subcolumn specific fields from restart
             subcol_utils_write_restart    ! Write subcolumn specific fields for restart
             is_filter_set           ! True if filters for averaging have been set
             is_weight_set           ! True if weights for averaging have been set
             is_subcol_on            ! true is any subcol_scheme other than "off" is set
             subcol_get_scheme       ! Return the active subcolumn scheme name
             subcol_utils_readnl     ! Set the active scheme based on namelist

A  +    models/atm/cam/src/physics/cam/subcol_tstcp.F90
         - Testing module for subcolumns
         - Has more robust setting of random indices
         - Introduced on fly test of subcolumn indices

List all existing files that have been modified, and describe the changes:

 M      models/atm/cam
M       models/atm/cam/test/system/tests_pretag_goldbach_nag
M       models/atm/cam/test/system/input_tests_master
         - Added regression test for subcolumns

M       models/atm/cam/bld/configure
         - Added SILHS to configure for SILHS developer's ease

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
         - Moved microp_uniform initialized to false
         - Introduced a number of subcolumn namelist variables
         - Initialized subcol_scheme to "off"

M       models/atm/cam/bld/build-namelist
         - Introduced subcolumn namelist variables

M       models/atm/cam/src/control/runtime_opts.F90
         - Added subcol_readnl

M       models/atm/cam/src/control/cam_history_support.F90
         - Added is_subcol field to field_info strtucture
         - Only defines the pio variables if they are associated 

M       models/atm/cam/src/control/cam_history.F90
         - Utilizes the new is_subcol field and handles subcolumns properly
         - Introduced an interface for subcol_field_avg_handler to eliminate a circular dependency

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
         - Allow microphysics to have grid or subcolumns
         - moved microp_uniform the this namelist
         - Lower portion of micro_mg_cam reverts back to the grid

M       models/atm/cam/src/physics/cam/check_energy.F90
         - registers that TEOUT and DTCORE need to have subcolumn fields as well if subcolumns turned on
   
M       models/atm/cam/src/physics/cam/restart_physics.F90
         - if subcolumns are on, then call appropriate routines

M       models/atm/cam/src/physics/cam/physics_types.F90
         - Removed fields from physics_state: nsubcol and indcol.  This information is now stored in subcol_utils module
         - cpariv and rairv now have local copies of cpair and rair.
             If subcolumns, then allocates to subcolumn size and assigns the scalar value
             If grid columns, then allocates to pcols and checks that all of array version matches scalar value
             If grid columns, and cpairv and/or rairv is not all equal to scalar value, exit with an error

M       models/atm/cam/src/physics/cam/physpkg.F90
         - uses the new subcolumn routines for init and register
         - tphysbc now has logic to handle optional subcolumns for microp_driver
             
M       models/atm/cam/src/physics/cam/microp_driver.F90
         - minor cleanup

M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
         - Now contains col_type parameters
         - buffer_hdr has additional fields:
             is_copy(ngrid_types): contains info on whether subcolumn field is a copy or not
             added: used to flag if pbuf_add_field was called on this field
             dimsizes and vardesc have dimension for ngrid_types
         - bfg_sc is gone and bfg now dimensioned over ngrid_types
         - number of possible dimensions one less due to subcolumns needing a dimension
         - new routines which are public:
            pbuf_col_type_index: retrieves col_type index based on whether subcolumns turned on or not
            pbuf_register_subcol: used to make sure a subcolumn field is created - does not care if it 
                                  already was created or not.
         - new internal routines:
            pbuf_field_has_gridcols: returns true only if it is an allocated grid field
            pbuf_field_has_subcols: returns true only if it is an allocated subcol field (and not a copy)
            pbuf_field_has_col_type: returns true only if col_type field is allocated
            find_pbuf_header: finds a pbuf header pointer based on name and tacks on extra header if name not found
            pbuf_register_field_int: register a field in the pbuf (used by pbuf_add_field and was 
                                     guts of pbuf_add_field in previous versions).  Has additional functionality
                                     to register both grid and subcolumn fields.
            get_pbuf2d_field_restart: used by write_restart_field.  If subcolumn data, unpacks it before returning field.
                                      Grid data is just returned
            write_restart_field: replacement of pbuf_write_field with support for subcolumns
            read_restart_field: replacement for pio_read_restart_field with support for subcolumns

         - removed obsolete routines: pbuf_set_test_field and pbuf_check_test_field

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS

goldbach/nag: All Pass except newly introduced BL325

goldbach/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_3_27
Originator(s): cchen, hannay, eaton
Date: Tue Mar  4 10:52:02 MST 2014
One-line Summary: Namelist control for AMWG variability
 diagnostics; remove rad_diag_1 from CAM5/RCP use cases; add new
 history_amwg defaults.

Purpose of changes:

. Add a namelist variable, history_vdiag, which adds the specific fields at
  daily, 6-hourly, and 3-hourly output frequency required by the AMWG
  variability diagnostics.  Setting history_vdiag=.true. in the namelist is
  the only action required on the user's part, unless there is a conflict
  with the setting of nhtfrq.  The history_vdiag option writes fields to
  auxilliary history files h1, h2, and h3, and it assumes that the output
  frequency for these files is set to daily, 6-hourly, and 3-hourly
  respectively.  If the value of nhtfrq is set by the user, the first 4
  elements must be 0,-24,-6,-3.  Otherwise build-namelist will flag an
  error.  In the case of an error be sure to check whether the use case is
  the source of the inconsistent values of nhtfrq.

. All CAM5/RCP use case files have been modified to remove the diagnostic
  radiation calculation.  This is an expensive diagnostic and it was
  decided that it should not be enabled by default.

. Add variables TAUGWX, TAUGWY, TAUTMSX, TAUTMSY to the history_amwg field
  list. 

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:

. add history_vdiag

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add default for history_vdiag
. check that nhtfrq hasn't been set inconsistently, and set it's default if
  not set yet.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add history_vdiag to phys_ctl_nl group

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add default for history_vdiag (.false.)

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. add module variable history_vdiag
. diag_init
  - init history_vdiag via phys_getopts call
  - add add_default calls for U200, V200, U850, OMEGA500, PRECT inside of
    history_vdiag conditionals.  The addfld calls for all these variables
    sets them as time averaged.  The add_default calls are hardcoded with
    the specific auxillary hist file numbers.

models/atm/cam/src/physics/cam/gw_drag.F90
models/atm/cam/src/physics/cam/vertical_diffusion.F90
. add variables TAUGWX, TAUGWY, TAUTMSX, TAUTMSY to the history_amwg field list.

models/atm/cam/src/physics/cam/phys_control.F90
. add module variable history_vdiag
. add history_vdiag to namelist group phys_ctl_nl
. add history_vdiag to phys_getopts accessor method

models/atm/cam/src/physics/cam/radiation.F90
models/atm/cam/src/physics/rrtmg/radiation.F90
. radiation_init
  - add add_default calls for FLUT inside history_vdiag conditional.
    addfld call adds FLUT as time average field.

models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp26.xml
models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp60.xml
models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp45.xml
models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp85.xml
. remove the following setting for rad_diag_1:
 <rad_diag_1>
 'A:Q:H2O','N:O2:O2','N:CO2:CO2','N:ozone:O3','N:N2O:N2O','N:CH4:CH4','N:CFC11:CFC11','N:CFC12:CFC12'
 </rad_diag_1>

. remove the fincl1 fields that are produced by rad_diag_1:
 'FSNT_d1','FSNTC_d1','FSNS_d1','FSNSC_d1'

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS

goldbach/nag: All PASS

goldbach/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_3_26
Originator(s): santos cacraig eaton
Date: 2014/02/21
One-line Summary: Subcolumn prep for MG, update frankfurt to goldbach

Purpose of changes:

- Size distribution calculations for the radiation and diagnostic output
  are now done in micro_mg_cam, instead of directly using the outputs from
  micro_mg_tend. This will allow them to be done after all subcolumn and
  substepping averages, which presents a more consistent state for RRTMG.

- Add new test to check that svn:mergeinfo exists in the root directory of
  CAM, and nowhere else.

- Transition from frankfurt to goldbach as a test system.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A       models/atm/cam/test/system/TFM.sh
A       models/atm/cam/test/system/find_mergeinfo.sh
        - Add find_mergeinfo.sh utility for detecting mergeinfo.
        - Add test to ensure that the svn:mergeinfo property only exists on
          certain directories.

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/Makefile.in
M       models/atm/cam/bld/configure
         - Work around issue with PGI and the MPI compiler wrapper on
           goldbach.
         - When running MCT's configure script, pass along the value of CC
           and user-specified LDFLAGS as well as FC.

M       models/atm/cam/doc/ChangeLog_template
        - Change frankfurt to goldbach.

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/micro_mg_utils.F90
        - Have micro_mg_cam initialize micro_mg_utils for MG 1 (in future
          versions, the portable layer of MG will do this).
        - Define mincld in micro_mg_utils. In future versions, this will
          allow micro_mg_cam and the portable layer to share this value.
          For now, only micro_mg_cam uses it.
        - Do size distribution parameter calculations for the radiation
          in micro_mg_cam, rather than using the MG outputs. Reorder some
          output statements for consistency with this.

M       models/atm/cam/test/system/CAM_decomp.sh
M       models/atm/cam/test/system/CAM_runcmnd.sh
M       models/atm/cam/test/system/TCB.sh
M       models/atm/cam/test/system/TCB_ccsm.sh
M       models/atm/cam/test/system/archive_baseline.sh
M       models/atm/cam/test/system/input_tests_master
M       models/atm/cam/test/system/test_driver.sh
D       models/atm/cam/test/system/tests_posttag_frankfurt
A       models/atm/cam/test/system/tests_posttag_goldbach
D       models/atm/cam/test/system/tests_pretag_frankfurt_nag
A       models/atm/cam/test/system/tests_pretag_goldbach_nag
D       models/atm/cam/test/system/tests_pretag_frankfurt_pgi
A       models/atm/cam/test/system/tests_pretag_goldbach_pgi
         - Fix issue where ptile=32 does not work consistently on
           yellowstone, due to a recent LSF upgrade.
         - Update from frankfurt to goldbach.
         - Add TFM (mergeinfo test) to NAG pretag tests on goldbach.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Feb 19 20:09:42 MST 2014
014 bl322 TBL.sh fn1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Wed Feb 19 20:15:58 MST 2014
016 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Feb 19 20:17:22 MST 2014
024 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Wed Feb 19 20:28:53 MST 2014
039 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Wed Feb 19 20:42:39 MST 2014
043 bl366 TBL.sh f1.9c5clbdh outfrq3s_clubb 9s ............................FAIL! rc= 7 at Wed Feb 19 20:57:31 MST 2014
046 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Wed Feb 19 21:05:43 MST 2014
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Wed Feb 19 21:29:26 MST 2014
060 bl430 TBL.sh fm1.9c5dh outfrq3s_NEUwetdep 9s ..........................FAIL! rc= 7 at Wed Feb 19 21:53:57 MST 2014
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s+soa_chem_megan_emis 9s ..............FAIL! rc= 7 at Wed Feb 19 22:11:53 MST 2014
079 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Wed Feb 19 22:48:40 MST 2014
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Wed Feb 19 22:51:25 MST 2014

goldbach/nag:

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Thu Feb 20 13:26:47 MST 2014
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Thu Feb 20 13:32:29 MST 2014
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Thu Feb 20 13:38:46 MST 2014
018 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Feb 20 13:47:49 MST 2014
026 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Feb 20 14:10:49 MST 2014
033 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Thu Feb 20 14:20:19 MST 2014
042 bl805 TBL.sh f4c5carmtt1dm outfrq3s_carma 9s ..........................FAIL! rc= 7 at Thu Feb 20 14:57:21 MST 2014

goldbach/pgi or jaguar/pgi:

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Thu Feb 20 13:28:30 MST 2014
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Thu Feb 20 13:36:01 MST 2014
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Thu Feb 20 13:41:24 MST 2014
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Thu Feb 20 13:44:47 MST 2014
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Feb 20 13:58:49 MST 2014
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Feb 20 14:25:48 MST 2014
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Thu Feb 20 14:49:53 MST 2014
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Feb 20 14:58:45 MST 2014
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Thu Feb 20 15:05:23 MST 2014
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Thu Feb 20 15:07:44 MST 2014
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Thu Feb 20 15:11:19 MST 2014
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Thu Feb 20 15:24:21 MST 2014
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Thu Feb 20 15:43:58 MST 2014

All CAM 5 baselines were expected to fail due to microphysics changes.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

All MG (therefore all CAM5).

- what platforms/compilers:

All.

- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

Larger than roundoff, same climate.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_25
Originator(s): santos
Date: 2014/01/27
One-line Summary: Add settings for new 60 layer AMIP compset.

Purpose of changes:

- Add namelist settings for new AMIP compset, with high vertical resolution
  and spectral gravity waves.

- Clean up work and fix of a minor DEBUG mode bug in CARMA.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

- Add gravity wave settings for new compset, including the new tau_0_ubc
  option.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
        - Use https instead of http to get PIO external (fixes Subversion
          1.7 error).

M       models/atm/cam/bld/build-namelist
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/src/physics/cam/gw_common.F90
M       models/atm/cam/src/physics/cam/gw_drag.F90
        - Add option to enforce an upper boundary condition of tau = 0 in
          the gravity waves, and turn it on for CAM runs with spectral
          gravity waves.
        - Add gravity wave settings for high vertical resolution,
          non-WACCM runs.

M       models/atm/cam/src/physics/carma/models/bc_strat/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/cirrus_dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/meteor_impact/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/mixed_sulfate/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/pmc_sulfate/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sulfate/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_detrain/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_growth/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_passive/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_radiative/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_swelling/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_tracers/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_tracers2/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/tholin/carma_model_mod.F90
        - Remove unnecessary calls to phys_grid routines.
        - Fix bug where uninitialized data was used in a multiplication,
          causing a floating point exception (this bug did not affect
          results).

M       models/atm/cam/doc/ChangeLog
        - Fixed the date on the previous commit (Happy New Year!).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS.

frankfurt/nag: All PASS.

frankfurt/pgi or jaguar/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_24
Originator(s): santos
Date: 2014/01/23
One-line Summary: Improve stability of the ZM scheme.

Purpose of changes:

- In the ZM deep convection scheme, use Brent's method to invert the
  entropy equation, as it converges faster.

- In the ZM scheme, for the mixing ratio of water vapor at saturation, use
  a ratio over total mass rather than over dry mass, to avoid numerical
  overflow that can occur at high temperature.

- Limit RRTMG so that it only operates below 1 Pa, rather than using the
  lid of 0.01 Pa that was in place before. (Only impacts WACCM5 and other
  high-top RRTMG runs.)

- Prevent rare divide by zero error for very cold grid points in
  modal_aero_wateruptake.

Bugs fixed (include bugzilla ID):

#1891 - The "top" of RRTMG is too high in high-top models

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
        - Work around divide-by-zero error by checking for water vapor
          saturation pressures that are 0. (If this happens, the saturation
          pressure is wrong anyway because the temperature is unrealistic,
          but we give the model the chance to recover, or to throw a better
          error elsewhere.)

M       models/atm/cam/src/physics/cam/wv_sat_methods.F90
M       models/atm/cam/src/physics/cam/wv_saturation.F90
M       models/atm/cam/src/physics/cam/zm_conv.F90
        - Use improved entropy inverter in zm_conv.
        - Remove qmmr, and have zm_conv use qsat_water instead.

M       models/atm/cam/src/physics/rrtmg/rrtmg_state.F90
        - Lower the lid on RRTMG to 1 Pa.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Wed Jan 22 16:30:24 MST 2014
006 bl133 TBL.sh e48c4paqdm aqpgro+aquaplanet_cam4 3s .....................FAIL! rc= 7 at Wed Jan 22 16:31:33 MST 2014
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Jan 22 16:34:29 MST 2014
014 bl322 TBL.sh fn1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Wed Jan 22 16:46:44 MST 2014
016 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Jan 22 16:48:19 MST 2014
020 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Wed Jan 22 16:56:05 MST 2014
024 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Wed Jan 22 17:10:37 MST 2014
026 bl333 TBL.sh f4c4paqdh aqpgro+aquaplanet_cam4 3s ......................FAIL! rc= 7 at Wed Jan 22 17:11:14 MST 2014
036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Wed Jan 22 17:18:15 MST 2014
039 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Wed Jan 22 17:26:23 MST 2014
043 bl366 TBL.sh f1.9c5clbdh outfrq3s_clubb 9s ............................FAIL! rc= 7 at Wed Jan 22 17:45:20 MST 2014
046 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Wed Jan 22 18:02:32 MST 2014
051 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Wed Jan 22 18:33:04 MST 2014
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Wed Jan 22 18:37:35 MST 2014
055 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Wed Jan 22 18:44:54 MST 2014
058 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Wed Jan 22 18:55:12 MST 2014
060 bl430 TBL.sh fm1.9c5dh outfrq3s_NEUwetdep 9s ..........................FAIL! rc= 7 at Wed Jan 22 19:05:38 MST 2014
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s+soa_chem_megan_emis 9s ..............FAIL! rc= 7 at Wed Jan 22 19:26:59 MST 2014
067 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Wed Jan 22 19:39:13 MST 2014
070 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Wed Jan 22 19:41:58 MST 2014
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Wed Jan 22 19:58:22 MST 2014
076 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Wed Jan 22 20:02:49 MST 2014
079 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Wed Jan 22 20:19:54 MST 2014
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Wed Jan 22 20:23:06 MST 2014
084 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Wed Jan 22 20:40:08 MST 2014

frankfurt/nag:

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Jan 22 14:43:08 MST 2014
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Jan 22 14:49:33 MST 2014
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Jan 22 14:58:37 MST 2014
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Jan 22 15:26:40 MST 2014
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Jan 22 15:53:26 MST 2014
027 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Wed Jan 22 15:54:48 MST 2014
030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan 22 16:07:12 MST 2014
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Jan 22 16:09:36 MST 2014
035 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Wed Jan 22 16:26:25 MST 2014
038 bl324 TBL.sh f4c4rrtmgdm outfrq3s 9s ..................................FAIL! rc= 7 at Wed Jan 22 16:35:26 MST 2014
041 bl805 TBL.sh f4c5carmtt1dm outfrq3s_carma 9s ..........................FAIL! rc= 7 at Wed Jan 22 17:10:20 MST 2014

frankfurt/pgi or jaguar/pgi:

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Jan 22 14:42:53 MST 2014
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Jan 22 14:51:44 MST 2014
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Jan 22 14:57:17 MST 2014
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Jan 22 15:04:41 MST 2014
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Jan 22 15:20:23 MST 2014
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Jan 22 15:56:52 MST 2014
033 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Wed Jan 22 16:01:35 MST 2014
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan 22 16:23:41 MST 2014
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Wed Jan 22 16:29:37 MST 2014
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Jan 22 16:37:16 MST 2014
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan 22 16:54:05 MST 2014
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Wed Jan 22 17:00:47 MST 2014
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Wed Jan 22 17:04:38 MST 2014
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Wed Jan 22 17:13:05 MST 2014
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Wed Jan 22 17:43:31 MST 2014
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Wed Jan 22 18:08:46 MST 2014

ZM modifications expected to change answers (but not climate) for all
runs except adiabatic and ideal physics.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: All CAM3/4/5.
- what platforms/compilers: All.
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): Larger than roundoff, same climate.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_23
Originator(s): Po-Lun Ma, eaton
Date: Thu Jan  9 13:37:51 MST 2014
One-line Summary: changes to defaults for soil_erod and dust_emis_fact

Purpose of changes:

A problem with too low dust burdens in high res (1/2 and 1/4 deg) cam5 runs
was traced to the soil_erod datasets being used at those resolutions.  The
proposed solution involves using the 2 deg (1.9x2.5) dataset at all
resolutions higher than 2 deg.  Since we have already tuned the 1 deg FV
runs using the 0.9x1.25 dataset, an exception will be made for that case to
maintain backwards compatibility.  There are also several low resolution
specific versions of soil_erod that will be maintained for backwards
compatibility (and because there is no known problem with them).

It is unnecessary to produce specific high resolution version of soil_erod by
interpolating the 1.9x2.5 dataset since CAM is already set up to do this on
the fly internally (this was done to support the SE dycore and not require
resolution specific datasets for all the SE grids).  Therefore the fix is
to simply modify the build-namelist defaults so that the 1.9x2.5 dataset is
used for all dycores at all resolutions except the 1 deg FV case, and for
the existing low res specific datasets.

There is also a change to the dust_emis_fact tuning parameter.  Po-Lun Ma
has done simulations showing that the dust burdens for the 1/2 and 1/4 deg
FV case is improved by using the value 0.45 (the value from the tuning with
the 1 deg soil_erod dataset is set to 0.35).  This change has been included
as well.

The SE setting for dust_emis_fact has not been changed from the value of
0.55 which was from tuning ne30np4 using the 1 deg soil_erod dataset.
Since the tuning of CAM-SE is ongoing we decided to change all the SE
resolutions to use the 1.9x2.5 soil erod dataset recognizing that
dust_emis_fact will need retuning for SE.


Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:
. defaults changed for soil_erod and dust_emis_fact as described above.

List any changes to the defaults for the boundary datasets:
. defaults changed for soil_erod as described above.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. updates to soil_erod defaults
. updates to dust_emis_fact


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all PASS except:
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Thu Jan  9 01:31:35 MST 2014

All SE w/ prognostic aerosols runs change answers.

frankfurt/nag: all PASS except:
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Jan  8 18:46:44 MST 2014

frankfurt/pgi: all PASS except:
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Jan  8 19:38:10 MST 2014

bl312 fails becase the default dataset when no resolution dependent version
of soil_erod is now the 1.9x2.5 version.  This resolution was previously
using 0.9x1.25.


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers:

Answers will change for all SE w/ prognostic aerosol runs.

Answers will change for FV w/ prognostic aerosols for resolutions finer
than 1 deg, or for low resolutions that don't already have resolution
specific version of soil_erod.

===============================================================
===============================================================

Tag name: cam5_3_22
Originator(s): cbardeen, santos
Date: 2014/01/02
One-line Summary: New CARMA updates and compiler porting

Purpose of changes:

 - Add six new CARMA models:
    - cirrus_dust
    - meteor_impact
    - mixed_sulfate
    - pmc_sulfate
    - tholin
    - test_tracers2

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

 - New CPP macro, N_RAD_CNST, sets the maximum allowed number of
   radiatively active constituents.

 - Work around new NAG fpp bug by turning off macro expansion in comments.

Describe any changes made to the namelist:

 - Add defaults for the new CARMA models.

 - New carma_emis_* variables for the meteor impact model.

 - New carma_neutral_h2so4 flag.

 - The types in namelist_definitions.xml can now contain arrays with
   variable dimensions.

 - The variable n_rad_cnst was introduced, and controls the size of the
   rad_climate and rad_diag_* arrays.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

A       models/atm/cam/src/physics/carma/cam/carma_getH2O.F90
A       models/atm/cam/src/physics/carma/cam/carma_getH2SO4.F90
         - Create constituent profiles from averages over columns.

A       models/atm/cam/src/physics/carma/models/cirrus_dust
A       models/atm/cam/src/physics/carma/models/cirrus_dust/carma_mod.F90
A       models/atm/cam/src/physics/carma/models/cirrus_dust/carma_model_mod.F90
A       models/atm/cam/src/physics/carma/models/cirrus_dust/hetnucl.F90
A       models/atm/cam/src/physics/carma/models/cirrus_dust/growevapl.F90
A       models/atm/cam/src/physics/carma/models/cirrus_dust/carma_model_flags_mod.F90
A       models/atm/cam/src/physics/carma/models/cirrus_dust/carma_cloudfraction.F90
         - Add CARMA cirrus_dust model.

A       models/atm/cam/src/physics/carma/models/meteor_impact
A       models/atm/cam/src/physics/carma/models/meteor_impact/carma_model_mod.F90
A       models/atm/cam/src/physics/carma/models/meteor_impact/carma_model_flags_mod.F90
         - Add CARMA meteor_impact model.

A       models/atm/cam/src/physics/carma/models/mixed_sulfate
A       models/atm/cam/src/physics/carma/models/mixed_sulfate/carma_model_mod.F90
A       models/atm/cam/src/physics/carma/models/mixed_sulfate/carma_model_flags_mod.F90
         - Add CARMA mixed_sulfate model.

A       models/atm/cam/src/physics/carma/models/pmc_sulfate
A       models/atm/cam/src/physics/carma/models/pmc_sulfate/carma_model_mod.F90
A       models/atm/cam/src/physics/carma/models/pmc_sulfate/carma_model_flags_mod.F90
         - Add CARMA pmc_sulfate model.

A       models/atm/cam/src/physics/carma/models/test_tracers2
A       models/atm/cam/src/physics/carma/models/test_tracers2/carma_model_mod.F90
A       models/atm/cam/src/physics/carma/models/test_tracers2/carma_model_flags_mod.F90
         - Add CARMA test_tracers2 model.

A       models/atm/cam/src/physics/carma/models/tholin
A       models/atm/cam/src/physics/carma/models/tholin/carma_model_mod.F90
A       models/atm/cam/src/physics/carma/models/tholin/carma_model_flags_mod.F90
         - Add CARMA tholin model.

A       models/atm/cam/test/system/config_files/f1.9c5carmc_ddm
A       models/atm/cam/test/system/config_files/f4c5carmm_idm
A       models/atm/cam/test/system/config_files/f4c5carmm_sdm
A       models/atm/cam/test/system/config_files/f4c5carmp_sdm
A       models/atm/cam/test/system/config_files/f4c5carmthodm
A       models/atm/cam/test/system/config_files/f4c5carmtt1dm
A       models/atm/cam/test/system/config_files/f4c5carmtt2dm
         - Config files for tests of new models.

A       models/atm/cam/test/system/config_files/f4c4rrtmgdm
         - Test case for CAM4+RRTMG.

A       models/atm/cam/test/system/nl_files/outfrq3s_carma
A       models/atm/cam/test/system/nl_files/outfrq3s_carma_fractal
         - Add namelist for a outfrq3s test for CARMA, and CARMA with
           fractal soot enabled.

List all existing files that have been modified, and describe the changes:


     NOTE: There are changes for porting to the NAG compiler, as well as
           cosmetic changes (such as whitespace), throughout the CARMA
           modules. The most common such change is to wrap lines that would
           otherwise be longer than the Fortran standard's limit (132
           characters.) These changes will not be listed individually.


M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - New CARMA external.

M       models/atm/cam/bld/build-namelist
M       models/atm/cam/bld/config_files/definition.xml
M       models/atm/cam/bld/configure
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
         - Add settings for new CARMA models and features.
         - Allow the user to increase the maximum allowed number of
           radiatively active (or diagnosed) constituents, using the new
           option "-max_n_rad_cnst".

M       models/atm/cam/bld/perl5lib/Build/Namelist.pm
M       models/atm/cam/bld/perl5lib/Build/NamelistDefinition.pm
         - Allow namelist_definitions.xml to specify a variable as an array
           dimension (for n_rad_cnst).

M       models/atm/cam/bld/Makefile.in
         - For NAG, don't expand macros in comments (workaround for fpp
           regression).

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
         - Don't add rel_fn to the physics buffer, since it's only used for
           output from MG itself.

M       models/atm/cam/src/physics/cam/phys_prop.F90
         - Remove limit on maximum number of unique input files, by using
           an allocatable to store the list.

M       models/atm/cam/src/physics/cam/physics_types.F90
         - Allow grid cells to have negative altitude. (Fixes issue with
           state_debug_checks and negative topology.)

M       models/atm/cam/src/physics/cam/rad_constituents.F90
         - Maximum number of radiative constituents now comes from the
           parameter n_rad_cnst, set from the macro N_RAD_CNST.

M       models/atm/cam/src/physics/cam/radiation_data.F90
         - Don't output rel_fn; it can be output by MG, and is not actually
           an input the radiation uses in the first place.

M       models/atm/cam/src/physics/carma/cam/carma_getT.F90
         - Spelling correction.

M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
         - Create and use new H2O/H2SO4 profiles.
         - Correct indexing errors.
         - Changes for new fractal code.
         - Fix fairly severe error where "nf90_get_var" was being used
           instead of "nf90_put_var", leading to outputs of files
           containing uninitialized data.

M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
         - Fix bug where state was being inappropriately modified by calls
           to MG routines.

M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
         - Address case where Weibull_k is 0 differently.
         - Removed prescribed Weibull coefficients entirely from this file,
           since this feature has not been completed, and the incomplete
           pieces broke the NAG build.

M       models/atm/cam/src/physics/carma/models/bc_strat/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/dust/carma_model_flags_mod.F90
M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_flags_mod.F90
M       models/atm/cam/src/physics/carma/models/sulfate/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_detrain/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_growth/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_passive/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_radiative/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_swelling/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_tracers/carma_model_flags_mod.F90
M       models/atm/cam/src/physics/carma/models/test_tracers/carma_model_mod.F90
         - Only NAG port and cosmetic changes.

M       models/atm/cam/src/physics/rrtmg/rad_solar_var.F90
         - Removed unnecessary use of ssi_ref.

M       models/atm/cam/src/physics/rrtmg/radiation.F90
         - Don't retrieve REL, REL_FN, and REI from pbuf, because they are
           never used.

M       models/atm/cam/test/system/TER.sh
         - For restart tests, copy RRTMG optical property files that have
           been written out by CARMA.

D       models/atm/cam/test/system/config_files/fsd1.9c4wcarmsulm
A       models/atm/cam/test/system/config_files/fsd1.9c4wcarmsuldm
         - Change SD-WACCM CARMA sulfate test to a debug mode test.

M       models/atm/cam/test/system/input_tests_master
         - Add tests for CAM4+RRTMG and new CARMA models.
         - Dust and SD-WACCM tests are now 9 timestep debug tests.

M       models/atm/cam/test/system/nl_files/outfrq3s_carma
         - Remove year specification (it messed up the SD test, which
           doesn't have data for 1995).

M       models/atm/cam/test/system/test_driver.sh
         - Explicitly use netCDF 4.3 on Frankfurt/NAG, since the symlink
           still points to a version where getting text attributes will
           corrupt data on the stack.

M       models/atm/cam/test/system/tests_carma
         - Add new CARMA model tests to this list.

M       models/atm/cam/test/system/tests_pretag_frankfurt_nag
         - Add test for CAM4+RRTMG.
         - Add test for CARMA test_tracers.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

All PASS.

frankfurt/nag:

038 bl324 TBL.sh f4c4rrtmgdm outfrq3s 9s ..................................FAIL! rc= 7 at Thu Jan  2 11:15:23 MST 2014
041 bl805 TBL.sh f4c5carmtt1dm outfrq3s_carma 9s ..........................FAIL! rc= 7 at Thu Jan  2 11:15:24 MST 2014

Failures for new tests where there is no baseline.

frankfurt/pgi or jaguar/pgi: 

All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

All configurations with CARMA.

- what platforms/compilers:

All.

- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

Mixed, several likely to have new climate. No changes to compsets that are
scientifically supported within CESM; this is only new CARMA development.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_21
Originator(s): cacraig
Date: 12/20/13
One-line Summary: Update yellowstone intel compiler to 13.1.2 to allow implementation of eq tests for CESM

Purpose of changes:
  - Have CAM standalone tests on yellowstone use Intel 13.1.2 to allow CESM eq tests to be BFB (compiler version
      CESM is currently using)
  - Modified CESM regression tests on yellowstone to be eq tests for CAM4 FV and CAM5 SE
  - Added missing finidat file for ne30np4 case (answers were not BFB with CESM without it)
  - Updated to alpha06d externals (except CLM which has a bug) to eliminate core dump in pio
  - Performed mergeinfo cleanup (svn propdel svn:mergeinfo -R; svn revert .)

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/test/system/TCB_ccsm.sh
        - Added echo of all CESM commands for documentation purposes

M       models/atm/cam/test/system/TSM.sh
        - Added echo of command sent to TCB.sh for documentation purposes

M       models/atm/cam/test/system/test_driver.sh
        - Force yellowstone intel compilations to be 13.1.2 to match CESM compiler and allow eq tests to be BFB

M       models/atm/cam/test/system/tests_pretag_yellowstone
M       models/atm/cam/test/system/input_tests_master
        - Modified CESM tests on yellowstone to be eq tests for CAM4 FV and CAM5 SE

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
        - Added missing finidat file for ne30np4 case (answers were not BFB with CESM without it)

M       models/atm/cam/src/dynamics/sld/inidat.F90
M       models/atm/cam/src/dynamics/eul/inidat.F90
M       models/atm/cam/src/dynamics/fv/inidat.F90
        - Change trunits to character*256 to get rid of bounds error in sm374 and sm430 with Intel 13.1.2

M       SVN_EXTERNAL_DIRECTORIES
        - Updated to alpha06d externals to eliminate core dump in pio

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

********* SPECIAL NOTES ON TESTING **************
** Due to time constraints due to the upcoming holidays,
** yellowstone tests were run without changes to inidat.
** The change to inidat allowed sm374 and sm430 to run to
** completion and these two group of tests were rerun.  
** Other yellowstone tests were not run with this inidat 
** change on yellowstone.
*************************************************
yellowstone/intel: All BFB except,
036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Mon Dec 16 18:23:43 MST 2013
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Mon Dec 16 19:41:43 MST 2013
070 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Mon Dec 16 20:25:32 MST 2013
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Mon Dec 16 20:42:02 MST 2013
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Mon Dec 16 21:06:26 MST 2013
   - Answer changes due to change in compiler

frankfurt/nag: All BFB and run with new inidat

frankfurt/pgi or jaguar/pgi:  All BFB and run with new inidat

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_20
Originator(s): hannay, pel, mataylo, eaton
Date: 
One-line Summary: update SE dycore tuning parameters and mct_libdir option

Purpose of changes:

. Update SE dycore tuning parameters
  - Change time stepping method to RK5 (Kinnmark & Gray Runga-Kutta 5
    stage; 3rd order accurate in time)
  - Set the namelists variables as recommended for RK5 in:
    http://www.cgd.ucar.edu/cms/pel/software/cam-se-dt-table.pdf
  - Add "tstep_type" namelist option for SE dycore
  - Turn on the FV energy fixer (This will be updated later on with
    Williamson an Olson enery fixer)
  - Remove the variable "energy_fixer" from the cam namelist.
 
  To update a namelist created by an earlier CAM tag for an SE run on
  grid ne30np4 one should make the following changes:
  - The default settings for CESM1.2.0 were:
    tstep_type =1
    hypervis_subcycle = 2
    qsplit =4
    rsplit = 5
    se_ftype =1
    se_nsplit = 1
 
  - The new recommended settings are:
    tstep_type =5
    hypervis_subcycle = 3
    qsplit = 1
    rsplit = 3
    se_ftype =0
    se_nsplit = 2

  These changes have been approved by the AMWG co-chairs:
  Rich Neale: 11/11/2013
  Minghua Zhang: 11/12/2013
  Mark Taylor: 11/12/2013

. Allow the CAM standalone mode to build the MCT libs outside the CAM build
  directory so that they can be reused for multiple CAM builds.  The
  location of the MCT build is specified using the -mct_libdir argument.
  If the libraries are present in the location specified by -mct_libdir
  then the MCT configure and build do not need to be redone.


Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:
. add tstep_type, remove energy_fixer, and change many default SE tuning
  parameters 

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. remove default for energy_fixer
. add default for tstep_type 

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update defaults for dtime, nu, nu_p, nu_div, hypervis_subcycle, qsplit,
  rsplit, se_nsplit, se_ftype
. remove energy_fixer default
. add default for tstep_type

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add namelist variable tstep_type for SE timestepping method
. remove entry for energy_fixer

models/atm/cam/src/physics/cam/physpkg.F90
. tphysbc and phys_run1_adiabatic_or_ideal
  - Add SE to the conditional for running the check_energy_fix global
    energy fixer (also used by FV).

models/atm/cam/test/system/TCB.sh
models/atm/cam/bld/configure
. Added changes to allow mct to be built once and used for all tests

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB except
076 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Thu Dec  5 20:45:41 MST 2013
079 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Thu Dec  5 21:02:21 MST 2013
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Thu Dec  5 21:05:37 MST 2013
084 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Thu Dec  5 21:22:22 MST 2013
090 bl997 TBL_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 7 at Thu Dec  5 21:40:24 MST 2013


frankfurt/nag: All BFB

frankfurt/pgi or jaguar/pgi: all BFB except
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Thu Dec  5 19:24:50 MST 2013

SE tests were answer changing and approved by the AMWG co-chairs

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: All SE configurations have answer
changes.  The climate is similar for ne30np4.

URL for AMWG diagnostics output used to validate new climate:
> http://webext.cgd.ucar.edu/FCLIMO/f.e12.F2000C5.ne30_ne30.dyn.001/atm/f.e12.F2000C5.ne30_ne30.dyn.001-f.e12.F2000C5.ne30_ne30.cnt.001/

===============================================================
===============================================================

Tag name: cam5_3_19
Originator(s): Cheryl Craig, Jen Kay, Jay Shollenberger, Jim Edwards, Brian Eaton
Date:  11/21/13
One-line Summary: Misc updates

Purpose of changes:
  - update a use case
  - updated SVN_EXTERNAL_DIRECTORIES to match alpha06c (gets the fix for Machines)

Bugs fixed (include bugzilla ID):
  - 1859: bug inside physics_buffer:  linked list should be advanced from 2,index instead of 1,index
  - 1864: bug in lidar simulator fixed

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_strat_soa.xml
         - Changed SSLT01PP,  SSLT02PP,  SSLT03PP  and SSLT04PP to
                   SSLT01WET, SSLT02WET, SSLT03WET and SSLT04WET

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - bug fix from jenkay for lidar simulator in cosp

M       models/atm/cam/src/control/cam_history.F90
         - bug fix from edwards to _Filltype type written to history restart file
           did not match the data type when history files were set to real in netCDF6.

M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
         - bug fix from eaton.  In physics_buffer, pbuf_get_field_name the loop over the
           linked list was one too many.  Now loops from 2,index.

M       models/atm/cam/test/system/tests_pretag_frankfurt_pgi
         - Removed tests sm991 and eq991 per Brian Eaton
           His feeling is that CESM testing should be done by the CESM team and this test is redundant
           The CESM team is seeing this error as well.

M       SVN_EXTERNAL_DIRECTORIES
         - Needed new machines external to fix CESM regression tests.  This tag
           appears to depend on other tags (CESM test would not build).  Updated
           all externals to ones used in alpha06c

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB

frankfurt/nag: all BFB

frankfurt/pgi or jaguar/pgi:  all BFB except:
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Nov 21 15:46:21 MST 2013
     The cosp test was expected to be different

060 sm991 TSM_ccsm.sh f19_f19 F 2d ........................................FAIL! rc= 4 at Thu Nov 21 17:00:26 MST 2013
061 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 4 at Thu Nov 21 17:00:26 MST 2013
     NOTE --  These tests are permanently removed per Brian Eaton


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_18
Originator(s): cacraig
Date: 11/20/13
One-line Summary: Update externals to CESM1_3_beta05

Purpose of changes:  Update externals to CESM1_3_beta05

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
        - Update externals to CESM1_3_beta05 except for csm_share.
          beta05 used share3_130918 for csm_share, but CAM requires 
          share3_131101 which made gamma elemental and is required in micro_mg_cam.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All BFB except
085 sm992 TSM_ccsm.sh f19_g16 ETEST 2d ....................................FAIL! rc= 6 at Mon Nov 18 20:43:08 MST 2013
086 er992 TER_ccsm.sh f19_g16 ETEST 1+1d ..................................FAIL! rc= 6 at Mon Nov 18 20:43:08 MST 2013
087 bl992 TBL_ccsm.sh f19_g16 ETEST 2d ....................................FAIL! rc= 4 at Mon Nov 18 20:43:08 MST 2013
088 sm997 TSM_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 6 at Mon Nov 18 21:13:31 MST 2013
089 er997 TER_ccsm.sh ne16_g37 FC5 1+1d ...................................FAIL! rc= 6 at Mon Nov 18 21:13:31 MST 2013
090 bl997 TBL_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 4 at Mon Nov 18 21:13:31 MST 2013
091 ne996 TNE_ccsm.sh f45_f45 FMOZ FMOZ+testmech 2d .......................FAIL! 

These CESM tests failed due to a bug in scripts/ccsm_utils/Machines/mkbatch.yellowstone.  Jim provided a fix which I tested
and the tests all passed and were BFB.  This fix will be in his next machines tag and will be incorporated in cam5_3_19.

frankfurt/nag: All BFB

frankfurt/pgi or jaguar/pgi: All BFB

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

- what platforms/compilers:

- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?


If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_17
Originator(s): santos
Date: 13/11/04
One-line Summary: Compiler fixes, prep work for new MG substepping.

Purpose of changes:

 - Bring in changes from the MG microphysics development branch, to make it
   easier to merge the full set of changes with the new subcolumn framework
   later.

   This includes micro_mg_utils, which provides routines that implement
   part of the core functionality of MG version 2 (coming soon).

 - Fix issues identified by NAG.

 - Fix issue due to missing CMELIQ output in the CLUBB interface.

 - Address other bugs that show up in rare cases.

Bugs fixed (include bugzilla ID):

 - #1813: CMELIQ no longer able to be output

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A       models/atm/cam/src/physics/cam/micro_mg_utils.F90
        - Module providing utility code and individual process subroutines.
          Part of MG 2.0 will be based on this module.

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
        - Update csm_share to a version where gamma is an elemental
          function.

M       models/atm/cam/bld/cam.buildnml.csh
        - Turn on state_debug_checks if DEBUG is TRUE.

M       models/atm/cam/src/chemistry/mozart/apex_subs.F90
        - Send array sections to TRILIN rather than individual elements
          (i.e. pointers), to satisfy NAG checks that error due to the
          dummy array exceeding the bounds of the actual argument array.

M       models/atm/cam/src/chemistry/mozart/spedata.F90
M       models/atm/cam/src/dynamics/fv/metdata.F90
        - Nullify pointers and take steps to reduce the chance of an
          uninitialized pointer reference.

M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
        - Change modal_aero_kohler to use assumed shape arrays to avoid a
          pointless copy.

M       models/atm/cam/src/control/interpolate_data.F90
        - Use new integer flag in lininterp_full1d instead of a literal 1.
        - Remove inappropriate check that causes failure in RRTMG for
          serial cases that are not SCAM runs.

M       models/atm/cam/src/control/wrap_nf.F90
        - Remove arbitrary addition of "1" to a dimension; this has no
          clear purpose and was causing issues for CARMA with strict
          compiler checks.

M       models/atm/cam/src/physics/cam/clubb_intr.F90
        - Add missing addfld/outfld calls for CMELIQ.

M       models/atm/cam/src/physics/cam/micro_mg1_0.F90
        - Remove unnecessary output "cldo".
        - Rearrange statements.

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
        - Reduce the number of differences with respect to the MG 2.0
          development branch, including statement reordering, cleanup,
          whitespace, and output changes.

M       models/atm/cam/src/physics/cam/tropopause.F90
        - Switch to assumed-shape arrays for twmo interface, avoiding an
          unnecessary copy, and also change the name "gamma" to "gam" to
          avoid any name clash with the F2008 intrinsic.

M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
        - Remove routines that were duplicated from an earlier version of
          the MG microphysics, and instead use versions from the new
          micro_mg_utils module.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS.

frankfurt/nag: All PASS.

frankfurt/pgi or jaguar/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

  Changes answers for CARMA cirrus model only.

- what platforms/compilers:

  All.

- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

  Roundoff.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

  Offline testing of the size distribution routines that caused the answer
  change.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_16
Originator(s): fvitt
Date: 21 Oct 2013
One-line Summary: Refactor the chemistry-aerosol model interface and update drv tag.

Purpose of changes:

 - The chemistry-aerosol model interface was refactored to provide a more
   extendable framework.  This will ease incorporation of other aerosol
   models (e.g., a sectional aerosol model)

  This refactoring of the chemistry-aerosol model interface does away with the numerous
  ifdefs that have been historically used to embed aerosol models within CAM-Chem.
  Each aerosol model must provide the following modules in chemistry/name_aero (where
  name is a named aerosol model, e.g., modal):
    aero_model.F90 ------- aerosol model specific module with methods:
      . aero_model_drydep ----- aerosol dry deposition and sediment
      . aero_model_wetdep ----- aerosol wet removal
      . aero_model_emissions -- aerosol emissions
      . aero_model_surfarea --- aerosol surface area for chemistry
      . aero_model_gasaerexch - create, grow, change, and shrink aerosols
    dust_model.F90 ------- dust module with methods
      . dust_names - dust species names
      . dust_nbin -- number of dust bins
      . dust_emis -- emissions method
    seasalt_model.F90 ---- sea salt module with methods
      . seasalt_names - sea salt species names
      . seasalt_nbin -- number of sea salt bins
      . seasalt_emis -- sea salt emissions method
    sox_cldaero_mod.F90 -- aerosol model specific code for cloud aerosol/SOx aqueous chemistry

 - Update drv tag to drvseq5_0_03 which fixes SCAM test

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

D       models/atm/cam/bld/namelist_files/master_mam_dep_list.xml
D       models/atm/cam/bld/namelist_files/master_drydep_list.xml
 - re-organized master deposition list files

D       models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
D       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
D       models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
 - removed

D       models/atm/cam/src/chemistry/bulk_aero/drydep_mod.F90
D       models/atm/cam/src/chemistry/bulk_aero/wetdep.F90
D       models/atm/cam/src/chemistry/bulk_aero/dust_sediment_mod.F90
 - moved to chemistry/aerosol directory

D       models/atm/cam/src/chemistry/mozart/mo_setsox.F90
 - moved to chemistry/aerosol directory

D       models/atm/cam/src/chemistry/mozart/mo_aerosols.F90
D       models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
 - moved to chemistry/bulk_aero

D       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
 - removed

List all subroutines added and what they do:

A       models/atm/cam/bld/namelist_files/master_aer_drydep_list.xml
A       models/atm/cam/bld/namelist_files/master_gas_drydep_list.xml
 - re-organized master deposition list files

A       models/atm/cam/src/chemistry/modal_aero/aero_model.F90
A       models/atm/cam/src/chemistry/modal_aero/seasalt_model.F90
A       models/atm/cam/src/chemistry/modal_aero/dust_model.F90
 - modal aerosol specific code

A       models/atm/cam/src/chemistry/modal_aero/sox_cldaero_mod.F90
 - modal aerosol specific code for aqueous chemistry

A       models/atm/cam/src/chemistry/bulk_aero/mo_aerosols.F90
 - moved from chemistry/mozart

A       models/atm/cam/src/chemistry/bulk_aero/aerosol_depvel.F90
A       models/atm/cam/src/chemistry/bulk_aero/aero_model.F90
A       models/atm/cam/src/chemistry/bulk_aero/mo_setsoa.F90
A       models/atm/cam/src/chemistry/bulk_aero/seasalt_model.F90
A       models/atm/cam/src/chemistry/bulk_aero/dust_model.F90
A       models/atm/cam/src/chemistry/bulk_aero/sox_cldaero_mod.F90
 - module for the bulk aerosol model

A       models/atm/cam/src/chemistry/aerosol/mo_setsox.F90
A       models/atm/cam/src/chemistry/aerosol/dust_sediment_mod.F90
 - moved from chemistry/mozart

A       models/atm/cam/src/chemistry/aerosol/drydep_mod.F90
A       models/atm/cam/src/chemistry/aerosol/dust_common.F90
A       models/atm/cam/src/chemistry/aerosol/cldaero_mod.F90
A       models/atm/cam/src/chemistry/aerosol/wetdep.F90
A       models/atm/cam/src/chemistry/aerosol
 - utility modules common to all aerosol models

A       models/atm/cam/src/chemistry/aerosol/soil_erod_mod.F90
 - extracted code from deprecated dust_intr.F90 module

A       models/atm/cam/src/chemistry/aerosol/sslt_sections.F90
 - extracted code from deprecated progseasalts module

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/test/system/TR8.sh
 - check for r8 kind in source directory src/cpl rather than the multiple
   src/cpl_* directories that existed prior to cam3_5_15

M       models/atm/cam/bld/configure
 - change in Filepath directory structure for the aerosol models

M       models/atm/cam/bld/namelist_files/master_aer_wetdep_list.xml
 - re-organized master deposition list files

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
 - sol_farcti_cloud_borne, aerosol_drydep_list, and aer_wetdep_list
   are now part of the aerosol_nl namelist group
 - dust_emis_fact moved to dust_nl namelist group
 - "soil_erod" --> "soil_erod_file" and is included in dust_nl namelist group

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - "soil_erod" --> "soil_erod_file"

M       models/atm/cam/bld/build-namelist
 - refactored how deposition lists are set
 - "soil_erod" --> "soil_erod_file"
 - set sol_facti_cloud_borne only if chemistry has modal aerosols

M       models/atm/cam/bld/perl5lib/Build/ChemNamelist.pm
 - refactored how deposition lists are set

M       models/atm/cam/bld/namelist_files/use_cases/cam4_chem_radpsv_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/cam4_bam_radpsv_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_chem.xml
 - removed ORO from fincl list
 - "soil_erod" --> "soil_erod_file"

M       models/atm/cam/bld/namelist_files/use_cases/soa_chem_megan_emis.xml
 - *PP history fields replaced by *WET fields

M       models/atm/cam/src/control/camsrfexch.F90
 - extend cam_in_t for dust and MEGAN fluxes from land model

M       models/atm/cam/src/cpl/atm_comp_mct.F90
M       models/atm/cam/src/cpl/atm_comp_esmf.F90
M       models/atm/cam/src/cpl/atm_import_export.F90
 - set dust and MEGAN fluxes in the cam_in data structure

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
 - replaced MODAL_AERO ifdef with prog_modal_aero conditional

M       models/atm/cam/src/physics/cam/clubb_intr.F90
 - removed MODAL_AERO ifdef that served no purpose

M       models/atm/cam/src/physics/cam/physpkg.F90
 - add FRACIS to phys buffer
 - register and initialize calsize and wateruptake for modal aerosol model
 - removed calls to aerosol_reg and aerosol_init -- these are invoked by chemistry
 - removed MODAL_AERO ifdefs
 - invoke calcsize and wateruptake for prescribed modal aerosols

M       models/atm/cam/src/physics/cam/qneg3.F90
 - removed MODAL_AERO ifdefs and qneg3_modalx1 subroutine which was
   essentially a duplication of the qneg3 subroutine

M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
 - moved output of 'ustar' and 'obklen' history fields to this module

M       models/atm/cam/src/chemistry/pp_none/chemistry.F90
 - chem_register invokes aero_model_register for prescribed aerosols
 - chem_init invokes aero_model_init for prescribed aerosols
 - added stub chem_emissions subroutine to be consistent with mozart/chemistry.F90

M       models/atm/cam/src/chemistry/utils/prescribed_aero.F90
 - added comment

M       models/atm/cam/src/chemistry/utils/mo_constants.F90
 - added densities of dust and sea salt

M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
 - added register method which adds DGNUMWET, WETDENS_AP, and QAERWAT fields
   to physics buffer

M       models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
 - added register method which adds DGNUM field to physics buffer

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
 - removed latndx and lonndx arguments

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
 - moved addfld calls for aqueous chemistry to sox_cldaero_mod
 - moved call to modal_aero_bcscavcoef_init to modal_aero/aero_model.F90

M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - removed the numerous MODAL_AERO ifdefs
 - the bulk of the modal aerosol formation code moved to
   aero_model_gasaerexch subroutine which include aqueous chem in setsox
 - invocation of set_srf_emissions moved to chem_emissions subroutine

M       models/atm/cam/src/chemistry/mozart/mo_setaer.F90
 - reference sslt_names

M       models/atm/cam/src/chemistry/mozart/mo_chemini.F90
 - removed calls to aerosols_inti, soa_inti, and sox_int subroutines

M       models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
 - removed MODAL_AERO ifdefs
   -- moved cloud-borne wet dep addfld calls to modal_aero/aero_model.F90

M       models/atm/cam/src/chemistry/mozart/chemistry.F90
 - chem_reset_fluxes --> chem_emissions
 - aerosol namelist vars moved to aero_model
 - general cleanup

M       models/atm/cam/src/chemistry/mozart/mo_photo.F90
 - reference seasalt_names

M       models/atm/cam/src/chemistry/mozart/mo_sethet.F90
 - determine if modal aerosols in initialization

M       models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
 - min size of 1 for col_dens and col_delta arguments

M       models/atm/cam/src/chemistry/mozart/mo_mass_xforms.F90
 - moved qqcw2vmr and vmr2qqcw to modal_aero/aero_model.F90

M       models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - removed surarea code -- is now in aero_model.F90
 - removed MODAL_AERO ifdefs

M       models/atm/cam/src/dynamics/sld/inidat.F90
M       models/atm/cam/src/dynamics/eul/inidat.F90
M       models/atm/cam/src/dynamics/se/inidat.F90
M       models/atm/cam/src/dynamics/fv/inidat.F90
 - removed calls to aerosol_implements_cnst (deprecated)

M       SVN_EXTERNAL_DIRECTORIES
 - update drv tag to drvseq5_0_03

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All pass

frankfurt/nag: All pass

frankfurt/pgi: All pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_15
Originator(s):  cacraig, mvertens
Date: 10/17/13
One-line Summary: Merge in comptype03_cam5_3_10 and update to cesm1_3_beta04 externals

Purpose of changes:
- Merge in Mariana's changes in comptype03_cam5_3_10
    svn merge $CAMREPO/trunk_tags/cam5_3_10 $CAMREPO/branch_tags/comptype_tags/comptype03_cam5_3_10
         (plus additional changes below)
- Additional changes required:
    cp /glade/u/home/mvertens/src/cesm1_3_beta04+comptype/models/atm/cam/src/utils/cam_dom/ocn_comp_mct.F90
       svn del cpl_mct, cpl_mct_ocn_comp_mct.F90, cpl_esmf
       svn add ocn_comp_mct.F90
    cp /glade/u/home/mvertens/src/cescm1_3_beat04_comptype/models/atm/cam/bld/configure
    Needed to modify models/atm/cam/src/cpl/atm_import_export.F90 to incorporate the changes from cam5_3_14
- Using cesm1_3_beta04 externals except for share which is using share3_130918 to get single column test to pass
- Added ability to CAM regression tests to use caldera for both compilation and running if job is started while logged on caldera
 
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: 

List all subroutines eliminated:
D       models/atm/cam/src/cpl_share
D       models/atm/cam/src/cpl_share/cam_cpl_indices.F90
D       models/atm/cam/src/utils/cam_dom/cpl_mct
D       models/atm/cam/src/utils/cam_dom/cpl_mct/ocn_comp_mct.F90
D       models/atm/cam/src/utils/cam_dom/cpl_esmf
D       models/atm/cam/src/utils/cam_aqua/cpl_mct
D       models/atm/cam/src/utils/cam_aqua/cpl_mct/ocn_comp_mct.F90
D       models/atm/cam/src/utils/cam_aqua/cpl_esmf
D       models/atm/cam/src/cpl_mct
D       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
D       models/atm/cam/src/cpl_esmf
D       models/atm/cam/src/cpl_esmf/atm_comp_mct.F90
D       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
           - Changes from the comptype branch merge

List all subroutines added and what they do:
A       models/atm/cam/src/utils/cam_dom/ocn_comp_mct.F90
A  +    models/atm/cam/src/utils/cam_aqua/cpl
A  +    models/atm/cam/src/utils/cam_aqua/cpl/ocn_comp_mct.F90
A  +    models/atm/cam/src/cpl
A  +    models/atm/cam/src/cpl/atm_comp_mct.F90
A  +    models/atm/cam/src/cpl/atm_comp_esmf.F90
A  +    models/atm/cam/src/cpl/atm_import_export.F90
A  +    models/atm/cam/src/cpl/cam_cpl_indices.F90
           - Changes from the comptype branch merge

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/test_driver.sh
M       models/atm/cam/test/system/CAM_runcmnd.sh
           - Added the ability to use caldera instead of yellowstone if job initiated on caldera

M       models/atm/cam/bld/configure
           - Changes from the comptype branch merge

M       SVN_EXTERNAL_DIRECTORIES
           - Using cesm1_3_beta04 externals except for share which is using share3_130918 to get single column test to pass


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB except:

092 sc001 TSC.sh e64c5bfbiop scm_prep scm64c5bfbiop scm_b4b_o1 7s .........FAIL! rc= 6 at Tue Oct 15 00:23:51 MDT 2013
    - Not all of John Truesdale's changes made it into the driver tag.  Mariana will be updating and will be in future tag.

frankfurt/nag:all BFB:

frankfurt/pgi: all BFB:

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_14
Originator(s): fvitt
Date: 30 Sep 2013
One-line Summary: Minor corrections to aerosol code and bug fixes

Purpose of changes:

This branch isolates the answer changing corrections uncovered
during the refactoring of chemistry/aerosol interface.

Answer changing features:

 - Corrections to dust emissions to use unmodified dust fluxes
   from the coupler each time step -- in time-steps where fluxes
   from surface models were not updated modification of cam_in%cflx
   were not representations of dust flux from surface models but the
   modification of dust fluxes from the previous time-step.  For example,
   when the model advances from time step 0 to time step 1 it does not
   couple with surface models and thus does not restore cflx with dust
   fluxes from coupler.

 - Removed kludge in ChemNamelist.pm that excluded H2SO4 from the
   gas_wetdep_list namelist variable

 - Register number density tracers with qmin of 1e-5 -- this allows
   removal of special code  in uwshcu for MAM

 - Scale organic aerosol emissions off line for MAM

 - Replace obsolete sulfchem routine with some chemistry for trop_bam

 - Let chemistry output all aerosols in MMR units (kg/kg)
   and gas species in VMR units (mole/mole) regardless of
   aerosol model

 - Corrections in setsox routine for chemistry mechanisms with MAM3
   aerosols that include NH3

 - Removed kludge in the hetrxtrate routine of mo_usrrxt which was
   introduced to keep the bulk aerosol model bit-for-bit

Bugs fixed (include bugzilla ID): Bug 1824

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

D   models/atm/cam/src/chemistry/bulk_aero/sulchem.F90
 - this code is obsolete and thus was removed

List all subroutines added and what they do:

A   models/atm/cam/test/system/config_files/fmz4c5dm
A   models/atm/cam/test/system/config_files/fsf1.9c5dh
A   models/atm/cam/test/system/config_files/fprgspc4c4dm
A   models/atm/cam/test/system/config_files/fsf4c4dm
A   models/atm/cam/test/system/config_files/fst4c5dm
A   models/atm/cam/test/system/config_files/fsf1.9c4dh
A   models/atm/cam/test/system/config_files/f1.9c4carmsuldh
A   models/atm/cam/test/system/nl_files/outfrq3s_NEUwetdep
 - updates to chemistry regression tests

List all existing files that have been modified, and describe the changes:


M   models/atm/cam/bld/namelist_files/use_cases/1850-PD_cam5.xml
M   models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
M   models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp60.xml
M   models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp26.xml
M   models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam7.xml
M   models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp45.xml
M   models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp85.xml
M   models/atm/cam/bld/namelist_files/use_cases/1850_cam5.xml
M   models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam5.xml
M   models/atm/cam/bld/namelist_files/use_cases/1850_cam5_super_fast_llnl.xml
M   models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- new emissions files for MAM pom and soag
  -- the emissions MAM primary organic matter and SOA are now
     multiplied offline by a factor of 1.4

M   models/atm/cam/bld/namelist_files/namelist_definition.xml
 - removed the obsolete "use_cam_sulfchem" namelist option

M   models/atm/cam/bld/namelist_files/use_cases/1850_cam4_trop_bam.xml
 - trop_bam now needs spectral irradiance solar data for photolysis


M   models/atm/cam/bld/build-namelist
 - references to 'use_cam_sulfchem' namelist variable were moved
 - bulk aerosol model need default photolysis inputs

M   models/atm/cam/bld/perl5lib/Build/ChemNamelist.pm
 - removed the kludge that excluded H2SO4 from the gas_wetdep_list namelist variable

M   models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - for BAM include the chemistry for the aerosol precursors

M   models/atm/cam/src/physics/cam/uwshcu.F90
 - removed the special code which set trmin to 1e-5 for number density tracers
   -- this is accounted for by setting qmin to  1e-5 when the tracers
      are registered to the consistuents module

M   models/atm/cam/src/chemistry/pp_trop_bam/mo_lu_solve.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_setrxt.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_adjrxt.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_rxt_rates_conv.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/chem_mods.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_prod_loss.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_lin_matrix.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/m_rxt_id.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_phtadj.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_nln_matrix.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_lu_factor.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_sim_dat.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/mo_indprd.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/m_spc_id.F90
M   models/atm/cam/src/chemistry/pp_trop_bam/chem_mech.doc
M   models/atm/cam/src/chemistry/pp_trop_bam/chem_mech.in
 - changes to trop_bam mechanism to include chemistry for aerosol precursors
   which is needed to replace the calcuations of the obsolete sulfchem routine


M   models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
 - added wet dep diagnostics

M   models/atm/cam/src/chemistry/bulk_aero/dust_sediment_mod.F90
 - corrections to if block expressions

M   models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
 - corrections to dust emissions to use unmodified dust fluxes
   from surface models each time step -- in time-steps where fluxes
   from surface models were not updated modification of cam_in%cflx
   were not representations of dust flux from surface models but the
   modifaction of dust fluxes from the previous time-step.

M   models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - add emissions fluxes returned from set_srf_emissions to cflx
 - removed references to do_cam_sulfchem

M   models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
 - let chemistry output all aerosols in MMR units (kg/kg)
   and gas species in VMR units (mole/mole) regardless of
   aerosol model

M   models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
M   models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
 - removed special code which scaled organic aerosol emissions

M   models/atm/cam/src/chemistry/mozart/chemistry.F90
 - register number density tracers with qmin set to 1.e-5
 - removed use_cam_sulfchem from chemistry namelist

M   models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
 - removed obsolete sulfchem option

M   models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - removed a kludge in the hetrxtrate routine which was introduced to
   keep the bulk aerosol model bit-for-bit

M   models/atm/cam/src/chemistry/mozart/mo_setsox.F90
 - correction for chemistry mechanisms with MAM3 aerosols that inlucde NH3

M   models/atm/cam/src/control/camsrfexch.F90
M   models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M   models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
 - extend cam_in_t data structure for dust fluxes from surface models
 - dust fluxes from the surface models are simply copied to cam_in%dstflx
   without any modifications.  This prevents an error which happens
   when the model goes from time step 0 to time step 1, which does not
   couple with surface models and thus does not restore cflx with dust
   fluxes from coupler.

M   models/atm/cam/test/system/tests_chem_hybrid
M   models/atm/cam/test/system/input_tests_master
M   models/atm/cam/test/system/tests_chem_mpi
 - updates to chemistry regression tests

M   models/atm/cam/src/chemistry/utils/tracer_data.F90
 -- Bugzilla  Bug 1824 -- don't use cyc_ndx_beg before it is defined

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Fri Sep 27 21:51:05 MDT 2013
016 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Sep 27 22:04:01 MDT 2013
024 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Fri Sep 27 22:27:31 MDT 2013
039 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Fri Sep 27 22:42:35 MDT 2013
043 bl366 TBL.sh f1.9c5clbdh outfrq3s_clubb 9s ............................FAIL! rc= 7 at Fri Sep 27 23:00:23 MDT 2013
046 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Fri Sep 27 23:17:06 MDT 2013
051 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Sep 27 23:47:27 MDT 2013
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Fri Sep 27 23:51:43 MDT 2013
055 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Fri Sep 27 23:58:49 MDT 2013
060 bl430 TBL.sh fm1.9c5dh outfrq3s_NEUwetdep 9s ..........................FAIL! rc= 7 at Sat Sep 28 00:17:53 MDT 2013
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s+soa_chem_megan_emis 9s ..............FAIL! rc= 7 at Sat Sep 28 00:38:28 MDT 2013
079 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Sat Sep 28 01:37:52 MDT 2013
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Sat Sep 28 01:40:56 MDT 2013
090 bl997 TBL_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 7 at Sat Sep 28 02:22:09 MDT 2013
 - expected failures

092 sc001 TSC.sh e64c5bfbiop scm_prep scm64c5bfbiop scm_b4b_o1 7s .........FAIL! rc= 6 at Sat Sep 28 02:32:04 MDT 2013
 - this failed in previous tag

frankfurt/nag:

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Sep 27 16:46:11 MDT 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Sep 27 16:56:14 MDT 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Sep 27 17:04:30 MDT 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Sep 27 17:15:09 MDT 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Sep 27 17:41:33 MDT 2013
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Sep 27 17:54:59 MDT 2013
 - expected failures

frankfurt/pgi:

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Sep 27 16:46:48 MDT 2013
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Sep 27 16:56:32 MDT 2013
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Sep 27 17:02:49 MDT 2013
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Sep 27 17:10:19 MDT 2013
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Sep 27 17:27:21 MDT 2013
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Sep 27 18:02:22 MDT 2013
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Sep 27 18:27:56 MDT 2013
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Sep 27 18:39:34 MDT 2013
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Fri Sep 27 18:55:59 MDT 2013
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Fri Sep 27 19:15:26 MDT 2013
 - expected failures

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): larger than roundoff but same climate

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
    https://svn-ccsm-models.cgd.ucar.edu/cam1/branch_tags/aerofixes_cam5_3_12_tags/aerofixes01_cam5_3_12

- platform/compilers:
    yellowstone / intel

- configure commandline:
    create_newcase -case /glade/p/acd/fvitt/cesm/cases/FC5.cam5312.ne30.test.001 -compset FC5 -res ne30_ne30 -mach yellowstone

- build-namelist command (or complete namelist):
    defaults for the FC5  ne30_ne30 configuration

- MSS location of output:
    -fvitt/csm/FC5.cam5312.ne30.test.001

MSS location of control simulations used to validate new climate:
    /CCSM/csm/f.e13.FC5.ne30_ne30.test2ans.002

URL for AMWG diagnostics output used to validate new climate:
    http://webext.cgd.ucar.edu/FCLIMO/FC5.cam5312.ne30.test.001/atm/FC5.cam5312.ne30.test.001-f.e13.FC5.ne30_ne30.test2ans.002/

===============================================================
===============================================================

Tag name: cam5_3_13 
Originator(s):  cacraig
Date: 9/27/13
One-line Summary: SVN_EXTERNAL_DIRECTORIES updated to cesm1_3_beta03

Purpose of changes:
- Updated to all cesm1_3_beta03 directories
- Updated share to share3_130918 (cesm1_3_alpha04a) to fix the frankfurt single column tests
 
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: 

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       SVN_EXTERNAL_DIRECTORIES


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB except:

004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Mon Sep 23 19:10:56 MDT 2013
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Mon Sep 23 19:14:57 MDT 2013
014 bl322 TBL.sh fn1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Mon Sep 23 19:26:09 MDT 2013
020 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Mon Sep 23 19:35:35 MDT 2013
024 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Mon Sep 23 19:50:23 MDT 2013
036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Mon Sep 23 19:57:50 MDT 2013
039 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Mon Sep 23 20:05:37 MDT 2013
043 bl366 TBL.sh f1.9c5clbdh outfrq3s_clubb 9s ............................FAIL! rc= 7 at Mon Sep 23 20:23:33 MDT 2013
046 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Mon Sep 23 20:40:25 MDT 2013
051 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Mon Sep 23 21:10:38 MDT 2013
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Mon Sep 23 21:14:51 MDT 2013
055 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Mon Sep 23 21:22:02 MDT 2013
058 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Mon Sep 23 21:31:13 MDT 2013
060 bl430 TBL.sh fm1.9c5dh outfrq3s_mozEOOH 9s ............................FAIL! rc= 7 at Mon Sep 23 21:41:21 MDT 2013
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s_mozEOOH+soa_chem_megan_emis 9s ......FAIL! rc= 7 at Mon Sep 23 22:02:19 MDT 2013
067 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Mon Sep 23 22:13:31 MDT 2013
070 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Mon Sep 23 22:16:13 MDT 2013
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Mon Sep 23 22:33:18 MDT 2013
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Mon Sep 23 23:04:53 MDT 2013
087 bl992 TBL_ccsm.sh f19_g16 ETEST 2d ....................................FAIL! rc= 7 at Mon Sep 23 23:31:36 MDT 2013
     - Changes expected due to Tony's coupler changes

092 sc001 TSC.sh e64c5bfbiop scm_prep scm64c5bfbiop scm_b4b_o1 7s .........FAIL! rc= 6 at Mon Sep 23 23:54:57 MDT 2013
     - John Truesdale investigated and has proposed a temporary fix which will most likely be in the next tag.  This
       test runs to completion but fails in the comparison test with a regular CAM run. 

frankfurt/nag:all BFB except:

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Sep 23 17:08:08 MDT 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Sep 23 17:15:03 MDT 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Sep 23 17:21:44 MDT 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Mon Sep 23 17:31:52 MDT 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Mon Sep 23 17:59:27 MDT 2013
030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Sep 23 18:09:20 MDT 2013
035 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Mon Sep 23 18:22:32 MDT 2013
     - Changes expected due to Tony's coupler changes

frankfurt/pgi: all BFB except:

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Sep 23 17:12:03 MDT 2013
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Sep 23 17:21:52 MDT 2013
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Sep 23 17:35:36 MDT 2013
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Mon Sep 23 17:55:59 MDT 2013
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Mon Sep 23 18:32:05 MDT 2013
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Sep 23 18:45:53 MDT 2013
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Mon Sep 23 18:52:03 MDT 2013
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Sep 23 19:09:22 MDT 2013
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Mon Sep 23 19:16:29 MDT 2013
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Mon Sep 23 19:19:22 MDT 2013
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Mon Sep 23 19:26:45 MDT 2013
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Mon Sep 23 19:46:08 MDT 2013
     - Changes expected due to Tony's coupler changes

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_12
Originator(s): santos
Date: 2013/09/22
One-line Summary: Fix radiation bug, change SE dycore to run with Pa.

Purpose of changes:

 - Fix a bug in cloud_rad_props, which was rounding down in a table lookup
rather than interpolating between table values, due to declaring an integer
rather than a real as the interpolation weight.

 - Change the dycore to use units of Pa instead of hPa, to remove the need
for a conversion and prevent future bugs.

 - Fix minor precision issues, where complex numbers were constructed in
single precision when double was intended.

 - Add clarification to error message in modal_aer_opt.

Bugs fixed (include bugzilla ID):

#1794 - Interpolation in cloud_rad_props is less precise than originally
        intended.
#1797 - CMPLX has wrong precision in several places

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - Update HOMME external to use Pa instead of hPa.

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
         - Clarify that do_circulation_diags must be set to .true. for QBO
           forcing to work in WACCM.

M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/physics/cam/phys_prop.F90
         - Add explicit kind to calls of the intrinsic "cmplx", to ensure
           that it returns a complex number with double-precision
           components.

M       models/atm/cam/src/control/interpolate_data.F90
         - Add parameters corresponding to the extrap_method values, so
           that callers can use named constants rather than bare ints.

M       models/atm/cam/src/dynamics/se/dp_coupling.F90
M       models/atm/cam/src/dynamics/se/dyn_comp.F90
M       models/atm/cam/src/dynamics/se/gravity_waves_sources.F90
M       models/atm/cam/src/dynamics/se/inidat.F90
M       models/atm/cam/src/dynamics/se/stepon.F90
         - Remove conversions to hPa (factors of 100._r8).

M       models/atm/cam/src/dynamics/se/spmd_dyn.F90
         - Remove unnecessary use statement.

M       models/atm/cam/src/physics/cam/micro_mg1_0.F90
M       models/atm/cam/src/physics/cam/micro_mg1_5.F90
         - Very slightly reduce the max value of lambda_c so that it will
           always fall within the limits of the table in RRTMG.

M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
         - Clarify error message for unreasonable optical depth, and abort
           when optical depth is negative.
         - Make calls to cmplx return double precision values.

M       models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
         - Use lininterp to do interpolation of lookup tables, instead of
           using (buggy) custom code.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Sep 17 21:30:18 MDT 2013
014 bl322 TBL.sh fn1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Tue Sep 17 21:41:45 MDT 2013
016 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Sep 17 21:43:22 MDT 2013
024 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue Sep 17 22:06:07 MDT 2013
039 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Tue Sep 17 22:20:49 MDT 2013
043 bl366 TBL.sh f1.9c5clbdh outfrq3s_clubb 9s ............................FAIL! rc= 7 at Tue Sep 17 22:38:58 MDT 2013
046 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Tue Sep 17 22:56:00 MDT 2013
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue Sep 17 23:30:24 MDT 2013
060 bl430 TBL.sh fm1.9c5dh outfrq3s_mozEOOH 9s ............................FAIL! rc= 7 at Tue Sep 17 23:57:06 MDT 2013
076 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Wed Sep 18 00:56:25 MDT 2013
079 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Wed Sep 18 01:18:00 MDT 2013
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Wed Sep 18 01:21:15 MDT 2013
084 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Wed Sep 18 01:42:23 MDT 2013
090 bl997 TBL_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 7 at Wed Sep 18 02:01:53 MDT 2013

frankfurt/nag:

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Sep 17 15:03:31 MDT 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Sep 17 15:10:17 MDT 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Sep 17 15:17:04 MDT 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Sep 17 15:27:32 MDT 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Sep 17 15:52:56 MDT 2013
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Tue Sep 17 16:05:17 MDT 2013

frankfurt/pgi or jaguar/pgi: 

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Sep 17 15:07:17 MDT 2013
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Sep 17 15:16:57 MDT 2013
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Sep 17 15:23:06 MDT 2013
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Sep 17 15:30:41 MDT 2013
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Sep 17 15:47:50 MDT 2013
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Sep 17 16:22:59 MDT 2013
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Tue Sep 17 16:48:32 MDT 2013
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Sep 17 16:59:13 MDT 2013
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Tue Sep 17 17:06:27 MDT 2013
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Tue Sep 17 17:09:30 MDT 2013
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Tue Sep 17 17:16:29 MDT 2013
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Tue Sep 17 17:36:04 MDT 2013
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Tue Sep 17 18:14:35 MDT 2013

  CAM-5 changes answers due to bug fixes, CAM-SE due to units change. This
accounts for all failed baselines.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

  All CAM-SE cases, and all CAM5 (specifically due to RRTMG, MG, and MAM
  changes).

- what platforms/compilers:

  All.

- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

  The pressure unit change and the cmplx changes are at or below single
  precision roundoff. RRTMG is larger than roundoff and climate changing.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):

https://svn-ccsm-models.cgd.ucar.edu/cam1/branch_tags/
  santos_answer_changes_tags/santos_answer_changes_n01_cam5_3_08

- platform/compilers:

  yellowstone/intel

- configure commandline:

  Default FC5 ne30_ne30 run.

- build-namelist command (or complete namelist):

  Default FC5 ne30_ne30 run.

- MSS location of output:

  /CCSM/csm/f.e13.FC5.ne30_ne30.test2ans.002

MSS location of control simulations used to validate new climate:

  /CCSM/csm/f.e13.FC5.ne30_ne30.ctl_ans.001 

URL for AMWG diagnostics output used to validate new climate:

Comparison of an earlier version with the RRTMG bug fix to control:

http://webext.cgd.ucar.edu/FCLIMO/f.e13.FC5.ne30_ne30.test2ans.001/atm/
        f.e13.FC5.ne30_ne30.test2ans.001-f.e13.FC5.ne30_ne30.ctl_ans.001/

Comparison of this tag to the earlier version mentioned above:

http://webext.cgd.ucar.edu/FCLIMO/f.e13.FC5.ne30_ne30.test2ans.002/atm/
        f.e13.FC5.ne30_ne30.test2ans.002-f.e13.FC5.ne30_ne30.test2ans.001/ 

Comparison of this tag to observations:

http://webext.cgd.ucar.edu/FCLIMO/f.e13.FC5.ne30_ne30.test2ans.002/atm/
        f.e13.FC5.ne30_ne30.test2ans.002-obs/

===============================================================
===============================================================

Tag name: cam5_3_11 
Originator(s):  cacraig
Date: 9/17/13
One-line Summary: Corrected SVN_EXTERNAL_DIRECTORIES to match cam5_3_09 version

Purpose of changes:
- Corrected the SVN_EXTERNAL_DIRECTORIES file which inadvertently was checked in with an older version
 
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: 

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       SVN_EXTERNAL_DIRECTORIES


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB

frankfurt/nag:all BFB 

frankfurt/pgi: all BFB


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_10 
Originator(s): tcraig, cacraig
Date: 9/06/13
One-line Summary: Tony's coupler changes

Purpose of changes:
- CAM trunk tag for merge of https://svn-ccsm-models.cgd.ucar.edu/cam1/branch_tags/cplupa_tags/cplupa_n01_cam5_3_09
     From Tony's notes:
     - modify intents on init/run/finalize coupling interfaces
     - add ifdef USE_ESMF_METADATA arouind esmf attribute calls
     - modify mkatmsrffile.F90 to account fo changes in shr_mct_sMatPInitnc interface
- Removed all mergeinfo files except the root
 
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton, andrew

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/tools/mkatmsrffile/mkatmsrffile.F90
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/doc/ChangeLog
M       models/atm/cam/src/utils/cam_dom/cpl_mct/ocn_comp_mct.F90
M       models/atm/cam/src/utils/cam_aqua/cpl_mct/ocn_comp_mct.F90
M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
M       SVN_EXTERNAL_DIRECTORIES
          - merge to Tony's cplupa branch

property 'svn:mergeinfo' deleted from 'models/atm/cam'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/test/system/tests_pretag_frankfurt_pgi'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/test/system/TCB_ccsm.sh'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/test/system/tests_posttag_frankfurt'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/configure'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/Makefile.in'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/config_files/definition.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/namelist_files/namelist_definition.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_strat_soa.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam3.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam7.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/namelist_files/use_cases/soa_chem_megan_emis.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_moz_mam3.xml'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/bld/build-namelist'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/control/camsrfexch.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/cpl_share/cam_cpl_indices.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/cpl_mct/atm_comp_mct.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/cam/comsrf.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/cam/micro_mg_cam.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/cam/wv_sat_methods.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/cam/micro_mg1_0.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/cam/microp_driver.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/cam/wv_saturation.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/cam/uwshcu.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/physics/rrtmg/radsw.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/dynamics/se/dp_coupling.F90'.
property 'svn:mergeinfo' deleted from 'models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90'.
         - files which had mergeinfo removed


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB

frankfurt/nag:all BFB 

frankfurt/pgi: all BFB except
060 sm991 TSM_ccsm.sh f19_f19 F 2d ........................................FAIL! rc= 6 at Thu Sep  5 18:11:33 MDT 2013
061 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 4 at Thu Sep  5 18:11:33 MDT 2013

Jay agreed that it made sense to check in cam5_3_10 with this failure and discover the solution during CESM testing


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_09 
Originator(s): cacraig
Date: 8/30/13
One-line Summary: minor microphysics rearrangement and cleanup

Purpose of changes:
- Moved calculation of in-cloud water values for radiation into cloud_diagnostics
- Moved calls for micro_mg_tend back to inline instead of being contained at end of module
- Simplified the calling list for conv_water_4rad
- Moved a handful pbuf_add_field, outfld and addfld calls to modules where data is being set
- Renamed pbuf_times to dyn_time_lvls and itim to itim_old.  These values should only be
  used for leap-frogging times. 
- cmeliq is now a member of pbuf and not passed on calling lists
- Removed effi, effc, effc_fn, effliq, effice and effliq_fn variables as they were exact copies
  of rei, rel and rel_fn and were redundant inside micro_mg_cam.F90
 
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton, andrew

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/src/control/cam_history.F90
          - added trim to string for calendar

M       models/atm/cam/src/physics/cam/cloud_diagnostics.F90
          - Contains the conv_rad_4rad call and associated calculations for radiation using mg physics

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
          - Moved in-cloud water calculations which are specific for radiation to cloud_diagnostics
          - Moved calls for micro_mg_tend back to inline instead of being contained at end of module
          - Moved a number of pbuf_add_field and addfld calls to modules where data is being set
          - Removed effi, effc, effc_fn, effliq, effice and effliq_fn variables as they were exact copies
            of rei, rel and rel_fn and were redundant

M       models/atm/cam/src/physics/cam/clubb_intr.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/microp_driver.F90
          - cmeliq is now added to pbuf

M       models/atm/cam/src/physics/cam/conv_water.F90
          - simplified calling list for conv_water_4rad
          - addfld calls moved from micro_mg_cam

M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/cloud_fraction.F90
M       models/atm/cam/src/physics/cam/convect_deep.F90
          - pbuf_add_field, addfld and outfld call(s) moved from micro_mg_cam


M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/cam/flux_avg.F90
M       models/atm/cam/src/physics/cam/check_energy.F90
M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
M       models/atm/cam/src/physics/cam/radiation_data.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
M       models/atm/cam/src/physics/rrtmg/ebert_curry.F90
M       models/atm/cam/src/physics/rrtmg/oldcloud.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
M       models/atm/cam/src/physics/rrtmg/slingo.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_neu_wetdep.F90
          - Rename of pbuf_times to dyn_time_lvls and itim to itim_old


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all BFB

frankfurt/nag:all BFB (mc111 failed on first try due to mangled log file due to multiprocessing)  Passed on second try

frankfurt/pgi: all BFB

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

    Inside micro_mg_cam: calculation of tgliqwp now uses iclwpst instead of iclwp.  This changes answers for 
    the diagnostic variables APRL, PE and PEFRAC. No regression tests show any changes.
  

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_08
Originator(s): santos
Date: 2013/08/29
One-line Summary: Fix NAG, CESM scripts with Frankfurt/PGI, serial CAM-SE

Purpose of changes:

 - Fix the NAG port, since the RRTMG changes were temporarily reverted to
   fix a bug on big-endian systems (e.g. Mira).

 - Pull in an updated Machines tag so that the CESM scripts can run with
   PGI on Frankfurt.

 - Have CAM tests use PGI 13.7 on Frankfurt, and change compiler flags, to
   match the new Machines tag.

 - Fix HOMME when SPMD is not defined, so that it will work with
   mpi-serial.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

 - The "-Mvect=nosse" option is no longer used for PGI, because SSE
   vectorization has been safe for a while now, and because Machines has
   made the same change.

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
         - New Machines tag with Frankfurt/PGI update.

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - New COSP and RRTMG tags, compatible with NAG, and with a
           big-endian system fix.

M       models/atm/cam/bld/Makefile.in
         - Remove -Mvect=nosse option from PGI builds.

M       models/atm/cam/src/control/runtime_opts.F90
         - Fix spelling error in abort message.

M       models/atm/cam/src/dynamics/se/dyn_comp.F90
M       models/atm/cam/src/dynamics/se/native_mapping.F90
M       models/atm/cam/src/dynamics/se/pmgrid.F90
         - Fix the SE dycore when SPMD is not defined (mpi-serial).
         - Add "implicit none" to pmgrid, since "iam" and "masterproc"
           were getting implicit types.

M       models/atm/cam/test/system/TCB_ccsm.sh
         - Put the CESM build in a directory called "bld", following
           convention.

M       models/atm/cam/test/system/test_driver.sh
         - Change the version of PGI used on Frankfurt to 13.7.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS.

frankfurt/nag: All PASS.

frankfurt/pgi or jaguar/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

For NAG only, change

Summarize any changes to answers, i.e.,
- what code configurations:

  CAM standalone builds only.

- what platforms/compilers:

  PGI, only with optimization on.

- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

  Roundoff.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

  The difference is due to a compiler optimization change, which should be
  no worse than roundoff.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_07 
Originator(s): fischer, fvitt
Date: Mon Aug  5 15:10:54 MDT 2013
One-line Summary: flbc_list namelist logic update, rrtmg reverted for mira

Purpose of changes:
.  SVN external updates
  -   Reverted rrtmg tag to previous tag due to a big endian bug caused by 
      a fix to get the NAG compiler to work.  This was causing large errors in 
      the energy balance.
  -   Updated homme external to fix threading issues on bluegene systems
  -   Updated component tags to match cesm1_3_beta01
.  Update to how flbc_list is set in namelist
.  Added new scenario_ghg called CHEM_LBC_FILE to indicate when values are being
   set from flbc_file. 
 
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer, eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
.  Update homme, and reverted rrtmg tag

M       SVN_EXTERNAL_DIRECTORIES
.  Updated externals to match cesm1_3_beta01

M       models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_chem.xml
.  Removed flbc_list since this is the default being set in build-namelist

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_chem.xml
M       models/atm/cam/bld/build-namelist
M       models/atm/cam/src/physics/cam/chem_surfvals.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/chemistry/utils/mo_flbc.F90
.  Updates to the way flbc_list is being handled
   Added new scenario_ghg called CHEM_LBC_FILE


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all passed

frankfurt/nag:
001 sm111 TSM.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 8 at Fri Aug  2 11:56:12 MDT 2013
002 er111 TER.sh e8c5t5mdm ttrac 4+5s .....................................FAIL! rc= 5 at Fri Aug  2 11:56:12 MDT 2013
003 br111 TBR.sh e8c5t5mdm ttrac 6+3s .....................................FAIL! rc= 5 at Fri Aug  2 11:58:17 MDT 2013
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 4 at Fri Aug  2 11:58:17 MDT 2013
005 mc111 TMC.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 4 at Fri Aug  2 11:58:17 MDT 2013
006 dd111 TDD.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 4 at Fri Aug  2 11:58:17 MDT 2013
007 sm112 TSM.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 8 at Fri Aug  2 12:03:02 MDT 2013
008 er112 TER.sh e8c5dm ghgrmp 4+5s .......................................FAIL! rc= 5 at Fri Aug  2 12:03:02 MDT 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 4 at Fri Aug  2 12:03:02 MDT 2013
010 sm114 TSM.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 8 at Fri Aug  2 12:05:18 MDT 2013
011 er114 TER.sh e8c5dm co2rmp 4+5s .......................................FAIL! rc= 5 at Fri Aug  2 12:05:18 MDT 2013
012 br114 TBR.sh e8c5dm co2rmp 6+3s .......................................FAIL! rc= 5 at Fri Aug  2 12:07:30 MDT 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 4 at Fri Aug  2 12:07:30 MDT 2013
014 sm311 TSM.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 8 at Fri Aug  2 12:12:34 MDT 2013
015 er311 TER.sh f10c5t5mdm ttrac 4+5s ....................................FAIL! rc= 5 at Fri Aug  2 12:12:34 MDT 2013
016 br311 TBR.sh f10c5t5mdm ttrac 6+3s ....................................FAIL! rc= 5 at Fri Aug  2 12:15:18 MDT 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 4 at Fri Aug  2 12:15:19 MDT 2013
018 mc311 TMC.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 4 at Fri Aug  2 12:15:19 MDT 2013
019 eq301 TEQ.sh f10c5t5mdm ttrac f10c5t5mdm ttrac_lb1 4s .................FAIL! rc= 4 at Fri Aug  2 12:17:47 MDT 2013
020 eq302 TEQ.sh f10c5t5mdm ttrac f10c5t5mdm ttrac_lb2 4s .................FAIL! rc= 4 at Fri Aug  2 12:17:47 MDT 2013
021 eq303 TEQ.sh f10c5t5mdm ttrac f10c5t5mdm ttrac_lb3 4s .................FAIL! rc= 4 at Fri Aug  2 12:17:48 MDT 2013
022 eq304 TEQ.sh f10c5t5mdm ttrac f10c5dm no_ttrac 4s .....................FAIL! rc= 4 at Fri Aug  2 12:17:48 MDT 2013
023 sm312 TSM.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 8 at Fri Aug  2 12:23:00 MDT 2013
024 er312 TER.sh f2.5c5dm ghgrmp 4+5s .....................................FAIL! rc= 5 at Fri Aug  2 12:23:01 MDT 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 4 at Fri Aug  2 12:23:01 MDT 2013
031 sm316 TSM.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 8 at Fri Aug  2 12:35:53 MDT 2013
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 4 at Fri Aug  2 12:35:53 MDT 2013
036 sc003 TSM.sh scmc5armiop scmarm 7s ....................................FAIL! rc= 8 at Fri Aug  2 12:50:32 MDT 2013
. cam5 tests are expected to fail because the rrtmg external was reverted to an earlier version that has an overflow
  error that NAG catches.

frankfurt/pgi: 
060 sm991 TSM_ccsm.sh f19_f19 F 2d ........................................FAIL! rc= 6 at Fri Aug  2 16:32:14 MDT 2013
061 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 4 at Fri Aug  2 16:32:14 MDT 2013
. expected, CESM scripts are not working with current setup on frankfurt

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_06
Originator(s): santos, fischer
Date: 2013/07/21
One-line Summary: Gravity wave refactoring, remove WACCM_PHYS CPP macro.

Purpose of changes:

 - Remove WACCM_PHYS CPP macro (and the equivalent "do_waccm_phys"
   function) in favor of more specific physics options.

 - Merge CAM and WACCM gravity wave modules and split the result into
   smaller, mostly portable modules.

 - Make WACCM modules read their own namelists.

 - Move uzm and frontgf/frontga from physics_state to the physics buffer,
   since they are not treated the same as other physics_state variables and
   introduce unnecessary complication into physics_types.

 - Remove Lahey support, since new code in this tag uses Fortran 2003
   features.

Bugs fixed (include bugzilla ID):

 - Due to a unit mismatch between CAM and HOMME, WACCM-SE was using a
   frontogenesis function that was ~14x too large.

 - Fix some namelist values in 1850_cam5_pm.xml that had yellowstone paths
   hard-coded (h/t Chris Fischer).

Describe any changes made to build system:

Describe any changes made to the namelist:

 - New history_waccm flag, for turning on common outputs for WACCM runs.
   Implementation of this flag is incomplete and should be considered a
   work in progress.

 - Three new namelist variables, use_gw_oro, use_gw_front, and
   use_gw_convect, are provided to turn on the three types of gravity wave
   sources currently used in CAM and WACCM.

 - Several previously hard-coded parameters were added to gw_drag_nl.

 - New namelist variables "do_molec_press" and "molec_diff_bot_press"
   determine whether molecular diffusion is on, and the bottom level where
   it will take place, respectively.

 - Existing namelist variables have been moved from cam_inparm to qbo_nl,
   radheat_nl, and iondrag_nl.

 - New namelist settings for WACCM-SE with vertically Lagrangian advection.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

D       models/atm/cam/test/system/tests_pretag_frankfurt_lahey
         - Lahey support dropped. (Current NAG test list is identical.)

List all subroutines added and what they do:

A       models/atm/cam/src/physics/cam/qbo.F90
         - Stub version of QBO module.

A       models/atm/cam/src/physics/cam/vdiff_lu_solver.F90
         - Contains vd_lu_decomp and vd_lu_solve, so this code can be
           shared rather than duplicated between diffusion_solver and
           gw_drag. These are also modified so that the output of
           vd_lu_decomp is contained in an object of type "lu_decomp",
           which can then be fed back to vd_lu_solver directly.

A       models/atm/cam/test/system/config_files/h30c4wgdm
A       models/atm/cam/test/system/config_files/wg4c4dm
A       models/atm/cam/test/system/nl_files/outfrq3s_wse
         - Files to test SC-WACCM-SE, and SC-WACCM's use_case.

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/build-namelist
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
         - Add history_waccm namelist option.
         - Add new molecular diffusion pressures to namelist.
         - Add new gw_drag namelist variables.
         - Move namelist variables out of cam_inparm.
         - Modify SC-WACCM-SE settings (experimental settings for
           vertically Lagrangian advection).

M       models/atm/cam/bld/namelist_files/use_cases/1850_cam5_pm.xml
         - Remove hard-coded glade paths.

M       models/atm/cam/doc/ChangeLog_template
M       models/atm/cam/test/system/archive_baseline.sh
M       models/atm/cam/test/system/gen_test_table.sh
M       models/atm/cam/bld/run-pc.csh
M       models/atm/cam/bld/configure
M       models/atm/cam/bld/Makefile.in
M       models/atm/cam/bld/config_files/definition.xml
M       models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
M       models/atm/cam/src/physics/cam/phys_grid.F90
         - Remove Lahey support.
         - Remove some workarounds for and mentions of Lahey.

M       models/atm/cam/src/control/runtime_opts.F90
         - Have qbo, radheat, and iondrag read their own namelists.
         - Call waccm_forcing_readnl from within radheat_readnl.

M       models/atm/cam/src/control/sat_hist.F90
         - Use global save statement instead of saving an individual
           variable.

M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
M       models/atm/cam/src/dynamics/fv/dyn_comp.F90
M       models/atm/cam/src/dynamics/se/gravity_waves_sources.F90
M       models/atm/cam/src/dynamics/se/dp_coupling.F90
M       models/atm/cam/src/dynamics/se/dyn_comp.F90
M       models/atm/cam/src/dynamics/se/stepon.F90
         - Set WACCM variables in the physics buffer rather than
           physics_state.
         - Replace "do_waccm_phys" with flags specific to the qbo and
           gw_drag modules.
         - Sometimes frontgf was handled before frontga, and sometimes vice
           versa. This made it too easy to mix them up, so move frontgf
           before frontga in all these cases.
         - Fix bug where WACCM-SE was using a too-large frontogenesis
           function.

M       models/atm/cam/src/physics/cam/convect_deep.F90
         - Remove do_waccm_phys in favor of querying for presence of pbuf
           field.
         - Change name of "ZMDT" to "TTEND_DP" in the physics buffer.

M       models/atm/cam/src/physics/cam/diffusion_solver.F90
         - Pull LU solver routines out into the portable module named
           vdiff_lu_solver. This is the only dependency of
           diffusion_solver, so it is effectively portable in that sense.
           Portability is still limited by the fact that it must be passed
           routines with very specific interfaces for molecular diffusion.
         - Update interfaces for compute_molec_diff and the vd_lu_*
           routines.

M       models/atm/cam/src/physics/cam/iondrag.F90
         - Harmonize stub module with WACCM version and make calls to its
           routines non-fatal (so we don't need WACCM_PHYS to determine
           whether or not to call it).

M       models/atm/cam/src/physics/cam/molec_diff.F90
M       models/atm/cam/src/physics/cam/ref_pres.F90
         - Have ref_pres find molecular diffusion levels, rather than
           molec_diff.
         - Change the way ref_pres calculates levels, to guarantee that a
           "top" level is not too high and a "bottom" level is not too low.
         - Return information about the interpretation of kvt from
           compute_molec_diff, so that diffusion_solver no longer has to
           use "waccmx_is".
         - Use the new lu_decomp type for compatibility with
           vdiff_lu_solver.

M       models/atm/cam/src/physics/cam/phys_control.F90
         - Add WACCM history flag.
         - Add use_gw_* flags to specify which gravity wave sources are on.

M       models/atm/cam/src/physics/cam/physics_types.F90
         - Remove uzm, frontgf, and frontga from physics_state objects.
         - Allow ZM to use a different name from convect_deep.

M       models/atm/cam/src/physics/cam/physpkg.F90
         - Since exbdrift is only used directly by iondrag, move the call
           to exbdrift_register into iondrag as well.
         - Change gw_drag interfaces.
         - Remove "#ifdef WACCM_PHYS" statements.
         - Pass pbuf to qbo_relax, since UZM is now in pbuf.
         - Call WACCM physics routines in the same order throughout.

M       models/atm/cam/src/physics/cam/radheat.F90
         - Add stub namelist read to replace defaultopts and setopts.

M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
         - Don't advertise gravity wave drag as "coming soon" in the
           comments.
         - Use a utility function in ref_pres to set ntop_eddy.
         - Use history_waccm to switch on add_default calls.
         - Account for changes in molec_diff and diffusion_solver
           interfaces.

M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
         - Change ptend%name from "convect_deep" to "zm_conv_tend".

M       models/atm/cam/src/physics/waccm/iondrag.F90
         - Have iondrag handle its own namelist.
         - Move in register logic from physpkg.

M       models/atm/cam/src/physics/waccm/qbo.F90
         - Have qbo handle its own namelist.
         - Get uzm from physics buffer.

M       models/atm/cam/src/physics/waccm/radheat.F90
         - Have radheat handle its own namelist.
         - radheat calls waccm_forcing_readnl.

M       models/atm/cam/src/physics/waccm/waccm_forcing.F90
         - Change null filename (no effect, done just to be consistent with
           QBO).

M       models/atm/cam/src/physics/waccmx/majorsp_diffusion.F90
         - Get molecular diffusion levels from ref_pres, not molec_diff.

M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
         - Fix spelling error.

M       models/atm/cam/test/system/input_tests_master
         - Add tests for WACCM-SE and tests that exercise the
           waccm_sc_2000_cam4 use_case.

M       models/atm/cam/test/system/CAM_compare.sh
         - Fix bug where fields with small differences would not be printed
           to the log after a comparison failure.

M       models/atm/cam/test/system/TCB_ccsm.sh
         - Allow compiler names to be specified as part of machine names
           (e.g. "frankfurt_nag").
         - Turn repetitive blocks into loops.

M       models/atm/cam/test/system/input_tests_master
         - Add SC-WACCM tests, including with the SE dycore.

M       models/atm/cam/test/system/test_driver.sh
         - Change walltime limit on Frankfurt so that setting
           CAM_BATCHQ="short" will work.
         - Remove Lahey section.

Changes to the gravity waves:

M       models/atm/cam/src/physics/cam/gw_drag.F90
D       models/atm/cam/src/physics/waccm/gw_drag.F90
A       models/atm/cam/src/physics/cam/gw_common.F90
A       models/atm/cam/src/physics/cam/gw_convect.F90
A       models/atm/cam/src/physics/cam/gw_diffusion.F90
A       models/atm/cam/src/physics/cam/gw_front.F90
A       models/atm/cam/src/physics/cam/gw_oro.F90
A       models/atm/cam/src/physics/cam/gw_utils.F90

Highlights of the refactoring:

    - Merge WACCM and CAM modules.

    - Use history_waccm to switch on add_default calls.

    - Eliminate dead code, including an old spectral wave source from CAM's
      version of gw_drag and a buggy implementation of low level stress
      divergence.

    - Set previously hard-coded parameters via namelist.

    - Change names of gw_inti and gw_intr to gw_init and gw_tend.

    - Move the gravity wave source routines into separate modules
      (gw_convect, gw_front, and gw_oro), which are turned on or off via
      the phys_control namelist.

    - Homogenize and simplify code for the three gravity wave sources,
      to simplify the process of adding new sources in the future.

    - Separate addfld/outfld calls from other code, and move gravity
      wave drag profile routines into a portable layer (gw_common).

    - Separate diffusion routines into a separate module from
      gw_common, called gw_diffusion, using the new vdiff_lu_solver
      module to share code with diffusion_solver.

    - Create a module for common vector operations (gw_utils).

    - Fix UTGWORO, VTGWORO, and TTGWORO to more accurately reflect the
      wind and temperature tendencies from orographic gravity waves.

    - Use cpairv rather than cpair (for consistency in WACCM-X).

    - Reorder loops to access memory in order and contiguously, and
      only calculate the LU decomposition once for diffusion due to
      gravity wave breaking, as diffusion_solver already does. These
      two optimizations reduce the total cost of spectral gravity
      waves by >40% (Yellowstone/ifort). Most of this gain is due to
      loop reordering, but it's unclear how much of the benefit was
      due to vectorization vs. more efficient cache use. In loops where the
      level bounds varied by column for the Beres scheme, this was handled
      mostly by masking assignments (where statements).

    - Change most arrays from size pcols to size ncol. This cleans up
      the code slightly because array operations no longer need an
      explicit bound (e.g. "src_level(:ncol)"), but there was no
      significant effect on computation time.

    - Purely orographic waves have taken a performance hit (roughly double
      the cost), but still only represent about 0.1% of the total cost of
      CAM5. This cost seems to be primarily the result of changes to
      gw_drag_prof, which needs more per-column level indices for the Beres
      scheme.

    - Miscellaneous cleanup, e.g. limiting lines to <=80 characters, and
      re-ordering arguments in interfaces.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Sun Jul 21 14:24:03 MDT 2013
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Sun Jul 21 16:35:21 MDT 2013

Changes to diagnostic output only, as UTGWORO and VTGWORO have been fixed
to match the actual wind tendencies from orographic gravity waves.

frankfurt/nag:

030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Sun Jul 21 12:55:40 MDT 2013

frankfurt/pgi or jaguar/pgi:

036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Sun Jul 21 13:44:29 MDT 2013
060 sm991 TSM_ccsm.sh f19_f19 F 2d ........................................FAIL! rc= 6 at Sun Jul 21 15:34:49 MDT 2013
061 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 4 at Sun Jul 21 15:34:49 MDT 2013

The bl314 tests failed because the old files used for WACCM at 10x15 have a
different vertical grid, and so some pressure limiters are now rounded to
a different level due to changes in ref_pres. This has no impact on current
WACCM cases.

The CESM tests on Frankfurt failed because of machine issues that have
temporarily broken the CESM port.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: WACCM
- what platforms/compilers: All
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

  - For WACCM-FV, larger than roundoff changes for diagnostic output only
    (UTGWORO and VTGWORO). The climate and all other diagnostics should be
    bit-for-bit.

  - For WACCM-SE, a climate-changing bug fix for the frontogenesis
    function.

  - Some old WACCM files, such as the default for 10x15 resolution, use
    different pressure levels than more current files. The tropospheric
    cloud physics top level was changed for these cases due to the change
    in ref_pres. This showed up in SC-WACCM testing but does not affect
    current, supported WACCM cases, as demonstrated by a test of SC-WACCM
    on FV at a resolution of 4x5 degrees.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_05 
Originator(s): fischer, cacraig, santos
Date: Tue Jul 2nd, 2013
One-line Summary: COSP build fix for CESM, CLUBB threading fix,
                  namelist updates

Purpose of changes:
.  The COSP build was broken when using cesm scripts with the latest
   cesm tags.  This is now fixed.

.  CLUBB was giving different answers when the number of threads are
   changed.  This is mostly fixed, except for when clubb_history is true.
   When clubb_history is true and the number of threads is > 1, then 
   build-namelist exits with an error message.

.  Namelist updates for flbc_file and bndtvs.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
. configure was refactored so cesm scripts build COSP in a separate library
  the same way cam stand alone does.  cosp_libdir is a new option for configure,
  this is the directory the COSP library will be built.  

Describe any changes made to the namelist:
. Updates for bndtvs and flbc_file

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/nl_files/outfrq3s_clubb
. Removed clubb_history from clubb test.

M       models/atm/cam/test/system/input_tests_master
. Turned on threading for clubb test.

M       models/atm/cam/bld/cam.buildnml.csh
. Pass cosp_libdir when configure is invoked.

M       models/atm/cam/bld/configure
. Check for CLUBB threading was removed.
. cosp_libdir is a new variable that can be passed into configure
. Refactored so cesm scripts build COSP in a separate library the
  same way cam stand alone does.

M       models/atm/cam/bld/Makefile.in
. Add -liomp5 for clubb threading.

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. Updated fpftcon and bndtvs files to match cesm.

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
. Fix documentation for COSP.

M       models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
. Updated bndtvs files

M       models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam3.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_chem.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam7.xml
M       models/atm/cam/bld/namelist_files/use_cases/cam4_trop_strat_chem.xml
M       models/atm/cam/bld/namelist_files/use_cases/cam5_trop_strat_chem.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1955-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_cam4_nuclear_winter.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam5.xml
M       models/atm/cam/bld/namelist_files/use_cases/cam4_chem_radpsv_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
. Updated flbc_file (from santos)

M       models/atm/cam/bld/build-namelist
. Add an exit if threading and clubb_history is true.  This combination isn't thread 
  safe.

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. Update clubb external for threading fix

M       models/atm/cam/src/physics/cam/clubb_intr.F90
. CLUBB threading and cmeliq fix.

M       models/atm/cam/src/physics/cam/physpkg.F90
. Add cmeliq to call the clubb_tend_cam.

M       models/atm/cam/src/physics/cam/micro_mg1_0.F90
. Fixes for CLUBB threading.

M       SVN_EXTERNAL_DIRECTORIES
. Updated machines tag to fix cosp cesm build.



If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
043 bl366 TBL.sh f1.9c5clbdh outfrq3s_clubb 9s ............................FAIL! rc= 7 at Tue Jul  2 14:07:28 MDT 2013
.  New test

053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue Jul  2 14:07:33 MDT 2013
067 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Tue Jul  2 14:07:38 MDT 2013
.  New bndtvs files change answers

frankfurt/lf95: all passed 

frankfurt/nag: all passed

frankfurt/pgi: all passed 

===============================================================
===============================================================

Tag name: cam5_3_04
Originator(s): santos, cbardeen, jedwards, pel, goldy
Date: 2013/06/11
One-line Summary: Answer-changing fixes and cleanup, NAG port fixes

Purpose of changes:

 Fix a bug that caused cases with interactive chemistry involving the CLY
 and BRY families to crash within a few years.

 Fix a race condition when using WACCM-SE with threading.

 Collect answer-changing code cleanup in one tag:

  - Remove references to "nonintrinsic" functions, which were
    provided only to preserve answers during the NAG port. Unit
    tests have verified that nonintrinsic and intrinsic versions
    of these functions match to within roundoff error in most cases
    (the exceptions involve large arguments to the gamma function,
    which are not needed by CAM, or gfortran, which has a less
    accurate library).

  - Remove a switch in pkg_cldoptics that caused a pointless
    difference between WACCM and CAM cases (the do_waccm_phys switch
    and the WACCM_PHYS macro will likely be removed entirely soon).

  - Change hard-coded physical constants in chemistry to use
    physconst (directly, or through mo_constants).

  - Remove dead code and change r4 to r8 in modal_aero_coag.

 Fix regressions with the NAG port and get it working out of the box.

 More bug fixes from various sources:
  - Fix broken Darwin build (from Chuck Bardeen).
  - Fix multi-instance CAM-SE (from Jim Edwards).
  - Fix for topo_tool (from Peter Lauritzen).
  - Correct physics_buffer abort messages (from Steve Goldhaber).

 Update externals to make the above possible:

  - csm_share: Fix for shr_spfn_gamma on Intel.
  - CLM: NAG port tag.
  - MCT: Fixes for NAG port, Darwin build, and Intel bounds-checking.
         These fixes have not been put into a released version of MCT
         yet, so for now CAM is using an MCT branch as its external.

 Some externals updated to try to avoid CLM compatibility issues:

  - RTM
  - scripts
  - Machines

Bugs fixed (include bugzilla ID):

 - 1729: WACCM (and possibly strat chem) crashes within a few years
 - 1744: WACCM-SE sometimes fails due to race condition with threading

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton, most chemistry changes reviewed by fvitt

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
         - Update csm_share, CLM, and MCT.

M       models/atm/cam/bld/Makefile.in
         - Fix the COSP build on Darwin.
         - Remove some OpenMP/NAG flags, as OpenMP is not ready yet.

M       models/atm/cam/bld/configure
         - Fix the setting of rpath on Darwin; Darwin's ld will accept
           "-rpath /foo" but not "-rpath=foo".

M       models/atm/cam/bld/build-namelist
         - Fix setting of srf_emis_cycle_yr for super_fast_llnl_mam3,
           waccm_mozart_mam3, and trop_mam7.

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
         - Remove dead code.
         - Change r4 declarations to r8.
         - Get physical constants from physconst.

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
M       models/atm/cam/src/chemistry/mozart/mo_airglow.F90
M       models/atm/cam/src/chemistry/mozart/mo_aurora.F90
M       models/atm/cam/src/chemistry/mozart/mo_sethet.F90
M       models/atm/cam/src/chemistry/mozart/mo_setinv.F90
M       models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
M       models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
         - Get physical constants from from physconst and mo_constants.
           (E.g. R_gas, Avogadro's number, Boltzmann's constant...)
         - Remove definitions of constants that are never used.
         - Fix line over 132 characters in mz_aerosols_intr.F90.

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90
M       models/atm/cam/src/physics/cam/micro_mg1_0.F90
M       models/atm/cam/src/physics/cam/micro_mg1_5.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/physics/cam/ndrop_bam.F90
M       models/atm/cam/src/physics/cam/uwshcu.F90
M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
         - Replace "nonintrinsic" versions of special functions with
           the regular versions (which allow shr_spfn_mod to decide if a
           Fortran 2008 intrinsic is available).

M       models/atm/cam/src/chemistry/utils/mo_constants.F90
         - Add more constants with different units needed by the chemistry.
         - Explicitly call out cgs units by naming them with a "_cgs"
           suffix.

M       models/atm/cam/src/control/cam_history_support.F90
         - Resolve ambiguity between check_hist_coord_all and
           check_hist_coord_char by making the "vlen" argument mandatory
           for check_hist_coord_all.

M       models/atm/cam/src/control/physconst.F90
         - Add molecular weight for NH4.

M       models/atm/cam/doc/ChangeLog_template
         - Add NAG to compilers used to run tests.

M       models/atm/cam/src/dynamics/se/dyn_comp.F90
         - Fix multi-instance CAM-SE by only calling write_grid_mapping
           from one index.

M       models/atm/cam/src/dynamics/se/gravity_waves_sources.F90
         - Fix race condition that caused a crash on Intel with DEBUG
           on.

M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
         - Correct endrun messages that mentioned pbuf_get_field but were
           actually in pbuf_set_field.

M       models/atm/cam/src/physics/cam/physpkg.F90
         - Fix bug where clybry_fam_adj would crash when given negative
           constituent concentrations, by calling qneg3 beforehand.

M       models/atm/cam/src/physics/cam/pkg_cldoptics.F90
         - Remove unnecessary truncation of a table when do_waccm_phys()
           is .false.

M       models/atm/cam/test/system/TCB_ccsm.sh
M       models/atm/cam/test/system/test_driver.sh
         - Use a CCSM_MPILIB as well as CCSM_MACH. This is a necessary step
           for NAG to run CESM tests on frankfurt right now, since only
           mpich is built there right now, but the CESM scripts choose
           openmpi as the default MPI library.
         - Define CCSM_MACH separately for all compilers on frankfurt
           except Lahey.
         - Correct the spelling of "edison" in edison's CCSM_MACH.

M       models/atm/cam/test/system/archive_baseline.sh
         - Mention NAG in the help message.

M       models/atm/cam/tools/topo_tool/cube_to_target/cube_to_target.F90
M       models/atm/cam/tools/topo_tool/cube_to_target/remap.F90
         - Several fixes for topo_tool from Peter Lauritzen.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Mon Jun 10 17:51:45 MDT 2013
006 bl133 TBL.sh e48c4paqdm aqpgro+aquaplanet_cam4 3s .....................FAIL! rc= 7 at Mon Jun 10 17:52:35 MDT 2013
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Mon Jun 10 17:55:01 MDT 2013
014 bl322 TBL.sh fn1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Mon Jun 10 18:03:19 MDT 2013
016 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Mon Jun 10 18:04:42 MDT 2013
020 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Mon Jun 10 18:09:12 MDT 2013
024 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Mon Jun 10 18:18:41 MDT 2013
026 bl333 TBL.sh f4c4paqdh aqpgro+aquaplanet_cam4 3s ......................FAIL! rc= 7 at Mon Jun 10 18:19:12 MDT 2013
036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Mon Jun 10 18:25:18 MDT 2013
039 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Mon Jun 10 18:31:04 MDT 2013
043 bl366 TBL.sh f1.9c5clbdm outfrq3s_clubb 9s ............................FAIL! rc= 7 at Mon Jun 10 18:46:32 MDT 2013
046 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Mon Jun 10 18:59:17 MDT 2013
051 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Mon Jun 10 19:24:26 MDT 2013
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Mon Jun 10 19:28:29 MDT 2013
055 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Mon Jun 10 19:35:24 MDT 2013
058 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Mon Jun 10 19:42:59 MDT 2013
060 bl430 TBL.sh fm1.9c5dh outfrq3s_mozEOOH 9s ............................FAIL! rc= 7 at Mon Jun 10 19:52:41 MDT 2013
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s_mozEOOH+soa_chem_megan_emis 9s ......FAIL! rc= 7 at Mon Jun 10 20:11:34 MDT 2013
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Mon Jun 10 20:40:06 MDT 2013
079 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Mon Jun 10 21:06:26 MDT 2013
081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Mon Jun 10 21:09:21 MDT 2013
090 bl997 TBL_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 7 at Mon Jun 10 21:47:38 MDT 2013

Expected failures due to various answer changes mentioned below.

The following tests unexpectedly passed:

067 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................PASS at Mon Jun 10 20:20:04 MDT 2013
070 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................PASS at Mon Jun 10 20:22:31 MDT 2013
076 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................PASS at Mon Jun 10 20:46:26 MDT 2013
084 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................PASS at Mon Jun 10 21:30:11 MDT 2013
087 bl992 TBL_ccsm.sh f19_g16 ETEST 2d ....................................PASS at Mon Jun 10 21:35:01 MDT 2013

These were expected to have answer changes due to the change in
pkg_cldoptics.F90. However, this change would only affect CAM3 and CAM4
non-WACCM cases, and only if temperatures fell below 180K. The most likely
explanation for the fact that these baseline tests passed, is that
temperatures never fell below 180K during the test.

frankfurt/lf95:
 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Jun 10 16:37:50 MDT 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Jun 10 17:17:27 MDT 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Jun 10 17:28:38 MDT 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Mon Jun 10 18:17:02 MDT 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Mon Jun 10 21:10:10 MDT 2013
027 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Mon Jun 10 21:27:46 MDT 2013
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Mon Jun 10 22:42:03 MDT 2013
035 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Mon Jun 10 23:15:21 MDT 2013

Expected failures due to various answer changes mentioned below.

frankfurt/nag:

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................SKIPPED* at Mon Jun 10 16:02:35 MDT 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................SKIPPED* at Mon Jun 10 16:10:17 MDT 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................SKIPPED* at Mon Jun 10 16:18:33 MDT 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................SKIPPED* at Mon Jun 10 16:30:08 MDT 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................SKIPPED* at Mon Jun 10 16:57:04 MDT 2013
027 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................SKIPPED* at Mon Jun 10 16:59:36 MDT 2013
030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................SKIPPED* at Mon Jun 10 17:08:04 MDT 2013
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................SKIPPED* at Mon Jun 10 17:10:54 MDT 2013
035 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................SKIPPED* at Mon Jun 10 17:24:24 MDT 2013

Baseline tests skipped because NAG is new (and baselines would be expected
to fail anyway).

frankfurt/pgi or jaguar/pgi: 

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Jun 10 16:26:49 MDT 2013
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Jun 10 16:36:55 MDT 2013
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Mon Jun 10 16:43:39 MDT 2013
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Jun 10 16:51:32 MDT 2013
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Mon Jun 10 17:09:33 MDT 2013
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Mon Jun 10 17:45:32 MDT 2013
033 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Mon Jun 10 17:50:21 MDT 2013
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Mon Jun 10 18:05:47 MDT 2013
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Mon Jun 10 18:12:40 MDT 2013
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Jun 10 18:24:04 MDT 2013
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Mon Jun 10 18:31:46 MDT 2013
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Mon Jun 10 18:34:44 MDT 2013
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Mon Jun 10 18:42:30 MDT 2013
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Mon Jun 10 19:02:11 MDT 2013
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Mon Jun 10 19:43:20 MDT 2013

Expected failures due to various answer changes mentioned below.


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

  All cases with CAM3/4 physics that are not WACCM cases, all cases with
  CAM5 physics, and all cases with active chemistry. The CARMA cirrus,
  dust, and sea_salt models are also affected.

  Therefore, the only bit-for-bit cases will be those without typical CAM
  physics (e.g. using ideal physics) and WACCM4 specified chemistry cases.

- what platforms/compilers:

  All.

- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

  Larger than roundoff but same climate, except that changes to use
  statements for shr_spfn_mod may be roundoff-level for most compilers.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

  For shr_spfn_mod changes, this was demonstrated during previous unit
  tests of csm_share code.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_03
Originator(s): Craig, Goldhaber
Date: 
One-line Summary: Implementation of pbuf and history support for sub-columns

Purpose of changes:
- Modifications to pbuf to support sub-columns
- Modifications to history to support sub-columns
- Bug fix to cosp history

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:
M       models/atm/cam/src/control/cam_history_support.F90
.  register_history_mdim: Removed and replaced with add_hist_coord interface

M       models/atm/cam/src/physics/cam/cosp_share.F90
.  Removed file (merged into cospsimulator_intr.F90 as separate file no
        longer needed for cam_history.F90 use).

List all subroutines added and what they do:
M       models/atm/cam/src/control/cam_history.F90
.  get_field_properties: Retrieve properties from CAM history field
     This function needed to provide information to non-history code
     needing to manipulate history data (e.g., subcol_outfld).

M       models/atm/cam/src/control/cam_history_support.F90
.  check_hist_coord interface consisting of routines to verify
     consistency between data passed in an add_hist_coord or
     add_vert_coord call and any data already residing in
     hist_coords. This interface includes subroutines for each datatype
     found in the hist_coord_t derived type.
.  add_hist_coord interface consisting of the following two routines
.  add_hist_coord_int: New routine for registering mdim and storing all
     information relevant to an mdim when the dimension values are integral
.  add_hist_coord_r8: New routine for registering mdim and storing all
     information relevant to an mdim when the dimension values are real
.  add_vert_coord: Routine for adding the vertical mdims (lev and ilev).
.  write_hist_coord_att: Write the NetCDF attributes for a single hist coord
.  write_hist_coord_atts: Write the NetCDF attributes for all hist coords
.  write_hist_coord_var: Write the NetCDF data for a single hist coord
.  write_hist_coord_vars: Write the netCDF data for all hist coords


M       models/atm/cam/src/utils/grid_flag_utils.F90
. Utilities to support grid flags
    col_type - number from 0-31 - used to identify which type of field (currently: 0=grid, 1=sub-col)
    grid_type - integer(bit_field_kind) which contains the appropriate fields turned on/off (internally each bit of
                a grid_type flag indicates on/off status for each type of field)

    * clear_grid_types - clears all the flags from provided grid_types_flag
    * is_col_type_set - returns true if requested col_type flag is set in provided grid_types_flag
    * set_col_type - returns a grid_types integer with the requested col_type flag set
    * add_col_type - adds the requested col_type to the provided grid_types_flag
    * clear_col_type - clears the requested col_type fromthe provided grid_types_flag


List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/control/cam_history.F90
.  Changes described in the subroutine sections
.  Removed unused 'use' subroutines and unused variables
.  Removed explicit output of vertical or 'mdim' coordinates. This
     output is now handled in the add_hist_coord and add_vert_coord interfaces.
.  Moved all register_hist_coord calls to 'owner' routines
.  Moved all information about specific hist coords to 'owner' routines
.  Added calls to support functions to write hist coord attributes and values

M       models/atm/cam/src/control/cam_history_support.F90
.  Changes described in the subroutine sections

M       models/atm/cam/src/control/ncdio_atm.F90
.  Added optional ncolnam input to infld_real_2dncol and to
     infld_real_3dncol. This input allows infld to read a variable
     defined on a different grid by specifying a name other than 'ncol'.

M       models/atm/cam/src/control/sat_hist.F90
.  Name change of hist_mdims to hist_coords. Also %value --> %dimsize

M       models/atm/cam/src/dynamics/eul/dp_coupling.F90
.  Now passing array subsection in geopotential_t call

M       models/atm/cam/src/dynamics/eul/dyn_comp.F90
.  Moved hycoef_init call to before addfld calls (needed because
        hycoef_init now defined 'lev' and 'ilev' dimensions).

M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
.  Now passing array subsection in geopotential_t call

M       models/atm/cam/src/dynamics/fv/dyn_comp.F90
.  Whitespace cleanup

M       models/atm/cam/src/dynamics/se/dp_coupling.F90
.  Now passing array subsection in geopotential_t call

M       models/atm/cam/src/dynamics/se/dyn_comp.F90
.  Removed redundant subroutine 'use' statement.

M       models/atm/cam/src/dynamics/se/dp_coupling.F90
.  Now passing array subsection in geopotential_t call

M       models/atm/cam/src/dynamics/sld/dyn_comp.F90
.  Moved hycoef_init call to before addfld calls (needed because
        hycoef_init now defined 'lev' and 'ilev' dimensions).

M       models/atm/cam/src/physics/cam/check_energy.F90
.  Arrays in arguments are now assumed shape.  Local arrays are now dimensioned state%ncol instead of pcols

M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
.  Merged cosp_share.F90 into file. Made as many transferred variables
     as possible private.
.  Replaced register_hist_mdim calls with more self-contained add_hist_coord
.  Replaced 'cosp_nhtml' mdim with 'lev' (change verified by Jen Kay).
.  Made dimension units CF compilant (changes verified with Brian and
  Jen Kay).

M       models/atm/cam/src/physics/cam/geopotential.F90
.  Arrays in arguments are now assumed shape.  Local arrays are now dimensioned ncol instead of pcols

M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
.  Added bfg_sc to buffer field
.  pbuf_add_field - added optional grid_types_flag parameter which if present adds field(s) specified
.  pbuf_get_field - added optional col_types parameter which if present specifies which col_type to
     retrieve, otherwise grid field is returned
.  pbuf_set_field - added optional grid_types_flag paramater which if present sets the field(s) specified,
     otherwise set the grid field

M       models/atm/cam/src/physics/cam/radiation.F90
.  use change due to cosp_share module elimination

M       models/atm/cam/src/physics/rrtmg/radiation.F90
.  use change due to cosp_share module elimination

M       models/atm/cam/src/utils/buffer.F90
M       models/atm/cam/src/utils/buffer.F90.in
.  Added buffer_field_is_alloc - checks the allocation status of buffer field passed in

M       models/atm/cam/src/utils/cam_pio_utils.F90
.  Name change of hist_mdims to hist_coords. Also %value --> %dimsize

M       models/atm/cam/src/utils/hycoef.F90
.  hyai, hyam, hybi, and hybm are now targets as they are stored as
     pointers in the hist_coord_t type.
.  level values for 'lev' and 'ilev' are stored as new module variables,
     alev and ailev (also targets).
.  hycoef_init now calls add_vert_coord for 'lev' and 'ilev'.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All Passed

frankfurt/lf95: All Passed

frankfurt/pgi: 
044 bl317 TBL.sh f10c5cdm outfrq3s 9s: 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

PGI with COSP test. mdim coordinate values and attributes were incorrect
	in history file.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_3_02 
Originator(s): fischer, eaton
Date: Thu May  9 2013
One-line Summary: Merge updates from cesm1_2_0 release branches 

Purpose of changes:

. Merge updates from the release branch to match cesm1_2_0_n05_cam5_3_01.
  Excluding the offline radiation driver.

. Improve how CAM standalone build handles NetCDF.  Improved error handling
  for configure's use of the nf-config and nc-config scripts to determine
  the link arguments.  Also made mods to allow the user to *not* specify
  NetCDF include file or library locations.  This is useful for working
  with compiler wrapper scripts that already have this information from the
  system module settings (e.g., when using the mpif90 wrapper script on
  yellowstone).

. Swapped test 735 on frankfurt with 991 on yellowstone.  Did this because
  The TEQ_ccsm 991 test was failing due to different intel compiler versions
  being used for cam stand alone, and cesm scripts.  735 was swapped because
  it's run lenght was about the same as 991.  In order to do this, the pes
  layout for frankfurt had to be overridden in TCB_ccsm.sh, and CCSM_MACH
  had to be set for frankfurt.

. Other testing changes were turning on debugging for the WACCM-X post-tag
  test on yellowstone, and add support for testing on edison.

. Updates for testing and run script example for yellowstone to set OMP_STACKSIZE and remove
  INC_NETCDF and LIB_NETCDF.

. Fix units for aerosol, basically it is all variables with the name that contain "num".  Units
  were "kg/m2/s", should be " 1/m2/s"

. #NO_MPI2 logic was removed, and MPI2 code was removed.  The MPI2 all_gather calls were failing due
  to a bug in MPI2.  

. SVN externals updated to match cesm1_2_beta08

Bugs fixed (include bugzilla ID):

. OMP bug fixed for WACCM-X.

. Memory leak fix for WACCM-SE.

Describe any changes made to build system:

Describe any changes made to the namelist:

. New initial condition file for ne30np4

. New tunings for rsplit and se_split to allow 7.5 minute vertical remapping for ne120np4.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Fischer, Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/tests_pretag_frankfurt_pgi
M       models/atm/cam/test/system/tests_pretag_yellowstone
. Moved the 735 tests to yellowstone.  Moved 991 from yellowstone to frankfurt

M       models/atm/cam/test/system/TCB_ccsm.sh
.  Add the ability to run ccsm tests on frankfurt

A       models/atm/cam/test/system/config_files/wx1.9c4dh
. Created a WACCM-X debug test to be run posttag on yellowstone

M       models/atm/cam/test/system/test_driver.sh
. Add test support for edison.
. Set CCSM_MACH for frankfurt to allow ccsm tests to be run on frankfrut.
. Removed INC_NETCDF and LIB_NETCDF from yellowstone testing

M       models/atm/cam/test/system/input_tests_master
. Turned on debugging for the WACCM-X 399 tests.

M       models/atm/cam/test/system/CAM_runcmnd.sh
A       models/atm/cam/test/system/tests_pretag_edison_intel
. Added support for edison testing

M       models/atm/cam/bld/configure
. Update how configure deals with the NetCDF library.
  - Remove the default locations of /usr/local/include and /usr/local/lib.
    The compiler wrapper scripts that are used on yellowstone supply this
    information, so there's no reason for configure to supply a default
    that's almost never correct.
  - Remove the check that the netCDF header files and libraries exist.  We
    may not know where they are.
  - Don't fail if .mod files not found
  - If the netcdf lib path is specified, then attempt to get netcdf link
    args from the nf-config or nc-config scripts.  But if that fails then
    set defaults based on the specified library path.
  - Add a -rpath setting to the link args unless the nf-config or nc-config
    scripts have already set info to be passed to linker (assuming the user
    has provided netcdf lib path)
  - Fix bug in test code (the create mode needed to be defined).
. removed some unused code

M       models/atm/cam/bld/Makefile.in
. Remove all setting of rpath for netcdf shared libs.  This responsibility
  has been moved to configure.
. Remove the -d option for mkDepends -- this was causing problems for the
  configure tests
. Put code to append the MOD_NETCDF seach path inside conditional logic since it
  may not be set.
. Need to set -DNO_C_SIZEOF to please latest PIO tag.

M       models/atm/cam/bld/config_files/definition.xml
. add nc_ldflags to save args used to link NetCDF libraries.


M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. New initial condition file for ne30np4 CAM5
. Set all values of rsplit to 5, and set se_nsplit to 2 for ne120np4.  This
  allows 7.5 minute vertical remapping.


M       models/atm/cam/bld/namelist_files/use_cases/1850-PD_cam5.xml
. Renamed emis files from ar5 to RCP45

M       models/atm/cam/bld/run-yellowstone.csh
. Removed LIB_NETCDF and INC_NETCDF
. Set OMP_STACKSIZE to 256M

M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M       models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
. Fix units for aerosols.

M       models/atm/cam/src/dynamics/se/gravity_waves_sources.F90
. Fix memory leak for WACCM-SE

M       models/atm/cam/src/dynamics/se/dyn_grid.F90
M       models/atm/cam/src/utils/spmd_utils.F90
. Removed #NO_MPI2
. Removed MPI2 code because of a bug in the MPI2 libraries

M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
. OMP bug fix, mmrSum_O_O2_H needed to be private.  Changes answer for WACCM-X

M       SVN_EXTERNAL_DIRECTORIES
. Externals updated to match cesm1_2_beta08.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Tue May  7 18:43:36 MDT 2013
051 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Tue May  7 19:42:06 MDT 2013
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue May  7 19:46:08 MDT 2013
055 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Tue May  7 19:52:59 MDT 2013
058 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Tue May  7 20:00:27 MDT 2013
060 bl430 TBL.sh fm1.9c5dh outfrq3s_mozEOOH 9s ............................FAIL! rc= 7 at Tue May  7 20:10:01 MDT 2013
063 bl440 TBL.sh fsoa1.9c4dh outfrq3s_mozEOOH+soa_chem_megan_emis 9s ......FAIL! rc= 7 at Tue May  7 20:28:58 MDT 2013
067 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Tue May  7 20:37:23 MDT 2013
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Tue May  7 20:57:22 MDT 2013
. Answer changes from new clm tag

079 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Tue May  7 21:23:56 MDT 2013
. New test for yellowstone

081 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Tue May  7 21:27:01 MDT 2013
.  Expected to fail because of new initial condition file

frankfurt/lf95:  All passed

frankfurt/pgi: All passed 


===============================================================
===============================================================

Tag name: cam5_3_01
Originator(s): santos cbardeen hannay
Date: Apr 25, 2013
One-line Summary: Fixes for CAM-CHEM, WACCM, and CARMA issues (posttag tests).

Purpose of changes:

 - Update driver and csm_share to fix some SCAM cases. (Also brings in a
   driver fix for NAG builds.)

 - Get CARMA working with debug flags turned on (Lahey, PGI, Intel).

 - Restore WACCM-X hydrogen limiters for calls of physics_update where
   hydrogen (atomic and molecular) is not being modified directly via
   ptend.

 - Fix issues with WACCM and CAM-CHEM debug cases.

 - Fix from Chuck Bardeen for meteor_smoke and pmc CARMA models with
   specified dynamics cases.

 - Fix from Cecile Hannay for the units of NUMLIQ and NUMICE.

Bugs fixed (include bugzilla ID):

 - SCAM cases that were over ocean, but not aquaplanet cases, were setting
   lnd_present = .false., but not sno_present = .false.
 - CARMA debug cases did not run.
 - WACCM and some CAM-CHEM debug cases failed state_debug_check.

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

D       models/atm/cam/bld/namelist_files/use_cases/arm95_scam.xml
         - Replaced by scam_arm95.xml, which was added in the previous tag.

List all subroutines added and what they do:

A       models/atm/cam/test/system/config_files/f1.9c5carmdusdm
         - CARMA dust model with debug flags enabled.

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
         - Pull in update to driver and csm_share with SCAM fix.

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - Pull in CARMA with fixes for DEBUG mode.
           (See the CARMA log for details about these changes.)

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
         - Output different units for mass mixing ratios and number
           concentrations (CLDLIQ/CLDICE vs. NUMLIQ/NUMICE).
         - Change units of "#" to the CF-compliant "1".

M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
         - Split long lines to stay under 132 character limit.

M       models/atm/cam/src/physics/cam/physics_types.F90
         - Remove conditionals that caused an accidental answer change for
           WACCM-X in cam5_2_21. In isolation, this change restores answers
           that are bit-for-bit with cam5_2_20. However, WACCM-X will not
           be bit-for-bit between this tag and any previous tag, because
           of other changes affecting WACCM chemistry.

M       models/atm/cam/src/physics/cam/physpkg.F90
         - Move clybry_fam_adj call before QNEG3, so that QNEG3 enforces
           the qmin limit on the result, and the subsequent call to
           physics_state_check can pass.

M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
         - Use carma_do_thermo to prevent access of unallocated array in
           the "CRTT" outfld call.
         - The calls to "set_dry_to_wet" and "set_wet_to_dry" did not
           respect qmin. For now, cause CARMA to operate on a temporary
           copy of the state. CARMA does not deliberately modify the state;
           it only produces a roundoff error due to these two conversions.
         - Change ptend names to differentiate between CARMA tendencies
           originating in different routines.

M       models/atm/cam/src/physics/carma/models/cirrus/carma_cloudfraction.F90
         - Remove unnecessary use of physics_ptend_init.

M       models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
         - Force internal calculations to use 365 day years, to deal with
           mismatches between year lengths in CARMA and specified dynamics
           files.

M       models/atm/cam/test/system/input_tests_master
         - Change CARMA dust test to a debug test.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

036 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Wed Apr 24 19:04:38 MDT 2013
073 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Wed Apr 24 21:18:15 MDT 2013

Expected small change due to moving clybry_fam_adj.

084 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 7 at Wed Apr 24 21:53:28 MDT 2013

Expected failure due to mismatch between CESM compiler version and
yellowstone default.

frankfurt/lf95: All PASS.

frankfurt/pgi or jaguar/pgi: All PASS.

(There is a WACCM case on frankfurt, but it is specified chemistry, and
 thus the baseline is not expected to fail.)

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

WACCM and CAM-CHEM - Small (but above roundoff) change due to reordering
                     of clybry_fam_adj and qneg3.
CARMA - Change due to machine roundoff in divide/multiply that is no longer
        executed on the shared physics_state object.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_3_00 
Originator(s): fischer, bsingh, eaton, hannay, jet, taylor
Date: Apr 23, 2013
One-line Summary:  Improve rad_diag calcs; add modal aerosol optics diagnostics 
                   scam updates, SE bug fix

Purpose of changes:
. Remove restriction that radiation diagnostic calculations reuse the water
  uptake and wet radius values calculated for the climate affecting modes.
  These quantities are now recomputed for the diagnostic modes.

. Add new diagnostics for modal aerosol optics.

. Make species burdens consistent with mode burdens, i.e., only include
  contributions from daylight columns.

. Add new IOP datasets, use cases, and run script for scam. Along with a 
  date bug fix for scam.

. Minor bug fix and external update for SE from Taylor

. Update svn externals to cesm1_2_beta06, except for pio tag.  PIO has
  an mpi-serial bug.
 
. inic files moved back to homme from se.

Bugs fixed (include bugzilla ID):

. Fix bug in configure script for SE


Describe any changes made to build system:

Describe any changes made to the namelist:
. Added a new namelist variable, history_aero_optics, to add modal aerosol
  optics diagnostics to the default history fields.  The existing
  history_aerosol variable turns on diagnostics related to the aerosol
  production and removal tendencies.

  A       models/atm/cam/bld/namelist_files/use_cases/scam_arm95.xml
  A       models/atm/cam/bld/namelist_files/use_cases/scam_arm97.xml
  A       models/atm/cam/bld/namelist_files/use_cases/scam_gateIII.xml
  A       models/atm/cam/bld/namelist_files/use_cases/scam_twp06.xml
  A       models/atm/cam/bld/namelist_files/use_cases/scam_togaII.xml
  A       models/atm/cam/bld/namelist_files/use_cases/scam_sparticus.xml
  A       models/atm/cam/bld/namelist_files/use_cases/scam_mpace.xml
  . New use cases for scam

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

  M       models/atm/cam/test/system/TBR.sh
  M       models/atm/cam/test/system/TER.sh
  M       models/atm/cam/test/system/TSM.sh
  M       models/atm/cam/bld/build-namelist
  M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
  M       models/atm/cam/bld/namelist_files/namelist_definition.xml
  M       models/atm/cam/src/physics/cam/phys_control.F90
  . add namelist variable history_aero_optics

  M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
  . add namelist variable history_aero_optics
  . Move inic files back to homme from se.
  
  M       models/atm/cam/bld/config_files/horiz_grid.xml
  . add ncol values for se dycore -- this is only used by standalone builds
    to provide info needed for the cice decomp

  M       models/atm/cam/bld/configure
  . change set_horiz_grid to use ncol from the horiz_grid.xml file rather
    than nlon and nlat when dycore is SE.  A little less confusing.

  M       models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
  . remove restriction that dry radius is being calculated for the modes
    affecting the climate.  The calculation for the diagnostic modes is
    returned via an optional argument rather than put in the physics buffer.

  M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
  . remove restriction that water uptake and wet radius are being calculated
    for the modes affecting the climate.  The calculations for the diagnostic
    modes are returned via optional arguments rather than put in the physics
    buffer.

  M       models/atm/cam/src/physics/cam/aer_rad_props.F90
  . use history_aero_optics rather than history_aerosol to add default
    diagnostics to the history output

  M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
  . remove restriction that diagnostic calculations will reuse the water
    uptake and wet radius values computed for the climate affecting modes.
  . add diagnostic output

  M       models/atm/cam/src/physics/rrtmg/radconstants.F90
  . add public parameters to identify nir and uv sw bands

  M       models/atm/cam/src/physics/cam/radconstants.F90
  . add public parameters to identify nir and uv sw bands.  This is only for
    interface consistency; this version of radconstants shouldn't be used
    when modal aerosols are in use.


  M       models/atm/cam/test/system/tests_pretag_yellowstone
  M       models/atm/cam/test/system/input_tests_master
  A       models/atm/cam/test/system/config_files/h30c5h
  . New non aquaplanet SE test

  M       models/atm/cam/bld/run-scam.csh
  M       models/atm/cam/src/dynamics/eul/iop.F90
  . Updates for scam from jet

  M       models/atm/cam/bld/run-yellowstone.csh
  . Remove dos carriage returns

  M       models/atm/cam/src/dynamics/se/dyn_comp.F90
  . Bug fix from Mark Taylor

  M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
  . Update SE tag to 1_3_36 for bug fix for Taylor

  M       SVN_EXTERNAL_DIRECTORIES
  . Update externals to match cesm1_2_beta06, except for pio, which has an
    mpi-serial bug


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Apr 23 11:10:56 MDT 2013
014 bl322 TBL.sh fn1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Tue Apr 23 11:11:00 MDT 2013
024 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue Apr 23 11:11:03 MDT 2013
039 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Tue Apr 23 11:11:05 MDT 2013
043 bl366 TBL.sh f1.9c5clbdm outfrq3s_clubb 9s ............................FAIL! rc= 7 at Tue Apr 23 11:11:13 MDT 2013
046 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Tue Apr 23 11:11:16 MDT 2013
053 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue Apr 23 11:11:20 MDT 2013
060 bl430 TBL.sh fm1.9c5dh outfrq3s_mozEOOH 9s ............................FAIL! rc= 7 at Tue Apr 23 11:11:28 MDT 2013
090 bl997 TBL_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 7 at Tue Apr 23 11:11:51 MDT 2013
. Baseline failures are due to a change in how the diagnostic output of
  species burdens (BURDENBC BURDENDUST BURDENPOM BURDENSEASALT BURDENSO4
  BURDENSOA) have been redefined to be consistent with the mode burden
  diagnostics which only contain contributions from daylight columns.


076 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Tue Apr 23 11:11:33 MDT 2013
078 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Tue Apr 23 11:11:33 MDT 2013
081 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Tue Apr 23 11:11:44 MDT 2013
. Bug fix for SE cause minor answer changes

078 bl740 TBL.sh h30c5h outfrq3s 9s .......................................FAIL! rc= 7 at Tue Apr 23 11:11:33 MDT 2013
. New test, no baselines

084 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 7 at Tue Apr 23 11:11:47 MDT 2013
.  expected, cam tests use Intel 12, cesm test use Intel 13, which have answer differences


frankfurt/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Apr 22 15:12:39 MDT 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Apr 22 15:12:41 MDT 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Apr 22 15:12:42 MDT 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Mon Apr 22 15:12:46 MDT 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Mon Apr 22 15:13:11 MDT 2013
. Baseline failures are due to a change in how the diagnostic output of
  species burdens (BURDENBC BURDENDUST BURDENPOM BURDENSEASALT BURDENSO4
  BURDENSOA) have been redefined to be consistent with the mode burden
  diagnostics which only contain contributions from daylight columns.


frankfurt/pgi or jaguar/pgi: 
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Apr 23 11:17:48 MDT 2013
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Apr 23 11:17:49 MDT 2013
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Apr 23 11:17:52 MDT 2013
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Apr 23 11:17:57 MDT 2013
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Apr 23 11:18:22 MDT 2013
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Apr 23 11:18:27 MDT 2013
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Tue Apr 23 11:18:30 MDT 2013
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Tue Apr 23 11:18:41 MDT 2013
. Baseline failures are due to a change in how the diagnostic output of
  species burdens (BURDENBC BURDENDUST BURDENPOM BURDENSEASALT BURDENSO4
  BURDENSOA) have been redefined to be consistent with the mode burden
  diagnostics which only contain contributions from daylight columns.




===============================================================
===============================================================

Tag name: cam5_2_21
Originator(s): santos
Date: Apr 17, 2013
One-line Summary: Add debug checks to physics_update, some chores

Purpose of changes:

 - Add a routine to validate physics_state objects, and provide a
   namelist option to run this routine every time physics_update is
   called.
   - Change ptend%name for some routines to be more informative when
     used in these messages.

 - Fix bug in CARMA netCDF file reads.

 - "endrun" is now a wrapper for "shr_sys_abort" from csm_share. This
   means that ENDRUN will no longer be printed to log files; ERROR
   will be printed instead.

 - For CESM cases, do not re-run configure after a build is complete.

 - Update mkDepends to match Machines version.

 - Standardize checking of error strings with handle_errmsg.

 - Move cprnc to $CESMROOT/tools, matching CESM's layout.
    - This also pulls in a copy of genf90; it's convenient to have
      an updated copy of genf90.pl in the same place in both CESM
      and CAM tags (e.g. to auto-regenerate source code in unit
      tests).
    - The location of cprnc does not seem to be specified anywhere
      in the CAM scripts, so this should be a "harmless" change
      except in any user scripts that build and use cprnc from the
      CAM source.

 - Remove some "#ifdef WACCM_PHYS" in cases where it can be replaced
   with a cheap runtime conditional.

 - Change outputs for CAM-CHEM cases.

Bugs fixed (include bugzilla ID):

 - Fixed issue with CARMA and a wrap_nf change introduced in
   cam5_2_19.

Describe any changes made to build system:

Describe any changes made to the namelist:

 - Add "state_debug_checks" to phys_control namelist.
   - .true. turns on these checks.
   - Default is .true. for cases passing "-debug" to configure,
     .false. otherwise.

 - Add new use_case (1850-PD_cam5.xml). This is similar to
   1850-2005_cam5.xml but has data from both observations and
   projections, to allow cases to be run longer.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

A       models/atm/cam/bld/namelist_files/use_cases/1850-PD_cam5.xml
         - New use_case for new compset (similar to F_AMIP_CAM5 but
           with added data from observations and projections).

In models/atm/cam/src/control/error_messages.F90:
   handle_errmsg:       Checks a string to make sure that it is empty.
                        If it is not empty, it is assumed to be an
                        error message and used to call endrun.

In models/atm/cam/src/physics/cam/physics_types.F90:
   physics_state_check: Checks for invalid data in a physics_state
                        object. Currently limited to checking for NaN
                        and finiteness, in most cases.

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
         - Add tools/cprnc.
         - Update csm_share external to get shr_assert_mod.

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - Remove CAM copy of tools/cprnc.

M       models/atm/cam/bld/Makefile.in
         - Use the "-d" option of mkDepends to ensure MCT is always
           built first.
         - Add netCDF to RPATH for Intel builds.

M       models/atm/cam/bld/build-namelist
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/src/physics/cam/phys_control.F90
         - Add state_debug_checks option (on by default for -debug
           builds).

M       models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_moz_mam3.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_strat_soa.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam3.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam7.xml
M       models/atm/cam/bld/namelist_files/use_cases/soa_chem_megan_emis.xml
         - Change fincl1 output variables.

M       models/atm/cam/bld/cam.buildnml.csh
         - Skip configure if build is complete (but error if
           config_cache.xml is missing).

M       models/atm/cam/bld/mkDepends
         - Updated with copy from Machines.

M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
M       models/atm/cam/src/physics/cam/clubb_intr.F90
M       models/atm/cam/src/physics/cam/convect_deep.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/eddy_diff.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/pkg_cldoptics.F90
M       models/atm/cam/src/physics/waccm/iondrag.F90
M       models/atm/cam/src/physics/waccmx/majorsp_diffusion.F90
         - Changed handling of ptend%name so that routines no longer
           need to alias themselves (e.g. MG's ptend%name was cldwat).
         - Changed/removed settings of ptend%name which were redundant
           or would tend to hide the true source of a change.
         - Error strings coming from portable code now use
           handle_errmsg.
         - Replace compile-time "#ifdef WACCM_PHYS" with run-time
           "if (do_waccm_phys)".

M       models/atm/cam/src/control/error_messages.F90
         - Add "handle_errmsg".

M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
M       models/atm/cam/src/dynamics/se/dp_coupling.F90
         - State variables initialized by dycore are now actually
           *allocated* by the dycore, if supported.
         - Remove temperature check that is now redundant with a check
           in physpkg.

M       models/atm/cam/src/dynamics/se/gravity_waves_sources.F90
M       models/atm/cam/src/dynamics/se/pmgrid.F90
M       models/atm/cam/src/dynamics/se/stepon.F90
         - Add save statement needed by XLF on Intrepid.

M       models/atm/cam/src/physics/cam/physics_types.F90
         - Add new state_debug_checks option and routine that
           implements it.
         - Added separate routine to allocate variables needed by
           WACCM and initialized by dycore (uzm, frontgf, and
           frontga).
         - If allocated, uzm, frontgf, and frontga are now copied
           in physics_state_copy.
         - Generalized pergro logic slightly so that microphysics and
           macrophysics routines no longer have to set ptend%name
           to cldwat.
         - Simplify some constituent limiters in physics_update.
         - physics_update now flushes iulog.

M       models/atm/cam/src/physics/cam/physpkg.F90
         - Call physics_state_check at beginning of tphysac and
           tphysbc.
         - Since uzm is part of the state, don't pass it as a separate
           argument to qbo_relax.
         - Remove/shrink some "#ifdef WACCM_PHYS" blocks.

M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
         - Uses temporary arrays instead of ptend components to hold
           local state.
         - Uses handle_errmsg to check errstring.
         - Replace "#ifdef WACCM_PHYS" with "if (do_waccm_phys)".

M       models/atm/cam/src/physics/cam/wv_saturation.F90
         - Use shr_assert_in_domain and handle_errmsg for some checks.

M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
         - Change CARMA netCDF reads to use netcdf module and new
           wrap_nf interface.
            - This is a bit hackish; wrap_nf should really just be
              removed.

M       models/atm/cam/src/physics/waccm/gw_drag.F90
         - Check that state fields have been allocated by dycore in
           gw_intr.
         - Minor cleanup in preparation of some strings used as field
           names in outfld (done while debugging a memory issue that
           was actually caused by code elsewhere).

M       models/atm/cam/src/physics/waccm/qbo.F90
         - Use state%uzm directly instead of requiring it as a
           separate argument to qbo_relax, and check that it is
           allocated first.

M       models/atm/cam/src/utils/abortutils.F90
         - endrun is now just a wrapper for shr_sys_abort.

M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
         - Comment change.

M       models/atm/cam/test/system/CAM_runcmnd.sh
M       models/atm/cam/test/system/archive_baseline.sh
M       models/atm/cam/test/system/test_driver.sh
         - Remove bluefire.
         - test_driver.sh will set the wallclock limit to 2:00 if
           using the "small" (debug) queue on yellowstone.
         - Intel uses -rpath (like other compilers) rather than adding
           $LIB_NETCDF to $LD_LIBRARY_PATH.

M       models/atm/cam/test/system/config_files/fst7mode1.9c5h
M       models/atm/cam/test/system/config_files/fsoa1.9c4dh
M       models/atm/cam/test/system/config_files/fsoa4c4dm
M       models/atm/cam/test/system/config_files/fst7mode4c5dm
         - Add option -age_of_air_trcs (now required by use_cases).

M       models/atm/cam/tools/README
         - Remove description of cprnc.

Additionally, a number of files with the "svn:executable" property
were not actually executables. This property was removed from files
that were not scripts.

Having svn:mergeinfo on subdirectories can cause merge problems, so
this property was removed from all subdirectories.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All PASS.

Note: Intel compiler version was set to 13 to get the following CESM
comparison test to pass:

082 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d

frankfurt/lf95: All PASS.

frankfurt/pgi or jaguar/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

This tag is bit-for-bit except:
cam5_2_19 introduced a roundoff-level change in "igamma" for compilers
that provide a gamma intrinsic function. This only affects the CARMA
dust and seasalt models, and was exposed in this tag (since CARMA
cases did not work in cam5_2_19 and cam5_2_20).

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_20
Originator(s): fischer 
Date: Fri Apr 12 09:42:31 MDT 2013
One-line Summary: rename homme to se, cice decomp fix

Purpose of changes:
.  HOMME is now referred to SE.  The code is changed to reflect this.
   If -dyn homme is used, you'll get a warning message and the dynamics
   will be automatically switched to se.
.  Fixes for calls to generate_cice_decomp.pl and cice configure
   to handel changes with a new cice tag
.  Update scripts tag to fix T42_T42 grid
.  Couple minor fixes to test scripts

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/TCB.sh
.       Remove cice decomp calls from test scripts, let bld/configure handel the cice decomp.

M       models/atm/cam/test/system/test_driver.sh
.       Changed path logic for submit scripts

M       models/atm/cam/test/system/TSC.sh
.       Bug fix to return error code from second call to TSM.sh

M       models/atm/cam/test/system/TR8.sh
M       models/atm/cam/test/system/config_files/h30c4aqdm
M       models/atm/cam/test/system/config_files/hn16c5aqdm
M       models/atm/cam/test/system/config_files/h16c3aqdh
M       models/atm/cam/test/system/config_files/h16c5aqdm
M       models/atm/cam/tools/interpic_new/README
M       models/atm/cam/bld/config_files/horiz_grid.xml
M       models/atm/cam/bld/config_files/definition.xml
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
M       models/atm/cam/bld/build-namelist
M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
M       models/atm/cam/src/utils/cam_pio_utils.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/chemistry/mozart/short_lived_species.F90
.       rename homme to se

M       models/atm/cam/bld/configure
.       Rename homme to se.  If homme dynamics is selected, print warning message and set to se.
.       Fix cice decomp for cam stand alone scripts.

D       models/atm/cam/bld/config_files/defaults_homme.xml
A       models/atm/cam/bld/config_files/defaults_se.xml
.       Rename file with homme to se

D       models/atm/cam/src/dynamics/homme/pmgrid.F90
D       models/atm/cam/src/dynamics/homme/dycore.F90
D       models/atm/cam/src/dynamics/homme/trunc.F90
D       models/atm/cam/src/dynamics/homme/gravity_waves_sources.F90
D       models/atm/cam/src/dynamics/homme/nctopo_util_mod.F90
D       models/atm/cam/src/dynamics/homme/dyn_grid.F90
D       models/atm/cam/src/dynamics/homme/interp_mod.F90
D       models/atm/cam/src/dynamics/homme/README
D       models/atm/cam/src/dynamics/homme/native_mapping.F90
D       models/atm/cam/src/dynamics/homme/initcom.F90
D       models/atm/cam/src/dynamics/homme/dp_coupling.F90
D       models/atm/cam/src/dynamics/homme/stepon.F90
D       models/atm/cam/src/dynamics/homme/inidat.F90
D       models/atm/cam/src/dynamics/homme/dyn_comp.F90
D       models/atm/cam/src/dynamics/homme/restart_dynamics.F90
D       models/atm/cam/src/dynamics/homme/spmd_dyn.F90
D       models/atm/cam/src/dynamics/homme/inital.F90
A       models/atm/cam/src/dynamics/se/dycore.F90
A       models/atm/cam/src/dynamics/se/nctopo_util_mod.F90
A       models/atm/cam/src/dynamics/se/README
A       models/atm/cam/src/dynamics/se/interp_mod.F90
A       models/atm/cam/src/dynamics/se/native_mapping.F90
A       models/atm/cam/src/dynamics/se/dp_coupling.F90
A       models/atm/cam/src/dynamics/se/dyn_comp.F90
A       models/atm/cam/src/dynamics/se/stepon.F90
A       models/atm/cam/src/dynamics/se/restart_dynamics.F90
A       models/atm/cam/src/dynamics/se/spmd_dyn.F90
A       models/atm/cam/src/dynamics/se/inital.F90
.       Move homme directory to se, and rename homme to se

M       SVN_EXTERNAL_DIRECTORIES
.       Update scripts to fix T42_T42 grid

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all passed

frankfurt/lf95: all passed

frankfurt/pgi: all passed 


===============================================================
===============================================================

Tag name: cam5_2_19
Originator(s): santos
Date: Apr 9, 2013
One-line Summary: NAG port

Purpose of changes:

This allows CAM to compile with the NAG Fortran compiler. The
build will not quite work out of the box; as of this tag, CLM
and CICE tags still must be updated, and MCT requires a patch
to remove "intent" attributes from the MPI interfaces in
m_mpif90.F90.

Not all configurations are ported; the following are still
untested or works in progress:
    - OpenMP threading
    - WACCM-X
    - CARMA
    - CLUBB

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

 - Add NAG support.
 - Get netCDF linking flags from nc-config/nf-config.
     - This should also allow the use of a shared library.
 - Add more debug flags to CAM Makefile for DEBUG cases:
     - Add "-g" to C code (most compilers).
     - Configure MCT with debugging enabled.
 - Update most externals to NAG-compatible versions.
     - All externals are between their cesm1_2_beta05
       and cesm1_2_beta06 versions.
     - This required the addition of a wave component (swav).

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

D       models/atm/cam/src/utils/error_function.F90
D       models/atm/cam/src/utils/gamma_function.F90
         - Functionality moved to shr_spfn_mod (csm_share module).

find_group_name (models/atm/cam/src/utils/namelist_utils.F90)
         - Moved to shr_nl_mod (csm_share module).

List all subroutines added and what they do:

A       models/atm/cam/test/system/tests_pretag_frankfurt_nag
         - NAG pretag test list. Duplicate of Lahey pretag tests.

A       models/atm/cam/bld/get_nxny.pl
         - Script to get nx and ny values from "config_grid.xml" in
           the CESM scripts. These values are needed because they
           must be passed to CICE configure scripts.

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
         - Update externals to very recent versions (between cesm1_2_beta05
           and cesm1_2_beta06).

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - Update externals to NAG-compatible versions.

M       models/atm/cam/bld/Makefile.in
M       models/atm/cam/bld/config_files/definition.xml
M       models/atm/cam/bld/configure
         - Add nagfor to compilers.
         - Use netCDF config script to get linking flags.
         - Add -g to CFLAGS for DEBUG builds.
         - Add --enable-debugging option to MCT for DEBUG builds.
         - For NAG, set MCT CFLAGS (override defaults), since otherwise
           there will be binary incompatibilities and/or spurious test
           failures in MCT's configure.
         - Update configure for standalone build with new wav component
           and CICE configure changes.

=====================
There are a number of short changes that had to be made to large numbers of
files. The following is a list of these changes, followed by the list of
all files that had only these changes made. These changes may have also
affected other files.

Changes regarding syntax and Fortran standard compliance:
 - Where a module has both a save statement, and variables declared with the
   save attribute individually, remove the individual save and leave only
   the module-scope save.
    - Additionally, add save statement to some modules where it was missing.
    - Additionally, move include statements of mpif.h above any save
      statements in a module, since mpif.h may include variables with
      the "save" attribute specified individually.
 - Where a procedure gets two arguments, and one is a dimension of the other,
   the arguments may be in either order in the interface, but the dimension
   must be declared first.
 - Break up source code lines longer than the standard length of 132
   characters (72 for fixed-form source).
 - Change non-standard format specifiers to standard equivalents.
 - Always pass reals to procedures requiring a real argument; do not assume
   integers will be converted to real automatically.
 - Pass whole arrays or appropriate slices, rather than passing the first
   element of an array under the assumption that a pointer to the correct
   array location will be passed.
 - Correct some "intent" attributes.

Changes to pointer use:
 - Default-initialize pointers to null() where NAG had detected at runtime
   that they were being used uninitialized.
 - Add "target" attribute to objects for which persistent pointers are
   needed.
 - In cases where pointer dummy arguments must remain associated with some
   memory upon entry to a procedure, declare the dummy arguments with
   "intent(in)" or "intent(inout)", not "intent(out)", regardless of how
   that memory is used.
    - Generally, this does not require changes to pointer dummy arguments,
      since Fortran 95 (and therefore the Lahey compiler) does not allow
      any intent to be specified on pointer dummy arguments. However, some
      derived types have pointer components, and dummy arguments of these
      types must have the correct intent.

Changes to use of libraries and intrinsics:
 - Get F2008 intrinsics that are not present on all compilers (e.g. gamma,
   erfc) from shr_spfn_mod, rather than assuming that all compilers do or
   do not have them.
 - When setting IEEE NaN or Infinity, use the new version of shr_infnan_mod,
   which requires the operator "assignment(=)" to be used.
    - "bigint" was also replaced with huge(1).
    - In some cases, "inf" had to be changed to "posinf" to deal with a
      bug in PGI on Frankfurt.
 - Where the netCDF F77 bindings are used, change to the netCDF F90
   bindings, and also replace any uses of wrap_nf in those modules.
 - Change non-standard complex number intrinsics to generic standard
   intrinsics (e.g. imag to aimag, dcmplx to cmplx).
 - Use CAM's "endrun", not "abort" or "exit" (non-standard extensions).

Other changes:
 - Where required by the above changes, change dimensions of arrays.
   (Usually, from explicit or assumed size to assumed shape.)
 - Add some changes that would have allowed problems described above to
   be detected on other compilers (initialize pointer components to null,
   add explicit intent on procedures).
 - Remove unnecessary code that would otherwise require one of the above
   changes to be made.

*A quick note on external libraries in Fortran:
It is technically not standard-conforming to use generic functions without
explicit interfaces, as in the netCDF and MPI F77 bindings. For netCDF, it
is easy to switch to the Fortran 90 bindings. For MPI, there are some
potential issues with using the MPI module, so instead the "-wmismatch"
argument is used to turn off some of nagfor's compile-time checks.

Files:
M       models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90
M       models/atm/cam/src/chemistry/mozart/cfc11star.F90
M       models/atm/cam/src/chemistry/mozart/chemistry.F90
M       models/atm/cam/src/chemistry/mozart/linoz_data.F90
M       models/atm/cam/src/chemistry/mozart/mo_ghg_chem.F90
M       models/atm/cam/src/chemistry/mozart/mo_jlong.F90
M       models/atm/cam/src/chemistry/mozart/mo_mass_xforms.F90
M       models/atm/cam/src/chemistry/mozart/mo_photo.F90
M       models/atm/cam/src/chemistry/mozart/mo_setinv.F90
M       models/atm/cam/src/chemistry/mozart/mo_sulf.F90
M       models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M       models/atm/cam/src/chemistry/mozart/short_lived_species.F90
M       models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M       models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
M       models/atm/cam/src/chemistry/mozart/upper_bc.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/chemistry/utils/msise00.F90
M       models/atm/cam/src/chemistry/utils/solar_data.F90

M       models/atm/cam/src/control/cam_comp.F90
M       models/atm/cam/src/control/cam_history.F90
M       models/atm/cam/src/control/cam_restart.F90
M       models/atm/cam/src/control/camsrfexch.F90
M       models/atm/cam/src/control/history_defaults.F90
M       models/atm/cam/src/control/physconst.F90
M       models/atm/cam/src/control/rgrid.F90
M       models/atm/cam/src/control/sat_hist.F90
M       models/atm/cam/src/control/scamMod.F90
M       models/atm/cam/src/control/wrap_nf.F90

M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90

M       models/atm/cam/src/dynamics/eul/comspe.F90
M       models/atm/cam/src/dynamics/eul/courlim.F90
M       models/atm/cam/src/dynamics/eul/dyndrv.F90
M       models/atm/cam/src/dynamics/eul/eul_control_mod.F90
M       models/atm/cam/src/dynamics/eul/forecast.F90
M       models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90
M       models/atm/cam/src/dynamics/eul/iop.F90
M       models/atm/cam/src/dynamics/eul/prognostics.F90
M       models/atm/cam/src/dynamics/eul/restart_dynamics.F90
M       models/atm/cam/src/dynamics/eul/scanslt.F90
M       models/atm/cam/src/dynamics/eul/spmd_dyn.F90
M       models/atm/cam/src/dynamics/eul/stepon.F90

M       models/atm/cam/src/dynamics/fv/ctem.F90
M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
M       models/atm/cam/src/dynamics/fv/dyn_comp.F90
M       models/atm/cam/src/dynamics/fv/inidat.F90
M       models/atm/cam/src/dynamics/fv/metdata.F90
M       models/atm/cam/src/dynamics/fv/par_xsum.F90
M       models/atm/cam/src/dynamics/fv/spmd_dyn.F90
M       models/atm/cam/src/dynamics/fv/stepon.F90
M       models/atm/cam/src/dynamics/fv/sw_core.F90

M       models/atm/cam/src/dynamics/homme/dp_coupling.F90
M       models/atm/cam/src/dynamics/homme/dyn_grid.F90
M       models/atm/cam/src/dynamics/homme/interp_mod.F90
M       models/atm/cam/src/dynamics/homme/native_mapping.F90

M       models/atm/cam/src/dynamics/sld/comspe.F90
M       models/atm/cam/src/dynamics/sld/courlim.F90
M       models/atm/cam/src/dynamics/sld/inidat.F90
M       models/atm/cam/src/dynamics/sld/prognostics.F90
M       models/atm/cam/src/dynamics/sld/restart_dynamics.F90
M       models/atm/cam/src/dynamics/sld/scan2.F90
M       models/atm/cam/src/dynamics/sld/scanslt.F90
M       models/atm/cam/src/dynamics/sld/spmd_dyn.F90
M       models/atm/cam/src/dynamics/sld/stepon.F90

M       models/atm/cam/src/physics/cam/aer_rad_props.F90
M       models/atm/cam/src/physics/cam/boundarydata.F90
M       models/atm/cam/src/physics/cam/cam3_aero_data.F90
M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/chem_surfvals.F90
M       models/atm/cam/src/physics/cam/cldwat2m_macro.F90
M       models/atm/cam/src/physics/cam/cloud_diagnostics.F90
M       models/atm/cam/src/physics/cam/comsrf.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M       models/atm/cam/src/physics/cam/diffusion_solver.F90
M       models/atm/cam/src/physics/cam/eddy_diff.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/micro_mg1_0.F90
M       models/atm/cam/src/physics/cam/micro_mg1_5.F90
M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
M       models/atm/cam/src/physics/cam/molec_diff.F90
M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/physics/cam/ndrop_bam.F90
M       models/atm/cam/src/physics/cam/physics_types.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/radae.F90
M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/cam/radiation_data.F90
M       models/atm/cam/src/physics/cam/tropopause.F90
M       models/atm/cam/src/physics/cam/uwshcu.F90

M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90

M       models/atm/cam/src/physics/rrtmg/radsw.F90
M       models/atm/cam/src/physics/rrtmg/rrtmg_state.F90

M       models/atm/cam/src/physics/waccm/gw_drag.F90
M       models/atm/cam/src/physics/waccm/iondrag.F90
M       models/atm/cam/src/physics/waccm/qbo.F90
M       models/atm/cam/src/physics/waccm/waccm_forcing.F90
M       models/atm/cam/src/physics/waccmx/ionosphere.F90

M       models/atm/cam/src/utils/abortutils.F90
M       models/atm/cam/src/utils/cam_dom/ocn_spmd.F90
M       models/atm/cam/src/utils/cam_dom/ocn_time_manager.F90
M       models/atm/cam/src/utils/cam_dom/sst_data.F90

M       models/atm/cam/src/utils/pilgrim/decompmodule.F90
M       models/atm/cam/src/utils/pilgrim/mod_comm.F90

M       models/atm/cam/src/utils/spmd_utils.F90
M       models/atm/cam/src/utils/time_manager.F90

=====================

M       models/atm/cam/src/chemistry/mozart/mo_drydep.F90
         - Change leading dimension of dummy argument rh to "ncol", to
           match the dimensions of the actual argument.

M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
         - Ensure that extfrc and reaction_rates always have non-zero
           size. (When extcnt or rxntot are 0, the arrays will have
           a trailing dimension of 1, but will not actually be used.)
            - Size zero arrays are not a problem with NAG, but these
              arrays have default values assigned, and this cannot be
              done for arrays with no elements to assign.

M       models/atm/cam/src/chemistry/mozart/mo_setsox.F90
         - Fix a case where a variable that was only set for 7-mode MAM
           was being referenced in all MAM cases.
            - It appears that only 7-mode MAM would actually enter the
              block where this reference occurred, so this caused no
              apparent problems and passed runtime checks on other
              compilers.

M       models/atm/cam/src/chemistry/mozart/wei96.F90
         - Remove unnecessary common block that impaired readability
           during debugging.

M       models/atm/cam/src/chemistry/utils/tracer_data.F90
         - Implemented workaround for a (still poorly understood) bug
           with the netCDF builds on Frankfurt, where netCDF stores
           a pointer to output dimension IDs and then overwrites them.
         - Change "write(*,*)" to "write(iulog,*)".
         - Nullify pointer in specify_fields if it will not be
           allocated.

M       models/atm/cam/src/control/infnan.F90
         - Internal variables replaced with references to shr_infnan_mod.
         - bigint removed; integers that were set to bigint are
           now set to huge(1).

M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
M       models/atm/cam/src/utils/buffer.F90
M       models/atm/cam/src/utils/buffer.F90.in
         - Cast physics buffer pointers back to their original type (and
           thus correct size) before deallocating.

M       models/atm/cam/src/physics/cam/rad_constituents.F90
         - Correct string with subroutine name.

M       models/atm/cam/src/physics/cam/restart_physics.F90
         - Randomly shuffle use statements to avoid bug with PGI on
           Frankfurt.

M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
         - Remove assumption that constituents 2 and 3 are cldliq and
           cldice.

M       models/atm/cam/src/utils/cam_dom/ocn_comp.F90
         - Close I/O unit before attempting to reuse it to open a new
           file.

M       models/atm/cam/src/utils/cam_pio_utils.F90
         - Fix integer overflow in find_iodesc.
M       models/atm/cam/src/utils/namelist_utils.F90
         - Now only a wrapper for shr_nl_mod.

M       models/atm/cam/test/system/CAM_runcmnd.sh
M       models/atm/cam/test/system/TBR.sh
M       models/atm/cam/test/system/TER.sh
M       models/atm/cam/test/system/TSM.sh
M       models/atm/cam/test/system/test_driver.sh
         - Add NAG to regression test compilers on Frankfurt.
         - For some cases, NAG requires ocn_modelio.nml to be written.
         - Set "ulimit -c unlimited" for Frankfurt, since this is generally
           desirable if a regression test fails, and does not seem to be
           inherited from the user's environment.

M       models/atm/cam/test/system/TCB.sh
M       models/atm/cam/test/system/TCB_ccsm.sh
         - Changes necessary to perform standalone build with new CICE,
           wav component, and scripts.

Some files with purely whitespace or comment changes:
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
M       models/atm/cam/tools/interpic_new/interpolate_data.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

082 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 7 at Tue Apr  9 05:22:41 MDT 2013
085 bl992 TBL_ccsm.sh f19_g16 ETEST 2d ....................................FAIL! rc= 7 at Tue Apr  9 05:27:33 MDT 2013

The updated version of Machines has a new version of the Intel compilers on
yellowstone. It was therefore expected that some TBL_ccsm tests might fail.

Additionally, TEQ_ccsm tests will fail until either version 13 of the Intel
compiler becomes the default on yellowstone, or test_driver.sh is updated
to specify version 13.

The TEQ_ccsm test did in fact pass with the compiler version bumped:
082 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................PASS at Tue Apr  9 11:09:14 MDT 2013

frankfurt/lf95: All PASS.

frankfurt/pgi or jaguar/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 


All CAM configurations are bit-for-bit, excepting CESM cases with changes
due to updated Machines.


If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_18
Originator(s): santos, mmills, bardeenc, hannay
Date: Apr 8, 2013
One-line Summary: Update externals and namelist for CARMA and HOMME

Purpose of changes:

 - Update CARMA external with several bug fixes. These are described in the
   CARMA ChangeLog at:
         models/atm/cam/src/physics/carma/base/ChangeLog
 - Add use cases for new WACCM/CARMA sulfur and nuclear winter compsets.
 - Source code updates for CARMA sulfate model to interact with chemistry.

 - Update HOMME with NAG-compatible version and bug fix for vector
   Laplacian operation.
 - Updates to HOMME namelist (see below). The most important change is that
   the vertically Lagrangian advection method is now the default.
 - Update namelist_definition.xml to describe HOMME namelist settings in
   more detail (some descriptions and assistance from Mark Taylor).

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

 - For HOMME cases, we use the flag "-DHAVE_F2003_PTR_BND_REMAP", as F2003
   pointer bounds remapping appears to be supported on all current
   compilers (except Lahey, which we no longer test with HOMME). If this
   causes problems, this flag will have to be set on a per-compiler basis
   in CAM's Makefile.in and Machines.

Describe any changes made to the namelist:

 - New CARMA sulfate model flag "carma_do_hetchem" toggles the use of CARMA
   sulfate surface area density in heterogeneous chemistry rate
   calculations.

 - SO2 forcing is no longer automatically added for waccm_mozart_sulfur.

 - Many HOMME changes:
    - Switch from Eulerian to Lagrangian vertical advection method.
    - Turn on energy fixer.
    - Correct nu_p value for ne30np4.
    - Correct both nu_p and nu_div for ne16np4 (necessary for stability).
    - Set default nu_q to -1.D0, which automatically sets nu_q = nu within
      HOMME.
    - ne120np4 with vertically Lagrangian code has experimental settings
      from John Truesdale.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_sulfur.xml
A       models/atm/cam/bld/namelist_files/use_cases/waccm_cam4_nuclear_winter.xml
         - Use cases for SD-WACCM sulfur and nuclear winter compsets.

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
         - Update csm_share external to get new shr_spfn_mod module. This is
           necessary for the NAG port update, including the HOMME external
           pulled in in this tag.

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
         - Update CARMA & HOMME externals.

M       models/atm/cam/bld/Makefile.in
         - Define CPRLAHEY and CPRGNU for the respective compilers; used by
           the new csm_share.

M       models/atm/cam/bld/build-namelist
         - Add carma_do_hetchem to CARMA sulfate model.
         - Remove logic that always adds an SO2 forcing file for
           waccm_mozart_sulfur.

M       models/atm/cam/bld/configure
         - Add "-DHAVE_F2003_PTR_BND_REMAP" to HOMME flags.

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
         - Changes to HOMME namelist.

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
         - Add carma_do_hetchem.
         - Update HOMME namelist documentation.

M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M       models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M       models/atm/cam/src/physics/cam/carma_flags_mod.F90
M       models/atm/cam/src/physics/carma/models/sulfate/carma_model_mod.F90
         - If carma_do_hetchem is .true., use CARMA sulfate surface area
           density in mozart chemistry.

M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
         - Minor tweaks (e.g. radiation_scheme is now discovered through
           phys_getopts rather than guessing based on the number of bands).

M       models/atm/cam/src/physics/carma/models/bc_strat/carma_model_mod.F90
         - Remove comment that should have only been in the cirrus model.

M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
         - Fix comment typo.

D       models/atm/cam/test/system/config_files/f1.9c4carmsulm
A       models/atm/cam/test/system/config_files/fsd1.9c4wcarmsulm
D       models/atm/cam/test/system/config_files/f1.9c5carmbc_m
A       models/atm/cam/test/system/config_files/f1.9c4wcarmbc_m
M       models/atm/cam/test/system/input_tests_master
D       models/atm/cam/test/system/nl_files/carma24h
A       models/atm/cam/test/system/nl_files/outfrq24h_carma
         - CARMA test changes:
            - Remove old sulfate and bc_strat tests and replace them with
              WACCM tests that more closely match the new CESM compsets
              (including the new use cases).
            - Rename carma24h to outfrq24h_carma (similar to outfrq3s_*).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

076 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Sun Apr  7 22:31:44 MDT 2013
079 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Sun Apr  7 22:52:24 MDT 2013
088 bl997 TBL_ccsm.sh ne16_g37 FC5 2d .....................................FAIL! rc= 7 at Sun Apr  7 23:13:39 MDT 2013

frankfurt/lf95: All tests PASS

frankfurt/pgi or jaguar/pgi: 

059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Sun Apr  7 21:28:48 MDT 2013
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Sun Apr  7 22:43:14 MDT 2013

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

   - All HOMME cases and CARMA cirrus and sulfate cases.

- what platforms/compilers: All
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):
   - Above roundoff, but same climate.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_2_17 
Originator(s): fischer, bsingh, eaton, 
Date: April 5, 2013 
One-line Summary: Prescribed MAM update

Purpose of changes:
. Merge in latest changes for prescribed MAM.
. Add default namelist support for prescribed MAM.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

A       models/atm/cam/bld/namelist_files/use_cases/1850_cam5_pm.xml
.       new use_case for 1850 prescribed MAM     
     
A       models/atm/cam/test/system/config_files/fn1.9c5dh
M       models/atm/cam/test/system/tests_pretag_yellowstone
M       models/atm/cam/test/system/input_tests_master
.       new prescribed MAM test

M       models/atm/cam/test/system/test_driver.sh
.       Fixed frankfurt intel tests  

M       models/atm/cam/bld/Makefile.in
.       Removed -DNO_MPI2 rule for dyn_grid.F90   

M       models/atm/cam/src/dynamics/homme/dyn_grid.F90
M       models/atm/cam/src/utils/spmd_utils.F90
.       Add #define DNO_MPI2 1

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
.       Add checks for prescribed bulk/modal aerosol variables

M       models/atm/cam/bld/build-namelist
.       Updated prescribed mam variable list
.       Fixed logic to allow prescribed bulk and modal aerosol namelist
        varibles to be set to defaults

M       models/atm/cam/bld/perl5lib/Build/Namelist.pm
.       Modify Namelist.pm to recognize comment lines in namelist input files.
        The previous code only recognized end of line comments.

M       models/atm/cam/src/physics/cam/convect_shallow.F90
.       Changes to option name for physics_ptend_init

M       models/atm/cam/src/physics/cam/gw_drag.F90
.       Changes to option name for physics_ptend_init

M       models/atm/cam/src/chemistry/utils/tracer_data.F90
. Change scalar file%in_pbuf to an array.

M       models/atm/cam/src/chemistry/utils/prescribed_aero.F90
.  Merge in changes from cam1/branch_tags/aerosol_tags/aerosol002_cam5_2_10
.  Allocate file%in_pbuf and initialize

M       models/atm/cam/src/physics/waccm/waccm_forcing.F90
M       models/atm/cam/src/chemistry/utils/aerodep_flx.F90
M       models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
M       models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
M       models/atm/cam/src/chemistry/utils/aircraft_emit.F90
M       models/atm/cam/src/chemistry/utils/tracer_data.F90
M       models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
M       models/atm/cam/src/chemistry/mozart/mo_tgcm_ubc.F90
M       models/atm/cam/src/chemistry/mozart/mo_sulf.F90
M       models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M       models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
M       models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
M       models/atm/cam/src/chemistry/mozart/linoz_data.F90
M       models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
.  Allocate file%in_pbuf and initialize



If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: 
014 bl322 TBL.sh fn1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Apr  4 21:56:30 MDT 2013
. New test for prescribed MAM

frankfurt/lf95: all passed 

frankfurt/pgi: all passed 


===============================================================
===============================================================

Tag name: cam5_2_16
Originator(s): Cheryl Craig, Pete Bogenschutz and Sean Santos
Date: April 1, 2013
One-line Summary: CLUBB tunings for scientifically validated release

Purpose of changes:

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
- Introduced sol_facti_cloud_borne to allow tuning, default value is 1.0
- Changed tuning of dust_emis_fact_dyn for CLUBB
- Changed tuning of sol_facti_cloud_borne for CLUBB

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
          - Utilizing modified CLUBB library

M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M       models/atm/cam/src/chemistry/mozart/chemistry.F90
          - Introduced sol_facti_cloud_borne tuning parameter

M       models/atm/cam/src/physics/cam/clubb_intr.F90
M       models/atm/cam/src/physics/cam/micro_mg1_0.F90
M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
          - CLUBB tunings

M       models/atm/cam/src/physics/cam/microp_aero.F90
          - Temporary CLUBB tuning

M       models/atm/cam/src/physics/cam/micro_mg1_5.F90
          - CLUBB tunings and revised routine from Sean

M       models/atm/cam/src/physics/cam/convect_deep.F90
          - Moved initializations of prec and snow to after they are acquired

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: All BFB except CLUBB, which is expected to fail due to new tunings
040 bl366 TBL.sh f1.9c5clbdm outfrq3s_clubb 9s ............................FAIL! rc= 7 at Sat Mar 30 01:45:03 MDT 2013

frankfurt/lf95: All BFB

frankfurt/pgi or jaguar/pgi: All BFB

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_15
Originator(s): fvitt, tilmes
Date: 29 Mar 2013
One-line Summary: CAM-Chem and WACCM updates

Purpose of changes:

 - call endrun when lower boundary conditions are specified
   in more than one manner via bndtvghg, flbc_file, or *vmr namelist
   variables to prevent multiple specification of lower boundary conditions
 - remove deprecated waccm_mozart_v1 chemistry package
 - replace chemistry package trop_strat_bam_v1 with trop_strat_soa
 - update chemistry in packages:
    trop_mozart_mam3
    trop_mozart_mam7
    trop_mozart_soa
 - set default nspltvrm to 2 for waccm_phys ( waccm and waccmx )
 - corrections to surface area calculations of modal aerosols
 - correction to units of the SOA*_PROD diagnostics
 - restrict message logging to masterproc in many of the chemistry modules
 - update to MEGAN factors input file
 - update to solar protons input file
 - update to SAD input file
 - update to sulfate file
 - new build-namelist use cases:
    2000_cam5_trop_moz_mam3
    2000_cam4_trop_strat_soa
    2000_cam5_trop_strat_mam3
    2000_cam5_trop_strat_mam7

Bugs fixed (include bugzilla ID):
             Bug #: 1639
           Summary: reduce stdout from cam

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

D     models/atm/cam/src/chemistry/pp_waccm_mozart_v1
 - deprecated chemistry package removed

D     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1
 - mechanism placed by pp_trop_strat_soa

D     models/atm/cam/src/chemistry/utils/mo_regrider.F90
 - removed this deprecated module that only works on regular lat/lon grids

List all subroutines added and what they do:

A     models/atm/cam/test/system/nl_files/outfrq3s_mozEOOH
 - added for mechanisms that have EOOH chemical tracer

A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_lu_solve.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_setrxt.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_adjrxt.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_rxt_rates_conv.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_imp_sol.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/chem_mods.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_prod_loss.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_lin_matrix.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/m_rxt_id.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_phtadj.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_nln_matrix.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_lu_factor.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_sim_dat.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/mo_indprd.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/m_spc_id.F90
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/chem_mech.doc
A     models/atm/cam/src/chemistry/pp_trop_strat_soa/chem_mech.in
A     models/atm/cam/src/chemistry/pp_trop_strat_soa
 - chemical mechanism added to replace trop_strat_bam_v1

A     models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_moz_mam3.xml
A     models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_strat_soa.xml
A     models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam3.xml
A     models/atm/cam/bld/namelist_files/use_cases/2000_cam5_trop_strat_mam7.xml
 - new build-namelist use case files

List all existing files that have been modified, and describe the changes:

M     models/atm/cam/test/system/config_files/wm1.9c4h
 - changed "waccm_mozart_v1" to "waccm_mozart"

M     models/atm/cam/test/system/config_files/fst1.9c4dh
 - changed "trop_strat_bam_v1" to "trop_strat_soa"

M     models/atm/cam/test/system/config_files/fsoa4c4dm
 - correction to -nosmp config option

M     models/atm/cam/test/system/tests_chem_hybrid
 - moved SOA tests to be first

M     models/atm/cam/test/system/test_driver.sh
 - set yellowstone queue to $CAM_BATCHQ

M     models/atm/cam/test/system/input_tests_master
 - adjustments for outfrq3s_mozEOOH namelist options

M     models/atm/cam/bld/configure
 - removed chemistry package waccm_mozart_v1
 - replaced chemistry package trop_strat_bam_v1 with trop_strat_soa
 - adjusted number of advected tracers in chemistry packages
   trop_strat_mam3
   trop_strat_mam7
   trop_mozart_mam3

M     models/atm/cam/bld/config_files/definition.xml
 - removed chemistry package waccm_mozart_v1
 - replaced chemistry package trop_strat_bam_v1 with trop_strat_soa

M     models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - waccm_mozart_v1 defaults removed
 - update to megan_factors_file
 - update to default SAD file -- default for WACCMX also
 - update to sulfate file
 - update to photolysis cross sections
 - set defaults of nspltvrm, nspltac and nsplit when waccm_phys is used

M     models/atm/cam/bld/namelist_files/master_gas_wetdep_list.xml
M     models/atm/cam/bld/namelist_files/master_drydep_list.xml
 - updates to species lists

M     models/atm/cam/bld/namelist_files/namelist_definition.xml
 - increase in megan_specifier string (to 1024 characters)

M     models/atm/cam/bld/namelist_files/use_cases/sd_waccm_geos5.xml
M     models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
 - update to solar proton input file
 - removed bndtvghg -- this is redundant specification of lower boundary with flbc_file

M     models/atm/cam/bld/namelist_files/use_cases/waccm_1955-2005_cam4.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp85.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp26.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
M     models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
 - removed bndtvghg -- this is redundant specification of lower boundary with flbc_file
 - update SPE file

M     models/atm/cam/bld/namelist_files/use_cases/mozart_megan_emis.xml
M     models/atm/cam/bld/namelist_files/use_cases/soa_chem_megan_emis.xml
 - update to megan_factors_file
 - corrected emissions from files
 - set megan_mapped_emisfctrs to .false.
 - included a fincl1 list
 - include IC files

M     models/atm/cam/bld/build-namelist
 - removed waccm_mozart_v1 setting
 - replaced "trop_strat_bam_v1" with "trop_strat_soa"
 - set default nsplit and nspltrac for waccm_phys
 - set default srf_emis_cycle_yr to 2000 for waccm_mozart_mam3 chemistry

M     models/atm/cam/bld/perl5lib/Build/ChemNamelist.pm
 - removed kludge to set wet deposition list for waccm_mozart_v1

M     models/atm/cam/src/physics/cam/chem_surfvals.F90
 - call endrun if both bndtvghg and flbc_file are specified


M     models/atm/cam/src/chemistry/utils/mo_flbc.F90
 - call endrun if lower boundary is specified in more than one manner

M     models/atm/cam/src/chemistry/mozart/mo_neu_wetdep.F90
 - map EOOH to CH2O

M     models/atm/cam/src/physics/waccm/gw_drag.F90
M     models/atm/cam/src/chemistry/utils/mo_solar_parms.F90
M     models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M     models/atm/cam/src/chemistry/mozart/mo_jlong.F90
M     models/atm/cam/src/chemistry/mozart/upper_bc.F90
M     models/atm/cam/src/chemistry/mozart/wei96.F90
M     models/atm/cam/src/chemistry/mozart/mo_jshort.F90
M     models/atm/cam/src/chemistry/mozart/mo_chemini.F90
M     models/atm/cam/src/chemistry/mozart/mo_aurora.F90
M     models/atm/cam/src/chemistry/mozart/mo_apex.F90
M     models/atm/cam/src/chemistry/mozart/mo_fstrat.F90
M     models/atm/cam/src/chemistry/mozart/mo_sad.F90
M     models/atm/cam/src/chemistry/mozart/efield.F90
 - restrict message logging to masterproc

M     models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - interface changes to mo_sulf and mo_drydep
 - zero out topospheric sulfate above tropopause and
   stratospheric sulfate below the tropopause

M     models/atm/cam/src/chemistry/mozart/chemistry.F90
 - interface changes to mo_sulf

M     models/atm/cam/src/chemistry/mozart/mo_lightning.F90
M     models/atm/cam/src/chemistry/mozart/mo_strato_sad.F90
 - removed use mo_regrider statement -- mo_regrider not used in these modules

M     models/atm/cam/src/chemistry/mozart/mo_sulf.F90
 - replaced the use of mo_regrider with tracer_data utility module

M     models/atm/cam/src/chemistry/mozart/mo_drydep.F90
 - replaced the use of mo_regrider with lininterp_data module
   which will regrid data on unstructure grids
 - depostition velocity of EOOH mapped to CH2O

M     models/atm/cam/src/chemistry/mozart/linoz_data.F90
 - misc code clean up

M     models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
 - correction to units of the SOA*_PROD diagnostics
 - correction for changing soa* tag names

M     models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - corrections to surface area calculations of modal aerosols

M     models/atm/cam/src/chemistry/pp_trop_bam/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_ghg/mo_sim_dat.F90
 - preprocessor re-ran on these mechanisms to give updated data

M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_lu_solve.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_prod_loss.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_lin_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_nln_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_lu_factor.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/m_spc_id.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.in
 - mechanism updates

M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_lu_solve.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_prod_loss.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_lin_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/m_rxt_id.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_nln_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_lu_factor.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/m_spc_id.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.in
 - mechanism updates

M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_lu_solve.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_prod_loss.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_lin_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/m_rxt_id.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_nln_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_lu_factor.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/m_spc_id.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mech.in
 - mechanism updates

M     models/atm/cam/src/chemistry/pp_waccm_ghg/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_waccm_mozart/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_mam3/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_bam/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_mam7/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_ghg/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_imp_sol.F90
 - correction for renaming the soa1 tag name

M     SVN_EXTERNAL_DIRECTORIES
 - chem proprocessor updates

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Wed Mar 27 19:14:26 MDT 2013
 - expected failure due to default setting of nspltvrm

070 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Wed Mar 27 21:22:55 MDT 2013
 - expected failure due to default setting of nspltvrm
 - changed chemistry mechanism from waccm_mozart_v1 to waccm_mozart

048 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Wed Mar 27 20:11:43 MDT 2013
052 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Wed Mar 27 20:22:14 MDT 2013
055 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Wed Mar 27 20:29:51 MDT 2013
 - changes in input files

057 bl430 TBL.sh fm1.9c5dh outfrq3s_mozEOOH 9s ............................FAIL! rc= 7 at Wed Mar 27 20:38:59 MDT 2013
 - changes in chemistry mechanism and input files

060 bl440 TBL.sh fsoa1.9c4dh outfrq3s_mozEOOH+soa_chem_megan_emis 9s ......FAIL! rc= 7 at Wed Mar 27 20:55:25 MDT 2013

frankfurt/lf95:
030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Mar 27 19:27:30 MDT 2013
 - expected failure due to default setting of nspltvrm

frankfurt/pgi:
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Mar 27 15:31:43 MDT 2013
 - expected failure due to default setting of nspltvrm

056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Wed Mar 27 16:38:04 MDT 2013
 - expected failure due to changes in photolysis inputs

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_2_14 
Originator(s): fischer, hannay
Date: Fri Mar 15 11:09:40 MDT 2013
One-line Summary:  Add namelist variables to control history file output, generate 
                   pre cam5_2_13 baselines, waccm sc ic file

Purpose of changes:

.  Namelist variables history_amwg, history_aerosol, history_eddy, and history_budget
   are setup to control the history file outputs.  These are boolean flags that are 
   used to control the add_default calls.  history_amwg is the only one that defaults to
   true.
.  A -b argument was added to test_driver.sh, incase there is a need to generate baselines
   for pre cam5_2_13 tags.  Usage would be test_driver.sh -f -b
.  New better logic in test_driver.sh to handle command line arguments
.  New ne30 initial condition file for waccm_sc_2000_cam4.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
M       models/atm/cam/bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
.  Changed ne30np4 ic from cami_ne30np4_L66_SC_WACCM_c121127.nc to
                           f.e11.FWSC.ne30_ne30.wm_SE.003.cam.i.0006-01-01-00000.nc
.  Add history_amwg, history_aerosol,  history_budget, and history_eddy to control
   variables being saved to history files.  The default is history_amwg is true,
   the rest are false.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer, eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/archive_baseline.sh
. Change group write permission

M       models/atm/cam/test/system/TCB.sh
M       models/atm/cam/test/system/TBR.sh
M       models/atm/cam/test/system/TER.sh
M       models/atm/cam/test/system/TSM.sh
.  Turn on extra history output for cam3/4/5

M       models/atm/cam/test/system/TBL_ccsm.sh
M       models/atm/cam/test/system/TBL.sh
.  Add logic to be able to create pre cam5_2_13 baselines

M       models/atm/cam/test/system/test_driver.sh
.  Improve logic for handling command line arguments 
.  Add -b argument to be able to generate baselines for pre cam5_2_13 tags.

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
.  Remove history_microphysics variable
.  Set defaults for history_amwg(true), history_aerosol(false), 
   history_eddy(false), and history_budget(false)

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
.  Add history_amwg and history_eddy, removed history_microphyics

M       models/atm/cam/bld/build-namelist
.  Add history_amwg, history_aerosol, history_budget, and history_eddy to namelists
   Remove history_microphysics

M       models/atm/cam/src/physics/cam/cloud_diagnostics.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/tropopause.F90
M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/cam/cloud_cover_diags.F90
M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/aer_rad_props.F90
M       models/atm/cam/src/physics/cam/phys_control.F90
M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/gw_drag.F90
M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M       models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
M       models/atm/cam/src/dynamics/fv/dyn_comp.F90
. Move add_default into conditionals based on history_amwg, history_aerosol, 
  history_budget, and history_eddy.  Remove history_microphysics.  

M       models/atm/cam/bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
.  Change ic file for ne30np4


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel: all passed

frankfurt/lf95:  all passed

frankfurt/pgi: all passed 


===============================================================
===============================================================

Tag name: cam5_2_13 
Originator(s): fischer, eaton, cacraig, cecila, jedwards, Mark Taylor
Date: 3-11-2013
One-line Summary: test script improvements, homme update, external updates, bug fixes,
                  change solar namelist defaults

Purpose of changes:

. The default for the solar data namelist variables was being set
  differently for the configurations "-phys cam5 -chem trop_mam3" and
  "-phys cam5 -chem none".  This was changed to make the value for
  prescribed aerosols be the same as for prognostic aerosols.  Also added
  a check to build-namelist to disallow setting both solar_const and
  solar_data_file.  It only makes sense to set one of these variables.

.  Made changes to test scripts to improve testing on yellowstone.  
   - -j option was added to be able to specify number of of jobs for gmake.
     The default setting of -j was unlimited, which was producing slower builds
     than specifying -j 4, -j 8, or -j 16.
   - Fix issues with builds on yellowstone being repeated done when it
     fails to build the first time.
   - Fix issues with builds being tried on yellowstone compute nodes.
   - Add CAM_RBOPTIONS to give more flexibility on how builds are done.
     Valued values are "build_only", "run_only" and "run_and_build"
     CAM_RBOPTIONS is passed to the other test scripts through the argument
     list.  The effect of this change is this tag cannot make a baseline for
     previous tags.
   - Option for pgi testing was added, but not working yet.

.  SVN externals were updated to match cesm1_2_beta02.  
   - Issues with PIO forced the use of a later PIO tag.
   - Also, the Machines tag wasn't updated do to failed tests with intel/13.0.1

. CAM-SE (homme) external was update to homme1_3_17

Bugs fixed (include bugzilla ID):
.  Fixed long name for SNOWHICE.  Bugzilla #945
.  Fix memory leak by adding missing deallocate.  Bugzilla #1629

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer, fvitt

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
 M       models/atm/cam/test/system/tests_pretag_yellowstone
 M       models/atm/cam/test/system/tests_posttag_yellowstone
.  Move sm415 and bl415(fst1.9c5dh) from pretag to posttag test.
.  Replaced sm993(ne30_g16), er993, and bl993 with sm997(ne16_g37),er997, and bl997

 M       models/atm/cam/test/system/input_tests_master
.  Add an ne16_g37 cesm test sm997, er997, and bl997

 D       models/atm/cam/test/system/TBL_cb.sh
 D       models/atm/cam/test/system/TNE_cb_ccsm.sh
 D       models/atm/cam/test/system/TBL_cb_ccsm.sh
 D       models/atm/cam/test/system/TSC_cb.sh
 .  These test scripts are no longer needed.

 M       models/atm/cam/test/system/test_driver.sh
.  Changed pes layouts for yellowstone and frankfurt
.  Removed bluefire logic
.  Add -j command line option to set the number of jobs for gmake
.  Changed logic for yellowstone builds, added new enviroment variable
   CAM_RBOPTIONS, valide values are 'build_only', 'run_only', and 'run and build'
.  Started adding pgi support for yellowstone, currently not working.

 M       models/atm/cam/test/system/TCB.sh
 M       models/atm/cam/test/system/TDD.sh
 M       models/atm/cam/test/system/TCB_ccsm.sh
 M       models/atm/cam/test/system/TBL.sh
 M       models/atm/cam/test/system/TBR.sh
 M       models/atm/cam/test/system/TPF.sh
 M       models/atm/cam/test/system/TER.sh
 M       models/atm/cam/test/system/TEQ_ccsm.sh
 M       models/atm/cam/test/system/TER_ccsm.sh
 M       models/atm/cam/test/system/TSM_ccsm.sh
 M       models/atm/cam/test/system/TMC.sh
 M       models/atm/cam/test/system/TBL_ccsm.sh
 M       models/atm/cam/test/system/TSC.sh
 M       models/atm/cam/test/system/TEQ.sh
 M       models/atm/cam/test/system/TNE_ccsm.sh
 M       models/atm/cam/test/system/TSM.sh
.  Pass CAM_RBOPTIONS to test scripts through argument list
.  Add logic to handle CAM_RBTIONS

 M       models/atm/cam/bld/configure
.  remove a debug print
.  Updated build filepaths for changes in the clm directory structure to
   handle multiple versions of clm (clm4.0, clm4.5)

 M       models/atm/cam/bld/namelist_files/use_cases/cam4_trop_strat_chem.xml
.  remove extraneous setting of solar_const

 M       models/atm/cam/bld/build-namelist
.  add check to disallow setting both solar_const and solar_data_file
.  change how solar namelist defaults are set so that for cam5 physics the
   defaults don't depend on which chemistry package is used.  The defaults
   for cam4 physics continue to depend on whether chemistry is used or not.

 M       models/atm/cam/bld/perl5lib/Build/Namelist.pm
.  add delete_variable method

 M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
.  Fixed long name for SNOWHICE.  Bugzilla #945

 M       models/atm/cam/src/utils/cam_pio_utils.F90
.  Fix memory leak by adding missing deallocate.  Bugzilla #1629

 M       models/atm/cam/src/chemistry/mozart/short_lived_species.F90
.  Bug fix to pbuf_set_field
 
 M       models/atm/cam/src/dynamics/homme/dyn_comp.F90
.  Bug fix for dynamics timestep when using lagrangian code.

 M       models/atm/cam/src/dynamics/fv/te_map.F90
.  Abort if vertical levels cross.  This prevents some unstable runs in
   various FV CAM and WACCM simulations.

 M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 .  Update homme(SE) external

 M       SVN_EXTERNAL_DIRECTORIES
 .  Update svn external to match cesm1_2_beta02.  Issues with pio forced the
    use of a later version of pio.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
.  All passed

frankfurt/lf95: 
035 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Thu Mar  7 17:07:33 MST 2013
.  Changed ntasks from 8 to 16, causes answer changes in COSP due to known bugs in COSP code

frankfurt/pgi: 
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Mar  7 12:39:38 MST 2013
.  Changed ntasks from 8 to 16, causes answer changes in COSP due to known bugs in COSP code
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Thu Mar  7 12:46:18 MST 2013
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Thu Mar  7 12:49:13 MST 2013
. The change to solar input defaults change answers for configurations with
  the args "-phys cam5 -chem none".


CAM tag used for the baseline comparison tests if different than previous
tag:

===============================================================
===============================================================

Tag name: cam5_2_12
Originator(s): fvitt
Date: 01 Mar 2012
One-line Summary: Corrections to super_fast_llnl_mam3 chemistry package
	and misc updates and fixes

Purpose of changes:

 - correct super_fast_llnl_mam3 chemistry package
 - fix in modal_aero_data to avoid index out of range error
 - change history output of SOA* aerosols from VMR to MMR
 - add build-namelist use case for MOZSOA compset
   so that 'NEU' wet deposition scheme is used
 - update solar input files for SD-WACCM
 - update default MEGAN emissions factors input file
 - make chemistry preprocessor more robust

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A     models/atm/cam/bld/namelist_files/use_cases/soa_chem_megan_emis.xml
 - new use case file for MOZSOA compsets -- this uses 'NEU' wet dep method

A     models/atm/cam/test/system/config_files/fsoa4c4dm
 - new SOA chem regestion test

List all existing files that have been modified, and describe the changes:

M     models/atm/cam/test/system/tests_chem_hybrid
M     models/atm/cam/test/system/input_tests_master
M     models/atm/cam/test/system/tests_chem_mpi
 - adjustments to chem tests

M    models/atm/cam/bld/configure
 - minor cleanup associated with customizing chemistry (preprocessor)

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - corrections to prescribed ozone input for SC-WACCM
 - added default IC file for waccm5 at 4x5 resolution
 - update to default MEGAN emissions factors

M    models/atm/cam/bld/build-namelist
 - correction in super_fast_llnl_mam3 linoz and chlorine loading inputs

M  ... /use_cases/..  sd_waccm_geos5 ???
 - updates to solar_data_file and solar_parms_file

M    models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - changes to make preprocessor more robust
  . check if need to re-run preprocessor -- checks changes to input
  . attempt to store executable in a public place so that every user
    does not need to compile every time the preprocessor is needed
  . errors in preprocessor input more apparent

M    models/atm/cam/src/chemistry/mozart/mo_mass_xforms.F90
M    models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
 - avoid index out of range error when index is greater the number of
   registered constituents which can occur when we have chemical tracers
   that are not registered (e.g., H2O in WACCM)

M    models/atm/cam/src/chemistry/pp_super_fast_llnl/m_rxt_id.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mech.in
 - change in tag name of O3 + hv photo reaction to be compatable with
   tag name check in llnl_O1D_to_2OH_adj

M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_setrxt.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_adjrxt.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_rxt_rates_conv.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/m_rxt_id.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_phtadj.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_indprd.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/m_spc_id.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mech.in
 - LLNL corrections to super_fast_llnl_mam3 chem mechanism

M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M    models/atm/cam/src/chemistry/mozart/mo_setz.F90
M    models/atm/cam/src/chemistry/mozart/mo_pchem.F90
M    models/atm/cam/src/chemistry/mozart/llnl_O1D_to_2OH_adj.F90
M    models/atm/cam/src/chemistry/mozart/chemistry.F90
M    models/atm/cam/src/chemistry/mozart/mo_xsections.F90
 - changes for super_fast_llnl_mam3 -- checks for j2oh rxt tag

M     models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
  - output SOA aerosol species in units of kg/kg

M     models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
  - added diagnostics

M     models/atm/cam/src/chemistry/mozart/mo_neu_wetdep.F90
  - map SOG species to H2O2

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
062 bl440 TBL.sh fsoa1.9c4dh outfrq3s+soa_chem_megan_emis 9s ..............FAIL! rc= 7 at Thu Feb 28 14:41:12 MST 2013
 - failed due to change in build-namelist use case

frankfurt/lf95:

030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Feb 28 14:58:28 MST 2013
 - failed due to change in prescribed ozone input file

frankfurt/pgi:

036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Feb 28 10:52:11 MST 2013
 - failed due to change in prescribed ozone input file

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_11
Originator(s): santos
Date: Feb 25, 2013
One-line Summary: Separate MAM top level, code simplifications

Purpose of changes:
 - Separate MAM top level from tropospheric cloud physics
   top level, so that modal aerosols can sediment above the
   clouds in WACCM5.
 - Make "tend" an optional argument to physics_update.
 - Make interpic_new always produce netCDF with 64-bit offset.
 - Cleanup regarding gw_drag.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

 - Add "clim_modal_aero_top_press", the new top level for
   modal aerosol microphysics. By default this is high enough
   that modal aerosol calculations are done throughout the
   WACCM levels, but below most WACCM-X levels.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/bld/build-namelist
        - Add clim_modal_aero_top_lev option with default 1.e-4 Pa.

M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M       models/atm/cam/src/physics/cam/aer_rad_props.F90
M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
        - Change top level from trop_cloud_top_lev to
          clim_modal_aero_top_lev.

M       models/atm/cam/src/physics/cam/physics_types.F90
        - Move the physics_tend argument to the end of
          physics_update's argument list, and make it
          optional.

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
M       models/atm/cam/src/physics/cam/clubb_intr.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
        - Remove dummy physics_tend argument that is no
          longer necessary to call physics_update.

M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/tphysidl.F90
        - Since both versions of gw_drag have a register
          routine now, move gw_drag_register out of
          #ifdef WACCM_PHYS.
        - Move "tend" argument to the end of every
          physics_update call.

M       models/atm/cam/src/physics/cam/gw_drag.F90
        - Add empty subroutine gw_drag_register, so that
          the interface for this module matches the other
          gw_drag.

M       models/atm/cam/src/physics/cam/ref_pres.F90
        - Add clim_modal_aero_top_lev, analogous to
          trop_cloud_top_lev, and force the MAM top to
          be above the cloud top.

M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/physics/waccm/gw_drag.F90
        - Changes with no effect (e.g. white space).

M       models/atm/cam/tools/interpic_new/fmain.F90
        - Remove -64 option, as 64-bit offset is now
          always on.

          WARNING: This will break scripts that specify
          "-64" if they are used on interpic built from
          this tag (or later).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.


  WACCM5 posttag baseline will fail. WACCM5 is bit-for-bit if
  clim_modal_aero_top_press is set to 100 Pa in the new code,
  but the new default is 1.e-4 Pa. Part of ongoing development
  of WACCM5.


yellowstone/intel:

All PASS.

frankfurt/lf95: 

All PASS.

frankfurt/pgi or jaguar/pgi: 

All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
  - WACCM5
- what platforms/compilers:
  - All
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 
  - Affects climate, but can be made bit-for-bit through namelist.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_10
Originator(s): santos
Date: Feb 8, 2013
One-line Summary: saturation vapor pressure fixes, WACCM5 fixes

Purpose of changes:
        - Fix problems with saturation vapor pressure schemes
          discovered during development of cam5_2_02.
        - Fix outstanding problems with WACCM5 that cause it to
          crash, by enforcing trop_cloud_top_lev in more modules
          that require this limit.
        - Make treatment of WACCM4 and WACCM5 more consistent. Both
          now set the same top_lev limiter, but some modules perform
          additional checks for CAM5 features to decide if they want
          to use it.
        - Add "rsplit" namelist option for HOMME (courtesy Cecile
          Hannay).

Bugs fixed (include bugzilla ID):
     "Meta"bugs:
         1588: Incorrect calculation of saturation specific humidity at
               low pressures throughout CAM
     Bugs:
         1583: zm_conv generates NaN and negative values in saturation mmr
               calculation at low pressure
         1584: radae bypasses checks for low pressure when calculating
               saturation specific humidity
         1585: modal_aero_wateruptake bypasses checks for low pressure in
               saturation specific humidity
         1589: Findsp does not conserve enthalpy for very low temperatures

     Enhancements:
         1587: Unify dqsdt calculations in CAM

Describe any changes made to build system:

Describe any changes made to the namelist:

 - Add rsplit option for HOMME.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/build-namelist
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
         - Add rsplit namelist option for HOMME.

M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
         - Set all fields added for clim_modal_aero to 0, to try to
           reduce the chance of uninitialized data use.

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/physics/cam/aer_rad_props.F90
M       models/atm/cam/src/physics/cam/cldwat2m_macro.F90
M       models/atm/cam/src/physics/cam/cloud_fraction.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/microp_driver.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
         - Add top_lev to more loops and array slices.
         - Remove unnecessary/unused logic.
         - The following miscellaneous changes:
           - modal_aero_wateruptake: Change qsat_water call to use
             new version.
           - aer_rad_props: Since trop_cloud_top_lev is now set in WACCM4,
             use it only "if (prog_modal_aero)".
           - cldwat2m_macro: Rename "qsat" to "qs" to avoid confusion with
             wv_saturation intrinsic (and "esat" to "es" to match).
           - cloud_fraction: cldfrc_fice moved from cldwat, and top_lev
             only used if macrop_scheme /= "rk".
           - Microphysics/macrophysics modules: Change indexes to ensure
             that output variables do not contain uninitialized data above
             top_lev.

M       models/atm/cam/src/chemistry/utils/tracer_data.F90
M       models/atm/cam/src/physics/cam/uwshcu.F90
         - Comment changes only.

M       models/atm/cam/src/physics/cam/cldwat.F90
         - Replace k1mb with top_lev.
         - Update calculation of dqsdt to use new code (and remove check for
           low pressure that is now done in wv_sat_methods).
         - Because cldwat_fice is shared code between CAM4 and CAM5, it
           has been moved to cloud_fraction. The resulting code is only
           used by RK microphysics and thus no longer checks microp_scheme.

M       models/atm/cam/src/physics/cam/micro_mg1_0.F90
M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/radae.F90
M       models/atm/cam/src/physics/cam/radlw.F90
M       models/atm/cam/src/physics/cam/zm_conv.F90
         - Update code that did SVP calculations without proper limits for
           low pressure, and/or used a method other than the CAM default.
         - ntopcld moved, and is now max(trop_cloud_top_lev,2).
         - SVP conversion from Pa to hPa has been moved back into zm_conv,
           since the requirement is specific to this module and not used
           by any other CAM module.

M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
         - Moved "inimc" call from physpkg to stratiform, since cldwat
           is not used at all unless RK microphysics is on.
         - Slight simplifications to stratiform constituent logic.

M       models/atm/cam/src/physics/cam/wv_sat_methods.F90
         - Do proper pressure limiting in qsat/qmmr functions.
         - Changed wv_sat_svp_trans to work correctly for ttrice == 0._r8.
         - Bolton water scheme now outputs in Pa, like the other schemes.

M       models/atm/cam/src/physics/cam/wv_saturation.F90
         - Remove "legacy" functions and special function for ZM.
         - Remove multiple copies of tmin; SVP calculations are now
           always performed down to 127.16K.
         - Fix findsp enthalpy checking at low temperatures, and generally
           improve consistency/integration with wv_saturation. Enthalpy is
           now always checked to ensure conservation.
           - Note: Findsp used to ENDRUN with a non-convergence error for
             very low temperatures. This (sometimes beneficial) checking
             behavior was unintentional, and only triggered in certain edge
             cases. Now findsp will abort the run only if a problem occurs
             while it is running, and not due to bad input. If necessary,
             temperatures should be checked elsewhere.
         - Cleanup changes:
           - trinv removed.
           - estblf reorganized, and uses kind=r8 in aint.
           - Pull out enthalpy formula for findsp into a function
             (tq_enthalpy).
           - Enthalpy at saturation can now be calculated as an optional
             argument to the qsat routines.
           - Temperature derivative optional outputs from qsat_* routines
             are calculated in a separate (shared) function.

M       models/atm/cam/src/physics/waccm/gw_drag.F90
         - Prevent divide by 0 if wind happens to be exactly 0 at certain
           points.
         - Prevent segfault from certain bad winds by avoiding use of "abs"
           to limit integer indices. This is just to avoid a "red herring"
           crash in gw_drag, when the real problem is elsewhere.

D       models/atm/cam/test/system/config_files/wm1.9c5h
A       models/atm/cam/test/system/config_files/wm1.9c5dh
M       models/atm/cam/test/system/input_tests_master
         - WACCM5 test is now a debug test, to catch some common errors
           that occurred during development.
         - Change "outfrq3s" to "outfrq3s_clubb" in CLUBB baseline test.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:

004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Fri Feb  8 15:44:21 MST 2013
006 bl133 TBL.sh e48c4paqdm aqpgro+aquaplanet_cam4 3s .....................FAIL! rc= 7 at Fri Feb  8 15:44:22 MST 2013
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Fri Feb  8 15:44:27 MST 2013
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Feb  8 15:44:28 MST 2013
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Fri Feb  8 15:44:33 MST 2013
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Fri Feb  8 15:44:39 MST 2013
023 bl333 TBL.sh f4c4paqdh aqpgro+aquaplanet_cam4 3s ......................FAIL! rc= 7 at Fri Feb  8 15:44:40 MST 2013
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Fri Feb  8 15:45:08 MST 2013
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Fri Feb  8 15:45:12 MST 2013
040 bl366 TBL.sh f1.9c5clbdm outfrq3s_clubb 9s ............................FAIL! rc= 7 at Fri Feb  8 15:45:12 MST 2013
043 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Fri Feb  8 15:45:25 MST 2013
048 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Feb  8 15:45:47 MST 2013
050 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Fri Feb  8 15:45:56 MST 2013
052 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Fri Feb  8 15:46:19 MST 2013
055 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Fri Feb  8 15:46:31 MST 2013
057 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Fri Feb  8 15:47:08 MST 2013
059 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Feb  8 15:47:35 MST 2013
062 bl440 TBL.sh fsoa1.9c4dh outfrq3s+mozart_megan_emis 9s ................FAIL! rc= 7 at Fri Feb  8 15:48:00 MST 2013
066 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Fri Feb  8 15:48:07 MST 2013
069 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Fri Feb  8 15:48:12 MST 2013
072 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Fri Feb  8 15:49:16 MST 2013
075 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Fri Feb  8 15:49:21 MST 2013
078 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Fri Feb  8 15:49:37 MST 2013
084 bl992 TBL_ccsm.sh f19_g16 ETEST 2d ....................................FAIL! rc= 7 at Fri Feb  8 15:49:41 MST 2013
087 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Fri Feb  8 15:50:11 MST 2013

frankfurt/lf95: 

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Feb  8 14:44:16 MST 2013
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Feb  8 14:44:19 MST 2013
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Feb  8 14:44:22 MST 2013
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Feb  8 14:44:31 MST 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Feb  8 14:45:18 MST 2013
027 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Fri Feb  8 14:45:19 MST 2013
030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Feb  8 14:45:27 MST 2013
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Feb  8 14:45:28 MST 2013
035 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Fri Feb  8 14:45:32 MST 2013

frankfurt/pgi or jaguar/pgi: 

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Feb  8 14:46:31 MST 2013
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Feb  8 14:46:35 MST 2013
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Feb  8 14:46:35 MST 2013
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Feb  8 14:46:38 MST 2013
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Feb  8 14:46:44 MST 2013
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Feb  8 14:47:30 MST 2013
033 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Fri Feb  8 14:47:31 MST 2013
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Feb  8 14:47:41 MST 2013
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Fri Feb  8 14:47:43 MST 2013
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Feb  8 14:47:43 MST 2013
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Feb  8 14:47:51 MST 2013
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Fri Feb  8 14:47:56 MST 2013
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Fri Feb  8 14:48:00 MST 2013
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Fri Feb  8 14:48:05 MST 2013
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Fri Feb  8 14:48:31 MST 2013
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Fri Feb  8 14:49:20 MST 2013
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Fri Feb  8 14:50:25 MST 2013


**All CAM physics cases fail baseline tests due to wv_saturation bug fixes.**



CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
  - All CAM physics cases (everything but ideal and adiabatic).

- what platforms/compilers:
  - All.

- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

   - Above roundoff but same climate as previous version and CESM1.1.1
     This was demonstrated with:

     - A CAM5 present day case (FC5, 1 degree), with code based on
       cam5_2_03, run for 5 years.
     - A fully-coupled 1850 WACCM case (B1850WCN, 2 degree), with code
       based on cam5_2_06, run for 25 years.
       - This run is in the experiment DB with ID #1635.
       - The case name is: b.e11.B1850WCN.f19_g16.test_lim.001
     - A fully-coupled 1850 CAM5 case (B1850C5CN, 2 degree) is also
       in the run database, but has not had its climate compared with
       CESM 1.1.1.
       - ID #1634
       - Case name is b.e11.B1850C5CN.f19_g16.test_lim.001

     - Finite-volume cases are bit-for-bit between cam5_2_06 and
       cam5_2_09, except that there is a roundoff-level difference due
       to changes to shr_reprosum_mod in csm_share.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_09 
Originator(s): Cheryl Craig
Date: 1/28/13
One-line Summary: Dynamic state,tend,ptend

Purpose of changes:
  - Introduce dynamic state,tend, ptend structures and supporting routines for use with sub-columns
  - eliminated MODAL_AERO ifdef and replaced with rad_constituent interface inside ndrop.F90 (Eaton modification)
  - Removed CLUBB_core from repository and the directory models/atm/cam/src/physics/clubb is now an external library
  - Added Yellowstone pretag test for CLUBB
  - Add module load mkl for CLUBB library
  - renamed sub_column to microp_uniform to better reflect its purpose inside microp routines

Bugs fixed (include bugzilla ID):
  - Corrected flag for the intel compiler to ignore temp array creation

Describe any changes made to build system:
  - Introduced new configure parameter "psubcols".  Default is 1 = no subcolumns.  

Describe any changes made to the namelist:
  - Introduced use_subcol_microp - Switch which will be used to control sub-columns within microphysics
    Namelist flag is accessed in phys_control, but it is not used inside CAM yet

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:
D       models/atm/cam/src/physics/CLUBB_core
D       models/atm/cam/src/physics/CLUBB_core/constants_clubb.F90
D       models/atm/cam/src/physics/CLUBB_core/variables_prognostic_module.F90
D       models/atm/cam/src/physics/CLUBB_core/interpolation.F90
D       models/atm/cam/src/physics/CLUBB_core/clip_explicit.F90
D       models/atm/cam/src/physics/CLUBB_core/saturation.F90
D       models/atm/cam/src/physics/CLUBB_core/mono_flux_limiter.F90
D       models/atm/cam/src/physics/CLUBB_core/mixing_length.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_zm.F90
D       models/atm/cam/src/physics/CLUBB_core/file_functions.F90
D       models/atm/cam/src/physics/CLUBB_core/mean_adv.F90
D       models/atm/cam/src/physics/CLUBB_core/grid_class.F90
D       models/atm/cam/src/physics/CLUBB_core/pdf_closure_module.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_zt.F90
D       models/atm/cam/src/physics/CLUBB_core/parameter_indices.F90
D       models/atm/cam/src/physics/CLUBB_core/hyper_diffusion_4th_ord.F90
D       models/atm/cam/src/physics/CLUBB_core/csr_matrix_class_3array.F90
D       models/atm/cam/src/physics/CLUBB_core/input_reader.F90
D       models/atm/cam/src/physics/CLUBB_core/parameters_model.F90
D       models/atm/cam/src/physics/CLUBB_core/error_code.F90
D       models/atm/cam/src/physics/CLUBB_core/lapack_wrap.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_rad_zm.F90
D       models/atm/cam/src/physics/CLUBB_core/parameters_radiation.F90
D       models/atm/cam/src/physics/CLUBB_core/mt95.f90
D       models/atm/cam/src/physics/CLUBB_core/endian.F90
D       models/atm/cam/src/physics/CLUBB_core/recl.inc
D       models/atm/cam/src/physics/CLUBB_core/parameters_microphys.F90
D       models/atm/cam/src/physics/CLUBB_core/gmres_cache.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_rad_zt.F90
D       models/atm/cam/src/physics/CLUBB_core/sigma_sqd_w_module.F90
D       models/atm/cam/src/physics/CLUBB_core/hydrostatic_module.F90
D       models/atm/cam/src/physics/CLUBB_core/array_index.F90
D       models/atm/cam/src/physics/CLUBB_core/anl_erf.F90
D       models/atm/cam/src/physics/CLUBB_core/T_in_K_module.F90
D       models/atm/cam/src/physics/CLUBB_core/calendar.F90
D       models/atm/cam/src/physics/CLUBB_core/model_flags.F90
D       models/atm/cam/src/physics/CLUBB_core/advance_windm_edsclrm_module.F90
D       models/atm/cam/src/physics/CLUBB_core/pos_definite_module.F90
D       models/atm/cam/src/physics/CLUBB_core/pdf_parameter_module.F90
D       models/atm/cam/src/physics/CLUBB_core/fill_holes.F90
D       models/atm/cam/src/physics/CLUBB_core/sponge_layer_damping.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_variables.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_subs.F90
D       models/atm/cam/src/physics/CLUBB_core/variables_radiation_module.F90
D       models/atm/cam/src/physics/CLUBB_core/numerical_check.F90
D       models/atm/cam/src/physics/CLUBB_core/stat_file_module.F90
D       models/atm/cam/src/physics/CLUBB_core/input_names.F90
D       models/atm/cam/src/physics/CLUBB_core/output_netcdf.F90
D       models/atm/cam/src/physics/CLUBB_core/diffusion.F90
D       models/atm/cam/src/physics/CLUBB_core/advance_wp2_wp3_module.F90
D       models/atm/cam/src/physics/CLUBB_core/advance_xm_wpxp_module.F90
D       models/atm/cam/src/physics/CLUBB_core/extrapolation.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_sfc.F90
D       models/atm/cam/src/physics/CLUBB_core/surface_varnce_module.F90
D       models/atm/cam/src/physics/CLUBB_core/clip_semi_implicit.F90
D       models/atm/cam/src/physics/CLUBB_core/clubb_core.F90
D       models/atm/cam/src/physics/CLUBB_core/stats_type.F90
D       models/atm/cam/src/physics/CLUBB_core/clubb_precision.F90
D       models/atm/cam/src/physics/CLUBB_core/advance_helper_module.F90
D       models/atm/cam/src/physics/CLUBB_core/gmres_wrap.F90
D       models/atm/cam/src/physics/CLUBB_core/Skw_module.F90
D       models/atm/cam/src/physics/CLUBB_core/parameters_tunable.F90
D       models/atm/cam/src/physics/CLUBB_core/advance_xp2_xpyp_module.F90
D       models/atm/cam/src/physics/CLUBB_core/output_grads.F90
D       models/atm/cam/src/physics/CLUBB_core/variables_diagnostic_module.F90
          - Removed CLUBB_core from repository and the directory 
            models/atm/cam/src/physics/clubb is now an external library

List all subroutines added and what they do:
A  +    models/atm/cam/test/system/config_files/f1.9c5clbdm
A  +    models/atm/cam/test/system/nl_files/outfrq3s_clubb
          - Added Yellowstone pretag test for CLUBB

A       models/atm/cam/bld/run-yellowstone.csh
          - Example build and run script for yellowstone

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/test_driver.sh
          - Add module load mkl for CLUBB library

M       models/atm/cam/test/system/tests_pretag_yellowstone
M       models/atm/cam/test/system/input_tests_master
          - Added Yellowstone pretag test for CLUBB
          
MM      models/atm/cam/bld/configure
MM      models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/src/physics/cam/ppgrid.F90
          - Added psubcols.  Changed CLUBB_core directory to clubb.

MM      models/atm/cam/bld/Makefile.in
          - Corrected flag for the intel compiler to ignore temp array creation

MM      models/atm/cam/bld/config_files/definition.xml
MM      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
MM      models/atm/cam/bld/build-namelist
M       models/atm/cam/src/physics/cam/phys_control.F90
          - Added use_subcol_microp switch to control sub-columns in microphysics

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
          - CLUBB code is now in an external library

M       models/atm/cam/src/physics/cam/microp_aero.F90
          - last microphysics fields which were in calling lists were added to pbuf

MM      models/atm/cam/src/physics/cam/micro_mg_cam.F90
          - "sub_column" renamed "microp_uniform" to better describe variable
          - modifications using new dynamically dimensioned state/tend/ptend

M       models/atm/cam/src/physics/cam/physics_types.F90
          - modifications for dynamically dimensioned state/tend/ptend
          - added new routines physics_state_alloc, physics_tend_alloc, physics_ptend_alloc,
            physics_state_dealloc, physics_tend_dealloc, and physics_ptend_dealloc
          - state now has:
                            ngrdcol       -- Grid        -- number of active columns (on the grid)
                            nsubcol(pcols)-- Sub-columns -- number of active sub-columns in each grid column
                            psetcols      --             -- max number of columns set - if subcols = pcols*psubcols, else = pcols
                            ncol          --             -- sum of nsubcol for all ngrdcols - number of active columns
                            indcol(pcols*psubcols)       -- indices for mapping from subcols to grid cols
          - ptend and tend now has:
                            psetcols      --             -- max number of columns set - if subcols = pcols*psubcols, else = pcols
          - new routine physics_ptend_copy_subcol - copies ptend on grid to ptend on subcols

M       models/atm/cam/src/physics/cam/ndrop.F90
          - eliminated MODAL_AERO ifdef and replaced with rad_constituent interface (Eaton modification)

M       models/atm/cam/src/physics/cam/clubb_intr.F90
          - modifications using new dynamically dimensioned state/tend/ptend
          - eliminated MODAL_AERO ifdef and now uses rad_constituent interface
	  - corrected bug found with Intel compiler in rho calculation 

M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/microp_driver.F90
          - microp_aero_run and summing with microp ptend now called in tphysbc instead of inside microp_driver_tend
          - modifications using new dynamically dimensioned state/tend/ptend

MM      models/atm/cam/src/physics/cam/micro_mg1_0.F90
M       models/atm/cam/src/physics/cam/micro_mg1_5.F90
          - renamed sub_column to microp_uniform to better reflect its purpose

M       models/atm/cam/src/physics/cam/tphysidl.F90
M       models/atm/cam/src/physics/cam/rayleigh_friction.F90
M       models/atm/cam/src/physics/cam/tracers.F90
M       models/atm/cam/src/physics/cam/radheat.F90
M       models/atm/cam/src/physics/cam/check_energy.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
M       models/atm/cam/src/physics/cam/carma_intr.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/convect_deep.F90
M       models/atm/cam/src/physics/cam/gw_drag.F90
M       models/atm/cam/src/physics/cam/iondrag.F90
M       models/atm/cam/src/physics/cam/aoa_tracers.F90
M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/bc_strat/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_tracers/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sulfate/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_swelling/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_detrain/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_radiative/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_growth/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_passive/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
M       models/atm/cam/src/physics/waccm/iondrag.F90
M       models/atm/cam/src/physics/waccm/radheat.F90
M       models/atm/cam/src/physics/waccm/gw_drag.F90
M       models/atm/cam/src/physics/waccm/qbo.F90
M       models/atm/cam/src/chemistry/pp_none/chemistry.F90
M       models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M       models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
M       models/atm/cam/src/chemistry/mozart/chemistry.F90
M       models/atm/cam/src/dynamics/sld/dp_coupling.F90
M       models/atm/cam/src/dynamics/sld/stepon.F90
M       models/atm/cam/src/dynamics/eul/dp_coupling.F90
M       models/atm/cam/src/dynamics/eul/stepon.F90
M       models/atm/cam/src/dynamics/homme/dp_coupling.F90
M       models/atm/cam/src/dynamics/homme/stepon.F90
M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
M       models/atm/cam/src/dynamics/fv/stepon.F90
          - modifications using new dynamically dimensioned state/tend/ptend

M       models/atm/cam/doc/ChangeLog

 M      models/atm/cam/test/system/tests_pretag_frankfurt_pgi
 M      models/atm/cam/test/system/tests_posttag_frankfurt
 M      models/atm/cam/test/system/tests_pretag_frankfurt_lahey
 M      models/atm/cam/bld/namelist_files
 M      models/atm/cam/src/control/camsrfexch.F90
 M      models/atm/cam/src/cpl_share/cam_cpl_indices.F90
 M      models/atm/cam/src/cpl_mct/atm_comp_mct.F90
 M      models/atm/cam/src/physics/cam/comsrf.F90
 M      models/atm/cam/src/physics/cam/wv_sat_methods.F90
 M      models/atm/cam/src/physics/cam/uwshcu.F90
 M      models/atm/cam/src/dynamics
 M      models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
040 bl366 TBL.sh f1.9c5clbdm outfrq3s 9s ..................................FAIL! rc= 7 at Wed Jan 30 16:31:23 MST 2013
    - This is a new regression test for CLUBB.  CLUBB was tested offline by both Cheryl Craig and Pete Bogenschutz.
   
frankfurt/lf95: all passed 

frankfurt/pgi: all passed 


Summarize any changes to answers, i.e.,: none

===============================================================
===============================================================

Tag name: cam5_2_08 
Originator(s): fischer
Date: Jan 25th, 2013
One-line Summary: Remove SRFRAD, new diagnostics, chem preprocessor build, 
                  update externals, fix dust_emis_fact 

Purpose of changes:
  -Remove unneeded SRFRAD from the monthly averaged output
   AMWG diagnostics uses SRFRAD to compute flwds, but FLDS can 
   used instead.
  -New diagnostics added for aerosol burdens and weed speeds.
  -Update to the chemistry preprocessor to recognize the intel 
   compiler on yellowstone.
  -SVN externals updated to match cesm1_2_beta01 externals.
  -dust_emis_fact was being set to .35 for CAM-SE5, should be set to .55


Bugs fixed (include bugzilla ID):
  -Bugzilla #1618, remove misleading SRFRAD variable

Describe any changes made to build system:
  -New information about the fc_type is being passed to the chemistry
   preprocessor build scripts.  This is to correct a problem with the
   chem preprocessor not recognizing the intel compiler on yellowstone.

Describe any changes made to the namelist:
  -dust_emis_fact was being set to .35 instead of .55 when dyn="homme", tms="1", and
   phys="cam5".  The problem was there was a better match for the .35 value
   than the .55 value.  This was fixed by added tests for tms and phys to the
   .55 value, making it the better match.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/archive_baseline.sh
.  Set read permissions for archived files

M       models/atm/cam/test/system/tests_pretag_yellowstone
.  Returned sm376, bl376, and ne996 test for the chemistry preprocessor

M       models/atm/cam/bld/Makefile.in
.  Add flag for the intel compiler to ignore temp array creation

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
.  Fixed bug where dust_emis_fact was being set to .35 instead of .55 for
   CAM-SE 5

M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccmx_2000_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_refb1.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam5.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp26.xml
M       models/atm/cam/bld/namelist_files/use_cases/cam4_trop_strat_chem.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1955-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp85.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1974-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam5.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccmx_1996_cam4.xml
.  Removed SRFRAD from namelist

M       models/atm/cam/src/control/camsrfexch.F90
M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
.  Removed srfrad.  Moved calculation for netsw from camsrfexch to 
   the radiation_trend subroutines.

M       models/atm/cam/bld/configure
M       models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
.  Add new argument fc_type to be passed to ChemPreprocess.pm.  This is needed to
   build on yellowstone using intel.

M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
. Add new diagnostics variables for aerosol burdens and wind speeds.

M       SVN_EXTERNAL_DIRECTORIES
. Update externals to match cesm1_2_beta01
  clm tag updated to branch_tags/nmlfix_tags/nmlfix01_clm4_0_58
  pio tag updated to trunk_tags/pio1_5_7


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
049 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Fri Jan 25 09:54:03 MST 2013
. expected since +testmech was broken on the previous tag

084 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Fri Jan 25 10:32:33 MST 2013
. answer changes expected for CAM_SE5


frankfurt/lf95: all passed 

frankfurt/pgi: all passed 


Summarize any changes to answers, i.e.,: all bfb, except CAM-SE using cam5
                                         physics.

===============================================================
===============================================================

Tag name: cam5_2_07
Originator(s): santos
Date: Jan 23, 2012
One-line Summary: HOMME update, move repro_sum_mod, WACCM-SE

Purpose of changes:

  - Update CESM externals.
   - Note: "setup" has been renamed to "cesm_setup", and
     "env_pesetup.xml" has been renamed back to "env_mach_pes.xml"
   - csm_share updated for to get working (and recently
     improved!) shr_reprosum_mod.
   - During debugging, updated the driver, Machines, and scripts.
     While this was unnecessary, these were verified BFB, so
     were updated anyway.
   - RTM had to be updated for the driver update. build_namelist
     had to be updated due to RTM namelist changes. Note that
     standalone CAM has RTM off by default, so no answer changes.

 - Update HOMME external (and make changes to interface layer
   to accomodate this).
 - Add changes that were waiting on this update:
   - repro_sum_mod is deleted, and modules now use
     shr_reprosum_mod from csm_share
   - New routine and first namelist options for WACCM-SE
     (WACCM+HOMME, still under development).
 - Fix WACCM5 restart test that fails since cam5_2_05 (diagnostic
   variables were not being initialized above top_lev, so random
   unused garbage above that level was in the output files).
 - Fix HOMME settings for ne120np4.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

 - Replace do_rtm = .false. with rtm_mode = "NULL", for RTM update.

 - Standalone CAM still allows modification of reprosum module
   options, but these are now written to a driver namelist.

 - New HOMME settings for ne120np4.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

D       models/atm/cam/src/utils/repro_sum_x86.c
D       models/atm/cam/src/utils/repro_sum_mod.F90
        - Eliminated in favor of shr_reprosum_mod in csm_share.

List all subroutines added and what they do:

A       models/atm/cam/src/dynamics/homme/gravity_waves_sources.F90
        - New module with HOMME-compatible frontogenesis calculation
          (for WACCM).

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
        - Update driver, RTM, csm_share, scripts, Machines, and HOMME.

M       models/atm/cam/bld/build-namelist
        - Update for RTM with CAM standalone.

M       models/atm/cam/bld/configure
        - Allow WACCM+HOMME configurations.
        - Define NC=4 for new HOMME.

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
        - WACCM-SE defaults for ne30np4.
        - Specify which defaults in the use_cases are for fv only.
        - Add ne30np4 data set for FWSC compset.
	- Fix default parameters for ne120np4 resolution.

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
        - Move RTM and reprosum options (see above).

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90
        - Remove use of shr_kind_r4 (cleanup).

M       models/atm/cam/src/chemistry/mozart/mo_lightning.F90
M       models/atm/cam/src/dynamics/fv/d2a3dikj.F90
M       models/atm/cam/src/dynamics/fv/fv_prints.F90
M       models/atm/cam/src/dynamics/fv/mean_module.F90
M       models/atm/cam/src/dynamics/fv/p_d_adjust.F90
M       models/atm/cam/src/dynamics/fv/par_xsum.F90
M       models/atm/cam/src/physics/cam/phys_gmean.F90
M       models/atm/cam/src/physics/cam/polar_avg.F90
        - Change use of repro_sum_mod to shr_reprosum_mod.

M       models/atm/cam/src/control/cam_comp.F90
        - Nullify pointers in module scope.

M       models/atm/cam/src/control/cam_restart.F90
        - Change dyn_in/dyn_out declarations to "intent(inout)"
          (to preserve allocation of pointer components).

M       models/atm/cam/src/control/runtime_opts.F90
        - Remove processing of repro_sum_mod options.

M       models/atm/cam/src/dynamics/fv/ctem.F90
        - Put explicit limits on arrays in par_xsum call (leftover
          cleanup from debugging, will be necessary for NAG).

M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
M       models/atm/cam/src/physics/cam/phys_control.F90
M       models/atm/cam/src/physics/cam/physics_types.F90
        - Remove WACCM_PHYS "ifdef" statements in favor of equivalent
          runtime switch in phys_control.
        - When dynamic state changes arrive, this will also be used
          to change allocation of frontgf/frontga.

D       models/atm/cam/src/physics/waccm/gravity_waves_sources.F90
A       models/atm/cam/src/dynamics/fv/gravity_waves_sources.F90
        - Moved FV-specific gravity_waves_sources from WACCM, since
          this module is dycore-specific.

M       models/atm/cam/src/dynamics/homme/dp_coupling.F90
M       models/atm/cam/src/dynamics/homme/stepon.F90
        - Add call to gravity_waves_sources for WACCM.
        - HOMME update changes (see below).
        - Check for negative temperatures in d_p_coupling and abort
          with a debug message if any are found.

M       models/atm/cam/src/dynamics/homme/dyn_comp.F90
M       models/atm/cam/src/dynamics/homme/dyn_grid.F90
M       models/atm/cam/src/dynamics/homme/inidat.F90
M       models/atm/cam/src/dynamics/homme/restart_dynamics.F90
        - Change interface to HOMME for the updated version.
          - Remove timelevel dimension from elem%state%Q.
          - Add calls to Timelevel_Qdp to get Qdp-specific timelevel
            index.
          - Rename references to "cslam" to "fvm".
        - Remove logic for deprecated or removed options.
          - "leapfrog" scheme not supported.
          - tracer_advection_formulation is now always
            TRACERADV_TOTAL_DIVERGENCE.
        - dyn_import_t and dyn_export_t are now created with pointer
          components nullified. This means that they usually must be
          "intent(inout)" arguments to maintain those pointers'
          association. (Using "intent(out)" was already incorrect
          Fortran, but still worked with most compilers.)

M       models/atm/cam/src/physics/cam/geopotential.F90
        - Changed arrays to assumed shape in order to prevent
          creation of temporary copies (flagged by ifort).

M       models/atm/cam/src/physics/cam/micro_mg1_5.F90
        - Change mistaken use of qin to qi (bug fix for
          sub_column=.true., which is not yet turned on).
        - Correct spelling of "heterogeneous".

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
        - Initialize diagnostic output above top_lev (prevents
          garbage from being output above top_lev in WACCM5).

M       models/atm/cam/src/physics/cam/pkg_cld_sediment.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
        - Pure cleanup changes.

M       models/atm/cam/src/physics/waccm/qbo.F90
        - Removed unused FV-specific dependencies. QBO forcing does
          not currently work with HOMME, but removing these dependencies
          is necessary for the module to be compiled in a HOMME case.

M       models/atm/cam/test/system/archive_baseline.sh
        - New script for archiving CAM regression test baselines on
          current testing machines.

M       models/atm/cam/test/system/TCB_ccsm.sh
        - Update for CESM scripts.

M       models/atm/cam/test/system/test_driver.sh
        - Remove "impi" module on yellowstone, as MPICH is supposedly
          faster.

M       models/atm/cam/tools/interpic_new/Makefile
        - Add ifort and make it default compiler (so that interpic_new
          can be used on yellowstone out-of-the-box).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

 - All baselines using the HOMME dycore are expected to fail due to
   the updated external.
 - All baselines for cases that used repro_sum_mod are expected to
   fail due to updates to the csm_share version.
   - In practice, this means HOMME cases (which would fail baseline
     tests anyway), and most FV cases.

yellowstone/intel:

013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Jan 11 03:02:02 MST 2013
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Fri Jan 11 03:05:43 MST 2013
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Fri Jan 11 03:20:21 MST 2013
026 bl334 TBL.sh f4adh fv2d_8tsk 9s .......................................FAIL! rc= 7 at Fri Jan 11 03:21:51 MST 2013
030 bl335 TBL.sh f4idm idphys 9s ..........................................FAIL! rc= 7 at Fri Jan 11 03:23:22 MST 2013
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Fri Jan 11 03:26:27 MST 2013
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Fri Jan 11 03:34:40 MST 2013
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Fri Jan 11 04:04:58 MST 2013
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Jan 11 05:03:22 MST 2013
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Fri Jan 11 05:07:13 MST 2013
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Fri Jan 11 05:18:56 MST 2013
052 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Fri Jan 11 05:55:46 MST 2013
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Jan 11 06:24:36 MST 2013
057 bl440 TBL.sh fsoa1.9c4dh outfrq3s+mozart_megan_emis 9s ................FAIL! rc= 7 at Fri Jan 11 07:01:50 MST 2013
061 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Fri Jan 11 07:10:08 MST 2013
064 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Fri Jan 11 07:12:28 MST 2013
067 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Fri Jan 11 07:50:50 MST 2013
070 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Fri Jan 11 08:00:33 MST 2013
073 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Fri Jan 11 08:18:07 MST 2013
079 bl992 TBL_ccsm.sh f19_g16 ETEST 2d ....................................FAIL! rc= 7 at Fri Jan 11 08:27:19 MST 2013
082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Fri Jan 11 08:59:27 MST 2013


bluefire:  Most tests run with identical results to yellowstone, but machine
           is being retired

frankfurt/lf95: 

017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Jan 10 19:06:24 MST 2013
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Jan 10 21:55:34 MST 2013
027 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Thu Jan 10 22:07:33 MST 2013
030 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 10 22:37:52 MST 2013
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Thu Jan 10 23:01:07 MST 2013
035 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Thu Jan 10 23:23:40 MST 2013

frankfurt/pgi: 

023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Jan 10 18:03:55 MST 2013
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Jan 10 18:32:55 MST 2013
033 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Thu Jan 10 18:37:10 MST 2013
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 10 18:44:21 MST 2013
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Thu Jan 10 18:49:26 MST 2013
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Thu Jan 10 18:54:43 MST 2013
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 10 19:02:42 MST 2013
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Thu Jan 10 19:08:34 MST 2013
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Thu Jan 10 19:11:07 MST 2013
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Thu Jan 10 19:14:42 MST 2013
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Thu Jan 10 19:30:33 MST 2013
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Thu Jan 10 20:02:34 MST 2013
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Thu Jan 10 21:02:17 MST 2013

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: HOMME and FV dycores
- what platforms/compilers: all
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): roundoff (due to shr_reprosum_mod and HOMME)

If bitwise differences were observed, how did you show they were no worse
than roundoff?
 - Testing of shr_reprosum_mod and HOMME output outside of CAM.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_06 
Originator(s): fischer
Date: Dec 10 2012
One-line Summary: bug fix for yellowstone

Purpose of changes: 
. Use cam erfc function in modal_aero_rename.F90 instead
  of intrinsic erfc function.  This is to get around an error
  on yellowstone.
. Change the queue name for the yellowstone test build 
  script from caldera go gpgpu.  This will give you a 
  dedicated node on caldera, instead of sharing a node.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/test_driver.sh
.  Changed caldera queue to gpgpu to get a dedicate node on caldera to do
   the pre builds.

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90
.  Use cam erfc function instead of intrinsic erfc.  Will cause answer 
   changes for cam5.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Sat Dec  8 00:08:12 MST 2012
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Sat Dec  8 00:12:07 MST 2012
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Sat Dec  8 00:36:50 MST 2012
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Sat Dec  8 00:59:45 MST 2012
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Sat Dec  8 01:43:28 MST 2012
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Sat Dec  8 03:51:51 MST 2012
052 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Sat Dec  8 05:48:46 MST 2012
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Sat Dec  8 07:04:02 MST 2012
082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Sat Dec  8 11:29:06 MST 2012
.  cam5 baselines expected to fail

bluefire:  
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Mon Dec 10 08:29:36 MST 2012
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Mon Dec 10 08:29:39 MST 2012
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Mon Dec 10 08:29:51 MST 2012
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Mon Dec 10 08:30:00 MST 2012
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Mon Dec 10 08:30:26 MST 2012
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Mon Dec 10 08:30:45 MST 2012
054 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Mon Dec 10 09:54:35 MST 2012
056 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Mon Dec 10 10:29:45 MST 2012
084 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Mon Dec 10 11:32:58 MST 2012
.  cam5 baselines expected to fail

frankfurt/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 5 at Mon Dec 10 08:32:42 MST 2012
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 5 at Mon Dec 10 08:32:57 MST 2012
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 5 at Mon Dec 10 08:32:57 MST 2012
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 5 at Mon Dec 10 08:33:11 MST 2012
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 5 at Mon Dec 10 08:33:25 MST 2012
032 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 5 at Mon Dec 10 08:33:39 MST 2012
.  cam5 baselines expected to fail

frankfurt/pgi: 
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 5 at Fri Dec  7 14:51:27 MST 2012
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 5 at Fri Dec  7 14:57:45 MST 2012
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 5 at Fri Dec  7 15:01:36 MST 2012
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 5 at Fri Dec  7 15:05:51 MST 2012
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 5 at Fri Dec  7 15:21:43 MST 2012
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 5 at Fri Dec  7 15:50:54 MST 2012
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 5 at Fri Dec  7 16:21:03 MST 2012
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 5 at Fri Dec  7 16:28:08 MST 2012
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 5 at Fri Dec  7 16:33:12 MST 2012
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 5 at Fri Dec  7 16:35:52 MST 2012
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 5 at Fri Dec  7 16:40:07 MST 2012
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 5 at Fri Dec  7 16:55:40 MST 2012
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 5 at Fri Dec  7 17:26:16 MST 2012
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 5 at Fri Dec  7 18:26:50 MST 2012
.  cam5 baselines expected to fail


===============================================================
===============================================================

Tag name: cam5_2_05
Originator(s): andrew, morrison, santos
Date: Dec 6, 2012
One-line Summary: New "MG1.5" microphysics scheme

Purpose of changes:
 - Added new microphysics scheme 'mg1.5', the next development
   version of the Morrison & Gettelman stratiform cloud microphysics.

Bugs fixed (include bugzilla ID):
 - Bug 1600: CARMA cirrus model fails in build_namelist in cam5_2_02
    - This bug was introduced in cam5_2_02, when the name of wvsat_scheme
      was changed to wv_sat_scheme. The name was not changed in the
      add_default call in build_namelist, so the cirrus model would not
      build.

Describe any changes made to build system:
 - Added mg1.5 option to -microphys configure option.

Describe any changes made to the namelist:
 - Added micro_mg_version and micro_mg_sub_version (MG version numbers).

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A       models/atm/cam/src/physics/cam/micro_mg1_5.F90
         - Alternative microphysics related to micro_mg.F90

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/build-namelist
         - Add micro_mg_version and micro_mg_sub_version to
           represent the version number of MG.
         - Fix bug with CARMA cirrus model and wv_sat_scheme.

M       models/atm/cam/bld/config_files/definition.xml
M       models/atm/cam/bld/configure
	 - Added "mg1.5" as valid option for -microphys.
         - "mg" is preserved as an alias for the old microphysics (which
           is now "mg1").

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
         - Add version number for MG.
	 - Added 1.9x2.5 MG1.5 defaults for cldfrc_rhminl and uwshcu_rpen.

M       models/atm/cam/src/chemistry/utils/tracer_data.F90
         - Initialize pointers in derived types to null (bug fix for
           gfortran, courtesy jedwards).

M       models/atm/cam/src/control/history_defaults.F90
M       models/atm/cam/src/dynamics/eul/inidat.F90
M       models/atm/cam/src/dynamics/eul/iop.F90
M       models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
M       models/atm/cam/src/dynamics/fv/inidat.F90
M       models/atm/cam/src/dynamics/homme/inidat.F90
M       models/atm/cam/src/dynamics/sld/inidat.F90
M       models/atm/cam/src/physics/cam/cloud_fraction.F90
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
M       models/atm/cam/src/physics/rrtmg/ebert_curry.F90
M       models/atm/cam/src/physics/rrtmg/oldcloud.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
M       models/atm/cam/src/physics/rrtmg/slingo.F90
         - Remove unused (or unnecessary) microp_scheme variable.

M       models/atm/cam/src/physics/cam/cldwat.F90
M       models/atm/cam/src/physics/cam/cloud_diagnostics.F90
M       models/atm/cam/src/physics/cam/conv_water.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/microp_driver.F90
M       models/atm/cam/src/physics/cam/phys_control.F90
M       models/atm/cam/src/physics/cam/physics_types.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/pkg_cldoptics.F90
M       models/atm/cam/src/physics/cam/radiation_data.F90
M       models/atm/cam/src/physics/cam/radsw.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
         - Files that did not need to be changed, but retain "cleanup"
           or stylistic changes due to changes to microp_scheme in a
           previous stage.

D       models/atm/cam/src/physics/cam/micro_mg.F90
A       models/atm/cam/src/physics/cam/micro_mg1_0.F90
         - File moved to emphasize place within series.

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
         - Added MG1.5 call, uniform use of top_lev.

M       models/atm/cam/src/physics/cam/stratiform.F90
         - stratiform_implements_cnst now always returns .false.
           if microp_scheme is not RK.

M       models/atm/cam/src/physics/cam/wv_sat_methods.F90
         - "save" attribute is now global.
         - Added qsat methods (non-optional logic from wv_saturation).

M       models/atm/cam/src/physics/cam/wv_saturation.F90
         - Moved qsat_water/ice logic to wv_sat_methods.

A       models/atm/cam/test/system/config_files/f1.0c5mg1_5m
M       models/atm/cam/test/system/input_tests_master
M       models/atm/cam/test/system/tests_posttag_frankfurt
         - Add test for mg1.5.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Thu Dec  6 11:46:02 MST 2012
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Thu Dec  6 12:14:45 MST 2012
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Thu Dec  6 12:37:43 MST 2012
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Thu Dec  6 13:22:20 MST 2012
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Thu Dec  6 15:04:19 MST 2012
052 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Thu Dec  6 17:01:20 MST 2012
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Dec  6 18:17:04 MST 2012
082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Thu Dec  6 22:51:13 MST 2012

bluefire:  
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Thu Dec  6 16:46:46 MST 2012
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Thu Dec  6 16:46:54 MST 2012
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Thu Dec  6 16:47:01 MST 2012
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Thu Dec  6 16:47:15 MST 2012
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Thu Dec  6 16:47:27 MST 2012
054 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Thu Dec  6 16:48:09 MST 2012
056 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Dec  6 16:48:39 MST 2012
084 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Thu Dec  6 19:44:23 MST 2012

frankfurt/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Dec  5 14:13:13 MST 2012
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Dec  5 15:07:40 MST 2012
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Dec  5 15:15:56 MST 2012
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Dec  5 16:24:19 MST 2012
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Dec  5 20:24:51 MST 2012

frankfurt/pgi: 
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Dec  5 13:28:35 MST 2012
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Dec  5 13:38:17 MST 2012
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Dec  5 13:50:04 MST 2012
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Dec  5 14:08:13 MST 2012
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Dec  5 14:44:06 MST 2012
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Dec  5 15:25:27 MST 2012
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Wed Dec  5 15:33:30 MST 2012
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Wed Dec  5 15:37:02 MST 2012
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Wed Dec  5 15:42:24 MST 2012
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Wed Dec  5 16:06:10 MST 2012
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Wed Dec  5 16:50:56 MST 2012
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Wed Dec  5 18:16:15 MST 2012

 - On all systems, CAM5 baselines were expected to fail due to a change in
   diagnostic output. Outside of this output, the model is bit-for-bit.

 - The changes are in these variables: AREI AREL AWNC AWNI FREQI FREQL

 - The only difference is that these variables are now scaled by the
   cloud fraction (liquid or ice, as appropriate).

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:cam5_2_04 
Originator(s): fischer
Date: Tue Dec  5 14:54:12 MST 2012
One-line Summary:  merge in changes from the release tag, yellowstone testing
support

Purpose of changes:
. Merge in changes from release branch tag
  - update for mozart_megan_emis.xml
  - cam-se topo tools from Peter L.
  - Support for SCAM running from cesm script fixed
  - Changed QNEG3 lchnk format from i5 to i7
  - EMIS addfld bug fix
. Fix fincl6lonlat namelist bug
. Support to run cam's test suite on yellowstone.
  - test_driver.sh first submits a build script to
    caldera to build all the needed exacutables.
  - The a run script is submitted to yellowstone.
  - There will be 2 td.*.status files, the first
    is for the builds, the second is for the runs.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer

List all subroutines eliminated:

List all subroutines added and what they do:
A       models/atm/cam/test/system/TNE_cb_ccsm.sh
A       models/atm/cam/test/system/TBL_cb.sh
A       models/atm/cam/test/system/TSC_cb.sh
A       models/atm/cam/test/system/TBL_cb_ccsm.sh
  - script needed to do all pre builds, only used on yellowstone at this time.

A       models/atm/cam/test/system/tests_pretag_yellowstone
A       models/atm/cam/test/system/tests_posttag_yellowstone
  - New test lists for yellowstone, the same as bluefire test lists,
    except for +testmech tests were removed

A       models/atm/cam/tools/topo_tool
  - topography generation tools

A       models/atm/cam/bld/namelist_files/use_cases/arm95_scam.xml
  - use case need to run SCAM with cesm scripts

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/TCB_ccsm.sh
  - Change pes layout for yellowstone

M       models/atm/cam/test/system/test_driver.sh
  -  Added ability to read in an existing test list and build
     everthing that's needed.  Only used on yellowstone.

M       models/atm/cam/test/system/CAM_runcmnd.sh
  - updated to run on yellowstone
 
M       models/atm/cam/src/control/runtime_opts.F90
  - Add fincl6lonlat

M       models/atm/cam/bld/Makefile.in
  - set rules to build dyn_grid.F90 due to mpich2 v1208 bug
  - added rpath to LIB_NETCDF to build test_nc

M       models/atm/cam/bld/namelist_files/use_cases/mozart_megan_emis.xml
  - updated

M       models/atm/cam/doc/ChangeLog_template
  - Add yellowstone/intel to testing results

M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
  - Fixes to run SCAM with cesm scripts

M       models/atm/cam/src/physics/cam/qneg3.F90
  -  Changed QNEG3 lchnk format from i5 to i7

M       models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/bc_strat/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sulfate/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
  -  Removed old comments

M       SVN_EXTERNAL_DIRECTORIES
  - Updated externals to match cesm1_1_beta18.  Machines and scripts tags were
    updated to newer version to get yellowstone support.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

yellowstone/intel:
  All TBL tests failed because previous tag didn't fully support yellowstone.

bluefire:  
059 bl440 TBL.sh fsoa1.9c4dh outfrq3s+mozart_megan_emis 9s ................FAIL! rc= 7 at Sat Dec  1 20:34:10 MST 2012
  update to megan emis use case

frankfurt/lf95: 
  all passed

frankfurt/pgi: 
  all passed

Summarize any changes to answers, i.e.,

===============================================================
===============================================================

Tag name: cam5_2_03
Originator(s): fvitt
Date: 26 Nov 2012
One-line Summary: Chemistry change and fix for WACCM5

Purpose of changes:

 - correction to trop_strat_mam3 chemistry (removed NH4NO3)
 - correction in RRTMG radiation code for WACCM5
 - a workaround for OpenMP problem in SC-WACCM when compiled with
   intel compiler (yellowstone)

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/bld/configure
 - reduced number of advected tracers for trop_strat_mam3 chemistry package

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - changed default IC file for trop_strat_mam7 chemistry

M    models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam5.xml
 - added IC file for WACCM5 at 4x5 resolution

M    models/atm/cam/src/physics/rrtmg/radsw.F90
 - corrections WACCM5

M    models/atm/cam/src/chemistry/utils/tracer_data.F90
 - a workaround for OpenMP problem in SC-WACCM when compiled with intel compiler
 - corrections to reading of zonal-averaged input data which applies only to
   varied arrangment of data dimensions in input file

M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_rxt_rates_conv.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_indprd.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/m_spc_id.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.in
 - removed NH4NO3 from chemical mechanism

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

054 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Thu Nov 15 16:27:37 MST 2012
expected failure due to correction to trop_strat_mam3 chemistry package

frankfurt/lf95: all pass

frankfurt/pgi: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_02
Originator(s): santos
Date: Nov 9, 2012
One-line Summary: Refactoring of wv_saturation module

Purpose of changes:
 - Refactoring of wv_saturation:
   - Consolidate routines in wv_saturation.
   - Pull in related logic from other modules to wv_saturation.
   - Create wv_sat_methods to hold SVP estimation methods separately
     from interface logic.
   - Update interfaces throughout CAM to match.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

 - Changed wvsat_scheme in phys_control to wv_sat_scheme in
   wv_saturation.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

D       models/atm/cam/src/physics/cam/esinti.F90
         - Removed in favor of wv_sat_init in wv_saturation.
D       models/atm/cam/src/physics/cam/gffgch.F90
         - Moved to gffgch_legacy in wv_saturation, in anticipation of
           it being phased out.

List all subroutines added and what they do:

A       models/atm/cam/src/physics/cam/wv_sat_methods.F90
         - Contains the basic formulae used to calculate SVP, and
           simple lookup routines for finding them.
         - Contains the basic formulae to convert SVP to saturation
           specific humidity and saturation mass mixing ratio.

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
         - Moved wvsat_scheme to wv_sat_scheme in wv_sat_nl.

M       models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/physics/cam/aer_rad_props.F90
M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/cloud_fraction.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M       models/atm/cam/src/physics/cam/hk_conv.F90
M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/physics/cam/ndrop_bam.F90
M       models/atm/cam/src/physics/cam/nucleate_ice.F90
M       models/atm/cam/src/physics/cam/radae.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
M       models/atm/cam/src/physics/cam/zm_conv.F90
         - Changed calls to qsat/qsat_water/qsat_ice and/or legacy svp
           functions to match new interface.

M       models/atm/cam/src/physics/cam/eddy_diff.F90
M       models/atm/cam/src/physics/cam/micro_mg.F90
         - Change svp calls to match new interface.
         - Now get gamma and svp functions through use statement
           rather than having them passed in.
         - micro_mg.F90 uses portable layer rather than wv_saturation.

M       models/atm/cam/src/chemistry/mozart/mo_aerosols.F90
         - Removed unnecessary dependence on wv_saturation.

M       models/atm/cam/src/control/physconst.F90
         - Added the triple point of water as h2otrip (used from
           csm_share, equivalent to triple point already used in
           polysvp).
         - Removed unused variables.

M       models/atm/cam/src/control/runtime_opts.F90
         - Add wv_saturation's namelist.

M       models/atm/cam/src/physics/cam/cldwat.F90
M       models/atm/cam/src/physics/cam/cldwat2m_macro.F90
M       models/atm/cam/src/physics/cam/uwshcu.F90
         - Change dependencies on wv_saturation to dependencies on
           physconst.
         - Move findsp to wv_saturation.
         - Change interface of qsat/svp calls.
         - uwshcu gets qsat through use statement rather than as
           an argument.

M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
M       models/atm/cam/src/utils/cam_aqua/shr_flux_mod.F90
         - Trivial cleanup unrelated to wv_saturation (e.g. removal of
           unused dependencies, comment typos).

M       models/atm/cam/src/physics/cam/phys_control.F90
         - Remove wvsat_scheme.

M       models/atm/cam/src/physics/cam/physpkg.F90
         - Call init/final for wv_saturation module.
         - Move some "use" statements around to deal with a PGI bug
           for large modules.

M       models/atm/cam/src/physics/cam/wv_saturation.F90
         - Completely refactored. A list of public routines:
           - Control routines, replacing esinti and other CAM logic:
             - wv_sat_readnl
             - wv_sat_init
             - wv_sat_final
           - SVP calculations, replacing polysvp:
             - svp_water
             - svp_ice
           - SVP table lookup, largely unchanged:
             - estblf
           - SVP to saturation specific humidity conversion:
             - svp_to_qsat
           - SVP to saturation mass mixing ratio conversion:
             - svp_to_qmmr
           - Saturation specific humidity functions, replacing all
             subroutines of the form [a,v]qsat[d[2]][_single]
             - qsat
             - qsat_water
             - qsat_ice
           - Wet bulb temperature solver, replacing findsp[_water]:
             - findsp_vc
           - "Legacy" routines, included only to preserve answers:
             - gffgch_legacy, gffgch_legacy_water
             - qsat_water_legacy
             - qmmr_zm

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All PASS

frankfurt/lf95: All PASS

frankfurt/pgi or jaguar/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_2_01
Originator(s): eaton
Date: Mon Oct 29 10:42:35 MDT 2012
One-line Summary: build changes for yellowstone; remove LCLOUD from default hist output

Purpose of changes:

. Made mods to configure and Makefile.in to account for new compiler
  wrappers used on yellowstone.
. Made some changes to the MCT build part of CAM's configure to allow
  trapping the error return from the MCT configure script.
. Modified the Makefile rules used by configure's -test option so they work
  with the recent changes to build MCT as a separate lib.
. Remove LCLOUD from the default history output.  It is only used by the
  stratus cloud activation, and is not the same as the fraction of liquid
  stratus which is available as LIQCLDF (but is not output by default).
. Move the addfld/outfld calls for AST, LIQCLDF, ICECLDF from micro_mg_cam
  to macrop_driver since these fields are computed by the macrophysics.

Bugs fixed (include bugzilla ID): 

. fix addfld call for EMIS in cam5 radiation (rrtmg).

Describe any changes made to build system: 

. mods for yellowstone and MCT build as noted above

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/configure
. set default CC to mpicc when mpif90 is the fortran compiler
. fix the check for the return status of the MCT configure command

models/atm/cam/bld/Makefile.in
. fix the rules for building test_fc and test_nc by removing the
  specification of $(LDFLAGS).  Now that we build MCT as a separate lib,
  these rules were failing because LDFLAGS contains -lmct which doesn't
  exist yet.  Similar fixes for test_mpi and test_esmf.  Had to add
  $(FFLAGS) to the link commands to pick up the OpenMP flags that
  are in the $(LDFLAGS) macro which was removed.

models/atm/cam/src/physics/cam/microp_aero.F90
. add addfld/outfld call for LCLOUD (moved from ndrop).  Modify long_name
  to 'Liquid cloud fraction used in stratus activation'

models/atm/cam/src/physics/cam/ndrop.F90
. move addfld call for LCLOUD to microp_aero.F90 and remove the add_default
  and outfld calls.

models/atm/cam/src/physics/cam/macrop_driver.F90
. add addfld/outfld calls for AST, LIQCLDF, ICECLDF

models/atm/cam/src/physics/cam/micro_mg_cam.F90
. remove addfld/outfld calls for AST, LIQCLDF, ICECLDF (move to
  macrop_driver) 

models/atm/cam/src/physics/cam/rrtmg/radiation.F90
. fix addfld call for EMIS.  change number of levels from 1 to plev, and
  changed default averaging from 'I' to 'A'


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

frankfurt/lf95: All PASS

frankfurt/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_2_00 
Originator(s): fischer eaton
Date: Tue Oct  9 13:36:42 MDT 2012
One-line Summary: namelist updates, bug fixes

Purpose of changes:

. In cam_diagnostics.F90, the default diagnostic that dqcond is used to
  compute is only written to the history file for 1 constituent (specific
  humidity).  The memory for the other pcnst-1 constituents is allocated and
  set but not used.  In the case where the diagnostic is written for all
  pcnst constituents the data structure was modified to avoid index addresses 
  that don't fit into 32 bit integers. 

. cam's configure script needed to be fixed to pass $mpi_inc and $mpi_lib to the
  MCT configure script, when mpi_inc and mpi_lib are passed in from the configure
  argument list.

. update svn externals to match cesm1_1_alpha18g. 

. Namelist updates for waccmx, sd-waccm and homme.
 
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
. cam configure was updated to pass mpi_lib and mpi_inc, being
  set by arguments to cam's configure, to MCT configure

Describe any changes made to the namelist:
. set dust_emis_fact to .55 for homme
. set so2_emis_file for sd_waccm use_cases
. clm_rtm_inparm group moved to clm_inparm
. sim_year for waccmx_1996_cam4 changed to 2000

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/test_driver.sh
.  intel support on frankfurt

M       models/atm/cam/test/system/CAM_runcmnd.sh
.  use mvapich mpirun for franfurt intel

M       models/atm/cam/bld/configure
.  fix MCT configure to allow mpi_lib and mpi_inc to be set with argument to cam configure

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
.  set dust_emis_fact to .55 for homme

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
.  moved clm_rtm_inparm group to clm_inparm

M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
.  set so2_emis_file

M       models/atm/cam/bld/namelist_files/use_cases/waccmx_1996_cam4.xml
.  Changed sim_year from 1996 to 2000

M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
.  Data allocation fixed to avoid indexing addresses that don't fit into
   32-bit integers.
.  Avoid allocating memory that's not used.

M       models/atm/cam/src/physics/cam/clubb_intr.F90
.  Changes to appease the intel compiler.

M       SVN_EXTERNAL_DIRECTORIES
.  Changed externals to match cesm1_1_alpha18g


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all passed 

frankfurt/lf95:  all passed

frankfurt/pgi: all passed 

===============================================================
===============================================================

Tag name: cam5_1_44
Originator(s): fischer, hannay, eaton
Date: Mon Oct  1 10:29:58 MDT 2012
One-line Summary: SE/cam5 tuning mods; mods for SE in standalone mode; some code cleanup.

Purpose of changes:

. Add tuning mods for SE/cam5 configurations.  Also add "tuned" topo
  dataset for ne30np4.

. Mods to CAM standalone build to support running SE in F compset
  configurations (i.e., active land, thermodynamic cice, and data ocean).
  Up to now the standalone build has only worked for SE running in
  adiabatic, ideal physics, or aquaplanet configurations.

. Some cleanup in the dynamics initialization layer.  In particular remove
  a bunch of dead code from the SE dynamics interfaces.

. The attempt to access the initial file from the dyn_init routine created
  a circular dependency.  Accessing the initial file in the dyn_comp module
  requires it to use startup_initialconds.  But startup_initialconds
  depends on dyn_comp because of the initial_conds method.  Resolve this by
  separating the code that opens the initial and topo files (and is not
  dycore dependent) from the initial_conds routine which reads the initial
  file and is dycore dependent.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:

. support for SE standalone scripts

Describe any changes made to the namelist:

. add some tuning parameters for SE

List any changes to the defaults for the boundary datasets:

. new default for ne16np4 and ne30np4 topo datasets
. new default for ne16np4 soil_erod dataset
. new defaults for SE grids for fsurdat, fatmlndfrc, bndtvs, focndomain

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/control/binary_io.F90
. remove unused file

models/atm/cam/src/dynamics/homme/commap.F90
. eliminate this file.   move module data to dyn_grid

List all subroutines added and what they do:

models/atm/cam/src/control/cam_initfiles.F90
. new file that contains just the routines from startup_initialconds that
  were responsible for open/close of initial and topo files, and provide
  accessor functions for the filehandles.
  - rename setup_initial      -> cam_initfiles_open
  - rename close_initial_file -> cam_initfiles_close

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add bndtvs_domain to docn stream txt file
. remove unused code for csim4
. add defaults for nu_p, nu_div, hypervis_subcycle, hypervis_subcycle_q

models/atm/cam/bld/configure
. mod to run mct configure in quiet mode unless cam configure is in verbose
  mode 

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add defaults for SE/cam5
  <uwshcu_rpen dyn="homme"> 5.0 </uwshcu_rpen>
  <nu hgrid="ne30np4">  1.0e15 </nu>
  <nu_p> 0.0 </nu_p>
  <nu_q> 1.0e15 </nu_q>
  <nu_div> 25.e14 </nu_div>
  <hypervis_subcycle> 2 </hypervis_subcycle>
  <hypervis_subcycle_q> 1 </hypervis_subcycle_q>
  <energy_fixer> -1 </energy_fixer>
  <se_ftype> 1 </se_ftype>
. add ne16np4 topo dataset
. update ne30np4 topo dataset
. add ne16np4 soil_erod dataset
. add se datasets (ne16,30,60,120,240) for fsurdat for 1850 and 2000
. add se datasets (ne16,30,60,120,240) for fatmlndfrc
. add se datasets (use 1x1 HadOIBl) for bndtvs for 1850, 2000, and
  1850-2000
. add se dataset for bndtvs_domain
. add se datasets for focndomain

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add bndtvs_domain
. add nu_p, nu_div, hypervis_subcycle, hypervis_subcycle_q

models/atm/cam/src/control/startup_initialconds.F90
. leave behind just the subroutine initial_conds.  This code should
  eventually move to the dycore interfaces.

models/atm/cam/src/dynamics/homme/dyn_comp.F90
. move dynamics initialization code out of cam_initial and into dyn_init1

models/atm/cam/src/dynamics/homme/dyn_grid.F90
. add coordinate/weights arrays from commap
. remove refs to commap

models/atm/cam/src/dynamics/homme/interp_mod.F90
. move reference to w from commap to dyn_grid

models/atm/cam/src/dynamics/homme/inital.F90
. move dynamics initialization stuff out of cam_initial and into dyn_init1

models/atm/cam/src/dynamics/homme/initcom.F90
. Tried to remove this file but initcom is called from cam_read_restart.
  That should be moved to a dycore specific spot since initcom is dycore
  specific.  For now just moved the contents to dyn_init1 and left a stub. 

models/atm/cam/src/dynamics/homme/spmd_dyn.F90
. remove unused routines spmd_dyn_defaultopts, spmd_dyn_setopts,
  spmdinit_dyn, compute_gsfactors
. remove unused module data

models/atm/cam/src/dynamics/sld/restart_dynamics.F90
. remove unused reference to binary_io module

models/atm/cam/src/dynamics/eul/inital.F90
models/atm/cam/src/dynamics/fv/inital.F90
models/atm/cam/src/dynamics/homme/inital.F90
models/atm/cam/src/dynamics/sld/inital.F90
. remove call to setup_initial (which has been renamed cam_initfiles_open)
  -- move it to cam_comp::cam_init.  Opening files is not dycore specific
  and shouldn't be buried in dycore specific code.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All PASS except:
072 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Sun Sep 30 18:09:05 MDT 2012
075 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Sun Sep 30 18:27:18 MDT 2012
084 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Mon Oct  1 08:58:46 MDT 2012

frankfurt/lf95: All PASS

frankfurt/pgi: All PASS except:
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Sat Sep 29 20:57:00 MDT 2012
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Sat Sep 29 22:11:40 MDT 2012

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except for SE configurations due to
new datasets and tuning parameters.

===============================================================
===============================================================

Tag name: cam5_1_43
Originator(s): santos, joemci, bardeenc
Date: Sept 27, 2012
One-line Summary: WACCM-X use_case, CARMA dust, RTM in standalone builds

Purpose of changes:
 - Add use_case for WACCM-X solar minimum conditions.
 - Add CARMA dust model.
 - Allow CAM standalone builds to build RTM and new CLM.
 - Add rof externals.
 - Update CARMA external (bug fix).
 - Update other externals (to alpha18e or higher).
 - Clean up CARMA models.
 - Clean up residual issues after CLUBB commit.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
 - Add build of ROF in standalone CAM.

Describe any changes made to the namelist:
 - Add options for CARMA dust model.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A models/atm/cam/bld/namelist_files/use_cases/waccmx_1996_cam4.xml
 - use_case containing solar minimum (1996) conditions for WACCM-X.

A models/atm/cam/src/physics/carma/models/dust/
A models/atm/cam/src/physics/carma/models/dust/carma_model_flags_mod.F90
A models/atm/cam/src/physics/carma/models/dust/carma_model_mod.F90
M models/atm/cam/test/system/config_files/f1.9c5carmdusm
 - New CARMA dust model.

List all existing files that have been modified, and describe the changes:

M SVN_EXTERNAL_DIRECTORIES
 - Update externals, add rof.

M models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - Update CARMA external with bug fixes.

M models/atm/cam/bld/build-namelist
M models/atm/cam/bld/config_files/definition.xml
M models/atm/cam/bld/configure
M models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M models/atm/cam/bld/namelist_files/namelist_definition.xml
 - Add rof for CAM standalone builds.
 - Add CARMA dust model options.

M models/atm/cam/src/control/camsrfexch.F90
M models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
M models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M models/atm/cam/src/cpl_share/cam_cpl_indices.F90
M models/atm/cam/src/physics/cam/comsrf.F90
 - Add volumetric soil water (soilw) to coupling from CLM, for CARMA dust.

M models/atm/cam/src/physics/cam/clubb_intr.F90
M models/atm/cam/src/physics/cam/convect_shallow.F90
M models/atm/cam/src/physics/cam/microp_aero.F90
 - Bug fixes and cleanup from previous tag (CLUBB commit).

M models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
 - Use gamma from gamma_function, move igamma to gamma_function.

M models/atm/cam/src/utils/gamma_function.F90
 - Update gamma function and make it pure.
 - Cleanup older code (e.g. remove goto statements).
 - Add "igamma", the upper incomplete gamma function.

M models/atm/cam/test/system/input_tests_master
M models/atm/cam/test/system/tests_carma
M models/atm/cam/test/system/tests_posttag_bluefire
 - Add tests for CARMA dust, new WACCM-X use_case.
 - Currently testing solar min in posttag, rather than solar max.
 - Change E compset to ETEST, for new docn/scripts compatibility.

M models/atm/cam/test/system/TCB_ccsm.sh
 - Add rof to build.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
 - All cases with chemistry impacted by dust fluxes have answer changes.

011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Sat Sep 29 13:14:57 MDT 2012
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Sat Sep 29 13:15:10 MDT 2012
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Sat Sep 29 13:15:19 MDT 2012
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Sat Sep 29 13:15:43 MDT 2012
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Sat Sep 29 13:16:26 MDT 2012
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Sat Sep 29 13:16:44 MDT 2012
049 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Sat Sep 29 13:17:25 MDT 2012
054 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Sat Sep 29 13:18:42 MDT 2012
056 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Sat Sep 29 13:19:37 MDT 2012
059 bl440 TBL.sh fsoa1.9c4dh outfrq3s+mozart_megan_emis 9s ................FAIL! rc= 7 at Sat Sep 29 13:20:22 MDT 2012
081 bl992 TBL_ccsm.sh f19_g16 ETEST 2d ....................................FAIL! rc= 5 at Sat Sep 29 13:20:29 MDT 2012
084 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Sat Sep 29 15:09:30 MDT 2012

frankfurt/lf95: 
 - All cases with chemistry impacted by dust fluxes have answer changes.

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Sat Sep 29 13:49:45 MDT 2012
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Sat Sep 29 13:49:51 MDT 2012
013 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Sat Sep 29 13:49:58 MDT 2012
017 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Sat Sep 29 13:50:05 MDT 2012
025 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Sat Sep 29 13:51:43 MDT 2012

frankfurt/pgi or jaguar/pgi: 
 - All cases with chemistry impacted by dust fluxes have answer changes.

005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Sep 28 10:44:50 MDT 2012
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Sep 28 11:17:22 MDT 2012
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Sep 28 11:51:00 MDT 2012
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Sep 28 12:45:56 MDT 2012
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Sep 28 13:57:40 MDT 2012
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Sep 28 16:05:53 MDT 2012
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Fri Sep 28 16:42:32 MDT 2012
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Fri Sep 28 17:29:37 MDT 2012

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: 
  - Most active chemistry and CARMA cases.
- what platforms/compilers:
  - All
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 
  - Larger than roundoff, same climate.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_42
Originator(s): cacraig, bogenschutz, eaton, santos, edwards
Date: 09/26/12
One-line Summary: CLUBB and two minor changes for trunk

Purpose of changes:

- Introduction of CLUBB onto CAM trunk.  CLUBB (Cloud Layers Unified by Bi-normals) is a 
  higher-order turbulence closure centered around an assumed double Guassian PDF.  It is 
  a unified parameterization in that it returns tendencies due to PBL, shallow convection, 
  and cloud macrophysical processes.  This unified moist turbulence parameterization 
  uses multivariate PDFs to predict moments to generate shallow and stratiform clouds 
  that are then passed to the microphysics. 

  Reference: Bogenschutz, P. A., Gettelman, A., Morrison, H., Larson, V. E., Schanen, D. P., 
  Meyer, N. R., and Craig, C.: Unified parameterization of the planetary boundary layer and 
  shallow convection with a higher-order turbulence closure in the community atmosphere 
  model: single column experiments, Geosci. Model Dev. Discuss., 5, 1743-1780, doi:10.5194/gmdd-5-1743-2012

- Removed CONCLDQL from pbuf as it was only written and never read

- bug fix to sat_hist (edwards)

- addition of carma_inparm namelist (santos)

Bugs fixed (include bugzilla ID):
1547: CAM dies trying to writ out N-dimensional fields to the "satellite" history file
  - fixed in sat_hist.F90

Describe any changes made to build system: 
- Introduced clubb_sgs flag as a configure option to turn on CLUBB

Describe any changes made to the namelist:
- Introduced in phys_ctl_nl
     macrop_scheme - character, valid values are "rk, park, clubb_sgs, none"
     do_clubb_sgs - logical, if true, turns on CLUBB_SGS
- Added option CLUBB_SGS to shallow_scheme and eddy_scheme
- Introduced in cam_inparm
     scm_clubb_iop_name - character, IOP name for CLUBB running in single column mode
- Introduced clubb namelist "clubb_his_nl" with variables:
     clubb_history - logical, if true, output CLUBB history statistics 
     clubb_rad_history - logical, if true, output CLUBBs radiative history statistics
- Introduced clubb namelist "clubb_stats_nl" with variables: 
     clubb_vars_zt - character, same as fincl1, but for CLUBB statistics on zt grid  
     clubb_vars_zm - character, same as fincl1, but for CLUBB statistics on zm grid  
     clubb_vars_rad_zt - character, same as fincl1, but for CLUBB statistics on radiation zt grid
     clubb_vars_rad_zm - character, same as fincl1, but for CLUBB statistics on radiation zm grid
     clubb_vars_src - character, same as fincl1, but for CLUBB statistics on surface
     clubb_iop_name - character, name of the IOP case for adjustments within CLUBB
- Moved from vert_diff_nl to phys_ctl_nl
     do_tms
- Moved from vert_diff_nl to physconst_nl
     tms_orocnst, tms_z0fac
- Introduced carma namelist "carma_inparm" with variables:
     carma_fields - character, list of fluxes needed by the CARMA model from CLM to CAM

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 

List all subroutines added and what they do: none
A  +    models/atm/cam/src/physics/cam/clubb_intr.F90
          - Interface module between CLUBB and CAM

A  +    models/atm/cam/src/physics/CLUBB_core
A  +    models/atm/cam/src/physics/CLUBB_core/constants_clubb.F90
A  +    models/atm/cam/src/physics/CLUBB_core/variables_prognostic_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/interpolation.F90
A  +    models/atm/cam/src/physics/CLUBB_core/clip_explicit.F90
A  +    models/atm/cam/src/physics/CLUBB_core/saturation.F90
A  +    models/atm/cam/src/physics/CLUBB_core/mono_flux_limiter.F90
A  +    models/atm/cam/src/physics/CLUBB_core/mixing_length.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_zm.F90
A  +    models/atm/cam/src/physics/CLUBB_core/file_functions.F90
A  +    models/atm/cam/src/physics/CLUBB_core/mean_adv.F90
A  +    models/atm/cam/src/physics/CLUBB_core/grid_class.F90
A  +    models/atm/cam/src/physics/CLUBB_core/pdf_closure_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_zt.F90
A  +    models/atm/cam/src/physics/CLUBB_core/parameter_indices.F90
A  +    models/atm/cam/src/physics/CLUBB_core/hyper_diffusion_4th_ord.F90
A  +    models/atm/cam/src/physics/CLUBB_core/csr_matrix_class_3array.F90
A  +    models/atm/cam/src/physics/CLUBB_core/input_reader.F90
A  +    models/atm/cam/src/physics/CLUBB_core/parameters_model.F90
A  +    models/atm/cam/src/physics/CLUBB_core/error_code.F90
A  +    models/atm/cam/src/physics/CLUBB_core/lapack_wrap.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_rad_zm.F90
A  +    models/atm/cam/src/physics/CLUBB_core/parameters_radiation.F90
A  +    models/atm/cam/src/physics/CLUBB_core/mt95.f90
A  +    models/atm/cam/src/physics/CLUBB_core/endian.F90
A  +    models/atm/cam/src/physics/CLUBB_core/recl.inc
A  +    models/atm/cam/src/physics/CLUBB_core/parameters_microphys.F90
A  +    models/atm/cam/src/physics/CLUBB_core/gmres_cache.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_rad_zt.F90
A  +    models/atm/cam/src/physics/CLUBB_core/sigma_sqd_w_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/hydrostatic_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/array_index.F90
A  +    models/atm/cam/src/physics/CLUBB_core/anl_erf.F90
A  +    models/atm/cam/src/physics/CLUBB_core/T_in_K_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/calendar.F90
A  +    models/atm/cam/src/physics/CLUBB_core/model_flags.F90
A  +    models/atm/cam/src/physics/CLUBB_core/advance_windm_edsclrm_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/pos_definite_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/pdf_parameter_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/fill_holes.F90
A  +    models/atm/cam/src/physics/CLUBB_core/sponge_layer_damping.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_variables.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_subs.F90
A  +    models/atm/cam/src/physics/CLUBB_core/variables_radiation_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/numerical_check.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stat_file_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/input_names.F90
A  +    models/atm/cam/src/physics/CLUBB_core/output_netcdf.F90
A  +    models/atm/cam/src/physics/CLUBB_core/diffusion.F90
A  +    models/atm/cam/src/physics/CLUBB_core/advance_wp2_wp3_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/advance_xm_wpxp_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/extrapolation.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_sfc.F90
A  +    models/atm/cam/src/physics/CLUBB_core/surface_varnce_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/clip_semi_implicit.F90
A  +    models/atm/cam/src/physics/CLUBB_core/clubb_core.F90
A  +    models/atm/cam/src/physics/CLUBB_core/stats_type.F90
A  +    models/atm/cam/src/physics/CLUBB_core/clubb_precision.F90
A  +    models/atm/cam/src/physics/CLUBB_core/advance_helper_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/gmres_wrap.F90
A  +    models/atm/cam/src/physics/CLUBB_core/Skw_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/parameters_tunable.F90
A  +    models/atm/cam/src/physics/CLUBB_core/advance_xp2_xpyp_module.F90
A  +    models/atm/cam/src/physics/CLUBB_core/output_grads.F90
A  +    models/atm/cam/src/physics/CLUBB_core/variables_diagnostic_module.F90
          - CLUBB code

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/configure
M       models/atm/cam/bld/config_files/definition.xml
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
MM      models/atm/cam/bld/build-namelist
         - namelist changes described above

M       models/atm/cam/doc/ChangeLog

M       models/atm/cam/src/control/runtime_opts.F90
M       models/atm/cam/src/control/scamMod.F90
         - introduction of scm_clubb_iop_name

M       models/atm/cam/src/control/physconst.F90
         - physconst_nl now has tms_orocnst and tms_z0fac

M       models/atm/cam/src/control/sat_hist.F90
         - bug fix described above

M       models/atm/cam/src/dynamics/eul/iop.F90
         - shflx and sh are now mutually exclusive

M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
          - Modifications to allow for QCWAT, TCWAT, ICWAT 
            and qpert possibly not being in pbuf

M       models/atm/cam/src/physics/cam/cldwat2m_macro.F90
          - aist_vector is now public
              
M       models/atm/cam/src/physics/cam/convect_deep.F90
          - modified deep_scheme_does_scav_trans logic to make
            it more flexible
          - jctop and jcbot are now initialized to non-zero values

M       models/atm/cam/src/physics/cam/convect_shallow.F90
          - moved qpert as it just exists in Hack scheme
          - cnt2 and cnb2 are now initialized to non-zero values
          - added CLUBB_SGS to possible cases for shallow_scheme

M       models/atm/cam/src/physics/cam/hb_diff.F90
          - pblintd is now public

M       models/atm/cam/src/physics/cam/macrop_driver.F90
M  +    models/atm/cam/src/physics/cam/micro_mg_cam.F90
M  +    models/atm/cam/src/physics/cam/microp_driver.F90
          - bug fix- energy conservation was giving off false alarms - non
            answer changing.  Removed rliq from microp to macro to be
            considered for energy conservation

M       models/atm/cam/src/physics/cam/microp_aero.F90
          - Introduced logic for CLUBB_SGS

M       models/atm/cam/src/physics/cam/phys_control.F90
          - Added to phys_ctl_nl: macrop_scheme, do_clubb_sgs and do_tms

M       models/atm/cam/src/physics/cam/physpkg.F90
          - Addition of CLUBB_SGS logic
          - Modifications to allow for QCWAT, TCWAT, ICWAT 
            and qpert possibly not being in pbuf
          - bug fix for energy conservation (see macrop_driver above for more details)

M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
          - Moved do_tms to phys_ctl_nl
          - Moved tms_orocnst and tms_z0fac to physconst_nl

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

frankfurt/lf95: All PASS

frankfurt/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: All BFB

===============================================================
===============================================================

Tag name: cam5_1_41
Originator(s): cacraig, eaton
Date: Mon Sep 24 13:57:57 MDT 2012
One-line Summary: cleanup in stratiform, macrop, microp modules; new namelist

Purpose of changes:

. Remove lots of unused code left over from the original cam5 development.
  This was a consequence of the cam5 macro/micro physics being developed in
  the stratiform module, and then later moved to separate macrop and
  micro_mg modules.  The result was code that's only needed for the cam5
  physics was left in the stratiform module, and code that's only needed for
  cam4 physics was left in the macrop and micro_mg modules.

. Move several pbuf_add calls to the modules that are responsible for
  setting the pbuf field.

. Add namelist group microp_aero_nl to the microp_aero module.  Currently
  just contains the variable microp_aero_bulk_scale which is a tuning
  parameter for using bulk aerosols with the cam5 physics package.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist:

. Add namelist group microp_aero_nl to the microp_aero module.  Currently
  just contains the variable microp_aero_bulk_scale which is a tuning
  parameter for using bulk aerosols with the cam5 physics package.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 

models/atm/cam/src/physics/cam/mcshallow.F90
. not used

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/Makefile.in
. occasionally the serial builds were failing due to trying to compile the
  pio_kinds.F90 before the mct build was finished.  This fails because in
  the serial build the mpi-serial lib is part of mct, and that build puts
  the mpif.h file in the appropriate include directory.  For now have added
  a rule to make pio_kind.o depend on libmct.a.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add microp_aero_bulk_scale

models/atm/cam/src/control/runtime_opts.F90
. add call for microp_aero_readnl

models/atm/cam/src/physics/cam/cloud_fraction.F90
. add cldfrc_register for SH_FRAC, DP_FRAC

models/atm/cam/src/physics/cam/conv_water.F90
. remove refs to pbuf fields ALST, AIST, QLST, QIST -- not used
. remove ref to CONCLDQL -- not used

models/atm/cam/src/physics/cam/eddy_diff.F90
. fix logfile info that was written from all procs -- only write from
  masterproc 
. replace 'stop' statements by calls to endrun

models/atm/cam/src/physics/cam/macrop_driver.F90
. Remove RHDFDA and RHU00 from pbuf and local vars.  Only used in cam4
  physics. 
. Remove the second call to cldfrc which was only used for the rhdfda
  calculation. 
. remove addfld/outfld for CNVCLD -- no longer used
. remove calls to add SH_FRAC, DP_FRAC to pbuf.  Now done in
  cldfrc_register. 
. remove pbuf_add calls for TINI, QINI, CLDLIQINI, CLDICEINI.  Now done in
  phys_register. 
. remove access of QME -- not used
. remove pbuf_add for CC_* variables -- moved to micro_mg_cam.  Replace
  with pbuf_get_index calls for those variables.

models/atm/cam/src/physics/cam/micro_mg_cam.F90
. remove REL2, REI2, DEICONV, MUCONV, LAMBDACONV from pbuf.  Not used.
. add initializer for CLDO.
. add pbuf_add for CC_* variables; also add initializers.

models/atm/cam/src/physics/cam/microp_aero.F90
. add microp_aero_readnl, and microp_aero_bulk_scale for tuning the
  activation by bulk aerosol.

models/atm/cam/src/physics/cam/physpkg.F90
. call cldfrc_register from phys_register
. add pbuf_add calls for TINI, QINI, CLDLIQINI, CLDICEINI (used for physics
  package diagnostics).
. move initializer for CLDO to microp_mg_cam

models/atm/cam/src/physics/cam/stratiform.F90
. remove micro_treatment parameter which isn't relevent for cam4
. Remove RHDFDA and RHU00 from pbuf and use local variables only.
  rhu00 is computed in cldfrc, then used to compute rhdfda, and is
  intent(in) to pcond.
  rhdfda is computed then used as intent(in) arg to pcond.  There is no
  use of saved values.
. remove many unused local variables
. remove AIST,ALST from pbuf.  Replace local use by ast.
. remove LIQCLDF, ICECLDF from hist.  They are identical to AST.
. remove CLDO, CONCLD_QL, ICCWAT, REL_FN, DEICONV, MUCONV, LAMBDACONV
  from pbuf.  Not used.
. remove pbuf_add calls for SH_FRAC, DP_FRAC.  Now done in
  cldfrc_register. 
. remove pbuf_add calls for TINI, QINI, CLDLIQINI, CLDICEINI.  Now done in
  phys_register. 
. replace local var fice by pbuf FICE.  get rid of fice_ql pointer

models/atm/cam/src/physics/carma/cam/carma_intr.F90
. remove pbuf_times dimension from CG*, CI*, CL*, CT

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

frankfurt/lf95: All PASS

frankfurt/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: All BFB

===============================================================
===============================================================

Tag name: cam5_1_40 
Originator(s): fischer
Date: Fri Sep 20 2012
One-line Summary: update SVN exteranals, build MCT library separately

Purpose of changes:
.  There are a couple of changes with the cesm build scripts with the new
   scripts tag.
   .  The command line command "configure -case" has been replace with "setup"
   .  env_configure.xml has been renamed env_pesetup.xml

.  Update SVN externals to match cesm1_1_beta17, except for clm4_0_47
   and pio1_5_4.  These are later tags that are a bug fix for cam and
   a fix for lahey

.  With the new tag for MCT, the MCT configure script must be run.  So
   configure and Makefile.in were updated to handle these changes.  A new
   varaible mct_libdir was added to be able to set the location of the mct
   library.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
.  MCT is now built as a stand alone library.  In order to build mct, changes
   where made to configure and Makefile.in.  
    .FC, FC_TYPE, and cc are now determined in configure instead of Makefile.in.  
    .cam's configure script creates a directory structure in $mct_libdir and copies the MCT 
     makefiles over.  
    .MCT's configure script is called in order to set up MCT's Makefile.conf.  
    .CAM's Makefile.in has new rules to build the MCT library.
    .$mct_libdir default is $cam_bld/mct, can be set on the command line -mct_libdir, or 
     enviroment variable MCT_LIBDIR.

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:eaton

List all subroutines eliminated:

List all subroutines added and what they do:


M       models/atm/cam/test/system/TCB_ccsm.sh
.  updated test script to reflect changes with the cesm build system

M       models/atm/cam/test/system/tests_pretag_frankfurt_lahey
.  removed 113 and 115 tests

M       models/atm/cam/bld/configure
.  Added code to create directory structure needed to build MCT.
.  Moved logic for determining fc and fc_type from Makefile.in to configure.
   This was done so the new call to the MCT configure script can be passed
   the compiler type.

M       models/atm/cam/bld/Makefile.in
.  removed logic for determining fc and fc_type.
.  Added make rules for MCT library build.

M       models/atm/cam/bld/config_files/definition.xml
.  add mct_libdir, and add xlf to fc_type defaults

M       SVN_EXTERNAL_DIRECTORIES
.  Update SVN externals to match cesm1_1_beta17, except for clm4_0_47
   and pio1_5_4.   The clm tag is a bug fix to allow cam builds using
   cesm scripts.  The pio tag is a fix to allow lahey to work.

List all existing files that have been modified, and describe the changes:

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all passed  

frankfurt/lf95: all passed 

frankfurt/pgi: all passed 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,: all bfb

===============================================================
===============================================================

Tag name: cam5_1_39
Originator(s): fvitt
Date: 18 Sep 2012
One-line Summary: MAM7 corrections

Purpose of changes:

  Correction to dust density weighting factors in microp_aero when
  7-mode modal aerosol model is used.

  Correction to the aerosol optics inputs for MAM7.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

D    models/atm/cam/test/system/tests_posttag_edinburgh
D    models/atm/cam/test/system/tests_pretag_edinburgh_lahey
D    models/atm/cam/test/system/tests_pretag_edinburgh_pgi
 - edinburgh is replaced by frankfurt

List all subroutines added and what they do:

A    models/atm/cam/test/system/tests_pretag_frankfurt_pgi
A    models/atm/cam/test/system/tests_posttag_frankfurt
A    models/atm/cam/test/system/tests_pretag_frankfurt_lahey
 - edinburgh is replaced by frankfurt

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/test/system/test_driver.sh
M    models/atm/cam/test/system/CAM_runcmnd.sh
 - edinburgh is replaced by frankfurt

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - correction to the aerosol optics inputs for MAM7

M    models/atm/cam/src/physics/cam/microp_aero.F90
 - corrections weighting factors of dust densities for MAM7

M    models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
 - sea salt emission scaling factor adjusted for MAM7

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

frankfurt/lf95: All PASS

frankfurt/pgi or jaguar/pgi:
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Mon Sep 17 15:04:53 MDT 2012
 - this is expected due to changes for MAM7

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_38
Originator(s): mmills, santos
Date: September 10, 2012
One-line Summary: Merge in WACCM5 development

Purpose of changes:
 - Add first WACCM5 chemistry package: waccm_mozart_mam3.
 - Add namelist settings and use_cases for WACCM5
 - Add features for WACCM5 compatibility.
   - Troposphere cloud physics "top" added to more modules.
 - Fix CARMA coordinate bug.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

 - New configuration file, namelist defaults, and use_cases for WACCM5.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/chem_mech.dat
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/chem_mech.doc
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/chem_mech.in
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/chem_mods.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/m_rxt_id.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/m_spc_id.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_adjrxt.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_imp_sol.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_indprd.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_lin_matrix.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_lu_factor.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_lu_solve.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_nln_matrix.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_phtadj.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_prod_loss.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_rxt_rates_conv.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_setrxt.F90
A models/atm/cam/src/chemistry/pp_waccm_mozart_mam3/mo_sim_dat.F90

 - Add new waccm_mozart_mam3 chemistry package.

A models/atm/cam/test/system/config_files/wm1.9c5h

 - Configuration file for WACCM5 tests.

List all existing files that have been modified, and describe the changes:

M models/atm/cam/bld/build-namelist
A models/atm/cam/bld/config_files/defaults_waccm5.xml
M models/atm/cam/bld/config_files/definition.xml
M models/atm/cam/bld/configure
M models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam5.xml
M models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam5.xml

 - Default settings for WACCM5 added.
 - waccm_mozart_mam3 added to configure, namelist defaults added.

M models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
M models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
M models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M models/atm/cam/src/physics/cam/aer_rad_props.F90
M models/atm/cam/src/physics/cam/modal_aer_opt.F90
M models/atm/cam/src/physics/cam/ndrop.F90
 - Added trop_cloud_top_lev as upper boundary of certain
   processes/loops.

M models/atm/cam/src/chemistry/mozart/chemistry.F90
M models/atm/cam/src/chemistry/mozart/mo_chemini.F90
M models/atm/cam/src/physics/cam/cam_diagnostics.F90
M models/atm/cam/src/physics/cam/phys_control.F90
 - Added waccm_mozart_mam3 chemistry package to options/conditionals.

M models/atm/cam/src/physics/cam/microp_aero.F90
 - Initialize entire lcldn/lcldo arrays to 0._r8, rather than
   only initializing below top_lev.

M models/atm/cam/src/physics/carma/cam/carma_intr.F90
 - Fixed bug in CARMA interface where dlat was being set
   instead of dy.

M models/atm/cam/test/system/input_tests_master
M models/atm/cam/test/system/tests_posttag_bluefire
 - Added short WACCM5 tests to bluefire posttag.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All PASS.

edinburgh/lf95: All PASS

edinburgh/pgi or jaguar/pgi: All PASS

The following non-pretag tests, however, are expected to fail.
 - WACCM5 posttag baseline test (bl380) will fail, because this is a new
   feature and chemistry package. However, sm380 and er380 succeed.
 - CARMA baseline tests expected to fail due to bug fix.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:

  - CARMA only, due to bug fix.

- what platforms/compilers: All

- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

  - Larger than roundoff CARMA, bit-for-bit all other cases, anticipate
    same climate.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_37
Originator(s): eaton
Date: Wed Sep  5 08:26:01 MDT 2012
One-line Summary: Remove hardcoded zvir from cam4 physics.

Purpose of changes:

. Call the init routine for the pbl_utils from phys_init, not from
  init_eddy_diff and init_hb_diff.  This wasn't done previously because a
  local value of zvir (0.61) was being used in the hb_diff module.  Using a
  single call to the init routine which uses the shared value of constants
  will change answers (but not climate) for cam3/cam4 physics.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/physics/eddy_diff.F90
. remove call to init_pbl

models/atm/cam/src/physics/hb_diff.F90
. remove call to init_pbl
. remove zvir_loc, zvir, rair.  they were only used in init_pbl call which has
  been moved.  Adjust init_hb_diff args accordingly.

models/atm/cam/src/physics/pbl_utils.F90
. change name init_pbl to pbl_utils_init

models/atm/cam/src/physics/physpkg.F90
. add call to pbl_utils_init from phys_init

models/atm/cam/src/physics/vertical_diffusion.F90
. modify actual args in init_hb_diff call

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Fri Aug 31 14:43:43 MDT 2012
006 bl133 TBL.sh e48c4paqdm aqpgro+aquaplanet_cam4 3s .....................FAIL! rc= 7 at Fri Aug 31 14:47:20 MDT 2012
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Fri Aug 31 15:36:07 MDT 2012
023 bl333 TBL.sh f4c4paqdh aqpgro+aquaplanet_cam4 3s ......................FAIL! rc= 7 at Fri Aug 31 15:58:00 MDT 2012
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Fri Aug 31 16:35:18 MDT 2012
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Tue Sep  4 09:25:23 MDT 2012
049 bl376 TBL.sh fm1.9c4dh+testmech outfrq3s 9s ...........................FAIL! rc= 7 at Tue Sep  4 10:31:57 MDT 2012
052 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Tue Sep  4 11:26:28 MDT 2012
059 bl440 TBL.sh fsoa1.9c4dh outfrq3s+mozart_megan_emis 9s ................FAIL! rc= 7 at Tue Sep  4 13:07:47 MDT 2012
063 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Tue Sep  4 13:51:42 MDT 2012
066 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Tue Sep  4 14:04:16 MDT 2012
069 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Tue Sep  4 16:14:28 MDT 2012
072 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Tue Sep  4 16:23:53 MDT 2012
075 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Tue Sep  4 16:47:10 MDT 2012
081 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Tue Sep  4 17:39:42 MDT 2012

edinburgh/lf95: All PASS except:
032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Mon Sep  3 23:57:16 MDT 2012
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Sep  4 01:18:44 MDT 2012
040 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Tue Sep  4 03:18:48 MDT 2012

edinburgh/pgi: All PASS except:
033 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Fri Aug 31 15:43:49 MDT 2012
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Aug 31 15:55:16 MDT 2012
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Fri Aug 31 16:03:06 MDT 2012

All configurations using cam3 or cam4 physics fail the baseline comparisons.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except configs using cam3/cam4 physics

===============================================================
===============================================================

Tag name: cam5_1_36
Originator(s): fvitt
Date: 31 Aug 2012
One-line Summary: Changes for MAM7, added chemistry package, and misc bug fixes

Purpose of changes:

 - changes for MAM7 (7 mode modal aerosol model):
   . use different scaling factor for sea salt emissions
   . adjusted the external forcings for trop_mam7 chemistry package
   . adjusted the NH4 aerosol optics files
 - new chemistry package trop_strat_mam7 (MOZART chemistry with MAM7 aerosols)
 - add build-namelist use case for MEGAN emissions that will be used
   with MOZSOA compsets
 - bug fix in CO+OH reaction rate for super_fast_llnl chemistry
 - bug fix in "WMO" method of tropopause calculation
 - fix path of chemistry preprocessor generated source files in Filepath
   so that CESM build with compile the correct source files
 - added regression tests for the chem preprocessor

Bugs fixed (include bugzilla ID):

 - correction to CO+OH reaction rate for super_fast_llnl chemistry
 - invoke O1D_to_2OH_adj subroutine when chemistry is super_fast_llnl_mam3
 - correction to "WMO" method of tropopause calculation

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

D    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_usrrxt.F90
 - removed duplicate code
   the code relevant to waccm_mozart_sulfur moved to chemistry/mozart/mo_usrrxt.F90

List all subroutines added and what they do:

A    models/atm/cam/test/system/TNE_ccsm.sh
A    models/atm/cam/test/system/config_files/testmech
 - for chemistry preprocessor regression tests

A    models/atm/cam/test/system/config_files/fst7mode1.9c5h
A    models/atm/cam/test/system/config_files/f7mode1.9c5dh
A    models/atm/cam/test/system/config_files/fst7mode4c5dm
 - for trop_mam7 and trop_strat_mam7 chemistry tests

A    models/atm/cam/test/system/tests_chem_hybrid
A    models/atm/cam/test/system/tests_chem_mpi
 - for many chemistry configurations

A    models/atm/cam/bld/namelist_files/use_cases/mozart_megan_emis.xml
 - use case for MEGAN emission for MOZART chemistry

A    models/atm/cam/src/chemistry/pp_trop_strat_mam7
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_rxt_rates_conv.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_lin_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_trop_strat_mam7/chem_mech.in
 - new chemistry package added

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/test/system/TCB.sh
M    models/atm/cam/test/system/tests_pretag_bluefire
M    models/atm/cam/test/system/TCB_ccsm.sh
M    models/atm/cam/test/system/input_tests_master
M    models/atm/cam/test/system/TSM.sh
 - changes for testing chemistry preprocessor
 - added tests for trop_mam7 and trop_strat_mam7 chemistry

M    models/atm/cam/bld/configure
M    models/atm/cam/bld/config_files/definition.xml
 - fixed the path of pre-processor generated source code in Filepath
 - new chem option

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - defaults for trop_strat_mam7 chemistry
 - change in NH4 optics files for MAM7
 - added emission files for MAM7

M    models/atm/cam/bld/namelist_files/use_cases/cam5_trop_strat_chem.xml
 - adjusted the lght_no_prd_factor namelist parameter

M    models/atm/cam/bld/build-namelist
 - MAM7 (trop_mam7 and trop_strat_mam7) default namelist
 - added the ability to use "$INPUTDATA_ROOT" variable in specifying complex 
   namelist settings in use cases

M    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - update to chemistry preprocessor to handle mechanism with up to 1000 species

M    models/atm/cam/src/physics/cam/tropopause.F90
 - correction to "WMO" method of tropopause calculation

M    models/atm/cam/src/physics/cam/phys_control.F90
M    models/atm/cam/src/physics/cam/modal_aer_opt.F90
 - additional prognostic modal aerosol model (trop_strat_mam7)

M    models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
 - use different scaling factor for sea salt emissions

M    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/mo_indprd.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mech.in
 - changes in external forcings

M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M    models/atm/cam/src/chemistry/mozart/chemistry.F90
 - fix for super_fast_llnl_mam3

M    models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - corrected CO+OH rate calculation for super_fast_llnl

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

052 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Fri Aug 31 00:16:50 MDT 2012
 - correction to reaction rate

054 bl415 TBL.sh fst1.9c5dh outfrq3s+cam5_trop_strat_chem 9s ..............FAIL! rc= 7 at Fri Aug 31 00:18:08 MDT 2012
 - change in lght_no_prd_factor namelist parameter

edinburgh/lf95: All Pass

edinburgh/pgi:

056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Thu Aug 30 16:13:18 MDT 2012
 changes in trop_mam7

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_35
Originator(s): eaton
Date: Wed Aug 29 08:28:47 MDT 2012
One-line Summary: fix vertical_diffusion pbuf fields

Purpose of changes:

. Several of the fields put in the physics buffer by the vertical diffusion
  module were using the special pbuf_times dimension incorrectly.  This
  only results in a bug for the Eulerian dycore (and hence SCAM) since
  that's the only dycore for which pbuf_times is greater than 1.
  The dimension was removed for the following fields:

  - tke is in the buffer to be communicated to microp_aero.  There is no
    need for multiple time levels when the purpose is just to share a the
    most recently computed values of a diagnostic.  In fact subtle mistakes
    will result when the data consuming module executes before the data
    producing module in the tphysbc then tphysac sequence, and both modules
    are using the pbuf_old_tim_idx to access the buffer.  In the particular
    case of tke the bug was that it was being accessed in microp_aero as if
    it did not even have a pbuf_times dimension.
  - kvh is used by other parameterizations, and as an initial guess in
    compute_eddy_diff on subsequent timesteps.  In the Eulerian case it
    probably doesn't make sense to use values that are 2 timesteps old as
    initial guesses rather than 1 timestep old values.  Furthermore this
    field was being accessed in microp_aero and ndrop as if it did not have
    a pbuf_times dimension.
  - kvm, tauresx, and tauresy are in the pbuf to be used as an initial
    guesses on the next timestep.
  - turbtype and smaw are not currently needed in the pbuf.
  - kvt is only used by the waccm/gw_drag code.  Only the information just
    computed in vertical_diffusion needs to be passed (not multiple time
    levels).

. Change default vertical remap subcycles for 1-deg FV to nspltvrm=2.  This
  is to make the 1-deg simulation more stable.

. Fix T_TTEND output diagnostic.

Bugs fixed (include bugzilla ID):

. Several physics buffer fields declared with the pbuf_times dimension were
  being incorrectly accessed.  This is only a bug for cam5 physics using
  Eulerian dycore.  Note in particular that this affects SCAM.

. The T_TTEND diagnostic had the wrong sign, and due to incorrect use of
  the physics buffer was completely invalid for runs using Eulerian dycore.

Describe any changes made to build system: none

Describe any changes made to the namelist:

. Change default value of nspltvrm to 2 for 1-deg FV.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

. The change of nspltvrm to 2 for 1-deg FV does add an overhead which will
  be noticable (5% ?) but hasn't been thoroughly evaluated.

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. set nspltvrm=2 for 1-deg FV

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. Fix access to tke, kvh, kvm (now 2D instead of 3D)
. Fix T_TTEND output diagnostic:
  - T_TTEND was added to the pbuf with a pbuf_times index, but was accessing
    the field ignoring that index.  For the Eulerian core this implies that
    on some steps the previous timestep value was accessed, and on the
    following steps the value from 2 previous timesteps was accessed.  When
    computing tendencies for Eulerian the ztodt variable contains twice the
    physics timestep, so need to always access the pbuf values from 2
    timesteps previous using the pbuf_old_tim_idx function.
  - In the diag_conv_tend_ini routine only initialize the T_TTEND pbuf on the
    first step of an initial run, and initialize all pbuf_times levels.
  - Fix the sign of the T_TTEND tendency calculation.

models/atm/cam/src/physics/cam/convect_shallow.F90
. remove time index from tke access from pbuf

models/atm/cam/src/physics/cam/diffusion_solver.F90
. make sure kvt is present when do_molec_diff=.true.
. remove initializer for kvt.  It is intent(out) from compute_molec_diff.

models/atm/cam/src/physics/cam/gw_drag.F90
. remove unused dummy arg kvh

models/atm/cam/src/physics/cam/molec_diff.F90
. change kvt dummy arg to intent(out) from inout

models/atm/cam/src/physics/cam/physpkg.F90
. fix initialization of tke, kvh, kvm to use just 1 time level
. tphysac - remove access of kvt from the pbuf, and remove kvt actual arg
  from call to gw_intr

models/atm/cam/src/physics/cam/stratiform.F90
. remove tke which is referenced but not used.  It is also initialized
  which overwrites the initialization in physpkg.  But shouldn't impact
  answers because it isn't used by the hack shallow convection.
. remove kvh which is referenced but not used.  It is also initialized
  which overwrites the initialization in physpkg.  Shouldn't impact cam4 
  answers unless running with IC file that contained KVH.
. remove turbtype and smaw which are referenced but not used

models/atm/cam/src/physics/cam/tracers_suite.F90
. comment out debug output

models/atm/cam/src/physics/cam/vertical_diffusion.F90
. remove pbuf_times dimension from tke.  it is set in compute_eddy_diff or
  compute_hb_diff and used in moist physics to estimate subgrid vertical
  velocity.  **N.B.** was being incorrectly accessed without the pbuf_times
  dimension in microp_aero.
. remove pbuf_times dimension from kvh.  kvh in the pbuf is used by other
  physics parameterizations, and as an initial guess in compute_eddy_diff
  on the next timestep.  **N.B.** was being incorrectly accessed without
  the pbuf_times dimension in microp_aero and in ndrop.
. remove pbuf_times dimension from kvm.  kvm in the pbuf is only used as an
  initial guess in compute_eddy_diff on the next timestep.  Thus the kvm
  field in the pbuf does not contain the contributions from molecular
  diffusion that are added in the call to compute_vdiff.
. remove pbuf_times dimension from turbtype and smaw.  these fields in the
  pbuf are currently not used, but may be in the future.  Also can remove
  the pbuf_set_field to zero for the HB case since the fields are init to
  zero and not modified.
. tauresx and tauresy are only in the pbuf to be used as initial guesses in
  subsequent timesteps.  No need for multiple time levels.

. kvt only needs one time level and physpkg scope.
. kvt is set before it is used anywhere -- doesn't need an initialization
  in vertical_diffusion_init
. change local array for kvt to pointer into pbuf
. remove obsolete comment about calc_kvt
. associate kvt pointer with pbuf and remove the copy of the local kvt into
  the pbuf.

models/atm/cam/src/physics/waccm/gw_drag.F90
. remove dummy arg kvt and access from pbuf instead.  add init for
  kvt_idx.  modify indexing to account for pbuf field using 1 based
  indices.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Mon Aug 27 18:54:35 MDT 2012

edinburgh/lf95: All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Aug 27 19:24:15 MDT 2012
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Aug 27 21:02:18 MDT 2012
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Mon Aug 27 22:30:15 MDT 2012
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Aug 27 22:40:37 MDT 2012

edinburgh/pgi: All PASS except:
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Aug 27 17:10:52 MDT 2012
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Aug 27 17:31:47 MDT 2012
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Mon Aug 27 17:46:04 MDT 2012
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Aug 27 17:58:51 MDT 2012

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except: 
. configurations using Eulerian dycore w/ cam5 physics change answers due
  to bug fixes
. FV, 1-deg runs change answers (same climate) due to changing the default
  number of subcycles for the vertical remapping (nspltvrm=2).

===============================================================
===============================================================
Tag name: cam5_1_34 
Originator(s): fischer, eaton, sungsup, fvitt
Date: Fri Aug 24 2012 
One-line Summary: obklen, deep convection, ndrop, and WACCM concentration bug fixes

Purpose of changes:

. Mods from Sungsu Park to fix the unreasonable concentration of some
  species in WACCM.  The fix prevents large fluxes of species with very
  small concentrations.

. Fix to wet radius calculation in the modal_aero_wateruptake module.

. Provide a computed value for the Obukhov length in the cam5 physics
  package.  It was inadvertently left set to zero.  This impacts dry
  deposition calculations.

. Mods from Guang Zhang in zm_conv to fix some inconsistency in the
  initialization of hu, and to define su at cloud base using hu.

. Mods to ndrop from Cathy Chuang, Philip Cameron-smith, and Steve Ghan.
  Mods to mo_setsox from Xiaohong Liu to generalize the method for
  calculating pH value of cloud water.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/bld/build-namelist
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
.  obklen variable fix for cam5

M       models/atm/cam/src/physics/cam/zm_conv.F90
.  deep convection bug fix 

M       models/atm/cam/src/physics/cam/uwshcu.F90
. bug fix for unreasonable concentration of tracers with WACCM

M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
. move calculation of dgncur_awet outside of modal_aero_wateruptake_sub and
  into modal_aero_wateruptake_dr.  This moves it to a point after the
  calculation of wetrad has been completed with the
  deliquesence/crystallization hysteresis treatment.

M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/chemistry/pp_trop_mam3/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/mozart/mo_setsox.F90
. ndrop bug fix



If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Thu Aug 23 09:29:18 MDT 2012
006 bl133 TBL.sh e48c4paqdm aqpgro+aquaplanet_cam4 3s .....................FAIL! rc= 7 at Thu Aug 23 09:29:20 MDT 2012
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Thu Aug 23 09:29:28 MDT 2012
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Thu Aug 23 09:29:30 MDT 2012
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Thu Aug 23 09:29:41 MDT 2012
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Thu Aug 23 09:29:52 MDT 2012
023 bl333 TBL.sh f4c4paqdh aqpgro+aquaplanet_cam4 3s ......................FAIL! rc= 7 at Thu Aug 23 09:29:54 MDT 2012
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Thu Aug 23 09:30:42 MDT 2012
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Thu Aug 23 09:30:49 MDT 2012
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Thu Aug 23 09:31:17 MDT 2012
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Aug 23 09:32:04 MDT 2012
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Thu Aug 23 09:32:24 MDT 2012
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Thu Aug 23 09:32:51 MDT 2012
052 bl415 TBL.sh fst1.9c5dh outfrq3s 9s ...................................FAIL! rc= 7 at Thu Aug 23 09:34:05 MDT 2012
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Aug 23 09:35:06 MDT 2012
057 bl440 TBL.sh fsoa1.9c4dh outfrq3s 9s ..................................FAIL! rc= 7 at Thu Aug 23 09:35:58 MDT 2012
061 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Thu Aug 23 09:36:11 MDT 2012
064 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Thu Aug 23 09:36:21 MDT 2012
067 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Thu Aug 23 09:38:37 MDT 2012
070 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Thu Aug 23 09:38:46 MDT 2012
073 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Thu Aug 23 09:39:20 MDT 2012
079 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Thu Aug 23 10:36:02 MDT 2012
082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Thu Aug 23 12:23:05 MDT 2012
expected, all bug fixes change answers


edinburgh/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Aug 22 23:23:39 MDT 2012
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Aug 22 23:23:43 MDT 2012
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Aug 22 23:23:44 MDT 2012
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Aug 22 23:23:50 MDT 2012
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Aug 23 00:12:41 MDT 2012
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Aug 23 02:58:48 MDT 2012
032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Thu Aug 23 03:39:43 MDT 2012
034 er314 TER.sh wg10c4dm outfrq3s 4+5s ...................................FAIL! rc= 8 at Thu Aug 23 04:32:47 MDT 2012
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Aug 23 05:19:42 MDT 2012
037 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Thu Aug 23 06:49:22 MDT 2012
040 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Thu Aug 23 07:47:52 MDT 2012
expected, all bug fixes change answers

edinburgh/pgi: 
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Aug 22 15:10:31 MDT 2012
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Aug 22 15:19:55 MDT 2012
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Aug 22 15:24:37 MDT 2012
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Aug 22 15:29:44 MDT 2012
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Aug 22 15:47:52 MDT 2012
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Aug 22 17:03:07 MDT 2012
033 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Wed Aug 22 17:11:49 MDT 2012
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Aug 22 17:29:57 MDT 2012
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Wed Aug 22 17:43:44 MDT 2012
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Aug 22 17:56:15 MDT 2012
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Aug 22 18:17:23 MDT 2012
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Wed Aug 22 18:33:39 MDT 2012
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Wed Aug 22 18:38:34 MDT 2012
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Wed Aug 22 18:46:36 MDT 2012
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Wed Aug 22 19:32:42 MDT 2012
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Wed Aug 22 20:48:29 MDT 2012
expected, all bug fixes change answers


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
   cam5_1_32
      obklen, deep convection, water update
   cesm1_1_beta15
      ndrop bug fix
- platform/compilers:
   bluefire, xlf
- configure commandline:
   Used cesm build scripts
   create_newcase -compset F1850C5 -res f19_f19 -mach bluefire -case /glade/home/fischer/runs/F1850C5_5_1_32_xxxx
- MSS location of output:
   /home/fischer/csm/F1850C5_5_1_32_mawu
      bug fix for water uptake in the modal aerosol
   /home/fischer/csm/F1850C5_5_1_32_obklen
      Fix for obklen variable
   /home/fischer/csm/F1850C5_5_1_32_zm
      Deep convection bug fix
   /home/tilmes/csm/f2000_cam5_beta15_modal 
      ndrop bug fix

MSS location of control simulations used to validate new climate:
   /home/fischer/csm/F1850C5_5_1_32_bl
      obklen, deep convection, water update
   /home/tilmes/csm/f2000_cam5_beta15 
      ndrop bug 

URL for AMWG diagnostics output used to validate new climate:
   http://www.cgd.ucar.edu/cms/hannay/internal/cam_dev/cam5.2_dev.html

===============================================================
===============================================================

Tag name: cam5_1_33 
Originator(s): fischer
Date: Wed Aug 22, 2012
One-line Summary: external updates and bug fixes

Purpose of changes:
.  SVN external updates to beta16 tags
   scripts4_120509a -> scripts4_120801a
    .  Changes to CESM build scripts.
       .  configure only supports -case and -clean.  
          cleannamelist, cleanmach and cleanall have been removed.
       .  RUNDIR moved from env_build.xml to env_run.xml
          Default RUNDIR is now set in Machines/config_machines.xml, instead of
          being based on $EXEROOT.
   drvseq4_1_09 -> drvseq4_1_24
   branch_tags/rasm_tags/rasm08_clm4_0_43 -> branch_tags/rasm_tags/rasm11_clm4_0_43
     Only update clm tags to cesm1_1_beta15 do to a bug in clm searching for
     datm files
   cice4_0_20120502 -> cice4_0_20120803
     newer cice tag than cesm1_1_beta16 to fix decomp types were missing from
     the definition file
   docn8_120502 -> docn8_120626
   share3_120509 -> share3_120731
   timing_120419 -> timing_120731
   MCT2_7_0-120413 -> MCT2_8_0_120503
     Didn't update MCT tag to github since it broke cam's build scripts
   PIO
     pio wasn't updated because newer version needs FORTRAN 2003, so all lahey
     tests failed.
   stubs1_3_02 -> stubs1_3_04
   Machines_120515 -> Machines_120802

.  Merge in branch tag branch_tags/bldnml_tags/bldnml04_cam5_1_31
    .CESM build namelist fixes

.  Cloud diagnostics bug fix in cloud_diagnostics.F90.

.   Additional optional microphysics output diagnostics.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       SVN_EXTERNAL_DIRECTORIES
.  updated externals to match cesm1_1_beta16, except for CLM, MCT,and PIO
   PIO has Fortran 2003 code which isn't supported in lahey, there will 
   be a patch for this.  MCT needs to be built using the MCT configure
   script, which isn't supported with the cam stand alone build.
   CLM's configure needs a definition file from datm.


M       models/atm/cam/test/system/TCB.sh
.  Update for cice decomp updates
.  Make seperate explicit calls to generate_cice_decomp to get decomp_type, 
   maxblocks, bsize_x, and bsize_y.

M       models/atm/cam/test/system/TCB_ccsm.sh
.  Renamed env_mach_pes.xml to env_configure.xml
.  Add xmlchange for RUNDIR

M       models/atm/cam/bld/configure
.  new decomp types for cice

M       models/atm/cam/bld/cam.buildnml.csh
M       models/atm/cam/bld/cam.cpl7.template
.  CESM build namelist fixes

M       models/atm/cam/bld/build-namelist
.  Change debug print messages

M       models/atm/cam/src/physics/cam/cloud_diagnostics.F90
.  cloud_diagnostics bug fix,  gravit*1000 should be just gravit in call to conv_water_4rad

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/microp_driver.F90
.   Additional optional microphysics output diagnostics.

M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
.   Fixed typo


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
          079 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Tue Aug 21 18:07:07 MDT 2012
          Change in cice decomp type changes answers for some cases

edinburgh/lf95: all passed

edinburgh/pgi: all passed 

===============================================================
===============================================================

Tag name: cam5_1_32
Originator(s): santos, eaton
Date: July 23, 2012
One-line Summary: remove dependencies in phys_control, vert diffusion cleanup

Purpose of changes:
 - To break the dependency of phys_control on ref_pres (and thus on the
   dynamics and physconst).
 - Move namelist options from phys_control to vertical_diffusion.
 - Remove #ifdef MODAL_AERO from vertical_diffusion.
 - Make trb_mtn_stress module fully portable.
 - General cleanup (remove goto statements, unnecessary code).

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

 - ref_pres_nl handles options for the reference pressure module.
 - trop_cloud_top_press is defined in namelist_definitions and
   always added by build_namelist.
   - Value for cam5 is 100 Pa. Currently only WACCM configurations
     go above this level.
   - Value for cam4 is currently 0 Pa. (CAM 4 uses k1mb as the
     microphysics top instead.)

 - The following namelist variables were moved from phys_control to
   vertical_diffusion:
   - do_iss
   - do_tms
   - tms_orocnst
   - tms_z0fac
   - vdiff_compute_obklen

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

models/atm/cam/src/physics/cam/phys_control.F90 :: phys_ctl_init
models/atm/cam/src/physics/cam/phys_control.F90 :: trop_cloud_top_init
 - These set various top/bottom levels for vertical_diffusion and the
   cloud physics, respectively.
 - Their functionality has been split between routines in other
   modules, in order to remove dependence on ref_pres.

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/diffusion_solver.F90 :: new_fieldlist_vdiff
 - Returns a new vdiff_selector ("fieldlist") object, given a
   constituent number.
 - Split fieldlist creation subroutine off of init_vdiff so that
   module does not have to be re-initialized by eddy_diff.

models/atm/cam/src/physics/cam/rad_constituents.F90 :: rad_cnst_get_mam_mmr_idx
models/atm/cam/src/physics/cam/rad_constituents.F90 :: rad_cnst_get_mode_num_idx
 - Get constituent indices of mam species mass mixing ratio, and mode
   number mixing ratio, respectively.
 - Used in cleanup of vertical diffusion.

models/atm/cam/src/physics/cam/ref_pres.F90 :: ref_pres_readnl
 - Namelist parser for ref_pres.
 - Added to move trop_cloud_top_press option from phys_control.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - Added trop_cloud_top_press to namelist.

models/atm/cam/bld/namelist_files/namelist_definition.xml
 - Added trop_cloud_top_press, moved options from phys_control to
   vertical_diffusion.

models/atm/cam/src/control/runtime_opts.F90
 - Added ref_pres namelist.

models/atm/cam/src/physics/cam/cldwat2m_macro.F90
models/atm/cam/src/physics/cam/cloud_fraction.F90
models/atm/cam/src/physics/cam/micro_mg_cam.F90
models/atm/cam/src/physics/cam/microp_aero.F90
models/atm/cam/src/physics/cam/ndrop_bam.F90
 - Updated location of trop_cloud_top_lev from phys_control to ref_pres.

models/atm/cam/src/physics/cam/diffusion_solver.F90
 - do_iss is set by input argument rather than gotten from phys_control.
 - Fieldlists are created by new_fieldlist_vdiff rather than init_vdiff.
 - vdiff_selector uses an allocatable list rather than a pointer, and
   the .not. and "any" operators operate without slicing. (Adding "(:)"
   actually does produce a semantic difference, though one that's
   irrelevant here!)

models/atm/cam/src/physics/cam/eddy_diff.F90
 - Get fieldlists from new_fieldlist_vdiff rather than init_vdiff.

models/atm/cam/src/physics/cam/molec_diff.F90
 - Use errstring argument to init_molec_diff to remove iulog and endrun
   dependencies.
 - init_molec_diff now calculates top/bottom of molecular diffusion

models/atm/cam/src/physics/cam/phys_control.F90
 - To remove ref_pres dependence, the following were removed
   from this module, and correspondingly from phys_getopts:
   - trop_cloud_top_init
     - trop_cloud_top_lev
     - trop_cloud_top_press
   - phys_ctl_init
     - do_molec_diff
     - ntop_eddy/nbot_eddy
     - ntop_molec/nbot_molec
 - Because they relate specifically to vertical_diffusion, the following
   were also removed:
   - do_iss
   - do_tms
   - tms_orocnst
   - tms_z0fac
   - vdiff_compute_obklen

models/atm/cam/src/physics/cam/physpkg.F90
 - phys_ctl_init and trop_cloud_top_init calls removed.

models/atm/cam/src/physics/cam/rad_constituents.F90
 - Added rad_cnst_get_mam_mmr_idx and rad_cnst_get_mode_num_idx.

models/atm/cam/src/physics/cam/ref_pres.F90
 - Added ref_pres_readnl.
 - Add trop_cloud_top_lev calculation.

models/atm/cam/src/physics/cam/trb_mtn_stress.F90
 - Used errstring to remove dependency on iulog, took dependence on
   shr_const_mod back out.

models/atm/cam/src/physics/cam/tropopause.F90
 - Replaced goto statements with cycle/exit.
 - Comment typo fixes.

models/atm/cam/src/physics/cam/vertical_diffusion.F90
 - Added variables to namelist from phys_control.
 - vertical_diffusion now decides if molecular diffusion will be done.
 - ntop_molec/nbot_molec are returned from init_molec_diff, not phys_getopts.
 - vertical_diffusion now determines ntop_eddy/nbot_eddy values.
 - Uses new_fieldlist_vdiff.
 - Handles new errstring outputs from init_molec_diff and init_tms.
 - New rad_constituent procedures and prog_modal_aero used to remove
   #ifdef MODAL_AERO statements.

models/atm/cam/src/physics/rrtmg/rad_solar_var.F90
 - Used DIM argument to maxloc to change size 1 vector to scalar.

models/atm/cam/src/physics/waccm/gw_drag.F90
 - nbot_molec used from molec_diff rather than queried from phys_getopts

models/atm/cam/src/physics/waccmx/majorsp_diffusion.F90
 - Unused Boltzmann constant removed.
 - ntop_molec/nbot_molec used from molec_diff rather than phys_control.
 - Do loop guaranteed to have exactly one iteration removed (replaced
   with simple assignment).


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  

 - All PASS.

edinburgh/lf95: 

 - All PASS.

edinburgh/pgi or jaguar/pgi: 

 - All PASS.

Summarize any changes to answers: None. All bit-for-bit.

===============================================================

===============================================================

Tag name: cam5_1_31
Originator(s):fischer, eaton, jedwards 
Date: 5-25-2012
One-line Summary: homme updates, 1/2 cam4 tunings, and bug fixes

Purpose of changes:

. Updated testing scripts to handle CESM jaguarpf to titan name change.
. Added new COSP tests that skip MISR and RADAR simulators because they
  cause answer changes when the columns change.  This happens when different
  pes layouts, or phys_loadbalance changes.
. Added ability to set tunings differently depending on the ocean model
. Merge with cam1/branch_tags/camse_cam5_1_27_tags/01_camse_cam5_1_27/
  Updates for homme, memory reduction
  Changes to vert_remap_q_alg in namelist_defaults_cam.xml 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
. Added ability to set tunings differently depending on the ocean model

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
. For ne60 with 256 mpi tasks on bluefire memory usage when from
  858Mb high water per task to 778Mb
  648Mb low water per task to 573Mb

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/test_driver.sh
.  added titan
 
M       models/atm/cam/test/system/tests_posttag_bluefire
M       models/atm/cam/test/system/input_tests_master
A       models/atm/cam/test/system/nl_files/outfrq3s_cosp
.  New COSP tests that skips MISR and the RADAR simulators
   This is to get around failing tests because of answer changes when
   columns are changed.

M       models/atm/cam/bld/configure
. remove 'none' as an option for -ocn.
. remove default setting of $ocn_pkg='none' when -ccsm_seq option set

M       models/atm/cam/bld/config_files/definition.xml
. replace 'none' by 'pop2' as valid value for ocn.

M       models/atm/cam/bld/cam.buildnml.csh
. use $COMP_OCN to set value of -ocn argument to configure (replace
  hardcoded value 'none')

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add tunings for 1/2 deg cam4 for cldfrc_rhminh, cldfrc_rhminl,
  cldfrc_sh1, cldwat_icritw
. Merge with cam1/branch_tags/camse_cam5_1_27_tags/01_camse_cam5_1_27/
  Changes made to vert_remap_q_alg

M       models/atm/cam/bld/build-namelist
. Added test for $cam_build when setting bndtvs and focndomain

M       models/atm/cam/src/control/cam_history.F90
.  Changed the len of logname from 8 to 16 to fix PGI problem on lynx.

M       models/atm/cam/src/physics/cam/microp_aero.F90
.  Initialize for ptend was needed.

M       models/atm/cam/src/dynamics/homme/interp_mod.F90
.  Updated seq_io_mod to use shr_pio_mod

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
.  updated homme external to homme1_3_6

M       SVN_EXTERNAL_DIRECTORIES
.  updated externals tags to cesm1_1_beta14 tags


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
070 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Thu May 24 11:46:43 MDT 2012
073 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Thu May 24 11:47:16 MDT 2012
082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Thu May 24 16:24:01 MDT 2012
.  homme is expected to changes answer



edinburgh/lf95: all passed 

edinburgh/pgi: 
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Tue May 22 20:14:51 MDT 2012
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Tue May 22 22:07:24 MDT 2012
.  homme is expected to changes answer

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_30
Originator(s): fvitt bardeenc
Date: 18 May 2012
One-line Summary: Chemisry and CARMA bug fixes

Purpose of changes:

Chemistry bug fixes
 - corrected SO2 + OH --> H2SO4 reaction in trop_strat_mam3 chemistry package
 - include wet removal of H2SO4 for aerosol chemistry packages other than trop_mam3
 - remove use of deprecated commap module from chemistry source code
 - include of solar/geomagnetic activity data in history files for WACCM

CARMA bug fixes
- carma_do_clearsky was not being passed to CARMA_Initialize (is false by default)
- the default for carma_do_clearsky was not correct for the cirrus model (should have been false)

CARMA models
- (cirrus) changed namelist defaults to match latest runs on Pleiades
- (pmc) added dust/ice coagulation
- (test_tracers) new model for tracer trajectory studies

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A    models/atm/cam/bld/namelist_files/use_cases/cam5_trop_strat_chem.xml
 -new build-namelist use case for *STRATMAM compsets

A    models/atm/cam/src/physics/carma/models/test_tracers/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/test_tracers/carma_model_flags_mod.F90
A    models/atm/cam/src/physics/carma/models/test_tracers
- (test_tracers) new model for tracer trajectory studies

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/bld/config_files/definition.xml
M    models/atm/cam/bld/configure
 - added new carma option (test_tracers)

M    models/atm/cam/bld/namelist_files/namelist_definition.xml
 - moved "diag_cnst_conv_tend" to "cam_diags_opts" namelist group
 - added definition for "met_srf_nudge_flux" namelist option
 - CARMA namilist options added:
    . carma_launch_doy
    . carma_emission_rate

M    models/atm/cam/bld/perl5lib/Build/ChemNamelist.pm
 - remove H2SO4 from wet dep list only for chem package trop_mam3

M    models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - resolve $CASEBUILD path so that the chemistry preprocessor execute
   properly within CESM scripts

M    models/atm/cam/test/system/test_driver.sh

M    models/atm/cam/src/physics/carma/cam/carma_intr.F90
 - pass do_clearsky option into CARMA model

M    models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
 - invoke CAMRA_AddCoagulation

M    models/atm/cam/src/physics/carma/models/cirrus/carma_cloudfraction.F90
 - change "camsrfexch_types" to "camsrfexch" so this will compile

M    models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
M    models/atm/cam/bld/namelist_files/use_cases/sd_waccm_geos5.xml
 - update to solar irradiance data input
 - update to list of GEOS5 meteorology input files

M    models/atm/cam/bld/namelist_files/use_cases/cam4_bam_radpsv_geos5.xml
 - update to list of GEOS5 meteorology input files

M    models/atm/cam/bld/namelist_files/use_cases/cam4_chem_radpsv_geos5.xml
 - update to list of GEOS5 meteorology input files
 - gas_wetdep_method set to "NEU"

M    models/atm/cam/bld/namelist_files/use_cases/cam4_trop_strat_chem.xml
 - set do_tms to .false.
 - gas_wetdep_method set to "NEU"

M    models/atm/cam/bld/build-namelist
 - changes for CARMA

M    models/atm/cam/src/physics/cam/cam_diagnostics.F90
M    models/atm/cam/src/control/runtime_opts.F90
 - moved reading of cam_diagnostics namelist options from runtime_opts to cam_diagnostics

M    models/atm/cam/src/control/cam_history_support.F90
M    models/atm/cam/src/control/cam_history.F90
 - restored inclusion of solar/geomagnetic activity data in history files for waccm

M    models/atm/cam/src/physics/cam/tropopause.F90
 - added TROP_DZ diagnostic history output

M    models/atm/cam/src/physics/cam/phys_control.F90
 - increased length of cam_chempkg_out optional argument

M    models/atm/cam/src/physics/cam/eddy_diff.F90
 - corrected pressure units in description of eddy_max_bot_pressure var

M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sad.F90
M    models/atm/cam/src/chemistry/mozart/mo_sad.F90
 - removed latndx and lonndx from arg list of sad_strat_calc routine, which are not used

M    models/atm/cam/src/chemistry/utils/mo_flbc.F90
 - removed use of commap module, which is deprecated

M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - removed latndx and lonndx from args passed into routines which don't make use of these variables

M    models/atm/cam/src/chemistry/mozart/mo_fstrat.F90
M    models/atm/cam/src/chemistry/mozart/mo_setext.F90
M    models/atm/cam/src/chemistry/mozart/mo_photoin.F90
 - removed latndx and lonndx from arg list, which are not used

M    models/atm/cam/src/chemistry/mozart/mo_photo.F90
 - removed latndx and lonndx from arg list, which are not used
 - set do_jshort to false for fast TUV method
 - removed use of deprecated commap module and use phys_grid interface to determine grid point locations

M    models/atm/cam/src/chemistry/mozart/mo_seto2.F90
M    models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
 - output known aerosol species in units of MMR and gas-phase species as VMR
   . the exception to this is trop_mam3 which outputs all species in units of MMR

M    models/atm/cam/src/chemistry/mozart/mo_synoz.F90
 - removed use of deprecated commap module and use dyn_grid interface to determine latitudes
   and latitude weights grid boxes

M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.in
 - corrected SO2 + OH --> H2SO4 reaction

M    models/atm/cam/src/dynamics/sld/grmult.F90
 - corrected code to compute virtual temperature (otherwise this would not compile)

M    models/atm/cam/src/dynamics/sld/sld_control_mod.F90
 - correction to endrun message in dyn_sld_readnl subroutine

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
052 bl415 TBL.sh fst1.9c5dh outfrq3s 9s ...................................FAIL! rc= 7 at Thu May 17 13:16:55 MDT 2012
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu May 17 13:17:55 MDT 2012
 These failures are expected due to H2SO4 added to list of tracers which are wet removed

edinburgh/lf95: All Pass

edinburgh/pgi:
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Wed May 16 18:35:24 MDT 2012
 This failure is expected due to H2SO4 added to list of tracers which are wet removed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_29
Originator(s): Cheryl Craig and Brian Eaton
Date: 5/10/2012
One-line Summary: Introduced driver layer for modal_aero_wateruptake and cleanup and bug fix

Purpose of changes: 
 Introduced driver layer for modal_aero_wateruptake to allow incorporation of sub-columns
 prec_zmc and snow_zmc renamed prec_dp and snow_dp  - both stored in pbuf
 prec_cmf and snow_cmf renamed prec_sh and snow_sh and  - both stored in pbuf
 prec_str, snow_str, prec_sed, snow_sed, prec_pcw and snow_pcw now stored in pbuf

Bugs fixed (include bugzilla ID):
 bug fix for klambda check in rrtmg/cloud_rad_props.F90, if == 1 then would klambda-1 would be out-of-bound index

Describe any changes made to build system:

Describe any changes made to the namelist:
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Eaton

List all subroutines eliminated:

D       models/atm/cam/src/control/camsrfexch_types.F90
           renamed camsrfexch.F90

D       models/atm/cam/src/control/srfxfer.F90
           moved into camsrfexch.F90 module and renamed cam_export

List all subroutines added and what they do:
A  +    models/atm/cam/src/control/camsrfexch.F90
           renamed from camsrfexch_type.F90 and now contains old srfxfer routine which is renamed cam_export
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
           new driver layer (modal_aero_wateruptake_dr) introduced to aid subcolumns

M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/convect_deep.F90
MM      models/atm/cam/src/physics/cam/microp_driver.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
          prec_zmc and snow_zmc renamed prec_dp and snow_dp  - both stored in pbuf
          prec_cmf and snow_cmf renamed prec_sh and snow_sh and  - both stored in pbuf
          prec_str, snow_str, prec_sed, snow_sed, prec_pcw and snow_pcw now stored in pbuf

M       models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
          bug fix for klambda check, if == 1 then klambda-1 would be out-of-bound index

M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
          calls modal_aero_wateruptake_dr now 

M       models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M       models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_lightning.F90
M       models/atm/cam/src/chemistry/mozart/chemistry.F90
M       models/atm/cam/src/chemistry/mozart/mo_drydep.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M       models/atm/cam/src/chemistry/pp_none/chemistry.F90
M       models/atm/cam/src/chemistry/utils/aerodep_flx.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_deposition.F90
M       models/atm/cam/src/control/cam_comp.F90
M       models/atm/cam/src/control/cam_restart.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M       models/atm/cam/src/dynamics/eul/inital.F90
M       models/atm/cam/src/dynamics/eul/stepon.F90
M       models/atm/cam/src/dynamics/fv/stepon.F90
M       models/atm/cam/src/dynamics/fv/fv_prints.F90
M       models/atm/cam/src/dynamics/fv/metdata.F90
M       models/atm/cam/src/dynamics/homme/stepon.F90
M       models/atm/cam/src/physics/cam/carma_intr.F90
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M       models/atm/cam/src/physics/cam/flux_avg.F90
M       models/atm/cam/src/physics/cam/iop_surf.F90
M       models/atm/cam/src/physics/cam/phys_debug.F90
M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/cam/radiation_data.F90
M       models/atm/cam/src/physics/cam/restart_physics.F90
M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
M       models/atm/cam/src/physics/carma/cam/carma_cloudfraction.F90
M       models/atm/cam/src/physics/carma/cam/carma_intr.F90
M       models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/bc_strat/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sulfate/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_swelling/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_detrain/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_radiative/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_growth/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/test_passive/carma_model_mod.F90
M       models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
M       models/atm/cam/src/physics/rrtmg/rrtmg_state.F90
M       models/atm/cam/src/dynamics/sld/stepon.F90
           rename of camsrfexch_types to camsrfexch

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all BFB

edinburgh/lf95:  all BFB

edinburgh/pgi:  all BFB
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam5_1_28
Originator(s): bardeenc santos
Date: May 8, 2012
One-line Summary: CARMA added, sathist multiple columns, cleanup

Purpose of changes:

 - Add CARMA (Community Aerosol and Radiation Model for Atmospheres),
   along with several CARMA models:
   - bc_strat
   - cirrus
   - meteor_smoke
   - pmc
   - sea_salt
   - sulfate
   As well as basic test/tutorial models for CARMA:
   - test_detrain
   - test_growth
   - test_passive
   - test_radiative
   - test_swelling

 - Add new chemistry package: waccm_mozart_sulfur, usable with
   the CARMA sulfate model.

 - New features used by CARMA, but potentially relevant outside of
   CARMA, include:
     - The ability to turn off some processes in MG microphysics and
       Park macrophysics.
     - A flag specifying the stage at which a constituent will undergo
       convective transport.
     - New spectral flux outputs for radiation.
     - The ability to calculate the Obukhov length outside the HB/HBR
       eddy scheme.

 - Allow sat_hist to use more than one column near a given point, as
   well as giving columns from more than one timestep, to allow
   interpolation in time and space.

 - Update/add to WACCM namelist defaults for certain configurations.

 - Tweaked forcing from meteorological data.

 - Improve Darwin parallel support.

 - Minor cleanup to RRTMG.

 - Some options from cldwat have been moved into cloud_fraction.

Bugs fixed (include bugzilla ID):

 - Bug #1475 has been partially addressed by this tag, which removed
   the faulty option (liu_in == .true. is the only valid behavior for
   MG microphysics). The faulty functionality will be restored with
   the addition of further ice nucleation options in a future tag.

Describe any changes made to build system:

 - Improved support for compilation using Darwin.

 - Added configure and namelist options specific to CARMA and
   waccm_mozart_sulfur, including also.

 - Namelist variables for new satellite history, RRTMG spectral
   (per-band) fluxes, changing wv_saturation scheme.

 - Moved/combined some variables from cldwat to cloud_fraction
   (cldfrc).

Describe any changes made to the namelist:

 - New defaults for certain WACCM resolutions:

       <ncdata dyn="fv"  hgrid="1.9x2.5"   nlev="64"  ic_ymd="101"     >atm/cam/inic/fv/cami_0000-01-01_1.9x2.5_L64_c070703.nc</ncdata>
       <ncdata dyn="fv"  hgrid="4x5"       nlev="64"  ic_ymd="101"     >atm/cam/inic/fv/cami_0000-01-01_4x5_L64_c090108.nc</ncdata>
       <ncdata dyn="fv"  hgrid="10x15"     nlev="64"  ic_ymd="101"     >atm/cam/inic/fv/cami_0000-01-01_10x15_L64_c081013.nc</ncdata>
       <ncdata dyn="fv"  hgrid="1.9x2.5"   nlev="125"  ic_ymd="20000701" >atm/waccm/ic/cami_2000-07-01_1.9x2.5_L125_c040928.nc</ncdata>

 - WACCM emissions files updated:

         <nox_emis_file  chem="waccm_mozart">atm/cam/chem/1850-2000_emis/IPCC_emissions_houw_NOx_1850-2000_1.9x2.5.c090728.nc</nox_emis_file>
         <co_emis_file   chem="waccm_mozart">atm/cam/chem/1850-2000_emis/IPCC_emissions_houw_CO_1850-2000_1.9x2.5.c090728.nc</co_emis_file>
         <ch2o_emis_file chem="waccm_mozart">atm/cam/chem/1850-2000_emis/IPCC_emissions_houw_CH2O_1850-2000_1.9x2.5.c090728.nc</ch2o_emis_file>
         <so2_emis_file  chem="waccm_mozart">atm/cam/chem/1850-2000_emis/IPCC_emissions_houw_SO2_1850-2000_1.9x2.5.c090522.nc</so2_emis_file>

      In the waccm_2000_cam4 use case:
         <flbc_file>atm/waccm/lb/LBC_1765-2005_1.9x2.5_CMIP5_za_c111110.nc</flbc_file>

 - Defaults for recently added eddy diffusion variables are now set
   in namelist_defaults_cam.xml rather than hard-coded in the module:

      <kv_top_pressure                      >0.D0</kv_top_pressure>
      <kv_top_scale                         >1.D0</kv_top_scale>
      <kv_freetrop_scale                    >1.D0</kv_freetrop_scale>
      <eddy_lbulk_max                       >40.e3</eddy_lbulk_max>
      <eddy_leng_max                        >40.e3</eddy_leng_max>
      <eddy_max_bot_pressure                >100.e3</eddy_max_bot_pressure>
      <diff_cnsrv_mass_check                > .false. </diff_cnsrv_mass_check>

 - Several changes specific to CARMA and waccm_mozart_sulfur.

 - H2SO4 added to drydep and wetdep lists.

 - New logical flags for turning off processes in macro/microphysics:
     - macro_park_do_cldice
     - macro_park_do_cldliq
     - macro_park_do_detrain
     - micro_mg_do_cldice
     - micro_mg_do_cldliq

 - Namelist options for cldfrc replacing functionality in cldwat:
     - cldfrc_rhminl_adj_land
     - cldfrc_premib
     - cldfrc_iceopt
     - cldfrc_icecrit

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/chem_mech.in
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_lin_matrix.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_rxt_rates_conv.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_sulfur/mo_usrrxt.F90
        - New waccm_mozart chemistry branch.

A    models/atm/cam/src/physics/cam/carma_flags_mod.F90
        - Module that provides CARMA-specific flags.

A    models/atm/cam/src/physics/cam/carma_intr.F90
A    models/atm/cam/src/physics/cam/carma_model_flags_mod.F90
        - Stubs for CARMA-specific code, used when the corresponding
          CARMA modules are not compiled.

A    models/atm/cam/src/physics/carma
A    models/atm/cam/src/physics/carma/cam/
A    models/atm/cam/src/physics/carma/cam/carma_cloudfraction.F90
A    models/atm/cam/src/physics/carma/cam/carma_constants_mod.F90
A    models/atm/cam/src/physics/carma/cam/carma_getT.F90
A    models/atm/cam/src/physics/carma/cam/carma_intr.F90
A    models/atm/cam/src/physics/carma/cam/carma_precision_mod.F90
A    models/atm/cam/src/physics/carma/models/
A    models/atm/cam/src/physics/carma/models/bc_strat/
A    models/atm/cam/src/physics/carma/models/bc_strat/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/cirrus/
A    models/atm/cam/src/physics/carma/models/cirrus/carma_cloudfraction.F90
A    models/atm/cam/src/physics/carma/models/cirrus/carma_model_flags_mod.F90
A    models/atm/cam/src/physics/carma/models/cirrus/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/cirrus/growevapl.F90
A    models/atm/cam/src/physics/carma/models/meteor_smoke/
A    models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_flags_mod.F90
A    models/atm/cam/src/physics/carma/models/meteor_smoke/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/pmc/
A    models/atm/cam/src/physics/carma/models/pmc/carma_model_flags_mod.F90
A    models/atm/cam/src/physics/carma/models/pmc/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/sea_salt/
A    models/atm/cam/src/physics/carma/models/sea_salt/carma_model_flags_mod.F90
A    models/atm/cam/src/physics/carma/models/sea_salt/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/sulfate/
A    models/atm/cam/src/physics/carma/models/sulfate/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/test_detrain/
A    models/atm/cam/src/physics/carma/models/test_detrain/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/test_growth/
A    models/atm/cam/src/physics/carma/models/test_growth/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/test_passive/
A    models/atm/cam/src/physics/carma/models/test_passive/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/test_radiative/
A    models/atm/cam/src/physics/carma/models/test_radiative/carma_model_mod.F90
A    models/atm/cam/src/physics/carma/models/test_swelling/
A    models/atm/cam/src/physics/carma/models/test_swelling/carma_model_mod.F90
        - Added CARMA-CAM interface and several CARMA models.

X    models/atm/cam/src/physics/carma/base
        - External for CARMA's base code.

A    models/atm/cam/test/system/config_files/f1.9c4carmsulm
A    models/atm/cam/test/system/config_files/f1.9c5carmbc_m
A    models/atm/cam/test/system/config_files/f1.9c5carmcirm
A    models/atm/cam/test/system/config_files/f1.9c5carmmetm
A    models/atm/cam/test/system/config_files/f1.9c5carmpmcm
A    models/atm/cam/test/system/config_files/f1.9c5carmseam
A    models/atm/cam/test/system/nl_files/carma24h
A    models/atm/cam/test/system/tests_carma
        -Added CARMA-specific tests for various models

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
        - Added CARMA base external, updated RRTMG external.

M    models/atm/cam/bld/Makefile.in
M    models/atm/cam/src/utils/abortutils.F90
M    models/atm/cam/tools/interpic/Makefile
        - Improved Darwin support.

M    models/atm/cam/bld/config_files/definition.xml
M    models/atm/cam/bld/configure
        - Added CARMA, waccm_mozart_sulfur.

M    models/atm/cam/bld/namelist_files/master_drydep_list.xml
M    models/atm/cam/bld/namelist_files/master_gas_wetdep_list.xml
        - Added H2SO4 to main gas phase lists.
        - Removed MAM-specific drydep entry to prevent
          double-counting.

M    models/atm/cam/bld/build-namelist
M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M    models/atm/cam/bld/namelist_files/namelist_definition.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
        - Added CARMA, waccm_mozart_sulfur, and sathist options.
        - New files for various WACCM resolutions.
        - Updated WACCM emis_file defaults (but usually overridden by
          use case defaults anyway).
        - Eddy diffusion defaults now set in namelist_defaults_cam.

M    models/atm/cam/bld/perl5lib/Build/ChemNamelist.pm
        - Tweaks to gas_wetdep_list moved from build-namelist to
          set_dep_lists.
        - Avoid changing answers for trop_mam due to
          waccm_mozart_sulfur's addition of H2SO4 to gas wetdep.

M    models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
        - Notify hub2atm if CARMA is doing drydep.

M    models/atm/cam/src/chemistry/bulk_aero/wetdep.F90
        - is_strat_cloudborne handled properly as optional argument
          rather than using #ifdef MODAL_AERO statements.

M    models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
        - Unnecessary use statement removed.

M    models/atm/cam/src/control/physconst.F90
        - Some constants from shr_const_mod are now used instead of
          recalculated with identical formulae.

M    models/atm/cam/src/control/runtime_opts.F90
        - Add CARMA readnl, microp/macrop driver readnl, and the new
          RRTMG spectralflux option.

M    models/atm/cam/src/control/sat_hist.F90
M    models/atm/cam/src/dynamics/eul/dyn_grid.F90
M    models/atm/cam/src/dynamics/fv/dyn_grid.F90
M    models/atm/cam/src/dynamics/homme/dyn_grid.F90
M    models/atm/cam/src/dynamics/sld/dyn_grid.F90
        - Now can use n closest columns to a given point, rather than
          only the nearest column.
        - sat_hist.F90 can output multiple timesteps as well.
        - Distance is now the great circle distance rather than
          lon^2+lat^2 (this will change the closest column found in
          some cases, particularly unstructured grids, points near 0
          degrees longitude, and points near the poles).

M    models/atm/cam/src/dynamics/eul/grmult.F90
M    models/atm/cam/src/dynamics/sld/grmult.F90
        - Replaced call to virtem with equivalent one-liner.

M    models/atm/cam/src/dynamics/eul/inidat.F90
M    models/atm/cam/src/dynamics/fv/inidat.F90
M    models/atm/cam/src/dynamics/homme/inidat.F90
M    models/atm/cam/src/dynamics/sld/inidat.F90
        - Add CARMA constituents.

M    models/atm/cam/src/dynamics/fv/metdata.F90
        - Meteorological data nudges, rather than forces, some CAM
          fields by default.
        - New namelist variable met_srf_nudge_flux can be set to
          .false. to recover the old behavior.

M    models/atm/cam/src/physics/cam/cldwat2m_macro.F90
M    models/atm/cam/src/physics/cam/cloud_fraction.F90
        - Account for CARMA's processes without trying to redo them.
        - Some subroutines made publically available for CARMA.
        - Some parameters now housed in cloud_fraction and read in
          from the namelist rather than set between cldwat2m_macro
          and cloud_fraction.

M    models/atm/cam/src/physics/cam/macrop_driver.F90
M    models/atm/cam/src/physics/cam/micro_mg.F90
M    models/atm/cam/src/physics/cam/micro_mg_cam.F90
M    models/atm/cam/src/physics/cam/microp_driver.F90
        - Account for physical processes executed by CARMA.
        - New namelist flags to control this behavior, and new readnl
          methods to get those flags.
        - The liu_in option has been removed, since setting it to
          false has produced garbage for some time now. See bug
          #1475 in bugzilla.
        - microp_driver now uses switch statement rather than if (this
          anticipates MG2 and/or other potential new schemes it will
          have to handle).

M    models/atm/cam/src/physics/cam/constituents.F90
M    models/atm/cam/src/physics/cam/stratiform.F90
M    models/atm/cam/src/physics/cam/zm_conv_intr.F90
        - Added flag for constituents to undergo convective transport
          in first or second stage.

M    models/atm/cam/src/physics/cam/eddy_diff.F90
        - Instead of trbintd, ustar now calculated from new calc_ustar
          subroutine in pbl_utils.
        - Surface density now output with ustar.

M    models/atm/cam/src/physics/cam/hb_diff.F90
        - Made clear that the module declares and uses its own value
          for zvir.
        - Added HB_ri field for Richardson number.
        - Use routines from pbl_utils to calculate virtual
          temperature, ustar, kinematic surface fluxes, and Obukhov
          length.
        - Virtual temperature is now only calculated once and reused,
          rather than recalculated several times.
        - Removed now-unnecessary arguments from several routines.
        - Instead of all constituent fluxes being input, only uses
          water vapor.

M    models/atm/cam/src/physics/cam/ndrop_bam.F90
        - Aerosols with no defined dispersion exempted from CCN loops.

M    models/atm/cam/src/physics/cam/phys_control.F90
        - Added wvsat_scheme option, since the scheme can now be
          changed.
        - Added flag vdiff_compute_obklen to force computation of
          Obukhov length outside the vertical diffusion.

M    models/atm/cam/src/physics/cam/phys_grid.F90
        - Added phys_grid_find_cols, identical to phys_grid_find_col
          except that it finds multiple nearest columns and uses the
          great circle distance to find them.

M    models/atm/cam/src/physics/cam/phys_prop.F90
        - Added 'trim' to string included in endrun message.

M    models/atm/cam/src/physics/cam/physpkg.F90
        - Set convective transport stage for water vapor.
        - Added calls to CARMA.

M    models/atm/cam/src/physics/cam/radconstants.F90
M    models/atm/cam/src/physics/cam/radsw.F90
        - CAMRT's radsw no longer thinks it's clever to sneak an index
          into the hundredth's place of a float. Sure, it seemed like
          the thing to do when it was young and headstrong, but times
          have changed, and radsw.F90 has grown up. It has adopted the
          more conventional approach of accepting a separate integer
          array from radconstants.
        - Accordingly, wavmin and wavmax are only available through
          an improved accessor function.

M    models/atm/cam/src/physics/cam/radiation.F90
M    models/atm/cam/src/physics/rrtmg/radiation.F90
M    models/atm/cam/src/physics/rrtmg/radlw.F90
M    models/atm/cam/src/physics/rrtmg/radsw.F90
        - Added new spectralflux option. Only used in RRTMG.

M    models/atm/cam/src/physics/cam/vertical_diffusion.F90
        - No longer sets defaults that are always provided via
          namelist.
        - Accomodates changes in eddy diffusion subroutine arguments.
        - If vdiff_compute_obklen == .true., now calculates obklen
          itself regardless of the eddy scheme.

M    models/atm/cam/src/physics/cam/wv_saturation.F90
        - 'MurphyKoop' scheme added for new wvsat_scheme option.

M    models/atm/cam/src/physics/cam/zm_conv.F90
        - Removed pcnst dependency (workaround for bug on PGI).

M    models/atm/cam/src/physics/rrtmg/ebert_curry.F90
M    models/atm/cam/src/physics/rrtmg/oldcloud.F90
M    models/atm/cam/src/physics/rrtmg/slingo.F90
        - wavmin and wavmax are now set by accessor function.

M    models/atm/cam/src/physics/rrtmg/rad_solar_var.F90
M    models/atm/cam/src/physics/rrtmg/radconstants.F90
        - Tweak to include far-IR in solar variability is now done in
          rad_solar_var rather than radconstants. (Lowest bin extends
          down to 100 microns, regardless of actual value.)
        - Accessor functions (get_sw/lw_spectral_boundaries) have
          minor improvements.

M    models/atm/cam/test/system/input_tests_master
        - Added CARMA tests.

M    models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
M    models/atm/cam/src/physics/cam/phys_debug_util.F90
M    models/atm/cam/src/physics/waccm/gw_drag.F90
M    models/atm/cam/src/utils/cam_pio_utils.F90
        - Cosmetic changes (comments, typos, whitespace).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all passed

edinburgh/lf95: all passed except

bl318 TBL.sh f10c4cdm sat_hist 9s

      This is an expected answer change, because satellite history
      interpolation now uses the correct great circle distance to find
      distances to columns.

edinburgh/pgi or jaguar/pgi: all passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: Any with satellite history output.
- what platforms/compilers: All
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):
        - Diagnostic output in satellite history file changes for some
          columns; this has no effect on other output, which is all
          bit for bit.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_27
Originator(s): jedwards, mtaylor, mlevy 
Date: 4-20-2012
One-line Summary: CAM-SE dycore updates, externals update

Purpose of changes: CAM_SE development, compatability with changes in PIO, driver and csm_share externals

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
      added vert_remap_q_alg to allow a toggle between three possible algorythms for vertical remapping in camse
      renamed pio_inparm to pio_default_inparm for cam standalone for compatibility with cesm build changes
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Edwards, Eaton

List all subroutines eliminated:

List all subroutines added and what they do:
      models/atm/cam/bld/cam.buildnml.csh
      models/atm/cam/bld/cam.buildexe.csh
        Part of new cesm build mechanism
	
List all existing files that have been modified, and describe the changes:
      models/atm/cam/test/system/nl_files/aqua
	added FU and FV to history file so that dyn grid variables are tested in history restart
      models/atm/cam/test/system/TCB_ccsm.sh
	removed obsolete option -skip_rundb 
      models/atm/cam/test/system/TSM_ccsm.sh
	Added -f flag to rm to avoid error message when file not found
      models/atm/cam/bld/configure
	Changed when variables are resolved in cesm build
      models/atm/cam/bld/Makefile.in
	Corrected rpath flag
      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
	Changed default cam-se limiter option 
      models/atm/cam/bld/namelist_files/namelist_definition.xml
	Added cam-se vert_remap_q_alg flag controls vertical remapping in dycore, updated pio namelist variable names
      models/atm/cam/bld/build-namelist
	Change pio namelist name
      models/atm/cam/bld/cam.cpl7.template
	Code moved to cam.build*.csh
      models/atm/cam/SVN_EXTERNAL_DIRECTORIES
	update dynamics/homme/share to latest cam-se dycore code
	
      models/atm/cam/src/dynamics/sld/dyn_grid.F90
      models/atm/cam/src/dynamics/eul/dyn_grid.F90
      models/atm/cam/src/dynamics/homme/dyn_grid.F90
      models/atm/cam/src/dynamics/fv/dyn_grid.F90
      models/atm/cam/src/utils/cam_pio_utils.F90
	Changed from seq_io_mod to shr_pio_mod, changed ldof arrays to kind=pio_offset

      models/atm/cam/src/control/cam_history.F90
	Fixed a problem with camse dyn grid variables in history restart file 
	
      models/atm/cam/src/physics/cam/tidal_diag.F90
	Changed source of constants from shr_const_mod to physconst
      models/atm/cam/src/physics/cam/phys_grid.F90
	Changed default load balance option from 0 to 2
      models/atm/cam/src/dynamics/homme/interp_mod.F90
      models/atm/cam/src/dynamics/homme/native_mapping.F90
      models/atm/cam/src/dynamics/homme/dyn_comp.F90
      models/atm/cam/src/dynamics/homme/restart_dynamics.F90
      models/atm/cam/src/dynamics/homme/inital.F90
        Updated interface to cam-se share code

      models/atm/cam/src/dynamics/homme/inidat.F90
	Fixed pertlim to apply perturbations to initial temperature field
	
      SVN_EXTERNAL_DIRECTORIES
	Updated externals

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   All pass except   
     070 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL
     073 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL
     082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL
edinburgh/lf95: All pass except 
     040 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! 

edinburgh/pgi:  All pass except 
     044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL!
     059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL!
     062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL!

	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

	Changes to CAM-SE for which we do not yet have a standard climate.
	Changes to COSP tests due to the change in default phys_loadbalance from 0 to 2, 
	this is a bug to be investigated.   

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_26 
Originator(s): fischer
Date: Mon Apr  9 15:59:20 MDT 2012
One-line Summary: svn external updates, Makefile updates, testing updates

Purpose of changes:

. svn externals updated to cesm1_1_beta11 component tags.  csm_share tag had a bug
  that was caught by the lahey compiler, so the latest csm_share tag was
  needed, along with a newer esmf_wrf_timemgr and clm tags.

. Makefile.in was updated to set CPPDEF flags to specify different compilers
  in the latests csm_share tag.

. CESM tests for 2deg FAMIPC5 and T42 FC5 were added to bluefire posttag test.
  PES layouts for cesm are being overridden by the cam tests scripts.
  lrg_regular queue is being used for bluefire testing.

.  fatmgrid was removed from the namelists, now using combined grid/land
   fraction data fatmlndfrc

.  atm_id was made public in cam_instance.F90 to speed up lookups in shr_pio_mod

.  New initial condition files for ne16 and ne60

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

. Makefile.in was updated to set CPPDEF flags for the different compilers
  in the latests csm_share tag.  
    For PGI compiler       set -DCPRPGI 
    For INTEL compiler     set -DCPRINTEL 
    For Pathscale compiler set -DCPRPATHSCALE 
    For Cray compiler      set -DCPRCRAY

Describe any changes made to the namelist:
.  new fatmlndfrc files, fatmgrid removed
 <fatmlndfrc hgrid="128x256" >share/domains/domain.clm/domain.lnd.T85_USGS.111004.nc</fatmlndfrc>
 <fatmlndfrc hgrid="64x128" >share/domains/domain.clm/domain.lnd.T42_USGS.111004.nc</fatmlndfrc>
 <fatmlndfrc hgrid="48x96" >share/domains/domain.lnd.T31_gx3v7.090928.nc</fatmlndfrc>
 <fatmlndfrc hgrid="32x64" >share/domains/domain.lnd.T21_USGS.111004.nc</fatmlndfrc>
 <fatmlndfrc hgrid="8x16" >share/domains/domain.clm/domain.lnd.T5_USGS.111004.nc</fatmlndfrc>

 <fatmlndfrc hgrid="0.23x0.31" >share/domains/domain.lnd.fv0.23x0.31_gx1v6.100517.nc</fatmlndfrc>
 <fatmlndfrc hgrid="0.47x0.63" >share/domains/domain.lnd.fv0.47x0.63_gx1v6.090407.nc</fatmlndfrc>
 <fatmlndfrc hgrid="0.9x1.25" >share/domains/domain.lnd.fv0.9x1.25_gx1v6.090309.nc</fatmlndfrc>
 <fatmlndfrc hgrid="1.9x2.5" >share/domains/domain.lnd.fv1.9x2.5_gx1v6.090206.nc</fatmlndfrc>
 <fatmlndfrc hgrid="2.5x3.33" >share/domains/domain.lnd.fv2.5x3.33_gx3v7.110223.nc</fatmlndfrc>
 <fatmlndfrc hgrid="4x5" >share/domains/domain.lnd.fv4x5_USGS.110713.nc</fatmlndfrc>
 <fatmlndfrc hgrid="10x15" >share/domains/domain.lnd.fv10x15_USGS.110713.nc</fatmlndfrc>

. New ncdata files for CAM5 ne16 and ne60
 <ncdata dyn="homme" hgrid="ne16np4"  nlev="30"             ic_ymd="101" >atm/cam/inic/homme/cami-mam3_0000-01-ne16np4_L30_c090306.nc</ncdata>
 <ncdata dyn="homme" hgrid="ne60np4"  nlev="30"             ic_ymd="101" >atm/cam/inic/homme/cami-mam3_0000-01-ne60np4_L30_c090306.nc</ncdata>

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/tests_posttag_bluefire
M       models/atm/cam/test/system/input_tests_master
  - add FAMIPC5 and T42 CAM5 tests

M       models/atm/cam/test/system/TCB_ccsm.sh
  - override cesm scripts pes layouts for cesm tests
	    
M       models/atm/cam/test/system/test_driver.sh
  - change bluefire queue to lrg_regular until we can replace the
    ne30 test with an ne16 tests 
  - updated hopper library paths for NETCDF

M       models/atm/cam/test/system/CAM_runcmnd.sh
  - set number of pes pre node to 24 for hopper

M       models/atm/cam/bld/Makefile.in
  - added CPPDEF compiler flags -DCPRPGI -DCPRINTEL -DCPRPATHSCALE and 
    -DCPRCRAY, which are needed to build csm_share
		   
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
  - added ne16 and ne60 CAM5 ncdata files
  - removed fatmgrid, switched to new combined grid/land fraction data files
    fatmlndfrc
			       
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/bld/build-namelist 
  - removed fatmgrid
				     
M       models/atm/cam/bld/cam.cpl7.template
  - fixed problem were cam template was being over written
						   
M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - updated rrtmg externals
					         
M       models/atm/cam/src/control/cam_instance.F90
 - made atm_id public.  This was done to make lookups in shr_pio_mod faster.


M       SVN_EXTERNAL_DIRECTORIES
  - updated to cesm1_1_beta11 component tags
  - needed to update to latest clm, esmf_wrf_timemgr, and csm_share tags
    because of bugs that caused lahey to fail

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Fri Apr  6 09:21:02 MDT 2012
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Fri Apr  6 09:21:10 MDT 2012 
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Fri Apr  6 09:21:20 MDT 2012
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Fri Apr  6 09:21:31 MDT 2012
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Fri Apr  6 09:22:17 MDT 2012
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Fri Apr  6 09:22:43 MDT 2012 
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Apr  6 09:23:31 MDT 2012
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Fri Apr  6 09:23:50 MDT 2012
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Fri Apr  6 09:24:16 MDT 2012
052 bl415 TBL.sh fst1.9c5dh outfrq3s 9s ...................................FAIL! rc= 7 at Fri Apr  6 09:58:04 MDT 2012
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Fri Apr  6 09:59:04 MDT 2012
057 bl440 TBL.sh fsoa1.9c4dh outfrq3s 9s ..................................FAIL! rc= 7 at Fri Apr  6 10:00:27 MDT 2012
061 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Fri Apr  6 10:00:42 MDT 2012
064 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Fri Apr  6 10:15:11 MDT 2012
067 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Fri Apr  6 11:06:22 MDT 2012
079 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Fri Apr  6 12:05:46 MDT 2012 
082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 7 at Fri Apr  6 13:34:04 MDT 2012
new clm tag is not bfb and causes baseline failures


edinburgh/lf95: 
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Mon Apr  9 09:47:37 MDT 2012
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Mon Apr  9 09:47:41 MDT 2012
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Mon Apr  9 09:47:46 MDT 2012
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Mon Apr  9 09:47:51 MDT 2012
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Mon Apr  9 09:48:30 MDT 2012
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Apr  9 09:58:14 MDT 2012
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Mon Apr  9 10:13:25 MDT 2012
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Apr  9 10:48:52 MDT 2012
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Mon Apr  9 11:05:56 MDT 2012
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Mon Apr  9 11:11:25 MDT 2012
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Mon Apr  9 11:18:50 MDT 2012
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Mon Apr  9 12:04:00 MDT 2012
new clm tag is not bfb and causes baseline failures


edinburgh/pgi: 
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Apr  6 11:15:26 MDT 2012
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Apr  6 11:24:26 MDT 2012
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Apr  6 11:35:05 MDT 2012
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Apr  6 11:54:22 MDT 2012
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Apr  6 12:50:52 MDT 2012
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Apr  6 13:08:14 MDT 2012
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Fri Apr  6 13:16:02 MDT 2012 
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Apr  6 13:34:37 MDT 2012
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Fri Apr  6 13:44:03 MDT 2012
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Fri Apr  6 13:47:54 MDT 2012
053 bl321 TBL.sh f10c5cdm atrain 9s .......................................FAIL! rc= 7 at Fri Apr  6 13:53:37 MDT 2012
056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Fri Apr  6 14:25:54 MDT 2012
new clm tag is not bfb and causes baseline failures



Summarize any changes to answers, i.e.: new clm tag is not bfb and causes baseline failures

===============================================================
===============================================================

Tag name: cam5_1_25
Originator(s): fvitt, emmons, mvertens
Date: 23 Mar 2012
One-line Summary: Corrections to tropospheric chemistry mechanisms and emissions inputs.

Purpose of changes:

 - Corrections to reactions in tropospheric chemistry packages
   to include M in reactions:
       MPAN + OH
       HCN + OH
 - Include HCOOH emissions in default namelist for tropospheric
   chemistry packages
 - Simplified specifications of default emission files for MAM-chemistry packages
 - Change in CAM configure to compile with MPICH2
 - Fix multiple instance in cesm scripts (cam.cpl7.template)

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Chris Fischer

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M     models/atm/cam/bld/cam.cpl7.template
 - Fix multiple instance in cesm scripts

M     models/atm/cam/bld/configure
 - check for MPICH2 -- do not set cppdefs NO_MPI2 and MO_MPIMOD for MPICH2

M     models/atm/cam/bld/build-namelist
 - include emissions files for HCOOH for tropospheric chem pkgs
 - corrected default emissions for trop_mozart_soa chem pkg
 - pass in ref to hash into get_default_value for emissions files
   -- use "ver" attribute for emis files to simplify namelist_defaults_cam.xml
 - change default emis files for super_fast_llnl_mam3 and trop_mam7

M     models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - update megan_factors_file
 - change location of default trop chem emissions
 - specify emissions for mam chemistry with "ver" attribute
   to combine many of the deplicate emissions

M     models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
M     models/atm/cam/bld/namelist_files/use_cases/2000_cam4_super_fast_llnl.xml
M     models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
M     models/atm/cam/bld/namelist_files/use_cases/1850_cam5_super_fast_llnl.xml
 - use mapped MEGAN emission factors for isoprene

M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_solve.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_prod_loss.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_lin_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/m_rxt_id.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_phtadj.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_nln_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_factor.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/m_spc_id.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.in
 - change in chemistry mechanism results in new preprocessor generated
   source files, many of which are just change in format
 - molecular masses are more presice with updated preprocessor
 - added M to reactions:
       MPAN + OH 
       HCN + OH

M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.in
 - added M to reactions:
       MPAN + OH 
       HCN + OH

M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lu_solve.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_imp_sol.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mods.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_prod_loss.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lin_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/m_rxt_id.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_phtadj.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_nln_matrix.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lu_factor.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/m_spc_id.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mech.in
 - change in chemistry mechanism results in new preprocessor generated
   source files, many of which are just change in format
 - molecular masses are more presice with updated preprocessor
 - added M to reactions:
       MPAN + OH 
       HCN + OH (and added .5*CO2 + M products)

M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.in
 - added M to reactions:
       MPAN + OH 
       HCN + OH

M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_setrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_adjrxt.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_rxt_rates_conv.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_sim_dat.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_indprd.F90
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.doc
M     models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.in
 - added M to reactions:
       MPAN + OH 
       HCN + OH (and added .5*CO2 + M products)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  

050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Thu Mar 22 04:17:54 MDT 2012
 - Change in MEGAN emissions of isoprene using mapped factors

045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Mar 22 04:17:31 MDT 2012
052 bl415 TBL.sh fst1.9c5dh outfrq3s 9s ...................................FAIL! rc= 7 at Thu Mar 22 04:19:06 MDT 2012
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Mar 22 04:20:07 MDT 2012
057 bl440 TBL.sh fsoa1.9c4dh outfrq3s 9s ..................................FAIL! rc= 7 at Thu Mar 22 04:20:58 MDT 2012
 - All these failures are due to change in chemitry mechanism and emissions

076 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 7 at Thu Mar 22 06:22:27 MDT 2012
 - As in previous tag, problems with clm namelist variable being changed from fatmgrid to fatmlndfrc

edinburgh/lf95: All pass

edinburgh/pgi: 

056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 7 at Wed Mar 21 23:47:35 MDT 2012
 - Change in emissions inputs caused this baseline failure for trop_mam7 chemistry

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_24 
Originator(s): fischer, edwards, eaton, neale, mvertens
Date: Mar 16, 2012
One-line Summary: CAM template update, namelist updates for homme, minor bug fixes 

Purpose of changes:

.  Bring in cam.cpl7.template updates from a branch tag

.  Update namelist option for homme.
   Updated soil_erod for the default and homme 
   cldfrc_permit is now being set for homme 
   Added ne30 and ne120 ncdata files

.  Add a CAM5 ne30_g16 CESM homme dycore test.  

. Fix memory leak in stratiform.F90.  When use_shfrc is false,
  then shfrc is allocated, but never deallocated.  Allocate was
  replaced with a pointer to a local variable.

. Fixes to testing scripts for hopper and titan/jaguar
  Wrong number of processors per node.

. Fix regular expression for parsing string values in Namelist.pm

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
M       models/atm/cam/bld/configure
. Change how SPMD is set

M       models/atm/cam/bld/perl5lib/Build/Namelist.pm
. Fix regular expression for parsing string values in Namelist.pm

A       models/atm/cam/bld/user_nl_cam
.  Empty user_nl_cam file that is used by new cam.cpl7.template

M       models/atm/cam/bld/cam.cpl7.template
.  Updated cam.cpl7.template

Describe any changes made to the namelist:
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. Update to newer soil_erod
     Default file was updated, this produces answer changes
     Add filenames for ne30, ne60, ne120, and ne240, this produces answer changes for homme
. cldfrc_permit being set for homme instead of default being used
. New ncdata added for ne30, ne120.  Still need and ne60 ic.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/tests_pretag_bluefire
M       models/atm/cam/test/system/input_tests_master
.  Add a CESM ne30 CAM5 test

M       models/atm/cam/test/system/TCB_ccsm.sh
.  Fix to work with latest cam.cpl7.template

M       models/atm/cam/test/system/CAM_runcmnd.sh
.  Set number of processors per node to 16 for hopper and titan/jaguarpf

M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
.  Changed spelling of precipitatable to precipitable

M       models/atm/cam/src/physics/cam/stratiform.F90
.  Memory leak fix.

M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
.  Change 4 to 2 in a formatted write

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
076 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 7 at Thu Mar 15 22:40:00 MDT 2012
.  Problems with clm namelist variable being changed from fatmgrid to fatmlndfrc

082 bl993 TBL_ccsm.sh ne30_g16 FC5 2d .....................................FAIL! rc= 5 at Thu Mar 15 23:57:26 MDT 2012
. Expected, this is a new test


edinburgh/lf95: 
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Mar 15 23:08:11 MDT 2012
. Expected, updated soil_erod file


edinburgh/pgi: 
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Mar 15 17:48:37 MDT 2012
. Expected, updated soil_erod file
059 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Thu Mar 15 20:11:09 MDT 2012
062 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 7 at Thu Mar 15 21:50:02 MDT 2012
. Expected updated soil_erod file and cldfrc_permit being set for homme


Summarize any changes to answers, i.e.,

===============================================================
===============================================================

Tag name: cam5_1_23
Originator(s): Francis Vitt
Date: 12 Mar 2012
One-line Summary: Support for new CLM MEGAN VOC emissions

Purpose of changes:

 * New functionality for CLM MEGAN VOC emissions 
   - flexibility in specifying VOC emissions from MEGAN in CLM
 * New functionality for offline dyn driver
   - ability added to turn off surface feedbacks to climate 
     met_srf_feedback (default is false)
 * New functionality added for generating chem rate diagnostics
 * Revived broken trop_mam7 and super_fast_llnl_mam3 chem packages
 * Added new chem packages :
   - trop_mozart_mam3
   - trop_mozart_soa
   - trop_strat_mam3
 * Added ability to support chemistry species names up to 16 characters
 * Maximum length for history increased to 24 characters
 * Fixed bug in physics_buffer
 * Fixed path issues in chem perl build modules for CESM scripts
 * Chemistry preprocessor changes :
   - supports chem species names up to 16 chars
   - remove references to het specifications -- all species can have wet removal
   - carbon mass of species output
   - calculates molecular masses using double precision to get consistent masses wrt invoking 
     the preprocessor on different platforms and compilers
   - new functionality for generating chem rate diagnostics
 * Switched on TMS for SC and SD WACCM
 * Misc cleanup in chemistry routines

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

   Namelist group megan_emis_nl has been added to file drv_flds_in
	
   Namelist variables:
     megan_specifier, megan_mapped_emisfctrs, megan_factors_file
  
   megan_specifier is a series of strings where each string contains one 
    CAM chemistry constituent name (left of = sign) and one or more MEGAN 
    compounds (seperated by + sign if more than one).  The specification of 
    the MEGAN compounds to the right of the = signs tells the MEGAN VOC 
    model within CLM how to construct the VOC fluxes using the factors in 
    megan_factors_file and land surface state.
  
   megan_factors_file read by CLM contains valid MEGAN compound names,
    MEGAN class groupings and scalar emission factors
   
   megan_mapped_emisfctrs switch is used to tell the MEGAN model to use 
    mapped emission factors read in from the CLM surface data input file
    rather than the scalar factors from megan_factors_file
  
   Example:
   &megan_emis_nl
    megan_specifier = 'ISOP = isoprene',
       'C10H16 = myrcene + sabinene + limonene + carene_3 + ocimene_t_b + pinene_b + ...',
       'CH3OH = methanol',
       'C2H5OH = ethanol',
       'CH2O = formaldehyde',
       'CH3CHO = acetaldehyde',
   ...
    megan_factors_file = '$datapath/megan_emis_factors.nc'
   /
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D       models/atm/cam/src/chemistry/modal_aero/mo_sethet.F90
 - this separate version is no longer needed and is removed

D       models/atm/cam/src/chemistry/pp_waccm_mozart/m_het_id.F90
D       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/m_het_id.F90
D       models/atm/cam/src/chemistry/pp_trop_mozart/m_het_id.F90
D       models/atm/cam/src/chemistry/pp_super_fast_llnl/m_het_id.F90
D       models/atm/cam/src/chemistry/pp_trop_mam3/m_het_id.F90
D       models/atm/cam/src/chemistry/pp_trop_mam7/m_het_id.F90
D       models/atm/cam/src/chemistry/pp_trop_ghg/m_het_id.F90
 - these are no longer used and are removed

List all subroutines added and what they do:
	
A       models/atm/cam/src/chemistry/mozart/rate_diags.F90
A       models/atm/cam/src/chemistry/pp_waccm_mozart/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_none/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_mam3/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_bam/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_mam7/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_ghg/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_waccm_ghg/mo_rxt_rates_conv.F90
 - these are added to give the user the ability to output reaction rates to history
	
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_lu_solve.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_setrxt.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_adjrxt.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_imp_sol.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mods.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_prod_loss.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_lin_matrix.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/m_rxt_id.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_phtadj.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_nln_matrix.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_lu_factor.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_sim_dat.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/mo_indprd.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/m_spc_id.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.doc
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3/chem_mech.in
A       models/atm/cam/src/chemistry/pp_trop_mozart_mam3
 - new chemistry package added

A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_lu_solve.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_setrxt.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_adjrxt.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_imp_sol.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mods.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_prod_loss.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_lin_matrix.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/m_rxt_id.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_phtadj.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_nln_matrix.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_lu_factor.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_sim_dat.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/mo_indprd.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/m_spc_id.F90
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.doc
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa/chem_mech.in
A       models/atm/cam/src/chemistry/pp_trop_mozart_soa
 - new chemistry package added

A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lu_solve.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_setrxt.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_adjrxt.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_rxt_rates_conv.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_imp_sol.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mods.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_prod_loss.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lin_matrix.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/m_rxt_id.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_phtadj.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_nln_matrix.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_lu_factor.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_sim_dat.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/mo_indprd.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/m_spc_id.F90
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.doc
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3/chem_mech.in
A       models/atm/cam/src/chemistry/pp_trop_strat_mam3
 - new chemistry package added

A       models/atm/cam/test/system/config_files/fsoa1.9c4dh
A       models/atm/cam/test/system/config_files/fm1.9c5dh
A       models/atm/cam/test/system/config_files/fst1.9c4dh
A       models/atm/cam/test/system/config_files/f7mode4c5dm
A       models/atm/cam/test/system/config_files/fsm4c5dm
A       models/atm/cam/test/system/config_files/fst1.9c5dh
 - new tests added

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/tests_pretag_bluefire
M       models/atm/cam/test/system/test_driver.sh
M       models/atm/cam/test/system/tests_pretag_edinburgh_pgi
M       models/atm/cam/test/system/input_tests_master
 - new tests added

M       models/atm/cam/bld/config_files/definition.xml
M       models/atm/cam/bld/configure
 - new chem pkgs listed above
 - clm_vocsrc congifure option removed (now run-time specification)
 - removed DUST and PROGSSLT cppdefs which are no longer used
 - corrected setting of chem_proc_src and chem_proc_src paths for CESM scripts
 - added NO__MPIMOD and NO_SIZEOF cppdefs for use of new PIO on edinburgh

M       models/atm/cam/bld/Makefile.in
 - use NO_MPIMOD and NO_MPI2 when _MPISERIAL is used 
 - fixed LDFLAGS for lahey so that we can build on systems that do have the ../lf6481/lib64 path
   the "-Wl,-rpath ..." flags do not seem to be needed

M       models/atm/cam/bld/build-namelist
 - removed the flds_voc namelist var (now handled in drv_flds_in namelist file)
 - removed reference to the clm_vocsrc config setting (no longer applies)
   the MEGAN VOC specifications should be done via build-namelist use cases
   or user_nl_cam
 - the set_dep_list perl routine needs chem_proc_src path to get correct species lists when
   the chem preprocessor is invoked.
 - added code for 7-mode modal aerosols
 - mods for trop_mozart_mam3, trop_mozart_soa, trop_strat_mam3
 - corrections to trop_mam7 settings
 - include megan_emis_nl (for MEGAN VOC emissions from CLM) in comp_gruops

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - added defaults for new chemistry pkgs
 - 7-mode mam phys props and optics files -- some of these defaults are not correct
 - defaults added for trop_mam7 emissions files
 - set drydep_method to xactive_atm for super_fast_llnl_mam3 and mozart_mam3 chem pckgs
 - set dust_emis_fact to 0.35 for all cam5 configurations regardless of chemistry
 - default megan factors file

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
 - moved met namelist opts for offline dyn driver from cam_inparm to metdata_nl
 - added new options for offline dyn driver
 - made fexcl, fincl and fwrtpr namelist type specifications consistent with array declarations in runtime_opts
 - added namelist vars for specification of CLM MEGAN VOC emissions
 - removed "flds_voc" namelist var
 - for cplflds_custom namlist var seq_cplflds_inparm -> seq_cplflds_userspec
   to support latest driver

M       models/atm/cam/bld/namelist_files/master_gas_wetdep_list.xml
M       models/atm/cam/bld/namelist_files/master_aer_wetdep_list.xml
M       models/atm/cam/bld/namelist_files/master_drydep_list.xml
 - added species for new trop_mozart_soa chem

M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_geos5.xml
 - switched on TMS
 - new wasolar forcing file which does not include 29 Feb 2100

M       models/atm/cam/bld/namelist_files/use_cases/waccmx_2000_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1955-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp26.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp85.xml
 - new wasolar forcing file which does not include 29 Feb 2100

M       models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
M       models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
M       models/atm/cam/bld/namelist_files/use_cases/2000_cam4_super_fast_llnl.xml
 - added megan specifer namelist

M       models/atm/cam/bld/perl5lib/Build/ChemNamelist.pm
M       models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - fixed a bug set_dep_lists which occurs when the chem preprocessor is used
 - fixed chem_src_dir and chem_proc_src paths problem for CESM scripts
 - removed setting DUST and PROGSSLT cppdefs

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - updates to chemistry preprocessor
   - supports chem species names upto 16 chars
   - remove references to het specifications -- all species can have wet removal
   - carbon mass of species output
   - calc molecular masses using double precision to get consistent masses wrt invoking 
     the preprocessor on different platforms and compilers
   - new functionality for generating chem rate diagnostics

M       models/atm/cam/src/control/runtime_opts.F90
 - use history fieldname_len declared in cam_history_support for consistency
 - moved met namelist opts for offline dyn driver from cam_inparm to metdata_nl in metdata.F90
M       models/atm/cam/src/control/cam_history_support.F90
 - increased fieldname_len to support longer constituent names

M       models/atm/cam/src/control/cam_comp.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
 - moved invocation of offline dyn driver get_met subroutines to physpkg level

M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
M       models/atm/cam/src/cpl_share/cam_cpl_indices.F90
M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
 - changes for new MEGAN VOC surface fluxes

M       models/atm/cam/src/physics/cam/microp_aero.F90
 - changes to be able to run 7 mode version of MAM
 - prog_modal_aero needs to be true for super_fast_llnl_mam3 and mozart_mam3


M       models/atm/cam/src/physics/cam/phys_control.F90
 - need to suppor longer chempkg names
 - prog_modal_aero logical added

M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
 - include hist fields for trop_mam7

M       models/atm/cam/src/physics/cam/ndrop.F90
 - get prog_modal_aero logical from phys_getopts

M       models/atm/cam/src/physics/cam/physics_buffer.F90
M       models/atm/cam/src/physics/cam/physics_buffer.F90.in
 - changes to support more diminsions physics buffer arrays

M       models/atm/cam/src/physics/cam/constituent_burden.F90
 - increase burdennam length for longer constituent names

M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
M       models/atm/cam/src/physics/waccmx/majorsp_diffusion.F90
 - waccmx corrections from 1.0.4 release version

M       models/atm/cam/src/chemistry/utils/modal_aero_deposition.F90
 - changes needed to run trop_mam7

M       models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
 - format change for readability

M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
 - set prog_modal_aero logical from phys_getopts

M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - changes needed to have modal aerosol with mozart chemistry
 - removal of the obsolete hetcnt reference

M       models/atm/cam/src/chemistry/mozart/mo_tracname.F90
 - increased species name length (up to 16 chars)

M       models/atm/cam/src/chemistry/mozart/mo_exp_sol.F90
 - removal of the obsolete hetcnt reference

M       models/atm/cam/src/chemistry/mozart/mo_cph.F90
 - reaction tag names changed for the waccm chemical potential heating reactions

M       models/atm/cam/src/chemistry/mozart/mo_chemini.F90
 - pass pbuf pointer into sao_inti

M       models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
 - removed assumption made about the indexing of modal aerosols
 - removal of the obsolete hetcnt reference 

M       models/atm/cam/src/chemistry/mozart/chemistry.F90
 - prog_modal_aero needs to be true for super_fast_llnl_mam3 and mozart_mam3
 - increase chem_name
 - chem_reset_fluxes subroutine added to initialize chem srf emissions each time set 
   including MEGAN emissions from CLM
 - soa_register added

M       models/atm/cam/src/chemistry/mozart/mo_drydep.F90
 - dry dep added for new SOA species
 - allocate and initialize fraction_landuse array for modal aerosol dry dep

M       models/atm/cam/src/chemistry/mozart/mo_sethet.F90
 - changes needed for new chem pkgs (SOA)
 - merged in modal version here
 - removal of the obsolete hetcnt reference 


M       models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - change tag names of waccm ion reactions
 - incorporate modal aerosols

M       models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
 - changes needed for new SOA chem pkg


M       models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
 - removed the assumption of which species has emissions set elsewhere
   -- now simply added what is specified in file to the surf fluxes
 - does not set surf fluxes to zero
 - cleaned up the MODAL ifdefs

M       models/atm/cam/src/physics/cam/radheat.F90
M       models/atm/cam/src/dynamics/fv/dyn_comp.F90
M       models/atm/cam/src/dynamics/fv/metdata.F90
 - changes for offline dyn driver new feature

M       SVN_EXTERNAL_DIRECTORIES
 - update driver to drvseq4_1_04 for MEGAN
 - update clm to megan05_clm4_0_40 for MEGAN
 - update pio to pio1_4_2 to support more dimensions in physics buffer
 - scripts updated to scripts4_120307 to support new pio
 - machines updated to Machines_120307 to support new pio

M       models/atm/cam/src/chemistry/pp_waccm_mozart/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/m_rxt_id.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.doc
M       models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.in
 - change in cph tag names
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/m_rxt_id.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.doc
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.in
 - change in cph tag names
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_trop_mozart/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_mozart/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_trop_mozart/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_mozart/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_none/chemistry.F90
A       models/atm/cam/src/chemistry/pp_none/mo_rxt_rates_conv.F90
M       models/atm/cam/src/chemistry/pp_none/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_none/chem_mods.F90
A       models/atm/cam/src/chemistry/pp_none/chem_mech.in
M       models/atm/cam/src/chemistry/pp_none/mo_lin_matrix.F90
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_trop_mam3/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_mam3/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_trop_mam3/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_mam3/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_trop_mam3/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

D       models/atm/cam/src/chemistry/pp_trop_bam/m_het_id.F90
A       models/atm/cam/src/chemistry/pp_trop_bam/mo_rxt_rates_conv.F90
M       models/atm/cam/src/chemistry/pp_trop_bam/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_bam/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_trop_bam/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_bam/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_trop_bam/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_trop_mam7/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_mam7/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_trop_mam7/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_mam7/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_trop_mam7/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

D       models/atm/cam/src/chemistry/pp_trop_ghg/m_het_id.F90
A       models/atm/cam/src/chemistry/pp_trop_ghg/mo_rxt_rates_conv.F90
M       models/atm/cam/src/chemistry/pp_trop_ghg/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_ghg/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_trop_ghg/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_ghg/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_trop_ghg/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history

M       models/atm/cam/src/chemistry/pp_waccm_ghg/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_waccm_ghg/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_waccm_ghg/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mech.doc
 - cleanup
 - added capability to write reaction rates to history


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  

050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Mon Mar 12 02:13:11 MDT 2012
 srf emis for ISOP has changed (new MEGAN emis) thus this is expected to fail

052 bl415 TBL.sh fst1.9c5dh outfrq3s 9s ...................................FAIL! rc= 5 at Mon Mar 12 02:13:12 MDT 2012
054 bl430 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 5 at Mon Mar 12 02:13:12 MDT 2012
057 bl440 TBL.sh fsoa1.9c4dh outfrq3s 9s ..................................FAIL! rc= 5 at Mon Mar 12 02:13:13 MDT 2012
 these baseline tests for new chem pckgs are expected to fail 

076 eq991 TEQ_ccsm.sh f19_f19 F f1.9c4m fcase 2d ..........................FAIL! rc= 7 at Mon Mar 12 03:13:02 MDT 2012
079 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Mon Mar 12 03:40:51 MDT 2012
 these failures are do to update to CLM which caused namelist inconsistencies

edinburgh/lf95: 

035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Mar 12 06:26:41 MDT 2012
 expected to fail due to TMS switch on
	
edinburgh/pgi: 
 
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Sun Mar 11 20:43:34 MDT 2012
 expected to fail due to TMS switch on

056 bl420 TBL.sh f7mode4c5dm outfrq3s 9s ..................................FAIL! rc= 5 at Sun Mar 11 22:31:14 MDT 2012
 new test expected to fail
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_22 
Originator(s):  fischer
Date: 2-28-2012
One-line Summary: Fixes for cam template

Purpose of changes:

.  cam.cpl7.template has two bug fixes in it, this only affects
   running with the cesm scripts
    - Incorrect number of tasks was being sent to build-namelist
      when mutliple instances of cam is running.
    - drv_flds_in needed to be copied to the cesm run directory.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/cam.cpl7.template
.  diveded ntasks my the number of atm instances
.  copy drv_flds_in from Buildconf/camconf to the run directory


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  

edinburgh/lf95: 

edinburgh/pgi or jaguar/pgi: 

Summarize any changes to answers: all bfb

===============================================================
===============================================================

Tag name: cam5_1_21 
Originator(s): fischer, eaton, mvertens
Date: Feb 23 07:50:11 MST 2012
One-line Summary: namelist changes, CAM5 RCP and homme fixes, COSP restart

Purpose of changes:
.  Namelist changes to support user_nl_comp and preview_namelist scripts
   changes in cesm.
.  Bug fix for old formatted fields in rad_diag for CAM5 RCP use_cases
.  Fixes to get CAM5 homme with chemistry working out of box
.  Fix added so COSP branch runs will work when using restart files from
   a non COSP run.

Bugs fixed (include bugzilla ID):


Describe any changes made to build system:
M       cam/bld/configure
. Removed -DSPMD for cesm 

M       cam/bld/build-namelist
. Fixes so aerosol deposition datasets aren't added to the namelist
  when running in aqua planet.
. Removed $pathname = strip_rootdir... so cesm user_nl_comp and 
  preview_namelist work correctly

M       cam/bld/cam.cpl7.template
.  Changes so cesm user_nl_comp and preview_namelist work correctly.
.  -DSMPD is set here

M       models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
.  $CODEROOT dir needed to be resolved for cesm runs

Describe any changes made to the namelist:
M       cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp60.xml
M       cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp26.xml
M       cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp45.xml
M       cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp85.xml
.  Fields in rad_diag needed to be updated to the new format


M       cam/bld/namelist_files/namelist_defaults_cam.xml
.  drydep_srf_file fix for homme/cam5
M       cam/bld/namelist_files/namelist_definition.xml
.  Path for drydep_srf_file was not resolving because input_pathname wasn't being set.



List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

A       cam/test/system/config_files/s64c5dh
A       cam/test/system/config_files/s64adh
A       cam/test/system/config_files/s64idh
A       cam/test/system/config_files/s64c5paqdh
.  config files needed for s64 tests

A       cam/test/system/config_files/h16c5aqdm
M       cam/test/system/tests_pretag_edinburgh_pgi
M       cam/test/system/input_tests_master
. Add new homme test with chemistry

M       models/atm/cam/test/system/nl_files/user_nl_cam
M       models/atm/cam/test/system/TCB_ccsm.sh
.  Changes so cesm user_nl_comp and preview_namelist work in testing.

M       models/atm/cam/src/physics/cam/restart_physics.F90
.  Added test for cossp_cnt_init, if missing then cosp_cnt_init is set to 0.
   This allows a COSP branch run from run that didn't have COSP turned on.

M       SVN_EXTERNAL_DIRECTORIES
. update tags for cesm user_nl_comp and preview_namelist.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all passed

edinburgh/lf95:  all passed

edinburgh/pgi or jaguar/pgi: 
059 bl735 TBL.sh h16c5aqdm outfrq3s+aquaplanet_cam5 9s ....................FAIL! rc= 5 at Wed Feb 22 15:08:45 MST 2012
   expected, new test


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bfb

===============================================================
===============================================================

Tag name: cam5_1_20 
Originator(s): fischer, eaton, craig, mvertens, edwards
Date: Feb 7, 2012
One-line Summary: coupler fields and esmf interface updates, remove csim4

Purpose of changes:

. Update ESMF interfaces for ESMF ver 5.2.0, and update coupler filed names.
  Merged with branch_tags/e52r_tags/e52r02_newcplflds03_cam5_1_16

. Remove csim4

. merge pbuf changes from branch_tags/spcam_cam5_1_17_tags/spcam01_cam5_1_17

. Update svn externals 

. Add r8 tests for dynamics/homme, skip dynamics/homme/share

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
M       models/atm/cam/bld/config_files/definition.xml
.  remove csim4

M       models/atm/cam/bld/configure
.  Refactor configure to have just one method for writing the Filepath file
.  csim4 removed

Describe any changes made to the namelist:
M       models/atm/cam/bld/build-namelist
.  add seq_cplflds_inparm group to the driver namelist file
.  set flds_voc       = .false.
       flds_co2a      = .true.
       flds_co2b      = .false.
       flds_co2c      = .false.
       flds_co2_dmsa  = .false.
       cplflds_inparm = ""
.  set do_rtm to false in the clm namelist file

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
.  add flds_voc, flds_co2a, flds_co2b, flds_co2c, flds_co2_dmsa,
   cplflds_inparm to the driver namelist file (drv_in)
. add do_rtm so river run off can be turned off in the clm namelist file

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:
D       models/atm/cam/src/utils/cam_csim4
.  Removed csim4

D    models/atm/cam/src/physics/cam/advnce.F90
.  merge in pbuf changes from branch_tags/spcam_cam5_1_17_tags/spcam01_cam5_1_17

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/input_tests_master
.  Add s64 tests
.  e48c5m test removed

M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/phys_debug.F90
M       models/atm/cam/src/physics/cam/eddy_diff.F90
M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M       models/atm/cam/src/chemistry/mozart/chemistry.F90
.  merge in pbuf changes from branch_tags/spcam_cam5_1_17_tags/spcam01_cam5_1_17

M       models/atm/cam/test/system/config_files/f10c3dm
.  replace csim4 with cice

M       models/atm/cam/test/system/tests_posttag_bluefire
.  remove s32 tests, add s64 tests

M       models/atm/cam/test/system/TR8.sh
.    Add R8 test from dynamics/homme, skip dynamics/homme/share 

M       models/atm/cam/test/system/tests_pretag_edinburgh_lahey
M       models/atm/cam/test/system/tests_pretag_edinburgh_pgi
.  Move r8 test from lahey test list to pgi test list
.  Add f10c3dm test for pgi

M       models/atm/cam/src/dynamics/homme/nctopo_util_mod.F90
.  fixed end module statement for the R8 test

M       models/atm/cam/src/dynamics/homme/dyn_grid.F90
M       models/atm/cam/src/dynamics/homme/native_mapping.F90
M       models/atm/cam/src/dynamics/homme/inidat.F90
M       models/atm/cam/src/dynamics/homme/stepon.F90
.  insterted missing _r8s.

M       models/atm/cam/bld/cam.cpl7.template
.  USE_MPISERIAL test changed to MPILIB == 'mpi-serial'
.  extra echo removed

M       models/atm/cam/src/cpl_share/cam_cpl_indices.F90
M       models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
.  couple field name changes

M       models/atm/cam/src/utils/time_manager.F90
M       models/atm/cam/src/utils/cam_dom/ocn_time_manager.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_mct.F90
.  ESMF interface update to 5.2.0


M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
.  couple field name changes
.  ESMF interface update to 5.2.0

M       models/atm/cam/src/utils/cam_dom/cpl_mct/ocn_comp_mct.F90
M       models/atm/cam/src/utils/cam_aqua/cpl_mct/ocn_comp_mct.F90
.  New fields are being passed to ocn_final_mct from the coupler.

M       models/atm/cam/src/physics/cam/convect_shallow.F90
.  Bug fix for 6 outfld calls that declared the 1st dimension of the
   output array to be size pcols, but then passed an array section of
   dimensioned ncol.


M       SVN_EXTERNAL_DIRECTORIES
.  Update externals


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   
063 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 7 at Thu Feb  2 16:12:20 MST 2012
066 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Thu Feb  2 16:12:53 MST 2012
  expected dynamics/homme missing r8s inserted


edinburgh/lf95: all passed 


edinburgh/pgi: 
039 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Tue Jan 31 17:40:58 MST 2012
  csim4 replaced with cice

056 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Tue Jan 31 19:11:09 MST 2012
  expected dynamics/homme missing r8s inserted



CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers:
  HOMME will have answer changes due to missing r8s being insterted in
  /dynamics/homme, and not the share directory
  CSIM4 replace with CICE in tests caused answer changes.


===============================================================
===============================================================

Tag name: cam5_1_19
Originator(s): Jim Edwards, Jen Kay
Date: 01-20-2012
One-line Summary: Intel compiler port, Make restarts double, COSP bug fix

Purpose of changes:  Intel compiler port, Make restarts double, COSP bug fix

Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: 

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:  Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
         models/atm/cam/test/system/test_driver.sh   
	     Adjusted modules used on lynx
	 models/atm/cam/test/system/tests_pretag_edinburgh_pgi
	 models/atm/cam/test/system/input_tests_master       
	     Added a test 321 for cosp atrain
	 models/atm/cam/src/control/cam_history.F90  
	     Make sure that restart files are always douple precision
	 models/atm/cam/src/physics/cam/cldwat2m_macro.F90   
	 models/atm/cam/src/physics/cam/uwshcu.F90   
	 models/atm/cam/src/physics/cam/vertical_diffusion.F90       
	 models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90 
              An assumption was made about the location of cldliq and cldice fields
	      in the constituents array.   This assumption was incorrect and was removed.
	 models/atm/cam/src/physics/cam/cospsimulator_intr.F90       
	      1) addition of allocate statement circa line 526. 
              2) match atrain file longitude range to model
	 models/atm/cam/src/dynamics/eul/inidat.F90  
	 models/atm/cam/src/dynamics/eul/prognostics.F90     
	 models/atm/cam/src/dynamics/eul/stepon.F90  
              Change subroutine calls so that intel compiler doesn't complain when endlat<beglat

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All Pass

edinburgh/lf95: All pass

edinburgh/pgi : All pass except bl321  (no baseline for comparison)

lynx/intel: Tested using tests_pretag_jaguarpf_pgi test list, skipped Baselines - all pass	


===============================================================
===============================================================

Tag name: cam5_1_18
Originator(s): Francis Vitt
Date: 13 Jan 2012
One-line Summary: Enable WACCM to use cam5 physics and bug fixes

Purpose of changes:
  To enable the following configurations: 
    - RRTMG radiation with cam4 physics
    - WACCM with cam5 physics and RRTMG radiation
  Fix mass conservation bug in molecular diffusion used in 
  WACCM and WACCMX

Bugs fixed (include bugzilla ID):
 - mass conservation in molecular diffision 
 - external forcings inputs which are on pressure levels

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D    models/atm/cam/src/physics/cam/param_cldoptics.F90
 - this is merged into cloud_diagnostics.F90 to avoid duplicate code
	
D    models/atm/cam/src/physics/cam/cldsav.F90
 - this subroutine is moved into cloud_cover_diags module
	
D    models/atm/cam/src/physics/rrtmg/cloud_diagnostics.F90
 - this is moved to physics/cam to eliminate the stub version
	
D    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_photo.F90
 - the chemistry/mozart version gives the same result, so this version 
   is no longer needed
	
List all subroutines added and what they do:

A    models/atm/cam/src/physics/cam/cloud_cover_diags.F90
 - this packages the cloud cover diagnostics and is used by both camrt and rrtmg

A    models/atm/cam/src/physics/rrtmg/rrtmg_state.F90
 - this manages the state layers that are passed into rrtmg rad

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/test/system/test_driver.sh
M    models/atm/cam/test/system/CAM_runcmnd.sh
 - changes for edinburgh

M    models/atm/cam/bld/configure
 - changes to allow cam4 physics to be configured with rrtmg radiation 
 - a correction to chem source paths in Filepath

M    models/atm/cam/bld/Makefile.in
 - new LDFLAGS added for edinburgh compilers (lahey and pgi)

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - slingo and ebertcurry default setting for rrtmg with RK microphys
	
M    models/atm/cam/bld/namelist_files/namelist_definition.xml
 - vertical diffusion control options added

M    models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - changes to select suitable fortran compiler for the preprocessor more robustly
	
M    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - update to chem preprocessor -- change how compiler is specified
 - update to rrtmg external -- removed adding extra layer to top of model

M    models/atm/cam/src/control/runtime_opts.F90
 - read namelist call added for vertical diffusion controls

M    models/atm/cam/src/physics/cam/molec_diff.F90
 - changes from Mike Mills to fix mass conservation bug

M    models/atm/cam/src/physics/cam/cloud_fraction.F90
M    models/atm/cam/src/physics/cam/micro_mg.F90
M    models/atm/cam/src/physics/cam/microp_aero.F90
M    models/atm/cam/src/physics/cam/ndrop_bam.F90
M    models/atm/cam/src/physics/cam/micro_mg_cam.F90
M    models/atm/cam/src/physics/cam/cldwat2m_macro.F90
 - specify top level where MG micro physics is applied

M    models/atm/cam/src/physics/cam/cloud_diagnostics.F90
 - cloud radiation diagnostics for both camrt and rrtmg rad

M    models/atm/cam/src/physics/cam/radiation.F90
 - cloud cover diagnostics moved to cloud_cover_diags module
 - cloud optics parameters now obtained from physics buffer
   which are now calculated in cloud_diagnostics (in one place)

M    models/atm/cam/src/physics/cam/phys_control.F90
 - tropospheric cloud top level parameter added

M    models/atm/cam/src/physics/cam/stratiform.F90
 - removed many pbuf_add_field calls that are not needed here

M    models/atm/cam/src/physics/cam/radlw.F90
M    models/atm/cam/src/physics/cam/radconstants.F90
 - long wave spectral band limts data added -- moved from radlw
 - get_lw_spectral_boundaries subroutine added
 
M    models/atm/cam/src/physics/cam/physpkg.F90
 - cloud_diagnostics_register call added

M    models/atm/cam/src/physics/cam/macrop_driver.F90
 - corrected indentation of one line

M    models/atm/cam/src/physics/cam/pkg_cldoptics.F90
 - code cleanup

M    models/atm/cam/src/physics/cam/vertical_diffusion.F90
 - controls added by C. Bardeen and M. Mills
 - code added to check mass conservation, whic is not active by default
	
M    models/atm/cam/src/physics/cam/eddy_diff.F90
 - controls added by C. Bardeen and M. Mills

M    models/atm/cam/src/physics/cam/cldwat.F90
M    models/atm/cam/src/physics/cam/uwshcu.F90
 - more endrun message changed to be more specific

M    models/atm/cam/src/physics/waccm/radheat.F90
 - changes for rrtmg merging

M    models/atm/cam/src/physics/rrtmg/radconstants.F90
 - long wave spectral band limts data added -- moved from radlw
 - get_lw_spectral_boundaries subroutine added

M    models/atm/cam/src/physics/rrtmg/ebert_curry.F90
 - set oldicewp to true.
 
M    models/atm/cam/src/physics/rrtmg/oldcloud.F90
 - removed some pbuf_get_index calls which are not needed

M    models/atm/cam/src/physics/rrtmg/radsw.F90
M    models/atm/cam/src/physics/rrtmg/radlw.F90
 - use rrtmg_state to specify state of atm for rrtmg rad 
 - moved long wave spectral band limts to radconstants
 - moved constituents units conversion to rrtmg_state where it is done for 
   both radlw and radsw

M    models/atm/cam/src/physics/rrtmg/radiation.F90
 - use rrtmg_state to specify state of atm for rrtmg rad 
 - changes to allow rrtmg to run with cam4 physics

M    models/atm/cam/src/physics/rrtmg/slingo.F90
 - set oldliqwp to true for slingo optics

M    models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
 - don't abort in init method if MG pbuf fields are not found to allow 
   rrtmg to run with RK microphys

M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sad.F90
 - diagnostics added by A Conley to be consistent with the chemistry/mozart version

M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_sim_dat.F90
 - molecular masses changed to be what the new preprocessor will generate
   these are changed now since the changes in molecular diffusion answer changing

M    models/atm/cam/src/chemistry/mozart/upper_bc.F90
 - ajusted top altitude check to 180 KM for waccm

M    models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
 - bug fix for external forcings inputs which are on pressure levels

M    models/atm/cam/src/chemistry/mozart/mo_sad.F90
 - science change from A Conley involving geometric mean radius 
   and the H2SO4 and H2O ratio of the stratospheric aerosols

M    models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
 - bottom level is now dictated by radheat module

M    models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - correction to "tagged" CO reactions

M    models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
 - added getfil call to hopefully clarify error messages when a specified 
   surface emissions file does not exist

M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - inquiry MAM pbuf indices moved back to this level to appease lahey
 - initialize reaction_rates to NAN in hopes to catch cases where rates do not get set

M    models/atm/cam/src/chemistry/mozart/chemistry.F90
 - inquiry MAM pbuf indices moved back to mo_gas_phase_chemdr to appease lahey
   in cases that MAM is not active

M    models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
 - explicitly declare pbuf_chnk for clarity

M    models/atm/cam/src/chemistry/utils/prescribed_aero.F90
M    models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
M    models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
M    models/atm/cam/src/chemistry/utils/aircraft_emit.F90
M    models/atm/cam/src/physics/cam/ghg_data.F90
M    models/atm/cam/src/dynamics/sld/dp_coupling.F90
M    models/atm/cam/src/dynamics/eul/dp_coupling.F90
M    models/atm/cam/src/dynamics/homme/dp_coupling.F90
M    models/atm/cam/src/dynamics/fv/dp_coupling.F90
 - made thread safe for PGI compiler by explicitly making pbuf_chnk private for the OMP loop

M    models/atm/cam/src/dynamics/sld/scanslt.F90
 - mpigatherv call switched to mpiallgatherv to avoid run failure
	
M    models/atm/cam/src/dynamics/sld/stepon.F90
 - correction to stepon_run1 argument list

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Thu Jan 12 19:04:32 MST 2012
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Thu Jan 12 19:07:01 MST 2012
 these WACCM baseline tests are expected to fail due to corrections in molecular diffusion

edinburgh/lf95:
 not able to run baseline tests due to system upgrades on edinburgh
 all other tests pass
	
hopper/pgi: 
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 12 19:46:17 PST 2012
 this baseline test is expected to fail due to corrections in molecular diffusion 
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_1_17
Originator(s): cacraig, jedwards, fischer
Date: Dec 21, 2011
One-line Summary: new physics buffer and  bug fixes

Purpose of changes:

- Implemented new physics buffer, this involves introduction of two new 
  modules - utils/buffer.F90.in and physics/cam/physics_buffer.F90.in
  buffer.F90.in introduces low level support for persistent arrays of types r8, r4, and i4 and
  up to 7 dimensions (the max allowed in fortran arrays).  These arrays are accessed and manipulated
  through a common (type independent) API.  
  physics_buffer.F90.in uses the low level buffer module and provides additional methods for physics.
  The physics buffer array is a derived type array declared in the cam_comp module with
  dimensions (pbufflds,begchunk:endchunk) within this structure arrays can be of type r8, r4, or i4 and
  always have first dimension pcols, all further dimensions are optional.    
  
- Moved the subroutines initindx, tphysac, and tphysbc into the physpkg
  module.  These routines are all part of the physics package driver.

- Fields from the buffer module were added to pbuf

Bugs fixed (include bugzilla ID):

- Added missing config file for waccmx tests
- Add missing coupler field Fioi_melth

Describe any changes made to build system: 

- change xlf90 to xlf95 in the AIX, Darwin, BGL, and BGP sections of the
  Makefile.in template

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: no difference

Code reviewed by: eaton, edwards

List all subroutines eliminated:

D       models/atm/cam/src/physics/cam/upper_bc.F90
           - Stubs not needed
D       models/atm/cam/src/physics/cam/uw_conv.F90
           - Module no longer used
D       models/atm/cam/src/physics/cam/initindx.F90
           - Moved into physpkg.F90 and renamed phys_register
D       models/atm/cam/src/physics/cam/tphysbc.F90
           - Moved into physpkg.F90
D       models/atm/cam/src/physics/cam/buffer.F90
           - Variables added to pbuf
D       models/atm/cam/src/physics/cam/phys_buffer.F90
           - Functionality replaced with the new module physics_buffer.F90
D       models/atm/cam/src/physics/cam/tphysac.F90
           - Moved into physpkg.F90

List all subroutines added and what they do:

A       models/atm/cam/test/system/config_files/wx1.9c4h
           - Added missing config file for waccmx tests
A  +    models/atm/cam/src/utils/dtypes.h
           - support routine used by genf90.pl (used in physics_buffer.F90)
A  +    models/atm/cam/src/utils/buffer.F90
A  +    models/atm/cam/src/utils/buffer.F90.in
           - Low level handler for F90 arrays.  The script genf90.pl is
             used to transform buffer.F90.in to buffer.F90
A  +    models/atm/cam/src/physics/cam/physics_buffer.F90
A  +    models/atm/cam/src/physics/cam/physics_buffer.F90.in
           - phys_buffer replacement.  Contains the new pbuf routines.
             The script genf90.pl is used to transform physics_buffer.F90.in
             to physics_buffer.F90


List all existing files that have been modified, and describe the changes:

M       models/atm/cam/src/utils/cam_csim4/cpl_mct/ice_comp_mct.F90
           - Add missing coupler field Fioi_melth

M       models/atm/cam/test/system/nl_files/outfrq3s
M       models/atm/cam/test/system/input_tests_master
M       models/atm/cam/bld/Makefile.in
M       models/atm/cam/doc/ChangeLog
M       models/atm/cam/src/control/runtime_opts.F90
M       models/atm/cam/src/control/startup_initialconds.F90
M       models/atm/cam/src/control/cam_restart.F90
M       models/atm/cam/src/control/cam_comp.F90
M       models/atm/cam/src/control/cam_history.F90
M       models/atm/cam/src/utils/cam_pio_utils.F90
M       models/atm/cam/src/physics/cam/cam3_aero_data.F90
M       models/atm/cam/src/physics/cam/molec_diff.F90
M       models/atm/cam/src/physics/cam/cloud_diagnostics.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/param_cldoptics.F90
M       models/atm/cam/src/physics/cam/radheat.F90
M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/cam/flux_avg.F90
M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
M       models/atm/cam/src/physics/cam/aer_rad_props.F90
M       models/atm/cam/src/physics/cam/check_energy.F90
M       models/atm/cam/src/physics/cam/restart_physics.F90
M       models/atm/cam/src/physics/cam/hk_conv.F90
M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
M       models/atm/cam/src/physics/cam/ghg_data.F90
M       models/atm/cam/src/physics/cam/radiation_data.F90
M       models/atm/cam/src/physics/cam/sslt_rebin.F90
M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
M       models/atm/cam/src/physics/cam/cloud_rad_props.F90
M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/cam3_ozone_data.F90
M       models/atm/cam/src/physics/cam/rad_constituents.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/cloud_fraction.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/convect_deep.F90
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
MM      models/atm/cam/src/physics/cam/microp_driver.F90
M       models/atm/cam/src/physics/cam/gw_drag.F90
M       models/atm/cam/src/physics/cam/iondrag.F90
M       models/atm/cam/src/physics/cam/phys_debug.F90
M       models/atm/cam/src/physics/cam/advnce.F90
M       models/atm/cam/src/physics/cam/conv_water.F90
M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
M       models/atm/cam/src/physics/cam/ionosphere.F90
M       models/atm/cam/src/physics/cam/eddy_diff.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
M       models/atm/cam/src/physics/waccmx/ionosphere.F90
M       models/atm/cam/src/physics/waccm/iondrag.F90
M       models/atm/cam/src/physics/waccm/nlte_lw.F90
M       models/atm/cam/src/physics/waccm/radheat.F90
M       models/atm/cam/src/physics/waccm/gw_drag.F90
M       models/atm/cam/src/physics/waccm/waccm_forcing.F90
M       models/atm/cam/src/physics/rrtmg/ebert_curry.F90
M       models/atm/cam/src/physics/rrtmg/oldcloud.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
M       models/atm/cam/src/physics/rrtmg/slingo.F90
M       models/atm/cam/src/physics/rrtmg/cloud_diagnostics.F90
M       models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_photo.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sad.F90
M       models/atm/cam/src/chemistry/pp_none/chemistry.F90
M       models/atm/cam/src/chemistry/utils/aerodep_flx.F90
M       models/atm/cam/src/chemistry/utils/prescribed_aero.F90
M       models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
M       models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
M       models/atm/cam/src/chemistry/utils/tracer_data.F90
M       models/atm/cam/src/chemistry/utils/aircraft_emit.F90
M       models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
M       models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M       models/atm/cam/src/chemistry/mozart/mo_setext.F90
M       models/atm/cam/src/chemistry/mozart/mo_tgcm_ubc.F90
M       models/atm/cam/src/chemistry/mozart/mo_lightning.F90
M       models/atm/cam/src/chemistry/mozart/clybry_fam.F90
M       models/atm/cam/src/chemistry/mozart/lin_strat_chem.F90
M       models/atm/cam/src/chemistry/mozart/upper_bc.F90
M       models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M       models/atm/cam/src/chemistry/mozart/mo_chemini.F90
M       models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
M       models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
M       models/atm/cam/src/chemistry/mozart/mo_aurora.F90
M       models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
M       models/atm/cam/src/chemistry/mozart/mo_sad.F90
M       models/atm/cam/src/chemistry/mozart/mo_setinv.F90
M       models/atm/cam/src/chemistry/mozart/chemistry.F90
M       models/atm/cam/src/chemistry/mozart/linoz_data.F90
M       models/atm/cam/src/chemistry/mozart/mo_photo.F90
M       models/atm/cam/src/chemistry/mozart/cfc11star.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_neu_wetdep.F90
M       models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
M       models/atm/cam/src/chemistry/mozart/mo_mass_xforms.F90
M       models/atm/cam/src/chemistry/mozart/short_lived_species.F90
M       models/atm/cam/src/chemistry/mozart/exbdrift.F90
M       models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
M       models/atm/cam/src/dynamics/sld/dp_coupling.F90
M       models/atm/cam/src/dynamics/sld/inidat.F90
M       models/atm/cam/src/dynamics/sld/stepon.F90
M       models/atm/cam/src/dynamics/eul/dp_coupling.F90
M       models/atm/cam/src/dynamics/eul/inidat.F90
M       models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90
M       models/atm/cam/src/dynamics/eul/iop.F90
M       models/atm/cam/src/dynamics/eul/stepon.F90
M       models/atm/cam/src/dynamics/homme/dp_coupling.F90
M       models/atm/cam/src/dynamics/homme/stepon.F90
M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
M       models/atm/cam/src/dynamics/fv/stepon.F90
          -  Changes required for the new pbuf routines

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all passed

edinburgh/lf95: no jobs run as edinburgh not back in full service (Brian 
okayed)

hopper/pgi:  all passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: None

===============================================================
===============================================================

Tag name: cam5_1_16 
Originator(s): fischer, jenkay, eaton
Date: Dec 8, 2011
One-line Summary: COSP updates, bug fixes, svn external update

Purpose of changes:

. COSP updates.  Included changes are:
  - made several high-level namelist variables that control COSP.
    The new options are all meant to reduce cost by running with fewer
    subcolumns (10) and by only running cosp every 3rd time the radiation is
    run.  The new variables are:
    cosp_amwg
    cosp_lite
    cosp_passive
    cosp_active
    cosp_isccp
  - change the default mode from cosp_runall to cosp_amwg.  Add cosp_runall
    to the namelist so this mode can still be specified.
  - changed default for cosp_histfile_num from '2' to '1'.
  - changed sub-column outputs to avoid crashes when you specify
    outputs as 'A' on a monthly history file.  The subcolumn output is only
    on by default when explicitly requested via setting either
    cosp_lfrac_out=.true. or cosp_runall=.true.
  - made COSP compatible with fincl1lonlat -- so that you can run
    COSP and save COSP outputs locally.  including your changes to
    cam_history.F90

.  get_memusage and print_memusage removed
.  updates svn externals to match cesm1_1_beta06
.  Updates to namelist for CAM5 RCP and CAM homme
.  Updates to testing
.  Remove the dependency of seq_fldx_indices
    drv tag no longer has a seq_fldx_indices module
.  Fix output bug for field EKGWSPEC in waccm gw_drag

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
. -132 flag was removed for intel compiler
.  The following new parameters are added to the 
   call to cice build namelist
        grid_type='latlon'
        grid_format='nc'
        stream_domtvarname='time'
        stream_domxvarname='lon'
        stream_domyvarname='lat'
        stream_domareaname='area'
        stream_dommaskname='mask'

Describe any changes made to the namelist:
.  New CAM5 RCP use cases were added
.  Add drydep_srf_file for CAM homme 
.  Add ncdata for CAM homme 30 level mam
.  remove 'QTHERMAL', 'QRS_AUR', 'QRS_CO2NIR', 'QRS_EUV' from
   use_cases/waccm_sc_2000_cam4.xml


List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:
D       models/atm/cam/src/control/get_memusage.c
D       models/atm/cam/src/control/print_memusage.F90

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/TR8.sh
.  add physics/waccmx directory for realkind test

M       models/atm/cam/test/system/tests_pretag_edinburgh_pgi
M       models/atm/cam/test/system/tests_pretag_edinburgh_lahey
.  sm315, er315, bl315 (f10c3dm) test removed

M       models/atm/cam/test/system/test_driver.sh
.  switch to pgi11.10.0 on lynx

M       models/atm/cam/bld/Makefile.in
.  remove -132 for intel compiler

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
.  add drydep_srf_file for CAM homme 
.  new ncdata for CAM homme 30 level mam

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
.  COSP updates

A       models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp60.xml
A       models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp26.xml
A       models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp45.xml
A       models/atm/cam/bld/namelist_files/use_cases/2006-2100_cam5_rcp85.xml
.  add new rcp cam5 use cases

M       models/atm/cam/bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
.  remove 'QTHERMAL', 'QRS_AUR', 'QRS_CO2NIR', 'QRS_EUV' 

M       models/atm/cam/bld/build-namelist
.  add new namelist options for cice build-namelist call
     grid_type='latlon'
     grid_format='nc'
     stream_domtvarname='time'
     stream_domxvarname='lon'
     stream_domyvarname='lat' 
     stream_domareaname='area' 
     stream_dommaskname='mask'

M       models/atm/cam/src/control/startup_initialconds.F90
M       models/atm/cam/src/control/cam_restart.F90
M       models/atm/cam/src/control/cam_comp.F90
M       models/atm/cam/src/physics/cam/phys_grid.F90
M       models/atm/cam/src/dynamics/sld/spetru.F90
M       models/atm/cam/src/dynamics/sld/stepon.F90
M       models/atm/cam/src/dynamics/eul/spetru.F90
M       models/atm/cam/src/dynamics/eul/stepon.F90
M       models/atm/cam/src/dynamics/fv/stepon.F90
.  removed call to print_memusage

M       models/atm/cam/src/control/cam_history.F90
.  COSP updates

M       models/atm/cam/src/utils/cam_dom/cpl_mct/ocn_comp_mct.F90
M       models/atm/cam/src/utils/cam_csim4/cpl_mct/ice_comp_mct.F90
M       models/atm/cam/src/utils/cam_aqua/cpl_mct/ocn_comp_mct.F90
.  removed use seq_fldx_indices
.  added calls to mct_avect_indexra to get indices

M       models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
.  replace use seq_flds_indices with use cam_cpl_indices

M       models/atm/cam/src/physics/cam/micro_mg.F90
.  initialize reff_rain and reff_snow to 0._r8

M       models/atm/cam/src/physics/cam/micro_mg_cam.F90
.  removed reff_rain and ref_snow = fillvalue
.  removed fillvalue from use

M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
.  add cosp_cnt_init for COSP restarts 

M       models/atm/cam/src/physics/cam/restart_physics.F90
.  add csop_cnt_init to restart files

M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
.  COSP updates 

M       models/atm/cam/src/physics/waccmx/ionosphere.F90
M       models/atm/cam/src/physics/waccmx/majorsp_diffusion.F90
.  add missing _r8

M       models/atm/cam/src/physics/waccm/gw_drag.F90
.  fixed output for field EKGWSPEC

M       SVN_EXTERNAL_DIRECTORIES
.  update externals to the cesm1_1_beta06 externals


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Thu Dec  8 10:12:42 MST 2011
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Thu Dec  8 13:19:40 MST 2011
                output for field EKGWSPEC was fixed causing different values

edinburgh/lf95: 
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Dec  5 10:13:21 MST 2011
                output for field EKGWSPEC was fixed causing different values
                test 42-45 weren't run since edinburgh went down for maintance for three days

hopper/pgi:  all passed, f10c3dm tests were removed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bfb except for waccm because of fix to EKGWSPEC
                                  also, waccmx not bfb due to _r8s

===============================================================
===============================================================

Tag name: cam5_1_15
Originator(s): liuh,joemci,fvitt,eaton
Date: Mon Nov 21 14:59:37 MST 2011
One-line Summary: Add in WACCM-X and fix WACCM bug

Purpose of changes:

. WACCM-X is the extension of the WACCM/CAM model from the lower thermosphere
  to the top of the thermosphere.  The neutral thermosphere physics are added
  here which involves modifications to a number of physics and chemistry 
  modules.  

  Later WACCM-X modifications will include ion transport and electrodynamics.

Bugs fixed (include bugzilla ID):

. Fixed a bug in the gw_drag module so that only molecular diffusion is 
  used instead of molecular and eddy diffusion in gravity wave drag 
  calculations

Describe any changes made to build system: 

. New configure option -waccmx added to turn on WACCM-X physics.  Also 
  added WACCMX cppdef and a WACCM-X physics directory to file paths.

. Added defaults xml file for WACCM-X configure defaults 

Describe any changes made to the namelist: 

. Namelist default variables set for WACCM-X with one new variable 
  waccmx_opt which is a run time flag to turn on WACCM-X physics 

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton, fvitt, fischer

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/iondrag.F90
models/atm/cam/src/physics/cam/ionosphere.F90
models/atm/cam/src/physics/cam/majorsp_diffusion.F90
. added as dummy interfaces for new WACCM-X physics modules/methods

models/atm/waccmx/src/physics/cam/ionosphere.F90
models/atm/waccmx/src/physics/cam/majorsp_diffusion.F90
. new WACCM-X physics modules

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/chemistry/mozart/chemistry.F90
. change to no fixed upper boundary for WACCM-X and add photo_register and
  aurora_register method calls

models/atm/cam/src/chemistry/mozart/mo_aurora.F90
. put ionization rates in pbuf

models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
. add pbuf to table_photo and setext interfaces

models/atm/cam/src/chemistry/mozart/mo_jeuv.F90
. add number of photo-ionization rates put in pbuf 

models/atm/cam/src/chemistry/mozart/mo_jshort.F90
. increas scale height for WACCM-X and set minimum value for cross-sections  

models/atm/cam/src/chemistry/mozart/mo_mean_mass.F90
. constituent dependent mean mass for WACCM-X  

models/atm/cam/src/chemistry/mozart/mo_photo.F90
. increase maximum zenith angle, add pbuf to table_photo interface and 
  add photo-ionization rates to pbuf  

models/atm/cam/src/chemistry/mozart/mo_setext.F90
. add pbuf to setext and aurora interfaces  

models/atm/cam/src/chemistry/mozart/mo_tgcm_ubc.F90
. add column dimension to mean mass array to allow dependence on 
  composition  

models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
. increase zenith angle and use constituent dependent mean mass and specific
  heat for WACCM-X 

models/atm/cam/src/chemistry/mozart/upper_bc.F90
. add upper boundary flux to ubc_get_vals interface, constituent 
  dependent mean mass to set_tgcm_ubc interface, and pbl height to 
  chem_timestep_tend interface
. calculate upper boundary flux and use constituent dependent gas constant in 
  upper boundary mixing ratio calculation 

models/atm/cam/src/chemistry/pp_none/chemistry.F90
. add pbl height to chem_timestep_tend interface

models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_jeuv.F90
. add number of photo-ionization rates put in pbuf to be compatible with mozart
  mo_jeuv

models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_photo.F90
. increase maximum zenith angle, add pbuf to table_photo interface to be 
  compatible with mozart mo_photo

models/atm/cam/src/control/physconst.F90
. add physconst_init and physconst_update methods

models/atm/cam/src/dynamics/eul/dp_coupling.F90
. add constituent dependent zvir and rair to geopotential_t method interface

models/atm/cam/src/dynamics/fv/dp_coupling.F90
. add constituent dependent zvir and rair to geopotential_t method interface and 
  call to physconst_update method

models/atm/cam/src/dynamics/homme/dp_coupling.F90
. add constituent dependent zvir and rair to geopotential_t method interface

models/atm/cam/src/dynamics/sld/dp_coupling.F90
. add constituent dependent zvir and rair to geopotential_t method interface

models/atm/cam/src/physics/cam/constituents.F90
. add fixed upper bondary flux and molecular diffusion type to cnst_add
  interface and add method to retrieve molecular diffusion type

models/atm/cam/src/physics/cam/diffusion_solver.F90
. add fixed upper boundary flux and molecular diffusion modifications to 
  compute_vdiff interface, add molecular conductivity calculation and apply to 
  temperature, and remove eddy diffusivity from molecular diffusion

models/atm/cam/src/physics/cam/eddy_diff.F90
. add fixed upper boundary flux and molecular diffusion modifications to 
  compute_vdiff interface

models/atm/cam/src/physics/cam/geopotential.F90
. add constituent dependency to geopotential calculations

models/atm/cam/src/physics/cam/initindx.F90
. add iondrag_register and ionos_register method calls for WACCM-X 

models/atm/cam/src/physics/cam/micro_mg_cam.F90
. removed use statement accessing pcnst since not used in module (bug with PGI)

models/atm/cam/src/physics/cam/molec_diff.F90
. add variables to interface of vd_lu_decomp and capability to solve for 
  temperature in addition to dry static energy
. add calculation of thermal diffusion coefficient, add upper boundary flux to 
  molecular compute_molec_diff, and add calculation of molecular conductivity

models/atm/cam/src/physics/cam/phys_control.F90
. add access to WACCM-X run time option and add phys_ctl_init method to set top
  and bottom levels for eddy and molecular diffusion operate and molecular
  diffusion switch.  Also add access to the these through phys_getopts method  

models/atm/cam/src/physics/cam/physics_types.F90
. set maximum values for H and H2 mixing ratios for WACCM-X, add call to 
  physconst_update method, add update of dry static energy, and add 
  constituent dependent variables to geopotential_dse call

models/atm/cam/src/physics/cam/physpkg.F90
. add calls to physconst_init, phys_ctl_init, mspd_init, and ionos_init methods

models/atm/cam/src/physics/cam/tphysac.F90
. access molecular viscosity from pbuf and gw_intr call, add pblh to chem_timestep_tend
  call, and add WACCM-X calls to mspd_intr and ionos_intr methods

models/atm/cam/src/physics/cam/vertical_diffusion.F90
. add molecular diffusion field list, add molecular conductivity to pbuf, and add calls to 
  phys_getopts to get molecular diffusion switch and top and bottom levels for eddy and
  molecular diffusion to operate

models/atm/cam/src/physics/waccm/gw_drag.F90
. calculate and use molecular diffusivity instead of molecular+eddy diffusivity and access
  bottom level for molecular diffusion using phys_getopts method

models/atm/cam/src/physics/waccm/iondrag.F90
. add Pedersen and Hall conductivities to pbuf

models/atm/cam/src/physics/waccm/nlte_lw.F90
. use constituent dependent constants for output heating rate calculations

models/atm/cam/src/physics/waccm/radheat.F90
. use constituent dependent constants for heating rate calculations

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Tue Nov 15 14:03:51 MST 2011
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Tue Nov 15 16:28:26 MST 2011

Failures are expected baseline comparison failures due to gravity wave drag bug fix.

edinburgh/lf95: 
036 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Nov 15 17:53:29 MST 2011

Failure is expected baseline comparison failure due to gravity wave drag bug fix.

hopper/pgi:
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Nov 16 14:41:19 PST 2011 

Failure is expected baseline comparison failure due to gravity wave drag bug fix.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: WACCM answers changed due to gravity wave drag bug fix

===============================================================
===============================================================

Tag name: cam5_1_14
Originator(s): eaton
Date: Sat Nov 12 09:59:14 MST 2011
One-line Summary: refactor the microp_driver and cldwat2m_micro modules

Purpose of changes:

. The microp_driver and cldwat2m_micro modules have been refactored to
  create a three layered architecture comprised of a driver, cam physics
  interfaces, and a portable physics parameterization.  The driver is a
  thin layer which exposes the control logic very cleanly to facilitate
  supporting multiple microphysics schemes.  The portable physics
  parameterization is the algorithms from cldwatwm_micro, but with all the
  cam specific infrastructure for doing things like managing fields in the
  physics buffer and writing fields to history files removed.  The just
  mentioned cam specific functionality is the responsibility of the cam
  interface layer.

  This change is to facilitate supporting both the original MG microphysics
  scheme along with the new MG2 scheme under development.

Bugs fixed (include bugzilla ID):

. Fixed a non-conforming use of the min intrisic function in the definesurf
  utility which some compilers didn't ignore.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/physics/cam/cldwat2m_micro.F90
. this file was renamed micro_mg.F90 and now contains the portable MG
  code. 

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/micro_mg.F90
. was cldwat2m_micro.F90.  The cam specific infrastructure code was removed
  so that this module now contains the portable MG code.

models/atm/cam/src/physics/cam/micro_mg_cam.F90
. The CAM specific physics interfaces for the MG microphysics scheme.
  Contains code that was originally in both the cldwat2m_micro and the
  microp_driver modules.

models/atm/cam/src/utils/gamma_function.F90
. The gamma function code that was originally in cldwat2m_micro.F90

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/physics/cam/macrop_driver.F90
. move the pbuf_add call for FICE to this module which is responsible for
  setting it.

models/atm/cam/src/physics/cam/microp_aero.F90
. move the outfield call for wsub and wsubi into this module which is the
  one responsible for computing them

models/atm/cam/src/physics/cam/microp_driver.F90
. remove code that belongs in cam interface to MG package.

models/atm/cam/src/physics/cam/ndrop.F90
. change the ptend argument of dropmixnuc to intent(out) and provide an
  initializer for it.
. fix first dimension of coltend and coltend_cw

models/atm/cam/src/physics/cam/tphysbc.F90
. update actual args in call to microp_driver_tend

models/atm/cam/tools/definesurf/map2f.f90
. bug fix in "min" intrinsic

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

hopper/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_1_13
Originator(s): eaton, fischer
Date: Nov 7,  2011
One-line Summary: refactor state updates by macrop and microp drivers
                  Changes to testing, work around for mpi_rsend bug

Purpose of changes:

. Refactor the way the "state" was being used in the macrop and microp
  drivers to conform to the physics interface design.

  This refactoring results in a larger than roundoff answer change.
  Previously instead of updating state sequentially first with the macrop
  tendencies and then with microp tendencies, the two tendencies were added
  together and only one update of state was being done after the microp
  code (although local copies of state were being updated for internal use,
  and an updated local copy of state was being passed between the macrop
  and microp calculations which was quite confusing).

. Move the addfld/outfld calls for the cam4 physics version of REL, REI
  from the param_cldoptics module to stratiform.  This refactoring enables
  the cam4 physics package to be run with MG microphysics swapped in RK.

  The move from param_cldoptics to stratiform affects the sampling
  frequency of these fields because param_cldoptics_calc was only called on
  radiation timesteps while stratiform_tend is called every timestep.  So
  there will be a larger than roundoff difference in the diagnostic history
  fields.

. Changes to testing
  The namelist files used for testing had hard coded inputdata directory paths
  in them.  This was making it hard to run the tests on non NCAR systems.  The
  directory paths are no being set by the enviroment variable $CSMDATA.
  Set up pretag test to run on jaguarpf

. Work around for mpi_rsend bug
  The Gemini interconnect has a performance bug for mpi_rsend and mpi_irsend.
  CPP flag _NO_MPI_RSEND was added so that MPI_RSEND and MPI_IRSEND can be
  redefined to MPI_SEND.  _NO_MPI_RSEND is only set within the CESM scripts.

. Bug fix for addfld call for U_COSP and V_COSP.
  Should be dimension of 1 instead of pver.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/physics/cam/param_cldoptics.F90
. remove addfld/outfld calls for REL, REI
. having the outfld calls made from param_cldoptics_calc means that they're
  only done on radiation timesteps.  Moving the outfld call to
  stratiform_tend will change the outfld frequency, hence the diagnostic
  result. 

models/atm/cam/src/physics/cam/stratiform.F90
. add addfld/outfld calls for REL, REI (sampling frequency is now every timestep) 
. remove pbuf entries for REL2, REI2 -- not used.
. remove some unneeded "if (microp_scheme .eq. 'RK')"
. use ncnst as the parameter that is set to 2, and remove ncnstmax
. remove unused state_eq arg from stratiform_tend
. Remove the unused convective in-cloud LWP and IWP.

models/atm/cam/src/physics/cam/macrop_driver.F90
. macrop_driver_tend
  - remove intent(out) arg state_eq 
  . update the equilibrium state variables for macrophysics
  . Rename the local state, ptend, and tend variables for consistency and
    clarity.

models/atm/cam/src/physics/cam/microp_driver.F90
. move the update of the equilibrium state variables for macrop to
  macrop_driver_tend (tcwat, qcwat, lcwat, iccwat, nlwat, niwat)
. remove argument state_eq -- the 'state' variable is now updated with the
  macrophysics tendencies.
. Rename the local state, ptend, and tend variables for consistency and
  clarity.
. Add missing ptend_loc.  Needed for local update of state.
. Remove the unused calculation of convective in-cloud LWP and IWP.

models/atm/cam/src/physics/cam/physics_types.F90
. add copy method for physics_ptend objects.

models/atm/cam/src/physics/cam/tphysbc.F90
. remove actual arg state_eq from macrop_driver_tend call
. restore the physics_update and energy check after macrop_driver_tend
. remove actual arg state_eq from microp_driver_tend call
. remove local state_eq variable.

models/atm/cam/src/control/wrap_mpi.F90
models/atm/cam/src/utils/spmd_utils.F90
models/atm/cam/src/utils/pilgrim/mod_comm.F90
. Work around for a performance bug with the MPI_RSEND and the Gemini interconnect
   added #ifdef for _NO_MPI_RSEND
   if _NO_MPI_RSEND is defined, then mpi_rsend and mpi_irsend is redefined as mpi_rsend

models/atm/cam/test/system/nl_files/off1.9x2.5
models/atm/cam/test/system/nl_files/rad_diag
models/atm/cam/test/system/nl_files/sat_hist
. Replace hard coded directory paths to inputdata with $CSMDATA

models/atm/cam/test/system/TSM.sh
models/atm/cam/test/system/TBR.sh
models/atm/cam/test/system/TER.sh
. Fixed problem with harded coded directory paths in namelist files.
  Copy namelist file to run directory, then replace $CSMDATA with machine
  specific inputdata directory path.

models/atm/cam/test/system/test_driver.sh
. Changed threads and tasks so edinburgh pretag test list works on jaguarpf
. Changed PGI compiler to 11.0

models/atm/cam/test/system/input_tests_master
. Added configure buildsi(CB) for jaguarpf pretag test list

models/atm/cam/src/physics/cam/cospsimulator_intr.F90
. addfld calls for U_COSP and V_COSP should be a dimension of 1 instead of pver

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Nov  2 09:41:16 MDT 2011
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Nov  2 09:41:17 MDT 2011
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Wed Nov  2 09:41:28 MDT 2011
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Wed Nov  2 09:41:36 MDT 2011
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Wed Nov  2 09:42:01 MDT 2011
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Wed Nov  2 09:42:20 MDT 2011

All failures are expected baseline comparison failures.

edinburgh/lf95: 
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Nov  1 16:19:59 MDT 2011
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Nov  1 16:34:14 MDT 2011
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Nov  1 16:46:19 MDT 2011
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Nov  1 16:51:03 MDT 2011
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Nov  1 17:21:18 MDT 2011
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Nov  1 19:55:15 MDT 2011
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Tue Nov  1 20:41:13 MDT 2011

All failures are expected baseline comparison failures.

hopper/pgi: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Nov  1 18:56:11 PDT 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Nov  1 19:14:42 PDT 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Nov  1 19:31:10 PDT 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Nov  1 19:36:19 PDT 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Nov  1 20:09:10 PDT 2011
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Nov  1 21:07:05 PDT 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Tue Nov  1 22:04:40 PDT 2011
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Nov  1 22:26:27 PDT 2011
046 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 7 at Tue Nov  1 22:40:32 PDT 2011
049 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 5 at Tue Nov  1 22:45:50 PDT 2011
052 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 7 at Tue Nov  1 23:29:12 PDT 2011

All failures are expected baseline comparison failures.


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,

Runs done on bluefire using cesm scripts.
  control:
    $SVNREPO/cam1/branch_tags/radcnst_cam5_1_11_tags/radcnst06_cam5_1_11/
    create_newcase -compset F1850C5 -res f19_f19 -mach bluefire -case /glade/home/fischer/runs/cam5_1_11_radcnst06
  experiment:
    $SVNREPO/cam1/branch_tags/macrop_cam5_1_12_tags/macrop01_cam5_1_12/
    create_newcase -compset F1850C5 -res f19_f19 -mach bluefire -case /blhome/fischer/runs/cam5_1_13_F1850C5

MSS location of control simulations used to validate new climate:
  control:    /home/fischer/csm/cam5_1_11_radcnst06
  experiment: /home/fischer/csm/cam5_1_13_F1850C5

URL for AMWG diagnostics output used to validate new climate:
  http://www.cgd.ucar.edu/cms/fischer/cam5/cam5_1_13_F1850C5-cam5_1_11_radcnst06/

===============================================================
===============================================================

Tag name: cam5_1_12
Originator(s): eaton
Date: Mon Oct 31 10:16:23 MDT 2011
One-line Summary: Functionality for prescribed MAM and diagnostic radiation calcs w/ MAM.

Purpose of changes:

The mods in this commit provide the functionality to run the cam5 physics
package with prescribed modal aerosols, and enable diagnostic radiation
calculations with modal aerosols.

*** Note that a climate validation has not yet been performed for cam5
*** using this version of prescribed modal aerosols.  Preliminary work has
*** been done at PNNL using a completely different code base.  The findings
*** from that work still need to be applied to this code base.

The new features required breaking the tight link between the code
responsible for optics/microphysics calculations and the data structures
used in the prognostic modal aerosol code.  That has been accomplished by
extending the rad_constituent interfaces to be able to provide information
about the modal aerosols.  But there a few complications related to the
interactions with the microphysics:

1) There are derived fields that are associated with the aerosol modes (the
water uptake by the mode, QAERWAT, and the mode wet radius, DGNUMWET), and
as currently implemented, these fields are only being computed for the
modes used in the climate calculations.  In the diagnostic radiation
calculations, the loop over modes is using the same values of QAERWAT and
DGNUMWET that were computed for the climate active modes.

2) The part of the droplet activation code that modifies the number and
mass mixing ratios of the modal aerosols is disabled if the aerosols that
affect the climate are prescribed.

3) The mode dry radius calculation which is a precurser to the wet radius
calculation is also where the modal aerosol physics responsible for mass
transfer between the accumulation and aitken modes takes place.  If the
modal aerosols that affect the climate calculation are prescribed, then
only a diagnostic calculation of dry radius takes place and the mode
transfer physics is disabled.

Both items 2) and 3) above imply that the prognostic modal aerosols must
affect the climate radiation calculation in order for all processes
affecting the modal aerosols to be computed.  In other words, you can't run
a full prognostic modal aerosol calculation if those aerosols are only
participating in diagnostic radiation calculations.

To summarize:

. The prescribed modal aerosol feature is fully functional.  Scientific
  validation with this code remains to be done.

. When prognostic modal aerosols are used only roundoff size differences
  have been introduced into the model results.  Most of these roundoff
  differences are at the double precision level.  But the one exception is
  that the sigma_logr_aer variable in the modal optics file was updated to
  match the hardcoded values of sigmag_amode in the modal_aero_data module,
  and this introduces a single precision roundoff error.

. The previous version of diagnostic radiation calculations with modal
  aerosols had hardcoded the restriction that no modal aerosols were
  present in any diagnostic calculation.  This restriction has been
  removed.

. The capability to do diagnostic radiation calculations with the modal
  aerosols is functional, but with the following important restriction:

  *** The derived QAERWAT and DGNUMWET fields are not recomputed for the
  *** modes used in a diagnostic calculation.

  The QAERWAT and DGNUMWET fields computed for the modes that affect the
  climate will be reused in the diagnostic calculations.  This may be an
  acceptable approximation in some cases, but not in others.  It also
  implies that there is not yet support to arbitrarily remove a mode from
  the diagnostic calculation.

. Due to the current constraint that there is only one version of the
  QAERWAT and DGNUMWET fields, a full prognostic aerosol calculation is
  only done when the prognostic aerosols are the ones that affect the
  climate.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:

. new variable, mode_defs, provides the metadata necessary to define the
  modes.  The default value is set by build-namelist.
. The existing namelist variables used by rad_constituents, i.e.,
  rad_climate and rad_diag_*, have been updated to accept modes as entities
  that can effect the climate and diagnostic radiation calculations.  The
  default value of rad_climate is set by build-namelist.
. The syntax of the rad_climate and rad_diag_* variables has been changed
  as follows.  The source of gas or aerosol mixing ratios was previously
  specified with either a 'P' (for prognostic) or a 'D' (for data).  But
  the real meaning of this specifier is that the mixing ratio will be found
  in either the constituent array (P) or the physics buffer (D).  However
  there is a semantic inconsistency in that prognostic species may also be
  found in the physics buffer, e.g., the cloud borne modal species.  So the
  source term has been renamed: 'P' has been changed to 'A' (for advected)
  and 'D' has been changed to 'N' (for non-advected).  Those terms are
  more physical descriptions of the difference between constituents that
  are stored in the constituent array (part of the state derived type)
  vs constituents that are stored in the physics buffer.

List any changes to the defaults for the boundary datasets:

. The file that contained properties for all modes (modal_optics_3mode.nc)
  has been broken up into 3 files which each contain properties for a
  single mode:
    mam3_mode1_rrtmg_c110318.nc
    mam3_mode2_rrtmg_c110318.nc
    mam3_mode3_rrtmg_c110318.nc

  This change introduces a single precision roundoff error due to replacing
  the single precision values in sigma_logr_aer by a new variable, sigmag,
  which contains the double precision values to match the hardcoded data in
  the modal_aero_data module.

Describe any substantial timing or memory changes:

. no memory change
. small performance degradation of about 3% measured on 2 nodes of bluefire
  using an FV, 2 deg, cam5 config.

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/chemistry/modal_aero/modal_aero_calcsize.F90
models/atm/cam/src/chemistry/modal_aero/modal_aero_wateruptake.F90
. moved to src/chemistry/utils/ so is available for calculations with
  prescribed modal aerosols

List all subroutines added and what they do:

models/atm/cam/src/chemistry/utils/modal_aero_calcsize.F90
. moved here from chemistry/modal_aero.
. update the interfaces to pass cam state, tend, pbuf
. modal_aero_calcsize_sub
  - this code performs chemistry specific calculations for transferring
    mass between the aitken and accumulation modes.  I don't think it makes
    sense to try and do this for the prescribed aerosol mode.  Also, in
    order to execute this code for prescribed aerosols the rad_constituent
    interfaces would need to be extended to provide a lot of chemistry
    specific information that doesn't really seem appropriate (the
    information that is currently provided in the modal_aero_rename module
    when prognostic aerosols are active).  So the part of this routine that
    doew the dry radius calculation has been extracted into a new
    subroutine.  Use a MODAL_AERO ifdef around the code that is only active
    for prognostic aerosols.
. modal_aero_calcsize_diag
  - new subroutine which contains just the dry radius calculation from
    modal_aero_calcsize_sub.  The calculation here makes use of the
    rad_constituents interfaces.

models/atm/cam/src/chemistry/utils/modal_aero_wateruptake.F90
. moved here from chemistry/modal_aero.
. add init method
. make use of rad_constituent interfaces
. same code used for both prognostic and prescribed modal aerosols

models/atm/cam/src/physics/cam/ndrop_bam.F90
. new module for droplet nucleation code used by BAM -- Moved here from the
  microp_aero module. 

models/atm/cam/src/physics/cam/nucleate_ice.F90
. new module for ice nucleation code -- code for ice nucleation moved here
  from the microp_aero module.  This code is used by both BAM and MAM aerosols

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. modify the rad_climate default to implement syntax change and extention
  for modes
. Add new code to construct the default definition of trop_mam3 modes.
  This works for both prognostic and prescribed modal aerosols.
. Modify the code that extracts physprop filenames from the rad_climate and
  rad_diag_* variables to deal with the syntax changes and the new
  mode_defs variable.  This code supports the -test and -inputdata options.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. replace old modal_optics_file defaults by defaults for the new mode
  physprop files

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add mode_defs
. remove modal_optics_file

models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3.xml
models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam4.xml
. update the rad_climate syntax

models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
. general cleanup
. replace several MODAL_AERO ifdefs by runtime control.  Add control
  logicals and set them using the rad_constituent interfaces to determine
  at runtime whether modal aerosols affect the climate, and whether the
  modal aerosols are prognostic or not.  Need to know whether aerosol modes
  affect the climate so can turn on code that previously would only be on
  when the prognostic aerosol code was on, but now it may be prescribed
  modes that will be used in the mode radius and water uptake calculations.
. modify prognostic_aerosol_initialize:
  - rename aerosol_init for consistency.
  - init the dgnum and dgnumwet pbuf fields
  - call the init methods for modal_aero_calcsize and
    modal_aero_wateruptake
. aerosol_wet_intr:
  - The modal_aero_calcsize and modal_aero_wateruptake interfaces have been
    cleaned up to just pass state, ptend, pbuf.  Make associated changes in
    calling code (remove several unneeded pointers into pbuf).
  - move the calls to the calcsize and wateruptake routines outside the ifdef
    MODAL_AERO section so that they are now available for prescribed modal
    aerosols.
. aerosol_emis_intr
  - interface cleanup
  - modify calls to dust_emis_intr and progseasalts_emis_intr due to
    cleaned up interfaces in those modules

models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
. pass cam import state through dust_emis_intr interface

models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
. pass cam import state and remove unnecessary
  MODAL_AERO ifdef from progseasalts_emis_intr interface

models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
. modify the mode type names to remove embedded blanks.
. remove data for sigmag_amode, dgnum_amode, dgnumlo_amode, dgnumhi_amode,
  rhcrystal_amode, rhdeliques_amode, and remove parameter attributes.

models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
. modify the code that's setting properties for the mode species to make
  use of the new rad_constituent interfaces.
. addfld calls for water uptake diagnostics moved to the wateruptake
  module.
. modify the mode type names to remove embedded blanks.
. set data for mode props using rad_cnst_get_mode_props.
. move setting of derived props depending on sigmag from the register to
  the init method. 

models/atm/cam/src/physics/cam/aer_rad_props.F90
. get info from rad_constituent interfaces to determine at runtime whether
  modal optics are required.
. modal_aero_{sw,lw} no longer need to be called from within ifdef
  MODAL_AERO conditionals.  The code inside the ifdef is where the
  restriction that all diagnostic radiation calcs would set the modal
  aerosol contributions to zero.  This restriction is removed.  There was
  also a restriction that the only bulk aerosol that could be added to the
  modes was a volcanic aerosol.  This restriction is also removed.
. add list_idx arg to calls to modal_aero_{sw,lw} -- this enables
  diagnostic rad calcs to be done with modified definitions of the modes.
. combined some unnecessarily duplicated cases for opticstype

models/atm/cam/src/physics/cam/microp_aero.F90
. move some of the code in this module to other modules that are
  responsible for the droplet activation and ice nucleation calculations
  for BAM and MAM.  Try to have this module be more of a control layer than
  a container for specific pieces of the microphysics calculations.
  Specifically moved alot of code to the new modules ndrop_bam and
  nucleate_ice.
. remove MODAL_AERO ifdefs.  There are now runtime
  conditionals to determine whether the modal aerosols are impacting the
  climate calculation, and whether prognostic modal aerosols are active.
. update microp_aero interfaces to pass the cam state and pbuf.
. remove unused code
. move the BAM/MAM specific code for setting aerosol number outside of
  nucleati. 
. move code for droplet activation by BAM into new ndrop_bam module
. add rad_constituent interfaces to init method to determine indices for
  specific modes/species required by the nucleation code.
. access required mode number m.r. and mode/specie mass m.r. fields using
  the rad_constituent interfaces
. microp_aero_ts
  - change name to microp_aero_run for consistency
  - use state and pbuf as dummy args rather than passing individual
    components of those structures.
  - use the rad_constituents interfaces inside the subroutine to construct
    the maerosol array rather than copying data into the aer_mmr array.
. move initialization of pbuf fields to the modules that are responsible
  for them (qqcw, dgnum, dgnumwet)
. remove error function code (derf)

models/atm/cam/src/physics/cam/microp_driver.F90
. remove unneeded MODAL_AERO ifdefs
. remove pbuf associations that are now done inside the microp_aero_run
  routine. 

models/atm/cam/src/physics/cam/modal_aer_opt.F90
. refactor to make use of the new capabilities of the rad_constituent
  interfaces to provide information about the modes rather than rely on
  information about the modes being read from the modal optics dataset.
  - Also note that the modal optics dataset has been broken up so that each
    mode is in its own dataset.  Correspondingly the mode dimension has
    been removed from several arrays since that data is now obtained from
    the rad_cnst_get_mode_props calls inside the loop over modes.
. remove the reading of the modal optics file -- this data is now accessed
  via the rad_constituent interfaces.
. enable the modal_aero_{sw,lw} routines to work for diagnostic as well as
  the climate radiation calcs.

models/atm/cam/src/physics/cam/ndrop.F90
. general cleanup
  - remove the unused surface exchange code
  - check declarations for unused vars
  - remove the conditional checks on (lnum > 0)
  - redo ndrop interfaces to pass cam types as per physics interface
  - replace local calc of pi with physconst version, and replace hardcoded
    value of sqrt(2*pi) by computed value.
. implement rad_constituent interfaces
. add logic so that tendencies are only computed for prognostic MAM
. remove the MODAL_AERO ifdef except around the code that does the tendency
  calculations. 
. rework local arrays that were declared with a pcnst dimension, but only
  needed storage for the modal number densities and species mmr.  Use a
  local indexing scheme for those constituents.

models/atm/cam/src/physics/cam/phys_prop.F90
. add fields for the modal optics and properties to the physprop_type
  structure. 
. modify logic to read physprop files for modes as well as for bulk
  aerosols.
. move the reading of bulk aerosol properties into separate routine and
  only call when appropriate.
. add new method for reading modal physprop files

models/atm/cam/src/physics/cam/physpkg.F90
. remove unused pbuf and phys_state args from rad_cnst_init call
. replace phys_state arg by pbuf in prognostic_aerosol_initialize call
. remove some unnecessary array bounds and just pass entire phys_state array

models/atm/cam/src/physics/cam/rad_constituents.F90
. extensions to support modal aerosols
  - a new namelist variable, mode_defs, was added to supply metadata
    defining the modes.
  - add parsing for new mode_defs variable
  - extend parsing of rad_climate and rad_diag_* variables to include
    modes. 
  - create new internal data structures for the mode definitions and for
    mode lists which are analogous to the gas and bulk aerosol lists.
  - move the initialization of data structures that contain information
    specified in the namelist up into rad_cnst_readnl so that this info is
    available elsewhere via the rad_cnst_get_info method as early in the
    initialization process as possible.
  - generic method rad_cnst_get_info has been extended to return info about
    the mode definitions
  - rad_cnst_get_aer_mmr and rad_cnst_get_aer_props have been extended to
    return mixing ratios and props for the mode species
  - rad_cnst_get_mode_num and rad_cnst_get_mode_props have been added to
    provide the number mixing ratio and properties that are specific to
    modes.
  - removed some optional args from the get_info method for data that
    should remain private in the module.
. rad_cnst_init and init_lists -- remove unused args pbuf & phys_state

models/atm/cam/src/physics/cam/radiation_data.F90
. use rad_constituent interfaces to access mixing ratio data -- old code
  was accessing metadata which is meant to be private in the
  rad_constituents module by extending rad_cnst_get_info, then using this
  metadata to directly access the mixing ratios in the state and pbuf
  structures.  The rad_cnst_get_gas and rad_cnst_get_aer_mmr interfaces are
  supposed to be used for this.

models/atm/cam/src/physics/cam/stratiform.F90
. remove unused cam5 macro/micro physics code

models/atm/cam/src/physics/cam/tphysac.F90
. fix aerosol_emis_intr interface to make ifdef MODAL_AERO unnecessary

models/atm/cam/src/physics/cam/vertical_diffusion.F90
. move the initialization of the physics buffer fields tke and kvh into the
  vertical diffusion init method.

models/atm/cam/src/physics/rrtmg/oldcloud.F90
. cleanup -- remove some unused code

models/atm/cam/src/physics/rrtmg/radiation.F90
. move the add_default calls for radiation diagnostics inside the loop over
  diagnostic calculations so that when diagnostic calculations are
  requested the output from those calculations is added to the history file.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Fri Oct 28 16:05:11 MDT 2011
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Oct 28 16:09:44 MDT 2011
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Fri Oct 28 16:28:12 MDT 2011
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Fri Oct 28 16:59:22 MDT 2011
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Fri Oct 28 17:16:34 MDT 2011
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Fri Oct 28 18:00:24 MDT 2011

All failures are expected baseline comparison failures.

edinburgh/lf95:  All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Oct 28 15:36:52 MDT 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Oct 28 15:51:40 MDT 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Oct 28 16:03:04 MDT 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Oct 28 16:07:47 MDT 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Oct 28 16:37:10 MDT 2011
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Oct 28 19:09:29 MDT 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Oct 28 19:51:59 MDT 2011

All failures are expected baseline comparison failures.

There is a bug in PGI compiler versions earlier than 11.0 which prevent it
from compiling the new rad_constituents.F90 file.  There is no obvious
workaround for this bug, so until edinburgh gets an updated pgi the testing
will be done on one of the cray platforms.

hopper/pgi-11.7: All PASS except:
005 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Oct 28 14:33:20 PDT 2011
010 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Oct 28 14:35:05 PDT 2011
012 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Oct 28 14:35:06 PDT 2011
016 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Oct 28 14:35:14 PDT 2011
023 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Oct 28 14:35:19 PDT 2011
031 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Oct 28 14:35:39 PDT 2011
041 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Oct 28 14:35:41 PDT 2011
044 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Oct 28 14:35:47 PDT 2011
047 bl319 TBL.sh fn10c5dm outfrq3s_bam 9s .................................FAIL! rc= 5 at Fri Oct 28 14:35:47 PDT 2011
050 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Fri Oct 28 14:35:50 PDT 2011
053 bl734 TBL.sh hn16c5aqdm outfrq3s_bam+aquaplanet_cam5 9s ...............FAIL! rc= 5 at Fri Oct 28 14:35:50 PDT 2011

These baseline failures are all expected due to the different answers from
cam5 w/ trop_mam3.  Two tests, bl319 and bl734 failed due the test
definitions changing and the new test wasn't defined for the baseline.  But
when the new test is added to the baseline cam5_1_11, then the failures in
those tests, as in bl320, is due to a roundoff diff in the diagnostic field
CCN3.  The simulations are actually identical.


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: The answers are bit for bit except for
configurations with cam5 physics and trop_mam3 chemistry.  In that case a
single precision size roundoff change was introduced, and has been
validated by the climate runs below.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced:

Runs done on bluefire using cesm scripts.
  control:
    $SVNREPO/cam1/branch_tags/r8_cam5_1_03_tags/r8b_cam5_1_03/
    create_newcase -compset F1850C5 -res f19_f19 -mach bluefire -case /blhome/fischer/runs/cam5_1_03_1850_r8
  experiment:
    $SVNREPO/cam1/branch_tags/radcnst_cam5_1_11_tags/radcnst06_cam5_1_11/
    create_newcase -compset F1850C5 -res f19_f19 -mach bluefire -case /glade/home/fischer/runs/cam5_1_11_radcnst06

MSS location of control simulations used to validate new climate:
  control:    /FISCHER/csm/cam5_1_03_1850_r8
  experiment: /home/fischer/csm/cam5_1_11_radcnst06

URL for AMWG diagnostics output used to validate new climate:
   http://www.cgd.ucar.edu/cms/fischer/cam5/cam5_1_11_radcnst06-cam5_1_03_1850_r8

===============================================================
===============================================================
Tag name: cam5_1_11 
Originator(s): fischer
Date: Oct 11 2011
One-line Summary: add missing explicit r8 kind, fix TKE and CUSH init

Purpose of changes:
.  Add testing for missing explicit r8 kind
.  Add missing explicit r8 kind to F90 code
.  Didn't add missing explicit r8 kind or tests for external code
.  Fix initialization bug (#1378) for TKE and CUSH.

Bugs fixed (include bugzilla ID): #1378

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: fischer

List all subroutines eliminated:
D       models/atm/cam/src/physics/cam/miesubs.F
.  not being used

List all subroutines added and what they do:
A       models/atm/cam/test/system/TR8.sh
.  test for missing explicit r8 kind

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/test/system/test_driver.sh
M       models/atm/cam/test/system/tests_pretag_edinburgh_pgi
M       models/atm/cam/test/system/input_tests_master
.  add test for missing explicit r8 kind 

M       models/atm/cam/src/physics/cam/convect_shallow.F90
.  remove initialization of TKE and CUSH (bug #1378)
.  add missing explicit r8 kind 


M       models/atm/cam/src/control/sat_hist.F90
M       models/atm/cam/src/control/interpolate_data.F90
M       models/atm/cam/src/control/scamMod.F90
M       models/atm/cam/src/utils/time_manager.F90
M       models/atm/cam/src/utils/cam_csim4/ice_time_manager.F90
M       models/atm/cam/src/utils/cam_dom/ocn_time_manager.F90
M       models/atm/cam/src/utils/pilgrim/mod_comm.F90
M       models/atm/cam/src/utils/pilgrim/unit_testers/ghosttest.F90
M       models/atm/cam/src/utils/pilgrim/unit_testers/redistributetest.F90
M       models/atm/cam/src/utils/pilgrim/unit_testers/decomptest.F90
M       models/atm/cam/src/utils/pilgrim/unit_testers/parutilitiestest.F90
M       models/atm/cam/src/utils/pilgrim/unit_testers/parpatterntest.F90
M       models/atm/cam/src/utils/repro_sum_mod.F90
M       models/atm/cam/src/physics/cam/cam3_aero_data.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/tropopause.F90
M       models/atm/cam/src/physics/cam/rayleigh_friction.F90
M       models/atm/cam/src/physics/cam/flux_avg.F90
M       models/atm/cam/src/physics/cam/aer_rad_props.F90
M       models/atm/cam/src/physics/cam/radsw.F90
M       models/atm/cam/src/physics/cam/phys_prop.F90
M       models/atm/cam/src/physics/cam/hirsbt.f90
D       models/atm/cam/src/physics/cam/miesubs.F
M       models/atm/cam/src/physics/cam/sslt_rebin.F90
M       models/atm/cam/src/physics/cam/modal_aer_opt.F90
M       models/atm/cam/src/physics/cam/physics_types.F90
M       models/atm/cam/src/physics/cam/radlw.F90
M       models/atm/cam/src/physics/cam/hb_diff.F90
M       models/atm/cam/src/physics/cam/ndrop.F90
M       models/atm/cam/src/physics/cam/physpkg.F90
M       models/atm/cam/src/physics/cam/phys_debug_util.F90
M       models/atm/cam/src/physics/cam/rad_constituents.F90
M       models/atm/cam/src/physics/cam/mcshallow.F90
M       models/atm/cam/src/physics/cam/cldwat2m_macro.F90
M       models/atm/cam/src/physics/cam/convect_deep.F90
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M       models/atm/cam/src/physics/cam/wv_saturation.F90
M       models/atm/cam/src/physics/cam/cldwat2m_micro.F90
M       models/atm/cam/src/physics/cam/rad_solar_var.F90
M       models/atm/cam/src/physics/cam/phys_grid.F90
M       models/atm/cam/src/physics/cam/phys_debug.F90
M       models/atm/cam/src/physics/cam/zm_conv_intr.F90
M       models/atm/cam/src/physics/cam/zm_conv.F90
M       models/atm/cam/src/physics/cam/eddy_diff.F90
M       models/atm/cam/src/physics/cam/cldwat.F90
M       models/atm/cam/src/physics/cam/uwshcu.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
M       models/atm/cam/src/physics/cam/uw_conv.F90
M       models/atm/cam/src/physics/waccm/gw_drag.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_photo.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sad.F90
M       models/atm/cam/src/chemistry/utils/mo_constants.F90
M       models/atm/cam/src/chemistry/utils/mo_util.F90
M       models/atm/cam/src/chemistry/utils/tracer_data.F90
M       models/atm/cam/src/chemistry/utils/solar_data.F90
M       models/atm/cam/src/chemistry/utils/aircraft_emit.F90
M       models/atm/cam/src/chemistry/modal_aero/mo_sethet.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_wateruptake.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_calcsize.F90
M       models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
M       models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M       models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_ghg_chem.F90
M       models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M       models/atm/cam/src/chemistry/mozart/mo_airmas.F90
M       models/atm/cam/src/chemistry/mozart/mo_trislv.F90
M       models/atm/cam/src/chemistry/mozart/mo_lightning.F90
M       models/atm/cam/src/chemistry/mozart/lin_strat_chem.F90
M       models/atm/cam/src/chemistry/mozart/mo_schu.F90
M       models/atm/cam/src/chemistry/mozart/mo_lymana.F90
M       models/atm/cam/src/chemistry/mozart/mo_calcoe.F90
M       models/atm/cam/src/chemistry/mozart/mo_aerosols.F90
M       models/atm/cam/src/chemistry/mozart/mo_airplane.F90
M       models/atm/cam/src/chemistry/mozart/gas_wetdep_opts.F90
M       models/atm/cam/src/chemistry/mozart/mo_ps2str.F90
M       models/atm/cam/src/chemistry/mozart/mo_fstrat.F90
M       models/atm/cam/src/chemistry/mozart/mo_sphers.F90
M       models/atm/cam/src/chemistry/mozart/mo_sad.F90
M       models/atm/cam/src/chemistry/mozart/mo_setozo.F90
M       models/atm/cam/src/chemistry/mozart/mo_drydep.F90
M       models/atm/cam/src/chemistry/mozart/mo_photo.F90
M       models/atm/cam/src/chemistry/mozart/cfc11star.F90
M       models/atm/cam/src/chemistry/mozart/mo_sethet.F90
M       models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M       models/atm/cam/src/chemistry/mozart/mo_neu_wetdep.F90
M       models/atm/cam/src/chemistry/mozart/mo_strato_sad.F90
M       models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M       models/atm/cam/src/chemistry/mozart/mo_setcld.F90
M       models/atm/cam/src/chemistry/mozart/mo_xsections.F90
M       models/atm/cam/src/chemistry/mozart/mo_inter.F90
M       models/atm/cam/src/chemistry/mozart/mo_synoz.F90
M       models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
M       models/atm/cam/src/chemistry/mozart/mo_setsox.F90
M       models/atm/cam/src/dynamics/sld/dyn_grid.F90
M       models/atm/cam/src/dynamics/sld/sld_control_mod.F90
M       models/atm/cam/src/dynamics/eul/eul_control_mod.F90
M       models/atm/cam/src/dynamics/eul/dyn_grid.F90
M       models/atm/cam/src/dynamics/eul/forecast.F90
M       models/atm/cam/src/dynamics/eul/inidat.F90
M       models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90
M       models/atm/cam/src/dynamics/eul/iop.F90
M       models/atm/cam/src/dynamics/eul/stepon.F90
M       models/atm/cam/src/dynamics/fv/dyn_grid.F90
M       models/atm/cam/src/dynamics/fv/dryairm.F90
M       models/atm/cam/src/dynamics/fv/dyn_comp.F90
M       models/atm/cam/src/dynamics/fv/ctem.F90
.  add missing explicit r8 kind 


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Mon Oct 10 09:50:55 MDT 2011
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Mon Oct 10 09:51:03 MDT 2011
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Mon Oct 10 09:51:05 MDT 2011
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Mon Oct 10 09:51:14 MDT 2011
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Mon Oct 10 09:51:26 MDT 2011
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Mon Oct 10 09:52:15 MDT 2011
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Mon Oct 10 09:52:22 MDT 2011
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Mon Oct 10 09:52:47 MDT 2011
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Mon Oct 10 09:53:35 MDT 2011
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Mon Oct 10 09:53:54 MDT 2011
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Mon Oct 10 09:54:19 MDT 2011
054 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Mon Oct 10 09:54:32 MDT 2011
057 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Mon Oct 10 09:54:42 MDT 2011
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Mon Oct 10 10:08:24 MDT 2011
072 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Mon Oct 10 11:27:41 MDT 2011


edinburgh/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Oct  7 10:05:05 MDT 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 5 at Fri Oct  7 10:23:38 MDT 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Fri Oct  7 10:41:40 MDT 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 5 at Fri Oct  7 10:47:03 MDT 2011
018 bl115 TBL.sh e8idm idphys 9s ..........................................FAIL! rc= 7 at Fri Oct  7 10:55:59 MDT 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Oct  7 11:30:05 MDT 2011
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Oct  7 14:53:54 MDT 2011
032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Fri Oct  7 15:05:18 MDT 2011
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Oct  7 15:38:46 MDT 2011
038 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Fri Oct  7 15:52:18 MDT 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Oct  7 16:16:54 MDT 2011
043 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Fri Oct  7 16:40:26 MDT 2011
 

edinburgh/pgi: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Oct  7 09:50:03 MDT 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 5 at Fri Oct  7 09:57:42 MDT 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 5 at Fri Oct  7 10:01:33 MDT 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 5 at Fri Oct  7 10:04:17 MDT 2011
018 bl115 TBL.sh e8idm idphys 9s ..........................................FAIL! rc= 7 at Fri Oct  7 10:08:53 MDT 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Oct  7 10:19:37 MDT 2011
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Fri Oct  7 10:49:54 MDT 2011
032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Fri Oct  7 10:55:05 MDT 2011
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Oct  7 11:03:37 MDT 2011
038 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Fri Oct  7 11:09:38 MDT 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Fri Oct  7 11:15:43 MDT 2011
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Oct  7 11:26:42 MDT 2011
046 bl319 TBL.sh fn10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Oct  7 11:34:07 MDT 2011
049 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Fri Oct  7 11:37:14 MDT 2011
052 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL! rc= 7 at Fri Oct  7 12:06:39 MDT 2011


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.: Adding in the missing explicit r8 kind caused greater than
                                        roundoff error.  But climate is still preserved.

Runs done on bluefire using cesm scripts.

control: $SVNREPO/cam1/trunk_tags/cam5_1_03/
create_newcase -compset F1850C5 -res f19_f19 -mach bluefire -case /blhome/fischer/runs/cam5_1_03_1850_OOB
create_newcase -mach bluefire -res f19_g16 -compset FMOZ -case /blhome/fischer/runs/mozt5_1_03_2000_OOB
create_newcase -mach bluefire -res f19_g16 -compset F1850W -case /blhome/fischer/runs/waccm5_1_03_1850_OOB
create_newcase -res f19_f19 -compset F_SD_WACCM -mach bluefire -case /blhome/fischer/runs/wcm_offline_OOB

experiment: $SVNREPO/cam1/branch_tags/r8_cam5_1_03_tags/r8b_cam5_1_03/
create_newcase -compset F1850C5 -res f19_f19 -mach bluefire -case /blhome/fischer/runs/cam5_1_03_1850_r8
create_newcase -mach bluefire -res f19_g16 -compset FMOZ -case /blhome/fischer/runs/mozt5_1_03_2000_r8
create_newcase -mach bluefire -res f19_g16 -compset F1850W -case /blhome/fischer/runs/waccm5_1_03_1850_r8
create_newcase -res f19_f19 -compset F_SD_WACCM -mach bluefire -case /blhome/fischer/runs/wcm_offline_r8


MSS location of control simulations used to validate new climate:

Control runs:
/FISCHER/csm/cam5_1_03_1850_OOB
/FISCHER/csm/mozt5_1_03_2000_OOB
/FISCHER/csm/waccm5_1_03_1850_OOB
/FISCHER/csm/wcm_offline_OOB

Experiment runs:
/FISCHER/csm/cam5_1_03_1850_r8
/FISCHER/csm/mozt5_1_03_2000_r8
/FISCHER/csm/waccm5_1_03_1850_r8
/FISCHER/csm/wcm_offline_r8

URL for AMWG diagnostics output used to validate new climate:
http://www.cgd.ucar.edu/cms/fischer/cam5/cam5_1_03_1850_r8-cam5_1_03_1850_OOB/
http://www.cgd.ucar.edu/cms/fischer/r8/mozart/mozt5_1_03_2000_r8-mozt5_1_03_2000_OOB/
http://www.cgd.ucar.edu/cms/fischer/r8/waccm/waccm5_1_03_1850_r8-waccm5_1_03_1850_OOB/
http://www.cgd.ucar.edu/cms/fischer/r8/waccm/wcm_offline_r8-wcm_offline_OOB/

===============================================================
===============================================================
Tag name: cam5_1_10 
Originator(s): fischer, jedwards, Mark Taylor
Date: Thu Oct  6 2011 
One-line Summary: Update externals, memory use reduction, fix column data output

Purpose of changes:
.  Updated SVN externals to match cesm1_1_beta03
.  Memory reduction in src/chemistry/mozart/mo_drydep.F90 provided my
   Mark Taylor
.  Fix bug where column data was the same across history files
.  Improve column data test

Bugs fixed (include bugzilla ID): 
.  #1417 CAM history column output: h0 column data same as h1 column 
   data even when specified to be different

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
.  250MB reduction for CAM5 1/8 degree with changes to 
   src/chemistry/mozart/mo_drydep.F90

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/nl_files/ghgrmp
.  improve column data testing 

M       models/atm/cam/src/control/cam_history_support.F90
M       models/atm/cam/src/control/cam_history.F90
M       models/atm/cam/src/utils/cam_pio_utils.F90
.  bug #1417 fix

M       models/atm/cam/src/chemistry/mozart/mo_drydep.F90
.  Memory usage reduction for CAM5

M       SVN_EXTERNAL_DIRECTORIES
.  Updated to cesm1_1_beta03 svn externals


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all passed, except for TBL with ghgrmp

edinburgh/lf95:  all passed, except for TBL with ghgrmp

edinburgh/pgi: all passed, except for TBL with ghgrmp

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: Test with ghgrmp where changed for better column data
                                  testing.  This causes TBLs for these tests to fail.

===============================================================
===============================================================

Tag name: cam5_1_09
Originator(s): Edwards
Date: 09-27-2011
One-line Summary:  Add radiation_scheme string

Purpose of changes: Memory usage reduction for cam5

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: 

Describe any changes made to the namelist:  Added variable
	radiation_scheme with allowed values 'rrtmg' and 'camrt'

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
        Memory reduction when using rrtmg since these 4D camrt variables were allocated but not required.
	
Code reviewed by: Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
               bld/namelist_files/namelist_defaults_cam.xml
               bld/namelist_files/namelist_definition.xml
               bld/build-namelist
               physics/cam/phys_control.F90
               physics/cam/radae.F90
                  Add support for radiation_scheme variable, allocate 4D structures only 
	           for camrt radiation
        
	       physics/rrtmg/radiation.F90
                  Remove unnessasary use of radae

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All pass

edinburgh/lf95:  All pass 

edinburgh/pgi or jaguar/pgi:  All pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_08
Originator(s): Francis Vitt
Date: 21 Sep 2011
One-line Summary: Misc bug fixes

Purpose of changes:

  Bug fixes include :

   - correction to O3 chemical loss rate diagnostic
   - fixed a restart problem that occurs when empty_htapes=.true. in waccm configurations
   - corrections to time-averaging history output
   - correction to sathist output of dynamics decomposed variables on the HOMME grid
   - replaced "physconst, only: amass => mwdry" with "physconst, only: mwdry" in several 
     chemistry modules to appease the PGI 9.3 compiler

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/cam4_bam_radpsv_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
M       models/atm/cam/bld/namelist_files/use_cases/cam4_chem_radpsv_geos5.xml
 - the first meteorology data file contains one month of data so that
   one can run more than one day with data which is downloaded from the 
   subversion inputdata repository

M       models/atm/cam/test/system/nl_files/sat_hist
 - include more output fields for more thorough tests of sat_hist and
   local-time averaging outputs

M       models/atm/cam/src/control/cam_history_buffers.F90
 - corrections to local-time averaging accumulation

M       models/atm/cam/src/control/sat_hist.F90
 - correction to column output of dynamics decomposed variables on the HOMME grid
 - moved dyn_find_col subroutine code to the dyn_grid module

M       models/atm/cam/src/control/cam_history.F90
 - fixed a restart problem that occurs when empty_htapes=.true. in waccm configurations
 - corrected the buffer allocations for time-averaging output
 - corrected the h_normalize subroutine for time-averaging output buffer

M       models/atm/cam/src/physics/cam/hb_diff.F90
 - correction to the TKE diagnostic so that it will be the same for different
   MPI configurations

M       models/atm/cam/src/dynamics/sld/dyn_grid.F90
M       models/atm/cam/src/dynamics/eul/dyn_grid.F90
M       models/atm/cam/src/dynamics/homme/dyn_grid.F90
M       models/atm/cam/src/dynamics/fv/dyn_grid.F90
 - added untility methods to find column nearest a specified coordinate and
   determine coordinates of a specified element (or lat slice), which 
   are used in sat_hist and local-time averaging history features.

M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
 - replace WACCM_GHG and WACCM_MOZART cppdefs with WACCM_PHYS

M       models/atm/cam/src/chemistry/pp_none/chem_mods.F90
 - change nabscol from 0 to 2 so that arrays are not declared to have zero size

M       models/atm/cam/src/chemistry/mozart/mo_photo.F90
 - declare do_diag variable that is needed when DEBUG is true

M       models/atm/cam/src/chemistry/mozart/linoz_data.F90
M       models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M       models/atm/cam/src/chemistry/utils/prescribed_aero.F90
M       models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
M       models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
M       models/atm/cam/src/chemistry/utils/aircraft_emit.F90
M       models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
M       models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M       models/atm/cam/src/physics/waccm/waccm_forcing.F90
 - replaced "physconst, only: amass => mwdry" with "physconst, only: mwdry"
   to appease the PGI 9.3 compiler

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - update to the chemistry preprocessor to correct O3 loss rate diagnostic and 
   include missing r8 kind specifiers

M       models/atm/cam/src/chemistry/pp_waccm_ghg/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_mozart/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_none/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_mam3/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_bam/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_mam7/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_trop_ghg/mo_imp_sol.F90
M       models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_imp_sol.F90
 - correction to O3 loss rate diagnostic
 - include missing "r8" kind specifier

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All pass

edinburgh/lf95: 
043 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Tue Sep 20 15:24:14 MDT 2011
 This failure is expected do the corrections in local-time averaging history output.

edinburgh/pgi: 
052 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL! rc= 5 at Tue Sep 20 11:20:45 MDT 2011
 The base-line code (cam5_1_07) did not successfully compile with PGI 9.3 
 It was noted in tag cam5_1_06 that this did compile after several attempts.
 Several attempts were made here without success.  The mwdry changes to the
 chemistry modes, as noted above, should remedy this problem.
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_07
Originator(s): jedwards
Date: 9-19-2011
One-line Summary: correct cam.cpl7.template for backward compatibility

Purpose of changes: Correct problems with cam restart file names in 
	branch runs.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Feddema

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
       models/atm/cam/bld/cam.cpl7.template 
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

   This file does not affect any cam standalone tests, it is only used in
   the cesm build.   Pretag testing was done in the CESM test suite
   using  cesm1_1_alpha02g

===============================================================
===============================================================

Tag name: cam5_1_06
Originator(s): Levy, Mirin, Taylor, Garcia, Edwards, Feddema
Date: 9-1-2011
One-line Summary: CAM-SE dycore update

Purpose of changes: Merge latest SE dycore development into CAM

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: 
	Made NETCDF 4.1.3_seq default on bluefire
	Made PGI 9.3 pgf95 default on edinburgh

Describe any changes made to the namelist:
	updated default settings for a number of dycore specific fields.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Jedwards, Mtaylor

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
          models/atm/cam/tools/interpic_new/README - refined instructions for interpolating to CAM-SE initial file.

	  models/atm/cam/bld/configure - added code to link libnetcdff.a if it is found in the nc_lib directory
          models/atm/cam/bld/cam.cpl7.template - added code to allow branch runs with restart files from older cam
	                                         versions which use cam2 in the filename instead of cam
	
	  models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
          models/atm/cam/bld/namelist_files/namelist_definition.xml
          models/atm/cam/bld/build-namelist

            Added some cam-se specific namelist variables.  Changes some default values. 

	  models/atm/cam/test/system/test_driver.sh
	    
	    Changed default netcdf for bluefire and PGI for edinburgh

	  models/atm/cam/test/system/TSC.sh
	  
	    ncdump no longer accepts more than one file on the command line, changed this test
	    to look at one file at a time.
	
          models/atm/cam/SVN_EXTERNAl_DIRECTORIES
	   
	    Update cam-se external pointer
          models/atm/cam/doc/ChangeLog
	
          models/atm/cam/src/physics/cam/cam_diagnostics.F90

	  Added 3 new diagnostic fields:
	  Z1000
	  PREC_pcw (precip due to prognostic cloud water)
	  PREC_zmc (Precip duc to ZM convective scheme)
	
          models/atm/cam/src/dynamics/homme/pmgrid.F90
          models/atm/cam/src/dynamics/homme/dyn_grid.F90
          models/atm/cam/src/dynamics/homme/interp_mod.F90
          models/atm/cam/src/dynamics/homme/native_mapping.F90
          models/atm/cam/src/dynamics/homme/dyn_comp.F90
          models/atm/cam/src/dynamics/homme/inidat.F90
          models/atm/cam/src/dynamics/homme/stepon.F90
          models/atm/cam/src/dynamics/homme/restart_dynamics.F90

          Bug fixes and updates for compatability with the new cam-se externals
	  Also creates a new HommeMapping.nc file which provides connectivity information
	  for the history grid.

	  models/atm/cam/src/dynamics/homme/share  

	  Latest cam-se dycore code from the HOMME standalone trunk.  Includes the 
	  ability to run on non-uniform (telescoping) grids.
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All pass except:
                 063 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL
	         066 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL
edinburgh/lf95: All pass

edinburgh/pgi or jaguar/pgi:  All pass except: 
	         052 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL

	(Note that test 050 sm734 TSM.sh hn16c5aqdm had problems building on edinburgh, these problems
	 seem to be compiler or system related - the build completed and tests passed after repeated attempts,
	this test was also run on lynx with no issues)

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?
   
   All differences are in the CAM-SE dycore, we do not yet have a baseline climate established for this dycore.
	
If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_1_05 
Originator(s): mvertens, fischer, eaton
Date: Wed Aug 31 2011
One-line Summary: Add multi instance support, replace cam2 with cam in
                  history file names, update externals

Purpose of changes:
.  Add multi instance support for cesm.
.  Replace cam2 with cam in history file names. Fix tests to handle
   the file name changes.
.  Modifications to mkDepends to relax the restrictions on 
   source file name matching module name and only one module per source 
   file.
.  Update to current externals

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
.  configure needed to be changed to set the number of instances 
   for each component.  This is needed for cam stand alone, the 
   CESM scripts were setting these values.
.  configure was also updated to work with the newest pio and mct tags
.  mkDepends was modified to relax the restrictions on source file
   name matching module

Describe any changes made to the namelist:
.  vect_map was added to the nameslists and set to cart3d for homme.
   The new driver tag was setting this to a default of npfix, which
   was causing failures.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:
A      models/atm/cam/src/control/cam_instance.F90
.  Initializes  instance variables inst_name, inst_index, inst_suffix

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/TBR.sh
M       models/atm/cam/test/system/TEQ_ccsm.sh
M       models/atm/cam/test/system/TER_ccsm.sh
M       models/atm/cam/test/system/TSM_ccsm.sh
M       models/atm/cam/test/system/nl_files/scm_b4b_o1
   Fixed tests to replace cam2 with cam in history files.

M       models/atm/cam/bld/configure
.  Set NUM_COMP_INST_ATM, NUM_COMP_INST_LND, NUM_COMP_INST_OCN, NUM_COMP_INST_ICE
       and NUM_COMP_INST_GLC to 1 for CAM stand alone runs.  This is needed for the
       new driver tag.
.  Updated to work with latest pio and mct tags

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
M       models/atm/cam/bld/build-namelist
.  Add vect_map and set to cart3d for homme.  New driver tag was setting the default
   for vect_map to npfix

M       models/atm/cam/bld/mkDepends
.  Modifications to relax the restrictions on source file name matching module name 
   and only one module per source file.  Also added a new "-d objfile" option which 
   allows an additional object file to be added to every dependence.

M       models/atm/cam/bld/cam.cpl7.template
M       models/atm/cam/src/control/runtime_opts.F90
M       models/atm/cam/src/control/sat_hist.F90
M       models/atm/cam/src/control/cam_restart.F90
M       models/atm/cam/src/control/cam_comp.F90
M       models/atm/cam/src/control/cam_history.F90
M       models/atm/cam/src/utils/cam_pio_utils.F90
M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M       models/atm/cam/src/physics/cam/restart_physics.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_mct.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
.  Changes made for multi-instance support.  Replace cam2 with cam
   in history filenames


M       SVN_EXTERNAL_DIRECTORIES
.  Updated externals.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
073 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Fri Aug 19 11:30:01 MDT 2011
.   E compset was updated in the CESM1 scripts
.   all other passed, expect for baselines because output files were renamed, but still bfb

edinburgh/lf95:  all passed, expect for baselines becuase output files were renamed, but still bfb

edinburgh/pgi: all passed , expect for baselines because output files were renamed, but still bfb

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.:  All baseline tests will fail
because history file names where change from having cam2 to cam.  However,
this tag is still bfb with the previous.

===============================================================
===============================================================
Tag name: cam5_1_04 
Originator(s): fischer, eaton jedwards
Date: 8 Aug 2011
One-line Summary: Fix cloud diagnostics, and remove unused allocate

Purpose of changes:

.   Bugfix for the diagnostic output fields CLDLIQSTR and CLDICESTR.  The
    previous version was based on state values that did not contain the
    tendencies from the macrophysics package.

.   Allocate statement in mo_drydep.F90 not used and was removed.  It could
    have caused problems with UNSTRUCTURED grids since the nlon_veg and nlat_veg
    variables are not defined in that case.


Bugs fixed (include bugzilla ID): #1386

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/src/physics/cam/macrop_driver.F90
.   Bugfix for the diagnostic output fields CLDLIQSTR and CLDICESTR.  The
    previous version was based on state values that did not contain the
    tendencies from the macrophysics package.

M       models/atm/cam/src/chemistry/mozart/mo_drydep.F90
.   The allocate statement at line 1861 is not used and was removed. It 
    could have caused problems with UNSTRUCTURED grids since the nlon_veg and 
    nlat_veg variables are not defined in that case.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all passed

edinburgh/lf95: all passed

edinburgh/pgi: all passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.: all bfb

===============================================================
===============================================================

Tag name: cam5_1_03
Originator(s): Francis Vitt
Date:  1 Aug 2011
One-line Summary: Extension of the prescribed aerosol reading capabilities.

Purpose of changes:
 The prescribed aerosol data modules were extended to be able to read in modal 
 aerosol concentrations and aerosol deposition fluxes.  This was done to facilitate 
 development of prescribed Modal Aerosol Model configurations.

Bugs fixed (include bugzilla ID):
 Missing namelist declaration of drydep_srf_file for chem_inparm in chemistry.F90 (1377)

Describe any changes made to build system:

Describe any changes made to the namelist:
 New namelist variable added: "prescribed_aero_model"
 Switch used to indicate which type of aerosols are prescribed -- bulk or modal.
 This is used to set the default prescribed_aero_specifier and aerodep_flx_specifier
 namelist variables.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

D     models/atm/cam/src/chemistry/modal_aero/modal_aero_deposition.F90
- this was moved to models/atm/cam/src/chemistry/utils
	
List all subroutines added and what they do:

A     models/atm/cam/src/chemistry/utils/modal_aero_deposition.F90
 - moved here so that it can be used when modal aerosols are not prognosed
 - modified init method so the the indices can be specified when modal aerosols are not prognosed

List all existing files that have been modified, and describe the changes:

M     models/atm/cam/bld/build-namelist
 - modified to set default aerodep_flx_specifier and prescribed_aero_specifier
   according to the new "prescribed_aero_model" namelist variable which can be
   "bulk" or "modal"

M     models/atm/cam/bld/namelist_files/namelist_definition.xml
 - new "prescribed_aero_model" namelist variable added
 - rewrite of the "prescribed_aero_specifier" namelist description
 - corrections to the "type" entries of prescribed_aero_specifier and aerodep_flx_specifier
   namelsit variables

M     models/atm/cam/src/physics/cam/advnce.F90
 - pass pbuf to prescribed data modules

M     models/atm/cam/src/physics/waccm/waccm_forcing.F90
M     models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M     models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
 - remove reference to fields%chnk_offset 

M     models/atm/cam/src/chemistry/utils/aerodep_flx.F90
 - Expanded to accommodate prescribed modal aerosol deposition fluxes.

M     models/atm/cam/src/chemistry/utils/prescribed_aero.F90
 - This has be generalized to read any prescribed field from datasets
   and store them in the physics buffer.  The units convertion feature 
   has been removed

M     models/atm/cam/src/chemistry/utils/tracer_data.F90
 - now can handle 2D fields that are stored in files that have lev dimension
 - no longer store pointer to pbuf locations but store pbuf indices for pbuf fields

M     models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
M     models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
M     models/atm/cam/src/chemistry/utils/aircraft_emit.F90
M     models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
M     models/atm/cam/src/chemistry/mozart/linoz_data.F90
 - pbuf is now passed into the adv method and operates on the pbuf field 
   using the stored pbuf indices rather the stored pbuf pointers
	
M     models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
 - check for prescribed aero dep fluxes before invoking the modal_aero_deposition_init 
   routine

M     models/atm/cam/src/chemistry/mozart/chemistry.F90
 - restored namelist declaration of drydep_srf_file for chem_inparm
 - check for prescribed aero dep fluxes before setting the cam_out fluxes to the 
   prognosed deposition fluxes
	
M     models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M     models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
 - check for prescribed aero dep fluxes before setting the cam_out fluxes to the 
   prognosed deposition fluxes

M     models/atm/cam/src/chemistry/mozart/mo_tgcm_ubc.F90
 - removed redundant "save"

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All Pass

edinburgh/lf95: All Pass

edinburgh/pgi: All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_1_02 
Originator(s): mirin, fischer, eaton
Date: Fri Jun 17 2011
One-line Summary: Implement reference pressure module.

Purpose of changes:
. The physics/chemistry parameterizations only need vertical level
  locations expressed as pressures.  In many places the hybrid coefficients
  were being used to directly compute reference pressures (assuming a
  surface reference pressure of 1e5 Pa).  Since future dycores may use
  different types of vertical coordinates we needed to remove any direct
  access to the hybrid coefficients.  A new reference pressure module
  (ref_pres) has been implemented and all direct references to the hybrid
  coefficients in the physics/chemistry code have been refactored to use
  this module.  Currently the physics is operating on the grid defined by
  the dynamics, so each dycore must supply a subroutine (in dyn_grid) which
  provides the reference pressures.  The ref_pres module calls this
  subroutine during initialization to set the reference pressures.

. Do some refactoring of the initialization sequence to move where the
  hybrid coefficients are read from dycore independent places to dycore
  dependent places.

. Update documentation in namelist_definition.xml (descriptions of
  variables and categories).

. Update test lists for bluefire

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
. Update documentation in namelist_definition.xml (descriptions of
  variables and categories).

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/control/hycoef.F90
. file moved to src/utils/

models/atm/cam/src/physics/cam/cldconst.F90
models/atm/cam/src/physics/cam/cldinti.F90
. code consolidated and moved to cloud_fraction.F90


List all subroutines added and what they do:

models/atm/cam/src/physics/cam/ref_pres.F90
. new module to provide access to the reference pressures

models/atm/cam/src/utils/hycoef.F90
. file moved here from src/control/

models/atm/cam/test/system/config_files/f1.9c4cm
models/atm/cam/test/system/config_files/f1.9c5cm
. created new 2deg COSP test with debug turned off

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
. change actual arg to set_ub_col from ps to pint(:,1).  This is because
  the top interface pressure was being calculated using ps and hybrid coefs.

models/atm/cam/src/control/cam_restart.F90
. remove reading of the hybrid coefs from this dycore independent spot.
  Moved to the dycore dependent read_restart_dynamics methods.
. add call to initialize the reference pressures before the physics restart
  is read.

models/atm/cam/src/control/readinitial.F90
. remove the call that reads the hybrid coefs from the initial file (and
  all associated error checks).  This is moved to dycore specific dyn_init
  methods. 
. remove a bunch of unused local variable declarations

models/atm/cam/src/control/startup_initialconds.F90
. remove unused 'include netcdf.inc'

models/atm/cam/src/dynamics/eul/dyn_comp.F90
models/atm/cam/src/dynamics/fv/dyn_comp.F90
models/atm/cam/src/dynamics/homme/dyn_comp.F90
models/atm/cam/src/dynamics/sld/dyn_comp.F90
. add file handle dummy arg to dyn_init method
. call hycoef_init to read and initialize hybrid coefs

models/atm/cam/src/dynamics/eul/dyn_grid.F90
models/atm/cam/src/dynamics/fv/dyn_grid.F90
models/atm/cam/src/dynamics/homme/dyn_grid.F90
models/atm/cam/src/dynamics/sld/dyn_grid.F90
. add dyn_grid_get_pref method.  This is to allow the dycore to supply the
  reference pressures to the physics.

models/atm/cam/src/dynamics/eul/inital.F90
models/atm/cam/src/dynamics/fv/inital.F90
models/atm/cam/src/dynamics/homme/inital.F90
models/atm/cam/src/dynamics/sld/inital.F90
. add file handle to dyn_init calling args
. call ref_pres_init before call to read initial_conds

models/atm/cam/src/dynamics/eul/initcom.F90
models/atm/cam/src/dynamics/fv/initcom.F90
models/atm/cam/src/dynamics/sld/initcom.F90
. remove call to hycoef_init.  moved to dyn_init

models/atm/cam/src/dynamics/eul/restart_dynamics.F90
models/atm/cam/src/dynamics/fv/restart_dynamics.F90
models/atm/cam/src/dynamics/homme/restart_dynamics.F90
models/atm/cam/src/dynamics/sld/restart_dynamics.F90
. call init_restart_hycoef from init_restart_dynamics -- vdimids is now
  local and can be removed from init_restart_dynamics args
. call write_restart_hycoef from write_restart_dynamics
. in read_restart_dynamcis add file handle to dyn_init calling args

models/atm/cam/src/physics/cam/cloud_fraction.F90
. put code from cldinti into cldfrc_init

models/atm/cam/src/physics/cam/eddy_diff.F90
. init_eddy_diff -- remove unused pref_mid dummy arg
. replace 'stop' by endrun call

models/atm/cam/src/physics/cam/physics_types.F90
. remove redundant calculation of psdry and pintdry

models/atm/cam/src/physics/cam/physpkg.F90
. change actual args from hyp* to pref_*
. remove call to cldinti -- code moved to cldfrc_init

models/atm/cam/src/physics/cam/uw_conv.F90
. replace a 'stop' by call endrun


models/atm/cam/src/chemistry/mozart/mo_aurora.F90
models/atm/cam/src/chemistry/mozart/mo_photo.F90
models/atm/cam/src/chemistry/mozart/mo_sad.F90
models/atm/cam/src/chemistry/mozart/mo_synoz.F90
models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
models/atm/cam/src/chemistry/utils/mo_msis_ubc.F90
models/atm/cam/src/chemistry/utils/tracer_data.F90
models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_photo.F90
models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sad.F90
models/atm/cam/src/physics/cam/boundarydata.F90
models/atm/cam/src/physics/cam/cldwat.F90
models/atm/cam/src/physics/cam/radae.F90
models/atm/cam/src/physics/cam/tphysidl.F90
models/atm/cam/src/physics/cam/tracers_suite.F90
models/atm/cam/src/physics/cam/vertical_diffusion.F90
models/atm/cam/src/physics/rrtmg/radlw.F90
models/atm/cam/src/physics/waccm/gravity_waves_sources.F90
models/atm/cam/src/physics/waccm/qbo.F90
. replace use of hycoef module by use of ref_pres

models/atm/cam/src/physics/cam/convect_deep.F90
models/atm/cam/src/physics/cam/convect_shallow.F90
models/atm/cam/src/physics/cam/gw_drag.F90
models/atm/cam/src/physics/cam/hb_diff.F90
models/atm/cam/src/physics/cam/radheat.F90
models/atm/cam/src/physics/cam/zm_conv_intr.F90
models/atm/cam/src/physics/waccm/gw_drag.F90
models/atm/cam/src/physics/waccm/iondrag.F90
models/atm/cam/src/physics/waccm/nlte_lw.F90
models/atm/cam/src/physics/waccm/radheat.F90
. change dummy args from hyp* to pref_*

models/atm/cam/test/system/input_tests_master
models/atm/cam/test/system/tests_posttag_bluefire
. Turned off debugging for COSP CAM5 2deg test

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all passed  

edinburgh/lf95:  all passed

edinburgh/pgi: all passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.: 2deg COSP baseline tests will fail
because debugging was turned off in the test.  Everything is bfb

===============================================================
===============================================================

Tag name: cam5_1_01
Originator(s): eaton, fvitt, fischer
Date: Mon May 30 18:24:32 MDT 2011
One-line Summary: enable 1/4 deg FV cam5, chemistry bug fixes

Purpose of changes:

. Enable 1/4 deg FV cam5 to run out of the box.  This required a code mod
  to the interpolation of the landuse map in the dry deposition code used
  by the modal aerosols, and providing an appropriate initial file.
. corrected O1D + CCL4 -> 4*CL reaction in the waccm_mozart_v1 mechanism
. removed reference to solar_parms_file from cam4_trop_strat_chem use_case

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. add default IC file for 1/4 deg FV cam5.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/chemistry/mozart/mo_drydep.F90
. subroutine interp_map -- clamp the values of fraction_landuse between 0
  and 1.  This replaces a check for out of range values which then
  triggered a call to endrun.

models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.in
. added comment

models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_prod_loss.F90
models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_lin_matrix.F90
models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.doc
models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.in
. corrected O1D + CCL4 -> 4*CL reaction in the waccm_mozart_v1 mechanism
. added comment to chem_mech.in

models/atm/cam/bld/namelist_files/use_cases/cam4_trop_strat_chem.xml
. removed reference to solar_parms_file (waccm input file) 


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_1_00 
Originator(s): fvitt, fischer, jedwards 
Date: 
One-line Summary: chemistry corrections, new homme ncdata file 

Purpose of changes:
 - chemistry preprocessor update -- adjust the write format to *.doc output
   files to allow negative values in the "troe" reactions
 - correction to pp_trop_mozart document file resulting from the above preprocessor change
 - numerous corrections to the chem reactions in trop_strat_bam_v1 package
 - corrected the reaction: O1D + CCL4 -> 4*CL 
 - correction to pp_waccm_mozart_v1 document file resulting from the above preprocessor change
 - new homme dycor ne240np4 1850 ncdata file
 - add output needed for radition driver

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
-<ncdata dyn="homme" hgrid="ne240np4" nlev="26"             ic_ymd="101" >atm/cam/inic/homme/cami_0002-01-01_ne240np4_L26_c100522.nc</ncdata>
+<ncdata dyn="homme" hgrid="ne240np4" nlev="26"             ic_ymd="101" >atm/cam/inic/homme/cami_1850-01-01_ne240np4_L26_c110314.nc</ncdata>


List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M       bld/namelist_files/namelist_defaults_cam.xml
 - new homme dycor ne240np4 1850 ncdata file

M       models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - chemistry preprocessor update -- adjust the write format to *.doc output
   files to allow negative values in the "troe" reactions

M       models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.doc
 - correction to this document file resulting from the above preprocessor change

M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lu_solve.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_setrxt.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_adjrxt.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mods.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_prod_loss.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/m_rxt_id.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_nln_matrix.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lu_factor.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_sim_dat.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_indprd.F90
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mech.doc
M       models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mech.in
 - numerous corrections to the chem reactions in trop_strat_bam_v1 package

M       models/atm/cam/src/chemistry/pp_waccm_mozart/mo_prod_loss.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/mo_lin_matrix.F90
M       models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.doc
M       models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.in
 - corrected the reaction: O1D + CCL4 -> 4*CL 

M       models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.doc
 - correction to this document file resulting from the above preprocessor change

M       models/atm/cam/src/physics/cam/radiation_data.F90
 - add output needed for radition driver

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
all passed

edinburgh/lf95: 
all passed

edinburgh/pgi: 
all passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: all bfb

===============================================================
===============================================================

Tag name: cam5_0_57 
Originator(s):  fischer, eaton, hannay, fvitt, andrew
Date: Tue May 17 13:57:22 MDT 2011
One-line Summary: CAM5.1 tuning, CAM5 default output updates, bug fixes

Purpose of changes:
. CAM5.1 2 degree tuning, new values for uwshcu_rpen and rhminl
. CAM5 default outputs added
. NEU Chemistry bug fixes
. Micro physics bug fixes from Andrew Gettelman
. Modify build-namelist to produce default FV decomposition settings
  (npr_yz).  This functionality was previously embedded in the CESM scripts
  and was not available to user's of CAM standalone scripts.
. Change dataroot for lynx testing
 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
. build-namelist has a new argument, -ntasks, which is used to set a
  default value for the FV decomposition.  The user can always override
  this default by explicitly setting npr_yz.

Describe any changes made to the namelist:
. uwshcu_rpen was added to the namelist for CAM5.
  Default value is 10.0
  At 2deg the value is 5.0, this changes answers
. rhminl was set the .8875 for 2deg CAM5, this changes answers

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:
. uwshcu_readnl was added to models/atm/cam/src/physics/cam/uwshcu.F90
  uwshcu_readnl reads the namelist variable uwshcu_rpen  

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add fv_decomp_set method used to set default FV decomp when new -ntasks
  arg is set and the user hasn't already explicitly set it (npr_yz).
. add namelist variable uwshcu_rpen

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add namelist variable uwshcu_rpen for CAM5 and set default to 10.0
  uwshcu_rpen is set to 5.0 when resoltion is 2 degree
. set cldfrc_rhminl to  .8875 for 2 degree CAM5

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add uwshcu_repn definition
  uwshcu_rpen - For penetrative entrainment efficiency

models/atm/cam/src/control/runtime_opts.F90
. add call to uwshcu_readnl to read in uwshcu_rpen

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. set cldfrc_rhminl to .8875 for 2 degree CAM5
. set uwshcu_rpen to 5.0 for 2 degree CAM5 and set default to 10

models/atm/cam/src/physics/cam/uwshcu.F90
. add routine uwshcu_readnl to set uwshcu_rpen
. add error checking to see if uwshcu_rpen is set

models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
. bug fix prevent overwriting of tendencies set by mo_neu_wetdep

models/atm/cam/src/chemistry/mozart/mo_neu_wetdep.F90
. turn off debug print statements

models/atm/cam/src/physics/cam/cldwat2m_micro.F90
models/atm/cam/src/physics/cam/macrop_driver.F90
. micro physics bug fixes from Andrew Gettelman

models/atm/cam/src/physics/cam/microp_driver.F90
. comment fix from Andrew Gettelman

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. T700, T850, ATMEINT added to default output

models/atm/cam/src/physics/rrtmg/radiation.F90
models/atm/cam/src/physics/rrtmg/radiation.F90
. TOT_CLD_VISTAU and TOT_ICLD_VISTAU added to default output 

models/atm/cam/src/physics/cam/microp_aero.F90
. CCN3 added to default output

odels/atm/cam/test/system/test_driver.sh
. set dataroot to /glade/proj3/cseg/inputdata for lynx

SVN_EXTERNAL_DIRECTORIES
. update clm tag to clm4_0_31
. update scripts tag to scripts4_110513


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Tue May 17 13:23:40 MDT 2011
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue May 17 14:16:19 MDT 2011
.  New CAM5 tunings for uwshcu_rpen and cldfrc_rhminl cause the baseline tests to fail

edinburgh/lf95: 
all passed

edinburgh/pgi : 
all passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: CAM5 at 2 degree will have answer changes due to
new tuning values for cldfrc_rhminl and uwshcu_rpen

===============================================================
===============================================================

Tag name: cam5_0_56
Originator(s):  fischer, eaton
Date: Thu May 12 12:24:30 MDT 2011
One-line Summary: update component svn externals

Purpose of changes: 
.  update component svn externals

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:
-<fpftcon>lnd/clm2/pftdata/pft-physiology.c101006.nc</fpftcon>
+<fpftcon>lnd/clm2/pftdata/pft-physiology.c110425.nc</fpftcon>
.  Update

+<finidat hgrid="48x96"     ic_ymd="101" sim_year="2000">lnd/clm2/initdata/clmi.BCN_0051-01-01_48x96_gx3v7_simyr2000_c110509.nc</finidat>
+<finidat hgrid="48x96"     ic_ymd="101" sim_year="1850">lnd/clm2/initdata/clmi.BCN.1850-01-01_48x96_gx3v7_simyr1850_c110421.nc</finidat>
+<fsurdat hgrid="512x1024"  sim_year="1850">lnd/clm2/surfdata/surfdata_512x1024_simyr1850_c100315.nc</fsurdat>
+<fpftdyn hgrid="48x96"         sim_year="1850-2000" >lnd/clm2/surfdata/surfdata.pftdyn_48x96_hist_simyr1850-2005_c110114.nc</fpftdyn>
+<fpftdyn hgrid="0.9x1.25"      rcp="6"  sim_year="1850-2100" >lnd/clm2/surfdata/surfdata.pftdyn_0.9x1.25_rcp6.0_simyr1850-2100_c100812.nc</fpftdyn>
+<fpftdyn hgrid="1.9x2.5"       rcp="6"  sim_year="1850-2100" >lnd/clm2/surfdata/surfdata.pftdyn_1.9x2.5_rcp6.0_simyr1850-2100_c100813.nc</fpftdyn>
+<fpftdyn hgrid="10x15"         rcp="6"  sim_year="1850-2100" >lnd/clm2/surfdata/surfdata.pftdyn_10x15_rcp6.0_simyr1850-2100_c100901.nc</fpftdyn>
.  Added

-<fsurdat hgrid="48x96"     sim_year="2000">lnd/clm2/surfdata/surfdata_48x96_simyr2000_c090928.nc</fsurdat>
+<fsurdat hgrid="48x96"     sim_year="2000">lnd/clm2/surfdata/surfdata_48x96_simyr2000_c100505.nc</fsurdat>
-<fsurdat hgrid="48x96"     sim_year="1850">lnd/clm2/surfdata/surfdata_48x96_simyr1850_c090928.nc</fsurdat>
+<fsurdat hgrid="48x96"     sim_year="1850">lnd/clm2/surfdata/surfdata_48x96_simyr1850_c110114.nc</fsurdat>
-<fsurdat hgrid="0.47x0.63" sim_year="1850">lnd/clm2/surfdata/surfdata_0.47x0.63_simyr1850_c100305.nc</fsurdat>
+<fsurdat hgrid="0.47x0.63" sim_year="1850">lnd/clm2/surfdata/surfdata_0.47x0.63_simyr1850_c100826.nc</fsurdat>
-<fpftdyn hgrid="0.9x1.25"      rcp="8.5" sim_year="1850-2100" >lnd/clm2/surfdata/surfdata.pftdyn_0.9x1.25_rcp8.5_simyr1850-2100_c100205.nc</fpftdyn>
+<fpftdyn hgrid="0.9x1.25"      rcp="8.5" sim_year="1850-2100" >lnd/clm2/surfdata/surfdata.pftdyn_0.9x1.25_rcp8.5_simyr1850-2100_c100319.nc</fpftdyn>
.  Changed

-<fpftdyn hgrid="0.9x1.25"      rcp="8.5" sim_year="2000-2100" >lnd/clm2/surfdata/surfdata.pftdyn_0.9x1.25_rcp8.5_simyr1850-2100_c100205.nc</fpftdyn>
-<fpftdyn hgrid="0.9x1.25"      rcp="4.5" sim_year="2000-2100" >lnd/clm2/surfdata/surfdata.pftdyn_0.9x1.25_rcp4.5_simyr1850-2100_c100406.nc</fpftdyn>
-<fpftdyn hgrid="0.9x1.25"      rcp="2.6" sim_year="2000-2100" >lnd/clm2/surfdata/surfdata.pftdyn_0.9x1.25_rcp2.6_simyr1850-2100_c100323.nc</fpftdyn>
.  Removed

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
.  Updated fsurdat, fptfcon, and finidat to match clm4_0_29
.  Added rcp6.0 fpftdyn
.  Removed extra > at line 249
.  Removed RCP 2000-2100 fpftdyn

SVN_EXTERNAL_DIRECTORIES
.  Updated all externals to match cesm1_0_beta20


SVN_EXTERNAL_DIRECTORIES

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Wed May 11 16:36:52 MDT 2011
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed May 11 16:59:47 MDT 2011
.   bl132 and bl137 failed because spun-up data is being used now

072 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Sat May  7 12:17:46 MDT 2011
.   bl992 failed because of updated drv tag

edinburgh/lf95: 
all passed

edinburgh/pgi: 
all passed 

CAM tag used for the baseline comparison tests if different than previous 
tag: 

Summarize any changes to answers, i.e.:  bfb except for: ccsm tests, and T31.

===============================================================
===============================================================

Tag name: cam5_0_55 
Originator(s): jenkay, eaton, fischer
Date: 5 May 2011

One-line Summary: Fixes for COSP, reduce CAM5 default output. 

Purpose of changes:
. Mods in modis simulator to workaround an xlf compiler problem.
. Modify both CAM standalone and CESM builds to allow modis simulator to
  use the abortutils module instead of calling stop.
. Move some 'add_default' calls for CAM5 diagnostic fields inside conditionals.
. Update to 110505 COSP external

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
. Add abortutils dependency so cosp code can make use of subroutine endrun.
  $(COSP_LIBDIR)/libcosp.a: abortutils.o

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. update to the 110505 COSP external

models/atm/cam/bld/Makefile.in
models/atm/cam/bld/configure
. mods to allow cosp to use associate CAM's abortutils module

models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
models/atm/cam/src/chemistry/modal_aero/modal_aero_calcsize.F90
models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
models/atm/cam/src/physics/cam/aer_rad_props.F90
models/atm/cam/src/physics/cam/ndrop.F90
models/atm/cam/src/physics/cam/vertical_diffusion.F90
. remove some 'add_default' calls for CAM5 diagnostic fields.  Many
  add_default calls for modal aerosols were moved inside conditionals that
  are turned on using the history_aerosol namelist variable.

models/atm/cam/src/physics/cam/cospsimulator_intr.F90
. fix long_name in some addfld calls
. fix bug in output fields clhmodis, clmmodis, cllmodis
. changes in cloud fraction weighting code


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
015 br381 TBR.sh f1.9c4cdm outfrq3s+1850-2005_cam4 6+3s ...................FAIL! rc= 12 at Thu May  5 00:05:32 MDT 2011
016 bl381 TBL.sh f1.9c4cdm outfrq3s+1850-2005_cam4 9s .....................FAIL! rc= 5 at Thu May  5 00:11:40 MDT 2011
019 br382 TBR.sh f1.9c5cdm outfrq3s+1850-2005_cam5 6+3s ...................FAIL! rc= 12 at Thu May  5 01:37:03 MDT 2011
020 bl382 TBL.sh f1.9c5cdm outfrq3s+1850-2005_cam5 9s .....................FAIL! rc= 5 at Thu May  5 01:45:22 MDT 2011
  Branch tests failed due to changing task geometry, when keeping the task geometry consistent the branch tests passed
  Baselines for COSP are expected to fail

edinburgh/lf95: 
all passed

edinburgh/pgi: 
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu May  5 13:45:00 MDT 2011
  Baselines for COSP are expected to fail

CAM tag used for the baseline comparison tests if different than previous
tag:cam5_0_54

Summarize any changes to answers: BFB except for COSP diagnostic output


===============================================================
===============================================================

Tag name: cam5_0_54
Originator(s): Francis Vitt
Date: 27 Apr 2011
One-line Summary: New chemistry features and minor corrections to trop_mozart reactions.
 
Purpose of changes:

 - provide an additional optional wet deposition method for gas phase chemical species
 - include short wavelength photolysis in tropospheric chemistry
 - new treatment of WACCM stratospheric aerosols 
 - new chemistry package added : trop_strat_bam_v1
 - adjustments to the trop_mozart chemistry mechanism
 - provide dynamic creation of default deposition species lists 
   namelist settings using master lists
 - correction to the wet deposition lists of species for 
   super_fast_llnl, and waccm_mozart
 - correction to the configure options for the offline driver regression test

 Science changes effect (baseline test will fail) these chemistry packages:
   trop_mozart 
    - inclusion of the short wavelength photolysis
    - adjustments to the chemistry mechanism (reaction rates)

   super_fast_llnl
    - correction to the wet deposition list (include CH3OOH)

   waccm_mozart (development version of waccm)
    - correction to the wet deposition list (N2O5 removed from list)
    - new treatment of stratospheric aerosols
	
Bugs fixed (include bugzilla ID): None

Describe any changes made to build system:

Describe any changes made to the namelist:

 namelist variables added
   - gas_wetdep_list
     list of gas phase species that under go wet depostion
   - gas_wetdep_method 
     'MOZ' to select the mozart scheme (default)
     'NEU' to select the 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A    models/atm/cam/bld/namelist_files/use_cases/cam4_trop_strat_chem.xml
 - new use case for F_TROP_STRAT_CHEM compset

A    models/atm/cam/bld/namelist_files/master_aer_wetdep_list.xml
A    models/atm/cam/bld/namelist_files/master_gas_wetdep_list.xml
A    models/atm/cam/bld/namelist_files/master_mam_dep_list.xml
A    models/atm/cam/bld/namelist_files/master_drydep_list.xml
A    models/atm/cam/bld/perl5lib/Build/ChemNamelist.pm
 - sets default depostion species lists namelist variables for the desired
   chemistry mechanism using the above master lists

A    models/atm/cam/src/chemistry/mozart/gas_wetdep_opts.F90
 - reads wet depostion options for gas phase species

A    models/atm/cam/src/chemistry/mozart/mo_neu_wetdep.F90
 - new wet depostion method provided by J Neu 

A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lin_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_trop_strat_bam_v1/chem_mech.in
 - new chem pkg added (133 species, interactive stratosphere and troposphere chem)

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/test/system/config_files/fmo1.9c4dh
 - correction to the configure options for the offline driver test

M    models/atm/cam/bld/configure
 - new chemistry package added 'trop_strat_bam_v1'
 - set $chem_src_dir to $cam_root/.... which is an absolute path so that 
   build-namelist deposition lists generation will function within CESM scripts
 
M    models/atm/cam/bld/config_files/definition.xml
 - new chemistry package added 'trop_strat_bam_v1' (-chem option)

M    models/atm/cam/bld/build-namelist
 - changes for the new trop_strat_bam_v1 chemisty package
 - invokes the ChemNamelist module to generate depostion lists
 - removed the if( $waccm_chem ) clause around the strat_aero_feedback/rad_climate setting

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - default emissions files added for trop_strat_bam_v1

M    models/atm/cam/bld/namelist_files/namelist_definition.xml
 - namelist variables added
   - gas_wetdep_list
     list of gas phase species that under go wet depostion
   - gas_wetdep_method 
     'MOZ' to select the mozart scheme (default)
     'NEU' to select the 

M    models/atm/cam/bld/namelist_files/use_cases/sd_waccm_geos5.xml
M    models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_refb1.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp26.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_1955-2005_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp85.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_1974-2005_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
 - history fields names change related to SAD code changes
   HNO3_CD1 replaced by HNO3_STS and HNO3_CD3 replaced by HNO3_NAT

M    models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - added get_species_list routine and is made public so it can be used by ChemNamelist.pm
 - set the chem_src_dir for customized mechanism
 
M    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - updated chemistry preprocessor

M    models/atm/cam/src/control/sat_hist.F90
 - added a check to avoid an error which occurs when the last observation 
   time is exactly the same as the model time

M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_photo.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sad.F90
 - inteface changes to be constitent with changes in mo_gas_phase_chemdr

M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_setrxt.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_adjrxt.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/m_rxt_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_indprd.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.in
 - changes to chemistry reactions
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 
M    models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - the master lists give a different list of wet dep species so 
   this is not a bit-for-bit change, otherwise it is bit-for-bit

M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_adjrxt.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/m_rxt_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_phtadj.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_indprd.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/m_spc_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_mam3/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/pp_trop_bam/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_adjrxt.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/m_rxt_id.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_phtadj.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_indprd.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/m_spc_id.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_bam/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/pp_trop_ghg/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_ghg/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_ghg/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_ghg/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_trop_ghg/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_ghg/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_trop_ghg/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_waccm_ghg/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mech.doc
M    models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mech.in
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist
 - this is a bit-for-bit change

M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - HNO3_CD1 renamed to HNO3_STS
 - HNO3_CD2 renamed to HNO3_NAT
 - removed HNO3_CD2, SAD_SNAT, RAD_SNAT 
 - added call to neu_wetdep (new wet deposition scheme)

M    models/atm/cam/src/chemistry/mozart/mo_strato_rates.F90
 - chenges to names of variables

M    models/atm/cam/src/chemistry/mozart/mo_chemini.F90
 - call to neu_wetdep_init added

M    models/atm/cam/src/chemistry/mozart/mo_jshort.F90
M    models/atm/cam/src/chemistry/mozart/mo_photo.F90
 - changes to use jshort for low top model if the needed fields are available
   (short wavelength photolsys for CAM-Chem)

M    models/atm/cam/src/chemistry/mozart/mo_sad.F90
 - extensive changes provided by Doug Kinnison
   this is a new treatment of the the WACCM stratospheric aerosols

M    models/atm/cam/src/chemistry/mozart/chemistry.F90
 - call gas_wetdep_readnl added to read wet dep namelist options
 - call to neu_wetdep_tend added

M    models/atm/cam/src/chemistry/mozart/mo_chem_utls.F90
M    models/atm/cam/src/chemistry/mozart/mo_sethet.F90
(N2O5 removed from list) - changed need to specify which species have wet dep with namelist 
   setting
 - chemistry solver includes wash-out loss rates term for all species
   which are set to non-zero for only the gas_wetdep_list namelist

M    models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
 - now uses the gas_wetdep_list to check that none of the gas phase
   species are included in the aerosol wet dep list

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  

033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Tue Apr 26 20:18:43 MDT 2011
  the development version of waccm_mozart (not waccm_mozart_v1) is expected
  to fail due to 
    - correction to the  wet deposition list (N2O5 removed from list)
    - new treatment of stratospheric aerosols

045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Tue Apr 26 21:24:59 MDT 2011
  trop_mozart is expected to fail due to 
    - inclusion of the short wavelength photolysis
    - adjustments to the chemistry mechanism (reaction rates)

050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Tue Apr 26 22:07:42 MDT 2011
  super_fast_llnl  is expected to fail due to correction to the wet deposition list (include CH3OOH)

edinburgh/lf95: All Pass

edinburgh/pgi : All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_53
Originator(s): eaton
Date: Mon Apr 25 14:11:19 MDT 2011
One-line Summary: fix cosp external

Purpose of changes:

. The new cosp external didn't get 'propset' before the last commit.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes: none

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  not done

edinburgh/lf95: not done

edinburgh/pgi or jaguar/pgi: not done

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_52 
Originator(s): fischer, eaton, fvitt, jenkay, tcraig	
Date: 19 April 2011 
One-line Summary: Update COSP, Fix for offline driver, performance fix for modal aerosol, ESMF updates

Purpose of changes:
. Fix performance problem introduced in cam5_0_27 in the modal aerosol
  optics calculation.
. COSP updates,  Includes the mods from LLNL to incorporate the effects of snow and other
  bug fixes. 
. Fix offline driver, add sd_waccm_ghg use case, fix SDBAM.
. ESMF updates from Tony Craig

Bugs fixed (include bugzilla ID):
. Fix for offline driver
. Fix the use case(cam4_bam_radpsv_geos5) used in SDBAM compset 

Describe any changes made to build system:

Describe any changes made to the namelist:
. Added cosp_histfile_aux to the COSP namelist.
       When set to true, additional output is generated.
. Use case cam4_bam_radpsv_geos5.xml changes
       set strat aerosol data cycle year, file, and type
       set ext_frc_type, srf_emis_type, and tracer_cnst_type to SERIAL

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
	CAM5 1deg is ~ 6.5% faster than the previous tag.
	previous tag  .902 hrs for a 1deg 10 day run
	cam5_0_52     .842 hrs for a 1deg 10 day run

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:
A      bld/namelist_files/use_cases/sd_waccm_geos5.xml
A      bld/namelist_files/use_cases/waccm_sc_2000_cam4.xml
. New WACCM use cases from fvitt

A      test/system/config_files/f1.9c4cdm
A      test/system/config_files/f1.9c5cdm
.  created 2deg COSP tests

List all existing files that have been modified, and describe the changes:
M      test/system/input_tests_master
M      test/system/tests_posttag_bluefire
.  added 2deg COSP tests to bluefire post-tag tests

M      test/system/nl_files/off1.9x2.5
.  changed start_ymd, met_data_file
.  set bnd_topo, and ncdata

M    src/utils/time_manager.F90
M    src/cpl_esmf/atm_comp_mct.F90
M    src/cpl_esmf/atm_comp_esmf.F90
.  ESMF updates from Tony Craig

M      models/atm/cam/bld/namelist_files/namelist_definition.xml
.  added cosp_histfile_aux and cosp_histfile_aux_num to the namelist

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. BAM and MAM aerosol emissions file changes

M      models/atm/cam/bld/build-namelist
.  added tracer_cnst_filelist

M      models/atm/cam/bld/namelist_files/use_cases/cam4_bam_radpsv_geos5.xml
.  set strat aerosol data cycle year, file, and type
.  set ext_frc_type, srf_emis_type, and tracer_cnst_type to SERIAL

M      models/atm/cam/SVN_EXTERNAL_DIRECTORIES
.  Updated COSP external

M      models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90
.  COSP updates

M      models/atm/cam/src/dynamics/fv/pfixer.F90
.  set sum1 private for omp

M      models/atm/cam/src/dynamics/fv/inidat.F90
M      models/atm/cam/src/dynamics/fv/uv3s_update.F90
.  added if defined for OFFLINE_DYN, WACCM_GHG, and WACCM_MOZART

M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
.  made do loops omp parallel

M      models/atm/cam/src/dynamics/fv/metdata.F90
.  removed if debug
.  added tests for TS in met dataset


models/atm/cam/src/physics/cam/modal_aer_opt.F90
. lookup the indicies of the modal aerosol species in the aerosol list at
  initialization and save them (this is the main performance fix)
. assign pointers to modal aerosol specie mixing ratios outside the
  calculation loops (not sure whether this is having a significant
  performance impact)

models/atm/cam/src/physics/cam/rad_constituents.F90
. make rad_cnst_get_aer_idx public


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
all passed

edinburgh/lf95: 
043 bl318 TBL.sh f10c4cdm sat_hist 9s .....................................FAIL! rc= 7 at Tue Apr 19 18:19:26 MDT 2011
   Changes is COSP caused bl318 to fail


edinburgh/pgi or jaguar/pgi: 
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Apr 19 12:05:14 MDT 2011
   Changes is COSP caused bl317 to fail

CAM tag used for the baseline comparison tests if different than previous
tag: cam5_0_51


Summarize any changes to answers: BFB except for COSP diagnostic output

===============================================================
===============================================================

Tag name: cam5_0_51
Originator(s): Francis Vitt
Date: 4 April 2011
One-line Summary:

 Added various chemistry features, bug fixes and code clean up.

Purpose of changes: 

 - provide more intuitive data-timing namelist variables
 - update trop_mozart with latest MOZART4 mechanism
 - restore lighting NOx production in super_fast_llnl
 - give flexibility to the units of the emissions datasets
 - use more up-to-date dataset for waccm_ghg forcing
 - include CO2 reactions for WACCM to improve concentrations in upper regions
 - updates to dry deposition module
 - bug fixes listed below
 
Bugs fixed (include bugzilla ID):

 - corrected vertically integrated wet deposition rates diagnostics
 - corrected MASS and AREA output fields
 - corrected chemical prod/loss rates diagnostics
 
Describe any changes made to build system:

Describe any changes made to the namelist:

 - data-timing namelist changes:
   * srf_emis_ymd --> srf_emis_cycle_yr
                      srf_emis_fixed_ymd
   * srf_emis_tod --> srf_emis_fixed_tod

   * ext_frc_ymd --> ext_frc_cycle_yr
                     ext_frc_fixed_ymd
   * ext_frc_tod --> ext_frc_fixed_tod

   * flbc_date --> flbc_cycle_yr
                   flbc_fixed_ymd
                   flbc_fixed_tod
   * flbc_yr_offset removed

   * prescribed_aero_ymd --> prescribed_aero_cycle_yr
                             prescribed_aero_fixed_ymd
   * prescribed_aero_tod --> prescribed_aero_fixed_tod

   * aerodep_flx_ymd --> aerodep_flx_cycle_yr
                         aerodep_flx_fixed_ymd
   * aerodep_flx_tod --> aerodep_flx_fixed_tod
   
   * prescribed_ghg_ymd --> prescribed_ghg_cycle_yr
                            prescribed_ghg_fixed_ymd
   * prescribed_ghg_tod --> prescribed_ghg_fixed_tod

   * prescribed_ozone_ymd --> prescribed_ozone_cycle_yr
                              prescribed_ozone_fixed_ymd
   * prescribed_ozone_tod --> prescribed_ozone_fixed_tod

   * prescribed_volcaero_ymd --> prescribed_volcaero_cycle_yr
                                 prescribed_volcaero_fixed_ymd
   * prescribed_volcaero_tod --> prescribed_volcaero_fixed_tod

   * sad_date --> sad_cycle_yr
                  sad_fixed_ymd
                  sad_fixed_tod

   * tgcm_ubc_ymd --> tgcm_ubc_cycle_yr
                      tgcm_ubc_fixed_ymd
   * tgcm_ubc_tod --> tgcm_ubc_fixed_tod

   * chlorine_loading_ymd --> chlorine_loading_cycle_yr
                              chlorine_loading_fixed_ymd
   * chlorine_loading_tod --> chlorine_loading_fixed_tod

   * linoz_data_ymd --> linoz_data_cycle_yr
                        linoz_data_fixed_ymd
   * linoz_data_tod --> linoz_data_fixed_tod

   * tracer_cnst_ymd --> tracer_cnst_cycle_yr
                         tracer_cnst_fixed_ymd
   * tracer_cnst_tod --> tracer_cnst_fixed_tod

   * tracer_srcs_ymd --> tracer_srcs_cycle_yr
                         tracer_srcs_fixed_ymd
   * tracer_srcs_tod --> tracer_srcs_fixed_tod


List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D    models/atm/cam/bld/config_files/defaults_waccm_ghg.xml
D    models/atm/cam/bld/config_files/defaults_trop_mozart.xml
D    models/atm/cam/bld/config_files/defaults_trop_mam3.xml
D    models/atm/cam/bld/config_files/defaults_trop_bam.xml
D    models/atm/cam/bld/config_files/defaults_trop_mam7.xml
D    models/atm/cam/bld/config_files/defaults_waccm_mozart.xml
D    models/atm/cam/bld/config_files/defaults_super_fast_llnl_mam3.xml
D    models/atm/cam/bld/config_files/defaults_trop_ghg.xml
D    models/atm/cam/bld/config_files/defaults_super_fast_llnl.xml
 - these were not needed and removed

D    models/atm/cam/src/physics/cam/chemistry.F90
 - moved to models/atm/cam/src/chemistry/pp_none

D    models/atm/cam/src/chemistry/mozart/tgcm_forcing.F90
D    models/atm/cam/src/chemistry/mozart/iondrag.F90
 - iondrag.F90 moved to physics/waccm/
 - tgcm_forcing.F90 replaced by physics/waccm/waccm_forcing.F90

List all subroutines added and what they do:

A    models/atm/cam/bld/config_files/defaults_waccm.xml
 - configure defaults in this file are used for all veriation of waccm

A    models/atm/cam/bld/namelist_files/use_cases/cam4_bam_radpsv_geos5.xml
A    models/atm/cam/bld/namelist_files/use_cases/sd_waccm_tslt_geos5.xml
A    models/atm/cam/bld/namelist_files/use_cases/2000_cam4_trop_chem.xml
A    models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp26.xml
A    models/atm/cam/bld/namelist_files/use_cases/cam4_chem_radpsv_geos5.xml
A    models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp85.xml
 - added build-namelist use cases

A    models/atm/cam/src/physics/waccm/waccm_forcing.F90
 - for new waccm_ghg forcing data

A    models/atm/cam/src/physics/waccm/iondrag.F90
 - moved from models/atm/cam/src/chemistry/mozart

A    models/atm/cam/src/chemistry/modal_aero/mo_sethet.F90
 - old mo_sethet.F90 moved here so that trop_mam3 is bit-for-bit unchanged

A    models/atm/cam/src/chemistry/pp_trop_bam/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_trop_bam/chem_mech.in
A    models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_trop_mozart/chem_mech.in
A    models/atm/cam/src/chemistry/pp_trop_mam3/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_trop_mam3/chem_mech.in
A    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mech.in
A    models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mech.in
A    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mech.in
A    models/atm/cam/src/chemistry/pp_trop_ghg/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_trop_ghg/chem_mech.in
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mech.in
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mech.in
A    models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mech.doc
A    models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mech.in
  - added chem package documents


A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_photo.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_lin_matrix.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sad.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_jeuv.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_strato_rates.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart_v1/m_spc_id.F90
 - this was added for backwards compatibility (b4b same as previous waccm_mozart)

A    models/atm/cam/src/chemistry/pp_none
A    models/atm/cam/src/chemistry/pp_none/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_none/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_none/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_none/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_none/chemistry.F90
A    models/atm/cam/src/chemistry/pp_none/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_none/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_none/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_none/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_none/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_none/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_none/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_none/mo_lin_matrix.F90
 - this chem pkg was added to inable removal of cppdefs 

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/test/system/config_files/wm1.9c4h
 - use waccm_mozart_v1 chemistry package for this test

M    models/atm/cam/bld/configure
 - copy chemistry mechanism docs to $cam_bld
 - added waccm_mozart_v1 chemistry package (same as the CMIP version of waccm_mozart)
 - reference only defaults_waccm.xml config defaults files
 - references to TROPCHEM and SUPERFASTLLNL cppdefs removed


M    models/atm/cam/bld/config_files/definition.xml
 - waccm_mozart_v1 chem option added
 - added chem_proc_src chemistry preprocessor generated source code directory path
 - new default emissions files for trop_mozart
 - defaults added for waccm_mozart_v1
 - set cam_chempkg to 'waccm_mozart' for the waccm_mozart_v1 mechanism

M    models/atm/cam/bld/build-namelist
 - chem_rad_passive --> atm_dep_flux=.false.
 - airpl_emis_file replaced with ext frc files
 - offline_dyn --> do_tms=.false.
 - cftgcm --> waccm_forcing_file
 - CB2 and OC2 default emis files added in addition to HCN,CH3CN,C2H2,CH3COOH for trop_mozart
 - changes in dep lists for new trop_mozart mechanism

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - replaced *_ymd namelist variables with *_cycle_yr 
 - replaced cftgcm defaults with waccm_forcing defaults for waccm_ghg

M    models/atm/cam/bld/namelist_files/namelist_definition.xml
 - met_data_path namelist added
 - waccm_forcing_* namelist options added for waccm ghg data
   -- itgcmcyc removed
   -- cftgcm removed
 - data-timing namelist changes (see above).

M    models/atm/cam/bld/namelist_files/use_cases/1850_cam4_trop_bam.xml
M    models/atm/cam/bld/namelist_files/use_cases/2005_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3.xml
M    models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam5.xml
M    models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85v2.xml
M    models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp60.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
M    models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp26.xml
M    models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp45.xml
M    models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_bgc.xml
M    models/atm/cam/bld/namelist_files/use_cases/2000_cam4_super_fast_llnl.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850_cam5.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_1974-2005_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850_cam4_2xco2.xml
M    models/atm/cam/bld/namelist_files/use_cases/1850_cam5_super_fast_llnl.xml
 - mods for the data-timing namelist changes

M    models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - copy over preprocessor input and *.doc files to $cam_bld directory
 - set $chem_proc_src dir when preprocessor is invoked
 - clean up

M    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - use updated preprocessor which has corrections to the chem prod/loss rate diagnostics

M    models/atm/cam/src/control/runtime_opts.F90
 - removed itgcmcyc and cftgcm 
   and added call to waccm_forcing_readnl
 - broadcast nlte_use_mo
 - met_data_path namelist variable added

M    models/atm/cam/src/physics/cam/tropopause.F90
  - TROPCHEM cppdefs removed 
  - history field names changed:
          'chem_trop'        --> 'hstobie_trop'
          'chem_trop_linoz'  --> 'hstobie_linoz'
          'chem_trop_tropop' --> 'hstobie_tropop'
          
M    models/atm/cam/src/physics/cam/advnce.F90
M    models/atm/cam/src/physics/cam/radheat.F90
  - radheat_timestep_init interface changed for new waccm_ghg 

M    models/atm/cam/src/physics/waccm/nlte_lw.F90
M    models/atm/cam/src/physics/waccm/radheat.F90
 - changes for waccm_ghg

M    models/atm/cam/src/physics/cam/tphysac.F90
M    models/atm/cam/src/physics/cam/tphysbc.F90
M    models/atm/cam/src/physics/cam/physpkg.F90
M    models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
  - WACCM_MOZART and TROPCHEM cppdefs removed 

M    models/atm/cam/src/physics/cam/phys_control.F90
 - cam_chempkg_out added to getopts

M    models/atm/cam/src/physics/cam/cam_diagnostics.F90
 - tidal diagnostics added
M    models/atm/cam/src/physics/cam/tidal_diag.F90
 - get_tidal_coeffs subroutine added

M    models/atm/cam/src/physics/cam/chem_surfvals.F90
 - data-timing namelist changes

M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_setrxt.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_adjrxt.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/m_rxt_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/m_het_id.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_indprd.F90
M    models/atm/cam/src/chemistry/pp_trop_mozart/m_spc_id.F90
 - changed trop_mozart chem mechanism

M    models/atm/cam/src/chemistry/pp_trop_mozart/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_trop_mam3/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_trop_bam/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_trop_mam7/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_trop_ghg/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_imp_sol.F90
M    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_imp_sol.F90
 - fixed bug in chem prod/loss diagnostics

M    models/atm/cam/src/chemistry/utils/aerodep_flx.F90
M    models/atm/cam/src/chemistry/utils/prescribed_aero.F90
M    models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
M    models/atm/cam/src/chemistry/utils/mo_flbc.F90
M    models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
M    models/atm/cam/src/chemistry/utils/tracer_data.F90
M    models/atm/cam/src/chemistry/utils/aircraft_emit.F90
M    models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
M    models/atm/cam/src/chemistry/utils/m_types.F90
M    models/atm/cam/src/chemistry/mozart/chlorine_loading_data.F90
M    models/atm/cam/src/chemistry/mozart/mo_tgcm_ubc.F90
M    models/atm/cam/src/chemistry/mozart/upper_bc.F90
M    models/atm/cam/src/chemistry/mozart/mo_chemini.F90
M    models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M    models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
M    models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
M    models/atm/cam/src/chemistry/mozart/linoz_data.F90
M    models/atm/cam/src/chemistry/mozart/mo_strato_sad.F90
 - data-timing namelist changes

M    models/atm/cam/src/chemistry/bulk_aero/dust_sediment_mod.F90
 - replaced "stop" statement with call to endrun

M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_setrxt.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_adjrxt.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/m_rxt_id.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_indprd.F90
 - waccm mech changes (added CO2 reactions near upper boundary)

M    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mods.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_indprd.F90
 - added ext frcing of NO for lightning production


M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - set sulfate passed to usrrxt from vmr(so4_ndx) if SO4 is active
 - corrected units on rxt (tag_names) history feilds
 - call set_fstrat_h2o only if h2o is not chem active

M    models/atm/cam/src/chemistry/mozart/mo_airplane.F90
M    models/atm/cam/src/chemistry/mozart/mo_setext.F90
 - moved the NO lightning code outside the if (has_airpl_src) block

M    models/atm/cam/src/chemistry/mozart/mo_lightning.F90
 - added has_no_lightning_prod var so that cppdefs can be removed from physpkg.F90

M    models/atm/cam/src/chemistry/mozart/spedata.F90
 - removed the "spe_restart" option
 - no longer save the spe data file pathname in restart file

M    models/atm/cam/src/chemistry/mozart/mo_strato_rates.F90
 - if mixing ratios are small (< 1e-16) then rates are set to zero

M    models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
 - NJEUV increased to 26 (neuv) for the new waccm upper boundary jeuv CO2 photolysis
 - corrected AREA, MASS, and WD_* (vert integrated wet dep rate) diagnostics 

M    models/atm/cam/src/chemistry/mozart/mo_setinv.F90
 - added *_dens and *_vmr history fields

M    models/atm/cam/src/chemistry/mozart/chemistry.F90
 - data-timing namelist changes
 - "chem_rad_passive" switch added -> sets ptend%lq(1) = .false. so that the
   chemistry does not change water vapor 
 - removed the spedata restart calls
 - removed cppdefs that set chem_name
 - chem_is now invokes phys_control->cam_chempkg_is function

M    models/atm/cam/src/chemistry/mozart/mo_drydep.F90
 - added code for HCN, CH3CN, HCOOH
 - if offline-dyn use meteorology TS to determine icefrac which is
   applied only when drydep_method = 'xactive_lnd'
 - HCN and CH3CN zero over land (only ocnice_dvel applied)
 - code corrected for Carbon aerosols
 - CO tags added

M    models/atm/cam/src/chemistry/mozart/mo_photo.F90
 - max zenith for waccm 94.0 --> 97.01 degress

M    models/atm/cam/src/chemistry/mozart/mo_sethet.F90
 - Louisa's wet dep changes
 - check for unset het rates added

M    models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - CO tags added
 - added check for usr_N2O5_aer if mech has het1 to avoid double counting
   in tropospheric aerosol rates

M    models/atm/cam/src/chemistry/mozart/mo_jeuv.F90
 - CO2 photolysis added (near upper boundary)

M    models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
 - data-timing namelist changes
 - flexable units of input data

M    models/atm/cam/src/dynamics/fv/ctem.F90
 - "defined on ilev" added to description of 2D outputs

M    models/atm/cam/src/dynamics/fv/cd_core.F90
M    models/atm/cam/src/dynamics/fv/metdata.F90
 - offline dyn changes
 - can read bottom portion of met data
 - added code to determine icefrac from surface temperature

M    SVN_EXTERNAL_DIRECTORIES
 - use driver tag drvseq3_1_51 and CLM tag clm4_0_26


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 
  This is expected to fail due to the changes in waccm_mozart chemistry mechanism

045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 
  This is expected to fail due to the changes in trop_mozart chemistry mechanism, 
  dry deposition and wet deposition

050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 
  This is expected to failure due to the inclusion of lightning produced NOx

060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 
  This failure is cause by changes in dry deposition.  If the drydep_method were set to 
  'xactive_atm' then this baseline test would pass since this uses waccm_mozart_v1 which 
  has exactly the same mechanism as the previous waccm_mozart

edinburgh/lf95: 
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 
  This is expected to fail due to changes in waccm_ghg forcing data

edinburgh/pgi: 
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 
  This is expected to fail due to changes in waccm_ghg forcing data

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_50
Originator(s): Jim Edwards
Date: March 30, 2011
One-line Summary: Bug fixes for cosp and inithist

Purpose of changes: bug fixes, code cleanup

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

Code reviewed by: Eaton

List all subroutines eliminated:

List all subroutines added and what they do:
         models/atm/cam/src/control/cam_history_support.F90 : field_copy
	  provides an overload on the = operator to properly copy the
	  field_info derived type
	
List all existing files that have been modified, and describe the changes:
         models/atm/cam/test/system/TER.sh

	 added code to prevent inithist file from initial runs with
	 inithist='endofrun' from being compared
	
	 models/atm/cam/test/system/nl_files/ghgrmp
	 models/atm/cam/test/system/nl_files/outfrq3s
        
	 added inithist='endofrun' to namelist to capture writting inithist 
	 after a restart

	 models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml

         updated some of the homme init files
	
	 models/atm/cam/src/control/cam_history_buffers.F90
	 models/atm/cam/src/control/cam_history_support.F90
	 models/atm/cam/src/control/cam_history.F90

	 Added support for individual fields to define and use their own fill values, replaced some cosp 
	 bounds variables improperly removed in cam5_0_47, fixed a bug that caused inithist files to fail
	 when trying to write after a restart.   Removed global declarations of plat,plon,plev and plevp.
	 Changed the variable time_bnds written to inithist files to properly reflect time of files, this 
	 will cause some baseline tests to fail.

	 models/atm/cam/src/physics/cam/cospsimulator_intr.F90

	 Added support for cosp fillvalues to be used in cam_history instead of overwritting one fillvalue
	 with another.   
	
	
	 models/atm/cam/src/physics/cam/tropopause.F90
	 models/atm/cam/src/physics/cam/radiation.F90
	 models/atm/cam/src/physics/cam/aer_rad_props.F90
	 models/atm/cam/src/physics/cam/radiation_data.F90
	 models/atm/cam/src/physics/cam/modal_aer_opt.F90
	 models/atm/cam/src/physics/cam/microp_driver.F90
	 models/atm/cam/src/physics/cam/cldwat2m_micro.F90
	 models/atm/cam/src/physics/rrtmg/oldcloud.F90
	 models/atm/cam/src/physics/rrtmg/radiation.F90
	 models/atm/cam/src/dynamics/fv/inidat.F90

         Moved references to fillvalue from cam_history.F90 to cam_history_support.F90

	
	 models/atm/cam/src/dynamics/homme/native_mapping.F90

	 Modified output mapping file to better conform to scrip/esmf standards
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All pass except:
	004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Thu Mar 31 07:44:32 MDT 2011
	006 bl133 TBL.sh e48c4paqdm aqpgro+aquaplanet_cam4 3s .....................FAIL! rc= 7 at Thu Mar 31 07:44:34 MDT 2011
	013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Thu Mar 31 07:44:36 MDT 2011
	017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Thu Mar 31 07:44:44 MDT 2011
	021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Thu Mar 31 07:44:52 MDT 2011
	023 bl333 TBL.sh f4c4paqdh aqpgro+aquaplanet_cam4 3s ......................FAIL! rc= 7 at Thu Mar 31 07:44:53 MDT 2011
	033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Thu Mar 31 07:45:19 MDT 2011
	045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Thu Mar 31 07:45:39 MDT 2011
	050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Thu Mar 31 07:45:54 MDT 2011
	054 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Thu Mar 31 07:46:01 MDT 2011
	066 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 7 at Thu Mar 31 08:04:48 MDT 2011


edinburgh/lf95: All pass except:
       004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Thu Mar 31 08:17:23 MDT 2011
       009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Thu Mar 31 08:17:25 MDT 2011
       011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Thu Mar 31 08:17:25 MDT 2011
       015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Thu Mar 31 08:17:28 MDT 2011
       022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Mar 31 08:17:30 MDT 2011
       030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Mar 31 09:08:13 MDT 2011
       032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Thu Mar 31 09:08:14 MDT 2011
       035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Mar 31 09:08:17 MDT 2011
       038 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Thu Mar 31 09:08:18 MDT 2011
       040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Thu Mar 31 09:08:19 MDT 2011



	
edinburgh/pgi :  ALL pass except:
	004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Thu Mar 31 08:37:53 MDT 2011
	009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Thu Mar 31 08:37:54 MDT 2011
	011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Thu Mar 31 08:37:55 MDT 2011
	015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Thu Mar 31 08:37:57 MDT 2011
	022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Mar 31 08:37:59 MDT 2011
	030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Thu Mar 31 08:55:29 MDT 2011
	032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 7 at Thu Mar 31 08:55:30 MDT 2011
	035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Mar 31 08:55:33 MDT 2011
	038 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 7 at Thu Mar 31 08:55:34 MDT 2011
	040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Thu Mar 31 08:55:35 MDT 2011
	043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Mar 31 08:55:41 MDT 2011
	046 bl319 TBL.sh fn10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Mar 31 08:55:44 MDT 2011
	052 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL! rc= 7 at Thu Mar 31 08:56:04 MDT 2011


All results are bfb, tests failed due to changes in the inithist file - for ghgrmp and outfrq3s an additional file is 
	present which was not in the baseline.  The others failed because the variable time_bnds was corrected to 
	properly reflect the (instantaneous) bounds of the inithist file and because the nlon and wnummax variables
	were removed.   


	

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_49 
Originator(s): Edwards, Taylor, Mirin
Date: 03/21/2011
One-line Summary: homme dycore updates, New column output method

Purpose of changes: Developement of homme dycore and related 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:  
	Additional homme hgrid support 

Describe any changes made to the namelist: 
	updated some defaults for high resolution  
        Exposed additional homme namelist variables to CAM's build-namelist:
	homme_ftype:  selects type of forcing (adjustment, tendencies or
	              hybrid
	phys_tscale:  HOMME's forcing allows for the the physics dt 
	              (phys_tscale) to be different than the 
	              physics update frequency (dtime)
	              default is phys_tscale=dtime
	nu_q          hyper-viscosity for tracers (default=nu)
	qsplit        controlls tracer/dynamics time step splitting
	

	
List any changes to the defaults for the boundary datasets:
	updated default topography data sets to use new 
	hyperviscosity-smoothed versions.  
	added a 128x256 eul initial dataset with 101 startdate

	
Describe any substantial timing or memory changes:

Code reviewed by: Edwards, Eaton

List all subroutines eliminated:
   models/atm/cam/src/dynamics/homme/io_dist.F90
   models/atm/cam/src/dynamics/fv/io_dist.F90	
      Obsolete functions to move distributed arrays to single processor IO.
	
	
List all subroutines added and what they do:
   two new modules added - they are data processing utilities which
   rely on both CAM and HOMME infrastructure so included here but 
   not used for normal simulations.
	  
   models/atm/cam/src/dynamics/homme/native_mapping.F90
	Allows the creation of scrip format mapping files based on the
	homme dycore basis functions.  These are smoother than bilinear
	interpolation but may not be sign preserving.  

    models/atm/cam/src/dynamics/homme/nctopo_util_mod.F90
	Applys hyper-viscosity smoothing to PHIS, SGH, SGH30 fields,
	writes smoothed fields to history files as PHIS_SM, SGH_SM and SGH30_SM



List all existing files that have been modified, and describe the changes:
   models/atm/cam/test/system/nl_files/ghgrmp
	Added a third history file output with new column data format but
	same data as second history file
	
   models/atm/cam/bld/config_files/horiz_grid.xml
   models/atm/cam/bld/build-namelist
   models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
   models/atm/cam/bld/namelist_files/namelist_definition.xml
      Added support for ne16np8 and ne30np8 hgrids     
      Updated default topo files for ne30np4, ne60np4, ne120np4 and ne240np4 hgrids
  
      Added support for new column output method, method is triggered with namelist
      variable collect_column_output = .true.   this is an array of size 6, one for
      each history file.
	
	
   models/atm/cam/src/control/cam_history.F90
   models/atm/cam/src/control/cam_history_support.F90	
	Added an interface to interp_mod so that information about the interpolation
	method is written to the history files.
	Added an option to collect column output into a single field and 
	output using the ncol format which is defined for unstructured grids.
	This is a much faster method when you are outputing several columns
	
   models/atm/cam/src/utils/spmd_utils.F90
        Refactored in an effort to move toward removeing mpishorthand.F and
	making this the sole location in cam where mpif.h is included.
	
	
   models/atm/cam/src/dynamics/homme/pmgrid.F90
   models/atm/cam/src/dynamics/homme/dyn_grid.F90
   models/atm/cam/src/dynamics/homme/dp_coupling.F90
   models/atm/cam/src/dynamics/homme/dyn_comp.F90
   models/atm/cam/src/dynamics/homme/inidat.F90
   models/atm/cam/src/dynamics/homme/stepon.F90
   models/atm/cam/src/dynamics/homme/restart_dynamics.F90
   models/atm/cam/src/dynamics/homme/spmd_dyn.F90
   models/atm/cam/src/dynamics/homme/inital.F90
      Added support for physics to use more mpi tasks than dynamics,  
      removed SPMD cpp ifdefs , remove use of mpishorthand module
      
   models/atm/cam/src/dynamics/homme/interp_mod.F90
      Added code to add attributes to the history file indicating
	the options used in interpolation, fixed a bug in vector 
	field interpolation.
	
   models/atm/cam/src/dynamics/fv/dyn_grid.F90
   models/atm/cam/src/dynamics/sld/dyn_grid.F90
   models/atm/cam/src/dynamics/eul/dyn_grid.F90
     Added stubs for get_block_ldof_d - plan to move code 
	
   models/atm/cam/src/dynamics/fv/interp_mod.F90
   models/atm/cam/src/dynamics/sld/interp_mod.F90
   models/atm/cam/src/dynamics/eul/interp_mod.F90	
     update stub api to support unstructured grids
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All pass except
       004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Tue Mar 22 11:21:47 MDT 2011
       021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue Mar 22 12:01:36 MDT 2011
       063 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ....................... FAIL
       066 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL

	
edinburgh/lf95: All pass except:
       009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Mar 22 11:32:18 MDT 2011
       030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Mar 22 15:59:09 MDT 2011
	
edinburgh/pgi : All pass except:
       009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Mar 22 11:18:46 MDT 2011
       030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Mar 22 12:00:41 MDT 2011	
       052 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL
	
     ghgrmp baseline tests fail due to the addition of a history file with collected column output
     all existing history files were comfirmed to be bfb with baseline	
     
     HOMME default output was changed from interpolated to native grid
	

	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_48
Originator(s): mvr,bundy,jedwards,dennis,hannay,eaton
Date: Wed Mar 16 2011
One-line Summary: added functionality for fv 2.5x3.33 resolution; small fixes 
and cleanup to test scripts; added support for 0.25deg cam-homme; tweak of 
cam5 tuning parameters; bug fixes to flushing of output buffers; updated 
externals definitions for component tags

=======
Purpose of changes:
-machine jaguar was decommissioned 3/7/11 so support was stripped from test scripts
-adjusted tuning parameters dust_emis_fact and cldfrc_rhminl for cam5_1...tuning 
 was done at 1deg but applies to all resolutions for now - tuning specific to
 other resolutions may follow
-externals updated from cesm1_0_beta13 to cesm1_0_beta16
	

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 
- added default files for new 2.5x3.33 resolution
- added default files for 0.25deg cam-homme

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do:
A       models/atm/cam/test/system/config_files/f2.5c5dm
- new configuration options test file for 2.5x3.33
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/test/system/TCB.sh
M       models/atm/cam/test/system/TDD.sh
M       models/atm/cam/test/system/TCB_ccsm.sh
M       models/atm/cam/test/system/TBL.sh
M       models/atm/cam/test/system/TBR.sh
M       models/atm/cam/test/system/TPF.sh
M       models/atm/cam/test/system/TER.sh
M       models/atm/cam/test/system/TEQ_ccsm.sh
M       models/atm/cam/test/system/TER_ccsm.sh
M       models/atm/cam/test/system/TSM_ccsm.sh
M       models/atm/cam/test/system/TMC.sh
M       models/atm/cam/test/system/TBL_ccsm.sh
M       models/atm/cam/test/system/TSC.sh
M       models/atm/cam/test/system/TEQ.sh
M       models/atm/cam/test/system/TSM.sh
- fix behavior of test scripts in how they clean up after themselves

M       models/atm/cam/test/system/CAM_decomp.sh
- added code for new 2.5x3.33 resolution to fv dynamics decomposition utility

M       models/atm/cam/test/system/test_driver.sh
- removed test support for decommissioned machine, jaguar
- made all module loading/unloading in test scripts to refer to generic 
  compilers, netcdf, etc and removed the 'module purge' from lynx
	
M       models/atm/cam/test/system/nl_files/ghgrmp
- enhanced namelist options test file with additional vars on aux history
  tapes (jedwards)
	
M       models/atm/cam/test/system/input_tests_master
- modified test definition to now run at new 2.5x3.33 resolution
	
M       models/atm/cam/test/system/CAM_runcmnd.sh
- removed test support for decommissioned machine, jaguar

M       models/atm/cam/bld/config_files/horiz_grid.xml
- added support for new 2.5x3.33 resolution

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- added default files for new 2.5x3.33 resolution
- added default files for 0.25deg cam-homme
- adjusted tuning parameters dust_emis_fact and cldfrc_rhminl for cam5

M       models/atm/cam/src/control/ncdio_atm.F90
M       models/atm/cam/src/utils/abortutils.F90
M       models/atm/cam/src/dynamics/eul/iop.F90
- now flushing correct output buffer rather than unit 6
	
M       models/atm/cam/src/control/cam_history.F90
- bug fix to string length problem (jedwards)

M       models/atm/cam/src/utils/time_manager.F90
- added method from release branch for timemgr_set_date_time

M       models/atm/cam/src/utils/cam_aqua/shr_flux_mod.F90
- change to interface to coincide with changes to share and drv code

M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
- added call to flush buffers after initialization stage
	
M       SVN_EXTERNAL_DIRECTORIES
 M      .
- new external component tags for drv, clm, cice, docn, share, timing, 
  scripts, slnd, sice, socn, sglc - consistent with update from cesm1_0_beta13 
  to cesm1_0_beta16

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Mar 15 16:35:21 MDT 2011
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Mar 15 16:36:56 MDT 2011
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue Mar 15 16:49:59 MDT 2011
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Tue Mar 15 17:14:53 MDT 2011
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Tue Mar 15 17:28:40 MDT 2011
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue Mar 15 17:56:35 MDT 2011
072 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Tue Mar 15 19:20:21 MDT 2011
- cam5 baselines were expected to fail due to changes in tuning parameters
- bl992 was expected to fail due to changes to component tags between cesm1_0_beta13 and cesm1_0_beta16, namely:
  "landfrac is no longer sent at run phase" (beta15) and "driver mapping mods" (beta16)

edinburgh/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Mar 15 14:47:47 MDT 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Mar 15 15:00:24 MDT 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Mar 15 15:07:27 MDT 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Mar 15 15:13:55 MDT 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Mar 15 15:41:20 MDT 2011
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Tue Mar 15 18:13:40 MDT 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Tue Mar 15 18:47:52 MDT 2011
- cam5 baselines were expected to fail due to changes in tuning parameters
- bl312 was expected to fail due to it changing to 2.5x3.33 resolution which did not exist in baseline code
	
edinburgh/pgi: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Mar 16 10:30:16 MDT 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Mar 16 10:35:59 MDT 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Mar 16 10:39:20 MDT 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Mar 16 10:42:43 MDT 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Mar 16 10:52:47 MDT 2011
030 bl312 TBL.sh f2.5c5dm ghgrmp 9s .......................................FAIL! rc= 7 at Wed Mar 16 11:17:07 MDT 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Mar 16 11:28:02 MDT 2011
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Mar 16 11:28:08 MDT 2011
046 bl319 TBL.sh fn10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Mar 16 11:28:09 MDT 2011
049 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 7 at Wed Mar 16 11:28:11 MDT 2011
052 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL! rc= 7 at Wed Mar 16 11:29:31 MDT 2011
- cam5 baselines were expected to fail due to changes in tuning parameters
- bl312 was expected to fail due to it changing to 2.5x3.33 resolution which did not exist in baseline code
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers:  b4b except for cam5, where all configurations had answers change due to 
	the tweaking of tuning parameters...these produce a new climate and the diagnostics can be found here:
	http://wwwint.cgd.ucar.edu/project/diagnostics/cesm-1.0/amwg/hannay/b40_1850_1d_b08c5cn_138j/b40_1850_1d_b08c5cn_138j-obs_yr200-209/ 

	
======================================================================
===============================================================

>>>>>>> .merge-right.r27350
Tag name: cam5_0_47
Originator(s): jedwards, eaton
Date: Mar, 08 2011
One-line Summary:  Refactoring cam history

Purpose of changes:

. Refactoring in cam history to allow for extra dimensions beyond the
  current spatial/temporal ones.  Previously the fields in a history file
  time sample only had (lon,lat,lev,time) or (ncol,lev,time) dimensions.
  The "addfld" calls allowed lev to be set to 1, plev or plevp.  To work
  around this constraint in the past optional flags were added to the
  addfld subroutine that allowed more values of lev, but this workaround
  did not provide extra dimensions.  In cases where multiple non-horizontal
  dimensions were needed, e.g., level and optical depth, or level and
  subcolumn, the technique employed was to combine multiple dimensions into
  a single mixed dimension.  We have eliminated the need to do that.
  Optional arguments have been added to the addfld subroutine which allow
  defining multiple dimensions rather than just a single "lev" dimension.

. The support for 4-byte history buffers has been removed.  This feature
  added substantial complexity to cam_history, but no demonstrated benefit.
  It also was not part of the regression testing, so we don't know whether
  it was working correctly.

. The old isccp cloudsimulator code was removed.  The latest ISCCP
  simulator is available as part of the COSP package.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Edwards, Eaton

List all subroutines eliminated:

models/atm/cam/src/physics/cam/cloudsimulator.F90
models/atm/cam/src/physics/cam/cloudsimulator_38.F90
models/atm/cam/src/physics/cam/icarus_scops.F90
models/atm/cam/src/physics/cam/icarus_scops_38.F90
. The old ISCCP simulator code has been removed.


List all subroutines added and what they do:

models/atm/cam/src/control/cam_history_buffers.F90
models/atm/cam/src/control/cam_history_support.F90
- These files seperate out some of the distinct functionality that was
  in cam_history.
	

List all existing files that have been modified, and describe the changes:
    models/atm/cam/test/system/CAM_compare.sh   
	Added -d option so that cprnc can compare sat_hist files
	
    models/atm/cam/test/system/test_driver.sh   
        Point to new cprnc location on bluefire and edinburgh, this change should
	be reverted when the new cprnc code is moved to the standard location
	
    models/atm/cam/test/system/nl_files/outfrq1m        
        Change ndens from 1 to 2 so that 4 byte history files are included in the test
	suite.
	
    models/atm/cam/test/system/input_tests_master       
        Modify test 318 to incude sat history file and local time buf tests
	
    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml 
    models/atm/cam/bld/namelist_files/namelist_definition.xml   
    models/atm/cam/bld/build-namelist   
        Remove isccp code, add drydep_srf_file for homme, remove flags for 4-byte history buffers
	
    models/atm/cam/bld/cam.cpl7.template       
        Remove phys_loadbalance setting - this is handled by cams configure script and varies with dycore
	
    models/atm/cam/SVN_EXTERNAL_DIRECTORIES     
        Update cprnc tag
	
    models/atm/cam/src/utils/time_manager.F90   
    models/atm/cam/src/control/mpishorthand.F   
        Remove global save statement

    models/atm/cam/src/control/runtime_opts.F90 
        Remove isccp code, remove 4-byte history buffer code
	
    models/atm/cam/src/control/cam_comp.F90     
    models/atm/cam/src/control/camsrfexch_types.F90     
	Added code to deallocate derived data types used in srf exchanges
	
    models/atm/cam/src/physics/cam/radiation.F90        
    models/atm/cam/src/physics/rrtmg/radiation.F90      
    models/atm/cam/src/control/filenames.F90    
	Remove isccp code
	
    models/atm/cam/src/control/cam_restart.F90  
	Removed unused reference to shr_sys_getenv, cam_history mtapes is now ptapes
	
    models/atm/cam/src/control/ioFileMod.F90    
	Added an optional argument to getfil, lexist, that will be set to true if the 
	file is found and false otherwise.   

    models/atm/cam/src/control/cam_history.F90  
        Moved buffer code to cam_history_buffers.F90, moved some shared header code to 
	cam_history_support.F90, removed 4-byte buffer code.   Added support for more than
	1 non-decomposed dimension in fields.  Refactored cosp and
	sat_hist code, removed isccp specific and other dead code. 

    models/atm/cam/src/utils/cam_pio_utils.F90  
        Moved code that had been moved here from cam_history to cam_history_support.F90
        Added support for more than 1 non-decomposed dimension in fields.
	
    models/atm/cam/src/utils/cam_dom/ocn_comp.F90       
	Removed reference to unused shr functions
	
    models/atm/cam/src/physics/cam/cospsimulator_intr.F90       
        Seperated dimensions that were required to be combined by restrictions in cam_history
        Added only clause to use statements.
	
    models/atm/cam/src/chemistry/mozart/mo_drydep.F90   
        Improved error checking for reading drydep_srf_file used by unstructured grids
	
    models/atm/cam/src/dynamics/homme/interp_mod.F90    
        Bug fix in interpolation of vector fields

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all pass

edinburgh/lf95: all pass except:
	043 bl318 TBL.sh f10c4cdm sat_hist 9s      Test was modified to include sat_hist, I back ported the modified test and
	                             ran manually with bfb results.
        Tests 317 and 318 require the updated cprnc (cprnc_110307c)
	
edinburgh/pgi or jaguar/pgi: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_46
Originator(s): jet, P. Worley, eaton
Date: 
One-line Summary: Fix spmd_comm namelist parameters for all dycores.

Purpose of changes: SPMD controlling namelist parameters were broken for all dycores but FV 
        by my cam5_0_25 tag. Additionally the inline documentation for the parameters in 
        spmd_dyn were also screwed up. Both of these are now fixed. This tag also continues
        the namelist refactor that defines and sets the default namelist values as module 
        data instead of using the setopts routines.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:  

        Added a new spmd_utils namelist to atm_in called spmd_utils_nl.  
        This contains the spmd controlling namelist parameters 
        swap_comm_protocol
        swap_comm_maxreq
        fc_gather_flow_cntl

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:mvr

List all subroutines eliminated:
        fc_gather_setopts
        swap_comm_setopts
        
List all subroutines added and what they do:

        spmd_utils_readnl - allows for namelist input for 
                            the swap_comm/gather_flow spmd 
                            parameters

List all existing files that have been modified, and describe the changes:
        M       models/atm/cam/doc/ChangeLog

        M       models/atm/cam/bld/namelist_files/namelist_definition.xml
        Added spmd_utils_nl as the group for the swap_comm/gather_flow parameters 

        M       models/atm/cam/src/control/runtime_opts.F90
        Added call for reading new namelist

        M       models/atm/cam/src/utils/spmd_utils.F90
        Added new subroutine to read spmd_utils_nl namelist

        M       models/atm/cam/src/dynamics/sld/spmd_dyn.F90
        Got rid of spmd setopts calls

        M       models/atm/cam/src/dynamics/eul/spmd_dyn.F90
        Got rid of spmd setopts calls

        M       models/atm/cam/src/dynamics/fv/spmd_dyn.F90
        Got rid of spmd setopts calls
        
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All Pass

edinburgh/lf95:   All Pass

edinburgh/pgi or jaguar/pgi:   All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,BFB
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
Tag name: cam5_0_45
Originator(s): mvr,jenkay
Date: Fri Feb 18 2011
One-line Summary: fixing a problem with the weighted averages for several COSP 
	output variables 

Purpose of changes:
- problem affects COSP answers and fix was needed before CFMIP integrations could begin.
  output variables affected:  MEANCLDALB_ISCCP, MEANPTOP_ISCCP, and MEANTAU_ISCCP

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: ALL PASS
	
edinburgh/lf95: 
043 bl318 TBL.sh f10c4cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Feb 18 13:06:55 MST 2011
- baselines for configurations using cosp were expected to fail - differences in the secondary history tapes only
	
edinburgh/pgi: 
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Fri Feb 18 13:07:06 MST 2011
- baselines for configurations using cosp were expected to fail - differences in the secondary history tapes only
	
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers:  b4b, except for cosp variables MEANCLDALB_ISCCP, MEANPTOP_ISCCP, and MEANTAU_ISCCP

	
======================================================================
===============================================================

Tag name: cam5_0_44
Originator(s): Francis Vitt
Date: 18 Feb 2011
One-line Summary: Added new history capabilities 

Purpose of changes:
	
  The following capabilities were added to CAM history to help with
  comparisons to observations:
   - local time averaging
   - sampling along a specified track
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

 To activate local time averaging use 'L' history averaging flag and set lcltod_start, and 
 lcltod_stop namelist variable to specify the local start and stop times (in seconds) of the
 averaging region.  For example:

   hist_avgflag_pertape = 'L'
   lcltod_start = 0
   lcltod_stop  = 3600

 To activate sampling along a specified track use the following namelists:
	
  sathist_track_infile - netcdf file that specifies the track(s) the sample along
  sathist_fincl - list of history fields to be sampled
  sathist_mfilt - number of columns output to each individual file
  sathist_hfilename_spec - specifies the output file template "%c.cam2.sat.%y-%m-%d-%s.nc"
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A   models/atm/cam/src/control/sat_hist.F90
 this manages the output of columns along a specified track

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/bld/namelist_files/namelist_definition.xml
M    models/atm/cam/src/control/runtime_opts.F90
M    models/atm/cam/src/control/cam_comp.F90
M    models/atm/cam/src/control/cam_history.F90
 changes for sampling and local time averaging
	
M    models/atm/cam/src/dynamics/sld/dyn_grid.F90
M    models/atm/cam/src/dynamics/eul/dyn_grid.F90
M    models/atm/cam/src/dynamics/fv/dyn_grid.F90
 made get_gcol_block_d interface the same as the dynamics/homme version
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  ALL PASS

edinburgh/lf95: ALL PASS

edinburgh/pgi: ALL PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_0_43
Originator(s): mvr,jenkay,eaton
Date: Wed Feb 16 2011
One-line Summary: cosp bug fixes/code improvement; cleanup of cam microphysics; 
	fix for sld configurations

Purpose of changes:
- cosp mods include:
  1) reff_cosp mods per Yuying's e-mail, described in cospsimulator_intr.F90
  2) I checked that all fields to run COSP off-line are available, and changed 
     documentation at the top of cospsimulator_intr.F90.
  3)  Jim Boyle found a problem when using cosp_nradsteps = 3:
      "The data were saved as instantaneous - the values were saved as missing.
      If there is a bug I could imagine the missing values cycling through all the 
      longitudes for a month and producing seemingly complete fields."
      This was indeed a problem -  radiation is called a number of times in a 
      single timestep (loop over chunks in physpkg.F90).  Therefore, my cosp_cnt 
      counter, which was meant to advance only as timestep advanced, was advancing 
      within a timestep.  I redid the logic in radiation.F90. cosp_cnt now has an 
      lchnk dimension... each chunk has its own counter. 

      Note: for 3), the monthly outputs from a long COSP run looked ok - I think 
      they are just sub-sampling the columns in a different way.  So 3) is really 
      an answer issue more for instantaneous forecast values, and a consistency 
      issue for monthly averages.
  4) An aside code mod not related to COSP:  I added ATMEINT addfld/outfld calls 
     in cam_diagnostics.F90, a useful diagnostic for meridional heat transport 
     calculations.  

- microphysics changes involve:
  1. Removing unnecessary passed variables and use statements for the CAM5 cloud 
     microphysics (cldwat2m_micro.F90)  [Hugh: Oct 31st Mods]
  2. Adding functionality for a logical flag called 'sub_column' to be passed to 
     the CAM5 microphysics that changes how it works, but with the flag set (false) 
     to reproduce the standard code (cldwat2m_micro.F90)

- anything using sld dycore was broken with mods in cam5_0_41, where a 
  namespace issue was addressed for coupling with cism
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/utils/sgexx.F90
M       models/atm/cam/src/dynamics/sld/nmmatrix.F90
- fix for sld - was broken with mods to address namespace problems in cam5_0_41

M       models/atm/cam/src/physics/cam/initindx.F90
M       models/atm/cam/src/physics/cam/microp_aero.F90
M       models/atm/cam/src/physics/cam/radiation.F90
M       models/atm/cam/src/physics/cam/tphysbc.F90
M       models/atm/cam/src/physics/cam/cam_diagnostics.F90
M       models/atm/cam/src/physics/cam/stratiform.F90
M       models/atm/cam/src/physics/cam/convect_shallow.F90
M       models/atm/cam/src/physics/cam/macrop_driver.F90
M       models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M       models/atm/cam/src/physics/cam/tphysac.F90
M       models/atm/cam/src/physics/cam/cldwat.F90
M       models/atm/cam/src/physics/rrtmg/radlw.F90
M       models/atm/cam/src/physics/rrtmg/radiation.F90
M       models/atm/cam/src/dynamics/fv/dyn_comp.F90
- mods for cosp work (see above)
	
M       models/atm/cam/src/physics/cam/cldwat2m_micro.F90
MM      models/atm/cam/src/physics/cam/microp_driver.F90
- mods included those for cosp work and microphysics cleanup (see above)
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: ALL PASS
	
edinburgh/lf95: 
043 bl318 TBL.sh f10c4cdm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Feb 15 13:38:13 MST 2011
- baselines for configurations turning on cosp were expected to fail - differences in the secondary history tapes only
	
edinburgh/pgi: 
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Feb 15 13:21:21 MST 2011
- baselines for configurations turning on cosp were expected to fail - differences in the secondary history tapes only
	
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers:  b4b, except for cosp variables

	
======================================================================
===============================================================

Tag name: cam5_0_42
Originator(s):  Edwards, Eaton
Date: Mon Feb  7 09:57:52 MST 2011
One-line Summary: Refactoring in rad_constituents and modal aerosol code.

Purpose of changes:  

. This is another step on the path to providing prescribed modal aerosol
  functionality. 

. The rad_constituent interfaces have been generalized to treat the climate
  and diagnostic calculations more uniformly.  The use of an optional
  argument to identify a diagnostic calc is replaced by a non-optional
  argument which is set to zero to indicate the climate calculation, and to
  1,...,N_DIAG for the diagnostic calculation.  This allows us to
  consolidate the separate code for climate and diagnostic calcs in the
  radiation driver (rrtmg only).

. Removed qqcw array from pbuf structure and replaced with individual cloud
  bourne constituant species.  Code clean up including replacing goto flow
  structures and redefining static variables as parameters.

. Add test for diagnostic rad calcs with BAM and rrtmg

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

. Removal of qqcw array reduces the number of 3D arrays in pbuf by 10.

Code reviewed by: Eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/test/system/nl_files/rad_diag

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/chemistry/modal_aero/modal_aero_calcsize.F90 
. update qqcw access
. cleanup code structure, remove "go to"s

models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
. move parameter settings here from the initialize module
. add methods to access qqcw fields

models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90 
. add register method for adding fields to constituent arrays and pbuf.
. fix output unit

models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90 
models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90 
models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90 
models/atm/cam/src/chemistry/modal_aero/modal_aero_wateruptake.F90 
. cleanup

models/atm/cam/src/chemistry/mozart/chemistry.F90 
. call new modal_aero_register method

models/atm/cam/src/chemistry/mozart/mo_mass_xforms.F90
. add methods qqcw2vmr and vmr2qqcw to handle new qqcw implementation

models/atm/cam/src/physics/cam/cldwat2m_micro.F90 
. cleanup unused rad_constituents use association

models/atm/cam/src/physics/cam/microp_aero.F90 
models/atm/cam/src/physics/cam/microp_driver.F90 
. update rad_cnst interfaces 
. update qqcw access

models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90 
models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90 
models/atm/cam/src/chemistry/mozart/mo_setsox.F90 
models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90 
models/atm/cam/src/physics/cam/ndrop.F90
. update qqcw access
. cleanup

models/atm/cam/src/physics/cam/stratiform.F90 
models/atm/cam/src/physics/cam/tphysbc.F90
. remove unused ifdef MODAL_AERO conditionals

models/atm/cam/src/physics/cam/aer_rad_props.F90 
models/atm/cam/src/physics/cam/cospsimulator_intr.F90 
models/atm/cam/src/physics/cam/modal_aer_opt.F90 
models/atm/cam/src/physics/cam/rad_constituents.F90 
models/atm/cam/src/physics/cam/radiation.F90 
models/atm/cam/src/physics/cam/radiation_data.F90 
models/atm/cam/src/physics/rrtmg/radiation.F90 
models/atm/cam/src/physics/waccm/nlte_lw.F90 
. update rad_cnst interfaces 

models/atm/cam/test/system/input_tests_master 
models/atm/cam/test/system/tests_pretag_edinburgh_pgi 
. add test {sm,er,bl}320 fn10c5dm rad_diag 9s
  This tests rad diagnostic calcs for bulk aerosols in rrtmg

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all pass

edinburgh/lf95: all pass

edinburgh/pgi:  all pass except
049 bl320 TBL.sh fn10c5dm rad_diag 9s .....................................FAIL! rc= 5 at Sat Feb  5 17:51:45 MST 2011

This failure is expected since it's a new test and there is no comparable
test in cam5_0_41 for the baseline comparison.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================
Tag name: cam5_0_41
Originator(s): mvr,jedwards,eaton
Date: Mon Jan 31 2011
One-line Summary: enabled use of intel and pathscale compilers; updated clm tag 
allowed cleanup of misc.h and preproc.h; filepath changes for clm; new default 
climatological datasets for prescribed aerosol, ozone; cleanup of namelist 
definitions; mods to allow coupling with cism

Purpose of changes:
- new aerosol and ozone datasets were for 2000 climatology
- coupling with land ice model (cism) was hampered by namespace conflicts
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 
- new default climatological datasets for prescribed aerosol, ozone

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/test_driver.sh
- enabled testing with pathscale and intel compilers on lynx

M      models/atm/cam/bld/configure
- new clm tag allowed cleanup of misc.h and preproc.h; filepath changes for clm

M      models/atm/cam/bld/Makefile.in
- changes needed to enable pathscale and intel compilers

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- new default climatological datasets (2000 climatology) for prescribed aerosol 
  and prescribed ozone
	
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
- cleanup of old clm entries
	
M      models/atm/cam/bld/namelist_files/use_cases/2005_cam4.xml
- changed the prescribed aero, deposition, and ozone datasets for present day 
  use_case to the versions used by rcp4.5
	
M      models/atm/cam/src/utils/time_manager.F90
M      models/atm/cam/src/physics/cam/stratiform.F90
M      models/atm/cam/src/physics/cam/convect_shallow.F90
- minor fixes needed to appease intel or pathscale compiler

M      models/atm/cam/src/utils/sgexx.F90
- converted to a module to prevent namespace conflicts when coupled with cism
	
M      models/atm/cam/src/dynamics/eul/settau.F90
- modified to now use new module sgexx

M      SVN_EXTERNAL_DIRECTORIES
 M     .
- updated land tag to clm4_0_22
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Mon Jan 31 09:50:55 MST 2011
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Mon Jan 31 09:51:06 MST 2011
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Mon Jan 31 09:51:29 MST 2011
072 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 4 at Mon Jan 31 10:40:13 MST 2011
- any baseline where prescribed aerosols or prescribed ozone was used was expected to fail
	
edinburgh/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Thu Jan 27 12:13:18 MST 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Thu Jan 27 12:22:16 MST 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Thu Jan 27 12:34:43 MST 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Jan 27 12:57:50 MST 2011
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Thu Jan 27 13:20:08 MST 2011
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 27 13:41:30 MST 2011
043 bl318 TBL.sh f10c4cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 27 13:57:43 MST 2011
- any baseline where prescribed aerosols or prescribed ozone was used was expected to fail
	
edinburgh/pgi: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Thu Jan 27 12:09:01 MST 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Thu Jan 27 12:14:38 MST 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Thu Jan 27 12:21:44 MST 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Thu Jan 27 12:32:49 MST 2011
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Thu Jan 27 12:41:59 MST 2011
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 27 12:49:30 MST 2011
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 27 13:02:30 MST 2011
046 bl319 TBL.sh fn10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Jan 27 13:06:58 MST 2011
049 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL! rc= 7 at Thu Jan 27 13:33:53 MST 2011
- any baseline where prescribed aerosols or prescribed ozone was used was expected to fail
	
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers:  b4b, except for configurations using default datasets for prescribed aerosols, ozone

	
======================================================================
===============================================================
Tag name: cam5_0_40
Originator(s): mvr,hannay
Date: Thu Jan 27 2011
One-line Summary: bug fixes and retuning of cam5 physics

Purpose of changes:
1. A fix to immersion freezing (small changes)
2. Fixing the diagnostic output FICE to trap for roundoff errors (diagnostic only)
3. Bug fix for subgrid cloud water treatment in contact nucleation (small changes)
4. Bug fix for size of snow particles used in radiation (they get smaller by a factor of 3 and more reflective: some impact).
5. Fix to guarantee the in-stratus LWC to be within the specified range even when the cloud fraction is very small (<  1.e-5 )
6  Fix to prevent model crash by dividing by near zero cloud fraction in the droplet activation routine

We also include retuning parameters as in: b40_1850_1d_b08c5cn_138j

               release(2deg)     Bugfix+CN (1deg)
Dcs              325                 400
rhminl           0.89                0.90
c0_lnd           0.0020              0.0059
c0_ocn           0.0150              0.0450
dp1              0.04                0.10
dp2              675.                500.
div24del2flag    2                   4

Notice that the 2 degree version has not been retuned and we use the 
1 degree parameter for all resolution.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- default settings for rhminl, c0_lnd, c0_ocn, dp1, dp2, div24del2flag 
  retuned for cam5 physics
	
M       models/atm/cam/src/physics/cam/ndrop.F90
- Fix to prevent model crash by dividing by near zero cloud fraction in 
  the droplet activation routine

M       models/atm/cam/src/physics/cam/cldwat2m_macro.F90
- bug fixes, see above
	
M       models/atm/cam/src/physics/cam/cldwat2m_micro.F90
- rhosn, Dcs retuned; bug fixes, see above
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Jan 26 11:49:08 MST 2011
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Jan 26 11:49:10 MST 2011
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Wed Jan 26 11:49:24 MST 2011
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Wed Jan 26 11:50:28 MST 2011
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Wed Jan 26 11:51:12 MST 2011
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Wed Jan 26 11:51:49 MST 2011
- cam5 baseline tests failed as expected
	
edinburgh/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Jan 26 15:36:19 MST 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Jan 26 15:42:36 MST 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Jan 26 15:48:01 MST 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Jan 26 15:49:49 MST 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Jan 26 16:06:20 MST 2011
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Wed Jan 26 16:36:45 MST 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Jan 26 17:27:13 MST 2011
- cam5 baseline tests failed as expected

edinburgh/pgi: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Jan 26 15:34:11 MST 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Jan 26 15:38:35 MST 2011
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Jan 26 15:41:42 MST 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Jan 26 15:42:39 MST 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Jan 26 15:49:55 MST 2011
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Wed Jan 26 15:54:17 MST 2011
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Jan 26 16:06:28 MST 2011
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan 26 16:17:26 MST 2011
046 bl319 TBL.sh fn10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan 26 16:24:58 MST 2011
049 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL! rc= 7 at Wed Jan 26 17:01:15 MST 2011
- cam5 baseline tests failed as expected

lynx/pgi: 
004 bl157 TBL.sh e64c5m ghgrmp 9s .........................................FAIL! rc= 7 at Tue Jan 25 12:58:50 MST 2011
006 bl158 TBL.sh e64c5paqm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Jan 25 12:58:52 MST 2011
012 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Jan 25 12:59:05 MST 2011
021 bl372 TBL.sh f1.9c5m fvvp_lb2 9s ......................................FAIL! rc= 7 at Tue Jan 25 13:00:44 MST 2011
026 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue Jan 25 13:01:16 MST 2011
- cam5 baseline tests failed as expected
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers: new climate for cam5 physics
	
The validation run is:
 http://wwwint.cgd.ucar.edu/project/diagnostics/cesm-1.0/amwg/hannay/cam5_0_39_1d_u265/cam5_0_39_1d_u265-obs/

	
======================================================================
===============================================================
Tag name: cam5_0_39
Originator(s): mvr,mvertens
Date: Fri Jan 21 2011
One-line Summary: mods to compute coupler indices locally

Purpose of changes:
The coupler is being changed to not depend on hard-wired indices.  Each component 
will now compute its own indices.  The calculation of the indices will reside in 
a new module called cam_cpl_indices.F90 - that is in a new directory cpl_share 
that is shared between cpl_esmf and cpl_mct. Use of seq_flds_indices is being 
removed.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none
A       models/atm/cam/src/cpl_share
A       models/atm/cam/src/cpl_share/cam_cpl_indices.F90
- new directory and file for computing coupler indices locally
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/bld/configure
- addition of new directory cpl_share to filepath
	
M       models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M       models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
- replaced use of seq_flds_indices with cam_cpl_indices

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: ALL PASS
	
edinburgh/lf95: not tested

edinburgh/pgi: not tested

lynx/pgi: ALL PASS
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers: 
	
======================================================================
===============================================================
Tag name: cam5_0_38
Originator(s): mvr
Date: Fri Jan 07 2011
One-line Summary: updated for esmf metadata capability

Purpose of changes:
The "register" interface in esmf is changing.  This change only
impacts the esmf interfaces, nothing else.  This should all be bfb 
and really only impacts the esmf interface version of the components.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/src/cpl_esmf/atm_comp_mct.F90
M       models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: ALL PASS
	
edinburgh/lf95: not tested

edinburgh/pgi: not tested
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers: 
	
======================================================================
===============================================================

Tag name: cam5_0_37
Originator(s):  Jim Edwards, Mark Taylor
Date: 01-03-2011
One-line Summary: Merge homme dycore development, inline history interpolation

Purpose of changes: Improve support for unstructured grids

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: 

Describe any changes made to the namelist:  Added analysis namelist for homme dycore
	with the following variables:
	interpolate_analysis : logical array which indicates whether each history file should be interpolated to a lat/lon grid
	interp_nlat, interp_nlon : integer variables indicating the size of the lat lon grid to interpolate to
	interp_gridtype: integer indicating the type of output grid to use.
	  ! gridtype = 1       equally spaced, including poles (FV scalars output grid)
          ! gridtype = 2       Gauss grid (CAM Eulerian)
          ! gridtype = 3       equally spaced, no poles (FV staggered velocity)
        interp_type : The type of interpolation to perform, currently supported values are
	  ! interp_type = 0     Native grid high order interpolation
	  ! interp_type = 1     Bilinear interpolation

	

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
       Inline Grid interpolation appears to require some 6-10x more time per history file than writting on the native grid,
       this feature is added as a convenience for the scientist.   If high frequency output is required, or it is required that
       the interpolation meet extraordinary quality standards, then it is recommended to
       output on the native grid and interpolate using the post processing tool provided in homme.       
	
Code reviewed by: Eaton, Taylor, Edwards

List all subroutines eliminated:

List all subroutines added and what they do: interp_mod.F90 provides an interface between cam_history.F90
	and the interpolation functions which may be unique to each dycore.

List all existing files that have been modified, and describe the changes:
      models/atm/cam/SVN_EXTERNAL_DIRECTORIES
      models/atm/cam/src/dynamics/homme/external
   
	The homme/external directory was formerly a copy of the homme source tree, 
	we are now pointing directly at the homme source code repository.  
	
      models/atm/cam/bld/Makefile.in

	Replaced -btextpsize:64k with -btextpsize:32K  for AIX builds, this is a workaround for a bug in AIX which prevents
	debuggers from properly reporting source code lines.
	
      models/atm/cam/bld/build-namelist
      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
      models/atm/cam/bld/namelist_files/namelist_definition.xml
	 
	Added support for the new interpolation fields outlined above
	
      models/atm/cam/src/dynamics/sld/interp_mod.F90
      models/atm/cam/src/dynamics/eul/interp_mod.F90
      models/atm/cam/src/dynamics/fv/interp_mod.F90
       
	Dummy code added to support the interpolation api.  This code could also be
	used to interpolate from one lat/lon grid to another.
	
      models/atm/cam/src/control/cam_history.F90
      models/atm/cam/src/utils/cam_pio_utils.F90
         
	Added code to support history file interpolation, including support for interpolating vector pairs
	which may require simultanious treatment.  

	
      models/atm/cam/src/dynamics/homme/dyn_grid.F90
      models/atm/cam/src/dynamics/homme/interp_mod.F90
      models/atm/cam/src/dynamics/homme/dp_coupling.F90
      models/atm/cam/src/dynamics/homme/dyn_comp.F90
      models/atm/cam/src/dynamics/homme/stepon.F90

	Added code for inline interpolation of history files to a lat-lon grid, merged in latest homme dycore
	development.  

      models/atm/cam/src/control/print_memusage.F90
        Bug fix for intrepid (BGQ) 


      models/atm/cam/chemistry/bulk_aero/dust_intr.F90

	Replaced netcdf calls with pio calls and added interpolation.
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
	011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL
	021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL
	036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL
	040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL
	045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL
	047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL
	063 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL
	066 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL

edinburgh/lf95: 
       004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL
       009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL
       015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL
       022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL
       030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL

edinburgh/pgi or jaguar/pgi: 
      004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL
      009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL
      015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL
      022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL
      030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL
      043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL


	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?
	Failing baseline cases are due to the change in dust_intr.F90, testing shows that this was a round-off 
	change for the fv cases.   The EUL cases however were not on the same grid as the dataset, though they 
	were at the same resolution, which causes the dataset to now be interpolated and thus greater 
	than roundoff error. 

        HOMME dycore baselines are failing because the default history file is now interpolated to a latlon
	grid.  These were tested to be bfb with interpolate_analysis set to .false.

	
If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_0_36
Originator(s): mvr
Date: Tue Jan 05 2011
One-line Summary: updated external definitions of component tags to those 
of cesm1_0_beta13

Purpose of changes:
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 
- new default datasets for plant function types and river routing  

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- new default datasets for plant function types and river routing  

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
- removed entry for obsolete namelist var, hist_crtinic
	
M       models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam5.xml
- bug fix to remove hard-coded file path to solar input datafile
	
M       SVN_EXTERNAL_DIRECTORIES
 M      .
- new component tags for clm, cice (non-bfb), csm_share, and scripts
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Tue Jan  4 13:34:59 MST 2011
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Jan  4 13:35:07 MST 2011
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Tue Jan  4 13:36:36 MST 2011
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue Jan  4 13:36:44 MST 2011
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Tue Jan  4 13:37:14 MST 2011
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Tue Jan  4 13:37:21 MST 2011
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Tue Jan  4 13:37:42 MST 2011
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Tue Jan  4 13:38:08 MST 2011
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Tue Jan  4 13:38:23 MST 2011
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Tue Jan  4 13:38:39 MST 2011
054 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Tue Jan  4 13:38:47 MST 2011
057 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Tue Jan  4 13:38:53 MST 2011
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Tue Jan  4 13:40:34 MST 2011
072 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Tue Jan  4 13:40:40 MST 2011
- baseline failures were expected for any configuration using cice, where changes were not bfb
	
edinburgh/lf95: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Jan  4 13:31:35 MST 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Jan  4 13:31:39 MST 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Jan  4 13:32:41 MST 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Jan  4 13:32:52 MST 2011
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Tue Jan  4 13:32:58 MST 2011
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Jan  4 13:33:03 MST 2011
043 bl318 TBL.sh f10c4cdm outfrq3s 9s .....................................FAIL! rc= 7 at Tue Jan  4 13:34:52 MST 2011
- baseline failures were expected for any configuration using cice, where changes were not bfb

edinburgh/pgi: 
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Jan  5 09:09:58 MST 2011
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Jan  5 09:10:00 MST 2011
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Jan  5 09:10:03 MST 2011
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Jan  5 09:10:06 MST 2011
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Wed Jan  5 09:10:09 MST 2011
035 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan  5 09:10:12 MST 2011
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan  5 09:10:19 MST 2011
046 bl319 TBL.sh fn10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jan  5 09:10:20 MST 2011
- baseline failures were expected for any configuration using cice, where changes were not bfb
	
CAM tag used for the baseline comparison tests if different than previous
tag:
	
Summarize any changes to answers: 
Answer changes were due soley to the new cice tag.  These changes were described as greater than round-off, but 
same climate - please see the cice documentation for more information.

	
======================================================================
===============================================================

Tag name: cam5_0_35
Originator(s): Jerry Olson
Date: Dec 29, 2010
One-line Summary:  fixed "cam3" and "cam3/aquaplanet" to be more
                   consistent with CAM3.1 release.  Adjusted cam4
	           and cam5 aquaplanet namelist parameters.

Purpose of changes: fix cam3 and aquaplanet runs.  Added cldfrc tuning 
	            parameters to namelist.  1 minor bugfix

  List of changes to have the current "cam3" replicate CAM3.1:
    1) models/atm/cam/src/physics/cam/stratiform.F90:         Remove extra cldfrc call after pcond call
    2) models/atm/cam/src/physics/cam/zm_conv_intr.F90:       Shut off convective momentum transport 
    3) models/atm/cam/src/physics/cam/zm_conv.F90:            Call buoyan instead of buoyan_dilute
    4) models/atm/cam/bld/namelist_files/use_cases/cam3.xml:  cldfrc_freeze_dry set to .false.
    5) models/atm/cam/bld/namelist_files/use_cases/cam3.xml:  
        a) tuning parameters are set back to their CAM3.1 levels
	b) orb_iyear, solar_const, GHG values all set back to CAM3.1 values

  Additional changes to have the current "cam3" aquaplanet replicate CAM3.1 aquaplanet:

    1) models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3.xml and
       models/atm/cam/src/control/physconst.F90: 
       modify freezing point of water from 273.15 --> 273.16
    2) copy models/csm_share/shr/shr_flux_mod.F90 to
       models/atm/cam/src/utils/cam_aqua/shr_flux_mod.F90 and modify:
        a) originally uses T rather than virtual T to compute stability functions.
           Changed back to virtual T for aqua_planet.
        b) "umin" set back to 1. from 0.5

    3) models/atm/cam/src/physics/cam/radlw.F90:  initialization of, "cldp", using
                                                  "ntoplw" instead of "ntopcld"

    4) models/atm/cam/src/chemistry/utils/prescribed_ozone.F90:  for unit conversion of APE ozone,
       change universal constants:

         from:
           - real(R8), parameter :: SHR_CONST_MWDAIR = 28.96623324623746_R8
           - real(r8), parameter :: molmass          = 47.9981995_r8
         to:
           - real(r8), parameter :: amass   = 28.9644_r8
           - real(r8), parameter :: molmass = 48._r8

    5) models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3.xml:
        a) solar_const, GHG values set back to CAM3.1 aquaplanet levels:
  	b) orbit set to circular/equinox settings.
        c) dtime set to 5 minutes physics timestep (dtime = 150 for Eulerian dycore)

        NOTE --> All tuning parameters for cam3 aquaplanet are set to standard CAM3.1 T85
	         settings no matter the dycore or resolution.  DTIME set to 5 minutes
	         physics timestep.  User must change in namelist if other settings are
                 desired.
	
 
Bugs fixed (include bugzilla ID):  State variables now output time-averaged
	                           by default when "budget_history" is true.

Describe any changes made to build system:  csm_share/shr and csm_share/dshr
	                                    moved to bottom of Filepath - has
	                                    no effect on answers

Describe any changes made to the namelist:
 When running full model, "cam3" physics, must use "-use_case cam3" in build-namelist call
	(numerous tuning parameter changes to be consistent with CAM3.1 release)
 When running aquaplanet, "cam3" physics, must use "-use_case aquaplanet_cam3" in build-namelist call
	(replaces aquaplanet_cam3_cam4.xml)
 When running aquaplanet, "cam4" physics, must use "-use_case aquaplanet_cam4" in build-namelist call
	(replaces aquaplanet_cam3_cam4.xml)
 When running aquaplanet, "cam5" physics, must use "-use_case aquaplanet_cam5" in build-namelist call

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: self, eaton

List all subroutines eliminated:

	models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3_cam4.xml
	
List all subroutines added and what they do:

	models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3.xml
	  namelist defaults for cam3 aquaplanet
	
	models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam4.xml
	  namelist defaults for cam4 aquaplanet

	models/atm/cam/bld/namelist_files/use_cases/cam3.xml
	  namelist defaults for cam3 full model runs

	models/atm/cam/src/utils/cam_aqua/shr_flux_mod.F90
	  copy of "models/csm_share/shr/shr_flux_mod.F90" for use 
	  when running aqua_planet.  Modified to replicate cam3 aquaplanet
	  results.

	models/atm/cam/test/system/config_files/f10c3aqdm
	  regression test added to test cam3 aquaplanet

List all existing files that have been modified, and describe the changes:

   models/atm/cam/bld/build-namelist
    - added cldfrc tuning parameters
	
   models/atm/cam/bld/configure
   models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
    - moved some namelist defaults to "cam3.xml", added cldfrc tuning params
	
   models/atm/cam/bld/namelist_files/namelist_definition.xml
    - cldfrc tuning params
	
   models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam5.xml
    - set some new aqua_planet defaults
	
   models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
    - changed physical constants for cam3 aquaplanet
	
   models/atm/cam/src/control/physconst.F90
    - set tmelt to be initialized at runtime
	
   models/atm/cam/src/physics/cam/cam_diagnostics.F90
    - made state variables time averaged rather than instantaneous
      on output when "history_budget" is .true.
	
   models/atm/cam/src/physics/cam/cldwat2m_macro.F90
   models/atm/cam/src/physics/cam/cldwat2m_micro.F90
    - set tmax_fsnow, tmin_fsnow to be initialized at runtime
	
   models/atm/cam/src/physics/cam/cldwat.F90
    - set tmax_fsnow, tmin_fsnow, tmax_fice, tmin_fice to be initialized at runtime
	
   models/atm/cam/src/physics/cam/cloud_fraction.F90
    - made cldfrc tuning params namelist parameters
	
   models/atm/cam/src/physics/cam/microp_driver.F90
    - made state variables time averaged rather than instantaneous
      on output when "history_budget" is .true.
	
   models/atm/cam/src/physics/cam/physpkg.F90
    - call inimc from here rather than from stratiform
	
   models/atm/cam/src/physics/cam/radlw.F90
    - code change to fix cam3 physics
	
   models/atm/cam/src/physics/cam/stratiform.F90
    - made state variables time averaged rather than instantaneous
      on output when "history_budget" is .true.
    - Remove extra cldfrc call after pcond call (cam3 physics change)

   models/atm/cam/src/physics/cam/zm_conv.F90
    - Call buoyan instead of buoyan_dilute (cam3 physics change)
	
   models/atm/cam/src/physics/cam/zm_conv_intr.F90
    - Shut off convective momentum transport (cam3 physics change)
	
   models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_init.f90
    - set physics constants from "physconst" rather than "shr_const_mod"
	
   models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_init.f90
    - set physics constants from "physconst" rather than "shr_const_mod"
	
   models/atm/cam/test/system/input_tests_master
    - use aquaplanet .xml files for all aquaplanet regression tests
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
	All pass except the following baseline tests which change due to changes in aquaplanet
006 bl133 TBL.sh e48c4paqdm aqpgro+aquaplanet_cam4 3s .....................FAIL! rc= 5 at Tue Dec 28 14:14:56 MST 2010
013 bl330 TBL.sh f4c5paqdh aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Tue Dec 28 14:42:34 MST 2010
023 bl333 TBL.sh f4c4paqdh aqpgro+aquaplanet_cam4 3s ......................FAIL! rc= 5 at Tue Dec 28 15:06:39 MST 2010
063 bl731 TBL.sh h16c3aqdh aqua+aquaplanet_cam3 9s ........................FAIL! rc= 5 at Tue Dec 28 18:19:21 MST 2010
066 bl751 TBL.sh h30c4aqdm outfrq3s+aquaplanet_cam4 9s ....................FAIL! rc= 5 at Tue Dec 28 18:31:44 MST 2010
	
edinburgh/lf95:
	All pass except the following baseline tests which change due to changes in aquaplanet and/or cam3
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Dec 29 11:36:29 MST 2010...
032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 5 at Wed Dec 29 12:48:00 MST 2010...
038 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 5 at Wed Dec 29 13:22:18 MST 2010...
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Dec 29 13:33:49 MST 2010...
	
edinburgh/pgi or jaguar/pgi:
	All pass except the following baseline tests which change due to changes in aquaplanet and/or cam3
011 bl113 TBL.sh e8c5paqdm aqpgro+aquaplanet_cam5 3s ......................FAIL! rc= 7 at Wed Dec 29 11:36:01 MST 2010...
032 bl313 TBL.sh f10c3aqdm outfrq3s+aquaplanet_cam3 3s ....................FAIL! rc= 5 at Wed Dec 29 11:52:15 MST 2010...
038 bl315 TBL.sh f10c3dm outfrq3s+cam3 9s .................................FAIL! rc= 5 at Wed Dec 29 12:09:40 MST 2010...
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Wed Dec 29 12:16:19 MST 2010...
049 bl734 TBL.sh hn16c5aqdm outfrq3s+aquaplanet_cam5 9s ...................FAIL! rc= 7 at Wed Dec 29 13:09:07 MST 2010...

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except > RO changes in aquaplanet and any cam3 runs 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_34
Originator(s): Jim Edwards
Date: Dec 21, 2010
One-line Summary: fix mpi issues

Purpose of changes: bug fixes

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: self

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
   mo_lightning.F90 : needed to add optional commm parameter to repro_sum calls
   metdata.F90 :  needed to move pio_closefile call out of mastertask only clause.

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all pass

edinburgh/lf95:  all pass 

edinburgh/pgi or jaguar/pgi:  all pass 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):   None

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam5_0_33
Originator(s): mvr, jenkay
Date: Thu Dec 16 2010
One-line Summary: extended cosp code to work with cam5 physics; update 
to latest cosp vendor tag

Purpose of changes:
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: 
A      models/atm/cam/test/system/config_files/f10c5cdm
- new configuration options test file for testing cosp with cam5 physics
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_edinburgh_pgi
- added test for cosp/cam5 to default suite of tests on edinburgh/pgi
- removed test for cosp/cam4 from default suite (still remains in edinburgh/lahey)

M      models/atm/cam/test/system/input_tests_master
- added definition of news tests for cosp/cam5

M      models/atm/cam/bld/configure
- no longer dies for cosp/cam5 configuration

M      models/atm/cam/bld/namelist_files/namelist_definition.xml
- entry for cosp_nradsteps; correction to cosp_histfile_num's type
	
M      models/atm/cam/src/physics/cam/initindx.F90
- added call to new method, conv_water_register

M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/cam/stratiform.F90
M      models/atm/cam/src/physics/cam/cosp_share.F90
M      models/atm/cam/src/physics/cam/convect_shallow.F90
M      models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M      models/atm/cam/src/physics/cam/microp_driver.F90
M      models/atm/cam/src/physics/cam/cldwat2m_micro.F90
M      models/atm/cam/src/physics/cam/conv_water.F90
M      models/atm/cam/src/physics/cam/uwshcu.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90
- local mods needed to work with new cosp vendor code to enable cosp 
  to work with cam5 physics
	
M      models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 M     models/atm/cam
- update to latest cosp vendor tag

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: ALL PASS

edinburgh/lf95: 
043 bl318 TBL.sh f10c4cdm outfrq3s 9s .....................................FAIL! rc= 7 at Thu Dec 16 11:10:47 MST 2010
- expected failure for cosp using cam4 due to changes in external cosp code

edinburgh/pgi: 
043 bl317 TBL.sh f10c5cdm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Dec 15 13:57:42 MST 2010
- new test for cosp using cam5 failed because baseline code did not recognize test configuration
	
CAM tag used for the baseline comparison tests if different than previous
tag:
**note: additional tests were performed for cosp using both cam4 and cam5 where results 
	were compared to the cosp branch tag, cosp08_cam5_0_18...results were b4b
	
Summarize any changes to answers: BFB

	
======================================================================
===============================================================

Tag name: cam5_0_32
Originator(s): Edwards, Vitt
Date: 12-10-10
One-line Summary: Generalize chemistry data input for unstructured grids

Purpose of changes: Extend unstructured grid functionality to chemistry/ cam5

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
	Changed default drydep_method to xactive_lnd except when modal chemistry is activated
        Added variable drydep_srf_file to chem_inparm namelist, this allows drydep surface values
	     to be interpolated to the cam grid offline by the new tool mkatmsrffile
	
List any changes to the defaults for the boundary datasets:
	

Describe any substantial timing or memory changes:

Code reviewed by: Edwards, Vitt, Kinnison, Lamarque, Marsh, Eaton

List all subroutines eliminated:

List all subroutines added and what they do:
   Added atm/cam/tools/mkatmsrffile to create fraction_landuse and soilw fields off line
	
List all existing files that have been modified, and describe the changes:
      models/atm/cam/tools/interpic_new/README
	extended instructions for creating homme dycore input data files
      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
	added defualts for drydep_method and drydep_srf_file
      models/atm/cam/bld/namelist_files/namelist_definition.xml
	added drydep_srf_file
      models/atm/cam/src/chemistry/utils/mo_flbc.F90
      models/atm/cam/src/chemistry/mozart/mo_lightning.F90
      models/atm/cam/src/chemistry/mozart/mo_chemini.F90
      models/atm/cam/src/chemistry/mozart/mo_airplane.F90
      models/atm/cam/src/chemistry/mozart/mo_fstrat.F90
      models/atm/cam/src/chemistry/mozart/mo_photo.F90
      models/atm/cam/src/chemistry/mozart/mo_strato_sad.F90
	changed IO and interpolation methods

      models/atm/cam/src/chemistry/utils/tracer_data.F90
	removed unused use statement
      models/atm/cam/src/chemistry/mozart/mo_setext.F90
	moved airplane specific code to mo_airplane.F90

      models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
        updated interfaces to chemistry code with new IO and
	interpolation methods
	
      models/atm/cam/src/chemistry/mozart/chemistry.F90
         added support for new namelist variable drydep_srf_file
	 removed hard coded string lengths and replaced with shr_kind_cl
	
      models/atm/cam/src/chemistry/mozart/mo_drydep.F90
         added support for reading fraction_landuse and soilw as generated offline
	 
      models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
	fraction_landuse changed from lat/lon grid to model grid
      models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
	changed interface to set_ub_col


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.


bluefire:  
	All pass except the following baseline tests which change due to changes in interpolation
        033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s
        045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s
        050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s
        060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d

edinburgh/lf95: All pass 

edinburgh/pgi or jaguar/pgi: All pass


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
           cam4 with chemistry	
 what platforms/compilers:   All
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):  

  Larger than roundoff changes in interpolation of input fields most pronounced near the
  poles due to changes in interpolation method.

If bitwise differences were observed, how did you show they were no worse
than roundoff?
       
	
If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
Tag name: cam5_0_31
Originator(s): mvr, eaton, sungsu, gettleman
Date: Mon Dec 06 2010
One-line Summary: corrected the default settings for compiler type on linux 
systems; fix to unwanted side-effect of using do_circulation_diags; mod to 
enable running cam5 physics without chemistry; default settings added for 
divergence damping and velocity diffusion as well as the number of vertical 
re-mapping timesteps per physics timestep; bug fix in shallow convection 
scheme; added a few new tests, changed the names of a few others

Purpose of changes:
The previous tag broke cam testing on the crays, where the test scripts were 
relying on default settings for compiler type...changes to Makefile.in were 
applied to address this problem

We discovered that the CAM use case files that set do_circulation_diags=.true. 
were having the undesirable side effect of writing the 3D field TH into the 
daily avg h1 file. 
	
Modifications were added to get cam5 with -chem none option to produce a 
climate 'similar' to standard cam5.  This also enabled running the homme 
dycore with cam5 physics - tests were added to exercise these. (gettleman)

Default setting added for divergence damping and velocity diffusion at 1deg 
for cam5 (was 2, now 4)

Default settings added for the number of vertical re-mapping timesteps per 
physics timestep: 2 for 0.5deg and 0.25deg and 1 otherwise

The shallow convection scheme needed a fix to prevent division by zero in 
computing cumulus top height (sungsu).

edinburgh testing will now test separate suites for lahey and pgi compilers

Scam test using cam5 will now have chemistry enabled.

Default homme testing now done at higher resolution (h30np4) on bluefire

	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: 
- add_default for nspltvrm (number of vertical re-mapping timesteps per 
  physics timestep)
- corrected default settings for compiler type on linux systems

List any changes to the defaults for the boundary datasets:
- new inic file for homme using cam5 physics

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none
D       models/atm/cam/test/system/config_files/f10c5pdm
D       models/atm/cam/test/system/config_files/e48c4pdm
D       models/atm/cam/test/system/config_files/e8c5pdm
D       models/atm/cam/test/system/config_files/h16x4c3dh
D       models/atm/cam/test/system/config_files/e64c5pm
D       models/atm/cam/test/system/config_files/s8c5pdm
D       models/atm/cam/test/system/config_files/s32c5pdh
D       models/atm/cam/test/system/config_files/f4c5pdh
D       models/atm/cam/test/system/config_files/f4c4pdh
- these configuration options files (used by test scripts) were renamed

D       models/atm/cam/test/system/config_files/h16c4aqdm
D       models/atm/cam/test/system/tests_pretag_edinburgh
- removed these obsolete test files
	
List all subroutines added and what they do: 
A  +    models/atm/cam/test/system/config_files/e64c5paqm
A  +    models/atm/cam/test/system/config_files/s32c5paqdh
A  +    models/atm/cam/test/system/config_files/f4c4paqdh
A  +    models/atm/cam/test/system/config_files/f10c5paqdm
A  +    models/atm/cam/test/system/config_files/f4c5paqdh
A  +    models/atm/cam/test/system/config_files/e8c5paqdm
A  +    models/atm/cam/test/system/config_files/s8c5paqdm
A  +    models/atm/cam/test/system/config_files/h16c3aqdh
A  +    models/atm/cam/test/system/config_files/e48c4paqdm
- these are newly named configuration options files (used by test scripts)

A       models/atm/cam/test/system/config_files/h30c4aqdm
A       models/atm/cam/test/system/config_files/hn16c5aqdm
A       models/atm/cam/test/system/config_files/fn10c5dm
- these are new configuration options files needed for new tests

A       models/atm/cam/test/system/tests_pretag_edinburgh_lahey
A       models/atm/cam/test/system/tests_pretag_edinburgh_pgi
- will now have separate default test suites depending on the edinburgh compiler used
- new tests added to pgi suite
	
List all existing files that have been modified, and describe the changes:
M       models/atm/cam/test/system/tests_pretag_bluefire
- default homme testing now done at higher resolution on bluefire
	
M       models/atm/cam/test/system/config_files/scm64c4bfbiop
M       models/atm/cam/test/system/config_files/e64c4bfbiop
- removed redundant setting of '-chem none' from cam4 scam test
- speeding up global 3d portion of test to run with mpi-only rather than serial

M       models/atm/cam/test/system/config_files/scmc5armiop
M       models/atm/cam/test/system/config_files/scm64c5bfbiop
M       models/atm/cam/test/system/config_files/e64c5bfbiop
- removed setting of '-chem none' to test default chemistry as part of cam5 scam test
- speeding up global 3d portion of test to run with mpi-only rather than serial
	
M       models/atm/cam/test/system/test_driver.sh
- will now have separate default test suites depending on the edinburgh compiler used

M       models/atm/cam/test/system/input_tests_master
- changes to test definitions due to filename changes with configuration options
- several new tests added, cleanup

M       models/atm/cam/bld/Makefile.in
- on linux systems, made the default fc_type pgi and set the default C compiler to 
  cc when the fortran compiler is ftn
- added the same optimization to the CFLAGS for pgi that is set in the
  CESM macros (for consistency)

M       models/atm/cam/bld/config_files/definition.xml
- The parameters cflags, fflags, and ldflags have all had the list="1" attribute added, 
  to allow adding flag values that contain commas.

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- new inic file for homme using cam5 physics
- new default settings for the number of vertical re-mapping timesteps per physics timestep
- new default setting for divergence damping and velocity diffusion for 1deg cam5
	
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1955-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1974-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_refb1.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
- Add the fields from the removed add_default calls (VTH2d, WTH2d, UV2d,
   UW2d, TH, and MSKtem) explicitly to the fincl2 specification in *all*
   WACCM use cases

M       models/atm/cam/bld/build-namelist
- add_default added for nspltvrm
	
M       models/atm/cam/src/physics/cam/microp_aero.F90
- modifications to get cam5 with -chem none to produce a climate 'similar' to 
  standard cam5 (gettleman)
	
M       models/atm/cam/src/physics/cam/uwshcu.F90
- fix to prevent division by zero in computing cumulus top height in shallow convection 
  scheme (sungsu)
	
M       models/atm/cam/src/dynamics/fv/ctem.F90
- remove the add_default calls for VTH2d, WTH2d, UV2d, UW2d, TH, and MSKtem

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
006 bl133 TBL.sh e48c4paqdm aqpgro 3s .....................................FAIL! rc= 7 at Mon Dec  6 09:46:12 MST 2010
013 bl330 TBL.sh f4c5paqdh aqpgro 3s ......................................FAIL! rc= 7 at Mon Dec  6 09:46:13 MST 2010
023 bl333 TBL.sh f4c4paqdh aqpgro 3s ......................................FAIL! rc= 7 at Mon Dec  6 09:46:51 MST 2010
063 bl731 TBL.sh h16c3aqdh aqua 9s ........................................FAIL! rc= 7 at Mon Dec  6 11:19:38 MST 2010
066 bl751 TBL.sh h30c4aqdm outfrq3s 9s ....................................FAIL! rc= 7 at Mon Dec  6 11:31:15 MST 2010
- bl751 is a new test, the other failures were due to name changes of the configuration options files

edinburgh/lf95: 
011 bl113 TBL.sh e8c5paqdm aqpgro 3s ......................................FAIL! rc= 7 at Mon Dec  6 09:42:07 MST 2010
032 bl313 TBL.sh f10c5paqdm aqpgro 3s .....................................FAIL! rc= 7 at Mon Dec  6 10:37:41 MST 2010
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Mon Dec  6 10:59:10 MST 2010
- failures were due to name changes of the configuration options files

edinburgh/pgi: 
011 bl113 TBL.sh e8c5paqdm aqpgro 3s ......................................FAIL! rc= 7 at Mon Dec  6 09:30:14 MST 2010
032 bl313 TBL.sh f10c5paqdm aqpgro 3s .....................................FAIL! rc= 7 at Mon Dec  6 09:56:54 MST 2010
040 bl316 TBL.sh f10c5paqdm aqpgro+aquaplanet_cam5 3s .....................FAIL! rc= 7 at Mon Dec  6 10:05:49 MST 2010
046 bl319 TBL.sh fn10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Dec  6 10:14:43 MST 2010
049 bl734 TBL.sh hn16c5aqdm outfrq3s 9s ...................................FAIL! rc= 7 at Mon Dec  6 10:35:24 MST 2010
- bl734 and bl319 are new tests, the other failures were due to name changes of the configuration options files
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

======================================================================
======================================================================
Tag name:  cam5_0_30 
Originator(s): Diane Feddema 
Date: Dec 1 2010 
One-line Summary: Add new command line option to CAM's configure, fc_type. Also code cleanup. 

Purpose of changes: CAM's configure and Makefile now allow the user to specify which compiler they want when 
they specify the wrapper script ftn as their compiler.   fc_type is the underlying compiler that
will be invoked, valid options are pgi, intel, pathscale, lahey.  

Bugs fixed (include bugzilla ID): None 

Describe any changes made to build system: CAM's configure has a new commandline option, fc_type. 

Describe any changes made to the namelist:None

List any changes to the defaults for the boundary datasets:None

Describe any substantial timing or memory changes: None

Code reviewed by:Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/bld/config_files/definition.xml 
         - added fc_type

M      models/atm/cam/bld/configure
         - added fc_type command line option 

M      models/atm/cam/bld/Makefile.in 
         - added support for fc_type command line option 

M      models/atm/cam/src/physics/cam/convect_shallow.F90
         - removed duplicate declarations 


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   None
	
edinburgh/lf95: None
	
edinburgh/pgi or jaguar/pgi: None


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

	All tests are BFB  

If bitwise differences were observed, how did you show they were no worse
than roundoff?

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name:  cam5_0_29 
Originator(s): Andrew Gettelman and Cheryl Craig
Date: Nov 23 2010 
One-line Summary: Separate microp/macrop physics

Purpose of changes: Separate microphysics and macrophysics drivers in CAM5 code

Bugs fixed (include bugzilla ID): Fix a bug in call to conv_water_4rad that would 
       lead to erroneous results with conv_water_in_rad=2 option if invoked.

Describe any changes made to build system:None

Describe any changes made to the namelist:None

List any changes to the defaults for the boundary datasets:None

Describe any substantial timing or memory changes: None

Code reviewed by:Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

 
A      models/atm/cam/src/physics/cam/macrop_driver.F90
          - File which contains the macrop physics processing which 
            had resided in stratiform
A      models/atm/cam/src/physics/cam/microp_driver.F90
          - File which contains the microp physics processing which 
            had resided in stratiform
A      models/atm/cam/src/physics/cam/conv_water.F90
          - File which contains the convective water processing which 
            had resided in stratiform


List all existing files that have been modified, and describe the changes:

M      models/atm/cam/src/physics/cam/microp_aero.F90
         - changed to support separation of microphysics and macrophysics and 
           concentrate aerosol information there


M      models/atm/cam/src/physics/cam/param_cldoptics.F90
         - Changed file to support separation of the macro and micro physics code
         - Fixed the bug found when conv_water_in_rad = 2 in the call to conv_water_4rad

M      models/atm/cam/src/physics/cam/initindx.F90
M      models/atm/cam/src/physics/cam/physpkg.F90
M      models/atm/cam/src/physics/cam/stratiform.F90
M      models/atm/cam/src/physics/cam/tphysbc.F90
M      models/atm/cam/src/dynamics/sld/inidat.F90
M      models/atm/cam/src/dynamics/eul/inidat.F90
M      models/atm/cam/src/dynamics/homme/inidat.F90
M      models/atm/cam/src/dynamics/fv/inidat.F90
         - Changed files to support separation of the macro and micro physics code

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   None
	
edinburgh/lf95: None
	
edinburgh/pgi or jaguar/pgi: None


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

	All tests are BFB  

If bitwise differences were observed, how did you show they were no worse
than roundoff?

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_28
Originator(s): mvr,jenkay,jedwards,hannay
Date: Mon Nov 22 2010
One-line Summary: pio namelist changes; mods to handle variable orbital settings; 
time_manager mods for calendar type; diagnostics added; added support to test 
scripts for additional machines; updated externals

Purpose of changes:
- pio now controlled by settings in pio_inparm of the drv namelist 
- now resetting orbital parameters at run phase
- time_manager to use share constants for calendar type, new method for cf standards
- new diagnostics for inversion parameters and visible cloud optical depth (jenkay),
  additional history_aerosol diagnostics (hannay)
- support was added to test scripts for jaguarpf and lynx_pgi
- external definitions updated for drv,clm,docn,cice,share,mct,scripts,pio to
  match those intended for cesm1_0_beta11

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:
- fix to settings for initial conditions files for cam5 at half and one degree fv
- updated to use the gx1v6 version of both the 1/4 deg focndomain and fatmlndfrc files

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: 
A       models/atm/cam/bld/run-lynx.csh
- template run script for ncar cray, lynx 

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/test/system/tests_pretag_bluefire
- reinstated tests er731 and bl731 to default suite on bluefire

M       models/atm/cam/test/system/test_driver.sh
M       models/atm/cam/test/system/CAM_runcmnd.sh
- added support to test scripts for jaguarpf, lynx_pgi

M       models/atm/cam/test/system/nl_files/fvvp_lb2
M       models/atm/cam/test/system/nl_files/fvvp_lb0
- modified test definition to utilize more of the requested resources

M       models/atm/cam/bld/Makefile.in
- added -DNO_MPI2 to all serial builds

M       models/atm/cam/bld/build-namelist
- namelist variable changed from orb_iyear_ad to orb_iyear

M       models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam5.xml
M       models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3_cam4.xml
- now specifying orb_mode=fixed_parameters in use_cases where any orbital info is specified

M       models/atm/cam/src/chemistry/utils/mo_solar_parms.F90
- replaced PIO_NOCLOBBER with PIO_NOWRITE to enable running on lynx, which uses NETCDF 4 
	
MM      models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
- additional diagnostics output if history_aerosol

M      models/atm/cam/bld/configure
- removed references to USE_ESMF_LIB

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- fix to settings for initial conditions files for cam5 at half and one degree fv
- namelist variable changed from orb_iyear_ad to orb_iyear
- updated to use the gx1v6 version of both the 1/4 deg focndomain and fatmlndfrc files

M      models/atm/cam/bld/namelist_files/namelist_definition.xml
- mods to reflect changes in the pio namelist
- namelist variable changed from orb_iyear_ad to orb_iyear
- new entry for orb_mode

M      models/atm/cam/src/utils/cam_pio_utils.F90
M      models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
- mods needed in connection with pio changes

M      models/atm/cam/src/control/runtime_opts.F90
- removed unneeded broadcasts of orbital parameters

M      models/atm/cam/src/control/cam_control_mod.F90
- cleanup of parameter iyear_ad

M      models/atm/cam/src/control/cam_history.F90
- replaced use of get_calendar with get_calendar_cf to retrieve cf standard calendar name
- mods needed in connection with pio changes

M      models/atm/cam/src/utils/time_manager.F90
- now using share values for noleap and gregorian calendar names
- removed method get_calendar
- new method, timemgr_is_caltype, returns true if incoming calendar type string
        matches actual calendar type in use
- new method, timemgr_get_calendar_cf, returns cf standard for calendar type
- removed references to USE_ESMF_LIB

M      models/atm/cam/src/utils/cam_csim4/ice_time_manager.F90
M      models/atm/cam/src/utils/cam_dom/ocn_time_manager.F90
- now using share values for noleap and gregorian calendar names
- removed method get_calendar
- new method, timemgr_is_caltype, returns true if incoming calendar type string
        matches actual calendar type in use

M      models/atm/cam/src/cpl_mct/atm_comp_mct.F90
- now resetting orbital parameters with each run phase, rather than just at init

M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/cam/radsw.F90
- new visible cloud optical depth diagnostics for cam4 (from jenkay)

M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
- new inversion diagnostics (from jenkay)

M      models/atm/cam/src/physics/rrtmg/radiation.F90
- new visible cloud optical depth diagnostics for cam5 (from jenkay)

M      models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M      models/atm/cam/src/chemistry/utils/tracer_data.F90
- removed references to get_calendar method in time_manager.F90

M      models/atm/cam/src/chemistry/mozart/spedata.F90
M      models/atm/cam/src/dynamics/fv/metdata.F90
- replaced use of get_calendar with timemgr_is_caltype and shr constants

M      models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
- added code to load orbital parameters

M      models/atm/cam/src/control/cam_comp.F90
- cleanup of comments referring to orbital parameters

M       SVN_EXTERNAL_DIRECTORIES
 M      .
- updated external definitions of component tags to those meant for cesm1_0_beta11

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
063 bl731 TBL.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 7 at Mon Nov 22 00:57:53 MST 2010
- failure due to test being reinstated and therefore not recognized by baseline scripts
	
**Note that sm731 had been failing up until this tag.  It is unclear what exactly
  was responsible for it now passing.  Through isolating each of the modifications
  going in with this tag, it appears to have something to do with the changes made
  in time_manager.F90, where one method was removed and two were added.

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_27
Originator(s): eaton
Date: Thu Nov 18 14:55:18 MST 2010
One-line Summary: Remove dependence of modal optics calc on prognostic MAM.

Purpose of changes:

. The first step in providing a prescribed modal aerosol capability is to
  make the current prognostic MAM interact with the radiative heating
  calculation via the rad_constituents module.  This commit is just part of
  the first step; the dependence of the modal_aer_opt module on the
  prognostic MAM code has been removed.  A side effect of this refactoring
  in modal_aer_opt was an extensive code clean up including removal of the
  inactive mie code (which can be reintroduced later if desired).

  The major structural change in modal_aer_opt is to reorder the loops so
  that the loop over modes is the outermost loop.  This is in preparation
  for doing diagnostic forcing calculations in which some modes are
  excluded from having a radiative effect.  The ability to do these
  diagnostic calculations is not yet in place.
  
  The rad_constituents interface is used to access the physical properties
  and mass mixing ratios of the individual species in each mode.  The
  rad_constituents interface requires the names of the species (as stored
  in the state or physics buffer) to access properties.  The names of the
  species in each mode (which is hardcoded in the prognostic MAM code) were
  added to the modal optics data file to make them accessible for either
  prognostic or prescribed modal optics calculations.

  The existing rad_constituent interfaces used list indexes to access the
  individual aerosols.  The interface was intended to be used in a context
  where the aerosols were all considered to be bulk aerosols whose optical
  properties would be externally mixed.  But in the modal context where the
  species are internally mixed we would like to be able to access
  individual species by name.  So generic methods have been added to the
  rad_constituents interfaces that allow requesting the physical properties
  and the mass mixing ratios either by index or by name.

  The namelist setting for rad_climate was updated to include all the
  3-mode species.  This is required to use the rad_constituents interface
  to retrieve properties and mmr for all the species contributing to the
  modes.

  The species refractive indices were being read from the physprops files,
  but the species densities were hardcoded and the densities in the
  physprops files did not match the hardcoded values.  So the physprops
  files were updated to contain the hardcoded values and the prognostic MAM
  code was changed to set the densities from the files.

  The phys_prop module had been hacked to get the refractive index of water
  from the physprops files of the first aerosol, and the refractive index
  of water data was duplicated in all the aerosol species files.  Remove
  this hack and put water refractive index in it's own file.  Read the data
  in the modal_aer_opt module since that's where it's used.  Give
  modal_aer_opt its own namelist for reading the name of both the water
  refindex file and the modal optics file.

  Refactor phys_prop and rad_constituents interfaces to pass complex form
  of refractive index.

  Refactor phys_prop to read refractive index data if it's present.  Don't
  depend on MODAL_AERO cpp token which is only defined for prognostic MAM.


Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:

. rad_climate updated for trop_mam3 to include all species that contribute
  to the modes.

List any changes to the defaults for the boundary datasets:

. The modal optics file has been updated to include the metadata that
  describes the modes, i.e., the number of species in each mode, the names
  of the species in each mode, and the types of the species in each mode.
  The original file, modal_optics_3mode.nc, was updated and renamed
  modal_optics_3mode_c100507.nc.

. The following files have the "density" variables updated to match the
  hardcoded values in the trop_mam3 code.

  bcpho_rrtmg_c090310.nc --> bcpho_rrtmg_c100508.nc
  ocpho_rrtmg_c100528.nc --> ocpho_rrtmg_c101112.nc
  ocphi_rrtmg_c080918.nc --> ocphi_rrtmg_c100508.nc
  ssam_rrtmg_c080918.nc  --> ssam_rrtmg_c100508.nc

. A new file was constructed that contains the refractive index data for
  water.  The file was created by extracting the data from
  ocpho_rrtmg_c080918.nc.  It's named water_refindex_rrtmg_c080910.nc

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add all 3-mode species to the rad_climate specifier

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update the modal_optics file
. update the physprop files
. change modal_optics to modal_optics_file and change the attribute from
  chem to aero which is set in build-namelist depending on whether 3mode or
  7mode aerosols are used.  But it's no longer dependent on particular
  chemistry scenarios in anticipation of a prescribed modal aerosol
  capability.
. add water_refindex_file

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add water_refindex_file
. change modal_optics to modal_optics_file and move out of rad_cnst_nl and
  into modal_aer_opt_nl.

models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
. use rad_constituents interface to set specdens_amode
. update the rad_cnst_get_aer_props interfaces to get complex refractive
  index and copy to local storage

models/atm/cam/src/control/filenames.F90
. remove modal_optics

models/atm/cam/src/control/runtime_opts.F90
. remove modal_optics
. add call to modal_aer_opt_readnl

models/atm/cam/src/physics/cam/aer_rad_props.F90
. rename aer_rad_props_get_clim_{sw,lw} to aer_rad_props_{sw,lw}
. remove loop over sw bands around call to modal_aero_sw
. move the call to modal_size_parameters inside modal_aero_sw.

models/atm/cam/src/physics/cam/modal_aer_opt.F90
. remove unused AEROCOM declarations
. remove calc_optics option - currently hardcoded to not operate
. remove miefit, fitcurv, fitcurvlin, chebft, write_modal_optics
. remove BACKSCAT which was only used for mie calcs
. remove "use mpishorthand" -- not referenced
. remove module variables nrefr, nrefi -- they're not used as variables, so
  just use the parameters prefr, prefi
. move the loop over sw bands inside modal_aero_sw
. move the call to modal_size_parameters inside modal_aero_sw.
. modal_aero_sw 
  - change args to match aer_rad_props_sw (except diagnostic capability not
    implemented yet)
  - pull some initializations outside the loop over sw bands
  - switch the order of the outer level and mode do loops putting the mode
    loop on the outside.  This causes roundoff diffs in AODABS, AODVIS,
    SSAVIS.  These are diagnostic fields that are summed over both level
    and mode, so interchanging that sum introduces a roundoff difference.
  - move the initializations of the diagnostic output outside the sw loop.
    Need to put the burden calc inside a savaervis conditional.
  - move the mode loop outside the sw band loop.  The diagnostic output
    moves outside all the loops since the arrays used for output are only
    set for the visible band.
  - replace direct use of state%q by call to rad_cnst_get_aermmr in the
    aerosol species loop
  - refactor dust aod diagnostic to look for xname_spectype='dust'
  - remove the else clause in the computation of the dustaodmode
    calculation.  This is a bug.  The calc is accumulating contributions to
    dustaodmode inside a loop over levels.  Setting the whole result to
    zero upon encountering a layer with wetvol<=1.e-40 is zeroing the
    entire accumulation over levels to that point rather than just zeroing
    the contribution from that level.
  - use rad_cnst_get_aer_props to get species densities
. modal_aero_lw::
  - change args to match aer_rad_props_lw (except diagnostic capability not
    implemented yet)
  - repeat the same refactoring that was done in modal_aero_sw to reorder
    loops and obtain the species mmr, density, and refractive index from
    the rad_constituent interfaces.
. read_modal_optics
  - modes arg removed.  Will instead set module variable ntot_amode with
    the number of modes.
  - remove all args that are just being used to set module data, and
    instead set it directly.
  - read new variables that contain the number of species in each mode, and
    the species names and types from optics file.
  - move sigma_logr_aer from local to module data so that it can be used
    instead of modal_aero_data::sigmag_amode
. add subroutine modal_aer_opt_readnl to read modal_optics_file and
  water_refindex_file.
. add new subroutine read_water_refindex and use it to set the module data
  for complex water refractive index
. remove the call to rad_cnst_get_clim_aer_prop to access water refractive
  index data
. remove unused wavelength band arguments from modal_aer_opt_init
. access species refractive index via rad_cnst_get_aer_props
. add alnsg_amode as module data that is set using the sigma_logr_aer field
  read from the modal optics file, rather than being set from the hardcoded
  values of sigmag_amode in modal_aero_data
. allocate/deallocate arrays with sizes that depend on the number of modes.
. remove ifdef MODAL_AERO -- the code is now independent of prognostic MAM

models/atm/cam/src/physics/cam/phys_prop.F90
. remove reading of water refractive index.
. refindex_aer_init - get rid of the ifdef MODAL_AERO by adding checks that
  the refindex variables are present in the file before trying to read
  them.  Only allocate space if the variable is present.
. supply the complex version of the refractive index data directly rather
  than as real and imaginary parts.

models/atm/cam/src/physics/cam/rad_constituents.F90
. implement generic rad_cnst_get_aer_mmr
. implement generic rad_cnst_get_props
. remove optional args that provide water refindex via the
  rad_cnst_get_aer_props interfaces.
. update the rad_cnst_get_aer_props interfaces to pass complex refractive
  index 

models/atm/cam/src/physics/cam/radiation.F90
. rename aer_rad_props_get_clim_{sw,lw} to aer_rad_props_{sw,lw}

models/atm/cam/src/physics/rrtmg/radiation.F90
. rename aer_rad_props_get_clim_{sw,lw} to aer_rad_props_{sw,lw}
. remove wavelength band args from call to modal_aer_opt_init

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Fri Nov 12 13:02:18 MST 2010
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Fri Nov 12 13:29:39 MST 2010
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Fri Nov 12 14:12:22 MST 2010
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Fri Nov 12 14:32:34 MST 2010
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Fri Nov 12 15:22:29 MST 2010
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Fri Nov 12 18:31:10 MST 2010

edinburgh/lf95: All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Nov 12 13:01:04 MST 2010
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Nov 12 13:45:01 MST 2010
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Nov 12 14:30:07 MST 2010
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Nov 12 15:43:19 MST 2010
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Fri Nov 12 16:28:54 MST 2010

edinburgh/pgi: All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Fri Nov 12 11:41:25 MST 2010
009 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Fri Nov 12 11:51:29 MST 2010
015 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Fri Nov 12 12:02:37 MST 2010
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Fri Nov 12 12:19:57 MST 2010
030 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Fri Nov 12 12:33:58 MST 2010

The baseline failures are all due to roundoff diffs introduced into the
diagnostic fields AODABS, AODVIS, and SSAVIS.

sm731 is a pre-existing failure.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except roundoff changes in some
  diagnostic fields for trop_mam3.

===============================================================
===============================================================

Tag name:  cam5_0_26
Originator(s): jet
Date: Wed Nov 03 2010
One-line Summary:Fix bug with new dynamics namelists,update external tags for high res support and Flow control

Purpose of changes:  There was a group name error for the spectral namelists that prevented user modifications of the dynamics variables via the namelist.  Support for high resolution

Bugs fixed (include bugzilla ID):Fixed namelist bug created during last commit.

Describe any changes made to build system:Updated SVN_EXTERNALS to reflect new tags for high res support in the externals.  Also brought remaining externals up to beta 10.

Describe any changes made to the namelist:Updated namelist defaults for high res support.

List any changes to the defaults for the boundary datasets:Added default datasets for high res.

Describe any substantial timing or memory changes:

Code reviewed by:jet

List all subroutines eliminated:

List all subroutines added and what they do:

	Added a diagnostic test that checks that a variable in the 
	spectral namelist can be successfully changed.

	A      models/atm/cam/test/system/TDD.sh

List all existing files that have been modified, and describe the changes:


	new diagnostic test that checks that a variable in the spectral 
	namelist can be successfully changed.

	M      models/atm/cam/test/system/input_tests_master
	M      models/atm/cam/test/system/tests_pretag_edinburgh
	M      models/atm/cam/test/system/nl_files/ttrac

	***********************

	additional support for high res models - default tuning parameters added
	M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml

	***********************

	Fixed bug with new dynamics namelist reads

	M      models/atm/cam/src/dynamics/sld/sld_control_mod.F90
	M      models/atm/cam/src/dynamics/eul/eul_control_mod.F90

	***********************

	Updated externals to a minimum of ccsm beta10 or the 
	latest tags with updates for add high res support

	M      SVN_EXTERNAL_DIRECTORIES


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ....FAIL!
011 bl137 TBL.sh e48c5h outfrq24h 2d ............FAIL!
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s .....FAIL!
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s .....FAIL!
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s ..........FAIL!
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ............FAIL!
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s ...........FAIL!

	Failure for test 4 was expected. I added a new test of 
	the dynamics namelist to a pre-existing test.  Because 
	of the namelist bug a new dynamics variable was not 
	updated correctly in the previous tag.  In the new tag
	the changed namelist variable is used and produces different
	answers

	The rest of the failures were expected due to an update to the 
	external libraries. The only field that failed the bfb tests 
	was U10 which was added to the trunk by updating the externals 
	to ccsm_beta10.
	
edinburgh/lf95: 

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .............FAIL! 
009 bl112 TBL.sh e8c5dm ghgrmp 9s ...............FAIL! 
015 bl114 TBL.sh e8c5dm co2rmp 9s ...............FAIL! 
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ............FAIL! 
030 bl312 TBL.sh f10c5dm ghgrmp 9s ..............FAIL! 
035 bl314 TBL.sh wg10c4dm outfrq3s 9s ...........FAIL! 
038 bl315 TBL.sh f10c3dm outfrq3s 9s ............FAIL! 
043 bl318 TBL.sh f10c4cdm outfrq3s 9s ...........FAIL! 

All expected as explained above.

	
edinburgh/pgi or jaguar/pgi: 

004 bl111 TBL.sh e8c5t5mdm ttrac 9s .............FAIL! 
009 bl112 TBL.sh e8c5dm ghgrmp 9s ...............FAIL! 
015 bl114 TBL.sh e8c5dm co2rmp 9s ...............FAIL! 
022 bl311 TBL.sh f10c5t5mdm ttrac 9s ............FAIL! 
030 bl312 TBL.sh f10c5dm ghgrmp 9s ..............FAIL! 
035 bl314 TBL.sh wg10c4dm outfrq3s 9s ...........FAIL! 
038 bl315 TBL.sh f10c3dm outfrq3s 9s ............FAIL! 
043 bl318 TBL.sh f10c4cdm outfrq3s 9s ...........FAIL! 

All expected as explained above.


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

	BFB with the exception of diagnostic field U10

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:  cam5_0_25
Originator(s): jet
Date: Fri Oct 29 2010
One-line Summary:clean up dynamics, add eulerian subcycling, support for t341

Purpose of changes:Commit of code modifications from Kate Evans, 
	Mark Taylor and Pat Worley.  These modifications add support
	running the T341 eulerian model.  Mark Taylor's mods to allow
	eulerian subcycling were also added to correct an instability in
	the cloud/convection parameterization at higher resolutions.
        As part of merging Mark Taylor's mods in correctly some clean
	up of the dynamics routines was required.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:Kate Evan's added support for
	T341 resolutions

Describe any changes made to the namelist:Moved dynamic specific variables
	out of the cam_inparm namelist into a dynamics namelist.  Also
	split the spmd and dynamics variables into separate namelists.

List any changes to the defaults for the boundary datasets: Added boundary datasets for t341 support.

Describe any substantial timing or memory changes:

Code reviewed by:jet,eaton

List all subroutines eliminated:

	D      models/atm/cam/src/control/decompinit.F90
	D      models/atm/cam/src/control/fv_control_mod.F90
	D      models/atm/cam/src/physics/cam/spmd_phys.F90
	

List all subroutines added and what they do:

	models/atm/cam/src/dynamics/fv/fv_control_mod.F90

	runtime opts was cleaned up, moving the dynamics namelist
	initializations into their own init routines under dynamics.
	After this was done fv_control_mod was moved into the fv dynamics
	directory.

	
List all existing files that have been modified, and describe the changes:

	M      models/atm/cam/bld/config_files/horiz_grid.xml
	M      models/atm/cam/bld/build-namelist
	M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
	M      models/atm/cam/bld/namelist_files/namelist_definition.xml
	M      models/atm/cam/doc/ChangeLog
	M      models/atm/cam/src/control/readinitial.F90
	M      models/atm/cam/src/control/runtime_opts.F90
	M      models/atm/cam/src/control/cam_control_mod.F90
	M      models/atm/cam/src/control/startup_initialconds.F90
	M      models/atm/cam/src/control/cam_restart.F90
	M      models/atm/cam/src/utils/spmd_utils.F90
	M      models/atm/cam/src/physics/cam/phys_grid.F90
	M      models/atm/cam/src/dynamics/sld/spegrd.F90
	M      models/atm/cam/src/dynamics/sld/dyn_comp.F90
	M      models/atm/cam/src/dynamics/sld/hordif.F90
	M      models/atm/cam/src/dynamics/sld/spmd_dyn.F90
	M      models/atm/cam/src/dynamics/sld/hdinti.F90
	M      models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90
	M      models/atm/cam/src/dynamics/eul/inital.F90
	M      models/atm/cam/src/dynamics/eul/iop.F90
	M      models/atm/cam/src/dynamics/eul/dyn.F90
	M      models/atm/cam/src/dynamics/eul/grcalc.F90
	M      models/atm/cam/src/dynamics/eul/dynpkg.F90
	M      models/atm/cam/src/dynamics/eul/stepon.F90
	M      models/atm/cam/src/dynamics/eul/courlim.F90
	M      models/atm/cam/src/dynamics/eul/restart_dynamics.F90
	M      models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
	M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
	M      models/atm/cam/src/dynamics/fv/spmd_dyn.F90
	M      models/atm/cam/src/dynamics/fv/inital.F90
	M      models/atm/cam/src/dynamics/fv/restart_dynamics.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  

edinburgh/lf95: 

edinburgh/pgi or jaguar/pgi: 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_24
Originator(s): dfeddema 
Date: Mon Oct 25 2010
One-line Summary: CAM cleanup for code which stores and retrieves pbuf indices. These changes 1) save pbuf index as local module data when pbuf_add is called 2) move pbuf_get_fld_idx calls from run routines to init routines.  

Purpose of changes: readability, consistency and performance 
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
[...]/models/atm/cam/src/physics/rrtmg/slingo.F90
[...]/models/atm/cam/src/physics/rrtmg/radiation.F90
[...]/models/atm/cam/src/physics/rrtmg/oldcloud.F90
[...]/models/atm/cam/src/physics/rrtmg/ebert_curry.F90
[...]/models/atm/cam/src/physics/cam/zm_conv_intr.F90
[...]/models/atm/cam/src/physics/cam/vertical_diffusion.F90
[...]/models/atm/cam/src/physics/cam/stratiform.F90
[...]/models/atm/cam/src/physics/cam/sslt_rebin.F90
[...]/models/atm/cam/src/physics/cam/radiation.F90
[...]/models/atm/cam/src/physics/cam/physpkg.F90 
[...]/models/atm/cam/src/physics/cam/param_cldoptics.F90 
[...]/models/atm/cam/src/physics/cam/convect_shallow.F90 
[...]/models/atm/cam/src/physics/cam/convect_deep.F90 
[...]/models/atm/cam/src/physics/cam/cloud_fraction.F90 
[...]/models/atm/cam/src/physics/cam/check_energy.F90 
[...]/models/atm/cam/src/physics/cam/cam_diagnostics.F90 
[...]/models/atm/cam/src/physics/cam/mo_gas_phase_chemdr.F90 
[...]/models/atm/cam/src/chemistry/mozart/iondrag.F90 
[...]/models/atm/cam/src/chemistry/mozart/chemistry.F90 
[...]/models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90 
 
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Sun Oct 24 14:54:04 MDT 2010
- sm731 failure is pre-existing
	
edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_23
Originator(s): mvr,mvertens
Date: Thu Oct 21 2010
One-line Summary: mods for processing u10 (10m wind speed) which is now 
being received from drv code; externals updated for new drv, cice and pio tags

Purpose of changes: 
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/src/control/camsrfexch_types.F90
M      models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
M      models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
- mods for processing u10 now being received from the driver
	
M      models/atm/cam/src/utils/cam_csim4/cpl_mct/ice_comp_mct.F90
- removed references to variable sicthk
	
M      SVN_EXTERNAL_DIRECTORIES
 M     .
- externals updated for new drv, cice and pio tags
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Wed Oct 20 22:26:59 MDT 2010
- sm731 failure is pre-existing
	
edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_22
Originator(s): mvr,hannay
Date: Wed Oct 13 2010
One-line Summary: corrected the default settings for condensate-
to-rain autoconversion coefficients for cam5 configurations

Purpose of changes: 
cam5 runs (other than those at 1.9x2.5) were using values meant 
for cam4 configurations
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: 
- new default values for condensate-to-rain autoconversion coefficients
  at cam5 configurations

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Oct 12 20:51:50 MDT 2010
013 bl330 TBL.sh f4c5pdh aqpgro 3s ........................................FAIL! rc= 7 at Tue Oct 12 20:59:06 MDT 2010
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue Oct 12 21:18:23 MDT 2010
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Tue Oct 12 21:56:41 MDT 2010
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Wed Oct 13 00:34:44 MDT 2010
- sm731 failure is pre-existing
- baseline failures were expected at cam5 configurations (other than 1.9x2.5) with changes to tuning parameters
	
edinburgh/lf95: All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Oct 12 17:01:21 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Oct 12 17:44:55 MDT 2010
010 bl113 TBL.sh e8c5pdm aqpgro 3s ........................................FAIL! rc= 7 at Tue Oct 12 18:19:12 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Oct 12 18:25:07 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Oct 12 19:33:09 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Tue Oct 12 20:16:18 MDT 2010
031 bl313 TBL.sh f10c5pdm aqpgro 3s .......................................FAIL! rc= 7 at Tue Oct 12 20:41:53 MDT 2010
039 bl316 TBL.sh f10c5pdm aqpgro+aquaplanet_cam5 3s .......................FAIL! rc= 7 at Tue Oct 12 21:47:57 MDT 2010
- baseline failures were expected at cam5 configurations (other than 1.9x2.5) with changes to tuning parameters

edinburgh/pgi: All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Tue Oct 12 16:28:44 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Tue Oct 12 16:37:59 MDT 2010
010 bl113 TBL.sh e8c5pdm aqpgro 3s ........................................FAIL! rc= 7 at Tue Oct 12 16:45:03 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Tue Oct 12 16:47:05 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Tue Oct 12 17:03:29 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Tue Oct 12 17:15:03 MDT 2010
031 bl313 TBL.sh f10c5pdm aqpgro 3s .......................................FAIL! rc= 7 at Tue Oct 12 17:22:05 MDT 2010
039 bl316 TBL.sh f10c5pdm aqpgro+aquaplanet_cam5 3s .......................FAIL! rc= 7 at Tue Oct 12 17:35:58 MDT 2010
- baseline failures were expected at cam5 configurations (other than 1.9x2.5) with changes to tuning parameters


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB, except for cam5 configurations other than 1.9x2.5

===============================================================
===============================================================

Tag name: cam5_0_21
Originator(s): mvr
Date: Tue Oct 12 2010
One-line Summary: new tuning mods added as defaults for T31; mods to 
test scripts to reflect changes in the cice decomposition formulation

Purpose of changes: 
T31 tuning mods...
cldfrc_rhminh =  0.50
cldwat_icritc =  1.e-6
cldwat_r3lcrit = 1.e-6  (and moved into a namelist variable)
do_tms =         true
tms_orocnst =    1.0
tms_z0fac =      0.1    (and moved into a namelist variable)
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: 
- new tuning mods added as defaults for T31

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TCB.sh
- mods to utilize fixes made to cice decomp script

M      models/atm/cam/test/system/CAM_decomp.sh
- bug fix to test script for properly altering task count for hybrid tests

M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TER.sh
M      models/atm/cam/test/system/TSM.sh
- test scripts now utilize new nl option for cice distribution type, roundrobin

M      models/atm/cam/test/system/test_driver.sh
- bluefire testing returned to use all 64procs of node with fixes to cice decomp

M      models/atm/cam/bld/build-namelist
- cleaned up handling of tms variables, added code for new namelist parameters

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- added default values for T31 (see description above)

M      models/atm/cam/bld/namelist_files/namelist_definition.xml
- added entries for new namelist variables

M      models/atm/cam/src/physics/cam/trb_mtn_stress.F90
M      models/atm/cam/src/physics/cam/phys_control.F90
M      models/atm/cam/src/physics/cam/cldwat.F90
M      models/atm/cam/src/physics/cam/vertical_diffusion.F90
- changes to reflect new handling of tms namelist variables

M      SVN_EXTERNAL_DIRECTORIES
 M     .
- updated to new cice tag with fixes to its decomposition formulation
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Tue Oct 12 08:48:07 MDT 2010
006 bl133 TBL.sh e48c4pdm aqpgro 3s .......................................FAIL! rc= 7 at Tue Oct 12 08:48:08 MDT 2010
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Oct 12 08:48:15 MDT 2010
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Tue Oct 12 08:50:49 MDT 2010
- sm731 failure is pre-existing
- baseline failures were expected at T31 with changes to tuning parameters
	
edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB, except at T31

===============================================================
===============================================================

Tag name: cam5_0_20
Originator(s): jet
Date: Mon Oct 4, 2010
One-line Summary: Updated SVN_EXTERNALS to include workaround for intel compile bug when compiling shr_scam_mod.

Purpose of changes: Updated SVN_EXTERNALS to include workaround for intel compile bug when compiling shr_scam_mod.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by:jet,tcraig

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/src/chemistry/mozart/tgcm_forcing.F90
M      SVN_EXTERNAL_DIRECTORIES

	tgcm_forcing had what looked to be debug io that was 
	incompatible with single column mode.  For now that write 
	statement was commented out.
	
bluefire: All PASS except:
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Thu Sep 30 11:50:18 MDT 2010

       Expected failure from previous tags.


edinburgh/lf95:  BFB scam runs completed on tramhill with lf95

edinburgh/pgi or jaguar/pgi:   BFB scam runs completed on tramhill with pfg90

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff? bfb

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_19
Originator(s): mvr,eaton
Date: Thr Sep 30 2010
One-line Summary: update component externals to those of cesm1_0_beta08;
corrected ghg dataset for cam5 use_case; added default ic file for 0.5deg cam5
	

Purpose of changes:

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:
- new default initial conditions file for 0.5deg cam5

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- added listing for default initial conditions file at 0.5deg cam5
	
M      models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
- corrected the ghg dataset being used
	
M      SVN_EXTERNAL_DIRECTORIES
 M     .
- new external definitions for drv, clm, cice, csm_share and scripts

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Thu Sep 30 11:50:18 MDT 2010
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Thu Sep 30 14:15:47 MDT 2010
- sm731 failure is pre-existing
- bl375 baseline comparison was expected to fail due to the change made to the ghg dataset used
	
edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_18
Originator(s): pworley, jedwards, eaton
Date: Sat Sep 25 11:20:58 MDT 2010
One-line Summary: Mods for COSP; phys_grid column pair fix

Purpose of changes:

. Changes were made to configure and to the COSP source tree to enable the
  build of COSP from the CESM scripts as part of the atm library (the
  standalone CAM build builds COSP as a separate library).

. The COSP interface module was incurring an unnecessary memory overhead
  when the COSP simulator was not being used.  This has been remedied
  (fixes from Jim Edwards).

. Modify configure to remove restrictions against building for spmd or smp
  modes with Darwin OS.

Bugs fixed (include bugzilla ID):

. Fix to column pairing algorithm in phys_grid.  From Pat Worley:
  > The error does not break the
  > code, it just erroneously disables the wrap map of the columns as
  > well as the column pairing. This essentially disables all load
  > balancing when the namelist parameter phys_twin_algorithm == 0 or
  > when using HOMME and not setting phys_twin_algorithm = 1.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

. Replace static allocation of atrain arrays in the COSP interface by
  dynamic allocation to remove the overhead when COSP isn't being used.

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. update cosp to cosp_v1_3_100924

models/atm/cam/bld/configure
. only write cosp Makefile if doing a cam standalone build
. modify the write_filepath_ccsm method to include the cosp filepaths if
  running with cosp enabled
. remove checks that disallow darwin builds with SPMD or SMP

models/atm/cam/src/physics/cam/cospsimulator_intr.F90:
. mpibcast of cosp_histfile_num, atrainday, atrainhr, atrainmin, atrainsec
  had wrong type 
. change large atrain orbit data arrays from static to allocatable

models/atm/cam/src/physics/cam/phys_grid.F90
. fix for twin algorithm

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Fri Sep 24 23:36:01 MDT 2010

sm731 failure is pre-existing

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_17
Originator(s): mvr,jek,eaton, pworley, bardeenc
Date: 16 Sep 2010
One-line Summary: update/fixes made to COSP code; add a test to test_driver 
for exercising COSP; Supply a missing initialization in the reproducible sum code

Purpose of changes:  
1) additional logic so that cosp outputs that require both radar and
lidar simulator are saved only when both simulators are run
2) double counting of the convective cloud water in cosp inputs.  this
required defining some new variables for the stratiform cloud water
within cospsimulator_intr.F90.
3) Pressures and heights not defined correctly in cosp inputs.
Yuying: "Based on TYPE COSP_GRIDBOX (line 282-286) in cosp_types.F90,
zlev & p are height and pressure at model levels,
and zlev_half & ph are values at bottom (interface) of model layer.
The definition in cospsimulator_intr.F90 (line 1581-1584) shows that
gbx%p & gbx%zlev are interface values while
gbx%ph & gbx%zlev_half are at model levels."
4) convection *_flxprc are for rain+snow while stratiform *_flxprc was
for rain only.  I am changing ls_flxprc so that it includes
both rain and snow in cldwat.F90, ~ line 946, rkflx = precab instead of
rkflx = precab - snowab.  It is confusing to have things labeled
*_flxprc when some include rain and others include rain+snow.  I also
made name mods in stratiform.F90.  I modified cospsimulator.F90
accordingly -- see lines 1447 - 1469.
5) Jim wanted a namelist variable so that you can specify which CAM
history tape COSP outputs are written to
I used Jerry's mods for history_budget_histfile_num as a template.
I added cosp_histfile_num as a namelist variable by making mods to both
namelist_definition.xml and to cospsimulator_intr.F90.
6) circa line 4288, dimension name wrong --
"dimen4a(3)=cosp_prstau_modis_dim" should be
"dimen4m(3)=cosp_prstau_modis_dim"
7) for cfad_sr532_cal.  nbze_cosp = nsr_cosp = 15.  this leads to if
statement problems because cam_history.F90 only checks flags and
dimensions sizes. i set the flag_**dbze** = .false when flag_cosphtsrlev
= .true circa line 1281
8) similar problem for fisccp1_cosp and isccp simulator flags. fix circa
line 1293

	
Bugs fixed (include bugzilla ID):

. fix for missing initializer in repro_sum_mod module (from Chuck Bardeen
  and Pat Worley)

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/f10c4cdm
- new configuration options test file for testing of cosp
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_edinburgh
- added new cosp test to default set of required pretag tests on edinburgh
	
M      models/atm/cam/test/system/TER.sh
- modified the exact restart test to not change number of tasks/threads upon
  restart for any test running cosp
	
M      models/atm/cam/test/system/input_tests_master
- added definition of new cosp tests to master list

M      models/atm/cam/test/system/CAM_runcmnd.sh
- change to test scripts to set run command on edinburgh while accounting for 
  potential tests of both mpi-only or hybrid

M      models/atm/cam/src/utils/repro_sum_mod.F90
- Supply a missing initialization in the reproducible sum code.  The code
  was not producing wrong answers, but could possibly produce a runtime
  failure due to a bad argument (fix from Bardeen, Worley).
	
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
M      models/atm/cam/src/control/cam_history.F90
M      models/atm/cam/src/physics/cam/stratiform.F90
M      models/atm/cam/src/physics/cam/cospsimulator_intr.F90
M      models/atm/cam/src/physics/cam/cldwat.F90
- cosp changes (see description above)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Thu Sep 16 00:23:05 MDT 2010
- existing failure
	
edinburgh/lf95: 
042 bl318 TBL.sh f10c4cdm outfrq3s 9s .....................................FAIL! rc= 5 at Wed Sep 15 19:38:59 MDT 2010
- new test failed because it is not defined in baseline code
	
edinburgh/pgi: 
042 bl318 TBL.sh f10c4cdm outfrq3s 9s .....................................FAIL! rc= 5 at Wed Sep 15 16:13:34 MDT 2010
- new test failed because it is not defined in baseline code

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):  b4b

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_16
Originator(s): Francis Vitt
Date: 15 Sep 2010
One-line Summary: Added capability to overwrite the cam surface GHG 
values with data from waccm lower boundary file.

Purpose of changes:  

This makes the co2vmr value used in the WACCM nlte_fomichev module 
consistent with the value in the WACCM lower boundary file.  This 
capability has been extended to non WACCM configurations so that 
a WACCM LBC file can be used set the CAM GHG surface values.

Also included is a change in the age-of-air tracers to use values 
from the initial conditions file as initial values.  To override
this default behavior set aoa_read_from_ic_file namelist variable
to false.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

D   models/atm/cam/src/chemistry/mozart/mo_flbc.F90
D   models/atm/cam/src/chemistry/mozart/m_types.F90
 - files moved to the models/atm/cam/src/chemistry/utils directory so 
   that they are available in non-chemistry configurations

List all subroutines added and what they do:

A   models/atm/cam/src/chemistry/utils/mo_flbc.F90
A   models/atm/cam/src/chemistry/utils/m_types.F90
 - files moved from the models/atm/cam/src/chemistry/mozart/ directory
	
List all existing files that have been modified, and describe the changes:

M   models/atm/cam/bld/build-namelist
 - if a LBC file is defined then do not set default settings for 
   bndtvghg, co2vmr, ch4vmr, n2ovmr, f11vmr, f12vmr

M   models/atm/cam/bld/namelist_files/namelist_definition.xml
 - aoa_read_from_ic_file defaults to TRUE
 - more explanation is added to ext_frc_specifier namelist description
 - flbc_* namelist variables have been moved to "chem_srfvals_nl" namelist

M   models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
 - removed the co2vmr setting since this is now set by the LBC file

M   models/atm/cam/src/physics/cam/phys_gmean.F90
 - added a subroutine to compute global mean of a single field

M   models/atm/cam/src/physics/cam/chem_surfvals.F90
 - changes to read flbc_* namelist variables
 - changes to overwrite the GHG surface values with global means from
   the mo_flbc module

M   models/atm/cam/src/physics/cam/aoa_tracers.F90
 - changes the default ICs to be set from the CAM initial conditions file
	
M   models/atm/cam/src/chemistry/utils/tracer_data.F90
 - set initial value of list_cycled to .false.
 - if data path is empty do not append "/filename" to it

M   models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M   models/atm/cam/src/chemistry/mozart/mo_chemini.F90
M   models/atm/cam/src/chemistry/mozart/chemistry.F90
M   models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
 - changes needed to make mo_flbc available to non-chemistry configurations

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  

033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Wed Sep 15 10:13:08 MDT 2010
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Wed Sep 15 10:13:48 MDT 2010
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Wed Sep 15 10:45:34 MDT 2010
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Wed Sep 15 10:46:35 MDT 2010

The WACCM baseline tests bl336 and bl379 failures are due to the change in the co2vmr 
surface value used in the nlte_fomichev module and the change in initial conditions 
of the age-of-air tracers

The trop_mozart baseline test bl379 failure is due to the change in GHG values used in 
the radiation which are now based on the chemistry lower conditions file

Test sm731 failure is pre-existing

edinburgh/lf95: 

034 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Sep 13 17:51:19 MDT 2010

This failure is due to the change in initial conditions of the age-of-air tracers
	
edinburgh/pgi: 

034 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 7 at Mon Sep 13 15:09:27 MDT 2010

This failure is due to the change in initial conditions of the age-of-air tracers

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_15
Originator(s): mirin, eaton
Date: Wed Sep  8 11:46:04 MDT 2010
One-line Summary: Fix for FV div4 filter; refactor pertlim code; rcp6.0 update

Purpose of changes:

. Fixes to indices for ghost regions in FV div4 filter (from Art Mirin).

. Refactor the application of a perturbation to the initial T field so that
  it is distributed.  Previously the 3D T field was read to the master
  task and then scattered after the perturbation was applied.

. Modify the rcp6.0 use case to use the datm version of the prescribed
  aerosol deposition fluxes.

Bugs fixed (include bugzilla ID):

. The results of the FV dycore with the div4 filtering on (only on by
  default for 1/2 deg and higher resolution) where found to depend on the
  decomposition.  The fixes to ghost region indexing has resolved this.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

. change aerosol deposition dataset in use case 2005-2100_cam4_rcp60

Describe any substantial timing or memory changes: 

. The change to how an initial temperature perturbation is applied
  substantially reduces memory requirements (eliminating the need for a
  global 3D field) so that perturbation growth tests may be done at higher
  resolutions.

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp60.xml
. modify aerodep_flx_file to use the datm dataset.

models/atm/cam/src/dynamics/fv/dyn_comp.F90
. remove debug write to all procs

models/atm/cam/src/dynamics/fv/inidat.F90
. remove reading 3D T field to masterproc and scattering when pertlim is
  specified. 
. add code that uses the global column number to seed the random number
  generator.  This makes setting the perturbation independent of
  decomposition. 

models/atm/cam/src/dynamics/fv/dynamics_vars.F90
models/atm/cam/src/dynamics/fv/sw_core.F90
. Fixes for indices in ghost regions of FV div4 filter.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Tue Sep  7 21:14:08 MDT 2010

sm731 failure is pre-existing.

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except FV run that use the div4
  filter produces larger than roundoff diffs.  This filter is the default
  for 1/2 deg and higher resolutions.

===============================================================
===============================================================

Tag name: cam5_0_14
Originator(s): mvr
Date: Wed Sep 01 
One-line Summary: use_cases added for waccm, rcp6.0; test added to default test 
suite; removed reference to shr_date_mod; updated externals to cesm1_0_beta07

Purpose of changes:
- a test was added to the test suite to ensure a run of stand-alone-cam vs 
  an "F" case via the ccsm scripts was b4b
	
Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:
A      models/atm/cam/test/system/nl_files/fcase
A      models/atm/cam/test/system/nl_files/user_nl_cam
-new test files required for new "stand-alone-cam vs fcase" test
	
A      models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp60.xml
A      models/atm/cam/bld/namelist_files/use_cases/waccm_2005-2100_cam4_rcp45.xml
A      models/atm/cam/bld/namelist_files/use_cases/waccm_1955-2005_cam4.xml
-new use_cases added
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_bluefire
M      models/atm/cam/test/system/tests_posttag_jaguar_cb
M      models/atm/cam/test/system/tests_posttag_jaguar
M      models/atm/cam/test/system/input_tests_master
-added new "stand-alone-cam vs fcase" test to master and default test lists 
	
M      models/atm/cam/test/system/TCB_ccsm.sh
-configure-time mods needed for new "stand-alone-cam vs fcase" test

M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TEQ_ccsm.sh
M      models/atm/cam/test/system/TEQ.sh
-correction to output messages of test scripts
	
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/TER_ccsm.sh
M      models/atm/cam/test/system/TSM_ccsm.sh
-mods to enable testing of ccsm scripts via cam test suite on jaguar

M      models/atm/cam/src/physics/cam/tidal_diag.F90
-removed the usage of the module shr_date_mod

M      SVN_EXTERNAL_DIRECTORIES
 M     .
-updated external definitions for drv, csm_share and scripts to represent those 
of beta07 as closely as possible

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
007 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Tue Aug 31 17:14:51 MDT 2010
016 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Tue Aug 31 17:15:06 MDT 2010
-bl992 failure is due to change in the setting for co2_ppmv
-sm731 failure is pre-existing

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB


===============================================================
===============================================================

Tag name: cam5_0_13
Originator(s): eaton
Date: Fri Aug 20 12:37:04 MDT 2010
One-line Summary: fix HOMME for repro_sum change; mods to high-res FV config; logfile output; COSP updates

Purpose of changes:

. Fix HOMME dycore to supply the new "commid" argument in the repro_sum
  calls. 

. Changes to FV filtering default for high resolution grids (1/2 deg and
  finer). 

. Modify logfile output to include lists of all history fields in the
  master and the active lists, including long_name.

. Remove the echo of the GHG and Solar forcing data to the IC file (it's
  still in the history files).  It's never read from the IC file, so it's
  confusing to have it there.

. Modify waccm_2000_cam4 use case with updated IC files.

. Makefile updates for the BGP and the Linux/Intel builds.

. Updates to COSP simulator code:
  - fix mpi bug
  - output cosp coordinate values in variables rather than as attributes
  - output cosp coordinate bounds in CF compliant variables rather than as
    attributes 
  - mods to save COSP CFMIP outputs with different frequencies on separate
    history files.

. Modify pretag tests for HOMME on bluefire

Bugs fixed (include bugzilla ID): 

. fix mpi bug in cospsimulator (missing mpibcast call for namelist vars)

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/test/system/config_files/h16c4aqdm
. new config: homme, ne16np4, cam4, aquaplanet, debug, pure mpi

List all existing files that have been modified, and describe the changes:

models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. update cosp externals to cosp_v1_3_100813

models/atm/cam/bld/Makefile.in
. add an include path for the BGP build
. add special rules to the ifort section for compiling 2 rrtmg modules
  and shr_scam_mod.F90 without optimization

models/atm/cam/bld/build-namelist
. remove the manual setting of the ape attribute (comes automatically from
  the cache file now that setting -ocn aquaplanet is a build time setting)
. add default for filtcw (since it now depends on resolution)

models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
. update initial files

models/atm/cam/bld/configure
. remove unused -notest option

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. make div24del2flag=42 the default for 1/2 deg and finer FV grids
. make filtcw=1 the default for 1/4 deg and finer FV grids
. replace the attribute ape="1" by ocn="aquaplanet" which comes
  automatically from the config_cache.xml file

models/atm/cam/bld/namelist_files/namelist_definition.xml
. fix documentation of fft_flt
. prepend "cosp_" to all cosp namelist variables

models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
. update IC files

models/atm/cam/src/control/cam_history.F90
. modify output for master and active field lists
. mods to remove GHG/Solar forcing data from IC file.
. mods to cosp vertical coordinates for CF conformance

models/atm/cam/src/control/camsrfexch_types.F90
. fix comment on snowhice to indicate that it is actual snow height, not
  the liquid water equivalent.

models/atm/cam/src/control/runtime_opts.F90
. add comment about physconst_readnl

models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
. supply the optional arg "commid" in the repro_sum calls (it's really only
  optional if the correct communicator is MPI_COMM_WORLD).

models/atm/cam/src/physics/cam/cosp_share.F90
. add new 2D bounds variables for CF conforming output

models/atm/cam/src/physics/cam/cospsimulator_intr.F90
. add missing mpibcast calls for namelist variables
. prepend "cosp_" to all cosp namelist variables
. modify output for CFMIP experiments

models/atm/cam/test/system/config_files/h16c4aqdm
. homme, ne16np4, cam4, aquaplanet, debug, pure mpi

models/atm/cam/test/input_tests_master
. add sm733, er733, bl733 to test h16c4aqdm, outfrq3s

models/atm/cam/test/system/nl_files/aqpgro
models/atm/cam/test/system/nl_files/aqua
. remove the aqua_planet and aqua_planet_sst settings -- they are redundant
  since aquaplanet is now a build time setting.

models/atm/cam/test/tests_pretag_bluefire
. add sm733, er733, bl733
. remove er731, bl731

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
061 sm731 TSM.sh h16x4c3dh aqua 9s ........................................FAIL! rc= 8 at Thu Aug 19 20:44:26 MDT 2010
064 bl733 TBL.sh h16c4aqdm outfrq3s 9s ....................................FAIL! rc= 5 at Thu Aug 19 20:44:27 MDT 2010

The failed test sm731 of HOMME in hybrid mode appears to be a system
problem.  It is only when the executable is built with threads enabled that
the failure occurs.  The error message points to the following location:

Illegal instruction (privileged operation) in cam_history.__cam_history_NMOD__&&_cam_history.__cam_history_NMOD_h_define at line 3350 in file "/ptmp/eaton/src/cam5_0_12_trb/models/atm/cam/src/control/cam_history.F90" ($t1)
 3350         if(restart) then

I'm guessing that the illegal instruction message is a result of the
variable "restart" being corrupted.  This configuration runs successfully
under PGI on edinburgh.  On bluefire the configuration runs successfully if
the debug flags are removed.  It also runs successfully with debug in
serial and pure mpi modes.  The code fails in a pure OMP mode in with an
identical error message as above.  Running a debug/OMP executable in
totalview with memoryscape enabled is successful, apparently due to
totalview's control of memory management.  When run in totalview without
memory tracing enabled the reported error is the same as above.  The
reported error is not in a threaded code region.  I added a pure mpi
version of the test so that HOMME would continue to be tested, and left
just the smoke test version of the debug/hybrid configuration that's
failing to keep this problem on the radar.

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB


===============================================================
===============================================================

Tag name: cam5_0_12
Originator(s): jenkay, eaton
Date: Tue Aug 10 14:02:00 MDT 2010
One-line Summary: Add COSP simulator.

Purpose of changes:

. add ability to produce diagnostic output from the COSP simulator as an
  option.  The option is enabled by adding the argument "-cosp" to the
  configure commandline.

. The Makefile.in template was refactored to facilitate passing the Fortran
  compiler flags to a sub-Make.  The COSP simulator is built as a separate
  library because it needs to be compiled using autopromotion flags.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: 

. add -cosp argument to configure to enable cosp simulator

Describe any changes made to the namelist:

. New variables for COSP simulator:

docosp:
If true, the COSP cloud simulator is run.
COSP will not run unless this is set to .true. in the namelist!
Turn on the desired simulators using lXXX_sim namelist vars
If no specific simulators are specified, all of the simulators
are run on all columns and all output is saved. (useful for testing). 
This option available with CAM4 physics only.
This default logical is set in cospsimulator_intr.F90.
Default: FALSE

lradar_sim:
If true, COSP radar simulator will be run and all output 
will be saved.
Default: FALSE

llidar_sim:
If true, COSP lidar simulator will be run and all output
will be saved
Default: FALSE

lisccp_sim:
If true, COSP ISCCP simulator will be run and all output
will be saved.  ISCCP simulator is run on only daylight
columns.
Default: FALSE

lmisr_sim:
If true, MISR simulator will be run and all output
will be saved.  MISR simulator is run on only daylight
columns.
Default: FALSE

lmodis_sim:
If true, MODIS simulator will be run and all output
will be saved.
Default: FALSE

cfmip_3hr:
If true, the COSP cloud simulator is run for CFMIP 3-hourly 
experiments.
This default logical is set in cospsimulator_intr.F90
Default: FALSE

cfmip_da:
If true, the COSP cloud simulator is run for CFMIP daily 
experiments.
This default logical is set in cospsimulator_intr.F90
Default: FALSE

cfmip_off:
If true, the COSP cloud simulator is run for CFMIP off-line  
monthly experiments.
This default logical is set in cospsimulator_intr.F90
Default: FALSE

cfmip_mon:
If true, the COSP cloud simulator is run for CFMIP monthly
experiments.
This default logical is set in cospsimulator_intr.F90
Default: FALSE

ncolumns:
Number of subcolumns in SCOPS
This default logical is set in cospsimulator_intr.F90
Default: 50

sample_atrain:
Turns on sampling along a-train orbit for radar and lidar simulators.
This default logical is set in cospsimulator_intr.F90
Default: TRUE

atrainorbitdata:
Path for the Atrain orbit data file provided by CFMIP.
There is no default for this, but sample_atrain = .true. will not work 
if this namelist variable is undefined.
currently /project/cms/jenkay/SCAM/repository/cloudsat_orbit_08921_14250.nc
Default: no default set now, need to specify in namelist

lfrac_out:
Turns on sub-column output from COSP.
If both the isccp/misr simulators and the lidar/radar simulators
are run, lfrac_out is from the isccp/misr simulators columns.
This default logical is set in cospsimulator_intr.F90
Default: FALSE


List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

. the simulator is not on by default
. performance and memory implications of the simulator in operation have
  not been evaluated

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/cosp_share.F90
models/atm/cam/src/physics/cam/cospsimulator_intr.F90
. CAM specific interfaces to simulator code

models/atm/cam/src/physics/cosp/*
models/atm/cam/src/physics/icarus-scops/*
. simulator code is linked in as an svn external

List all existing files that have been modified, and describe the changes:

models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. link cosp source via externals

models/atm/cam/bld/Makefile.in
. add rules to build cosp library
. refactor how FFLAGS are set to facilitate passing the fortran compiler
  flags to the sub-Make used to build cosp

models/atm/cam/bld/build-namelist
. set docosp=.true. when CAM is built with the cosp simulator

models/atm/cam/bld/config_files/definition.xml
models/atm/cam/bld/configure
. add -cosp argument to enable cosp simulator

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add namelist variables to control cosp simulator

models/atm/cam/src/control/cam_history.F90
. add output for cosp simulator -- the main issue is all the new level
  dimensions and coordinate variables 
. remove the call to check_accum from subroutine hbuf_accum_inst.  This
  subroutine checks that either all values in a column are fill values, or
  none are.  This breaks when the vertical dimension is actually a
  collection of subcolumns (stacked on top of one another) some of which
  contain fill values and others which don't.  An assumption of the
  accumulator for time averaging is that a column (the vertical dimension)
  is all fill value or no fill value.  These hybrid vertical dimensions
  break that assumption.  As a consequence they should only be output as
  instantaneous fields.
. Don't call the h_normalize subroutine for instantaneous fields.  For
  fields with fill values it enforces the constraint that either all values
  in the vertical dimension are the fill value, or none are.  This is not
  true for cosp output.  It should be up to the diagnostic code to enforce
  this constraint where it is appropriate, not the generic h_normalize
  code.

models/atm/cam/src/control/runtime_opts.F90
. call cospsimulator_intr_readnl method

models/atm/cam/src/physics/cam/cldwat.F90
. add diagnostic fields needed by cosp simulator as intent(out) args

models/atm/cam/src/physics/cam/radiation.F90
. add calls to init and run the simulator

models/atm/cam/src/physics/cam/convect_shallow.F90
models/atm/cam/src/physics/cam/stratiform.F90
models/atm/cam/src/physics/cam/zm_conv_intr.F90
. add fields to physics buffer for driving cosp simulator

models/atm/cam/src/utils/cam_pio_utils.F90
. add flags for new level coordinates for cosp output

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_11
Originator(s): Patrick Worley / Art Mirin
Date: Sun Aug 8 2010
One-line Summary: FV memory optimization; repro_sum update; spmd_utils and mod_comm communication protocol updates.

Purpose of changes: 

. significant decrease in memory requirements in FV mod_comm 
  layer (Mirin)

. modification to implementation of handshaking communication 
  logic in spmd_utils and mod_comm to improve robustness. 
  Problems have not been observed with previous implementation,
  and these changes are simply to avoid potential future problems.

. modification to repro_sum logic, improving accuracy in extreme
  cases, enabling bit-for-bit agreement whether using 4-byte or 
  8-byte integers in implementation, and changing CPP token used 
  to determine which length integers to use

. modification to repro_sum implementation to remove 
  dependencies in mpishorthand, spmd_utils, cam_iulog,
  and abortutils, as first step to moving repro_sum_mod to
  models/csm_share or models/utils (for use by other components)

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

. Changed CPP token that forces use of 4-byte integers in repro_sum
  algorithm from "BGP" to "noI8".

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

. significant decrease in FV memory requirements, no longer
  allocating memory for undecomposed 3D field (only undecomposed
  2D field) when modcomm_gatscat /= 0

Code reviewed by: Worley

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

. removal of dependence on spmd_utils and cam_iulog required new 
  formal parameters for specifying log unit number and "masterproc" in 
  repro_sum_setopts routine
control/runtime_opts.F90
utils/repro_sum_mod.F90

. removal of dependence on cam_iulog required new formal parameter
  for specifying log unit number in repro_sum_tol_exceeded routine
utils/repro_sum_mod.F90
dynamics/fv/d2a3dikj.F90
dynamics/fv/fv_prints.F90
dynamics/fv/mean_module.F90
dynamics/fv/p_d_adjust.F90
dynamics/fv/par_xsum.F90
physics/cam/phys_gmean.F90

. removal of dependence on spmd_utils required addition of exisiting
  optional commid parameter in calls to repro_sum
physics/cam/polar_avg.F90

. reimplementation of communication handshaking logic so that each
  handshaking message is received into a different memory location
  (rather than all going to/from the same location); also
  add nonblocking handshaking message logic to mp_swaptrirr.
utils/pilgrim/mod_comm.F90
utils/spmd_utils.F90

. new CCP token to indicate use of 4-byte integers instead of
  8-byte integers (original workaround for compiler bug on BG/P - 
  no longer necessary?): "noI8" replacing "BGP"; modified algorithm
  termination logic so that get full accuracy and 4-byte integer
  and 8-byte integers options now 
utils/repro_sum_mod.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  none

edinburgh/lf95: none 

edinburgh/pgi: none

CAM tag used for the baseline comparison tests if different than previous
tag: cam5_0_10

Summarize any changes to answers: NONE

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_10 
Originator(s): Diane Feddema  
Date: 4, Aug, 2010  
One-line Summary:Fixed CAM memory leak with work-around for xlf90 compiler bad code generation bug(IBM PMR 21571.003.000)

Purpose of changes: Fixed memory leak in CAM by adding a work-around to CAM for a bad code generation bug in IBM's xlf90 comipler. 

Bugs fixed (include bugzilla ID):
. Fix memory leak in CAM caused by IBM xlf90 compiler error which does not free memory for an automatic array (which is the return value for an called function)  before the calling function exits. The calling function is pbuf_get_fld_idx.  When the calling function is exited memory for the automatic array is not freed - and is never freed.  Diane submitted a failing testcase to IBM and they filed IBM internal bug report PMR 21571.003.000.   

. Fixed misplaced t_startf call in aircraft_emit.F90 which results in mismatched timer calls when aircraft_emit.F90 results in mismatched timer calls when aircraft emission code isn't active.  (Also removed embedded space from teh event tag). 
describe any changes made to build system: none 

Describe any changes made to the namelist: none 

List any changes to the defaults for the boundary datasets: none 

Describe any substantial timing or memory changes: memory leak fixed 

Code reviewed by: Brian Eaton 

List all subroutines eliminated: none 

List all subroutines added and what they do: none 

List all existing files that have been modified, and describe the changes:
./models/atm/cam/src/physics/cam/phys_buffer.F90 

Modified routine pbuf_get_fld_idx so that it is case sensitive.  This modication removes a check (call to to_upper from inside an if-block that contains a return statement within the if-block)  that caused a memory leak, due to a bug in the IBM xlf90 compiler (see IBM bug report PMR 21571.003.000).   

./models/atm/cam/src/physics/cam/stratiform.F90

Made pbuf_get_fld_idx calls case sensitive by using arguments with the same case for field name that was used to create the pbuf entry. 
ifld = pbuf_get_fld_idx('KVH') was changed to ifld = pbuf_get_fld_idx('kvh')
ifld = pbuf_get_fld_idx('TKE') was changed to ifld = pbuf_get_fld_idx('tke') 
ifld = pbuf_get_fld_idx('TURBTYPE') was changed to ifld = pbuf_get_fld_idx('turbtype') 
ifld = pbuf_get_fld_idx('SMAW') was changed to ifld = pbuf_get_fld_idx('smaw')  
 
./models/atm/cam/src/physics/cam/tphysac.F90 

Made pbuf_get_fld_idx call case sensitive by using argument with the same case for field name that was used to create the pbuf entry. 
ifld = pbuf_get_fld_idx('KVH') was chaned to ifld = pbuf_get_fld_idx('kvh')

 
If there were any failures reported from running test_driver.sh on any test

platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: none 

edinburgh/lf95: none 

edinburgh/pgi : none 

CAM tag used for the baseline comparison tests if different than previous
tag:  cam5_0_09 

Summarize any changes to answers, i.e., NONE 
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_09
Originator(s):  Cheryl Craig and Jack Chen
Date: 27 July, 2010
One-line Summary: Added the ability to read in FAA aircraft files
                  Added latitude weighted interpolation and conserve column capabilities

Purpose of changes: To allow FAA aircraft data to be used in CESM

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: Created aircraft_emit_nl:  contains aircraft_spcecifier and aircraft_type
   aircraft_specifier contains a list of "aircraft species -> filename of file list for that species"
   aircraft_type contains "CYCLICAL_LIST" which says the file list should be cycled

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Brian Eaton, Francis Vitt

List all subroutines eliminated: none

List all subroutines added and what they do: 

A  models/atm/cam/src/chemistry/utils/horizontal_interpolate.F90: NEW MODULE
    ! This module computes and uses weighting functions to map a variable of (im1,jm1) resolution to (im2,jm2) resolution
    ! weight_x(im2,im1) is the weighting function for zonal interpolation
    ! weight_y(jm2,jm1) is the weighting function for meridional interpolation
   models/atm/cam/src/chemistry/utils/tracer_data.F90  
     - advance_file:  Advances to the next file
     - vert_interp_mixrat: performs vertical interpolation of mixing ratios
   models/atm/cam/src/chemsitry/utils/aircraft_emit.F90: NEW MODULE
     - aircraft_emit_register: adds the aircraft emission data to the physics buffer
     - aircraft_emit_init: Initialize the aircraft emission data handling
     - aircraft_emit_adv: Advance to the next aircraft data
     - aircraft_emit_readnl: Reads the aircraft emission namelist
     - function get-aircraft_ndx: returns the index of the aircraft data being requested

List all existing files that have been modified, and describe the changes:
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
          - added aircraft_specifier and aircraft_type
M       models/atm/cam/src/physics/cam/initindx.F90  
          - added call to new routine aircraft_emit_register
M       models/atm/cam/src/physics/cam/physpkg.F90 
          - added call to new routine aircraft_emit_init 
M       models/atm/cam/src/physics/cam/advnce.F90
          - added call to new aircraft_emit_adv
M       models/atm/cam/src/chemistry/utils/tracer_data.F90
          - added the following new basic functionalities
              - stepTime: time can "step" (no interpolation is done in time)
              - CYCLICAL_LIST: added capability of cycling of filelists
              - weight_by_lat: if true, then performs interpolations weighted by lat
              - conserve_column: if tue, then interpolations preserve the total column
          - introduced new routine advance_file: Copy of section in check_files which is
            now called in two places.
M       models/atm/cam/src/control/runtime_opts.F90
          - added call to aircraft_emit_readnl

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: none

calgary/lf95:

calgary/pgi or jaguar/pgi:

CAM tag used for the baseline comparison tests if different than previous
tag: camdev_cam3_6_23_tags/camdev55_cam3_6_72

Summarize any changes to answers, i.e., NONE
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff? NONE

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_08 
Originator(s): Diane Feddema 
Date: 26 Jul 2010 
One-line Summary:  Renamed two derived types: surface_state became cam_out_t, srfflx_state became cam_in_t.  

Purpose of changes: To clarify the intended use of these derived types. 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton 

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
models/atm/cam/src/control/camsrfexch_types.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/control/srfxfer.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/control/cam_restart.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/control/cam_comp.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/cpl_mct/atm_comp_mct.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/advnce.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/physics/cam/iop_surf.F90
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/phys_debug.F90
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/radiation.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/restart_physics.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/physics/cam/cam_diagnostics.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/chemistry.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/flux_avg.F90
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/physpkg.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"
    
models/atm/cam/src/physics/cam/tphysbc.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/cam/tphysac.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/physics/rrtmg/radiation.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/chemistry/utils/aerodep_flx.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/chemistry/modal_aero/modal_aero_deposition.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/chemistry/mozart/chemistry.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/chemistry/mozart/mo_drydep.F90
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/chemistry/mozart/mo_lightning.F90
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/chemistry/mozart/spedata.F90
comment line changed ("srfflx_state" was changed to "cam_in" in comment)

models/atm/cam/src/dynamics/eul/stepon.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/dynamics/homme/stepon.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/dynamics/fv/metdata.F90
derived type name "srfflx_state"  was changed to "cam_in_t"

models/atm/cam/src/dynamics/fv/stepon.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/dynamics/fv/fv_prints.F90
derived type name "surface_state" was changed to "cam_out_t"

models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
derived type name "surface_state" was changed to "cam_out_t"
derived type name "srfflx_state"  was changed to "cam_in_t"


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all pass 

edinburgh/lf95: all pass 

edinburgh/pgi or jaguar/pgi: all pass 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_07
Originator(s): Francis Vitt
Date: 21 Jul 2010
One-line Summary: Bug fixes to FV dycore offline driver and the chemistry customization option in CAM configure.

Purpose of changes:

 Fix a bug in the FV dycore offline driver that was introduced when the 
 metdata module used by the FV dycore offline driver was modified to use 
 parallel IO utilities.  

 Fix a bug in the CAM configure utility to allow the user to customize
 the  trop_bam, trop_ghg, and waccm_ghg chemistry packages via the "-usr_mech_infile" 
 configure option.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M   models/atm/cam/test/system/config_files/fmo1.9c4dh
 Use the new -offline_dyn configure option

M   models/atm/cam/bld/configure
M   models/atm/cam/bld/config_files/definition.xml
 Added "-offline_dyn" option

M   models/atm/cam/bld/config_files/defaults_trop_bam.xml
M   models/atm/cam/bld/config_files/defaults_trop_ghg.xml
M   models/atm/cam/bld/config_files/defaults_waccm_ghg.xml
 Removed the "prog_species" specification to allow the user to customize
 the chemical mechanism.  The prog_species specification is not needed
 here since these chemistry packages are pre-defined, i.e., the preprocessor
 generated source code for the chem packages are already included in the 
 standard source code distribution.

M   models/atm/cam/bld/build-namelist
 Adjustments needed for trop_bam, trop_ghg, and waccm_ghg since prog_species
 is not set for these chem packages. 
 Included the ver=>'fixed_ox' specification to tracer_cnst* default namelist 
 settings.

M   models/atm/cam/src/dynamics/fv/metdata.F90
 Corrected problems with the reading of prescribed meteorology fields that
 were introduced when this module was modified to use parallel IO utilities
 in cam4_1_12.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all pass

edinburgh/lf95: all pass

edinburgh/pgi: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam5_0_06
Originator(s): andrew, eaton
Date: Mon Jul 19 19:10:10 MDT 2010
One-line Summary: separate aerosol activation code from microphysics code

Purpose of changes:

. Separate the aerosol activation code from the microphysics code.

. Change waccm_ghg test to use cam4 physics.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: 

models/atm/cam/test/system/config_files/wg10c5dm
. this file was moved to wg10c4dm

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/microp_aero.F90
. aerosol activation code previously in cldwat2m_micro.F90

models/atm/cam/test/system/config_files/wg10c4dm
. was wg10c4dm -- change cam5 to cam4

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/physics/cam/cldwat2m_micro.F90
. Move aerosol activation code to new microp_aero module.

models/atm/cam/src/physics/cam/stratiform.F90
. add calls to microp_aero subroutines

models/atm/cam/test/system/input_tests_master
. wg10c5dm changed to wg10c4dm


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Jul 14 19:14:39 MDT 2010
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Wed Jul 14 19:40:24 MDT 2010
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Wed Jul 14 20:20:16 MDT 2010
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Wed Jul 14 20:40:42 MDT 2010
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Wed Jul 14 21:31:32 MDT 2010

These baseline failures are due to roundoff changes associated with the
code refactoring.

edinburgh/lf95: 
034 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 5 at Mon Jul 19 18:45:06 MDT 2010

edinburgh/pgi:
034 bl314 TBL.sh wg10c4dm outfrq3s 9s .....................................FAIL! rc= 5 at Mon Jul 19 18:26:03 MDT 2010

bl314 fails because it is a new test -- no baseline available for comparison.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: cam4 is BFB.  cam5 has roundoff changes
  due to the code refactoring.  Andrew Gettelman verified the roundoff
  changes.

===============================================================
===============================================================

Tag name: cam5_0_05
Originator(s): olson
Date: Fri Jun 30 2010
One-line Summary: added capability to specify which history file to place heat/moisture budget terms

Purpose of changes: 
Added the namelist variable "history_budget_histfile_num" to specify which
history file to place the heat/moisture budget terms (and instantaneous state fields).
Previously the only option was the primary history file.  When "history_budget" is .false.,
"history_budget_histfile_num" is ignored.  Default is "1" (primary).
	
Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: added "history_budget_histfile_num"

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
M      models/atm/cam/src/physics/cam/phys_control.F90
-	added "history_budget_histfile_num" to namelist and control infrastructure
	
M      models/atm/cam/src/dynamics/eul/dyn_comp.F90
M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
M      models/atm/cam/src/physics/cam/convect_shallow.F90
M      models/atm/cam/src/physics/cam/gw_drag.F90
M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/cam/vertical_diffusion.F90
M      models/atm/cam/src/physics/cam/zm_conv_intr.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90

-	replaced the primary history file designation ("1") with "history_budget_histfile_num"
	in the call to "add_default"

M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
M      models/atm/cam/src/physics/cam/stratiform.F90
-	replaced the primary history file designation ("1") with "history_budget_histfile_num"
	in the call to "add_default".  Also, made the state fields instantaneous for that 
	history file when "history_budget" is .true.
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_04
Originator(s): mvr, jedwards
Date: Fri Jun 25 2010
One-line Summary: various fixes made to test scripts; pnetcdf bug fix and 
io cleanup from release branch

Purpose of changes: 
The test scripts place an explicit call to generate_cice_decomp.pl (the cice 
decomposition script) so that cice can be built in a manner that allows reuse 
of the resulting binary during restart tests, where the number of mpi tasks 
(and possible smp threads) are changed.  Until now, this script was not being 
called with the proper inputs, but still managed to provide an executable 
that could be reused for restart tests.  

However, we discovered that this was the cause of a failed test in the jaguar 
posttag testing, where the pgi compiler had a problem with zero-length arrays 
being created as a by-product.  To fix that problem, changes were made to properly 
call the decomp script and make the necessary changes to the rest of the test 
scripts to deal with some of its constraints.  For example, testing on bluefire 
was moved to 48 processors (under-utilizing one bluefire node) because many of its 
tests are done at fv 4x5, which does not have a cartesian solution with 64 procs.

This is viewed as a short-term solution.  Long-term we intend to remove the call 
to generate_cice_decomp.pl from the test scripts and have cam's configure figure 
out the parameters to send to the cice build.
	
Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/config_files/fma1.9c5m
D      models/atm/cam/test/system/config_files/fmgpa1.9c5dm
D      models/atm/cam/test/system/config_files/fmo1.9c5dh
- config options test files using cam5 were replaced with those using cam4

D      models/atm/cam/test/system/nl_files/off2x2.5
- removed obsolete test file
	
List all subroutines added and what they do: 
A      models/atm/cam/test/system/config_files/fmgpa1.9c4dm
A      models/atm/cam/test/system/config_files/fma1.9c4m
A      models/atm/cam/test/system/config_files/fmo1.9c4dh
- config options test files using cam5 were replaced with those using cam4

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TCB.sh
- modification of the call to generate_cice_decomp.pl
	
M      models/atm/cam/test/system/test_driver.sh
- bluefire testing now done on 48 processors instead of 64; no longer 
  using 'module purge' prior to jaguar testing

M      models/atm/cam/test/system/nl_files/off1.9x2.5
- namelist options test file now will use inputfile with 26 levels (needed for cam4 testing)

M      models/atm/cam/test/system/nl_files/fvvp_lb2
- namelist options file modified to fit into fewer processors on bluefire

M      models/atm/cam/test/system/input_tests_master
- changes to test definitions to reflect some tests moving from cam5 to cam4

M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/bld/run-cray.csh
- run template scripts now execute build-namelist from rundir rather than blddir

M      models/atm/cam/src/utils/cam_pio_utils.F90
- bug fix for pnetcdf (from jedwards)
	
M      models/atm/cam/src/utils/time_manager.F90
M      models/atm/cam/src/utils/cam_csim4/ice_filenames.F90
M      models/atm/cam/src/utils/cam_csim4/cpl_mct/ice_comp_mct.F90
M      models/atm/cam/src/utils/cam_csim4/ice_data.F90
M      models/atm/cam/src/utils/cam_csim4/ice_time_manager.F90
M      models/atm/cam/src/utils/cam_csim4/ice_srf.F90
M      models/atm/cam/src/utils/cam_csim4/ice_comp.F90
M      models/atm/cam/src/physics/cam/rayleigh_friction.F90
M      models/atm/cam/src/physics/cam/phys_gmean.F90
M      models/atm/cam/src/physics/cam/modal_aer_opt.F90
M      models/atm/cam/src/physics/cam/ndrop.F90
M      models/atm/cam/src/physics/cam/convect_shallow.F90
M      models/atm/cam/src/physics/cam/cldwat2m_macro.F90
M      models/atm/cam/src/physics/cam/uwshcu.F90
M      models/atm/cam/src/physics/cam/vertical_diffusion.F90
M      models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
M      models/atm/cam/src/chemistry/modal_aero/modal_aero_wateruptake.F90
M      models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M      models/atm/cam/src/chemistry/mozart/lin_strat_chem.F90
M      models/atm/cam/src/chemistry/mozart/wei96.F90
M      models/atm/cam/src/dynamics/sld/restart_dynamics.F90
M      models/atm/cam/src/dynamics/eul/restart_dynamics.F90
M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
M      models/atm/cam/src/dynamics/fv/restart_dynamics.F90
- io cleanup pulled in from release branch

M      models/atm/cam/src/dynamics/homme/restart_dynamics.F90
- bug fix for homme restart on 48 processors (from jedwards)
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_03
Originator(s): eaton
Date: Mon Jun 21 09:08:32 MDT 2010
One-line Summary: code workaround for bluefire threading problem; update externals

Purpose of changes:

. A system problem on bluefire has been causing threaded CAM runs to either
  crash badly (bringing down the node) when running cam5, or just seg fault
  when running with cam4.  A code modification has been made in the
  tropopause module which allows cam4 to run without seg faulting, but does
  not fix the problem running cam5.  A firmware fix for bluefire will be
  applied shortly, and at that time we may back out this workaround.

. Update to cesm1_0_beta05 externals.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. add default jan 01 IC for 1 deg cam5

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. drvseq3_1_30 -> drvseq3_1_32
  clm4_0_08    -> clm4_0_09
  cice4_0_20100607 -> cice4_0_20100611
  share3_100607 -> share3_100616
  scripts4_100608 -> scripts4_100617

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add cami-mam3_0000-01-01_0.9x1.25_L30_c100618.nc

models/atm/cam/src/physics/cam/tropopause.F90
. Make the variables kap, faktor, and ka1 module variables, and remove the
  local declarations in routine twmo.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_02
Originator(s): aconley, fvitt
Date: 16 June 2010
One-line Summary: RRTMG source code clean up.

Purpose of changes:

 Rename the "conley" liquid cloud optics method to "gammadist"

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

 RRTMG liqcloudoptics method "conley" changed to "gammadist"

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

U    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
U    models/atm/cam/bld/namelist_files/namelist_definition.xml
U    models/atm/cam/src/physics/rrtmg/radiation.F90
 - Changed "conley" liquid cloud optics method to "gammadist"

U    models/atm/cam/src/physics/rrtmg/ebert_curry.F90
U    models/atm/cam/src/physics/rrtmg/slingo.F90
 - Fixed bug for wavelengths greater the 2.38 micrometers.
   These methods are not used in the default configurations so this
   bug fix had no effect on the base-line regression tests.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS

edinburgh/lf95: all PASS

edinburgh/pgi: all PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, BFB

===============================================================
===============================================================

Tag name: cam5_0_01
Originator(s): eaton
Date: Tue Jun 15 08:21:45 MDT 2010
One-line Summary: back out change to restart file

Purpose of changes:

. The change to the restart file made in cam4_9_11 which moved the variable
  rst_calendar to a global attribute has been backed out.  The change is
  not backwards compatible with older restart files which prevents the
  model from doing branch runs from older ccsm4 runs.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/utils/time_manager.F90
. revert rst_calendar from a global attribute back to being a variable

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: not done

edinburgh/lf95: not done

edinburgh/pgi or jaguar/pgi: not done

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam5_0_00
Originator(s): fvitt, eaton
Date: Sun Jun 13 09:30:22 MDT 2010
One-line Summary: branch point for CAM5 release; hist output mods

Purpose of changes:

. The CAM5 release branch will be made off of this tag.

. Modify addfld/add_default calls so that fields relevent to cam5 physics
  don't show up by default when using cam4 physics.

. Updates to chemistry namelist documentation.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/namelist_definition.xml
. update documentation

models/atm/cam/src/chemistry/mozart/lin_strat_chem.F90
. don't execute init method unless needed

models/atm/cam/src/physics/cam/ndrop.F90
. add the addfld/add_default calls for
  WTKE,LCLOUD,NDROPMIX,NDROPSRC,NDROPSNK,NDROPCOL 

models/atm/cam/src/physics/cam/stratiform.F90
. remove addfld/add_default calls for
  WTKE,LCLOUD,NDROPMIX,NDROPSRC,NLSED,NDROPSNK,NDROPCOL 
  - there was no outfld call for NLSED, the other diags belong in ndrop.

models/atm/cam/src/physics/waccm/qbo.F90
. remove extraneous log messages


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam4_9_12
Originator(s): eaton et al.
Date: Sat Jun 12 12:25:34 MDT 2010
One-line Summary: update externals; build-namelist mod for cam5; change
  adiabatic mode dry mass; fix cam5 budget output; cleanup for release

Purpose of changes:

. update externals to be consistent with cesm1_0_beta03

. modify build-namelist to call the cice build-namelist with cam5=.true. for
  cam5 runs.  This enables the cice build-namelist to provide the following
  cam5 specific settings: r_snw=1.75, dt_mlt_in=1.0, rsnw_melt_in=1000.
  Note that these changes were already in place for runs using the ccsm
  scripts. 

. updates to namelist defaults for HOMME (from Mark Taylor)

. new run script template for scam (from John Truesdale)

. updates to aquaplanet use case (from John Truesdale)

. change how the dry atmosphere mass is fixed in adiabatic mode (from
  Christianne Jablonowski)

. cleanup comments in stratiform (from Andrew Gettelman)

. add missing CAM5 budget diagnostics (from Jerry Olson)

. remove unsupported KE deep convection scheme

. remove unsupported water tracer code

Bugs fixed (include bugzilla ID): none

. fix bug in creation of cam.buildexe.csh (wouldn't allow switching between
  mct and esmf interfaces after the script was created)  This is only
  relevent to running with ccsm scripts.  (from Tony Craig)

Describe any changes made to build system: none

Describe any changes made to the namelist:

. modify the atm_dep_flux namelist variable so that setting it to false
  explicitly sets the deposition fluxes sent to the coupler to zero.
  Previously setting it to false was supposed to signal to CLM and CICE to
  read the deposition fluxes from an external file.  But that functionality
  has been removed from CICE, and both CLM and CICE now expect CAM to
  always provide these fluxes.  Explicitly setting them to zero provides a
  way to turn of the climate feedbacks from prognostically determined
  fluxes.

List any changes to the defaults for the boundary datasets: 

. update the 20th century use cases to use the 1850-2008 AMIP SST datasets
  rather than 1850 climatology.  (This affects CAM standalone runs only,
  not runs done using ccsm scripts.)

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/physics/cam/convect_ke.F90
models/atm/cam/src/physics/cam/convect_ke_intr.F90
. remove KE deep convection

models/atm/cam/src/control/wtrc_flxoce.F90
models/atm/cam/src/physics/cam/water_isotopes.F90
models/atm/cam/src/physics/cam/water_tracers.F90
. remove water tracer code

List all subroutines added and what they do:

models/atm/cam/bld/run-scam.csh
. new run script template for scam

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. clm4_0_07        -> clm4_0_08
  cice4_0_20100602 -> cice4_0_20100607
  scripts4_100603a -> scripts4_100608

models/atm/cam/bld/build-namelist
. add "cam5=.true." to the cice namelist arg when cam5 physics used.
. remove setting of faerdep in clm namelist

models/atm/cam/bld/cam.cpl7.template
. fix bug in creation of cam.buildexe.csh (wouldn't allow switching between
  mct and esmf interfaces after the script was created)

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update defaults for HOMME (parameters and ne240np4 IC file for jan 01)
. remove faerdep defaults since no longer asking CLM to read deposition file

models/atm/cam/bld/namelist_files/namelist_definition.xml
. remove KE as valid option for deep_scheme
. remove wisotope, tracer_water

models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3_cam4.xml
. update tuning parameters

models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_bgc.xml
models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4.xml
models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
. update the 20th century use cases to use the 1850-2008 AMIP SST datasets
  rather than 1850 climatology.

models/atm/cam/src/control/runtime_opts.F90
. remove trace_water, wisotope variables
. remove water_isotopes, water_tracers

models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
models/atm/cam/src/cpl_mct/atm_comp_mct.F90
. hardcode the setting of atm_aero=.true. rather than listening to the
  atm_dep_flux variable since the ability of the cice code to read the
  deposition fluxes from an external file has been removed.


models/atm/cam/src/dynamics/eul/inidat.F90
models/atm/cam/src/dynamics/sld/inidat.F90
. initialize tmass0 from the initial pressure field for adiabatic runs

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. in subroutine diag_surf set the deposition fluxes to zero if
  atm_dep_flux=.false.

models/atm/cam/src/physics/cam/cldwat.F90
. remove deep_scheme='KE' 

models/atm/cam/src/physics/cam/cloud_fraction.F90
. remove unused deep_scheme variable

models/atm/cam/src/physics/cam/convect_deep.F90
. remove deep_scheme='KE'

models/atm/cam/src/physics/cam/initindx.F90
models/atm/cam/src/physics/cam/physpkg.F90
. remove water_tracers

models/atm/cam/src/physics/cam/stratiform.F90
. cleanup comments
. remove deep_scheme from inimc calling args.
. add diagnostics:
  'DPDLFLIQ ','DPDLFICE ','SHDLFLIQ ','SHDLFICE ','DPDLFT   ','SHDLFT   '
. remove water_tracers

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
009 bl134 TBL.sh e48adh adia 9s ...........................................FAIL! rc= 7 at Fri Jun 11 18:10:39 MDT 2010
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Jun  9 15:36:44 MDT 2010
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Wed Jun  9 16:03:07 MDT 2010
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Wed Jun  9 16:39:49 MDT 2010
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Wed Jun  9 16:59:21 MDT 2010
045 bl373 TBL.sh fm1.9c4dh outfrq3s 9s ....................................FAIL! rc= 7 at Wed Jun  9 17:28:04 MDT 2010
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Wed Jun  9 17:46:41 MDT 2010
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Wed Jun  9 18:06:49 MDT 2010
054 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Wed Jun  9 18:22:54 MDT 2010
057 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Wed Jun  9 18:34:21 MDT 2010
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Wed Jun  9 19:14:19 MDT 2010
068 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Wed Jun  9 19:55:26 MDT 2010

edinburgh/lf95: All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Jun  9 15:13:25 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Jun  9 15:34:55 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Jun  9 15:48:02 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Jun  9 16:26:15 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Wed Jun  9 17:02:19 MDT 2010
034 bl314 TBL.sh wg10c5dm outfrq3s 9s .....................................FAIL! rc= 4 at Wed Jun  9 17:10:32 MDT 2010

edinburgh/pgi: All PASS except:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Wed Jun  9 14:47:02 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Wed Jun  9 14:52:42 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Wed Jun  9 14:58:31 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Wed Jun  9 15:08:45 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Wed Jun  9 15:16:42 MDT 2010
034 bl314 TBL.sh wg10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Wed Jun  9 15:27:47 MDT 2010

The baseline failures are due to the following:
. The bugfix to snow hydrology in CLM changes answers in all configurations
  that use CLM.
. The update to build-namelist changes answers for all configurations using
  CAM5 physics and CICE due to changed parameter values.
. The update to how the dry mass is initialized in adiabatic mode causes
  answer changes in all adiabatic tests.
. The update to use the AMIP SST datasets for all transient tests changes
  answers in runs using the 1850-2005 use cases.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: cam is BFB, but answers change due to new
  externals and boundary datasets.

===============================================================
===============================================================

Tag name: cam4_9_11
Originator(s): Jim Edwards, Art Mirin, Mark Taylor
Date: 6/9/2010
One-line Summary: Update Homme Dynamics

Purpose of changes: Development/ bug fixes

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: 

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Jim

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
      models/atm/cam/doc/ChangeLog_template
        removed calgary added edinburgh
	
      models/atm/cam/test/system/input_tests_master
      Renamed models/atm/cam/test/system/config_files/h16x4c3dm
	to
       models/atm/cam/test/system/config_files/h16x4c3dh
        following the convention because OpenMP was added to the test.

      models/atm/cam/test/system/test_driver.sh
	updated pnetcdf version for bluefire.   

      models/atm/cam/bld/config_files/horiz_grid.xml
	added a very low resolution homme grid
      models/atm/cam/bld/namelist_files/namelist_definition.xml
	added qsplit to homme ctl_nl
      models/atm/cam/src/utils/time_manager.F90
	made the calendar string an attribute rather than a variable
      models/atm/cam/src/dynamics/sld/inidat.F90
      models/atm/cam/src/dynamics/eul/inidat.F90
	Fixed a bug in reading the PHIS variable when the from_hires attribute
	is not defined.
      models/atm/cam/src/dynamics/homme/external/filter_mod.F90
      models/atm/cam/src/dynamics/homme/external/diffusion_mod.F90
      models/atm/cam/src/dynamics/homme/external/mass_matrix_mod.F90
      models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
      models/atm/cam/src/dynamics/homme/external/parallel_mod.F90
      models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
      models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
      models/atm/cam/src/dynamics/homme/external/control_mod.F90
      models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
      models/atm/cam/src/dynamics/homme/external/element_mod.F90
      models/atm/cam/src/dynamics/homme/external/viscosity_mod.F90
      models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
      models/atm/cam/src/dynamics/homme/external/edge_mod.F90
      models/atm/cam/src/dynamics/homme/external/dof_mod.F90
      models/atm/cam/src/dynamics/homme/external/solver_mod.F90
      models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
      models/atm/cam/src/dynamics/homme/dp_coupling.F90
      models/atm/cam/src/dynamics/homme/stepon.F90
      models/atm/cam/src/dynamics/homme/inidat.F90
      models/atm/cam/src/dynamics/homme/dyn_comp.F90
      models/atm/cam/src/dynamics/homme/restart_dynamics.F90
      models/atm/cam/src/dynamics/homme/spmd_dyn.F90
        Fixed OpenMP implementation.   Ported recent development from homme standalone
	repository.  


	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all pass except
        063 bl731 TBL.sh h16x4c3dh aqua 9s   expected due to dycore 
	      development and change of test from MPI to hybrid.
edinburgh/lf95:  all pass

edinburgh/pgi : all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam4_9_10
Originator(s): fvitt, eaton
Date: Tue Jun  8 08:15:34 MDT 2010
One-line Summary: add BGC and WACCM use cases; update externals

Purpose of changes:

. add use cases 1850-2005_cam4_bgc and waccm_2000_cam4
. update csm_share and driver externals
. modify run script templates to explicitly run fv, 1.9x2.5

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: 

models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_bgc.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_2000_cam4.xml
. new use case files

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. drvseq3_1_29  -> drvseq3_1_30
. share3_100515 -> share3_100607

models/atm/cam/bld/namelist_files/namelist_definition.xml
. fix category of co2_cycle_rad_passive namelist var

models/atm/cam/bld/run-cray.csh
models/atm/cam/bld/run-ibm.csh
models/atm/cam/bld/run-pc.csh
. configure for fv, 1.9x2.5

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers; BFB

===============================================================
===============================================================

Tag name: cam4_9_09
Originator(s): hannay, gettelman, morrison, mvr
Date: 
One-line Summary: finalize CAM5 

Purpose of changes: 
* bugfix in microphysics and major (non-answer changing) cleanup of code, 
* physics changes (scale sea-salt, change in solubility factor, emissions numbers for black carbon and organic carbon, rhminl)
* Change testing of mozart :  fm1.9c5 =>  fm1.9c4
	
Bugs fixed (include bugzilla ID):
Bug Fix in microphysics:  calculation of pgam changed to c1 * (ncic/1e.-6 * rho) + c2  [bug was dividing by rho] 
	
Describe any changes made to build system:

Describe any changes made to the namelist:
* Changes to output by default the MG microphysics variables for AMWG package
	
List any changes to the defaults for the boundary datasets:
* Changes in emissions numbers for black carbon and organic carbon
* Changes in hygroscopicity "B" of POA from 0 to 0.1 	
	
Describe any substantial timing or memory changes:
* efficiency improvements due to major non-answer changing cleanup of microphysics code
	
Code reviewed by: hannay, eaton

List all subroutines eliminated:

* models/atm/cam/test/system/config_files/fm1.9c5dh
* models/atm/cam/test/system/config_files/fm1.9c5m
	Delete testing: fm1.9c5 (testing mozart in cam5)
	
List all subroutines added and what they do:
* models/atm/cam/test/system/config_files/fm1.9c4dh	
* models/atm/cam/test/system/config_files/fm1.9c4m
	Add testing: fm1.9c4 (testing mozart in cam4)
	
List all existing files that have been modified, and describe the changes:
* models/atm/cam/test/system/input_tests_master
	Change testing of mozart:  fm1.9c5 =>  fm1.9c4
	
* models/atm/cam/src/physics/cam/cldwat2m_micro.F90
	Major non-answer changing cleanup of code, includes efficiency improvements
	Bug Fix:  calculation of pgam changed to c1 * (ncic/1e.-6 * rho) + c2  [bug was dividing by rho]
	Sub-grid qc removed from fallspeed calculation (unc, umc)
	For t > tmelt, use esl (saturation vapor pressure over liquid)(2-4 are answer changing)
	
* models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
	scale sea-salts: increase by 35%

* models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
	change in the solubility factor: sol_factic = 0.5->0.4

* models/atm/cam/src/physics/cam/phys_control.F90
	output by default the MG microphysics variables for AMWG package

* models/atm/cam/bld/build-namelist
	Changes to output by default the MG microphysics variables for AMWG package

* models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
	Change in rhminl: 0.905->0.89
	Changes in emissions numbers for black carbon and organic carbon
	Changes in hygroscopicity "B" of POA from 0 to 0.1 (atm/cam/physprops/ocpho_rrtmg_c100528.nc)
		
* models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
	Changes in emissions numbers for black carbon and organic carbon	
	
* models/atm/cam/bld/namelist_files/use_cases/1850_cam5.xml
	Changes in emissions numbers for black carbon and organic carbon	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Mon Jun  7 11:10:45 MDT 2010
013 bl330 TBL.sh f4c5pdh aqpgro 3s ........................................FAIL! rc= 7 at Mon Jun  7 11:10:48 MDT 2010
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Mon Jun  7 11:10:59 MDT 2010
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Mon Jun  7 11:11:09 MDT 2010
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Mon Jun  7 11:11:34 MDT 2010
047 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 7 at Mon Jun  7 11:23:02 MDT 2010

calgary/lf95:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Sat Jun  5 16:09:08 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Sat Jun  5 16:22:41 MDT 2010
010 bl113 TBL.sh e8c5pdm aqpgro 3s ........................................FAIL! rc= 7 at Sat Jun  5 16:26:37 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Sat Jun  5 16:32:33 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Sat Jun  5 16:59:28 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Sat Jun  5 17:27:04 MDT 2010
031 bl313 TBL.sh f10c5pdm aqpgro 3s .......................................FAIL! rc= 7 at Sat Jun  5 17:32:17 MDT 2010
034 bl314 TBL.sh wg10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Sat Jun  5 17:32:19 MDT 2010
039 bl316 TBL.sh f10c5pdm aqpgro+aquaplanet_cam5 3s .......................FAIL! rc= 7 at Sat Jun  5 17:35:00 MDT 2010
- any baseline tests where cam5 was used were expected to fail becasue changes in the cam5 physics
	
calgary/pgi or jaguar/pgi:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 7 at Sat Jun  5 15:57:09 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 7 at Sat Jun  5 16:03:12 MDT 2010
010 bl113 TBL.sh e8c5pdm aqpgro 3s ........................................FAIL! rc= 7 at Sat Jun  5 16:07:29 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 7 at Sat Jun  5 16:09:19 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 7 at Sat Jun  5 16:19:37 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 7 at Sat Jun  5 16:28:00 MDT 2010
031 bl313 TBL.sh f10c5pdm aqpgro 3s .......................................FAIL! rc= 7 at Sat Jun  5 16:32:30 MDT 2010
034 bl314 TBL.sh wg10c5dm outfrq3s 9s .....................................FAIL! rc= 7 at Sat Jun  5 16:38:44 MDT 2010
039 bl316 TBL.sh f10c5pdm aqpgro+aquaplanet_cam5 3s .......................FAIL! rc= 7 at Sat Jun  5 16:43:06 MDT 2010
- any baseline tests where cam5 was used were expected to fail becasue changes in the cam5 physics
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam4_9_08
Originator(s): mvr, hannay
Date: Fri Jun  4  2010
One-line Summary: updated to recent versions of external component code; Turn on 
	volcanic aerosols in CAM5 for the 1850-2005 use case.

Purpose of changes:

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: changes needed to implement volcanic 
	aerosols in cam5

List any changes to the defaults for the boundary datasets: new setting for volcanics

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: 
A      models/atm/cam/test/system/nl_files/volc
- new namelist options test file for testing volcanics
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TER.sh
M      models/atm/cam/test/system/TSM.sh
- added dumping of missing namelists to test log output
	
M      models/atm/cam/test/system/input_tests_master
- change in test definition for test of cam5 volcanics
	
M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/bld/run-cray.csh
- fix to run template scripts needed to utilize new ocn.stream.txt info
	
M      models/atm/cam/bld/configure
- removed ntr_pond and ntr_iage settings from cice configure call
	
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
- changes required to implement volcanic aerosols in cam5
	
M      SVN_EXTERNAL_DIRECTORIES
 M     .
- updated external definitions for drv,clm,cice,pio,scripts

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Fri Jun  4 12:26:23 MDT 2010
- failure expected due to bug fix in drydep code of new clm tag
	
002 bl375 TBL.sh f1.9c5m volc+1850-2005_cam5 2d ...........................FAIL! rc= 5 at Fri Jun  4 14:57:52 MDT 2010
- failure due to new test definition not recognized by baseline code, but would have failed anyway due to change 
  in volcanics in cam5 physics
	
edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam4_9_07
Originator(s): eaton
Date: Wed Jun  2 16:33:56 MDT 2010
One-line Summary: mods for BGC runs; mods to super_fast_llnl use cases;
 misc cleanup

Purpose of changes:

. Add logic to build-namelist for the desired co2_cycle behavior: 
  If co2_cycle is true then:
  - don't read the co2 fossil fuel fluxes when sim_year=1850
  - read the co2 fossil fuel fluxes when sim_year=1850-2000 unless the user
    explicitly sets co2_readflux_fuel=.false.
  - make the prognostic CO2 radiatively active unless the user explicitly
    sets co2_cycle_rad_passive=.true.

. mods for output when co2_cycle is active
. mods in super_fast_llnl use cases
. make the setting of npr_yz in the cam.buildnml.csh script more robust 
. remove the compiler patch args from the AIX section.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:

. namelist variables for the co2_cycle module were put into their own
  namelist group co2_cycle_nl

. namelist variables for the chem_surfvals module were put into their own
  namelist group chem_surfvals_nl

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add logic for desired co2_cycle behavior: when co2_cycle is true then
  - don't read the co2 fossil fuel fluxes when sim_year=1850
  - read the co2 fossil fuel fluxes when sim_year=1850-2000 unless the user
    explicitly sets co2_readflux_fuel=.false.
  - make the prognostic CO2 radiatively active unless the user explicitly
    sets co2_cycle_rad_passive=.true.

models/atm/cam/bld/cam.cpl7.template
. make the setting of npr_yz in the cam.buildnml.csh script more robust

models/atm/cam/bld/Makefile.in
. Remove the compiler patch args from the AIX section.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. change group of co2_cycle namelist variables to co2_cycle_nl
. put the chem_surfvals namelist variables into the chem_surfvals_nl group.
. remove unused variable prognostic_sulfur
. add co2_cycle_rad_passive
. updates to documentation

models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
. adjust h0 fields

models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
. turn on clm drydep

models/atm/cam/src/physics/cam/aoa_tracers.F90
. put log output inside if(masterproc) condition

models/atm/cam/src/control/cam_history.F90
. replace chem_surfvals_get('CO2VMR') by chem_surfvals_co2_rad(vmr_in=.true.)

models/atm/cam/src/control/runtime_opts.F90
. remove co2_{default,set}opts routines
. add call to co2_cycle_readnl
. replace chem_surfvals_{default,set}opts calls by chem_surfvals_readnl

models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90 
models/atm/cam/src/cpl_mct/atm_comp_mct.F90
. remove outfld calls for SFCO2*

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. add outfld calls for SFCO2*, CO2*_BOT

models/atm/cam/src/physics/cam/chem_surfvals.F90
. modify chem_surfvals_co2_rad with an optional argument to allow it to
  return co2 as vmr (default is to return it as mmr).
. add chem_surfvals_readnl for reading namelist

models/atm/cam/src/physics/cam/co2_cycle.F90
. add addfld calls for CO2*_BOT
. add add_default calls for TMCO2*

models/atm/cam/src/physics/cam/co2_cycle.F90
. add co2_cycle_readnl routine to read namelist
. remove old co2_{default,set}opts routines

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

Note: answers will change when using the 1850_cam4_super_fast_llnl use case.

===============================================================
===============================================================

Tag name: cam4_9_06
Originator(s): mvr
Date: 27 May 2010
One-line Summary: cleanup of test scripts 

Purpose of changes:
the filename of the configure options file used by each test did not 
always contain a string indicating which physics package was being 
exercised - filenames in these instances were changed

removed the cppdef -DNO_VEXP from the test scripts as it is no longer 
being used by the model

removed test of waccm using cam5 physics until the configuration has been 
validated
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
	
Describe any changes made to the namelist:
	
List any changes to the defaults for the boundary datasets:
	
Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/config_files/f4h
D      models/atm/cam/test/system/config_files/fmo1.9dh
D      models/atm/cam/test/system/config_files/fm1.9m
D      models/atm/cam/test/system/config_files/e64m
D      models/atm/cam/test/system/config_files/s8dm
D      models/atm/cam/test/system/config_files/e48m
D      models/atm/cam/test/system/config_files/e64o
D      models/atm/cam/test/system/config_files/scm64bfbiop
D      models/atm/cam/test/system/config_files/e64bfbiop
D      models/atm/cam/test/system/config_files/f4dm
D      models/atm/cam/test/system/config_files/s48dh
D      models/atm/cam/test/system/config_files/s32pdh
D      models/atm/cam/test/system/config_files/wm4dh
D      models/atm/cam/test/system/config_files/s32dh
D      models/atm/cam/test/system/config_files/f10pdm
D      models/atm/cam/test/system/config_files/wm1.9m
D      models/atm/cam/test/system/config_files/scmarmiop
D      models/atm/cam/test/system/config_files/e8dm
D      models/atm/cam/test/system/config_files/f10t5mdm
D      models/atm/cam/test/system/config_files/wg10dm
D      models/atm/cam/test/system/config_files/scm64bfbiop_4
D      models/atm/cam/test/system/config_files/fma1.9h
D      models/atm/cam/test/system/config_files/e64bfbiop_4
D      models/atm/cam/test/system/config_files/fm1.9dh
D      models/atm/cam/test/system/config_files/fma1.9m
D      models/atm/cam/test/system/config_files/e8pdm
D      models/atm/cam/test/system/config_files/e8t5mdm
D      models/atm/cam/test/system/config_files/s64h
D      models/atm/cam/test/system/config_files/f1.9h
D      models/atm/cam/test/system/config_files/s64m
D      models/atm/cam/test/system/config_files/f1.9m
D      models/atm/cam/test/system/config_files/e64pm
D      models/atm/cam/test/system/config_files/h16x4dm
D      models/atm/cam/test/system/config_files/s64o
D      models/atm/cam/test/system/config_files/s8pdm
D      models/atm/cam/test/system/config_files/f1.9o
D      models/atm/cam/test/system/config_files/fmgpa1.9dh
D      models/atm/cam/test/system/config_files/s8t5mdm
D      models/atm/cam/test/system/config_files/fmgpa1.9dm
D      models/atm/cam/test/system/config_files/f10dm
D      models/atm/cam/test/system/config_files/s48pdh

List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/f10c5pdm
A      models/atm/cam/test/system/config_files/scmc5armiop
A      models/atm/cam/test/system/config_files/f10c5t5mdm
A      models/atm/cam/test/system/config_files/e8c5dm
A      models/atm/cam/test/system/config_files/wg10c5dm
A      models/atm/cam/test/system/config_files/fm1.9c5dh
A      models/atm/cam/test/system/config_files/e8c5pdm
A  +   models/atm/cam/test/system/config_files/scm64c4bfbiop
A  +   models/atm/cam/test/system/config_files/e64c4bfbiop
A      models/atm/cam/test/system/config_files/wm1.9c4h
A      models/atm/cam/test/system/config_files/e8c5t5mdm
A      models/atm/cam/test/system/config_files/s64c5h
A      models/atm/cam/test/system/config_files/s64c5m
A  +   models/atm/cam/test/system/config_files/h16x4c3dm
A      models/atm/cam/test/system/config_files/e64c5pm
A      models/atm/cam/test/system/config_files/s8c5pdm
A      models/atm/cam/test/system/config_files/s8c5t5mdm
A      models/atm/cam/test/system/config_files/fmgpa1.9c5dm
A      models/atm/cam/test/system/config_files/s32c5pdh
A      models/atm/cam/test/system/config_files/f10c5dm
A      models/atm/cam/test/system/config_files/s32c5dh
A      models/atm/cam/test/system/config_files/fm1.9c5m
A      models/atm/cam/test/system/config_files/fma1.9c5m
A      models/atm/cam/test/system/config_files/s8c5dm
A      models/atm/cam/test/system/config_files/e64c5m
A      models/atm/cam/test/system/config_files/e48c5m
A      models/atm/cam/test/system/config_files/scm64c5bfbiop
A      models/atm/cam/test/system/config_files/e64c5bfbiop
A      models/atm/cam/test/system/config_files/fmo1.9c5dh

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_bluefire
M      models/atm/cam/test/system/config_files/e48c4pdm
M      models/atm/cam/test/system/config_files/wm1.9c4m
M      models/atm/cam/test/system/config_files/f4c5dm
M      models/atm/cam/test/system/config_files/wm4c4h
M      models/atm/cam/test/system/config_files/f4c4pdh
M      models/atm/cam/test/system/tests_posttag_jaguar_cb
M      models/atm/cam/test/system/tests_posttag_jaguar
M      models/atm/cam/test/system/input_tests_master


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
045 bl373 TBL.sh fm1.9c5dh outfrq3s 9s ....................................FAIL! rc= 5 at Thu May 27 11:16:50 MDT 2010
060 bl379 TBL.sh wm1.9c4h outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 5 at Thu May 27 12:49:01 MDT 2010
063 bl731 TBL.sh h16x4c3dm aqua 9s ........................................FAIL! rc= 5 at Thu May 27 12:53:53 MDT 2010
- failures were due to the change in name of the respective configuration options file, where it was not recognized
  by the baseline scripts
	
edinburgh/lf95:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 5 at Wed May 26 11:18:09 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 5 at Wed May 26 11:30:34 MDT 2010
010 bl113 TBL.sh e8c5pdm aqpgro 3s ........................................FAIL! rc= 5 at Wed May 26 11:33:53 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 5 at Wed May 26 11:38:42 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 5 at Wed May 26 12:04:26 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 5 at Wed May 26 12:29:01 MDT 2010
031 bl313 TBL.sh f10c5pdm aqpgro 3s .......................................FAIL! rc= 5 at Wed May 26 12:32:56 MDT 2010
034 bl314 TBL.sh wg10c5dm outfrq3s 9s .....................................FAIL! rc= 5 at Wed May 26 12:54:55 MDT 2010
039 bl316 TBL.sh f10c5pdm aqpgro+aquaplanet_cam5 3s .......................FAIL! rc= 5 at Wed May 26 13:02:29 MDT 2010
- failures were due to the change in name of the respective configuration options file, where it was not recognized
  by the baseline scripts

edinburgh/pgi:
004 bl111 TBL.sh e8c5t5mdm ttrac 9s .......................................FAIL! rc= 5 at Wed May 26 11:07:28 MDT 2010
008 bl112 TBL.sh e8c5dm ghgrmp 9s .........................................FAIL! rc= 5 at Wed May 26 11:10:34 MDT 2010
010 bl113 TBL.sh e8c5pdm aqpgro 3s ........................................FAIL! rc= 5 at Wed May 26 11:12:41 MDT 2010
014 bl114 TBL.sh e8c5dm co2rmp 9s .........................................FAIL! rc= 5 at Wed May 26 11:14:03 MDT 2010
021 bl311 TBL.sh f10c5t5mdm ttrac 9s ......................................FAIL! rc= 5 at Wed May 26 11:21:38 MDT 2010
029 bl312 TBL.sh f10c5dm ghgrmp 9s ........................................FAIL! rc= 5 at Wed May 26 11:26:50 MDT 2010
031 bl313 TBL.sh f10c5pdm aqpgro 3s .......................................FAIL! rc= 5 at Wed May 26 11:29:08 MDT 2010
034 bl314 TBL.sh wg10c5dm outfrq3s 9s .....................................FAIL! rc= 5 at Wed May 26 11:32:59 MDT 2010
039 bl316 TBL.sh f10c5pdm aqpgro+aquaplanet_cam5 3s .......................FAIL! rc= 5 at Wed May 26 11:37:13 MDT 2010
- failures were due to the change in name of the respective configuration options file, where it was not recognized
  by the baseline scripts
	
CAM tag used for the baseline comparison tests if different than previous
tag:  

Summarize any changes to answers: b4b
	
===============================================================

Tag name: cam4_9_05
Originator(s): sungsu, aconley, hannay, eaton
Date: Wed May 26 09:24:56 MDT 2010
One-line Summary: "final" cam5 version

Purpose of changes:

. Mods to CAM5 physics package:
  - change to the initialization for the radius in prescribed_volcaero.F90 
  - correction to the lookup table in aer_rad_props.F90 
  - fixes in the wet scavenging of aerosols  
  - solubility factor = 0.4 instead of 0.6 
  - increase SOAG by 1.5
  - reduction in black & organic carbon number by a factor of 3

  This is expected to be the final version of the CAM5 physics for the
  CESM-1.0 release except for bug fixes and code cleanup.

Bugs fixed (include bugzilla ID): 

. bug fix in modal_aero_lw (makes refractive index vary with wavelength)

. bugfix in aerosol activation

. bugfix in wet deposition

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

- new emission datasets for soag and black carbon numbers (num_a1)

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
models/atm/cam/bld/namelist_files/use_cases/1850_cam5.xml
models/atm/cam/bld/namelist_files/use_cases/1850_cam5_super_fast_llnl.xml
models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
models/atm/cam/src/chemistry/bulk_aero/sulchem.F90
models/atm/cam/src/chemistry/bulk_aero/wetdep.F90
models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
models/atm/cam/src/physics/cam/aer_rad_props.F90
models/atm/cam/src/physics/cam/cldwat2m_micro.F90
models/atm/cam/src/physics/cam/cloud_fraction.F90
models/atm/cam/src/physics/cam/convect_deep.F90
models/atm/cam/src/physics/cam/convect_shallow.F90
models/atm/cam/src/physics/cam/eddy_diff.F90
models/atm/cam/src/physics/cam/modal_aer_opt.F90
models/atm/cam/src/physics/cam/ndrop.F90
models/atm/cam/src/physics/cam/stratiform.F90
models/atm/cam/src/physics/cam/tphysbc.F90
models/atm/cam/src/physics/cam/uwshcu.F90
models/atm/cam/src/physics/cam/vertical_diffusion.F90
models/atm/cam/src/physics/cam/zm_conv_intr.F90


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue May 25 15:23:22 MDT 2010
013 bl330 TBL.sh f4c5pdh aqpgro 3s ........................................FAIL! rc= 7 at Tue May 25 15:30:27 MDT 2010
021 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue May 25 15:49:40 MDT 2010
036 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Tue May 25 16:27:50 MDT 2010
040 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Tue May 25 16:47:45 MDT 2010
045 bl373 TBL.sh fm1.9dh outfrq3s 9s ......................................FAIL! rc= 7 at Tue May 25 17:23:04 MDT 2010
047 bl375 TBL.sh f1.9c5m outfrq24h+1850-2005_cam5 2d ......................FAIL! rc= 7 at Tue May 25 17:40:45 MDT 2010

edinburgh/lf95: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .........................................FAIL! rc= 7 at Tue May 25 15:08:15 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...........................................FAIL! rc= 7 at Tue May 25 15:31:59 MDT 2010
010 bl113 TBL.sh e8pdm aqpgro 3s ..........................................FAIL! rc= 7 at Tue May 25 15:38:27 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...........................................FAIL! rc= 7 at Tue May 25 15:44:34 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 7 at Tue May 25 16:24:29 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 7 at Tue May 25 17:02:39 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .........................................FAIL! rc= 7 at Tue May 25 17:10:39 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Tue May 25 17:47:25 MDT 2010
039 bl316 TBL.sh f10pdm aqpgro+aquaplanet_cam5 3s .........................FAIL! rc= 7 at Tue May 25 17:55:54 MDT 2010

edinburgh/pgi: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .........................................FAIL! rc= 7 at Tue May 25 14:44:21 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...........................................FAIL! rc= 7 at Tue May 25 14:49:54 MDT 2010
010 bl113 TBL.sh e8pdm aqpgro 3s ..........................................FAIL! rc= 7 at Tue May 25 14:54:09 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...........................................FAIL! rc= 7 at Tue May 25 14:55:46 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 7 at Tue May 25 15:05:59 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 7 at Tue May 25 15:13:48 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .........................................FAIL! rc= 7 at Tue May 25 15:18:22 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Tue May 25 15:25:17 MDT 2010
039 bl316 TBL.sh f10pdm aqpgro+aquaplanet_cam5 3s .........................FAIL! rc= 7 at Tue May 25 15:29:38 MDT 2010

All failures are baseline tests that are expected to fail due to changed
answers with cam5 physics.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: cam4 is BFB.  cam5 has new climate.

===============================================================
===============================================================

Tag name: cam4_9_04
Originator(s): jet,eaton,mvertens
Date: 5-20-2010
One-line Summary: Added aquaplanet as component model and make docn default for cam

Purpose of changes: aquaplanet is now a supported configuration.  It is no longer
	a namelist option but is now an -ocn aquaplanet option to the configure script.  
	The configure -ocn aquaplanet and build-namelist calls will produce a cam 
	executable that uses the default analytic sst pattern #1.  I also included two 
	new use cases that allow building namelists which have specific settings for the
	ape experiments (resetting of model constants, special boundary datasets, etc.)
	There is a use case for cam3/cam4 called aquaplanet_cam3_cam4 and one for cam5
	physics called aquaplanet_cam5.  The cam3/cam4 use-case turns off aerosol forcing
	and the cam5 use-case uses most of the cam5 default configuration which includes
	prognostic aerosols.

	DOCN is now the default ocn component for CAM.  DOM is still an option to configure.
	The DOCN model uses a slightly different interpolation algorithm and is roundoff 
	compared to DOM. 

	Cleaned up the use of shr_const in the model.  Replace most of the shr_const parameters
	with their physconst analogs.  This allows a consistent use and derivation of physical 
	constants for when running aquaplanet experiments.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
	
        DOCN is the new default ocn component
	DOM must now be specified via -ocn dom setting of configure
	aquaplanet is now an configure option -ocn aquaplanet

Describe any changes made to the namelist:
        =====================================================================
	Brought some additional resolution tuning parameters into the namelist
        =====================================================================

	   Cldwat
	      cldwat_icritc    !threshold for autoconversion of cold ice
              cldwat_icritw    !threshold for autoconversion of warm ice
              cldwat_conke     !tunable constant for evaporation of precip

           hkconv
	      hkconv_cmftau    !characteristic adjustment time scale
              hkconv_c0        !rain water autoconversion coefficient

           zmconv	 
              zmconv_ke        !Tunable evaporation efficiency
        =====================================================================
	Added docn parameters to namelist
        =====================================================================
	      restfilm         !Full pathname of docn restart file.
              ocn_in           !ocn type
              decomp           !1d

        =====================================================================
        Added namelist option to pick analytic sst pattern for aquaplanet
        =====================================================================
              aqua_planet_sst  !Set the sst to a particular analytic solution.

        =====================================================================
        Added 6 physical constants to namelist to support APE experiments
        =====================================================================

	      sday              ! sec in siderial day ~ sec
              rearth            ! radius of earth (m)
              gravit            ! gravitational acceleration (m/s**2)
              mwdry             ! molecular weight dry air
              mwh2o             ! molecular weight h2o
              cpwv              ! specific heat of water vapor (J/K/kg)

	   These values default to their shr_const values if not reset in the namelist
	
List any changes to the defaults for the boundary datasets:

	added new solar and ozone datasets for aquaplanet experiments.

Describe any substantial timing or memory changes:

Code reviewed by: jet eaton 

List all subroutines eliminated:

	Moved physconst to control
D      models/atm/cam/src/physics/cam/physconst.F90
	
        Replace shr_const values with physconst equivalents
D      models/atm/cam/src/dynamics/fv/dynconst.F90
D      models/atm/cam/src/dynamics/sld/dynconst.F90
D      models/atm/cam/src/dynamics/eul/dynconst.F90

List all subroutines added and what they do:
        New Use Cases for Aquaplanet
A      models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam5.xml
A      models/atm/cam/bld/namelist_files/use_cases/aquaplanet_cam3_cam4.xml

	Moved physconst from physics to control
A  +   models/atm/cam/src/control/physconst.F90

          Added new utils directory for aquaplanet support
A      models/atm/cam/src/utils/cam_aqua
A      models/atm/cam/src/utils/cam_aqua/ocn_types.F90
A      models/atm/cam/src/utils/cam_aqua/cpl_mct
A      models/atm/cam/src/utils/cam_aqua/cpl_mct/ocn_comp_mct.F90
A      models/atm/cam/src/utils/cam_aqua/cpl_esmf
A      models/atm/cam/src/utils/cam_aqua/ocn_comp.F90

List all existing files that have been modified, and describe the changes:

          Aquaplanet support
M      models/atm/cam/test/system/config_files/e48c4pdm
M      models/atm/cam/test/system/config_files/f10c3dm
M      models/atm/cam/test/system/config_files/s32pdh
M      models/atm/cam/test/system/config_files/f10pdm
M      models/atm/cam/test/system/config_files/f4c5pdh
M      models/atm/cam/test/system/config_files/e8pdm
M      models/atm/cam/test/system/config_files/e48adh
M      models/atm/cam/test/system/config_files/s8pdm
M      models/atm/cam/test/system/config_files/h16x4dm
M      models/atm/cam/test/system/config_files/e64pm
M      models/atm/cam/test/system/config_files/f4c4pdh

	  New diagnostic tests for aquaplanet use case
M      models/atm/cam/test/system/tests_posttag_edinburgh
M      models/atm/cam/test/system/tests_pretag_edinburgh

          Added support for docn branch
M      models/atm/cam/test/system/TBR.sh

          Aquaplanet/docn support
M      models/atm/cam/test/system/nl_files/aqua
M      models/atm/cam/test/system/nl_files/aqpgro
M      models/atm/cam/test/system/input_tests_master
M      models/atm/cam/bld/configure
M      models/atm/cam/bld/config_files/definition.xml

          Added new namelist parameters that control tuning parameters and docn component
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
M      models/atm/cam/src/physics/cam/cloud_fraction.F90
M      models/atm/cam/src/physics/cam/zm_conv.F90
M      models/atm/cam/src/physics/cam/cldwat.F90
M      models/atm/cam/src/physics/cam/hk_conv.F90
M      models/atm/cam/src/control/runtime_opts.F90

          Code cleanup
M      models/atm/cam/src/control/ncdio_atm.F90
M      models/atm/cam/src/utils/cam_csim4/cpl_mct/ice_comp_mct.F90
M      models/atm/cam/src/utils/cam_csim4/print_coverage.F90
M      models/atm/cam/src/utils/cam_dom/sst_data.F90
M      models/atm/cam/src/utils/cam_dom/cpl_mct/ocn_comp_mct.F90
M      models/atm/cam/src/utils/cam_dom/ocn_comp.F90
M      models/atm/cam/src/control/cam_history.F90

         updated to latest docn7/csm_share/drv components to allow support for docn and aquaplanet
M      SVN_EXTERNAL_DIRECTORIES

        shr_const parameters replaced with physconst equivalents
M      models/atm/cam/src/physics/cam/tropopause.F90
M      models/atm/cam/src/physics/cam/boundarydata.F90
M      models/atm/cam/src/physics/cam/phys_gmean.F90
M      models/atm/cam/src/physics/cam/ghg_data.F90
M      models/atm/cam/src/physics/cam/chem_surfvals.F90
M      models/atm/cam/src/physics/cam/pkg_cld_sediment.F90
M      models/atm/cam/src/physics/cam/co2_cycle.F90
M      models/atm/cam/src/physics/cam/tidal_diag.F90
M      models/atm/cam/src/physics/waccm/nlte_fomichev.F90
M      models/atm/cam/src/physics/waccm/gw_drag.F90
M      models/atm/cam/src/physics/waccm/gravity_waves_sources.F90
M      models/atm/cam/src/chemistry/utils/mo_constants.F90
M      models/atm/cam/src/chemistry/utils/solar_data.F90
M      models/atm/cam/src/chemistry/utils/tracer_data.F90
M      models/atm/cam/src/chemistry/utils/mo_msis_ubc.F90
M      models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M      models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
M      models/atm/cam/src/chemistry/mozart/chlorine_loading_data.F90
M      models/atm/cam/src/chemistry/mozart/mo_aero_settling.F90
M      models/atm/cam/src/chemistry/mozart/mo_airglow.F90
M      models/atm/cam/src/chemistry/mozart/mo_jlong.F90
M      models/atm/cam/src/chemistry/mozart/mo_lightning.F90
M      models/atm/cam/src/chemistry/mozart/lin_strat_chem.F90
M      models/atm/cam/src/chemistry/mozart/mo_jshort.F90
M      models/atm/cam/src/chemistry/mozart/mo_sulf.F90
M      models/atm/cam/src/chemistry/mozart/set_cp.F90
M      models/atm/cam/src/chemistry/mozart/mo_aurora.F90
M      models/atm/cam/src/chemistry/mozart/mo_apex.F90
M      models/atm/cam/src/chemistry/mozart/mo_snoe.F90
M      models/atm/cam/src/chemistry/mozart/mo_sphers.F90
M      models/atm/cam/src/chemistry/mozart/mo_sad.F90
M      models/atm/cam/src/chemistry/mozart/mo_setinv.F90
M      models/atm/cam/src/chemistry/mozart/chemistry.F90
M      models/atm/cam/src/chemistry/mozart/mo_drydep.F90
M      models/atm/cam/src/chemistry/mozart/iondrag.F90
M      models/atm/cam/src/chemistry/mozart/mo_photo.F90
M      models/atm/cam/src/chemistry/mozart/mo_sethet.F90
M      models/atm/cam/src/chemistry/mozart/efield.F90
M      models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M      models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M      models/atm/cam/src/chemistry/mozart/mo_jeuv.F90
M      models/atm/cam/src/chemistry/mozart/exbdrift.F90
M      models/atm/cam/src/chemistry/mozart/mo_solarproton.F90
M      models/atm/cam/src/chemistry/mozart/mo_synoz.F90
M      models/atm/cam/src/chemistry/mozart/mo_params.F90
M      models/atm/cam/src/dynamics/sld/dyn_grid.F90
M      models/atm/cam/src/dynamics/sld/linemsdyn.F90
M      models/atm/cam/src/dynamics/sld/initcom.F90
M      models/atm/cam/src/dynamics/sld/settau.F90
M      models/atm/cam/src/dynamics/sld/scanslt.F90
M      models/atm/cam/src/dynamics/sld/spetru.F90
M      models/atm/cam/src/dynamics/sld/dyn.F90
M      models/atm/cam/src/dynamics/sld/quad.F90
M      models/atm/cam/src/dynamics/sld/grcalc.F90
M      models/atm/cam/src/dynamics/eul/dyn_grid.F90
M      models/atm/cam/src/dynamics/eul/initcom.F90
M      models/atm/cam/src/dynamics/eul/scanslt.F90
M      models/atm/cam/src/dynamics/eul/inidat.F90
M      models/atm/cam/src/dynamics/eul/spetru.F90
M      models/atm/cam/src/dynamics/eul/iop.F90
M      models/atm/cam/src/dynamics/eul/dyn.F90
M      models/atm/cam/src/dynamics/eul/quad.F90
M      models/atm/cam/src/dynamics/eul/grcalc.F90
M      models/atm/cam/src/dynamics/homme/external/physical_constants.F90
M      models/atm/cam/src/dynamics/homme/dyn_grid.F90
M      models/atm/cam/src/dynamics/fv/dyn_grid.F90
M      models/atm/cam/src/dynamics/fv/initcom.F90
M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
M      models/atm/cam/src/dynamics/fv/inital.F90
M      models/atm/cam/src/dynamics/fv/restart_dynamics.F90


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

	Since docn gives roundoff differences to dom all the baseline tests 
	were expected to fail

	When the code was tested with dom all tests past as expected.

bluefire:
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7
054 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7
057 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7
060 bl389 TBL.sh wm1.9c4m outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7
068 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7

edinburgh/lf95:
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7


edinburgh/pgi:
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7
039 bl316 TBL.sh f10pdm aqpgro+aquaplanet_cam5 3s .........................SKIPPED*

        bl316 is a new test for the aquaplanet5 use case and didn't exist in the base line.
	

CAM tag used for the baseline comparison tests if different than previous
tag:cam4_9_03

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

	roundoff changes.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

	tested docn sstfield against original dom sst.  Some values were different in the last bit.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
Tag name: cam4_9_03
Originator(s): mvr, eaton, jet
Date: 14 May 2010
One-line Summary: made prescribed aerosol mode the default; mod to cam.cpl7.template to read users CCSM namelist 
from CASEROOT/user_nl_cam; scam bugfix; back out workaround for esmf bug; new jan1 ncdata for 0.23x0.31 

Purpose of changes:
- the user namelist was previously read from $CASEROOT/SourceMods/src.cam/user_nl
- reverting back to the cam4_1_14 version of time_manager.F90 to undo workaround for esmf bug
- cam's handling of prescribed aerosols and their depositions will allow surface models to remove this functionality 
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
	
Describe any changes made to the namelist:
- added settings for aerosol deposition
	
List any changes to the defaults for the boundary datasets:
- new jan1 ncdata file for 0.23x0.31
	
Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4.xml
M      models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp26.xml
M      models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp45.xml
M      models/atm/cam/bld/namelist_files/use_cases/2005_cam4.xml
M      models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
M      models/atm/cam/bld/namelist_files/use_cases/2000_cam4_super_fast_llnl.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_cam4.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
M      models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85v2.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1974-2005_cam4.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_cam4_2xco2.xml
M      models/atm/cam/src/physics/cam/phys_control.F90
- mods need to make prescribed aerosols the default
	
M      models/atm/cam/bld/cam.cpl7.template
- new reading user namelist from $CASEROOT/user_nl_cam

M      models/atm/cam/src/utils/time_manager.F90
- back out workaround for esmf bug
	
M      models/atm/cam/src/utils/cam_dom/sst_data.F90
- scam bug fix
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Fri May 14 07:05:21 MDT 2010
017 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Fri May 14 07:05:29 MDT 2010
033 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Fri May 14 07:05:55 MDT 2010
050 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Fri May 14 07:06:10 MDT 2010
054 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Fri May 14 07:06:17 MDT 2010
057 bl388 TBL.sh f1.9c4m outfrq24h+1850_cam4 2d ...........................FAIL! rc= 7 at Fri May 14 07:06:23 MDT 2010
060 bl389 TBL.sh wm1.9c4m outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 7 at Fri May 14 07:07:48 MDT 2010
068 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Fri May 14 07:07:54 MDT 2010
- any baseline test where prescribed aerosols were used were expected to fail
	
edinburgh/lf95:
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Thu May 13 17:31:21 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7 at Thu May 13 17:33:41 MDT 2010
- any baseline test where prescribed aerosols were used were expected to fail

edinburgh/pgi:
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Thu May 13 16:15:27 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7 at Thu May 13 16:15:27 MDT 2010
- any baseline test where prescribed aerosols were used were expected to fail
	
CAM tag used for the baseline comparison tests if different than previous
tag:  

Summarize any changes to answers: runs using prescribed aerosols are different by larger than roundoff but presumably 
	same climate - we are relying on dbaily and dlawrence signing off on validation runs with this change
	
===============================================================
Tag name: cam4_9_02
Originator(s): mvr, eaton, mirin
Date: 05 May 2010
One-line Summary: enhanced testing of cam4 configurations; updated externals of 
surface components to match those of ccsm4_0_beta52; cleaned up test scripts to 
reflect decommissioning of calgary; addition of fields to master field list; 
fix of potential bug in fv dycore

Purpose of changes:
-the cgd linux cluster, calgary was decommissioned on 5/5/10...this was a primary 
 test platform for cam - testing will now take place on its replacement, edinburgh 

-master field list needed some additional fields being requested for the "moar" 
 production runs
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
	
Describe any changes made to the namelist:
	
List any changes to the defaults for the boundary datasets:
- fsurdat settings updated for T85 and 0.23x0.31
- fpftdyn and faerdep settings added for rcp=4.5,2.6
	
Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/config_files/fmo2dh
- removed obsolete test file
	
D      models/atm/cam/test/system/config_files/scm64bfbiop_35
D      models/atm/cam/test/system/config_files/e64bfbiop_35
- test files renamed (cam3_5 -> cam4)
	
D      models/atm/cam/test/system/tests_posttag_calgary
D      models/atm/cam/test/system/tests_pretag_calgary
- test files renamed to reflect decommissioning of calgary 
	

List all subroutines added and what they do:
A  +   models/atm/cam/test/system/tests_posttag_edinburgh
A  +   models/atm/cam/test/system/tests_pretag_edinburgh
- files containing test lists renamed to reflect decommissioning of calgary

A      models/atm/cam/test/system/config_files/wm1.9c4m
A      models/atm/cam/test/system/config_files/f0.9c4m
A      models/atm/cam/test/system/config_files/fm1.9dh
A      models/atm/cam/test/system/nl_files/outfrq1m
- new test files for enhanced testing of cam4 configurations, trop_mozart chemistry
	
A      models/atm/cam/test/system/config_files/scm64bfbiop_4
A      models/atm/cam/test/system/config_files/e64bfbiop_4
- test files renamed (cam3_5 -> cam4)
	

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/input_tests_master
M      models/atm/cam/test/system/tests_pretag_bluefire
M      models/atm/cam/test/system/tests_posttag_jaguar_cb
M      models/atm/cam/test/system/tests_posttag_jaguar
M      models/atm/cam/test/system/tests_posttag_bluefire
- additional tests for cam4 physics, trop_mozart chemistry

M      models/atm/cam/test/system/TCB.sh
- fixed the error trapping for calls to generate_cice_decomp.pl 
	
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/CAM_runcmnd.sh
- stripped out settings in test scripts for calgary
	
M      models/atm/cam/bld/configure
- default number of vertical levels is now set to 26 only for non-waccm chemistry runs 
  using cam3 or cam4 physics

M      models/atm/cam/bld/run-cray.csh
- run template script for xt machines will now use default version of compilers

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- update to default inputdata files to coincide with updated clm tag
	
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
- added temporary clim_pi SST datasets to this use_case
	
M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
. add T200, T500, Z100, Z200 to master fieldlist
. add interpolation and outfld calls for new fields
. add hist_fld_active conditionals to avoid diagnostic calculations and/or
  interpolations for fields that don't appear in any history file.
. remove duplicate routine polysvp

M      models/atm/cam/src/dynamics/fv/dp_coupling.F90
. add some omp directives

M      models/atm/cam/src/dynamics/fv/cd_core.F90
. fix dimension in work array (This is fixing a potential bug, not a
  currently occurring bug.)

M      models/atm/cam/src/dynamics/fv/sw_core.F90
. put declaration for u2, v2 inside ifdef FILTER_MASS_FLUXES conditional
  (this option isn't being enabled in cam.  This fix is just saving memory
  by not declaring unused arrays)

M      SVN_EXTERNAL_DIRECTORIES
 M     .
- updated externals to match settings for ccsm4_0_beta52 (drv, clm, cice, docn, csm_share, scripts)
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
009 bl134 TBL.sh e48adh adia 9s ...........................................FAIL! rc= 7 at Tue May  4 17:57:40 MDT 2010
024 bl334 TBL.sh f4adh fv2d_8tsk 9s .......................................FAIL! rc= 7 at Tue May  4 18:37:16 MDT 2010
028 bl335 TBL.sh f4idm idphys 9s ..........................................FAIL! rc= 7 at Tue May  4 18:39:03 MDT 2010
043 bl373 TBL.sh fm1.9dh outfrq3s 9s ......................................FAIL! rc= 5 at Tue May  4 19:41:52 MDT 2010
058 bl389 TBL.sh wm1.9c4m outfrq24h+waccm_1850_cam4 2d ....................FAIL! rc= 5 at Tue May  4 21:12:43 MDT 2010
002 bl330 TBL.sh f4c5pdh aqpgro 3s ........................................FAIL! rc= 5 at Wed May  5 11:13:44 MDT 2010
- adiabatic and ideal physics baseline tests failed because they're now running at 30-levels which require 
  a different initial file
- bl373, bl389 and bl330 failed because they introduce a new test configuration that was not recognized by the baseline code
	
edinburgh/lf95:
017 bl115 TBL.sh e8idm idphys 9s ..........................................FAIL! rc= 7 at Tue May  4 17:32:52 MDT 2010
- ideal physics baseline test failed because it's now running at 30-levels which requires a different initial file

edinburgh/pgi:
017 bl115 TBL.sh e8idm idphys 9s ..........................................FAIL! rc= 7 at Tue May  4 16:58:15 MDT 2010
- ideal physics baseline test failed because it's now running at 30-levels which requires a different initial file

	
CAM tag used for the baseline comparison tests if different than previous
tag:  bl351, bl352, bl385, bl386, bl388, bl389 were run against cam4_9_00 to ensure nothing changed 
      answers for these configurations with previous tag

Summarize any changes to answers: b4b except for adiabatic and ideal physics configurations which now run at 30 levels
	
===============================================================
===============================================================

Tag name: cam4_9_01
Originator(s): Francis Vitt
Date: 3 May 2010
One-line Summary: Updates to the 1850-2005_cam4_super_fast_llnl build-namelist use case 
 and radiation output bug fixes.

Purpose of changes:

  Changes to the 1850-2005_cam4_super_fast_llnl use case are needed for the
  track1 with super_fast_llnl chemistry 20th century transient simulation.
  
  Fix bugs:
   - the SWCF radiation diagnostic needs to be in the dosw if block
   - output of undefined fields when MG microphysics is not used

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

U    models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
 - mods for the 20th century transient simulation with super_fast_llnl chemistry
   . use 1-degree emission data sets
   . changed to be consistent with the 1850-2005_cam4 use case
   . fincl1 output fields list was adjusted

U    models/atm/cam/src/physics/cam/radiation.F90
 - move the outfld call for SWCF diagnostic to the dosw if block

U    models/atm/cam/src/physics/cam/radiation_data.F90
 - modified to not output physics buffer fields which are not defined when 
   'MG' is not used

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except 
045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Mon May  3 13:02:43 MDT 2010
 - this is expected to fail due to changes in the 1850-2005_cam4_super_fast_llnl use case

edinburgh/lf95: all PASS

edinburgh/pgi: all PASS 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam4_9_00
Originator(s): mvr, sungsu, hannay, eaton, others
Date: 29 Apr 2010
One-line Summary: updated the physics with code from the cam5 development branch; 
some changes to the dynamics, including the enabling of fourth-order divergence damping

Purpose of changes:

Devlopment of the cam5 physics has been occuring on a code branch for some 
time.  The merge of that code base with that of the cam trunk is now complete, 
including backwards compatibility with cam4 and cam3 physics.  For more details 
on the changes, see the ChangeLog file for the branch camdev_cam3_6_23.

There were some changes to the dynamics included with this merge including:
- Switch to enable fourth-order divergence damping except at the model top layers where regular 
  second-order (Laplacian) damping is applied (damps both divergence and vorticity).
- FV no longer writes/reads "DELP" to/from IC file.
- Added another nested loop to the FV dynamical core.  allow multiple vertical 
  remappings within a physics time-step.  added new namelist variable:  NSPLTVRM (for 
  split vertical remapping) as an addtion to the NSPLIT and NSPLTRAC dynamics  
  splitting namelist variables.  Default is 1.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
- changes in support of new cam5 physics (addition of flag to specify pbl scheme, etc)
	
Describe any changes made to the namelist:
- changes in support of new cam5 physics (settings for turbulent mountain stress, 
  convective water in radiation, condensate-to-rain autoconversion coefficients, etc)
	
List any changes to the defaults for the boundary datasets:
- files now specified for running with 30 vertical levels
	
Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated: none
D      models/atm/cam/src/physics/cam/cldwat2m.F90
- file split into two, one for microphysics and one for macrophysics
	
List all subroutines added and what they do:
A  +   models/atm/cam/bld/namelist_files/use_cases/1850_cam5_super_fast_llnl.xml
- new use_case using cam5 physics

A  +   models/atm/cam/src/physics/cam/cldwat2m_macro.F90
A  +   models/atm/cam/src/physics/cam/cldwat2m_micro.F90
- new physics files created from cldwat2m.F90

A  +   models/atm/cam/src/physics/cam/uwshcu.F90
- new physics for university of wash shallow convection scheme
	
List all existing files that have been modified, and describe the changes:

 M     models/atm/cam
- externals property updated to reflect changes in SVN_EXTERNAL_DIRECTORIES from cam4_1_08

M  +   models/atm/cam/test/system/nl_files/off1.9x2.5
- update of test file to use input file with 30 vertical levels

M      models/atm/cam/test/system/nl_files/scm_b4b_o1
M      models/atm/cam/test/system/nl_files/scm_prep
- update of scam tests to ensure 3d model and scam runs use identical inputs

M      models/atm/cam/test/system/CAM_runcmnd.sh
- just a change in white space 

M      models/atm/cam/bld/configure
M      models/atm/cam/bld/config_files/definition.xml
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/fv_control_mod.F90
M      models/atm/cam/src/control/cam_comp.F90
M      models/atm/cam/src/physics/cam/molec_diff.F90
M      models/atm/cam/src/physics/cam/param_cldoptics.F90
M      models/atm/cam/src/physics/cam/trb_mtn_stress.F90
M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/cam/tphysbc.F90
M      models/atm/cam/src/physics/cam/aer_rad_props.F90
M      models/atm/cam/src/physics/cam/phys_prop.F90
M      models/atm/cam/src/physics/cam/phys_control.F90
M      models/atm/cam/src/physics/cam/check_energy.F90
M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
M      models/atm/cam/src/physics/cam/stratiform.F90
M      models/atm/cam/src/physics/cam/constituents.F90
M      models/atm/cam/src/physics/cam/modal_aer_opt.F90
M      models/atm/cam/src/physics/cam/physics_types.F90
M      models/atm/cam/src/physics/cam/diffusion_solver.F90
M      models/atm/cam/src/physics/cam/ndrop.F90
M      models/atm/cam/src/physics/cam/physpkg.F90
M      models/atm/cam/src/physics/cam/rad_constituents.F90
M      models/atm/cam/src/physics/cam/convect_shallow.F90
M      models/atm/cam/src/physics/cam/cloud_fraction.F90
M      models/atm/cam/src/physics/cam/convect_deep.F90
M      models/atm/cam/src/physics/cam/wv_saturation.F90
M      models/atm/cam/src/physics/cam/gw_drag.F90
M      models/atm/cam/src/physics/cam/phys_buffer.F90
M      models/atm/cam/src/physics/cam/zm_conv_intr.F90
M      models/atm/cam/src/physics/cam/tphysac.F90
M      models/atm/cam/src/physics/cam/zm_conv.F90
M      models/atm/cam/src/physics/cam/eddy_diff.F90
M      models/atm/cam/src/physics/cam/cldwat.F90
M      models/atm/cam/src/physics/cam/vertical_diffusion.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90
M      models/atm/cam/src/physics/rrtmg/cloud_diagnostics.F90
M      models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
- changes in support of new cam5 physics 
	
M      models/atm/cam/src/dynamics/sld/spegrd.F90
M      models/atm/cam/src/dynamics/sld/linemsdyn.F90
M      models/atm/cam/src/dynamics/sld/scanslt.F90
M      models/atm/cam/src/dynamics/sld/dyn_comp.F90
M      models/atm/cam/src/dynamics/sld/grmult.F90
M      models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
M      models/atm/cam/src/dynamics/eul/lagyin.F90
M      models/atm/cam/src/dynamics/eul/sphdep.F90
M      models/atm/cam/src/dynamics/eul/dyn_comp.F90
M      models/atm/cam/src/dynamics/eul/cubydr.F90
M      models/atm/cam/src/dynamics/fv/initcom.F90
M      models/atm/cam/src/dynamics/fv/dp_coupling.F90
M      models/atm/cam/src/dynamics/fv/inidat.F90
M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
M      models/atm/cam/src/dynamics/fv/inital.F90
M      models/atm/cam/src/dynamics/fv/cd_core.F90
M      models/atm/cam/src/dynamics/fv/sw_core.F90
M      models/atm/cam/src/dynamics/fv/dynamics_vars.F90
M      models/atm/cam/src/dynamics/fv/diag_dynvar_ic.F90
M      models/atm/cam/src/dynamics/fv/uv3s_update.F90
M      models/atm/cam/src/dynamics/fv/te_map.F90
M      models/atm/cam/src/dynamics/fv/stepon.F90
M      models/atm/cam/src/dynamics/fv/restart_dynamics.F90
- changes made in support of dynamics changes (see above)
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Tue Apr 27 21:40:53 MDT 2010
019 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Tue Apr 27 22:00:13 MDT 2010
034 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Tue Apr 27 22:37:02 MDT 2010
038 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Tue Apr 27 22:56:00 MDT 2010
042 bl375 TBL.sh f1.9c5m outfrq24h+1850-2005_cam5 2d ......................FAIL! rc= 7 at Tue Apr 27 23:20:40 MDT 2010
045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Tue Apr 27 23:40:52 MDT 2010
049 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Tue Apr 27 23:57:19 MDT 2010
057 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Wed Apr 28 00:34:35 MDT 2010
- any baseline test using cam5 physics was expected to fail (bl137, bl332, bl337, bl371, bl375)
- bl374, bl387, and bl992 failed due to the fact that delta pressure (delp) is no longer being read from the 
  initial conditions file

**additional tests using cam4 physics
2deg 1850 and 1850-2005 
1deg 1850 and 1850-2005
2deg waccm 1850 and 1850-2005
- 2-month tests vs baseline were b4b, when accounting for the fact that delta pressure (delp) is no longer being 
  read from the initial conditions file
	
edinburgh/lf95:
004 bl111 TBL.sh e8t5mdm ttrac 9s .........................................FAIL! rc= 7 at Tue Apr 27 21:45:29 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...........................................FAIL! rc= 7 at Tue Apr 27 21:56:21 MDT 2010
010 bl113 TBL.sh e8pdm aqpgro 3s ..........................................FAIL! rc= 7 at Tue Apr 27 22:04:06 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...........................................FAIL! rc= 7 at Tue Apr 27 22:10:06 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 7 at Tue Apr 27 22:36:18 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 7 at Tue Apr 27 23:00:53 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .........................................FAIL! rc= 7 at Tue Apr 27 23:09:37 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Tue Apr 27 23:34:04 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7 at Tue Apr 27 23:39:46 MDT 2010
- any baseline test using cam5 physics was expected to fail (bl111, bl112, bl113, bl114, bl311, bl312, bl313, bl314)
- bl315 failed due to 1) round-off differences introduced in calculation of 
  condensate-to-rain autoconversion coefficient (c0) and 2) the fact that delta pressure (delp) 
  is no longer being read from the initial conditions file

edinburgh/pgi:
004 bl111 TBL.sh e8t5mdm ttrac 9s .........................................FAIL! rc= 7 at Tue Apr 27 17:08:20 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...........................................FAIL! rc= 7 at Tue Apr 27 17:13:58 MDT 2010
010 bl113 TBL.sh e8pdm aqpgro 3s ..........................................FAIL! rc= 7 at Tue Apr 27 17:18:45 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...........................................FAIL! rc= 7 at Tue Apr 27 17:20:24 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 7 at Tue Apr 27 17:30:19 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 7 at Tue Apr 27 17:38:10 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .........................................FAIL! rc= 7 at Tue Apr 27 17:42:53 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Tue Apr 27 17:49:13 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7 at Tue Apr 27 17:53:02 MDT 2010
- any baseline test using cam5 physics was expected to fail (bl111, bl112, bl113, bl114, bl311, bl312, bl313, bl314)
- bl315 failed due to 1) round-off differences introduced in calculation of 
  condensate-to-rain autoconversion coefficient (c0) and 2) the fact that delta pressure (delp) 
  is no longer being read from the initial conditions file

jaguar:
004 bl157 TBL.sh e64m ghgrmp 9s ...........................................FAIL! rc= 7 at Wed Apr 28 11:15:15 EDT 2010
006 bl158 TBL.sh e64pm aqpgro 3s ..........................................FAIL! rc= 7 at Wed Apr 28 11:15:17 EDT 2010
009 bl159 TBL.sh e64am adia 9s ............................................FAIL! rc= 7 at Wed Apr 28 11:15:21 EDT 2010
012 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Apr 28 11:15:29 EDT 2010
015 bl372 TBL.sh f1.9m fvvp_lb2 9s ........................................FAIL! rc= 7 at Wed Apr 28 11:15:56 EDT 2010
018 sm375 TSM.sh f1.9c5m outfrq24h+1850-2005_cam5 2d ......................FAIL! rc= 8 at Tue Apr 27 22:47:39 EDT 2010
019 er375 TER.sh f1.9c5m outfrq24h+1850-2005_cam5 1+1d ....................FAIL! rc= 5 at Tue Apr 27 22:47:39 EDT 2010
020 bl375 TBL.sh f1.9c5m outfrq24h+1850-2005_cam5 2d ......................FAIL! rc= 4 at Wed Apr 28 11:16:57 EDT 2010
023 bl378 TBL.sh fm1.9m outfrq3s 9s .......................................FAIL! rc= 7 at Wed Apr 28 11:17:33 EDT 2010
024 sm379 TSM.sh wm1.9m outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 8 at Tue Apr 27 22:54:29 EDT 2010
025 er379 TER.sh wm1.9m outfrq3s+waccm_1850_cam4 4+5s .....................FAIL! rc= 5 at Tue Apr 27 22:54:29 EDT 2010
026 bl379 TBL.sh wm1.9m outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 4 at Wed Apr 28 11:17:49 EDT 2010
030 bl383 TBL.sh fma1.9m outfrq3s+1850_cam4_trop_bam 9s ...................FAIL! rc= 7 at Wed Apr 28 11:18:13 EDT 2010
031 sm384 TSM.sh fmgpa1.9dm outfrq3s+1850_cam4 9s .........................FAIL! rc= 8 at Tue Apr 27 23:00:19 EDT 2010
032 er384 TER.sh fmgpa1.9dm outfrq3s+1850_cam4 4+5s .......................FAIL! rc= 5 at Tue Apr 27 23:00:20 EDT 2010
033 br384 TBR.sh fmgpa1.9dm outfrq3s+1850_cam4 6+3s .......................FAIL! rc= 5 at Tue Apr 27 23:00:31 EDT 2010
034 bl384 TBL.sh fmgpa1.9dm outfrq3s+1850_cam4 9s .........................FAIL! rc= 4 at Wed Apr 28 11:18:28 EDT 2010
037 bl386 TBL.sh f1.9c4m outfrq24h+1850_cam4 2m ...........................FAIL! rc= 7 at Wed Apr 28 11:22:08 EDT 2010
- '375' '379' and '384' test failures are pre-existing
- any baseline test using cam5 physics was expected to fail (bl157, bl158, bl137, bl372, bl378, bl383)
- bl159 failed due to change in default cam initial conditions file being used
- bl386 failed due to either 1) round-off differences introduced in calculation of 
  condensate-to-rain autoconversion coefficient (c0) or 2) the fact that delta pressure (delp) 
  is no longer being read from the initial conditions file, or both (this was not investigated)
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers:
cam5:  answers change due to new climate 
cam4:  the change to no longer read delp from the initial file may produce answers beyond round-off; the change 
       to the setting of the condensate-to-rain autoconversion coefficient (c0) from a scalar to a computation 
       introduces a round-off level difference on some compilers (for example, edinburgh w/pgi and w/lahey)
	
If bitwise differences were observed, how did you show they were no worse
than roundoff?
- cam5 answere are b4b with end of the development branch - see the ChangeLog file for branch camdev_cam3_6_23 for 
  validation details
	
If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- see the ChangeLog file for branch camdev_cam3_6_23 for validation details


===============================================================
===============================================================

Tag name: cam4_1_15
Originator(s): Francis Vitt
Date: 26 Apr 2010
One-line Summary: WACCM and CAM-Chem changes

Purpose of changes:

 - correction to WACCM Fomichev code for time-dependent surface co2
 - bug fixes for dry deposition calculations over ocean and ice when CLM dry deposition is used
 - give user the ability to turn on/off aerosol deposition fluxes to surface components

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D    models/atm/cam/src/chemistry/utils/ocnice_aero.F90
  caused errors in dry dep over ocean and ice

List all subroutines added and what they do:

A    models/atm/cam/bld/namelist_files/use_cases/2000_cam4_super_fast_llnl.xml
  new use case added

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/bld/configure
  impose cam5 physics restriction on all MAM chemistry packages

M    models/atm/cam/bld/build-namelist
  - remove the ISOP emis from super_fast_llnl namelist when CLM MEGAN is used
  - include trop_mam7 in with the 'atm_dep_flux' default namelist setting
  - get default prescribed_aero settings unless prescribed_aero_file is specified
  - set co2vmr for waccm unless scenario_ghg is 'RAMPED'
  - set srf_emis_type='CYCLICAL' and srf_emis_ymd=19970101 unless srf_emis_type is specified

M    models/atm/cam/bld/namelist_files/namelist_definition.xml
  - corrected spelling of 'category' 

M    models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
  - cldfrc_rhminl set to 0.90
  - specify scenario_ghg='RAMPED' and bndtvghg input file
  - use IC file from 1850 control simulation
  - use new solar_parms file which spans period from 1845-2008
  - added TROPP_FD diagnostic to h0 history 

M    models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
  - use correct solar data input file
  - cldfrc_rhminl set to 0.9225
  - added 1-degree volc vert emis files
  - history fields added to fincl1

M    models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
  - cldfrc_rhminl set to 0.90
  - strat_aero_feedback=.true. added for volcanoes

M    models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
  - cleanup -- rearrange

M    models/atm/cam/src/control/camsrfexch_types.F90
  - initializing aero dep fluxes to shr_const_spval seems to have no effect -- this is removed

M    models/atm/cam/src/utils/time_manager.F90
  - work around for ESMF lib problem when time is negative

M    models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M    models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
  - set driver atm_aero flag to atm_dep_flux cam namelist

M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M    models/atm/cam/src/chemistry/mozart/mo_chemini.F90
M    models/atm/cam/src/chemistry/mozart/mo_drydep.F90
  - corrections to dry dep over non-land regions

M    models/atm/cam/src/physics/waccm/nlte_lw.F90
M    models/atm/cam/src/physics/waccm/nlte_fomichev.F90
  - set matrice amat and bmat every timestep since co2vmr at the surface can be time-dependent

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except
031 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Mon Apr 26 14:57:40 MDT 2010
045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Mon Apr 26 16:10:41 MDT 2010
 - these are expected failures due to changes in the waccm_1850_cam4 and 1850-2005_cam4_super_fast_llnl use cases

edinburgh/lf95: all PASS

edinburgh/pgi: all PASS 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam4_1_14
Originator(s): mvr
Date: Wed Apr 21 2010
One-line Summary: updated externals of surface components to 
those of ccsm4_0_beta48

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:
- update CLM datasets to be consistent with the clm3_7_10 tag
	
Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none
	
List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- update CLM datasets to be consistent with the clm3_7_10 tag
M      SVN_EXTERNAL_DIRECTORIES
 M     .
- updated external definitions
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 7 at Wed Apr 21 10:01:48 MDT 2010
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 7 at Wed Apr 21 10:11:11 MDT 2010
015 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s ...............................FAIL! rc= 7 at Wed Apr 21 10:15:58 MDT 2010
019 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 7 at Wed Apr 21 10:24:06 MDT 2010
031 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s .......................FAIL! rc= 7 at Wed Apr 21 10:38:12 MDT 2010
034 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ......................................FAIL! rc= 7 at Wed Apr 21 10:45:25 MDT 2010
038 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .....................................FAIL! rc= 7 at Wed Apr 21 10:57:47 MDT 2010
042 bl375 TBL.sh f1.9c5m outfrq24h+1850-2005_cam5 2d ......................FAIL! rc= 7 at Wed Apr 21 11:13:11 MDT 2010
045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Wed Apr 21 11:13:21 MDT 2010
049 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 7 at Wed Apr 21 11:13:31 MDT 2010
057 bl992 TBL_ccsm.sh f19_g16 E 2d ........................................FAIL! rc= 7 at Wed Apr 21 11:13:38 MDT 2010
- baselines (other than aquaplanet, ideal physics, adiabatic) were expected to fail due to change in clm and cice
	
edinburgh/lf95: all PASS except
004 bl111 TBL.sh e8t5mdm ttrac 9s .........................................FAIL! rc= 7 at Tue Apr 20 16:45:42 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...........................................FAIL! rc= 7 at Tue Apr 20 16:45:43 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...........................................FAIL! rc= 7 at Tue Apr 20 16:45:46 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 7 at Tue Apr 20 16:45:47 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 7 at Tue Apr 20 16:45:48 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Tue Apr 20 17:11:02 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7 at Tue Apr 20 17:16:49 MDT 2010
- baselines (other than aquaplanet, ideal physics, adiabatic) were expected to fail due to change in clm and cice
	
edinburgh/pgi: all PASS except
004 bl111 TBL.sh e8t5mdm ttrac 9s .........................................FAIL! rc= 7 at Tue Apr 20 13:02:10 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...........................................FAIL! rc= 7 at Tue Apr 20 13:08:08 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...........................................FAIL! rc= 7 at Tue Apr 20 13:15:38 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 7 at Tue Apr 20 13:29:08 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 7 at Tue Apr 20 13:37:28 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 7 at Tue Apr 20 13:49:42 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 7 at Tue Apr 20 13:53:19 MDT 2010
- baselines (other than aquaplanet, ideal physics, adiabatic) were expected to fail due to change in clm and cice

CAM tag used for the baseline comparison tests if different than previous
tag: 

Summarize any changes to answers: larger than roundoff but same climate - see clm ChangeLog for details

	
===============================================================
Tag name: cam4_1_13
Originator(s): mvr
Date: Tue Apr 20 2010
One-line Summary: corrected solar input file for use_cases with super_fast chem; 
fix for pio bug introduced with previous tag; enhancement/cleanup of test scripts;
updated run template scripts and added one for cray xt's

test scripts/files were modified to:
- enhance testing of eul dycore at T31
- explicitly test cam5 physics rather than relying on default
- explicitly test cam4 physics (replacing cam3_5_1)
- add mpi-only tests to bluefire
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none
- new solar input files for super_fast chemistry
	
Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 
D      models/atm/cam/test/system/config_files/e32c4pdm
D      models/atm/cam/test/system/config_files/f4idh
D      models/atm/cam/test/system/config_files/e64h
D      models/atm/cam/test/system/config_files/e32adh
D      models/atm/cam/test/system/config_files/e32idh
D      models/atm/cam/test/system/config_files/f4dh
D      models/atm/cam/test/system/config_files/f1.9c4dh
D      models/atm/cam/test/system/config_files/f1.9c351h
D      models/atm/cam/test/system/config_files/f1.9c351m
D      models/atm/cam/test/system/config_files/e32c4dh
D      models/atm/cam/test/system/tests_posttag_lightning
- removed test files that were no longer being used
	
List all subroutines added and what they do: 
A      models/atm/cam/test/system/config_files/e48c4pdm
A      models/atm/cam/test/system/config_files/e48c4dh
A      models/atm/cam/test/system/config_files/f4idm
A      models/atm/cam/test/system/config_files/e48m
A      models/atm/cam/test/system/config_files/f4c5dm
A      models/atm/cam/test/system/config_files/s48dh
A      models/atm/cam/test/system/config_files/f4dm
A      models/atm/cam/test/system/config_files/s48adh
A      models/atm/cam/test/system/config_files/s48idh
A      models/atm/cam/test/system/config_files/f1.9c4h
A      models/atm/cam/test/system/config_files/f1.9c4m
A      models/atm/cam/test/system/config_files/f1.9c4dm
A      models/atm/cam/test/system/config_files/e48c5h
A      models/atm/cam/test/system/config_files/e48adh
A      models/atm/cam/test/system/config_files/f1.9c5m
A      models/atm/cam/test/system/config_files/e48idh
A      models/atm/cam/test/system/config_files/s48pdh
- new files to be used by test scripts

A      models/atm/cam/test/system/CAM_decomp.sh
- new test utility to build fv 2d decomp string if required for test (needed to 
  enable broader testing of mpi-only configurations)

A      models/atm/cam/bld/run-cray.csh
- new run template script for cray platforms

A      models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam5.xml
A      models/atm/cam/bld/namelist_files/use_cases/1850_cam5.xml
- new use_cases brought over from cam5 branch to enable testing
	

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_bluefire
M      models/atm/cam/test/system/tests_posttag_jaguar_cb
M      models/atm/cam/test/system/tests_posttag_jaguar
M      models/atm/cam/test/system/tests_posttag_calgary
M      models/atm/cam/test/system/tests_pretag_calgary
- modified to reflect changes in test names
	
M      models/atm/cam/test/system/TCB.sh
- hardwired cice_maxblocks=4 to enable testing a wide variety of configurations 
  while limiting the number of model builds
	
M      models/atm/cam/test/system/config_files/wm4c4h
M      models/atm/cam/test/system/config_files/wm4dh
M      models/atm/cam/test/system/config_files/wm1.9m
M      models/atm/cam/test/system/config_files/wg10dm
- explicitly set dycore to fv - was relying on the default

M      models/atm/cam/test/system/TSM.sh
M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TER.sh
- now calls CAM_decomp.sh to build fv 2d decomp string for namelist if needed

M      models/atm/cam/test/system/TPF.sh
- change to how test results are written to log file

M      models/atm/cam/test/system/test_driver.sh
- edinburgh now tests on 8tsks; jaguar now tests on 64 processors and default version of
  pgi compilers; modified format of test results

M      models/atm/cam/test/system/input_tests_master
- modified with new test definitions  
	
M      models/atm/cam/test/system/CAM_runcmnd.sh
- improved how hybrid runs are set up for testing; improved the changing of tasks/threads
  on restart tests
	
M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-ibm.csh
- updated run template scripts to work with recent changes to model
	
MM     models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
- fix for use_cases using super_fast chemistry to use correct solar input file

M      models/atm/cam/src/utils/cam_dom/sst_data.F90
- fix for pio bug introduced with previous tag
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except
004 bl132 TBL.sh e48c4dh ghgrmp+1850_cam4 9s ..............................FAIL! rc= 5 at Tue Apr 20 09:01:21 MDT 2010
006 bl133 TBL.sh e48c4pdm aqpgro 3s .......................................FAIL! rc= 5 at Tue Apr 20 09:01:21 MDT 2010
009 bl134 TBL.sh e48adh adia 9s ...........................................FAIL! rc= 5 at Tue Apr 20 09:01:22 MDT 2010
011 bl137 TBL.sh e48c5h outfrq24h 2d ......................................FAIL! rc= 5 at Tue Apr 20 09:01:23 MDT 2010
019 bl332 TBL.sh f4c5dm ghgrmp+1850_cam5 9s ...............................FAIL! rc= 5 at Tue Apr 20 09:01:24 MDT 2010
028 bl335 TBL.sh f4idm idphys 9s ..........................................FAIL! rc= 5 at Tue Apr 20 09:01:25 MDT 2010
042 bl375 TBL.sh f1.9c5m outfrq24h+1850-2005_cam5 2d ......................FAIL! rc= 5 at Tue Apr 20 09:55:11 MDT 2010
045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s .....FAIL! rc= 7 at Tue Apr 20 10:14:54 MDT 2010
049 bl387 TBL.sh f1.9c4dm outfrq3s+1850-2005_cam4 9s ......................FAIL! rc= 5 at Tue Apr 20 10:27:22 MDT 2010
- bl374 failed due to new solar input file for super_fast chemistry
- all other baselines failures were due to them being new tests where the configuration was not recognizable in 
  the baseline test scripts
	
edinburgh/lf95: all PASS except
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 5 at Mon Apr 19 17:58:14 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 5 at Mon Apr 19 18:16:56 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .........................................FAIL! rc= 5 at Mon Apr 19 18:24:09 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 5 at Mon Apr 19 18:43:13 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 5 at Mon Apr 19 18:48:00 MDT 2010
- baselines at 10x15 failed due to baseline test scripts not having new functionality to build fv 2d decomp namelist setting
	
edinburgh/pgi: all PASS except
021 bl311 TBL.sh f10t5mdm ttrac 9s ........................................FAIL! rc= 5 at Mon Apr 19 17:28:51 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..........................................FAIL! rc= 5 at Mon Apr 19 17:36:04 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .........................................FAIL! rc= 5 at Mon Apr 19 17:41:24 MDT 2010
034 bl314 TBL.sh wg10dm outfrq3s 9s .......................................FAIL! rc= 5 at Mon Apr 19 17:47:14 MDT 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ......................................FAIL! rc= 5 at Mon Apr 19 17:50:43 MDT 2010
- baselines at 10x15 failed due to baseline test scripts not having new functionality to build fv 2d decomp namelist setting


CAM tag used for the baseline comparison tests if different than previous
tag: 

Summarize any changes to answers: BFB, except for super_fast chemistry

	
===============================================================

Tag name: cam4_1_12
Originator(s):  Jim Edwards
Date: 04-14-2010
One-line Summary: chem port to pio, homme restart fix

Purpose of changes: Removing depreciated wrap_nf code and
	replacing it with pio.   

Bugs fixed (include bugzilla ID): homme restart was not bfb when
	task count changed after restart

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: self

List all subroutines eliminated:

	
List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
     models/atm/cam/src/utils/cam_dom/ocn_spmd.F90
     models/atm/cam/src/utils/cam_dom/sst_data.F90
     models/atm/cam/src/utils/cam_dom/ocn_comp.F90
     models/atm/cam/src/chemistry/utils/solar_data.F90
     models/atm/cam/src/chemistry/mozart/chlorine_loading_data.F90
     models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
     models/atm/cam/src/chemistry/mozart/mo_photoin.F90
     models/atm/cam/src/chemistry/mozart/spedata.F90
     models/atm/cam/src/chemistry/mozart/mo_seto2.F90
     models/atm/cam/src/chemistry/mozart/mo_jshort.F90
     models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
     models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
     models/atm/cam/src/chemistry/mozart/mo_snoe.F90
     models/atm/cam/src/chemistry/mozart/euvac.F90
     models/atm/cam/src/chemistry/mozart/mo_drydep.F90
     models/atm/cam/src/chemistry/mozart/iondrag.F90
     models/atm/cam/src/chemistry/mozart/mo_photo.F90
     models/atm/cam/src/chemistry/mozart/mo_tuv_inti.F90
     models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
     models/atm/cam/src/dynamics/fv/metdata.F90

     replaced serial netcdf io functions with pio equivalents.

	
     models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
     models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
     models/atm/cam/src/dynamics/homme/external/viscosity_mod.F90
     models/atm/cam/src/dynamics/homme/inidat.F90

     replaced an internal homme global average function with the
     task count independent cam version in repro_sum_mod
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all pass except 
	 052 bl731 TBL.sh h16x4dm aqua 9s 
         due to roundoff level change in global sum calculation
	
edinburgh/lf95: all pass

calgary/pgi or jaguar/pgi: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam4_1_11
Originator(s): fvitt, aconley
Date: 12 Apr 2010
One-line Summary: Correction to the solar spectral scaling in CAMRT used by WACCM.

Purpose of changes:

 Corrected solar band spectral scaling in CAMRT used in WACCM 
 and super_fast_llnl simulations.  Added history fields for 
 off-line radiation calculations.  Band-level scaling is now
 computed relative to a reference spectrum of 4 solar cycles
 rather than a reference from the CAMRT code.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

   Namelist variable "solar_htng_spctrl_scl" added.  This is a switch that can be used to
   turn on/off the solar band spectral heating.  This is set to TRUE by default for waccm_mozart 
   or when radiation package is RRTMG, otherwise it is set to FALSE

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

A       models/atm/cam/src/physics/rrtmg/rad_solar_var.F90
  Manages the solar spectral scaling specific to RRTMG radiation package.
  This is the same as the previous version, just moved to the rrtmg directory.
  Band level scaling in RRTMG continues to be relative to the base Kurucz
  spectrum assumed by RRTMG.

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/build-namelist
 - solar_cnst explicitly set to -9999. when solar_data_file is specified
 - namelist var solar_htng_spctrl_scl to TRUE for waccm_mozart or when rad package is rrtmg

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - change in default solar_data_file for waccm_mozart
 - solar_photons_files default setting removed

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
 - solar_htng_spctrl_scl namelist variable added
 - rad_data_avgflag namelist variable added
 - rad_data_output and rad_data_histfile_num namelist variables moved from rad_cnst_nl to rad_data_nl

M       models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
M       models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
 - change in solar_data_file input for these waccm use cases

M       models/atm/cam/src/control/runtime_opts.F90
 - rad_data_readnl call added

M       models/atm/cam/src/physics/cam/radiation.F90
 - init_rad_data moved from physpkg
 - output_rad_data call moved from tphysbc
 - FSDTOA diagnostic field added to history

M       models/atm/cam/src/physics/cam/tphysbc.F90
 - output_rad_data call moved to radiation.F90

M       models/atm/cam/src/physics/cam/radsw.F90
 - calculate the column value of the fsdtoa diagnostic field
 - correction to the solar band scaling 

M       models/atm/cam/src/physics/cam/radconstants.F90
 - wavemin_true data added
 - correction to the get_sw_spectral_boundaries subroutine

M       models/atm/cam/src/physics/cam/radiation_data.F90
 - output of the rad constituents moved from rad_constituents
 - solar zeneth weighted surface fields added
 - code cleanup

M       models/atm/cam/src/physics/cam/physpkg.F90
 - init_rad_data moved to radiation.F90

M       models/atm/cam/src/physics/cam/rad_constituents.F90
 - output of the rad constituents moved to radiation_data.F90
 - rad_data_output and rad-data_histfile_num namelist vars moved to radiation_data
 - rad_cnst_get_clim_info subroutine was extended to provide more information

M       models/atm/cam/src/physics/cam/rad_solar_var.F90
 - reference spectrum used in the solar band scaling is now based on a 
   reference spectrum provided in the solar input dataset rather than a spectrum
   provided by CAMRT
 - set band scaling factors to 1.0 for TSI solar heating

M       models/atm/cam/src/physics/rrtmg/radiation.F90
 - init_rad_data moved from physpkg
 - output_rad_data call moved from tphysbc

M       models/atm/cam/src/chemistry/utils/mo_util.F90
 - constant "0." changed to "0._r8"

M       models/atm/cam/src/chemistry/utils/solar_data.F90
 - solar_htng_spctrl_scl namelist variable added.  This is a switch that can be used to
   turn on/off the solar band spectral heating.
 - endrun called if both solar_const and solar_data_file are both specified
 - read both tsi and ssi if the input dataset contains both
 - read in a reference spectrum (ref_ssi) and reference TSI (ref_tsi)
 - correction to the units of the solar photon fluxes used by photolysis

M       models/atm/cam/src/chemistry/mozart/mo_jlong.F90
 - comments added to clearly specify units of the input solar fluxes
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

031 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s ...............FAIL! rc= 7
 This is an expected failure due to changes in the band-level solar spectral scaling in 
 CAMRT for waccm_mozart.

045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s FAIL! rc= 7
 This is an expected failure due to change to use of TSI in CAMRT heating rather than 
 band-level solar spectral scaling for super_fast_llnl chemistry configuration.

edinburgh/lf95:

td.1285.status:034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
 This is an expected failure due to change to use of TSI in CAMRT heating rather than 
 band-level solar spectral scaling for waccm_ghg chemistry configuration.

edinburgh/pgi:
td.1282.status:034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
 This is an expected failure due to change to use of TSI in CAMRT heating rather than 
 band-level solar spectral scaling for waccm_ghg chemistry configuration.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam4_1_10
Originator(s): eaton
Date: Fri Apr  9 09:47:41 MDT 2010
One-line Summary: update for carbon cycle runs

Purpose of changes:

. Updates to configure and build-namelist to facilitate "out of the box"
  capability for carbon cycle runs.  When the configure option -co2_cycle
  is set, build-namelist will by default set the flags to turn on the
  co2_cycle code in CAM (adds 4 tracers) and will set the flag to read the
  fossil fuel emissions dataset.  Note that the code that reads the
  emission dataset doesn't do any spatial interpolation.  We currently only
  have the required dataset at fv 0.9x1.25 resolution.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. add default fossil fuel emissions dataset:
  inputdata/atm/cam/ggas/co2flux_fossil_1751-2006-monthly_0.9x1.25_c20100204.nc

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/configure
. remove the check that only allows the -co2_cycle option to be specified
  with -ccsm_seq.  This option can be run in standalone mode to test the
  emission and flux datasets.

models/atm/cam/bld/build-namelist
. add section to set defaults for co2_flag, co2_readflux_fuel, and
  co2flux_fuel_file when co2_cycle is true.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add default for co2flux_fuel_file

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS.

edinburgh/lf95: All PASS.

edinburgh/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam4_1_09
Originator(s): eaton
Date: Wed Apr  7 16:51:52 MDT 2010
One-line Summary: add rcp26 and rcp45 use cases; change default fields on
  initial file; misc cleanup

Purpose of changes:

. Add use cases for rcp2.6 and rcp4.5 runs.

. Change default value of inithist_all to .false..  This affects the
  writing of extra fields to the initial file that are used in CAPT
  experiments.

. Change some defaults in the FV communications per recommendation of Pat
  Worley. 

. Misc cleanup.

Bugs fixed (include bugzilla ID):

. Fix build-namelist deal correctly with the case when both -ignore_ic_year
  and -ignore_ic_date are specified.  You now get the -ignore_ic_date
  behavior from this setting.  This fix was needed for ncdata.  It was
  implemented correctly for finidat (used by cam standalone).

Describe any changes made to build system: none

Describe any changes made to the namelist:

. Change default value of inithist_all to .false..

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp26.xml
models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp45.xml
. update the GHG, aerosol, and ozone datasets

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/cam.cpl7.template
. change \$BLDROOT/Makefile to \$CASETOOLS/Makefile.  (requested by Tony)

models/atm/cam/bld/configure
. add check_fc test
. don't try to run esmf test in spmd mode

models/atm/cam/bld/Makefile.in
. remove old platforms: nec-sx6, cray-x1, earth_simulator

models/atm/cam/bld/namelist_files/namelist_definition.xml
. change documentation for inithist_all default to .false.
. change "catagory" to "category".
. remove bndtvsf6

models/atm/cam/bld/perl5lib/Build/NamelistDefinition.pm
. change "catagory" to "category".

models/atm/cam/src/control/filenames.F90
. remove bndtvsf6

models/atm/cam/src/control/ncdio_atm.F90
. change "warning" to "info" in logfile message.

models/atm/cam/src/control/runtime_opts.F90
. change documentation for inithist_all default to .false.
. remove bndtvsf6

models/atm/cam/src/dynamics/fv/diag_dynvar_ic.F90
models/atm/cam/src/dynamics/fv/dyn_comp.F90
. only add DELP to IC file when inithist_all is true.

models/atm/cam/src/dynamics/fv/inidat.F90
. don't issue warning if DELP isn't found on IC file

models/atm/cam/src/dynamics/fv/spmd_dyn.F90
. change default of modc_onetwo from 1 to 2.
. change default of modc_tracers from 0 to 3.

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. change default for inithist_all to .false.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS.

edinburgh/lf95: All PASS.

edinburgh/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam4_1_08
Originator(s): Francis Vitt
Date: 19 March 2010
One-line Summary: WACCM features added and bug fixes 

Purpose of changes:

Added new features and bug fixes:
 - 'INTERP_MISSING_MONTHS' capability added to WACCM upper boundary 
 - new WACCM QBO capability added
 - fix a bug in the turbulent mountain stress (TMS) module
 - fix for QBO problem introduced in cam4_1_05 (uzm was not set)
 - fix a bug in CLY family diagnostic
 - switch added to age of air tracers to read from IC file
 - clean up of waccm use cases
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D    models/atm/cam/bld/namelist_files/use_cases/waccm_1953_ramped_qbo.xml
D    models/atm/cam/bld/namelist_files/use_cases/waccm_1995_climo.xml
D    models/atm/cam/bld/namelist_files/use_cases/waccm_1995_smin.xml
D    models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cntrl.xml
D    models/atm/cam/bld/namelist_files/use_cases/waccm_1995_smax.xml
D    models/atm/cam/bld/namelist_files/use_cases/waccm_1950_smin.xml
D    models/atm/cam/bld/namelist_files/use_cases/waccm_1950_smax.xml
D    models/atm/cam/bld/namelist_files/use_cases/waccm_1950_ramped.xml
 cleaned out deprecated waccm use cases

D    models/atm/cam/src/chemistry/mozart/mo_drydep_tables.F90
 this was duplicated in the drv/shr code and is no longer needed

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

U    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 update in the chemistry pre-processor

U    models/atm/cam/bld/build-namelist
 change default waccm_ghg namelist settings

U    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 tgcm upper boundary file name change

U    models/atm/cam/bld/namelist_files/namelist_definition.xml
 age of air tracer namelist option added
	
U    models/atm/cam/bld/namelist_files/use_cases/waccm_1974-2005_cam4.xml
U    models/atm/cam/bld/namelist_files/use_cases/waccm_refb1.xml
U    models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
U    models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
 waccm use cases corrections

U    models/atm/cam/src/physics/waccm/qbo.F90
U    models/atm/cam/src/control/wrap_nf.F90
 functionality added to QBO code to operate over long time spans
	
U    models/atm/cam/src/physics/cam/molec_diff.F90
	
U    models/atm/cam/src/physics/cam/trb_mtn_stress.F90
 TMS bug fix

U    models/atm/cam/src/chemistry/mozart/chemistry.F90
U    models/atm/cam/src/physics/cam/vertical_diffusion.F90
U    models/atm/cam/src/physics/waccm/nlte_lw.F90
U    models/atm/cam/src/physics/cam/advnce.F90
U    models/atm/cam/src/physics/cam/upper_bc.F90
U    models/atm/cam/src/chemistry/mozart/mo_tgcm_ubc.F90
 ability to interpolate over long time spans added to upper boundary

U    models/atm/cam/src/physics/cam/aoa_tracers.F90
 namelist option added

	
U    models/atm/cam/src/chemistry/utils/tracer_data.F90
U    models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
 bug fix in CLY diagnostic

U    models/atm/cam/src/dynamics/fv/ctem.F90
U    models/atm/cam/src/dynamics/fv/dp_coupling.F90
 changes needed for QBO bug fix introduced in cam4_1_05 

U    models/atm/cam/src/chemistry/mozart/mo_drydep.F90
 - bug fixes and code clean up

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7 at Fri Mar 19 12:11:59 MDT 2010
031 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s ...............FAIL! rc= 7 at Fri Mar 19 12:35:46 MDT 2010
034 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ..............................FAIL! rc= 7 at Fri Mar 19 12:48:13 MDT 2010
038 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .............................FAIL! rc= 7 at Fri Mar 19 13:06:04 MDT 2010
042 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7 at Fri Mar 19 13:28:04 MDT 2010
045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s FAIL! rc= 7 at Fri Mar 19 13:48:08 MDT 2010
These are expected failures.  The waccm baseline fails due to change in upper boundary code and dry deposition.
The other chemistry configurations fail due to change in dry deposition.
	
edinburgh/lf95:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7 at Fri Mar 19 11:26:34 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7 at Fri Mar 19 11:32:21 MDT 2010
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7 at Fri Mar 19 11:38:23 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7 at Fri Mar 19 11:40:10 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Fri Mar 19 11:50:58 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Fri Mar 19 11:59:49 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7 at Fri Mar 19 12:04:56 MDT 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Fri Mar 19 12:18:26 MDT 2010
These are expected failures.  The chemistry configurations fail the baseline tests due to change in dry deposition.

edinburgh/pgi:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7 at Fri Mar 19 11:26:34 MDT 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7 at Fri Mar 19 11:32:21 MDT 2010
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7 at Fri Mar 19 11:38:23 MDT 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7 at Fri Mar 19 11:40:10 MDT 2010
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Fri Mar 19 11:50:58 MDT 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Fri Mar 19 11:59:49 MDT 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7 at Fri Mar 19 12:04:56 MDT 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Fri Mar 19 12:18:26 MDT 2010
These are expected failures.  The chemistry configurations fail the baseline tests due to change in dry deposition.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam4_1_07
Originator(s): eaton
Date: Sat Mar 13 11:33:42 MST 2010
One-line Summary: add dust tuning param to namelist; misc configure/build-namelist mods

Purpose of changes:

. Make the dust emission tuning parameter namelist accessable.

. Modify the dust emission tuning parameter for trop_bam only.

. Remove any remaining references to track1 from the CAM regression
  tests. 

. The CLM deposition velocity calc is a runtime setting.  Remove the switch 
  from configure and require it to be set via build-namelist.

. Add error trapping in build-namelist to protect against the user setting
  tms_orocnst without setting do_tms.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

. Add dust_emis_fact to new namelist group aerosol_nl.  This is the dust
  emissions tuning factor.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/test/system/input_tests_master
. replace track1 by cam4 (use case names have previously been updated)

M       models/atm/cam/bld/configure
. remove -lnd_drydep switch
. change -lnd_vocsrc to -clm_vocsrc, and only process when land model is
  CLM. 
. made verbose mode output more consistent.

M       models/atm/cam/bld/config_files/definition.xml
. remove lnd_drydep
. change lnd_vocsrc to clm_vocsrc

M       models/atm/cam/bld/build-namelist
. add dust_emis_fact to namelist when dust is prognostic -- default value
  depends on the value of do_tms 
. change lnd_vocsrc to clm_vocsrc
. remove dependence of drydep_method on the lnd_drydep configure parameter
  which was removed.   The default for drydep_method is set in
  namelist_defaults_cam.xml.  To use deposition velocities from CLM the
  user specifies drydep_method='xactive_lnd' in the namelist.
. add check that do_tms has been set if tms_oroconst has been set.

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add default values for dust_emis_fact -- allow them to depend on attribute tms
. add default for drydep_method

M       models/atm/cam/bld/namelist_files/namelist_definition.xml
. add dust_emis_fact to namelist group aerosol_nl
. move soil_erod to namelist group aerosol_nl

M       models/atm/cam/src/control/filenames.F90
. remove soil_erod from module data

M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
. add log output for do_tms and tms_orocnst

M       models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
. fixed log output to only be written from masterproc

M       models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
. declare namelist variables as module data
. set namelist variables by passing them through the arg list of
  dust_initialize.
. add soil_erod to module data
. set namelist variables by passing them through the arg list of
  dust_initialize.
. in dust_emis_intr set the variable "fact" from the namelist setting
  dust_emis_fact.  Remove conditional logic for setting fact since this
  will now be done by build-namelist.

M       models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
. declare namelist variables as module data
. add aerosol_readnl to read namelist group aerosol_nl
. add soil_erod to module data and to namelist group aerosol_nl
. add soil_erod to calling args for dust_initialize

M       models/atm/cam/src/chemistry/mozart/chemistry.F90
. call aerosol_readnl from the chem_readnl method
. remove soil_erod from chem_inparm namelist group

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except trop_bam

===============================================================
===============================================================

Tag name: cam4_1_06
Originator(s): eaton
Date: Tue Mar  9 08:08:52 MST 2010
One-line Summary: finish "track1" to "cam4" conversion; update externals

Purpose of changes:

. Finish cleanup of use cases that contain "track1" in name.  All
  references to "track1" have been replaced by "cam4".

. comment out the 'dpcoup dqreq' and 'dpcoup cant adjust' log messages.
  They're making the output log file unusable.

. remove old utilities for SOM and reduced grid

. update externals

. update the ccsm build template to recognize the USE_MPISERIAL environment
  variable set by the ccsm scripts

Bugs fixed (include bugzilla ID):

. change attribute "cell_method" to "cell_methods" to be compliant with CF
  conventions.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/bld/namelist_files/use_cases/1850_track1_2xco2.xml
models/atm/cam/bld/namelist_files/use_cases/1850_track1_super_fast_llnl.xml
. moved to "cam4" versions

models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
models/atm/cam/bld/namelist_files/use_cases/1850_track1.xml
. deleted (cam4 versions already exist)

models/atm/cam/tools/definemld/*
models/atm/cam/tools/defineqflux/*
. old SOM utilities

models/atm/cam/tools/mkrgrid/*
models/atm/cam/tools/mkrgridnew/*
models/atm/cam/tools/mkrgridsst/*
. old reduced grid utilities

models/ice/csim4/*
. move to models/atm/cam/src/utils/cam_csim4/*

models/ocn/dom/*
. move to models/atm/cam/src/utils/cam_dom/*

List all subroutines added and what they do:

models/atm/cam/bld/namelist_files/use_cases/waccm_1974-2005_cam4.xml
. new waccm use case

models/atm/cam/bld/namelist_files/use_cases/1850_cam4_2xco2.xml
models/atm/cam/bld/namelist_files/use_cases/1850_cam4_super_fast_llnl.xml
. moved from "track1" versions

models/atm/cam/src/utils/cam_csim4/*
. moved from models/ice/csim4/*

models/atm/cam/src/utils/cam_dom/*
. moved from models/ocn/dom/*

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. drvseq3_1_18      --> drvseq3_1_19
  MCT2_7_0_100106   --> MCT2_7_0_100228
  pio1_0_12         --> pio1_0_15
  scripts4_100225   --> scripts4_100306

models/atm/cam/bld/cam.cpl7.template
. add logic to recognize USE_MPISERIAL env var and set -nospmd arg to
  configure when it's value is 'TRUE'.

models/atm/cam/bld/configure
. change the filepaths for dom and csim4
. remove unused arg esmf_libvers

models/atm/cam/src/control/cam_history.F90
. change attribute "cell_method" to "cell_methods" to be compliant with CF
  conventions.

models/atm/cam/src/control/runtime_opts.F90
. Put log output for divdampn inside conditional logic so it's only written
  to the logfile for the spectral dycores.

models/atm/cam/src/dynamics/fv/dp_coupling.F90
. comment out the 'dpcoup dqreq' and 'dpcoup cant adjust' log messages.
  They're making the output log file unusable.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam4_1_05
Originator(s): Francis Vitt
Date: 8 Mar 2010
One-line Summary: Added features and misc code cleanup

Purpose of changes:

Features added:
 - ability to use CLM generated MEGAN VOC emissions
 - ability to use CLM generated dry deposition velocities
 - ability to read in prescribed aerosol deposition fluxes
   to be passed to surface models via the coupler
 - ability to use the WACCM age-of-air diagnostic tracers
   in any configuration
 - ability to use the WACCM TEM circulation diagnostics in 
   non-WACCM configurations that use the finite-volume dycore
 - ability to output data fields need for offline radiation
   calculations

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D    models/atm/cam/src/physics/waccm/tracers.F90
D    models/atm/cam/src/physics/waccm/ctem.F90
 these were moved so that they can be made available outside of waccm

List all subroutines added and what they do:
	
A    models/atm/cam/src/physics/cam/aoa_tracers.F90
 waccm age-of-air tracers moved make available outside of waccm
	
A    models/atm/cam/src/physics/cam/radiation_data.F90
 module added to output field for offline radiation calculations
	
A    models/atm/cam/src/chemistry/utils/ocnice_aero.F90
 utility module added to compute surface aerodynamic quatities for 
 dry deposition
	
A    models/atm/cam/src/chemistry/utils/aerodep_flx.F90
 used to read in precribed aerosol deposition fluxes

A    models/atm/cam/src/dynamics/fv/ctem.F90
 waccm TEM diagnostics moved make available outside of waccm

List all existing files that have been modified, and describe the changes:

U    models/atm/cam/bld/config_files/definition.xml
U    models/atm/cam/bld/configure
 configure options added:
   -[no]age_of_air_trcs
   -lnd_vocsrc
   -lnd_drydep

U    models/atm/cam/bld/build-namelist
 changed needed for WACCM TEM diagnostics, age-of-air, MEGAN VOCs and dry depostion
	
U    models/atm/cam/bld/namelist_files/namelist_definition.xml
 namelist variables added:
   do_circulation_diags
   rad_data_output
   rad_data_histfile_num
   aoa_tracers_flag
   aerdep_flx_*
	
U    models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4.xml
U    models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85.xml
U    models/atm/cam/bld/namelist_files/use_cases/1850_cam4.xml
 added TEM diagnostics
	
U    models/atm/cam/src/control/runtime_opts.F90
 cleanup - the presrcibed_* utility data modules now read there own namelist

U    models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
U    models/atm/cam/src/cpl_mct/atm_comp_mct.F90
U    models/atm/cam/src/control/camsrfexch_types.F90
 mods to receive the CLM generated VOC emissions and dry dep velocities

U    models/atm/cam/src/control/cam_restart.F90
U    models/atm/cam/src/control/cam_comp.F90
U    models/atm/cam/src/dynamics/fv/dp_coupling.F90
U    models/atm/cam/src/dynamics/sld/restart_dynamics.F90
U    models/atm/cam/src/dynamics/eul/restart_dynamics.F90
U    models/atm/cam/src/dynamics/fv/restart_dynamics.F90
U    models/atm/cam/src/dynamics/homme/restart_dynamics.F90
U    models/atm/cam/src/dynamics/fv/dyn_comp.F90
U    models/atm/cam/src/dynamics/fv/inital.F90
 mods for TEM diagnostics initialization
	
U    models/atm/cam/src/physics/cam/tropopause.F90
U    models/atm/cam/src/physics/cam/radiation.F90
U    models/atm/cam/src/physics/cam/radsw.F90
U    models/atm/cam/src/physics/cam/radconstants.F90
U    models/atm/cam/src/physics/cam/radlw.F90
 cleanup
 fixed threading bug in calculation of SOLIN diagnostic

U    models/atm/cam/src/physics/cam/rad_constituents.F90
U    models/atm/cam/src/physics/cam/tphysbc.F90
 mods to output radiation data for offline calculations

U    models/atm/cam/src/physics/cam/physpkg.F90
 changes in initialization
	
U    models/atm/cam/src/physics/cam/advnce.F90
 advances aoa_tracers and aerodep_flx modules added
	
U    models/atm/cam/src/physics/cam/tphysac.F90
 aoa_tracers tendancies invoked

U    models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
U    models/atm/cam/src/chemistry/utils/prescribed_aero.F90
U    models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
U    models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
 these read their own namelists to set options

U    models/atm/cam/src/chemistry/utils/tracer_data.F90
 path90 compilier bug fix

U    models/atm/cam/src/chemistry/mozart/mo_drydep.F90
U    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
U    models/atm/cam/src/chemistry/mozart/mo_chemini.F90
U    models/atm/cam/src/chemistry/mozart/chemistry.F90
 changes to make use of the CLM generated dry deposition velocities

U    models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
 code cleanup

U    models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
 changes to make use of the CLM generated MEGAN VOC emissions

U    models/atm/cam/src/dynamics/sld/inidat.F90
U    models/atm/cam/src/dynamics/eul/inidat.F90
U    models/atm/cam/src/dynamics/homme/inidat.F90
U    models/atm/cam/src/dynamics/fv/inidat.F90
U    models/atm/cam/src/physics/cam/initindx.F90
 changes for age-of-air tracers

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS
	
edinburgh/lf95: All PASS

edinburgh/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam4_1_04
Originator(s): eaton
Date: Mon Mar  1 14:23:48 MST 2010
One-line Summary: update externals; update rcp8.5 use case

Purpose of changes:

. update externals to match ccsm4_0_beta45

. update the solar and ghg files in the rcp8.5 use case

. Move the pilgrim directory location so that CCSM tags don't need to
  explicitly declare pilgrim to be an external.  It will now automatically
  come with the declared CAM tag.  Since pilgrim is maintained as part of
  CAM, this change enforces the consistency between pilgrim and CAM tags
  that is already implicitly assumed by the development process.

. misc cleanup

Bugs fixed (include bugzilla ID):

. There was a bug in share code that caused incorrect interpolation of
  annual cycle datasets when the model start date was 101.  This code was
  only being used by CICE in prescribed mode for the interpolation of ice
  fraction.  CAM inherited the fix by updating the share external.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. CLM datasets updated with the new external.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/utils/pilgrim/*
. pilgrim directory moved to models/atm/cam/src/utils

List all subroutines added and what they do:

models/atm/cam/src/utils/pilgrim/*
. pilgrim directory moved from models/utils/

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. drvseq3_1_16      --> drvseq3_1_18
  clm3_6_63         --> clm3_7_05
  cice4_0_20100105  --> cice4_0_20100222
  docn8_100103      --> docn8_100124
  share3_091217     --> share3_100228
  timing_090929     --> timing_091021
  scripts4_100112b  --> scripts4_100225

models/atm/cam/bld/cam.cpl7.template
. remove the atm_in and atm_in.tmp file once they're no longer needed
  (after the cam.buildnml.csh script is complete).

models/atm/cam/bld/configure
. update filepath for pilgrim: 
  models/utils/pilgrim --> models/atm/cam/src/utils/pilgrim 

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update CLM datasets to be consistent with the clm3_7_05 tag

models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85v2.xml
models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85.xml
. update solar and ghg files

models/atm/cam/src/control/cam_comp.F90
. remove superfluous declaration and setting of dtime in cam_final.

models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
models/atm/cam/src/cpl_mct/atm_comp_mct.F90
. fix the comment in atm_run_mct about looping over the radiation interval.
  Should say looping over atm coupling interval.

models/atm/cam/src/physics/cam/radsw.F90
. remove unused JPE_VMATH ifdefs


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
004 bl132 TBL.sh e32c4dh ghgrmp+1850_cam4 9s ......................FAIL! rc= 7 at Fri Feb 26 19:16:35 MST 2010
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7 at Fri Feb 26 19:36:47 MST 2010
015 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s .......................FAIL! rc= 7 at Fri Feb 26 19:43:58 MST 2010
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7 at Fri Feb 26 19:59:01 MST 2010
031 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s ...............FAIL! rc= 7 at Fri Feb 26 20:24:58 MST 2010
034 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ..............................FAIL! rc= 7 at Fri Feb 26 20:36:28 MST 2010
038 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .............................FAIL! rc= 7 at Mon Mar  1 10:36:21 MST 2010
042 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7 at Mon Mar  1 10:52:18 MST 2010
057 bl992 TBL_ccsm.sh f19_g16 E 2d ................................FAIL! rc= 5 at Fri Feb 26 22:28:50 MST 2010

bl132, bl151, bl331, bl332, bl336, bl337 fail due to updating the fsurdat files
at resolutions other than fv 1 and 2 deg.

bl151, bl337, bl371, bl375 fail due to fixing the bug in share code that
was giving incorrect results for runs with start dates of 101.

bl992 fails due to a pre-existing failure of the build in the previous
tag.

edinburgh/lf95:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7 at Fri Feb 26 18:56:30 MST 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7 at Fri Feb 26 18:59:52 MST 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7 at Fri Feb 26 19:03:41 MST 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Mon Mar  1 11:31:37 MST 2010

edinburgh/pgi:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7 at Fri Feb 26 19:07:59 MST 2010
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7 at Fri Feb 26 19:21:32 MST 2010
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7 at Fri Feb 26 19:39:55 MST 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Mon Mar  1 09:52:21 MST 2010

bl111, bl112, bl114 fail due to updating the fsurdat files
at resolutions other than fv 1 and 2 deg.

bl317 fails due to fixing the bug in share code that was giving incorrect
results for runs with start dates of 101.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except configs using new CLM datasets
(updated CLM tag) and runs starting on 101 (bug fix in share code).

===============================================================
===============================================================

Tag name: cam4_1_03
Originator(s):  Jim Edwards, Mark Taylor, Pat Worley
Date: 2/23/2010
One-line Summary: Homme dycore update, pio netcdf4 support

Purpose of changes: Homme dycore development, unstructured grid support

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: 

Describe any changes made to the namelist: 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Eaton

List all subroutines eliminated:

List all subroutines added and what they do: 

List all existing files that have been modified, and describe the changes:
   cam_trunk/SVN_EXTERNAL_DIRECTORIES
	Updated pio external
   cam_trunk/models/atm/cam/SVN_EXTERNAL_DIRECTORIES
	Updated cprnc to the same as used by ccsm
   cam_trunk/models/atm/cam/bld/build-namelist
   cam_trunk/models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
	Namelist cleanup for the homme dycore
   cam_trunk/models/atm/cam/src/chemistry/mozart/mo_airplane.F90
   cam_trunk/models/atm/cam/src/chemistry/mozart/mo_drydep.F90
        Replaced wrap_nf with pio.   
   cam_trunk/models/atm/cam/src/chemistry/utils/tracer_data.F90
   cam_trunk/models/atm/cam/src/physics/cam/modal_aer_opt.F90
        Replaced pio_noclobber with pio_nowrite, this change was required for 
	some netcdf4 versions
   cam_trunk/models/atm/cam/src/control/cam_history.F90
        Removed dead code
   cam_trunk/models/atm/cam/src/dynamics/homme/dp_coupling.F90
   cam_trunk/models/atm/cam/src/dynamics/homme/inital.F90
   cam_trunk/models/atm/cam/src/dynamics/homme/external/control_mod.F90 
   cam_trunk/models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
   cam_trunk/models/atm/cam/src/dynamics/homme/external/namelist_mod.F90	
   cam_trunk/models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
   cam_trunk/models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
   cam_trunk/models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
   cam_trunk/models/atm/cam/src/dynamics/homme/external/viscosity_mod.F90 	
   cam_trunk/models/atm/cam/src/dynamics/homme/restart_dynamics.F90  
   cam_trunk/models/atm/cam/src/dynamics/homme/stepon.F90
       Ongoing development changes for the homme dycore
       Enable subcycling &  foward-in-time dynamics by default
       Update to time-split forcing for forward-in-time dynamics
       Removed unnecessary data from restart files
	
   cam_trunk/models/atm/cam/src/physics/cam/phys_gmean.F90
   cam_trunk/models/atm/cam/src/physics/cam/phys_grid.F90
       Memory reductions in loadbalance options for unstructured grids
   
   cam_trunk/models/atm/cam/src/physics/cam/radconstants.F90
	move psf from module global to subroutine local

   cam_trunk/models/atm/cam/src/utils/cam_pio_utils.F90
         Added support for two new pio file types
	 netcdf4c (hdf5 compressed) and netcdf4p (hdf5 parallel)
	 these are somewhat mutually exclusive types: a file opened 
         to write compressed data must be serial.  
	 PIO will detect and open files to read with the correct 
	 option for that file type regardless of option requested.

   cam_trunk/models/atm/cam/test/system/test_driver.sh
         Update bluefire pnetcdf path
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all pass except ...
        052 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! 
        053 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! 
        054 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! 
        055 sm992 TSM_ccsm.sh f19_g16 E 2d ................................FAIL! 
        056 er992 TER_ccsm.sh f19_g16 E 1+1d ..............................FAIL! 
        057 bl992 TBL_ccsm.sh f19_g16 E 2d ................................FAIL! 

        bl731 fails due to update of homme dycore.
	
	- 991 and 992 tests failed to build due to update of drv external
	without corresponding required updates to other external
	components - carried forward from 4_1_02
	
edinburgh/lf95: all pass

calgary/pgi:  all pass

CAM tag used for the baseline comparison tests if different than previous
tag:   testing on bluefire required a mod to cam4_1_02 to allow that pio tag to build
       with pnetcdf-1.1.1svn. The pnetcdf version check in pio had to be commented out. 	

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
Tag name: cam4_1_02
Originator(s): mvr
Date: Fri Feb 19 2010
One-line Summary: enhancement of test suite on bluefire; added use_cases for 
rcp runs; qarch setting returned to Makefile and xlf compiler patch added; 
mods for the atm_aero infodata flag; build-namelist bug fix for dynamic PFT dataset

notes: 
1 rcp use_cases will need update to solar data file when it is ready
2 test suite on bluefire enhanced to include more configurations including better 
  coverage of cam4 (track1) runs - more enhancements to follow
3 atm_aero flag indicates whether CAM will provide carbon and dust deposition fluxes
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none
- improved error messages; addition of cam_chempkg; bug fix for dynamic PFT dataset

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 
D      models/atm/cam/test/system/config_files/f1.9c351dh
D      models/atm/cam/test/system/config_files/f1.9dm
D      models/atm/cam/test/system/config_files/e32dh
D      models/atm/cam/test/system/config_files/f4c351pdh
D      models/atm/cam/test/system/config_files/fm1.9dh
D      models/atm/cam/test/system/config_files/wm4h
D      models/atm/cam/test/system/config_files/e32pdh
- removed obsolete configuration options files no longer needed in test suite

D      models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_track1.xml
D      models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1_super_fast_llnl.xml
D      models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
- changed name of use_cases from 'track1' to cam4

D      models/atm/cam/tools/newcprnc
D      models/atm/cam/tools/cprnc
- removed all versions of netcdf comparison tool - will be added as external in subsequent tag
	
List all subroutines added and what they do: none
A      models/atm/cam/test/system/config_files/e32c4pdm
A      models/atm/cam/test/system/config_files/f1.9c5dm
A      models/atm/cam/test/system/config_files/fs1.9c4dh
A      models/atm/cam/test/system/config_files/f4c5dh
A      models/atm/cam/test/system/config_files/wm4c4h
A      models/atm/cam/test/system/config_files/f1.9c4dh
A      models/atm/cam/test/system/config_files/f4c4dh
A      models/atm/cam/test/system/config_files/e32c4dh
A      models/atm/cam/test/system/config_files/f4c4pdh
- new configuration options files needed for enhancements to test suite

A  +   models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_cam4.xml
A  +   models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4_super_fast_llnl.xml
A  +   models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cam4.xml
- changed name of use_cases from 'track1' to cam4

A      models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85.xml
A      models/atm/cam/bld/namelist_files/use_cases/2005-2100_cam4_rcp85v2.xml
- new use_cases required for rcp runs - will require mod for new solar data file
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_bluefire
- changes made to set of required pretag tests on bluefire

M      models/atm/cam/test/system/TBL.sh
M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TER.sh
M      models/atm/cam/test/system/TEQ_ccsm.sh
M      models/atm/cam/test/system/TER_ccsm.sh
M      models/atm/cam/test/system/TBL_ccsm.sh
M      models/atm/cam/test/system/TEQ.sh
- b4b checks now include any initial files generated

M      models/atm/cam/test/system/nl_files/aqpgro
- namelist options test file now included inithist='ENDOFRUN'

M      models/atm/cam/test/system/input_tests_master
- master list of test definitions changes to reflect enhancements made to test suite

M      models/atm/cam/bld/Makefile.in
- qarch setting replaced for bluefire compilations (was removed in cam4_1_00) and compiler 
  patch was added to FFLAGS and CFLAGS

M      models/atm/cam/bld/build-namelist
- improved error messages; addition of cam_chempkg; bug fix for dynamic PFT dataset

M      models/atm/cam/bld/namelist_files/namelist_definition.xml
- info added for cam_chempkg

M      models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4.xml
- fix to xml syntax for several recently added fields; added pre-industrial sst datasets

M      models/atm/cam/bld/namelist_files/use_cases/2005_cam4.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_cam4.xml
- fix to xml syntax for several recently added fields

M      models/atm/cam/src/control/cam_history.F90
- mods to ensure initial files get the default output variables when empty_htapes=.true.

M      models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M      models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
- use atm_aero flag to provide carbon and dust deposition fluxes when desired

M      models/atm/cam/src/physics/cam/phys_control.F90
- addition of cam_chempkg to phys_ctl_nl namelist

M      SVN_EXTERNAL_DIRECTORIES
 M     .
- update of drv tag needed for use of the atm_aero info flag
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except
004 bl132 TBL.sh e32c4dh ghgrmp+1850_cam4 9s ......................FAIL! rc= 7 at Fri Feb 19 10:14:28 MST 2010
006 bl133 TBL.sh e32c4pdm aqpgro 3s ...............................FAIL! rc= 7 at Fri Feb 19 10:14:28 MST 2010
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7 at Fri Feb 19 10:14:37 MST 2010
015 bl331 TBL.sh f4c4dh co2rmp+1850_cam4 9s .......................FAIL! rc= 7 at Fri Feb 19 10:14:39 MST 2010
021 bl333 TBL.sh f4c4pdh aqpgro 3s ................................FAIL! rc= 7 at Fri Feb 19 10:14:44 MST 2010
031 bl336 TBL.sh wm4c4h outfrq3s+waccm_1850_cam4 9s ...............FAIL! rc= 7 at Fri Feb 19 10:14:49 MST 2010
034 bl337 TBL.sh f4c5dh fv2d_8tsk 9s ..............................FAIL! rc= 7 at Fri Feb 19 10:14:50 MST 2010
038 bl371 TBL.sh f1.9c5dm fvvp_lb2 9s .............................FAIL! rc= 7 at Fri Feb 19 10:14:50 MST 2010
042 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7 at Fri Feb 19 10:15:02 MST 2010
045 bl374 TBL.sh fs1.9c4dh outfrq3s+1850-2005_cam4_super_fast_llnl 9s FAIL! rc= 7 at Fri Feb 19 10:15:03 MST 2010
049 bl387 TBL.sh f1.9c4dh outfrq3s+1850-2005_cam4 9s ..............FAIL! rc= 7 at Fri Feb 19 10:15:04 MST 2010
053 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4 at Fri Feb 19 10:15:31 MST 2010
054 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6 at Fri Feb 19 10:15:31 MST 2010
055 sm992 TSM_ccsm.sh f19_g16 E 2d ................................FAIL! rc= 4 at Fri Feb 19 10:15:47 MST 2010
056 er992 TER_ccsm.sh f19_g16 E 1+1d ..............................FAIL! rc= 6 at Fri Feb 19 10:15:47 MST 2010
057 bl992 TBL_ccsm.sh f19_g16 E 2d ................................FAIL! rc= 4 at Fri Feb 19 10:15:47 MST 2010
- bl132, bl133, bl331, bl333, bl336, bl337, bl371, bl374, bl387 failed due to change in test definition
- bl151, bl336, bl375 failed due to replacement of qarch setting in Makefile and inclusion of compiler patch
- 991 and 992 tests failed to build due to update of drv external without corresponding required updates to 
  other external components
	
edinburgh/lf95: all PASS except
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7 at Thu Feb 18 15:41:54 MST 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7 at Thu Feb 18 16:47:54 MST 2010
- these failed because initial files are now generated and included in b4b checks

edinburgh/pgi: all PASS except
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7 at Thu Feb 18 15:21:07 MST 2010
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7 at Thu Feb 18 15:38:12 MST 2010
- these failed because initial files are now generated and included in b4b checks

CAM tag used for the baseline comparison tests if different than previous
tag: additional testing done with cam and drv changes placed into ccsm4_0_beta43 - CME.f19_f19.F.bluefire PASSED

Summarize any changes to answers: BFB, but pergro test was performed on bluefire for configuration where things 
were not b4b due to replacement of qarch setting and addition of compiler patch (fv 1.9x2.5 hybrid - passed)

	

===============================================================
Tag name: cam4_1_01
Originator(s): mvr
Date: Wed Feb 10 2010
One-line Summary: adjustment to dust mods of previous tag; general cleanup of test scripts

Purpose of changes: dust mods of previous tag were applied for all configurations, but 
	were not intended when using cam5 physics (indicated when MODAL_AERO is defined)

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 
D      models/atm/cam/test/system/config_files/h5x8dm
D      models/atm/cam/test/system/config_files/h5x8adm
D      models/atm/cam/test/system/config_files/h5x8idm
- removed configuration options test files for unused homme grid
D      models/atm/cam/test/system/posttag_cron_lightning.sh
D      models/atm/cam/bld/run-lightning.csh
- removed test and template scripts for obsolete machine lightning
	
List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/config_files/scm64bfbiop_35
M      models/atm/cam/test/system/config_files/e64bfbiop_35
M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/CAM_runcmnd.sh
- cleanup of test scripts, including removal of code for obsolete machines lightning and dublin
M      models/atm/cam/test/system/input_tests_master
- corrected test definitions where usecase 1870_prog_aero was replaced with 1850_cam4_trop_bam
M      models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
- adj to dust changes of previous tag, where mods will not have an affect when MODAL_AERO 
  is defined
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7 at Wed Feb 10 09:04:46 MST 2010
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7 at Wed Feb 10 09:04:54 MST 2010
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7 at Wed Feb 10 09:05:02 MST 2010
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7 at Wed Feb 10 09:05:06 MST 2010
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7 at Wed Feb 10 09:05:11 MST 2010
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7 at Wed Feb 10 09:05:27 MST 2010
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7 at Wed Feb 10 09:05:38 MST 2010
- all were expected, as they are cam5 configurations where dust mod of cam4_1_00 was undone
	
edinburgh/lf95: all PASS except
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Tue Feb  9 19:05:35 MST 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Tue Feb  9 19:42:09 MST 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Tue Feb  9 20:56:52 MST 2010
- all were expected, as they are cam5 configurations where dust mod of cam4_1_00 was undone

edinburgh/pgi: all PASS except
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Tue Feb  9 18:20:27 MST 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Tue Feb  9 18:29:45 MST 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Tue Feb  9 18:49:06 MST 2010
- all were expected, as they are cam5 configurations where dust mod of cam4_1_00 was undone

CAM tag used for the baseline comparison tests if different than previous
tag: additional testing was done vs cam3_6_79 to verify the baseline tests listed above were b4b 

Summarize any changes to answers: BFB

===============================================================

Tag name: cam4_1_00
Originator(s): eaton
Date: Wed Feb  3 10:35:05 MST 2010
One-line Summary: update names to reflect CAM4 release; update trop_bam dust; SST datasets.

Purpose of changes:

. The decision was made to publicly release what we have been calling
  track1 or cam3_5_1 during the development process as CAM-4.0.  This
  update is mainly to make name changes that are consistent with that
  decision.

  The default physics on the trunk is still in an intermediate development
  state between cam4 and the new track5 physics.  For that reason the trunk
  tag name has been advanced beyond cam4_0_00.  We expect to merge the
  track5 development branch to the trunk in the near future.

  In the public release of CAM-4.0 the cam4 physics will obviously be the
  default.  But to get cam4 physics from a trunk tag you must give the
  argument "-phys cam4" to configure.  For backwards compatibility with
  existing scripts configure will continue to recognize the value cam3_5_1
  as an alias for cam4.

. Update SST datasets for 1850 climatology and add 1850-2008 AMIP.

. Changes for dust in trop_bam
  - Update soil_erod files for 1, 1/2, and 1/4 degree FV
  - New use case: 1850_cam4_trop_bam
  - tuning mod in dust_emis_intr

. Add workaround to Makefile for problems with track5 physics on bluefire.
  This workaround causes a roundoff level change in other configurations.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. updated soil_erod files for 1, 1/2, and 1/4 degree FV

. updated the "clim_pi" SST datasets which are used when sim_year=1850.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/bld/namelist_files/use_cases/1990_prog_aero.xml
. deleted

models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam351.xml
models/atm/cam/bld/namelist_files/use_cases/1850_cam351.xml
models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
models/atm/cam/bld/namelist_files/use_cases/2005_cam351.xml
. old names

List all subroutines added and what they do:

models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam4.xml
models/atm/cam/bld/namelist_files/use_cases/1850_cam4.xml
models/atm/cam/bld/namelist_files/use_cases/2005_cam4.xml
. new names

models/atm/cam/bld/namelist_files/use_cases/1850_cam4_trop_bam.xml
. renamed from 1870_prog_aero.xml
. update 1850 GHG values
. update prescribed ozone and oxidants datasets

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
models/atm/cam/bld/config_files/definition.xml
models/atm/cam/bld/configure
models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. change valid values of phys to be cam3, cam4, cam5, ideal, adiabatic.
  cam5 is default on the trunk.  For backwards compatibility accept
  cam3_5_1 as an alias for cam4.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add SST datasets for 1850 climatology and 1850-2008 AMIP.
. update soil_erod files for 1, 1/2, and 1/4 degree FV

models/atm/cam/bld/Makefile.in
. remove the -qarch=auto flag for AIX builds.  This is a temporary
  workaround to address current problems with the track5 code on bluefire.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. documentation update

models/atm/cam/bld/build-namelist
models/atm/cam/bld/namelist_files/namelist_definition.xml
models/atm/cam/src/physics/cam/phys_control.F90
. add namelist variable to be set by build-namelist that communicates the
  name of the physics package.
. add logical query function, physpkg_is(name), to allow control logic to
  be based on the name of the physics package.

models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
. modify a conditional on soil_erod_tmp at line 858 (tuning mod)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7 at Tue Feb  2 19:23:17 MST 2010
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7 at Mon Feb  1 13:08:47 MST 2010
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7 at Tue Feb  2 19:46:49 MST 2010
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7 at Tue Feb  2 19:54:22 MST 2010
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7 at Mon Feb  1 13:40:03 MST 2010
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7 at Tue Feb  2 20:11:27 MST 2010
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7 at Tue Feb  2 20:24:18 MST 2010
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7 at Mon Feb  1 14:13:58 MST 2010
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7 at Tue Feb  2 20:58:25 MST 2010
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 4 at Tue Feb  2 21:02:27 MST 2010

bl151, bl336, and bl375 fail due to the removal of the -qarch=auto flag.
That change only introduced roundoff diffs (validated w/ a pergro test)
into configs running without debug flags.

bl132, bl151, bl331, bl332, bl337, bl371, bl375, bl374 are failing due to
the tuning mod in dust_intr.F90.  This is larger than roundoff.

bl387 fails due to updating the "clim_pi" SST dataset.

edinburgh/lf95:
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Tue Feb  2 20:08:59 MST 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Tue Feb  2 20:35:01 MST 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Tue Feb  2 21:25:21 MST 2010

edinburgh/pgi:
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Tue Feb  2 19:21:44 MST 2010
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Tue Feb  2 19:27:41 MST 2010
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Tue Feb  2 19:39:15 MST 2010

bl311, bl312, and bl317 fail with both lf95 and pgi due to the tuning mod
in dust_intr.F90.  This is larger than roundoff.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except:
. non-debug runs on bluefire all have roundoff diffs due to qarch flag 
. trop_mozart and trop_mam3 are both affected by the tuning mod in
  dust_intr.F90
. any run using new SST datasets (*clim_pi* versions)

===============================================================
===============================================================

Tag name: cam3_6_79
Originator(s): mvr, hannay
Date: Fri Jan 22 2010
One-line Summary: New SSTs data for 1850 runs; Make the SST dataset "sim_year" dependant.

Purpose of changes:

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 
- new sst datasets for 1850 configurations

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/bld/build-namelist
- Make the SST dataset "sim_year" dependant.
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- New SSTs data for 1850 runs; Make the SST dataset "sim_year" dependant.
M      models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
M      models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_track1.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_track1.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cntrl.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_track1_super_fast_llnl.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_track1_2xco2.xml
- documentation for use cases changed to reflect sst forcings are based on sim_year
M      models/atm/cam/test/system/test_driver.sh
- increased wall time for running test suite on jaguar
M      models/atm/cam/test/system/tests_posttag_jaguar
M      models/atm/cam/test/system/tests_pretag_bluefire
M      models/atm/cam/test/system/input_tests_master
- new test id's for equivalence tests to avoid confusion; added test cb372

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7 at Thu Jan 21 20:05:20 MST 2010
- bl387 was expected to fail since it's using a new sst dataset
	
edinburgh/lf95: all PASS

edinburgh/pgi: all PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except configs that use 1850 sst datasets

===============================================================

Tag name: cam3_6_78
Originator(s): pworley, fvitt, eaton
Date: Mon Jan 18 15:23:36 MST 2010
One-line Summary: Merge mods/fixes from the release branch; update externals

Purpose of changes:

. Add workaround for problem with BGP in the repro_sum_mod module. (from
  pworley) 

. Cleanup of some old and unused files.

. fixes to waccm and super fast chem use cases (from fvitt)

. update externals
  pio1_0_6         --> pio1_0_7
  scripts4_100108b --> scripts4_100112b


Bugs fixed (include bugzilla ID):

. the problem with the SCAM runs (link failure) in the last tag is fixed by
  updating to pio1_0_7

. workaround apparent compiler bug that was affecting the SOLIN diagnostic
  field in some configurations. (from fvitt)

. subroutine calc_col_mean should use pdeldry rather than pdel to
  convert the GHG mixing ratios to masses.  Only affects CAM-RT radiation
  scheme.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

Copyright
README
. Old CAM3 files

models/atm/cam/bld/script_tests/namelist.pl
models/atm/cam/bld/perl5lib/t/*
. delete unused test code

models/atm/cam/bld/camdom.cpl7.template
. delete since camdom no longer supported from ccsm scripts

models/atm/cam/bld/README
. delete old README

models/atm/cam/src/physics/cam3_6/*
. delete unsupported physics option

models/atm/cam/test/unit/*
. delete unused test code

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update pio and scripts externals

models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1_super_fast_llnl.xml
models/atm/cam/bld/namelist_files/use_cases/1850_track1_super_fast_llnl.xml
. mods from fvitt

models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_track1.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cntrl.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
. new 4x5 IC file

models/atm/cam/src/physics/cam/radsw.F90
. replace an intrinsic sum by an explicit do loop.  This is a workaround
  for a problem where the diagnostic field SOLIN would contain bad values
  in some configurations (cam3_5_1 plus trop_mozart).  (from fvitt)

models/atm/cam/src/physics/cam/aer_rad_props.F90
models/atm/cam/src/physics/cam/radiation.F90
. fix lines longer than 132 chars

models/atm/cam/src/utils/repro_sum_mod.F90
. Add a workaround, inside a BGP ifdef, to use i4 with the scalable
  reproducible algorithm.  All other platforms use i8.

models/atm/cam/src/physics/cam/radiation.F90
. Change subroutine calc_col_mean to use pdeldry rather than pdel to
  convert the GHG mixing ratios to masses.

models/atm/cam/src/physics/rrtmg/radiation.F90
. Change subroutine calc_col_mean to use pdeldry rather than pdel to
  convert the GHG mixing ratios to masses.  This subroutine is only used
  for a diagnostic calculation in the RRTMG version.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except
021 bl333 TBL.sh f4c351pdh aqpgro 3s ..............................FAIL! rc= 7 at Mon Jan 18 12:36:15 MST 2010
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7 at Mon Jan 18 12:47:31 MST 2010
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7 at Mon Jan 18 13:52:43 MST 2010
051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7 at Mon Jan 18 13:57:35 MST 2010
056 bl992 TBL_ccsm.sh f19_g16 E 2d ................................FAIL! rc= 7 at Mon Jan 18 14:19:13 MST 2010

edinburgh/lf95:
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7 at Mon Jan 18 13:48:38 MST 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7 at Mon Jan 18 13:53:14 MST 2010

edinburgh/pgi:
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7 at Mon Jan 18 12:21:25 MST 2010
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7 at Mon Jan 18 12:23:34 MST 2010

bl314 and bl336 fail due to the workaround in radsw for the SOLIN
calculation.  It's only the diagnostic field SOLIN that contains roundoff
level diffs.

All baselines above fail because they
use the CAM-RT radiation code which
uses the calc_col_mean routine to compute a value of both O2 and CO2.
Changing the weights used in the calculation results in a roundoff level
change if the constituent has a constant mmr to begin with, and a larger
than roundoff change in any constituent that is not already constant in the
column.  That causes larger than roundoff diffs in WACCM runs that have
prognostic CO2 and O2.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except configs that use CAM-RT.  That
config changes by rounoff if O2 and CO2 are constant, and by more than
roundoff if O2 or CO2 have 3D variation.

===============================================================
===============================================================

Tag name: cam3_6_77
Originator(s): mataylo, jedwards, eaton
Date: Mon Jan 11 18:33:04 MST 2010
One-line Summary: fix namespace conflict w/ new pio lib; update externals

Purpose of changes:

. Fix CAM trunk to work with new pio tag by changing the name of the
  pio_utils module to cam_pio_utils.
  **Note** The SCAM mode is not linking correctly with the new PIO lib.
  This will be fixed shortly, but this tag was made anyway due to timelines
  of the release branch for CCSM4.0.

. update PIO and CLM externals

Bugs fixed (include bugzilla ID):

. bug fix for the totalsize calculation in pbuf_init_restart (from mataylo)

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/utils/pio_utils.F90
. this name conflicts with one in the new PIO lib

models/atm/cam/bld/perl5lib/XML/man3/XML::Lite.3
models/atm/cam/bld/perl5lib/XML/man3/XML::Lite::Element.3
. "::" in filenames causes problems when trying to check out code from the
  svn repo on a Windows system.

List all subroutines added and what they do:

models/atm/cam/src/utils/cam_pio_utils.F90
. renamed from pio_utils.F90
. also change module name from pio_utils to cam_pio_utils

models/atm/cam/bld/perl5lib/XML/man3/XML_Lite.3
models/atm/cam/bld/perl5lib/XML/man3/XML_Lite_Element.3
. renamed from XML::Lite.3 and XML::Lite::Element.3

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. clm3_6_58   --> clm3_6_63
  pio60_prod  --> pio1_0_6

models/atm/cam/src/chemistry/utils/mo_solar_parms.F90
models/atm/cam/src/chemistry/utils/tracer_data.F90
models/atm/cam/src/control/cam_comp.F90
models/atm/cam/src/control/cam_history.F90
models/atm/cam/src/control/cam_restart.F90
models/atm/cam/src/control/ncdio_atm.F90
models/atm/cam/src/control/startup_initialconds.F90
models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
models/atm/cam/src/cpl_mct/atm_comp_mct.F90
models/atm/cam/src/dynamics/eul/restart_dynamics.F90
models/atm/cam/src/dynamics/fv/restart_dynamics.F90
models/atm/cam/src/dynamics/homme/inidat.F90
models/atm/cam/src/dynamics/homme/restart_dynamics.F90
models/atm/cam/src/dynamics/sld/restart_dynamics.F90
models/atm/cam/src/physics/cam/modal_aer_opt.F90
models/atm/cam/src/physics/cam/phys_prop.F90
models/atm/cam/src/physics/cam/radae.F90
models/atm/cam/src/physics/cam/restart_physics.F90
models/atm/cam/src/physics/cam/tropopause.F90
. change pio_utils to cam_pio_utils

models/atm/cam/src/physics/cam/phys_buffer.F90
. change pio_utils to cam_pio_utils
. bug fix for the totalsize calculation in pbuf_init_restart (from mataylo)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
057 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 4 at Mon Jan 11 15:14:53 MST 2010

edinburgh/lf95: All PASS except
042 sc003 TSM.sh scmarmiop scmarm 7s ..............................FAIL! rc= 4 at Mon Jan 11 15:00:07 MST 2010

edinburgh/pgi: All PASS except
042 sc003 TSM.sh scmarmiop scmarm 7s ..............................FAIL! rc= 4 at Mon Jan 11 13:20:45 MST 2010

These failures are all build time link failures.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_76
Originator(s): fvitt, mataylo, eaton
Date: Sat Jan  9 13:25:13 MST 2010
One-line Summary: use case mods; update externals

Purpose of changes:

. add use cases to supply additional sub-monthly output for AR5 runs

. modify waccm use cases to use a different 4x5 initial file, and add
  workaround for problem in waccm_1850_track1 (from fvitt)

. update externals to be consistent with ccsm4_0_beta39

. some cleanup work in namelist code

Bugs fixed (include bugzilla ID): 

. fix for HOMME subcycling bug (from mataylo)

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. waccm use cases using a new 4x5 initial file
. new initial (jan 01) and topo files for HOMME ne30np4 grid

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/namelist_files/use_cases/1850_cam351.xml
. This is the 1850_track1 use case with daily fields requested for AR5 runs
  added ('TREFHTMN','TREFHTMX','TREFHT','PRECC','PRECL','PSL').

models/atm/cam/bld/namelist_files/use_cases/1850-2005_cam351.xml
. This is the 1850-2005_track1 use case with daily fields requested for AR5 runs

models/atm/cam/bld/namelist_files/use_cases/2005_cam351.xml
. Use case for fixed 2005 forcings.

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
  drvseq3_1_10      --> drvseq3_1_11
  cice4_0_20091202  --> cice4_0_20100105
  docn8_091208      --> docn8_100103
  scripts4_091208   --> scripts4_100108b
  MCT2_6_0_090926   --> MCT2_7_0_100106

models/atm/cam/bld/build-namelist
. refactor code that makes sure consistent land/ocn fractions are used by
  surface components.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. remove bndtvs and focndomain settings for homme grids
. add ncdata (jan 01) and bnd_topo files for ne30np4 HOMME grid

models/atm/cam/bld/namelist_files/namelist_definition.xml
. remove old SOM variables

models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_track1.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cntrl.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
. update 4x5 ncdata to waccm3548_4x_t43.cam2.i.1870-01-01-00000.nc

models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
. set ext_frc_ymd=18500102 to work around a problem that occurs when
  setting it to 18500101. 

models/atm/cam/src/dynamics/homme/dyn_comp.F90
. fix for subcycling bug (from Mark Taylor)

models/atm/cam/test/system/input_tests_master
. change SOM tests from f19_g15 to f19_g16

models/atm/cam/test/system/config_files/h16x4dm
models/atm/cam/test/system/config_files/h5x8adm
. remove machine specific settings for -pnc_inc and -pnc_lib

models/atm/cam/test/system/test_driver.sh
. Add {INC,LIB}_PNETCDF variables for bluefire to point to the required
  version of PNetCDF.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
056 bl992 TBL_ccsm.sh f19_g16 E 2d ................................FAIL! rc= 7 at Thu Jan  7 12:21:24 MST 2010

This baseline failure is expected due to changing the test definition from
g15 to g16.

edinburgh/lf95: All PASS.

edinburgh/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_75
Originator(s): tcraig, cacraig, mvertens, eaton
Date: Tue Jan  5 09:45:39 MST 2010
One-line Summary: Support for DOCN; mods for running with CCSM scripts; misc fixes and cleanup.

Purpose of changes:

. Changes to allow running the DOCN data model in place of CAM-DOM.
  CAM-DOM is currently still the default when running in a standalone CAM
  mode (DOCN doesn't yet support the aqua-planet SSTs).  But only DOCN is
  supported for running F compsets with the CCSM scripts.

. Mod to allow putting namelist variables in the file
  $CASEROOT/SourceMods/src.cam/user_nl when running with CCSM scripts.
  This is an easier way to modify namelist settings than via the
  CAM_NAMELIST_OPTS attribute in the compset definition.

. Add ESMF interfaces and support for running with an external ESMF library
  via the CCSM scripts.

. Changes to support running single column mode from the CCSM scripts.

. Code cleanup -- added implicit none, private, and save statements to
  modules that were missing them.

. Fix bugs that were causing problems on BG/P.

Bugs fixed (include bugzilla ID):

. bug 1073 -- change the first argument of mpi_get_processor_name from char
  array to string.

. bug 1074 -- Add error return arg to mpi_abort.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/bld/namelist_files/use_cases/1870-2000_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_bam.xml
models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1990_control.xml
. delete old use cases

List all subroutines added and what they do:

models/atm/cam/src/cpl_esmf/atm_comp_esmf.F90
models/atm/cam/src/cpl_esmf/atm_comp_mct.F90
. esmf interface layer

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. Modify so that build-namelist doesn't try to find defaults for bndtvs when
  ocn has been set to none.  This was causing a problem trying to run HOMME
  from the CCSM scripts.
. Add code to write the files that docn needs.

models/atm/cam/bld/cam.cpl7.template
. Add support for "PTS_MODE" == single_column
. change use of ATM_NY -- now it's resolved at build time rather than
  configure time.
. mod to allow the user to put a file with namelist settings in the source
  mods directory in a file named user_nl, i.e.,
  $CASEROOT/SourceMods/src.cam/user_nl.  This file should have the
  format of a file that is supplied to build-namelist via the -infile
  argument. 

models/atm/cam/bld/configure
. Remove the -esmf_libvers option.  The cpp macro ESMF_v2 has been replaced
  by USE_ESMF_LIB for consistency with CCSM.  We assume that whenever an
  external ESMF lib is used, that its version is 3.1 or later.  If an
  external ESMF lib is not used, the default WRF implementation of the ESMF
  time manager utilities has interfaces from ESMF version 2.
  Modify configure to recognize the USE_ESMF_LIB environment variable which
  is set by the CCSM scripts.  This must be used to determine whether or
  not and external lib is being used since ESMF_LIBDIR is always set by the
  CCSM scripts whether it will be used or not.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. Remove the years from the ic_ymd attributes for the finidat files.  This
  way they will be used with the default 101 start date without the user
  having to specify -ignore_ic_year to build-namelist.  This is the way
  CAM's ncdata files work as well.

models/atm/cam/src/dynamics/fv/inidat.F90
models/atm/cam/src/physics/cam/buffer.F90
models/atm/cam/src/physics/cam/cam_diagnostics.F90
models/atm/cam/src/physics/cam/cloud_diagnostics.F90
models/atm/cam/src/physics/cam/cmparray_mod.F90
models/atm/cam/src/physics/cam/convect_ke_intr.F90
models/atm/cam/src/physics/cam/geopotential.F90
models/atm/cam/src/physics/cam/hirsbtpar.f90
models/atm/cam/src/physics/cam/iop_surf.F90
models/atm/cam/src/physics/cam/param_cldoptics.F90
models/atm/cam/src/physics/cam/pkg_cld_sediment.F90
models/atm/cam/src/physics/cam/pkg_cldoptics.F90
models/atm/cam/src/physics/cam/ppgrid.F90
models/atm/cam/src/physics/cam/restart_physics.F90
models/atm/cam/src/physics/cam/wv_saturation.F90
models/atm/cam/src/physics/rrtmg/cloud_diagnostics.F90
. code cleanup -- mostly adding missing implicit none, private, and save
  statements to modules
. eliminate unused parameter pvermx

models/atm/cam/src/utils/abortutils.F90
. Add error return arg to mpi_abort.  This fixes bug 1074.

models/atm/cam/src/utils/spmd_utils.F90
. Change the first argument of mpi_get_processor_name from char array to
  string.  This fixes bug 1073.

models/atm/cam/src/utils/time_manager.F90
. initialize_clock: arg ref_date - change intent from in to inout
. set_date_from_time_float: Distinquish between the esmf-v2 (the wrf_esmf
  code uses these interfaces) and the esmf-v3 or later interfaces by the
  cpp macro USE_ESMF_LIB.  The ESMF_v2 macro is deprecated.

models/atm/cam/test/system/input_tests_master
. The 1870_bam use case was only being used in the *384 tests on jaguar.
  Replace that use case by 1850_track1.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS.

dublin/lf95: All PASS.

dublin/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_74
Originator(s): Francis Vitt
Date: 23 Dec 2009
One-line Summary: Update chemistry code with track5 branch code

Purpose of changes:

 - Update trunk with latest chemistry code which is in the track5 branch.
 - Eliminate the discrepancies in chem code between trunk and track5 branch.
 - Fix the super_fast_llnl build-namelist use cases.

 The changes merged in from track5 branch:
   - added capability to specify 'INTERP_MISSING_MONTHS' to the surface and elevated emissions codes  
   - modifications needed for running super_fast_llnl chemistry with prognostic modal aerosols
   - radiation packages camrt and rrtmg both have the ability to use spectral solar variance
   - chemistry photolysis reactions and radiation heating use the same input dataset
     so in chemistry configurations rad heating will have spectral solar variance
   - woods and neckel schemes of using F10.7 data to model the solar spectrum is removed
   - additional chemistry code changes:
     . use tropopause level determined by physics/cam/tropopause.F90
     . unified "users" reaction labeling scheme for waccm and cam-chem
     . aircraft sources optional
     . minimum mixing ratio of all chemical tracers greater than zero
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

D      models/atm/cam/src/physics/cam/solvar_interface.F90
D      models/atm/cam/src/chemistry/mozart/solar_photons.F90
D      models/atm/cam/src/chemistry/mozart/mo_tropopause.F90
D      models/atm/cam/src/chemistry/mozart/solvar_interface.F90
D      models/atm/cam/src/chemistry/mozart/woods.F90
D      models/atm/cam/src/chemistry/mozart/llnl_set_chem_trop.F90
D      models/atm/cam/src/chemistry/mozart/solvar_woods.F90
D      models/atm/cam/src/chemistry/mozart/solvar_data.F90
D      models/atm/cam/src/chemistry/mozart/neckel.F90

List all subroutines added and what they do:

A      models/atm/cam/bld/config_files/defaults_super_fast_llnl_mam3.xml
  - configure defaults file for new super_fast_llnl_mam3 chem option
	
A      models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1_super_fast_llnl.xml
  - track1 with chemistry use case
	
A      models/atm/cam/src/physics/cam/rad_solar_var.F90
  - needed for the spectral solar variance 
	
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lu_solve.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_setrxt.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/m_rxt_id.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_phtadj.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_nln_matrix.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_adjrxt.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/m_het_id.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lu_factor.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_indprd.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_sim_dat.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/m_spc_id.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_imp_sol.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/chem_mods.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_prod_loss.F90
A      models/atm/cam/src/chemistry/pp_super_fast_llnl_mam3/mo_lin_matrix.F90
 - preprocessor generated files for new super_fast_llnl_mam3 chemistry with package

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/bld/configure
M      models/atm/cam/bld/config_files/definition.xml
 - chem option "super_fast_llnl_mam3" added

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - update MAM inputs
 - optics file for super_fast_llnl_mam3 configuration
 - default solar input file
 - prescribed constituents updates
 - tropopause, woods, neckel inputs removed

M      models/atm/cam/bld/namelist_files/namelist_definition.xml
 - tropopause, woods, neckel namelist vars removed
 - added capability to specify 'INTERP_MISSING_MONTHS' to the 
   surface and elevated emissions 

M      models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
M      models/atm/cam/bld/namelist_files/use_cases/1990_prog_aero.xml
M      models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_track1.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cntrl.xml
M      models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850_track1_super_fast_llnl.xml
M      models/atm/cam/bld/build-namelist
 - changes to build-namelist and use cases to be consistent with namelist changes
	
M      models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - update to super_fast_llnl input file
	
M      models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - update chem preprocessor and rrtmg
	
M      models/atm/cam/src/control/wrap_nf.F90
 - added routine to get number of vars in a netcdf file

M      models/atm/cam/src/physics/cam/tropopause.F90
 - added hybrid-stobie method

M      models/atm/cam/src/chemistry/utils/solar_data.F90
M      models/atm/cam/src/physics/cam/physpkg.F90
M      models/atm/cam/src/physics/cam/radsw.F90
M      models/atm/cam/src/physics/cam/radconstants.F90
M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/rrtmg/radconstants.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90
M      models/atm/cam/src/physics/rrtmg/radsw.F90
  - radiation packages camrt and rrtmg both have the ability to use spectral solar variance
  - shortened the routine names in radconstants.F90 to be less than 32 characters (F90 standard limit)

M      models/atm/cam/src/chemistry/pp_trop_mam7/m_rxt_id.F90
M      models/atm/cam/src/chemistry/pp_trop_mam7/mo_sim_dat.F90
M      models/atm/cam/src/chemistry/pp_waccm_mozart/m_rxt_id.F90
M      models/atm/cam/src/chemistry/pp_waccm_mozart/mo_sim_dat.F90
M      models/atm/cam/src/chemistry/pp_super_fast_llnl/m_rxt_id.F90
M      models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_sim_dat.F90
M      models/atm/cam/src/chemistry/pp_trop_mozart/m_rxt_id.F90
M      models/atm/cam/src/chemistry/pp_trop_mozart/mo_sim_dat.F90
M      models/atm/cam/src/chemistry/pp_trop_mam3/m_rxt_id.F90
M      models/atm/cam/src/chemistry/pp_trop_mam3/mo_indprd.F90
M      models/atm/cam/src/chemistry/pp_trop_mam3/mo_sim_dat.F90
M      models/atm/cam/src/chemistry/pp_trop_mam3/chem_mods.F90
 - unified usrrxt tagging scheme
 - ext frc from file added for time-dependent aircraft emissions

M      models/atm/cam/src/physics/cam/modal_aer_opt.F90
M      models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
M      models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
M      models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
M      models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
M      models/atm/cam/src/chemistry/bulk_aero/drydep_mod.F90
M      models/atm/cam/src/chemistry/bulk_aero/dust_sediment_mod.F90
M      models/atm/cam/src/chemistry/bulk_aero/wetdep.F90
M      models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
M      models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
M      models/atm/cam/src/chemistry/bulk_aero/sulchem.F90
M      models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
 - MAM track5 branch mods

M      models/atm/cam/src/chemistry/mozart/mo_photo.F90
 - check for spectral solar data input

M      models/atm/cam/src/chemistry/mozart/mo_jlong.F90
M      models/atm/cam/src/chemistry/mozart/mo_jshort.F90
 - removed woods and neckel etf

M      models/atm/cam/src/chemistry/mozart/mo_airplane.F90
M      models/atm/cam/src/chemistry/mozart/mo_setext.F90
 - check for aircraft input file

M      models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
 - tropopause level passed in
 - call to one usrrxt interface

M      models/atm/cam/src/chemistry/mozart/upper_bc.F90
 - waccm check


M      models/atm/cam/src/chemistry/mozart/mo_cph.F90
 - change in usrrxt label scheme

M      models/atm/cam/src/chemistry/mozart/chemistry.F90
M      models/atm/cam/src/chemistry/mozart/mo_chemini.F90
 - tropopause, woods, neckel namelist vars removed
 - emis namelist var changes

M      models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
M      models/atm/cam/src/chemistry/utils/prescribed_aero.F90
M      models/atm/cam/src/chemistry/utils/tracer_data.F90
M      models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
M      models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
M      models/atm/cam/src/chemistry/mozart/mo_sulf.F90
M      models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M      models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
M      models/atm/cam/src/chemistry/mozart/linoz_data.F90
M      models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
M      models/atm/cam/src/chemistry/mozart/mo_strato_sad.F90
M      models/atm/cam/src/control/cam_history.F90
 - misc cleanup
	
M      models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
 - unified tagging scheme

M      models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
M      models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
 - added capability to specify 'INTERP_MISSING_MONTHS' to the 
   surface and elevated emissions codes  

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7
 - these are expected to due to changes in chemistry configurations
 - the configurations that test cam3 and cam3_5_1 physics pass
	
calgary/lf95:

004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
 - these are expected to due to changes in chemistry configurations
 - the configurations that test cam3 and cam3_5_1 physics pass

calgary/pgi or jaguar/pgi:

004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
 - these are expected to due to changes in chemistry configurations
 - the configurations that test cam3 and cam3_5_1 physics pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_73
Originator(s): eaton
Date: Mon Dec 21 14:01:12 MST 2009
One-line Summary: update prescribed GHG data; update externals; misc fixes

Purpose of changes:

. update external references to be consistent with ccsm4_0_beta37

. Add new timer events for performance evaluation.

. Modify physics buffer error checking in pbuf_add to be consistent with
  code in pbuf_get_fld_idx.  The physics buffer names are assumed to be
  case insensitive.

. Modify code in the parcel_dilute subroutine of zm_conv.F90 to avoid bug
  in cases where the model top is below 40 mb.

Bugs fixed (include bugzilla ID):

. The values of atm_nx and atm_ny were not being set correctly in the
  driver infobuffer for the HOMME dycore.

. The interpic_new Makefile had a bug in the logic for setting netcdf
  default locations.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

. add new IC file for T31 valid at Jan 01.

. update the prescribed GHG data for AR5 20th century runs.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update externals as follows:
  drvseq3_0_40     --> drvseq3_1_08
  clm3_6_54        --> clm3_6_58
  cice4_0_20091104 --> cice4_0_20091202
  docn7_090720     --> docn8_091208
  share3_091026    --> share3_091208
  MCT2_6_0_090317  --> MCT2_6_0_090926
  scripts4_091102  --> scripts4_091208

models/atm/cam/bld/config_files/definition.xml
. allow -ocn to be set to 'docn'.

models/atm/cam/bld/configure
. modify the Filepaths file for the new driver directory structure.
. modify the Filepaths file for the new docn directory.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. Add T31 IC file for Jan 01.
. update bndtvghg to use atm/cam/ggas/ghg_hist_1765-2005_c091218.nc
. update the 1.9x2.5 fsurdat and fpftdyn files.  Last time I tried this I

models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
. update bndtvghg to use atm/cam/ggas/ghg_hist_1765-2005_c091218.nc

models/atm/cam/src/dynamics/atm_comp_mct.F90
. set atm_nx and atm_ny values in infobuffer by using the dyn_grid method
  get_horiz_grid_dim_d.  Remove reference to pmgrid which should not appear
  outside of the dynamics.

models/atm/cam/src/dynamics/homme/stepon.F90
. bugfix from Mark Taylor

models/atm/cam/src/physics/cam/ghg_data.F90
. fixed comment

models/atm/cam/src/physics/cam/phys_buffer.F90
. modify the pbuf_add error checking for a name that's already been defined
  by making the name matching case insensitive.  The code that returns the
  buffer index for a specified name is doing case insensitive matching, so
  pbuf_add needs to be consistent with that.

models/atm/cam/src/physics/cam/tphysac.F90
. add timer events for rayleigh friction and aerosol drydep

models/atm/cam/src/physics/cam/radiation.F90
models/atm/cam/src/physics/rrtmg/radiation.F90
. modify timer events for consistency between rrtmg and camrt code, and to
  separate out the cost of the aerosol optics calc.

models/atm/cam/src/physics/cam/zm_conv.F90
. modify code in parcel_dilute to avoid bug in cases where the model top is
  below 40 mb.

models/atm/cam/tools/interpic_new/Makefile
. fix bug in logic for setting defaults of netcdf lib and inc dirs.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7 at Sat Dec 19 12:37:39 MST 2009
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7 at Tue Dec 15 16:20:16 MST 2009
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7 at Tue Dec 15 16:30:08 MST 2009
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7 at Tue Dec 15 16:36:56 MST 2009
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7 at Tue Dec 15 16:49:22 MST 2009
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7 at Tue Dec 15 16:53:16 MST 2009
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7 at Tue Dec 15 17:05:34 MST 2009
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7 at Tue Dec 15 17:20:21 MST 2009
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7 at Tue Dec 15 17:39:57 MST 2009
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7 at Tue Dec 15 17:53:23 MST 2009
051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7 at Tue Dec 15 17:58:06 MST 2009
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7 at Tue Dec 15 18:36:55 MST 2009

dublin/lf95: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7 at Tue Dec 15 12:56:24 MST 2009
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7 at Tue Dec 15 13:07:32 MST 2009
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Tue Dec 15 14:04:10 MST 2009
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Tue Dec 15 14:47:06 MST 2009
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7 at Tue Dec 15 15:36:47 MST 2009
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7 at Tue Dec 15 15:43:40 MST 2009
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Tue Dec 15 16:00:22 MST 2009

dublin/pgi: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7 at Tue Dec 15 11:47:18 MST 2009
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7 at Tue Dec 15 11:50:23 MST 2009
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7 at Tue Dec 15 12:00:44 MST 2009
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7 at Tue Dec 15 12:06:04 MST 2009
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7 at Tue Dec 15 12:13:03 MST 2009
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7 at Tue Dec 15 12:15:06 MST 2009
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7 at Tue Dec 15 12:16:32 MST 2009

Most of the baseline failures appear to be due to a roundoff level change
introduced into either CLM or CICE.  For resolutions except FV 1.9x2.5 the
diffs don't show up at nstep=0, but are first present at nstep=3.  For the 2
degree FV runs the diffs show up at nstep=0 but just in a few fields, and
the diffs again appear to be roundoff level changes.  I suspect this is due
to updating the 2 degree CLM fsurdat file.

In addition to the differences just mentioned:

bl731 fails due to a homme bug fix.

bl112, bl132, bl312, bl332, bl387 fail due to updating the prescribed GHG
dataset.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: Answers change due to updating externals
and updating the prescribed GHG dataset.  HOMME answers change due to a
bug fix.

===============================================================
===============================================================

Tag name: cam3_6_72
Originator(s): Francis Vitt
Date: 11 Dec 2009
One-line Summary: WACCM changes needed for climate runs.

Purpose of changes:

  - compute "CFC11STAR" for radiation in WACCM configuration
  - adjust inputs to the waccm_1850-2005_track1 use case
  - misc cleanup

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

A   models/atm/cam/src/chemistry/mozart/cfc11star.F90
  - calculates "CFC11STAR" and addes it the the physics buffer for radiation
	
A   models/atm/cam/bld/namelist_files/use_cases/waccm_1850-2005_track1.xml
  - use case added for 1850-2005 transient waccm climate run
	
List all existing files that have been modified, and describe the changes:

M   models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
  - default solar_photons_file added 
  - defaults added for time dependent NO2 and BC aircraft emissions
	
M   models/atm/cam/bld/namelist_files/namelist_definition.xml
  - "ippc_aircraft_emis" variable added which sets the ext_frc namelist
    variables appropriately for the time dependent aircraft emissions
	
M   models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
  - adjustments to the waccm 1850 track1 use case
	
M   models/atm/cam/bld/build-namelist
  - specify "CFC11STAR" radiatively active by default for WACCM
  - added "ipcc_aircraft_emis" namelist variable
  - set xactive_drydep = .true. for waccm
  - as default use the Lean solar data rather than Woods and Neckel data for waccm
	
M   models/atm/cam/src/chemistry/pp_waccm_mozart/mo_indprd.F90
M   models/atm/cam/src/chemistry/pp_waccm_mozart/mo_sim_dat.F90
M   models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mods.F90
  - NO2 external forcing added to mechanism for aircraft emissions
	
M   models/atm/cam/src/chemistry/mozart/woods.F90
  - initialize only if input file is specified

M   models/atm/cam/src/chemistry/mozart/neckel.F90
  - initialize only if input file is specified

M   models/atm/cam/src/chemistry/mozart/chemistry.F90
  - invocations of the cfc11star module
	
M   models/atm/cam/src/chemistry/mozart/llnl_set_chem_trop.F90
  - removed 'chem_trop_linoz' field from default history
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL
  expected failure due to waccm changes in input data and cfc11star 
	
calgary/lf95: all pass
	
calgary/pgi or jaguar/pgi: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_71
Originator(s): Jim Edwards
Date: 12/09/2009
One-line Summary: update homme dycore

Purpose of changes: Update HOMME dycore

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
    Remove homme requirement for lapack library
	
Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
  models/atm/cam/bld/configure
    Removed requirement for lapack
  models/atm/cam/src/control/ncdio_atm.F90
    Moved call to pio_setframe
  models/atm/cam/src/dynamics/homme/
    A host of new features and options added.   
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All pass except
  051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL
	expected failure due to dycore update
	
dublin/lf95: All pass
    
calgary/pgi or jaguar/pgi:  All pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_70
Originator(s): eaton
Date: Tue Dec  8 17:05:37 MST 2009
One-line Summary: fix memory leaks

Purpose of changes:

. fix memory leaks and EUL OMP bug (see below)

. misc configure/Makefile changes:
  - enable building HOMME from CCSM scripts
  - add flexibility to deal with new dycores in set_horiz_grid method
  - remove Switch module from configure due to strange behavior on bluefire

Bugs fixed (include bugzilla ID):

. memory leaks (pointed out by Chuck Bardeen) due to missing deallocation
  of allocated local variables in:
  models/atm/cam/src/chemistry/utils/tracer_data.F90
  models/atm/cam/src/dynamics/fv/dyn_comp.F90
  models/atm/cam/src/physics/cam/polar_avg.F90

. fix OMP directive in eulerian dycore (missing private variable
  declaration) (from Pat Worley)

Describe any changes made to build system: none

Describe any changes made to the namelist:

. add some HOMME initial files

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/doc/ChangeSum
models/atm/cam/doc/Copyright
models/atm/cam/doc/DatasetLog
models/atm/cam/doc/README
. old files relevent to earlier ccm/cam versions

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/Makefile.in
. remove --pca from lf95 debug flags.  Documentation says it overrides the
  effect of --chk a
. remove -DCAM from the CPPDEF macro.  It is only used by HOMME, so is
  added to the USER_CPPDEFS by configure.

models/atm/cam/bld/configure
. Remove check for smp=off when building for scam.  Should run with threads
  enabled even if they aren't kept busy.
. fix set_horiz_grid so that the fv grid recognition is specific to 'fv',
  to allow extension to other dycores that start with fv, like fvcubed.
. add "-DCAM" to the cppdefs for the homme dycore.  It is the only
  component using this macro.  Having configure set the macro means that it
  will be available when running from the CCSM scripts as well as from CAM
  standalone scripts.
. remove use of Switch module.  We ran into some bizzare problems on
  bluefire.  The if/elsif conditional is just as easy to read.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update homme initial files to provide settings for non-aqua-planet runs.

models/atm/cam/src/chemistry/utils/tracer_data.F90
. remove unused allocatable arrays filename and filelist in subroutine
  specify_fields. 

models/atm/cam/src/dynamics/eul/sphdep.F90:
. add S_NVAL to omp private variables at line 413

models/atm/cam/src/dynamics/fv/dyn_comp.F90
. add missing deallocate for phisxy3 in dyn_run

models/atm/cam/src/physics/cam/polar_avg.F90
. deallocate lats, n_pole, s_pole in subroutines polar_average{2,3}d

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

dublin/lf95: All PASS

dublin/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_69
Originator(s): Francis Vitt
Date: 24 Nov 2009
One-line Summary: Updates to super_fast_llnl/LINOZ chemistry 

Purpose of changes:  

Correct the LINOZ code and allow  interactive "super_fast_llnl" chemistry 
to be included in a "track1" coupled CCSM simulation..

The changes are summarized as:
	
 * ISOP added to the super_fast_llnl chemistry mechanism
 * CH4 is now prescribed 
 * The prescribed CH4 is radiatively active
 * LINOZ chlorine loading is now read in from file
 * Use case added for 1850 track 1 with super_fast_llnl chem 
 * FIXED solar data restart bug fix
 * Corrections LINOZ code
 * Added another tropopause method which is used in super_fast_llnl chemistry
 * Added new super_fast_llnl mechanism file to preprocessor 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A   models/atm/cam/bld/namelist_files/use_cases/1850_track1_super_fast_llnl.xml
 - build namelist use case added for track1 with super_fast_llnl chemistry simulation
	
A   models/atm/cam/src/chemistry/mozart/chlorine_loading_data.F90
 - reads in time-dependent chlorine data for LINOZ 
	
List all existing files that have been modified, and describe the changes:


M   models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - default input files added for the prescribed CH4 and chlorine loading used 
   in the super_fast_llnl chemistry
	
M   models/atm/cam/bld/namelist_files/namelist_definition.xml
 - namelist variables added for the chlorine loading input data
	
M   models/atm/cam/bld/build-namelist
 - prognostic SO4 and prescribed CH4 is now radiatively active by default
   for super_fast_llnl chemistry configuration
 - surface emissions for ISOP added to the default super_fast_llnl 
   chemistry namelist
 - vertical emmisions of SO2 and SO4 added to the default 
   super_fast_llnl chemistry namelist
 - prescribed CH4 namelist variable settings added to the default 
   super_fast_llnl chemistry namelist
	
M   models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
 - use the new super_fast_llnl chemistry preprocessor input file
	
M   models/atm/cam/src/chemistry/utils/solar_data.F90
 - FIXED solar data restart bug fix
	
M   models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
 - minor code cleanup
	
M   models/atm/cam/src/chemistry/utils/tracer_data.F90
 - fixed bug in datapath specification
 - out log info in masterproc only

M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lu_solve.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_setrxt.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/m_rxt_id.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_nln_matrix.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_adjrxt.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lu_factor.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_indprd.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_sim_dat.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/m_spc_id.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mods.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_prod_loss.F90
M   models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lin_matrix.F90
 - preproccessor generated file for the new super_fast_llnl chemistry mechanism

M   models/atm/cam/src/chemistry/mozart/lin_strat_chem.F90
 - corrections to the LINOZ code
	
M   models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M   models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
 - fix bug in data_type specifier (INTERP_MISSING_MONTHS)
	
M   models/atm/cam/src/chemistry/mozart/chemistry.F90
 - namelist variables added for chlorine loading inputs
 - subroutine calls added to invoke chlorine loading module
 - default method for tropopause set to "Stobie-LINOZ hybrid"
	
M   models/atm/cam/src/chemistry/mozart/llnl_set_chem_trop.F90
 - "Stobie-LINOZ hybrid" method added to find tropopause
 - diagnostic outputs added
	
M   models/atm/cam/SVN_EXTERNAL_DIRECTORIES
 - updated chemistry preprocessor input files
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All Pass

calgary/lf95: All Pass

calgary/pgi or jaguar/pgi: All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_68
Originator(s): eaton
Date: Thu Nov 19 14:56:35 MST 2009
One-line Summary: tuning for 1.9x2.5 track1 runs

Purpose of changes:

. The default value of rhminl was changed to 0.91, and a multiplier for the
  ice fall velocity in pkg_cld_sediment.F90 was set to 0.5.  Because this
  multiplier depends both on resolution and the physics/chemistry packages
  it was made settable via the namelist.

  These mods only change answers for FV 1.9x2.5 (a.k.a. 2 deg) track1 runs.
  The changes were made so that the tunings for that configuration match
  the ones used in WACCM runs.

. The WACCM use case waccm_1850_track1 was updated to be consistent with
  the prescribed aerosol changes made in the 1850_track1 use case in the
  previous tag.  This will change WACCM answers for runs using that use
  case for all horizontal resolutions except 0.9x1.25.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:

. add namelist group cldsed_nl which includes the variable
  cldsed_ice_stokes_fac used to set the factor applied to the ice fall
  velocity computed from Stokes terminal velocity.

List any changes to the defaults for the boundary datasets:

. defaults for prescribed aerosols changed in waccm_1850_track1 use case.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add an add_default call for cldsed_ice_stokes_fac

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. change cldfrc_rhminl for 1.9x2.5 track1 to match the waccm_mozart value
  of 0.91
. add defaults for cldsed_ice_stokes_fac.  Default remains 1.0 for
  backwards compatibility with older cam physics packages.  Change default
  to 0.5 for any waccm_phys run, and also for 2 degree track1 runs.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add cldsed_ice_stokes_fac

models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
. make the prescribed aerosols consistent with 1850_track1.xml

models/atm/cam/src/control/runtime_opts.F90
. add call to cld_sediment_readnl

models/atm/cam/src/physics/cam/pkg_cld_sediment.F90
. add cld_sediment_readnl to read namelist
. add namelist variable cldsed_ice_stokes_fac to set the factor to be
  applied to the ice fall velocity via the Stokes calculation.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7 at Thu Nov 19 15:05:24 MST 2009

This is a 2 deg track1 baseline which is expected to fail.

**Note**
050 er731 TER.sh h16x4dm aqua 4+5s ................................PASS at Thu Nov 19 15:09:59 MST 2009

We've been seeing some erratic behavior with this test.  I had both failures
and passes of it during testing for the previous tag.  More examination of
this test is needed.

calgary/lf95: All PASS

calgary/pgi or jaguar/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except 2 deg track1 and WACCM runs
using the waccm_1850_track1 use case.

===============================================================
===============================================================

Tag name: cam3_6_67
Originator(s): jedwards, eaton
Date: Wed Nov 18 11:44:51 MST 2009
One-line Summary: update prescribed aerosol and ozone datasets.

Purpose of changes:

. bug fixes and updated datasets -- see below.

Bugs fixed (include bugzilla ID):

. The attributes _FillValue and missing_value were being written to the
  history file as 8-byte reals even when the corresponding data value were
  written as 4-byte reals.  These attributes must match the data type for
  successful post-processing.  This bug was introduced at cam3_6_39 with
  the changes to pio.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. The prescribed aerosol and ozone datasets have been updated.  The new
  data will be the default in the 1850_track1 and 1850_track1_2xco2 use
  cases for all resolutions except FV 0.9x1.25.  This is for backwards
  compatibility with the existing control run.  The new data will be the
  default for the 1850-2005_track1 use case.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
. update prescribed aerosol and ozone datasets

models/atm/cam/bld/namelist_files/use_cases/1850_track1.xml
models/atm/cam/bld/namelist_files/use_cases/1850_track1_2xco2.xml
. update prescribed aerosol and ozone datasets for all resolutions except
  FV 0.9x1.25 (for backwards compatibility with control run).

models/atm/cam/src/control/cam_history.F90
. Fix the real kind of data written to the attributes _FillValue and
  missing_value.
. Remove old logic for "fullgrid".  The reduced grid option is not functional.

models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
. mods from Jim Edwards

models/atm/cam/test/system/TCB.sh
. mod to allow stub ice model

models/atm/cam/test/system/config_files/h16x4dm
models/atm/cam/test/system/config_files/h5x8adm
models/atm/cam/test/system/config_files/h5x8dm
models/atm/cam/test/system/config_files/h5x8idm
. use stub ice and lnd in all these standalone mode configs which
  only supports adiabatic, ideal, or aqua-planet physics.

models/atm/cam/test/system/CAM_runcmnd.sh
models/atm/cam/test/system/test_driver.sh
. add edinburgh

models/atm/cam/test/system/tests_posttag_jaguar_cb
. add cb372


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
004 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7 at Tue Nov 17 15:09:41 MST 2009
006 er731 TER.sh h16x4dm aqua 4+5s ................................FAIL! rc= 10 at Tue Nov 17 15:10:36 MST 2009

bl387 fails because the new prescribed aerosol and ozone datasets changes
answers.

er731 failure is unexplained.  cam3_6_66 is also exhibiting this failure
even though the test passed at the time of that commit on Nov 5.

dublin/lf95: All PASS

dublin/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except configurations using the
updated prescribed aerosol and ozone datasets.

===============================================================
===============================================================

Tag name: cam3_6_66
Originator(s): mvertens, eaton
Date: Thu Nov  5 10:11:53 MST 2009
One-line Summary: add SNOWHICE to diagnostic output; update externals

Purpose of changes:

. Add SNOWHICE to the default monthly avg history output.

. Update externals to be mostly consistent with ccsm4_0_beta33
  drvseq3_0_29      --> drvseq3_0_40
  clm3_6_51         --> clm3_6_54
  cice4_0_20090831  --> cice4_0_20091104
  share3_090825     --> share3_091026
  timing_081221     --> timing_090929
  scripts4_090901a  --> scripts4_091102
  stubs1_1_01       --> stubs1_2_02

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none for CAM

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. remove forganic (no longer used by CLM)

models/atm/cam/bld/configure
. updates for directory paths used by stub components

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update defaults for CLM files

models/atm/cam/bld/namelist_files/namelist_definition.xml
. two driver pio variable name changes

models/atm/cam/src/control/camsrfexch_types.F90
models/atm/cam/src/cpl_mct/atm_comp_mct.F90
models/atm/cam/src/physics/cam/cam_diagnostics.F90
. add SNOWHICE to default monthly avg output

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7 at Thu Nov  5 11:54:53 MST 2009

This failure is due to updating the CICE external.  CICE is run in
prognostic mode in the E compsets (SOM mode).

dublin/lf95: All PASS

dublin/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_65
Originator(s): eaton
Date: Mon Nov  2 14:16:30 MST 2009
One-line Summary: Add output for CCR diagnostics, and to verify forcings
  for 20th century track1 runs.

Purpose of changes:

. Add diagnostic fields needed by the CCR package and for verifying that
  the intended forcings have been used in the track1 20th century
  simulations.
  - The scalar GHG and solar const values were added to history output.
    co2vmr was already there.  The values n2ovmr, ch4vmr, f11vmr, f12vmr,
    sol_tsi have been added to all history files.
  - PRECT was added by default to monthly avg output.
  - The aerosol optical depths (visible) of all species affecting the
    climate have been added by default to the monthly avg output.
  - The ability to output the column burdens of all aerosol and gas species
    that affect the climate was added.  The burdens of SO4 and O3 have been
    added to the default monthly avg file (via fincl1) for the
    1850-2005_track1 use case.  

. Modify regression tests to improve coverage of the production 1850_track1
  and 1850-2005_track1 use cases.

. Mod to configure needed for building for BGL and BGP from CCSM scripts.

. Mods to PGI settings in Makefile.in for consistency with CCSM scripts.

. Misc cleanup

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/test/system/config_files/f1.9c351h
models/atm/cam/test/system/config_files/f1.9c351m
. new files for track1 physics (c351 ==> cam3_5_1)

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/Makefile.in
. PGI settings:
  - change optimization from -fast to -O2 (keep -Mvect=nosse -Kieee)
  - apply the threading options to FFLAGS_NOOPT macro
  - remove special compilation rule for seq_timemgr_mod.o for consistency
    with CCSM build.

models/atm/cam/bld/build-namelist
. fix logic for when defaults are added for co2vmr.  That value is needed
  for the RAMP_CO2_ONLY option and for waccm_mozart which were previously not
  adding defaults for co2vmr (hence the hardcoded value in chem_surfvals
  was being used).
. remove redundant specification of default values for tracer_cnst_type and
  tracer_cnst_ymd which are present in the namelist_defaults_cam.xml file.

models/atm/cam/bld/configure
. Only add the Fortran name mangling macro to the cppdefs list for a cam
  standalone build.  When build from the CCSM scripts they take care of
  setting this macro.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
models/atm/cam/bld/namelist_files/namelist_definition.xml
. add nu_q definition and defaults (for homme)

models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
. add cb_ozone_c and cb_sulf_c to fincl1 list

models/atm/cam/src/chemistry/utils/solar_data.F90
. initialize sol_tsi to -1.0.  Default value set by build-namelist.

models/atm/cam/src/control/cam_history.F90
. add n2ovmr, ch4vmr, f11vmr, f12vmr, sol_tsi

models/atm/cam/src/control/hycoef.F90
. add initializers for module data ps0, psr, and change them to parameters.

models/atm/cam/src/physics/cam/aer_rad_props.F90
. add an add_default call for the individual aerosol optical depth
  (visible) fields.

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. add PRECT to default monthly avg history file

models/atm/cam/src/physics/cam/chem_surfvals.F90
. change initialization values of co2vmr, n2ovmr, ch4vmr, f11vmr, f12vmr to
  -1.0.  The default values are set by build-namelist.

models/atm/cam/src/physics/cam/rad_constituents.F90
. add diagnostics for column burden of both gases and aerosols

models/atm/cam/src/physics/cam/radiation.F90
models/atm/cam/src/physics/rrtmg/radiation.F90
. replace rad_cnst_clim_aer_out by generic rad_cnst_out

models/atm/cam/src/utils/pio_utils.F90
. remove base=0 optional arg that's hardcoded in the init_pio_subsystem
  call. 

models/atm/cam/src/control/runtime_opts.F90
models/atm/cam/src/utils/time_manager.F90
. remove timemgr_preset from time_manager.F90 and remove the call to
  timemgr_preset from subroutine preset in module runtime_opts.  dtime is
  the only thing being set and setting this value has been moved to
  build-namelist.

models/atm/cam/test/system/CAM_runcmnd.sh
. add -d ${CAM_THREADS} to aprun command for hybrid mode.

models/atm/cam/test/system/input_tests_master
. define new tests:
  - sm372 TSM.sh f1.9m fvvp_lb2 9s
  - er372 TER.sh f1.9m fvvp_lb2 4+5s
  - bl372 TBL.sh f1.9m fvvp_lb2 9s
  - eq374 TEQ.sh f1.9m fvvp_lb2 f1.9m fv1d_lb2 9s
  - eq375 TEQ.sh f1.9m fvvp_lb2 f1.9m fvvp_lb0 9s
. change definition:
  - sm379 TSM.sh wm1.9m outfrq3s 9s
    changed to sm379 TSM.sh wm1.9m outfrq3s+waccm_1850_track1 9s
  - er379 TER.sh wm1.9m outfrq3s 4+5s
    changed to er379 TER.sh wm1.9m outfrq3s+waccm_1850_track1 4+5s
  - bl379 TBL.sh wm1.9m outfrq3s 9s
    changed to bl379 TBL.sh wm1.9m outfrq3s+waccm_1850_track1 9s
  - cb386 TCB.sh f1.9m
    changed to cb386 TCB.sh f1.9c351m
  - sm385 TSM.sh f1.9h outfrq24h+1870_control 2m
    changed to sm385 TSM.sh f1.9c351h outfrq24h+1850_track1 2m
  - sm386 TSM.sh f1.9m outfrq24h+1870_control 2m
    changed to sm386 TSM.sh f1.9c351m outfrq24h+1850_track1 2m
  - er385 TER.sh f1.9h outfrq24h+1870_control 1+1m
    changed to er385 TER.sh f1.9c351h outfrq24h+1850_track1 1+1m
  - er386 TER.sh f1.9m outfrq24h+1870_control 1+1m
    changed to er386 TER.sh f1.9c351m outfrq24h+1850_track1 1+1m
  - bl385 TBL.sh f1.9h outfrq24h+1870_control 2m
    changed to bl385 TBL.sh f1.9c351h outfrq24h+1850_track1 2m
  - bl386 TBL.sh f1.9m outfrq24h+1870_control 2m
    changed to bl386 TBL.sh f1.9c351m outfrq24h+1850_track1 2m
  - pf385 TPF.sh f1.9h outfrq24h+1870_control 2m
    changed to pf385 TPF.sh f1.9c351h outfrq24h+1850_track1 2m
  - pf386 TPF.sh f1.9m outfrq24h+1870_control 2m
    changed to pf386 TPF.sh f1.9c351m outfrq24h+1850_track1 2m

models/atm/cam/test/system/tests_posttag_jaguar
. replace sm371 er371 bl371 eq372 eq373
  by      sm372 er372 bl372 eq374 eq375

models/atm/cam/test/system/tests_posttag_jaguar_cb
. remove cb371


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7 at Mon Nov  2 12:49:10 MST 2009
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7 at Mon Nov  2 13:00:02 MST 2009

dublin/lf95: All PASS except:
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7 at Sun Nov  1 12:18:36 MST 2009

dublin/pgi: All PASS except:
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7 at Sat Oct 31 16:46:56 MDT 2009

The above baseline failures are all due to removing the hardcoded GHG
values from the chem_surfvals module and requiring that these values be set
via the namelist.  The failed tests were all making use of the hardcoded
value of co2vmr, and that value changed when the default came from the
namelist.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except for configurations that
were using the hardcoded GHG values in chem_surfvals.

===============================================================
===============================================================

Tag name: cam3_6_64
Originator(s): Francis Vitt
Date: 27 Oct 2009
One-line Summary: Miscellaneous chemistry cleanup and bug fixes

Purpose of changes:

The main purpose is to make waccm physics features available to 
tropospheric chemistry configurations.  The changes are summarized as:

 - added ability to configure waccm physics with any chemistry configuration
 - fix needed to customize chemistry mechanism without dust and sea salt
 - fix needed to get troposphere level with customized chemistry mech without
   prognostic ozone present
 - cleaned up physics/cam/chemistry.F90 -- removed deprecated chemistry code
 - cleaned up aerosol_drydep_intr interface -- removed MODAL_AERO cpp def
 - fix in waccm ctem module for cases where more processors are 
   operating on physics than on dynamics

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D  models/atm/cam/bld/chem_preprocess.pl
  Moved to the bld/perl5lib/Build/ChemPreprocess.pm.

List all subroutines added and what they do:

A  models/atm/cam/bld/perl5lib/Build/ChemPreprocess.pm
  Chemistry preprocessor perl code file was moved to the bld/perl5lib/Build
  subdirectory and implemented as a perl module.  A check for prognostic 
  sea salt and dust was added which was needed for customized chemistry
  mechanisms.

List all existing files that have been modified, and describe the changes:

M  models/atm/cam/bld/configure
M  models/atm/cam/bld/config_files/definition.xml
M  models/atm/cam/bld/config_files/defaults_waccm_ghg.xml
M  models/atm/cam/bld/config_files/defaults_waccm_mozart.xml
  Option "-waccm_phys" was added to get the users the ability to 
  configure with waccm physics for any of the chemistry packages.

M  models/atm/cam/bld/build-namelist
  Set the appropriate gravity wave namelist when configured with -waccm_phys option

M  models/atm/cam/src/control/runtime_opts.F90
  Misc cleanup.  
  Replaced cpp flags WACCM_GHG, WACCM_MOZART with WACCM_PHYS.

M  models/atm/cam/src/control/camsrfexch_types.F90
  Nullify ram1 and fv pointers before they are allocated.

M  models/atm/cam/src/cpl_mct/atm_comp_mct.F90
  Removed DUST and PROGSSLT cpp flags .

M  models/atm/cam/src/physics/cam/initindx.F90
M  models/atm/cam/src/physics/cam/trb_mtn_stress.F90
M  models/atm/cam/src/physics/cam/cldwat2m.F90
M  models/atm/cam/src/physics/cam/physics_types.F90
M  models/atm/cam/src/physics/cam/physpkg.F90
M  models/atm/cam/src/physics/cam/esinti.F90
M  models/atm/cam/src/physics/cam/pkg_cld_sediment.F90
M  models/atm/cam/src/physics/cam/convect_deep.F90
M  models/atm/cam/src/physics/cam/pkg_cldoptics.F90
M  models/atm/cam/src/physics/cam/advnce.F90
M  models/atm/cam/src/physics/cam/cldwat.F90
M  models/atm/cam/src/physics/cam3_6/cldwat2m.F90
M  models/atm/cam/src/dynamics/fv/dp_coupling.F90
  Replaced cpp flags WACCM_GHG, WACCM_MOZART with WACCM_PHYS.
  This makes waccm physics available to tropospheric chemistry
  configurations.

M  models/atm/cam/src/physics/cam/tphysbc.F90
M  models/atm/cam/src/physics/cam/tphysac.F90
  Made clybry_fam module available to TROCHEM configuration.

M  models/atm/cam/src/physics/cam/cloud_fraction.F90
  Cleanup -- removed to not-used waccm check.

M  models/atm/cam/src/physics/cam/chemistry.F90
  Cleanup -- removed to not-used chemistry code .

M  models/atm/cam/src/physics/waccm/ctem.F90
  Fix bug when more PEs are used in physics than in dynamics.

M  models/atm/cam/src/physics/waccm/radheat.F90
  Add a check for waccm heating.
  Misc clean up.

M  models/atm/cam/src/physics/waccm/gw_drag.F90
  Jack Chen's changes:
    1) change the source level of Beres scheme to the top of heating instead of 100 mb.
    2) momentum/energy tendency below gravity wave source level to ensure the
       total momentum/energy of the entire column is conserved.

M  models/atm/cam/src/physics/waccm/qbo.F90
M  models/atm/cam/src/chemistry/mozart/mo_setz.F90
  Misc clean up.

M  models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
  Removed the MODAL_AERO cpp flag from the aerosol_drydep_intr subroutine
  interface.

M  models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M  models/atm/cam/src/chemistry/mozart/llnl_set_chem_trop.F90
  Fixed bug where the tropopause level was not set when mechanism does 
  not have prognostic ozone.

M  models/atm/cam/src/chemistry/mozart/mo_tropopause.F90
  Removed the check for the need for tropopause level.

M  models/atm/cam/src/chemistry/mozart/chemistry.F90
  Made stratosphere aerosol feedback available to troposphere chemistry
  configurations.

M  models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
  Made has_hrates variable public.
	
M  models/atm/cam/src/chemistry/mozart/mo_tuv_inti.F90
  Added "_r8" kind specifier to zero constant.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
 - Failed due to changes in waccm/gw_drag.F90.

calgary/lf95:

034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
 - Failed due to changes in waccm/gw_drag.F90 and physics for waccm_ghg.

calgary/pgi or jaguar/pgi:

034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
 - Failed due to changes in waccm/gw_drag.F90 and physics for waccm_ghg. 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_63
Originator(s):  Jim Edwards
Date: 10-19-2009
One-line Summary: update of tropopause interpolation for cs grids

Purpose of changes: code development and cleanup

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: self

List all subroutines eliminated:
       control/landfrac_file.F90
        no longer used
	
List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

       control/runtime_opts.F90  
       some namelist strings were declared too short for possible options 
	
       control/ncdio_atm.F90
       control/interpolate_data.F90
       control/startup_initialconds.F90
       utils/pio_utils.F90
       dynamics/eul/inidat.F90
       dynamics/homme/inidat.F90
       dynamics/fv/inidat.F90

       code cleanup, added support for files with more than one timelevel
	  	
       physics/cam/tropopause.F90
       physics/cam/phys_prop.F90
       physics/cam/modal_aer_opt.F90
       physics/cam/radae.F90
       update IO method to PIO, update tropopause interpolation to one compatible 
	with unstructured grids.   This change causes some non bfb differences in 
	tropopause level diagnostic fields.

       chemistry/utils/mo_solar_parms.F90
       chemistry/utils/tracer_data.F90
	Update IO method to PIO
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   All pass except
 037 bl371 TBL.sh f1.9dm fvvp_lb2 9s
 041 bl375 TBL.sh f1.9h outfrq24h 2d
 048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s
	
dublin/lf95: All pass except
 004 bl111 TBL.sh e8t5mdm ttrac 9s 
 008 bl112 TBL.sh e8dm ghgrmp 9s 
 014 bl114 TBL.sh e8dm co2rmp 9s 
	
calgary/pgi or jaguar/pgi: All pass except
 004 bl111 TBL.sh e8t5mdm ttrac 9s 
 008 bl112 TBL.sh e8dm ghgrmp 9s 
 014 bl114 TBL.sh e8dm co2rmp 9s 

	All failures due to differences in diagnostic tropopause height fields due to change in
	the interpolation algorythm for climatological tropopause file.  
	These fields are diagnostic only and do not feed back to model prognostics.
	Differences may be greater than roundoff but generally in the 6th digit or less.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_62
Originator(s): Jim Edwards / Pat Worley / Mark Taylor
Date: 8-13-2009
One-line Summary: Homme Dynamics update/ handshake logic update / pio interface update

Purpose of changes: Code development and improvement

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Self

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

       
Changed mpi handshake logic to avoid potential deadlock.
M           18837   models/utils/pilgrim/mod_comm.F90
M           18837   models/atm/cam/src/utils/spmd_utils.F90

Added a timestamp to the status message printed
M           18837   models/atm/cam/test/system/test_driver.sh	


Moved initialization of surface fields sgh, sgh30,and landm from dynamics to physics	
M           18837   models/atm/cam/src/physics/cam/comsrf.F90
M           18837   models/atm/cam/src/physics/cam/physpkg.F90
M           18837   models/atm/cam/src/dynamics/sld/inidat.F90
M           18837   models/atm/cam/src/dynamics/eul/inidat.F90
M           18837   models/atm/cam/src/dynamics/homme/inidat.F90
M           18837   models/atm/cam/src/dynamics/fv/inidat.F90
	
New pio interface no longer requires arrays to be flattened before passing
M           18837   models/atm/cam/src/physics/cam/phys_buffer.F90
M           18837   models/atm/cam/src/control/ncdio_atm.F90
M           18837   models/atm/cam/src/control/cam_history.F90
M           18837   models/atm/cam/src/physics/cam/restart_physics.F90

Message to stdout limited to masterproc	
M           18837   models/atm/cam/src/chemistry/mozart/mo_jlong.F90

Homme dynamics updated with support for tracer/dynamics subcycling
M           18837   models/atm/cam/src/dynamics/homme/external/filter_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/diffusion_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/derivative_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/dimensions_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/coordinate_systems_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/control_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/interpolate_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/element_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/viscosity_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/edge_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
M           18837   models/atm/cam/src/dynamics/homme/dp_coupling.F90
M           18837   models/atm/cam/src/dynamics/homme/stepon.F90
M           18837   models/atm/cam/src/dynamics/homme/dyn_comp.F90
M           18837   models/atm/cam/src/dynamics/homme/restart_dynamics.F90

Updated PIO
M           18837   SVN_EXTERNAL_DIRECTORIES

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   all pass except 
    051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL
    expected due to ongoing development of dycore.
	
dublin/lf95:  all pass    

calgary/pgi or jaguar/pgi: calgary - all pass 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_6_61
Originator(s): pworley
Date: Wed Sep 30 2009
One-line Summary: spectral Eulerian dycore performance optimizations; 
T341 support; new repro_sum option

Purpose of changes: Improve performance of spectral Eulerian dycore when
have exhausted MPI parallelism; introduce new, cheaper, reproducible sum 
option; add support for T341 resolution

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: 

* added OUTER_OMP cpp token to revert to original implementation of 
  OpenMP in spectral Eulerian dycore

Describe any changes made to the namelist:

* added phys_twin_algorithm to cam_inparm to specify whether to use
  twin algorithm in creating physics chunks (potentially overriding default)
	
* added repro_sum_use_ddpdd in cam_inparm to select alternative 
  reproducible sum algorithm

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

* Can improve performance of spectral Eulerian dycore significantly (~2x) 
  on systems with OpenMP parallelism when using large MPI process counts

* Can degrade performance of spectral Eulerian dycore slightly on systems 
  with OpenMP parallelism when using small MPI process counts. Adding
  OUTER_OMP to cpp tokens when compiling will restore original performance

Code reviewed by: self

List all subroutines eliminated:

* usetlbuf in cam/src/control/usetlbuf.c
  call to the routine was eliminated in cam3_4_04. Eliminating file now.

List all subroutines added and what they do:

* fc_gathervc in cam/src/utils/spmd_utils.F90
  flow control gather for character strings

* repro_sum_ddpdd and DDPDD in cam/src/utils/repro_sum_mod.F90
  He and Ding's implementation of the double-double reproducible sum 
  algorithm

* x86_fix_start and x86_fix_end in cam/src/utils/repro_sum_x86.c
  routines to set and restore round-to-double flag in the control word
  of a x86 fpu (required for double-double algorithm)
	
List all existing files that have been modified, and describe the changes:

1) The primary performance optimization has been moving OpenMP off of the loops
that are also decomposed with MPI and onto inner loops. Some of these loops
have also been restructured to improve the effectiveness of the OpenMP 
parallelism. Legacy Cray vectorization and streaming directives were also
removed during this process.

 src/advection/slt/bandij.F90
 src/advection/slt/difcor.F90
 src/advection/slt/kdpfnd.F90
 src/advection/slt/omcalc.F90
 src/advection/slt/pdelb0.F90
 src/advection/slt/plevs0.F90
 src/advection/slt/qmassa.F90
 src/advection/slt/xqmass.F90

 src/dynamics/eul/cubydr.F90
 src/dynamics/eul/cubzdr.F90
 src/dynamics/eul/dyndrv.F90
 src/dynamics/eul/dp_coupling.F90
 src/dynamics/eul/grmult.F90
 src/dynamics/eul/herxin.F90
 src/dynamics/eul/heryin.F90
 src/dynamics/eul/herzin.F90
 src/dynamics/eul/lagyin.F90
 src/dynamics/eul/limdy.F90
 src/dynamics/eul/limdz.F90
 src/dynamics/eul/linemsdyn.F90
 src/dynamics/eul/quad.F90
 src/dynamics/eul/realloc4.F90
 src/dynamics/eul/realloc7.F90
 src/dynamics/eul/scan2.F90
 src/dynamics/eul/scandyn.F90
 src/dynamics/eul/scanslt.F90
 src/dynamics/eul/spegrd.F90
 src/dynamics/eul/sphdep.F90
 src/dynamics/eul/stats.F90
 src/dynamics/eul/tfilt_massfix.F90
 src/dynamics/eul/trjmps.F90
 src/dynamics/eul/tstep.F90

 src/physics/cam/virtem.F90

2) Added support for T341 resolution

 bld/config_files/horiz_grid.xml
 src/dynamics/eul/dycore.F90
 src/physics/cam/cldwat.F90
 src/physics/cam/cloud_fraction.F90
 src/physics/cam/hk_conv.F90
 src/physics/cam/zm_conv.F90

3) Added a flow control version of gather used to determine names of nodes
during intialization

 src/utils/spmd_utils.F90

4) Added DDPDD alternative reproducible sum algorithm. 

 src/utils/repro_sum_mod.F90
 src/utils/repro_sum_x86.c
 src/control/mpishorthand.F

5) Added namelist support for choice of algorithm to use in creating physics
chunks. The default is for lon/lat grids to look for north/south; day/night
"twins" when assigning columns to chunks, and not to do this for unstructured 
grids. Setting phys_twin_algorithm=.true. will force the twin algorithm to be
used. Setting phys_twin_algorithm=.false. will disable the twin algorithm.
Also added namelist support for the DDPDD alternative reproducible
sum algorithm. Setting repro_sum_use_ddpdd=.true. will enable this option.

 bld/namelist_files/namelist_definition.xml
 src/control/runtime_opts.F90

6) MPI communication optimization
 src/dynamics/eul/bndexch.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: PASSED

calgary/lf95: PASSED

calgary/pgi: PASSED

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers:

NONE (bit for bit)

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_6_60
Originator(s): rneale,mvr
Date: Mon Sep 28 2009
One-line Summary: additional output fields for ipcc analysis; fix to scam test; 
code work-arounds to enable testing with intel compilers; adjustment to waccm 
tuning parameter

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/nl_files/scm_prep_35
- removing obsolete namelist options test file
	
List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/config_files/scm64bfbiop_35
M      models/atm/cam/test/system/config_files/e64bfbiop_35
M      models/atm/cam/test/system/input_tests_master
- corrected config settings for testing scam with cam3_5_1 physics

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- change to tuning parameter (rhminl) default for waccm at 1.9x2.5
	
M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
M      models/atm/cam/src/physics/cam/radlw.F90
M      models/atm/cam/src/physics/cam/physpkg.F90
M      models/atm/cam/src/physics/cam/convect_shallow.F90
M      models/atm/cam/src/physics/cam/zm_conv_intr.F90
- added output of fields required for ipcc analysis

M      models/atm/cam/src/dynamics/sld/inidat.F90
M      models/atm/cam/src/dynamics/sld/restart_dynamics.F90
M      models/atm/cam/src/advection/slt/phcs.F90
- code work-arounds to enable testing with intel compilers
	

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:none

calgary/lf95:none

calgary/pgi:none

CAM tag used for the baseline comparison tests if different than previous

Summarize any changes to answers: bfb

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_6_59
Originator(s): jet, jedwards
Date: Tue Sep 15 15:24:42 MDT 2009
One-line Summary:Bug fixes for scam and CAM column output

Purpose of changes:fixes a problem with restarts when using column output
                   and bug fixes for scam aerosol deposition
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:na

Describe any changes made to the namelist:na

List any changes to the defaults for the boundary datasets:na

Describe any substantial timing or memory changes:na

Code reviewed by:jet

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/src/control/cam_history.F90
	fix for column output
M      models/atm/cam/src/utils/spmd_utils.F90
	fix for column output
M      models/atm/cam/src/chemistry/mozart/mo_drydep.F90
	fix for scam dry deposition
M      models/atm/cam/src/dynamics/eul/inidat.F90
	fix for scam dry deposition
M      models/atm/cam/src/dynamics/eul/iop.F90
	fix for scam dry deposition

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:none

calgary/lf95:

calgary/pgi or jaguar/pgi:none

CAM tag used for the baseline comparison tests if different than previous
tag:cam3_6_58

Summarize any changes to answers, i.e.,

	Default model is bfb

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_6_58
Originator(s): eaton, jedwards
Date: Thu Sep  3 11:44:33 MDT 2009
One-line Summary: Update externals; add cloud fraction tuning parameters to namelist.

Purpose of changes:

. Update externals to be consistent with ccsm4_0_beta22:
  cice4_0_20090805 --> cice4_0_20090831
  clm3_6_47        --> clm3_6_51
  drvseq3_0_24     --> drvseq3_0_29
  share3_090706b   --> share3_090825
  scripts4_090722b --> scripts4_090901a

. Move the cloud fraction tuning parameters rhminl, rhminh to the
  namelist.  The code that previously set these parameters in cldfrc_init
  has been replaced by entries in the namelist_defaults_cam.xml file.  The
  logic for supported tunings has been simplified by making use of the
  high level physics package attribute.  So now the default settings are
  available for the track1 and track5 physics packages (corresponding to
  the -phys values cam3_5_1 and cam), and some chemistry packages.  And of
  course the tunings remain resolution dependent.

  Most importantly, when experimenting with tunings for any particular
  model configuration, the user only needs to add values to the namelist
  input rather than having to wade through the quagmire of default settings
  in cldfrc_init in order to modify the source code.

. Modify build-namelist to allow the definition, defaults, and use case
  files to be located in the user source directories (specified via the
  -usr_src argument to configure).

. Some workarounds for the intel compiler.

Bugs fixed (include bugzilla ID):

. Fix problems with column output, including the longstanding restriction
  that column output doesn't work for fields with names that contain the
  underscore character.

. Remove the setting of NF90_NOCLOBBER in calls to nf90_open (this was a
  one line change in cam_history.F90).  NF90_NOCLOBBER is not a valid
  argument to nf90_open, but most netcdf libraries were silently ignoring
  this.  We encountered an error when trying to link with netcdf4 libs that
  were built with hdf5 enabled.


. Fix bug in build-namelist that resulted in the default setting for forganic
  having the inputdata root directory prepended twice.  This only occurred
  when the inputdata root directory was specified as a relative path.

Describe any changes made to build system: none

Describe any changes made to the namelist:

. add outnc_large_files to clm_inparm group

. remove atm_cdf64, ice_cdf64, lnd_cdf64, ocn_cdf64 -- not used

. add cldfrc_rhminl, cldfrc_rhminh for setting cloud fraction tuning
  parameters rhminl and rhminh.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
.  cice4_0_20090805 --> cice4_0_20090831
.  clm3_6_47        --> clm3_6_51
.  drvseq3_0_24     --> drvseq3_0_29
.  share3_090706b   --> share3_090825
.  scripts4_090722b --> scripts4_090901a

models/atm/cam/bld/Makefile.in
. Intel compiler options: move -132 out of FFLAGS and into FIXEDFLAGS.
  This allows the compiler to process lines longer than 132 chars in free
  format source code.
. Add -static-intel to the intel LDFLAGS to get around problem with CGD
  cluster dublin.  Should be temporary.

models/atm/cam/bld/build-namelist
. Fix the default setting for forganic (the inputdata root directory was
  being prepended twice).
. add cldfrc_rhminl and cldfrc_rhminh by default.
. Modify to allow the definition, defaults, and use case files to be
  located in the user source directories (specified via the -usr_src
  argument to configure).

models/atm/cam/bld/configure
. fixed a comment

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add defaults for cldfrc_rhminl, cldfrc_rhminh

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add outnc_large_files to clm_inparm group
. fix documentation for use_64bit_nc
. remove atm_cdf64, ice_cdf64, lnd_cdf64, ocn_cdf64 -- not used
. add cldfrc_rhminl, cldfrc_rhminh

models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
. Replace parameter index reference by a variable index (workaround for
  intel compiler).

models/atm/cam/src/control/cam_history.F90
. Fix problems with column output, including the longstanding restriction
  that column output doesn't work for fields with names that contain the
  underscore character.
. Remove pio_noclobber flag from the call to cam_pio_openfile.

models/atm/cam/src/control/gauaw_mod.F90
. replace a sqrt generic function call by ()**0.5_r16.  Don't know why this
  wasn't working since ifort supports quad precision.

models/atm/cam/src/dynamics/fv/inidat.F90
models/atm/cam/src/dynamics/fv/metdata.F90
. Move pio use association out of subroutines and up to module level
  (workaround for intel compiler).

models/atm/cam/src/physics/cam/cloud_fraction.F90
. set tuning parameters rhminl, rhminh via namelist
  - remove inline code in cldfrc_init for setting rhminl, rhminh 

models/atm/cam/src/physics/cam/phys_buffer.F90
. remove old code for binary restart files
. add ability to break large fields into smaller pieces for writing to
  restart.  If the global field is larger than 4-GB, then try to split it
  up using the last pbuf dimension.  This avoids a size limit imposed by
  the netcdf 64-bit offset format.

models/atm/cam/src/physics/cam/convect_shallow.F90
models/atm/cam/src/physics/cam/phys_debug.F90
models/atm/cam/src/physics/cam/physics_types.F90
models/atm/cam/src/physics/cam/vertical_diffusion.F90
. replace hardcoded constituent indices for cldliq & cldice

models/atm/cam/test/system/test_driver.sh
. changes for intel compiler and for dublin cluster


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7

calgary/lf95: All PASS except
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

dublin/pgi: All PASS except
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

The failed baseline tests are due to updating the CLM and CICE components.
The baseline tests in aqua-planet, ideal, and adiabatic modes all pass.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: new climate due to changes in CLM and
CICE components.

===============================================================
===============================================================

Tag name: cam3_6_57
Originator(s):  Dani Bundy Coleman
Date: 08/13/09
One-line Summary: Add optional ESMFv3 interfaces in order to use the Gregorian calendar 

Purpose of changes: 
To use the Gregorian calendar, CAM must link with the actual ESMF library
instead of the default WRF fortran implementation of it. 
The configure option to do this remains unchanged: 
	-esmf_libdir directory
There is a new configure option:
	-esmf_libvers [ 2 (default) | 3 ]
that is only necessary if configure is unable to determine the library
version through an automatic test.  The default remains esmf_libvers=2 for
compatibility with the WRF implementation of the ESMF library.

This code includes the changes necessary for CAM to run with a Gregorian
calendar (existing namelist variable: calendar = 'GREGORIAN' ) but this
option will fail until the externals (drv,lnd,csm_share) have been updated.
	
Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: 
	Added configure option 	-esmf_libvers [ 2 (default) | 3 ]

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary data set: None

Describe any substantial timing or memory changes: None

Code reviewed by: Eaton

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:
M      models/ocn/dom/ocn_time_manager.F90

M      models/ice/csim4/ice_time_manager.F90
Change ESMF variables from intent(in) to intent(inout) in order to use
ESMF version 3. When using a Gregorian calendar, have time managers
fake day 366 by repeating day 365. This allows the models to run on
leap-years without having to modify the solar zenith angle calculations.

M      models/atm/cam/src/utils/time_manager.F90
In addition to above, trap for Feb 29 of a non-leap year, which
might be invoked legitimately by a routine reading a dataset for a fixed
year (see below).

M      models/atm/cam/bld/configure
Require test of ESMF library when invoked with the existing option
-esmf_libdir in order to test which ESMF version is being used. Required
some re-ordering of flow.  Add option -esmf_libvers [ 2 (default) | 3 ] in
case the test fails.
	   
M      models/atm/cam/bld/Makefile.in
If using the ESMF library, override default linker with ESMF recommendation

M      models/atm/cam/bld/config_files/definition.xml
Add esmf_libvers option

M      models/atm/cam/src/chemistry/mozart/mo_flbc.F90
Trap for Feb 29 of a non-leap year, which might be invoked legitimately by
a routine reading a dataset for a fixed year (see below).

Explanation of the Feb 29 trap:
When using a fixed year from a dataset, these routines create an integer
date by combining the fixed year with the current model day-of-year. 
This fails on Feb 29 of a leap year:
	        e.g.    fixed year      = 1990
	                model date      = 20000229
	                combined date   = 19900229
Since this is an unrealistic date, we trap for it here, using Feb 28
instead of Feb 29. 

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: None

calgary/lf95: None

calgary/pgi or jaguar/pgi: None

CAM tag used for the baseline comparison tests if different than previous
tag: 

Summarize any changes to answers, i.e.,
	Default model is bfb

===============================================================

Tag name: cam3_6_56
Originator(s): Art Mirin
Date: 08/10/2009
One-line Summary: Alternative OpenMP in FV dynamics

Purpose of changes: In FV dynamics, OpenMP is applied in the vertical direction. For example, for
cases with one level per subdomain, OpenMP becomes meaningless. An option has been added to instead
apply OpenMP to horizontal loops throughout sw_core and tp_core. Because this involves whether or
not to include directives, the option is necessarily a compile-time option. In order to apply this
option, one must define the CPP flag INNER_OMP. One should not do this in general, since
for cases where there are enough levels per subdomain to apply OpenMP, there is less OpenMP
overhead applying it vertically. If the user does not define INNER_OMP, the precompiled code
will be identical to the previous tag.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Worley

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
In dynamics/fv, files cd_core.F90 and trac2d.F90 optionally have OpenMP directives removed;
files sw_core.F90 and tp_core.F90 optionally have OpenMP directives added.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

calgary/lf95:

calgary/pgi or jaguar/pgi:

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_55
Originator(s): mvr,eaton,hannay
Date: Thu Aug  6 2009
One-line Summary: Completed update of externals to be consistent with ccsm;
modified machine support in test scripts; new aerosol/ozone datasets; track1 tuning

Purpose of changes:

- Updated externals as follows:
  clm3_6_46        -> clm3_6_47
  cice4_0_20090721 -> cice4_0_20090805

  clm needed update to fix bug in hybrid dynamic pft code; cice needed update to fix 
  bug where lahey detected use of variable with undefined value

- new aerosol and ozone datasets arrived for the 1850-2005 transient runs and for 
  the 2000 climatology - gives new climate
	
- linux cluster bangkok was retired and a new cluster came online (dublin)...
  the test scripts were modified to reflect this

- tuning parameter rhminl was tweaked for track1: 
	for 0.9x1.25:  .91_r8 to .920_r8
	for 1.9x2.5:   .92_r8 to .924_r8
		
Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: new aerosol and ozone datasets

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 
D      models/atm/cam/test/system/tests_pretag_bangkok
- file containing set of required tests removed for retired machine

List all subroutines added and what they do:
A  +   models/atm/cam/test/system/tests_pretag_calgary
- new file for set of required tests on machine calgary
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/CAM_runcmnd.sh
- test scripts modifed for machine changes (bangkok out, dublin in)

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M      models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
- mods to reflect new aerosol and ozone datasets

M      models/atm/cam/src/physics/cam/cloud_fraction.F90
- new setting for tuning parameter rhminl
	
M      SVN_EXTERNAL_DIRECTORIES
 M     .
- updated externals as summarized above.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4c351pdh aqpgro 3s ..............................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7
- baselines (except adiabatic and ideal physics) failed due to new aerosol 
  and ozone datasets; bl387 would've failed anyway due to bug fix
	
dublin/lf95:  
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 5
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 5
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 5
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 5
017 bl115 TBL.sh e8idm idphys 9s ..................................FAIL! rc= 5
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 5
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 5
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 5
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 5
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 5
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 5
- all baselines failed because baseline was not set up to run on dublin;

calgary/pgi: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
- all baselines (except ideal physics) failed due to new aerosol and ozone 
  datasets
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: New climate due to new aerosol and ozone datasets

===============================================================
===============================================================

Tag name: cam3_6_54
Originator(s): eaton
Date: Mon Aug  3 11:23:46 MDT 2009
One-line Summary: Update externals to be consistent with ccsm4_0_beta20.

Purpose of changes:

. Updated externals as follows:
  clm3_6_19        -> clm3_6_46
  cice4_0_20090226 -> cice4_0_20090721
  scripts4_090428  -> scripts4_090722b
  docn7_090107     -> docn7_090720

  **NOTE** clm3_6_46 has a known bug in the hybrid dynamic pft code.
    Consequently this tag should not be used in hybrid mode for transient
    simulations (climatology runs are OK).  The fix will be added to the
    next CAM commit.

. Mods so that SCAM works with the updated CLM and with trop_mam3.

. Added WACCM use case for 1850 track1 simulations.

. Added use case for 1850 track1 w/ 2X CO2 simulations.

. Updated regression tests to use the CCSM version of cprnc.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/namelist_files/use_cases/1850_track1_2xco2.xml
. same as use case 1850_track1 except double the CO2 value

models/atm/cam/bld/namelist_files/use_cases/waccm_1850_track1.xml
. use case for waccm 1850 track1 runs

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. updated externals as summarized above.

models/atm/cam/bld/build-namelist
. add code to use sim_year in generating the clm namelist
. update code for clm namelist to be consistent with clm3_6_46
. add -DCO2A to the cppdefs.  The clm namelist is now being set with the 
  variable co2_type='diagnostic' so it always listens to the atm to recieve
  the surface CO2 concentration.  -DCO2A is needed when building the
  coupler to make sure these fields are always allocated.
. added capability to not include the aerosol deposition dataset in the CLM
  namelist when CAM will provide the deposition fluxes to the coupler.
  Note: due to CLM bug the aerosol deposition dataset currently needs to be
  added to the CLM namelist whether it's used or not.

models/atm/cam/bld/configure
. define -DCO2A for building the cpl7 code.  This is currently the only BGC
  option implemented.
. change -DMAXPATCH_PFT=4 to -DMAXPATCH_PFT=numpft+1 for CLM build.
. add new CLM directory for mct or esmf component interface.
. add new CICE directories for mct or esmf component interface.
. hack to modify output of CICE configure in SCAM mode since the CICE
  configure doesn't support SCAM mode.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update clm defaults for consistency with clm3_6_43

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add sim_year
. remove old clm variables: csm_doflxave, irad
. add new clm variables: rtm_nsteps, urban_hac, urban_traffic

models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
models/atm/cam/bld/namelist_files/use_cases/1850_track1.xml
models/atm/cam/bld/namelist_files/use_cases/1870-2000_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_bam.xml
models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cntrl.xml
. add setting for sim_year

models/atm/cam/src/control/cam_restart.F90
. move 'use pio' for intel compiler workaround

models/atm/cam/bld/build-namelist
models/atm/cam/src/chemistry/mozart/mo_drydep.F90
models/atm/cam/src/chemistry/utils/tracer_data.F90
models/atm/cam/src/control/history_defaults.F90
models/atm/cam/src/control/scamMod.F90
models/atm/cam/src/dynamics/eul/diag_dynvar_ic.F90
models/atm/cam/src/dynamics/eul/inidat.F90
models/atm/cam/src/dynamics/eul/iop.F90
models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
models/atm/cam/src/physics/cam/initindx.F90
models/atm/cam/test/system/nl_files/scm_prep
models/atm/cam/test/system/nl_files/scm_prep_35
. mods for SCAM

models/atm/cam/test/system/CAM_compare.sh
. update to parse output from cprnc version:
  https://svn-ccsm-models.cgd.ucar.edu/tools/cprnc/trunk_tags/cprnc_081022

models/atm/cam/test/system/CAM_runcmnd.sh
. modify run commands for bluefire to use the environment variable
  TARGET_CPU_LIST and add absolute paths to "launch" and "hybrid_launch"

models/atm/cam/test/system/test_driver.sh
. update the location of the cprnc executable


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
046 er387 TER.sh f1.9c351dh outfrq3s+1850-2005_track1 4+5s ........FAIL! rc= 10
047 br387 TBR.sh f1.9c351dh outfrq3s+1850-2005_track1 6+3s ........FAIL! rc= 12
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 7
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 5

The baseline failures are all expected due to the new climate of the CLM
tag.

er387, br387, bl387 are all failing due to the bug in clm3_6_46.

calgary/lf95:  not done
There are currently problems with the mpich installation under lf95 on
calgary (since the OS upgrade).

calgary/pgi: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

These baseline failures are expected due to the new climate of CLM.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: New climate due to updated CLM external.

===============================================================
===============================================================

Tag name: cam3_6_53
Originator(s): Jim Edwards, Mark Taylor, Pat Worley, Jerry Olson
Date:  7-23-09
One-line Summary: Update of homme dynamics, 
	          correction of column output, 
	          improvement of load balance initialization

Purpose of changes:

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:  Updated build paths for calgary

Describe any changes made to the namelist: Updated defaults for homme dycore, 
	                                   reimplimented use_64bit_nc namelist flag  
	                                   (this flag was disabled in cam3_6_39)

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: originators

List all subroutines eliminated:  
-   subroutine xzy_to_xyz (xyzbuf, xzybuf, dimind)
-   subroutine loc_xzy_to_xyz (xyzbuf, xzybuf, dimind)
-   subroutine loc_xyz_to_xzy (xzybuf, xyzbuf, dimind)
    dead code in cam_history.F90

List all subroutines added and what they do:
	
List all existing files that have been modified, and describe the changes:

	updated build paths for calgary. 
	
       models/atm/cam/test/system/CAM_compare.sh
       models/atm/cam/test/system/test_driver.sh
       models/atm/cam/test/system/CAM_runcmnd.sh

       modified build defaults for homme dycore
	
       models/atm/cam/bld/config_files/horiz_grid.xml
       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml

       Column output is unsupported for unstructured grids, added error checking on
       fincllonlat
	
       models/atm/cam/src/control/runtime_opts.F90

       Changed default value of use_64bit_nc to true
	
       models/atm/cam/src/control/cam_control_mod.F90

       Added error checking for the case of a filename which exceeds the variable length
	
       models/atm/cam/src/control/ioFileMod.F90

       added BGP to supported platforms
       models/atm/cam/src/control/print_memusage.F90


       Corrected location of column data output, new locations were verified by
       comparing netcdf column output to global output file using chkcol.ncl
	
       models/atm/cam/src/control/cam_history.F90
       models/atm/cam/src/utils/pio_utils.F90

       Added code so that if the proc_name count exceeds 256 only the first 256 are printed to the log
	
       models/atm/cam/src/utils/spmd_utils.F90

       improved initialization of load balancing scheme, especially for high task counts and 
       unstructed dycores.
       models/atm/cam/src/physics/cam/phys_grid.F90
       models/atm/cam/src/dynamics/homme/dyn_grid.F90
	

       development update of homme dycore.  	
       models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
       models/atm/cam/src/dynamics/homme/external/reduction_mod.F90
       models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
       models/atm/cam/src/dynamics/homme/external/cube_mod.F90
       models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
       models/atm/cam/src/dynamics/homme/external/element_mod.F90
       models/atm/cam/src/dynamics/homme/external/viscosity_mod.F90
       models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
       models/atm/cam/src/dynamics/homme/external/edge_mod.F90
       models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
       models/atm/cam/src/dynamics/homme/stepon.F90
       models/atm/cam/src/dynamics/homme/inidat.F90
       models/atm/cam/src/dynamics/homme/dyn_comp.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
  051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
  Fails due to update of homme dycore

	
  052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
  053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
  054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
  055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
  056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
  Preexisting failures
	
calgary/lf95:
   all pass

calgary/pgi or jaguar/pgi:
  all pass

CAM tag used for the baseline comparison tests if different than previous
tag:  cam3_6_51 (no relevent changes in cam3_6_52)

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_52
Originator(s): eaton
Date: Thu Jul 23 11:19:58 MDT 2009
One-line Summary: fix filepath for builds from ccsm scripts

Purpose of changes: fix filepath for builds from ccsm scripts

Bugs fixed (include bugzilla ID): 

. CAM's configure was not producing the correct filepath when run from the
  CCSM scripts (with -ccsm_seq flag).

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/configure
. fix filepath for ccsm mode

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: not done

calgary/lf95: not done

calgary/pgi or jaguar/pgi: not done

No regression testing was done for this tag.  The change only affects the
ccsm tests and they are currently failing for other reasons.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_51
Originator(s): jedwards, eaton
Date: Tue Jul 21 14:04:05 MDT 2009
One-line Summary: fixes for history buffer restart files

Purpose of changes:

. Finish fixing the bug in the history buffer restart files.  The first
  part of this fix was made in cam3_6_49.

. Update externals:
  drvseq3_0_14     -> drvseq3_0_24
  pio50_prod       -> pio51_prod
  share3_090112    -> share3_090706b

Bugs fixed (include bugzilla ID): see above

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

. reduce memory requirement for unstructured grids by writing the global
  lat, lon, and area fields one at a time.

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update driver, csm_share, and pio

models/atm/cam/src/control/cam_history.F90
. fix for history buffer restart files
. reduce memory requirement for unstructured grids by writing the global
  lat, lon, and area fields one at a time.

models/atm/cam/src/utils/pio_utils.F90
. removed some commented code

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
050 er731 TER.sh h16x4dm aqua 4+5s ................................FAIL! rc= 10
051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

The ccsm test failures are pre-existing.

Jim Edwards will address the homme test failures in his upcoming commit.

calgary/lf95: All PASS

calgary/pgi: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_50
Originator(s): Francis Vitt
Date: 14 July 2009
One-line Summary:
	
  Cleanup the old CAM3 prognostic aerosol code files and use
  the chemistry preprocessor only when customizing the chemistry.

Purpose of changes:
	
  The old CAM3 prognostic aerosol routines have been replicated 
  in the MOZART chemistry framework.  The deprecated configure and
  run-time options and source code have been removed to improve
  maintainability.

  The configure script only invokes the chemistry preprocessor only 
  when the chemistry is customized which is done by providing the code files 
  generated by the preprocessor for the pre-defined chemistry packages.
  The purpose of this is to avoid portability and long path name issues 
  associated with the chemistry preprocessor and shorten the configure time.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
  Removed deprecated prog_aero configure option

Describe any changes made to the namelist:
  Removed the namelist variables:
    aero_carbon
    aero_dust
    aero_progsslt
    aero_sea_salt
    bndtvdms
    bndtvoxid
    bndtvsox
    caer_emis
    rampyear_prognostic_sulfur
    scenario_prognostic_sulfur
	
  Moved namelist variable soil_erod form cam_inparm to chem_inparm
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D    models/atm/cam/src/physics/cam/progseasalts_intr.F90
D    models/atm/cam/src/physics/cam/drydep_mod.F90
D    models/atm/cam/src/physics/cam/dust_sediment_mod.F90
D    models/atm/cam/src/physics/cam/wetdep.F90
D    models/atm/cam/src/physics/cam/dust_intr.F90
D    models/atm/cam/src/physics/cam/aerosol_intr.F90
D    models/atm/cam/src/physics/cam/sulchem.F90
These have moved to models/atm/cam/src/chemistry/bulk_aero
	
D    models/atm/cam/src/physics/cam/acbnd.F90
D    models/atm/cam/src/physics/cam/dmsbnd.F90
D    models/atm/cam/src/physics/cam/caer.F90
D    models/atm/cam/src/physics/cam/sulfur_intr.F90
D    models/atm/cam/src/physics/cam/sulemis.F90
D    models/atm/cam/src/physics/cam/sulbnd.F90
D    models/atm/cam/src/physics/cam/seasalt_intr.F90
D    models/atm/cam/src/physics/cam/soxbnd.F90
D    models/atm/cam/src/physics/cam/caerbnd.F90
D    models/atm/cam/src/physics/cam/carbon_intr.F90
These deprecated module files have been removed.

D    models/atm/cam/src/chemistry/trop_mam3
D    models/atm/cam/src/chemistry/trop_bam
These directories have been replaced by pp_trop_mam3 and pp_trop_bam.
	
List all subroutines added and what they do:

A    models/atm/cam/src/chemistry/bulk_aero
A    models/atm/cam/src/chemistry/bulk_aero/progseasalts_intr.F90
A    models/atm/cam/src/chemistry/bulk_aero/drydep_mod.F90
A    models/atm/cam/src/chemistry/bulk_aero/dust_sediment_mod.F90
A    models/atm/cam/src/chemistry/bulk_aero/wetdep.F90
A    models/atm/cam/src/chemistry/bulk_aero/dust_intr.F90
A    models/atm/cam/src/chemistry/bulk_aero/aerosol_intr.F90
A    models/atm/cam/src/chemistry/bulk_aero/sulchem.F90
These are the CAM3 aerosol module files that are used within the MOZART 
chemistry framework.

A    models/atm/cam/src/chemistry/pp_trop_mozart
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_trop_mozart/mo_lin_matrix.F90
These are the preprocessor generated code files for the trop_mozart 
chemistry package.

A    models/atm/cam/src/chemistry/pp_trop_bam
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_trop_bam/mo_lin_matrix.F90
These are the preprocessor generated code files for the trop_bam
chemistry package.

A    models/atm/cam/src/chemistry/pp_trop_mam3
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_trop_mam3/mo_lin_matrix.F90
These are the preprocessor generated code files for the trop_mam3
chemistry package.

A    models/atm/cam/src/chemistry/pp_trop_mam7
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_trop_mam7/mo_lin_matrix.F90
These are the preprocessor generated code files for the trop_mam7
chemistry package.

A    models/atm/cam/src/chemistry/pp_trop_ghg
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_trop_ghg/mo_lin_matrix.F90
These are the preprocessor generated code files for the trop_ghg 
chemistry package.

A    models/atm/cam/src/chemistry/pp_super_fast_llnl
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_super_fast_llnl/mo_lin_matrix.F90
These are the preprocessor generated code files for the super_fast_llnl 
chemistry package.

A    models/atm/cam/src/chemistry/pp_waccm_mozart
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_waccm_mozart/mo_lin_matrix.F90
These are the preprocessor generated code files for the waccm_mozart 
chemistry package.

A    models/atm/cam/src/chemistry/pp_waccm_ghg
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_lu_solve.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_setrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/m_rxt_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_phtadj.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_nln_matrix.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_adjrxt.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/m_het_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_lu_factor.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_indprd.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_sim_dat.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/m_spc_id.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_imp_sol.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/chem_mods.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_prod_loss.F90
A    models/atm/cam/src/chemistry/pp_waccm_ghg/mo_lin_matrix.F90
These are the preprocessor generated code files for the waccm_ghg
chemistry package.

List all existing files that have been modified, and describe the changes:

U    models/atm/cam/bld/configure
Removed prog_aer option
Invoke chem preprocessor only when chem package is customized
	
	
U    models/atm/cam/bld/config_files/definition.xml
Removed prog_aer configure option

U    models/atm/cam/bld/config_files/defaults_trop_mozart.xml
Made 1.9x2.5 the default resolution for trop_mozart chemistry
	
U    models/atm/cam/bld/namelist_files/namelist_definition.xml
Removed the CAM3 prognostic aerosol namelist variables listed above.
Moved soil_erod namelist varible to chem_inparm namelist
	
U    models/atm/cam/bld/build-namelist
Removed the old prognostic aerosol code
	
U    models/atm/cam/bld/perl5lib/t/config_definition.xml
Removed prog_aero configure option

U    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
Modified chemistry preprocessor to handle longer path names

U    models/atm/cam/src/control/runtime_opts.F90
Removed the namelist variables listed above
Moved soil_erod namelist varible to chem_inparm namelist

U    models/atm/cam/src/control/filenames.F90
Remove the deprecated prognostic aerosol input file names
	
U    models/atm/cam/src/physics/cam/tropopause.F90
Changed tropLev from real(r8) to integer since this is used to index arrays.

U    models/atm/cam/src/physics/cam/advnce.F90
Removed the deprecated aerosol_time_interp subroutine call
	
U    models/atm/cam/src/physics/cam/tphysac.F90
Removed the deprecated aerosol_srcsnk_intr subroutine call

U    models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
Changed tropLev from real(r8) to integer (see tropopause.F90).

U    models/atm/cam/src/chemistry/modal_aero/modal_aero_deposition.F90
Fixed for trop_mam7 configuration.

U    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
Removed code that checks the deprecated prognostic aerosol namelist settings
	
U    models/atm/cam/src/chemistry/mozart/chemistry.F90
Moved soil_erod namelist varible from cam_inparm to chem_inparm namelist

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: pre-existing failures
052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL!   rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL!   rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL!   rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL!   rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL!   rc= 4

calgary/lf95: All Pass

calgary/pgi or jaguar/pgi:
	
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL!   rc= 7
This fails due to the difference in molecular masses in the preprocessor generated 
code produced by different compilers.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bit-for-bit

===============================================================
===============================================================

Tag name: cam3_6_49
Originator(s): jedwards, eaton
Date: Wed Jul  8 12:15:07 MDT 2009
One-line Summary: fixes for history buffer restart files

Purpose of changes:

. Some bugs have been discovered in the netcdf history buffer restart
  files.  Restart failures can occur when multiple time samples are being
  written to a history file, and the restart occurs at a point when the
  history buffers must be written to a restart file.

  This commit fixes part of the problem, i.e., the errors encountered when
  trying to write some history buffer restart files.  But there is an
  outstanding problem which will be fixed in a subsequent commit, i.e.,
  some history buffer restart files will contain corrupted data which
  impacts the next time sample written in the sequence.  Things are OK for
  subsequent time samples until another restart occurs.  The workaround is
  to use mfilt=1 for all history files that use averaging periods which
  will require writing a history buffer restart file.

. Update to pio50_prod

. Some logfile cleanup.

Bugs fixed (include bugzilla ID): see above

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update pio external to pio50_prod

models/atm/cam/bld/build-namelist
. bugfix: don't fail when the use case file is missing a default value that
  has already been supplied by the user via the -namelist or -infile args.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. Add 'B' as a valid value of avgflag_pertape

models/atm/cam/src/chemistry/mozart/spedata.F90
. add some initializers for filename variables

models/atm/cam/src/control/cam_history.F90
. fixes for history buffer restart files

models/atm/cam/src/control/runtime_opts.F90
. logfile output cleanup

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except pre-existing failures:

052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

calgary/lf95: All PASS.

calgary/pgi: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_48
Originator(s): mvr
Date: 6/25/2009
One-line Summary: bug fix for proper selection of cam initial files with ccsm; remove 
	-Mrecursive from pgi debug build; prep code for intel compilers

Purpose of changes: 
intel compilers limit line length to 132 chars; also, code work-arounds were required in 
some instances of use association and array subscripting

the use of -Mrecursive was tripping up a cam regression test (with pgi); after discussion 
it was deemed unneccessary for debug builds
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist:
- replaced a bad T42 cam initial dataset as the default for jan 1 startdates, 26levs

List any changes to the defaults for the boundary datasets:
- replaced a bad T42 cam initial dataset as the default for jan 1 startdates, 26levs

Describe any substantial timing or memory changes: none
 
Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/test/system/test_driver.sh
- fix for invocation of 'showproj' to enable grabbing default charge account on jaguar

M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TER.sh
- bug fix to setting of tasks/threads when testing restarts and branches
	
M      models/atm/cam/bld/Makefile.in
- removed '-Mrecursive' from pgi debug compilation flags
- made 'icc' the default c compiler for ifort builds
	
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- replaced a bad T42 cam initial dataset as the default for jan 1 startdates, 26levs
	
M      models/atm/cam/bld/cam.cpl7.template
- bug fix for ccsm to grab correct cam initial file based on start date
	
M      models/atm/cam/src/cpl_mct/atm_comp_mct.F90
M      models/atm/cam/src/chemistry/mozart/spedata.F90
M      models/atm/cam/src/dynamics/eul/inidat.F90
M      models/atm/cam/src/dynamics/eul/restart_dynamics.F90
- workaround for use association of pio module

M      models/atm/cam/src/physics/cam/sulchem.F90
M      models/atm/cam/src/physics/cam/eddy_diff.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90
M      models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
M      models/atm/cam/src/chemistry/mozart/chemistry.F90
M      models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
- trim line lengths to <132 chars
	
M      models/atm/cam/src/chemistry/mozart/mo_photoin.F90
M      models/atm/cam/src/chemistry/mozart/mo_setaer.F90
M      models/atm/cam/src/chemistry/mozart/mo_photo.F90
- workaround for array subscripting
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   All pass except 
	052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
        053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
        054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
        055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
        056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
failures are pre-existing
	
calgary/lf95: All pass 
	
calgary/pgi: All pass except
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 5
failed due to problem in baseline code that has been fixed with removal of -Mrecursive flag

	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): b4b

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_47
Originator(s): Jim Edwards
Date: 6/15/2009
One-line Summary: Fix model column output problem on restart

Purpose of changes: 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist: 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: New PIO external should improve io performance.
 
Code reviewed by: self

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
           cam_history.F90  - improved support for outputing single columns or block subsets
	                      of model fields.  Outputing columns was causing model failure on
	                      restart.  
	   test/system/nl_files/ghgrmp - added code to test column output so that this test
	                      becomes a regular part of precommit and postcommit cam testing
           SVN_EXTERNAL_DIRECTORIED - updated pio external
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   All pass except 
        004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
        019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7


	052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
        053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
        054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
        055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
        056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

calgary/lf95: All pass except
       008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
       029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7

	
calgary/pgi or jaguar/pgi:
       008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
       029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
       032 sm314 TSM.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 8
       033 er314 TER.sh wg10dm outfrq3s 4+5s .............................FAIL! rc= 5 
       034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 4


The ghgrmp baseline tests fail due to the addition of a new history file for column output
	all results in the existing files are BFB.  Bluefire 052-056 and calgary 032-034 are
	legacy failures.

	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_46
Originator(s): Francis Vitt
Date: 12 June 2009
One-line Summary: WACCM updates

Purpose of changes:
 Bring the trunk up to date with waccm branch.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

A    models/atm/cam/bld/namelist_files/use_cases/waccm_1850_cntrl.xml
 - for ccsm 1850 "track 1" simulation
	
List all existing files that have been modified, and describe the changes:

M       models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
 - Corrected RSF photolysis file
	
M       models/atm/cam/src/chemistry/mozart/linoz_data.F90
M       models/atm/cam/bld/namelist_files/namelist_definition.xml
 - INTERP_MISSING_MONTHS option added
	
M       models/atm/cam/src/chemistry/mozart/mo_sad.F90
 - corrected strat aero rad forcing

M       models/atm/cam/bld/namelist_files/use_cases/waccm_refb1.xml
M       models/atm/cam/bld/build-namelist
M       models/atm/cam/src/physics/cam/radsw.F90
M       models/atm/cam/src/physics/cam/phys_control.F90
M       models/atm/cam/src/physics/cam/solvar_interface.F90
M       models/atm/cam/src/physics/cam/cloud_fraction.F90
M       models/atm/cam/src/physics/cam/tidal_diag.F90
M       models/atm/cam/src/physics/cam/vertical_diffusion.F90
M       models/atm/cam/src/physics/waccm/gw_drag.F90
M       models/atm/cam/src/chemistry/utils/mo_solar_parms.F90
M       models/atm/cam/src/chemistry/mozart/solar_photons.F90
M       models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
M       models/atm/cam/src/chemistry/mozart/solvar_interface.F90
M       models/atm/cam/src/chemistry/mozart/chemistry.F90
M       models/atm/cam/src/chemistry/mozart/solvar_data.F90
M       models/atm/cam/src/dynamics/fv/pfixer.F90
M       models/atm/cam/src/dynamics/fv/cd_core.F90
 - merged in mods from waccm16_cam3_5_48
 - enabled stratospheric aerosols radiation feedback 

M       models/atm/cam/src/chemistry/mozart/spedata.F90
 - write spedata log messages only from masterproc  

M       models/atm/cam/src/control/cam_history.F90
 - change to appease Lahey compiler

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
 expected to fail due to waccm updates

052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

calgary/lf95:

034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
 This is expected to fail due to parameter changes in waccm gravity wave routine.

calgary/pgi or jaguar/pgi:

032 sm314 TSM.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 8
033 er314 TER.sh wg10dm outfrq3s 4+5s .............................FAIL! rc= 5
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 4

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_45
Originator(s): eaton
Date: Thu Jun 11 12:35:34 MDT 2009
One-line Summary: bugfix for branch runs via ccsm scripts

Purpose of changes:

. The camdom component isn't using netcdf for its restart files.  Need to
  back out the change in cam.cpl7.template that assumed it was.

Bugs fixed (include bugzilla ID): see above

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/cam.cpl7.template
. remove ".nc" from value of nrevsn_dom_nml

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: not done

calgary/lf95: not done

calgary/pgi or jaguar/pgi: not done

No regression testing was done for this tag because the change in
cam.cpl7.template is only tested via the ccsm scripts, and our tests of the
ccsm scripts are currently failing for other reasons.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_44
Originator(s): eaton
Date: Wed Jun 10 11:29:39 MDT 2009
One-line Summary: Add directories to enable optional esmf component interfaces.

Purpose of changes:

. For each component the directories cpl_mct and cpl_esmf are added.  The
  current mct based component interfaces (in the modules xxx_comp_mct.F90)
  are moved to the cpl_mct directory.  The esmf component interfaces will
  be added to the cpl_esmf directories.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:

. Add -comp_intf argument to configure.  Once the esmf interfaces are in
  place, they will be used by adding "-comp_intf esmf" to the configure
  commandline. 

. Add BGP and BGL support to Makefile for chemistry preprocessor

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/control/atm_comp_mct.F90
models/ice/csim4/ice_comp_mct.F90
models/ocn/dom/ocn_comp_mct.F90
. These files were moved to the new cpl_mct directories.

models/ocn/som/mixed_layer.F90
models/ocn/som/ocn_filenames.F90
models/ocn/som/ocn_spmd.F90
models/ocn/som/ocn_types.F90
models/ocn/som/ocn_time_manager.F90
models/ocn/som/somint.F90
models/ocn/som/ocn_constants.F90
models/ocn/som/ocn_comp.F90
models/ocn/som/ocean_data.F90
models/ocn/som/somini.F90
models/ocn/som/ocn_comp_mct.F90
. remove unused som code

List all subroutines added and what they do:

models/atm/cam/src/cpl_mct/atm_comp_mct.F90
models/ice/csim4/cpl_mct/ice_comp_mct.F90
models/ocn/dom/cpl_mct/ocn_comp_mct.F90
. These files were moved into the new cpl_mct directories, and the SEQ_MCT
  ifdefs were removed.

List all existing files that have been modified, and describe the changes:

models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. chem_proc -> trunk_tags/chem_proc3_6_01

models/atm/cam/bld/configure
. add new option comp_intf to select which component interfaces to use.
  Can be set to either mct or esmf.  Default: mct.
. modify filepaths for cam, dom, and csim4 to use the cpl_* directories.
  Wait to update the filepaths for other components until updating the
  externals to versions that have the cpl_* directories implemented.  Once
  this is done the -DSEQ_MCT can be removed from Makefile.in.

models/atm/cam/bld/config_files/definition.xml
. add comp_intf parameter w/ valid values mct or esmf.  Default is mct.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

These are pre-existing failures.

calgary/lf95: All PASS

calgary/pgi: All PASS except:
032 sm314 TSM.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 8
033 er314 TER.sh wg10dm outfrq3s 4+5s .............................FAIL! rc= 5
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 4

These are pre-existing failures.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_43
Originator(s): eaton, mirin
Date: Thu Jun  4 12:50:57 MDT 2009
One-line Summary: Misc bug fixes.

Purpose of changes:

. Workaround for PGI compiler bug.

. Fix bug in hfilename_spec.  User specification of history filenames was
  being ignored.

. Change to BG/L section of Makefile.in (Mirin).

Bugs fixed (include bugzilla ID):

. hfilename_spec wasn't being recognized.  There was a missing broadcast of
  the namelist variable.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/Makefile.in
. change compilers for BG/L to mpxlf90 and mpxlc

models/atm/cam/src/control/cam_history.F90
. remove LLNL_PELOTON

models/atm/cam/src/control/runtime_opts.F90
. add an mpi broadcast for hfilename_spec

models/atm/cam/src/dynamics/fv/metdata.F90
. remove unneeded use shr_kind_mod declarations.  This is a workaround for
  a pgi compiler bug, but resulting code is cleaner.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

These are pre-existing failures.

calgary/lf95: All PASS

calgary/pgi: All PASS except
032 sm314 TSM.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 8
033 er314 TER.sh wg10dm outfrq3s 4+5s .............................FAIL! rc= 5
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 4

sm314 is a pre-existing failure.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB.

===============================================================
===============================================================

Tag name: cam3_6_42
Originator(s): eaton, sawyer, mvertens, mvr
Date: Tue Jun  2 09:27:01 MDT 2009
One-line Summary: Fixes for ccsm branch runs, intel compiler, low order FV interpolation.

Purpose of changes:

. Fix bug in cam.cpl7.template to restore branch run functionality to ccsm
  scripts (mvertens)

. Fixes for intel compiler.

. Bug fixes from Will Sawyer for low order interpolation options in the FV
  dycore. 

. Update default 1 degree SST climatology dataset (mvr).

Bugs fixed (include bugzilla ID): 970

. 970 - fix cam.cpl7.template to restore branch runs

. Fixes for intel compiler include reformatting lines longer than 132
  characters and replacing the LLNL_PELOTON fix with a more generic one.

. Fix problems in FV dycore with setting iord/jord equal to 1 or 2.
  Problems were due to indexing bugs.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. Update the default 1 degree SST dataset to
  sst_HadOIBl_bc_0.9x1.25_clim_c040926a.nc.  This is the same as the
  c040926 version except that the calendar attribute has been added to the
  time coordinate variable.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton, mirin (FV indexing)

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/cam.cpl7.template
. add ".nc" suffixes to nrevsn* values

models/atm/cam/src/dynamics/fv/cd_core.F90
models/atm/cam/src/dynamics/fv/sw_core.F90
models/atm/cam/src/dynamics/fv/tp_core.F90
. fixes for low order interpolation schemes.

models/atm/cam/bld/Makefile.in
models/atm/cam/src/chemistry/utils/tracer_data.F90
models/atm/cam/src/control/hycoef.F90
models/atm/cam/src/dynamics/fv/restart_dynamics.F90
models/atm/cam/src/physics/cam/aer_rad_props.F90
models/atm/cam/src/physics/cam/phys_buffer.F90
models/atm/cam/src/physics/cam/rad_constituents.F90
models/atm/cam/src/physics/cam/restart_physics.F90
models/atm/cam/src/utils/time_manager.F90
. fixes for intel compiler
. remove need to #define LLNL_PELOTON

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

Pre-existing failures due to inconsistency between ccsm scripts and clm tag.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_41
Originator(s): Jim Edwards, Pat Worley
Date:  05-28-2009
One-line Summary:  Additional communications algorythms, cice bug fix

Purpose of changes: Cray XT machines were having mpi buffer issues at large proc counts
	this pio update resolves those issues.   
	Updated PIO to trunk_tags/pio47_prod
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: self

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
     Moved call to close initial file from cam_init to cam_finalize in 
	cam_comp.F90 - the ice component 


	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: no failures other than ccsm tests carried over from cam3_6_38

bangkok/lf95: no failures
	

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_40
Originator(s): Jim Edwards
Date: May 12, 2009
One-line Summary: bug fixes for cam3_6_39

Purpose of changes: Remedy bugs and performance in cam3_6_39

Bugs fixed (include bugzilla ID): Fixed a postcommit PGI compiler issue in
           PIO.  Fixed problems with history column output.
	   Fixed a post commit failure in sld dycore.

           NOTE: There are still outstanding issues related to running on
	     CRAY XT systems that we continue to work on.  

	
Describe any changes made to build system:
           PIO updated to pio43_prod
Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:  

Code reviewed by: self, eaton

List all subroutines eliminated:
	Removed dead code from cam_history.F90 : read_hbuf, write_hbuf, readin_hbuf
                               mpigatherv_hbuf, wrap_put_vara_hbuf, 
	                       gather_chunk_to_field_hbuf, scatter_field_to_chunk_hbuf
List all subroutines added and what they do:
        Added code for storing iodesc in pio_utils.F90: find_iodesc, clean_iodesc_list
	
List all existing files that have been modified, and describe the changes:
        src/control/ncdio_atm.F90
        src/control/startup_initialconds.F90
        src/control/cam_restart.F90
        src/control/cam_history.F90
        src/utils/pio_utils.F90
        src/physics/cam/restart_physics.F90
        src/physics/cam/phys_buffer.F90
        src/dynamics/sld/restart_dynamics.F90
        src/dynamics/homme/inidat.F90

	The iodesc variable was changed to a pointer so that it could be reused, this 
	improved performance and reduced memory relative to cam3_6_39 and brought it
	back inline with cam3_6_38.   Capability to output column subsets of history
	variables was restored.   Some dead code was removed.


	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  All pass against cam3_6_39 except ccsm tests.
	   post commit test pf385 was run against cam3_6_38 and also passed.
	   additional testing with ndens=2 was also conducted
052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

	
bangkok/lf95: All pass against cam3_6_39
	   PGI tests were also conducted against cam3_6_38, all pass except 
	   expected failures.
032 sm314 TSM.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 8
033 er314 TER.sh wg10dm outfrq3s 4+5s .............................FAIL! rc= 5
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 4

POST test sm371 Fails on jaguar with DEBUG=true - this is a feature of the PGI compiler	
   which is giving an error when mct passes an array of length 0.  This is legal fortran
	and should not be trapped.
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_39
Originator(s): Jim Edwards, Mark Taylor
Date: 01-09-2009
One-line Summary: Add pio support for initial file

Purpose of changes: parallelize IO

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: Removed PIO from CAM build in 
	CCSM: PIO is now built as a library

Describe any changes made to the namelist: Added pio_input logical to 
	control use of PIO in reading initial file

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Eaton

List all subroutines eliminated: 

List all subroutines added and what they do:
	Added PIO specific versions of inidat for all dycores

List all existing files that have been modified, and describe the changes:

M              models/atm/cam/test/system/TBR.sh
	Updated to match new netcdf restart name string
M              models/atm/cam/test/system/nl_files/off1.9x2.5
M              models/atm/cam/test/system/nl_files/ghgrmp
M              models/atm/cam/test/system/nl_files/off2x2.5
        Removed obsolete pio_restart variable

M              models/atm/cam/bld/build-namelist
        Clean up homme dycore options, add pio_inparm namelist for driver
	
M              models/ice/csim4/ice_comp.F90
	T3 field is used to initialize TBOT when TBOT not present in initial        file, however this field was being allocated and read even when 
	TBOT was present.  Refactored to read T3 in parallel and 
	only when required
M              models/atm/cam/src/control/runtime_opts.F90
        Broadcast pertlim variable to support parallel IO

M              models/atm/cam/src/control/cam_history.F90
        Added cell area variable for homme dycore
	
M              models/atm/cam/src/control/readinitial.F90
M              models/atm/cam/src/control/ncdio_atm.F90
M              models/atm/cam/src/control/startup_initialconds.F90
M              models/atm/cam/src/utils/pio_utils.F90
M              models/atm/cam/src/physics/cam/restart_physics.F90
M              models/atm/cam/src/dynamics/sld/inidat.F90
M              models/atm/cam/src/dynamics/eul/inidat.F90
M              models/atm/cam/src/dynamics/homme/inidat.F90
M              models/atm/cam/src/dynamics/fv/inidat.F90
        Added PIO versions of initial file read routines.
	
M              models/atm/cam/src/physics/cam/cam3_aero_data.F90
M              models/atm/cam/src/physics/cam/seasalt_intr.F90
M              models/atm/cam/src/physics/cam/tracers.F90
M              models/atm/cam/src/physics/cam/progseasalts_intr.F90
M              models/atm/cam/src/physics/cam/dust_intr.F90
M              models/atm/cam/src/physics/cam/tracers_suite.F90
M              models/atm/cam/src/physics/cam/stratiform.F90
M              models/atm/cam/src/physics/cam/carbon_intr.F90
M              models/atm/cam/src/physics/cam/co2_cycle.F90
M              models/atm/cam/src/physics/cam/chemistry.F90
M              models/atm/cam/src/physics/cam/aerosol_intr.F90
M              models/atm/cam/src/physics/cam/sulfur_intr.F90
M              models/atm/cam/src/physics/waccm/tracers.F90
M              models/atm/cam/src/chemistry/mozart/chemistry.F90
       Refactored initialization of Constituents to allow for parallel
	initialization.
	
M              models/atm/cam/src/dynamics/fv/dyn_grid.F90
M              models/atm/cam/src/dynamics/homme/dyn_grid.F90
       Added subroutines get_gcol_lat and get_gcol_lon to map a global 
	column id to a lat/lon pair
	
M              models/atm/cam/src/dynamics/homme/restart_dynamics.F90
M              models/atm/cam/src/dynamics/homme/inital.F90
M              models/atm/cam/src/dynamics/fv/dp_coupling.F90
	Simplified an indexing equation

M              models/atm/cam/src/dynamics/fv/dyn_comp.F90
	Added default initialization of dyn_in members to inf for debugging
	uninitialized variables
M              models/atm/cam/src/dynamics/fv/metdata.F90
	Cleaned up stdout
M              SVN_EXTERNAL_DIRECTORIES
        Updated PIO external and mct serial driver

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   All pass except 
	051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
	expected failure due to homme dynamics updates
	
        052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
        053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
        054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
        055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
        056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
	carried forward from cam3_6_38 - This commit passed these tests as run against 
	cam3_6_37 prior to the cam3_6_38 merge.
	
	

bangkok/lf95:  All pass except
        037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
	fails due to round off differences in polar averaging of TCWAT field
	as initialized from T in physpkg.F90 - see cam3_6_35 for details.

	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_6_38
Originator(s): eaton
Date: Tue May  5 11:34:35 MDT 2009
One-line Summary: Fix for running F compsets from ccsm4_0_beta16 and later.

Purpose of changes:

. modify build-namelist so that it generates a landmask file for the CAMDOM
  component namelist that is consistent with the one generated for the CICE
  namelist.
  Note that the fix is for running the F compsets from the ccsm4_0_beta16
  and later tags.  Using the ccsm scripts to run F compsets from this cam
  tag is broken due to an inconsistency between the scripts and the CLM
  tag.  We will be updating the CLM external to fix this problem shortly.

. Update to the latest scripts and pio tags.  Updating to the latest
  scripts tag has temporarily broken the ability to run F compsets via the
  ccsm scripts in this CAM tag.


Bugs fixed (include bugzilla ID): 

. Fix for running F compsets from ccsm4_0_beta16 and later.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. models/utils/pio  -> pio38_prod/pio
. scripts           -> scripts4_090428

cam/bld/build-namelist
. modify build-namelist to look at the cice namelist defaults to determine
  whether the gx1v6 mask is being used.  If a gx1v6 mask is used, the
  default for the focndomain variable will be determined using the attribue
  mask="gx1v6".
. don't write dom_inparm namelist group when it isn't needed, i.e., for
  ideal, adiabatic, and aqua-planet modes.

cam/bld/namelist_files/namelist_defaults_cam.xml
. remove defaults for old 1x1.25 and 2x2.5 resolutions which are no longer
  supported. 
. add focndomain defaults for gx1v6 mask.

cam/src/chemistry/utils/tracer_data.F90
cam/src/physics/cam/polar_avg.F90
. Change name of polar_avg_mod to polar_avg to match the filename (required
  by dependency generator).

cam/test/system/TCB_ccsm.sh
. change the xmlchange command to modify env_build.xml rather than
  env_mach_generic.xml.  The EXEROOT variable was moved to env_build.xml. 

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all PASS except

052 sm991 TSM_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
053 er991 TER_ccsm.sh f19_f19 F 1+1d ..............................FAIL! rc= 6
054 sm992 TSM_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4
055 er992 TER_ccsm.sh f19_g15 E 1+1d ..............................FAIL! rc= 6
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

These tests fail due to an inconsistency between the scripts and CLM tags.

bangkok/lf95: all PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_37
Originator(s): pworley
Date: Mon Apr 27 2009
One-line Summary: more accurate reproducible sum; additional OpenMP 
parallelism.

Purpose of changes:

1) Modify repro_sum fixed-point algorithm to improve accuracy.
   In certain situations, numerical cancellation can degrade accuracy 
   of original repro_sum algorithm as compared to floating-point-based
   algorithms. New algorithm is nearly exact, employing variable 
   precision as needed. This results in roundoff level differences.

2) Introduce OpenMP parallelism in physics and chemistry routines 
   that are not called within the major loop over chunks.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

- Cost of new repro_sum algorithm is higher than that of the old
  algorithm. Experiments indicate that the additional cost is
  not significant.

Code reviewed by: self

List all subroutines eliminated:

List all subroutines added and what they do:

   physics/cam/polar_avg.F90 - 
      moved polar averaging routines out of repro_sum_mod.F90 and
      into their own module

List all existing files that have been modified, and describe the changes:

   chemistry/utils/prescribed_aero.F90 -
      slight restructuring to expose OpenMP parallelism; 
      addition of OpenMP directives

   chemistry/utils/tracer_data.F90 -
      'use' polar_avg_mod instead of repro_sum_mod;
      addition of OpenMP directives

   dynamics/fv/spmd_dyn.F90 -
      changed default communication protocol for I/O-related scatter
      routines in FV, to address runtime failure on Cray XT system

   physics/cam/ghg_data.F90 - 
      addition of OpenMP directive

   physics/cam/phys_grid.F90 -
      bug fix to unadvertised load balancing option
	
   utils/repro_sum_mod.F90 -
      generalization of fixed-point reproducible sum algorithm to
      enable (almost) exact arithmetic
	
   test/system/input_tests_master -
      bug fix (at request of Brian Eaton)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except

015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4c351pdh aqpgro 3s ..............................FAIL! rc= 7
024 bl334 TBL.sh f4adh adia 9s ....................................FAIL! rc= 7
027 bl335 TBL.sh f4idh idphys 9s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
048 bl387 TBL.sh f1.9c351dh outfrq3s+1850-2005_track1 9s ..........FAIL! rc= 4
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7

bangkok/lf95: All PASS except

021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 4
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 4
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 4
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 4
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 4
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 4

   All baselines using FV fail due to roundoff introduced in changes to
   reproducible sum algorithm.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: 
   Roundoff diffs in all configurations using FV.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

   pergro test on bluefire

===============================================================

Tag name: cam3_6_36
Originator(s): fvitt, eaton
Date: Tue Apr 21 14:56:51 MDT 2009
One-line Summary: new solar data code; update prescribed forcing data.

Purpose of changes:

. A new module (solar_data) has been added with capabilities to read
  datasets containing either total solar irradiance (TSI) or spectrally
  resolved solar irradiance (SSI).  Currently only the TSI code, needed for
  the track1 transient runs, is active.

. Updates to prescribed forcing data:
  - New TSI and SSI datasets from Caspar Ammann.
  - New 1850 and 2000 climatologies for both BAM and ozone from
    Jean-Francois Lamarque.
  - New GHG data (CO2, CH4, N2O, F11*, F12) from Doug Kinnison.
  - New volcanic emissions (eruptive) data from Caspar Ammann.

. A new use case (1850-2005_track1) has been implemented for the 1850-2005
  transient runs for track1 physics.

. configure has been modified to invoke the CICE configure with the args
  "-ntr_aero 0 -ntr_pond 1 -ntr_iage 0".  The -ntr_aero setting was already
  being used; the -ntr_pond and -ntr_iage settings are new.  This is for
  consistency with how the CCSM F cases are configured.  The values for
  -ntr_pond and -ntr_iage are the defaults, so this doesn't change
  answers.

Bugs fixed (include bugzilla ID):

. The chemistry/utils/prescribed_* modules all contained a bug which did
  not allow the data_type variable to be set to INTERP_MISSING_MONTHS (the
  module variable was declared char*8).

. The interpic_new utility was assuming that all global attributes are text
  strings.  This was causing failures on input files produced by the NCO
  operators which contain a global attribute of type integer.

. build-namelist wasn't recognizing a value of "0" in the use case file
  because a conditional statement was testing whether the value was true
  rather than whether the value was defined.

Describe any changes made to build system: none

Describe any changes made to the namelist:

. new namelist variables for the solar_data module:
  character(len=256) :: solar_data_file = ''
  character(len=8)   :: solar_data_type = 'SERIAL' ! "FIXED" or "SERIAL"
  integer            :: solar_data_ymd = 0         ! YYYYMMDD for "FIXED" type
  integer            :: solar_data_tod = 0         ! seconds of day for "FIXED" type
  real(r8)           :: solar_const                ! constant TSI (W/m2)

. The following namelist variables have been removed:
  bndtvscon, rampyear_scon, scenario_scon, scon

List any changes to the defaults for the boundary datasets:

. updates to 2000 climatology for ozone, prescribed BAM
. update fixed GHG values to be consistent with year 2000 from the new GHG
  dataset. 

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/physics/cam/ramp_scon.F90
. old solar irradiance module

List all subroutines added and what they do:

models/atm/cam/bld/namelist_files/use_cases/1850-2005_track1.xml
. use case for track1 1850-2005 transient runs

models/atm/cam/src/chemistry/utils/solar_data.F90
. new module to manage solar irradiance specification

models/atm/cam/test/system/config_files/f1.9c351dh
. config params for fv, 1.9x2.5, cam3_5_1, debug, hybrid.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. unless the solar_data_file is specified by the user or by a use case, set
  the default solar constant.
. fix bug in processing use case values (need to check whether value is
  defined rather than whether it's true)

models/atm/cam/bld/namelist_files/namelist_definition.xml
. remove bndtvscon, rampyear_scon, scenario_scon, scon
. add solar_data_file, solar_data_type, solar_data_ymd, solar_data_tod,
  solar_const
. change type of prescribed_*_type variables from char*8 to char*32.  Add
  the appropriate valid values to each.

models/atm/cam/bld/namelist_files/use_cases/1850_track1.xml
models/atm/cam/bld/namelist_files/use_cases/1870_bam.xml
models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
. convert scon -> solar_const (change units too)

models/atm/cam/bld/namelist_files/use_cases/1990_control.xml
models/atm/cam/bld/namelist_files/use_cases/1990_prog_aero.xml
. remove scon spec so default present day value is used (valid for 1990 or 2000).

models/atm/cam/src/chemistry/mozart/solvar_woods.F90
. use sol_tsi from solar_data instead of scon from cam_control_mod.

models/atm/cam/src/chemistry/utils/prescribed_aero.F90
models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
. change declaration of datatype variable from char*8 to char*32.  Needs to
  be long enough for the value INTERP_MISSING_MONTHS.

models/atm/cam/src/control/cam_control_mod.F90
. remove doramp_scon and scon

models/atm/cam/src/control/runtime_opts.F90
. add call to solar_data_readnl
. remove use ramp_scon
. remove scenario_scon, rampyear_scon, scon

models/atm/cam/src/physics/cam/advnce.F90
. add call to solar_data_advance
. remove ramp_scon

models/atm/cam/src/physics/cam/physconst.F90
. add speed of light and Planck's constant.

models/atm/cam/src/physics/cam/physpkg.F90
. add call to solar_data_init

models/atm/cam/src/physics/cam/radiation.F90
. use sol_tsi from solar_data instead of scon from cam_control_mod.
  use local scon to convert units to mW/m2.

models/atm/cam/src/physics/rrtmg/radiation.F90
. use sol_tsi from solar_data instead of scon from cam_control_mod.
  conversion to mks units no longer necessary.

models/atm/cam/test/system/input_tests_master
. add new tests:
  - sm387 TSM.sh f1.9c351dh outfrq3s+1850-2005_track1 9s
  - er387 TER.sh f1.9c351dh outfrq3s+1850-2005_track1 4+5s
  - br387 TBR.sh f1.9c351dh outfrq3s+1850-2005_track1 6+3s
  - bl387 TBR.sh f1.9c351dh outfrq3s+1850-2005_track1 9s

models/atm/cam/test/system/tests_pretag_bluefire
. replace {sm,er,br,bl}382 by {sm,er,br,bl}387

models/atm/cam/tools/interpic_new/fmain.F90
. remove assumption that copied attributes are text strings

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4c351pdh aqpgro 3s ..............................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
051 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7

bangkok/lf95: All PASS except
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: Answers change due to update of
  prescribed forcing datasets.  There was also a roundoff level change in
  waccm_mozart due to changing the units of the solar constant input.

===============================================================
===============================================================

Tag name: cam3_6_35
Originator(s): fvitt, aconley, bardeenc, jedwards, eaton
Date: Mon Apr 13 13:36:28 MDT 2009
One-line Summary: volcano emissions and optics; 1850_track1 updates;
  build-namelist mods (improve AMIP setup)

Purpose of changes:

. Add new code for reading volcano emission datasets.  This includes a new
  feature to mask emissions below the tropopause.  Currently the volcanic
  emissions are radiatively active by default only when used with camrt and
  with BAM (prescribed or prognostic).  This functionality is needed for the
  track1 transient runs.

. Add module to diagnose the location of the tropopause. Multiple
  algorithms are provided, some of which may not be able to identify a
  tropopause in all situations. To handle these cases, an analytic
  defintion and a climatology are provided that can be used to fill in
  when the original algorithm fails. The troppause temperature and
  pressure are determined and can be output to the history file.  (From
  Charles Bardeen.)

. Tuning mod: set rhminl=0.92 for FV 1.9x2.5 w/ cam3 or cam3_5* physics.

. Update the 1850_track1 use case with new 1850 prescribed BAM aerosols
  from Jean-Francois Lamarque.

. Update build-namelist to allow setting all namelist variables recognized
  by the perf_mod module.  Also change default for timing output files to
  use a single file.

. Update build-namelist to enforce consistency between the SST and ocean
  domain files used by CAM-DOM and the prescribed CICE mode.  Also add
  variables to the CAM namelist that are needed to specify the first and
  last years of a multi-year SST dataset (for AMIP runs).

. Update the FV inidat code to replace global sums by distributed sums in
  the polar averaging.  This results in roundoff level differences.  (From
  Jim Edwards.)

. Add support for radius dependent optics calculation for volcanic
  aerosols.  This code will only be turned on for RRTMG.

Bugs fixed (include bugzilla ID):

. The volcano emissions code used in cam3 was broken when changes were made
  to remove assumptions about rectangular lat/lon grids from the physics
  code.  The new code added with this commit replaces the old code which
  has been removed.

Describe any changes made to build system: none

Describe any changes made to the namelist: new volcano emission variables

character(len=16)  :: prescribed_volcaero_name      ! name of variable containing volcano mmr (default: MMRVOLC)
character(len=256) :: prescribed_volcaero_file      ! name of file containing emission data
character(len=256) :: prescribed_volcaero_filelist  ! name of file containing list of emission dataset file names
character(len=256) :: prescribed_volcaero_datapath  ! absolute pathname of file containing emission data
character(len=8)   :: prescribed_volcaero_type      ! type of time interpolation (default: SERIAL)
logical            :: prescribed_volcaero_rmfile    ! true => remove dataset after using (default: false)
integer            :: prescribed_volcaero_ymd       ! start ymd for interpolation if different from model time
integer            :: prescribed_volcaero_tod       ! time of day (sec) relative to prescribed_volcaero_ymd

. Remove variables used by old volcano emission modules: bndtvvolc and
  strat_volcanic. 

. Add support for all namelist variables recognized by the perf_mod module.

. Add the variables stream_year_first and stream_year_last which are used
  to specify, respectively, the first and last years of data in a
  multi-year SST dataset.  This is needed for AMIP runs.

. The new tropopause diagnostic code uses a tropopause climatology file.
  The default (which is also used by the trop_mozart code) can be
  overridden via the namelist variable tropopause_climo_file.

List any changes to the defaults for the boundary datasets:

. new dataset for 1850 climatology of prescribed bulk aerosols.

. replace sst_HadOIBl_bc_32x64_clim_c030228.nc by
  sst_HadOIBl_bc_32x64_clim_c050526.nc because the latter file has a time
  coordinate that's recognized by cice.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/physics/cam/volcanicmass.F90
models/atm/cam/src/physics/cam/volcemission.F
. old volcanic emission code

List all subroutines added and what they do:

models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
. module to read prescribed volcano emissions dataset

models/atm/cam/src/physics/cam/tropopause.F90
. new tropopause diagnostic code.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/Makefile.in
. add -gopt to pgi FFLAGS for non-debug build

models/atm/cam/bld/build-namelist
. modify to make the prescribed volanic aerosols radiatively active if
  present. 
. change the default so a single file is produced for timing output
. modify how default is added for the fsurdat file
. invoke the cice build-namelist with variables set to insure that the
  settings of SST dataset and ocn domain file are consistent with the
  CAM-DOM settings.
. Add ability to set the variables stream_year_first and stream_year_last
  directly in the CAM namelist as a convenience for setting up AMIP runs.
  These settings are passed to the cice build-namelist which is the
  component that requires setting them.
. add default for tropopause climatology file.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add default for tropopause climatology file.
. change T21 SST dataset.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. Add new namelist variables for prescribed_volcaero module.
. Remove old volcano emissions variables
. Add all namelist variables recognized by the perf_mod module.
. add stream_year_first and stream_year_last.  These set the first and last
  years respectively in a multi-year SST dataset read by cice in prescribed
  mode.  They must be set for AMIP style runs.
. add definition for tropopause climatology file.

models/atm/cam/bld/namelist_files/use_cases/1850_track1.xml
. new dataset for 1850 climatology of prescribed bulk aerosols.

models/atm/cam/src/chemistry/utils/prescribed_aero.F90
models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
. remove a save attribute that caused compiler warnings (because there's
  already a global save statement)

models/atm/cam/src/chemistry/utils/tracer_data.F90
. fix indexing bug in read_za_trc

models/atm/cam/src/dynamics/fv/inidat.F90
. Replace global sums done on masterproc by distributed sums.  Needed for
  polar averaging.

models/atm/cam/src/control/runtime_opts.F90
models/atm/cam/src/physics/cam/advnce.F90
models/atm/cam/src/physics/cam/initindx.F90
models/atm/cam/src/physics/cam/physpkg.F90
models/atm/cam/src/physics/cam/restart_physics.F90
. add hooks for new prescribed_volcaero module

models/atm/cam/src/control/filenames.F90
models/atm/cam/src/control/runtime_opts.F90
models/atm/cam/src/physics/cam/advnce.F90
models/atm/cam/src/physics/cam/aerosol_intr.F90
models/atm/cam/src/physics/cam/initindx.F90
models/atm/cam/src/physics/cam/physpkg.F90
models/atm/cam/src/physics/cam/sulfur_intr.F90
. remove references to old volcanicmass and volcemission modules

models/atm/cam/src/chemistry/utils/prescribed_volcaero.F90
. replace simple tropopause expression by a utility that provides multiple
  methods for diagnosing the tropopause.

models/atm/cam/src/physics/cam/aer_rad_props.F90
. add code to compute optics for radius-dependent quantities

models/atm/cam/src/physics/cam/cloud_fraction.F90
. set rhminl=0.92 for FV 1.9x2.5 with cam3 or cam3_5* physics

models/atm/cam/src/physics/cam/phys_prop.F90
. add code to read radius-dependent mass-specific quantities: r_sw_ext,
  r_sw_scat, r_sw_ascat, r_lw_abs, mu

models/atm/cam/src/physics/cam/physpkg.F90
. add calls to tropopause_init

models/atm/cam/src/physics/cam/rad_constituents.F90
. add access to new properties: r_lw_abs, r_sw_ext, r_sw_scat, r_sw_ascat,
  mu 

models/atm/cam/src/physics/cam/tphysbc.F90
. add output of tropopause diagnostic calc


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4c351pdh aqpgro 3s ..............................FAIL! rc= 7
024 bl334 TBL.sh f4adh adia 9s ....................................FAIL! rc= 7
027 bl335 TBL.sh f4idh idphys 9s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
048 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_bam 9s ..................FAIL! rc= 7
056 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7

bangkok/lf95: All PASS except
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7


. bl132 fails due to new SST dataset.

. All baselines using FV fail due to roundoff introduced in computing polar
  averages at initialization.

. bl315 and bl333 have larger than roundoff differences due to the rhminl
  tuning mod for track1, 1.9x2.5 runs.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: Roundoff diffs in all configurations
  using FV.  Larger than roundoff diffs in FV @ 1.9x2.5 using cam3_5_1
  or earlier physics.

===============================================================
===============================================================

Tag name: cam3_6_34
Originator(s): Jim Edwards,mvr
Date: Fri Mar 27 2009
One-line Summary: Extend cam3.5 physics to unstructured grids; bug fix to 
test scripts for testing of ccsm and cleanup

Purpose of changes:
. Extend cam3.5 physics to unstructured grids.  This involves the code used
  to interpolate the prescribed aerosols and ozone datasets.  It does not
  involve lots of code used by the prognostic chemistry schemes to
  interpolate surface emission datasets.

  The new interpolation code parallelizes the calculation rather than
  interpolating on masterproc and scattering the results.

Bugs fixed (include bugzilla ID):
. The changes made to the interpolation code to support unstructured grids
  fixed code bugs related to the treatment of interpolation points at or
  near the poles.  This introduces larger than roundoff changes in the
  interpolated fields.

Describe any changes made to build system:
- moved memory pagesize flags for AIX from testdriver to Makefile

Describe any changes made to the namelist: 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:  Brian, mvr, Francis

List all subroutines eliminated: 
D      models/atm/cam/test/system/TCS.ccsm.sh
D      models/atm/cam/test/system/TCB.ccsm.sh
D      models/atm/cam/test/system/config_files/f4pdh
- remove test scripts, config file that are no longer used
	

List all subroutines added and what they do:
A      models/atm/cam/bld/namelist_files/use_cases/1850_track1.xml
- new use_case for 1850 runs and track1
	
A      models/atm/cam/test/system/config_files/f4c351pdh
- new configure options test file for testing cam3_5_1 physics
	

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_bluefire
M      models/atm/cam/test/system/tests_posttag_bluefire
- modified bluefire pretag test list to enable it to finish within 6hr limit

M      models/atm/cam/test/system/TCB_ccsm.sh
- minor cleanup to allow reuse of existing test directories

M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/bld/Makefile.in
M      models/atm/cam/bld/run-ibm.csh
- moved memory pagesize flags for AIX from testdriver to Makefile

M      models/atm/cam/test/system/input_tests_master
- modified definition of pergro test to use cam3_5_1 physics

M      models/atm/cam/test/system/TBL_ccsm.sh
- bug fix to ccsm baseline test - was not using baseline code!

M      models/atm/cam/src/control/interpolate_data.F90
- added support for direct interpolation from a regular grid to a phys 
  grid decomposition.
	
M      models/atm/cam/src/utils/repro_sum_mod.F90
- added support for pole averaging fv on the phys grid

M      models/atm/cam/src/chemistry/utils/tracer_data.F90
- replaced mo_regrid calls with calls to interpolate_data, this parallelizes 
  the interpolation and extends it to unstructured grids.
	
M      models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
M      models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
M      models/atm/cam/src/chemistry/mozart/mo_aurora.F90
M      models/atm/cam/src/chemistry/mozart/mo_airplane.F90
M      models/atm/cam/src/chemistry/mozart/mo_apex.F90
M      models/atm/cam/src/chemistry/mozart/mo_drydep.F90
- replaced references to commap with calls to dyn_grid

M      models/atm/cam/src/dynamics/sld/dyn_grid.F90
M      models/atm/cam/src/dynamics/eul/dyn_grid.F90
M      models/atm/cam/src/dynamics/fv/dyn_grid.F90
- extended functionality of get_horiz_grid_d to return either regular
  grid or unstructured grid output depending on the size of the array(s)
  to be returned
	
M      models/atm/cam/src/dynamics/homme/dycore.F90
- added 'UNSTRUCTURED' as a valid string in dycore_is
	
M     .
M      SVN_EXTERNAL_DIRECTORIES
- updated to new mct, scripts external tags


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   All pass except 
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4c351pdh aqpgro 3s ..............................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_bam 9s ..................FAIL! rc= 7
061 bl991 TBL_ccsm.sh f19_f19 F....................................FAIL! rc= 7
064 bl992 TBL_ccsm.sh f19_g15 E....................................FAIL! rc= 7

bangkok/lf95:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

all baselines were expected to fail except those using:
-ideal physics
-adiabatic
-cam3_5 physics
-homme 
-trop mozart chemistry
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers:   
- what code configurations: see above
- what platforms/compilers: all
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):  Larger than roundoff but same climate. 

   The new interpolation scheme improves handling of grid points close to the 
   poles, this change results in a larger than roundoff difference.   

If bitwise differences were observed, how did you show they were no worse
than roundoff?  20yr validatin run vs cam3_6_33

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository): cs_cam3_6_33
- platform/compilers: bluefire
- configure commandline: 
configure -ntasks 16 -nthreads 4 -phys cam3_5_1 -dyn fv -res 1.9x2.5
	
- build-namelist command (or complete namelist):
build-namelist -s -case cs_cam3_6_33_F -runtype continue -namelist "&camexp stop_option='nmonths', stop_n=30 /"

- MSS location of output:
mss:/MVR/csm/cs_cam3_6_33_F
	
MSS location of control simulations used to validate new climate:
mss:/MVR/csm/cam3_6_33_F
	
URL for AMWG diagnostics output used to validate new climate:
mss:/MVR/csm/cs_cam3_6_33_F/cs_cam3_6_33_F-cam3_6_33_F.tar 

	
===============================================================

Tag name: cam3_6_33
Originator(s): eaton
Date: Fri Mar 13 17:00:02 MDT 2009
One-line Summary: add cam3_5_1 option & tuning; change solar constant; change cice default

Purpose of changes:

. Add a new configure option, "-phys cam3_5_1".  This is to configure the
  "track1" simulations out of the box.  cam3_5_1 is the same build as
  cam3_5, but the namelist settings are modified to set the critical Froude
  number to 1.0 and to set the FV polar filter to use FFT always (these are
  the same values that are used by default in the latest development code).

. Tuning parameter for track1: set rhminl=0.90 for 2 degree runs using RK
  microphysics. 

. Change to solar constant.  Notes from Caspar Ammann:
  On Wed, Mar 11, 2009 at 04:44:54PM -0600, Caspar Ammann wrote:
  >
  > the numbers for mean total solar irradiance (TSI, or scon) for the  
  > 1850-PreIndustrial as well as PresentDay controls are now computed based 
  > on the latest information from Judith Lean and her irradiance model. They 
  > are consistent with SORCE:
  >
  > 	PreIndustrial: 1360.89 W/m2 (~1850 AD)
  > 	PresentDay:  1361.27 W/m2 (~1990 but also 2000 AD)
  >
  > FYI:
  > the 1850 mean was computed over 3 roughly stable solar cycles 1834-1866 AD
  > the 1990/2000 values were computed over 3 roughly stable solar cycles  
  > 1975-2007 AD
  >
  > The cycles were assumed to be 11-year cycles.
  >
  > The spectral range included is: integral of irradiance at wavelengths  
  > >200nm

. Turn off the aerosol tracers in CICE:
  The CAM "standalone" configuration uses the "prescribed" mode of CICE.
  The recent addition of aerosol tracers into CICE is causing problems in
  the prescribed mode, so we have decided as a short term fix to turn off
  the aerosol tracers in CICE.  It is an open science question whether the
  aerosol tracers should be turned on in the CICE prescribed mode since
  this mode allows only vertical transport of the tracers.

. Update scripts external to scripts4_090312

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:

. Changes to configure: add valid option "-phys cam3_5_1".

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

. added default for 1/4 degree soil_erod dataset

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. Update scripts external to scripts4_090312

models/atm/cam/bld/cam.cpl7.template
. Add $CAM_NAMELIST_OPTS to the build-namelist command.

models/atm/cam/bld/config_files/definition.xml
. add cam3_5_1 as valid value for phys.

models/atm/cam/bld/configure
. add cam3_5_1 as valid value for phys.  The build is identical to cam3_5.
. call the cice configure command with the argument "-ntr_aero 0" to turn
  off the aerosol tracer code.
. add check of exit status from the cice configure.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. change present day value of scon to 1.36127e6

models/atm/cam/bld/namelist_files/use_cases/1870_bam.xml
models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
. change 1870 value of scon to 1.36089e6

models/atm/cam/src/control/atm_comp_mct.F90
models/atm/cam/src/control/cam_comp.F90
. remove of old gensom code

models/atm/cam/src/physics/cam/cloud_fraction
. set rhminl=.90 for 2 degree w/ RK microphysics

models/atm/cam/src/physics/cam/zm_conv.F90
. Change the dpdry arg from optional to required.  dpdry is always
  available and changing this allows us to remove a compiler workaround for
  the bluegene machines.

models/atm/cam/src/physics/cam/zm_conv_intr.F90
. remove BGP ifdef.  always pass dpdry to convtran.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl370 TBL.sh fmo1.9dh off1.9x2.5 9s ...........................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_bam 9s ..................FAIL! rc= 7
058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
061 bl991 TBL_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 4
064 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 4

bangkok/lf95: All PASS except
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

The baseline failures are expected as summarized below.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: new climate in all configs except
  adiabatic and ideal physics due to changing the solar constant.  In
  addition the tuning parameter change for track1 affects 2 degree FV runs
  using the RK microphysics (cam3, cam3_5, and cam3_5_1 physics options).
  I suspect that turning off the aerosol tracers in CICE will also change
  answers although that change wasn't tested in isolation.

===============================================================
===============================================================

Tag name: cam3_6_32
Originator(s): eaton
Date: Mon Mar  2 12:55:20 MST 2009
One-line Summary: mods to ramp_co2; update externals

Purpose of changes:

. The option to ramp CO2 at a specified annual rate currently required the
  user to specify the start date via the namelist variable
  ramp_co2_start_ymd.  This has been modified so that if this variable is
  not specified, the default behavior is to start the ramping at the
  beginning of the run.

. Update to the following externals:
  drvseq3_0_09
  clm3_6_19
  cice4_0_20090226
  scripts4_090226

  ** Note ** Updating the CLM and CICE externals results in a new climate
  for any configuration that provides deposition of carbon/dust to the
  surface (currently trop_mam3, trop_bam, trop_mozart).  The new CLM and
  CICE versions will use deposition fluxes from the atm whenever they are
  provided. 

Bugs fixed (include bugzilla ID):

. bug fix from Sungsu in the MG microphyics:
  Add the term mnucct+msacwi to the calculation of tlat.
  These terms do not appear in the cam3_6 version of MG microphysics, so
  this fix will not affect the "track2b" simulations.  It does change
  answers in the version of MG microphysics currently on CAM's trunk which
  came from the end of the modal branch (modal12_cam3_6_26).

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update to include drvseq3_0_09, clm3_6_19, cice4_0_20090226, scripts4_090226

models/atm/cam/bld/build-namelist
. restore untruncated names of the following variables to the fincl2 list
  used for the camiop test: afixcldliq, afixcldice,dqfxcldliq,dqfxnumliq,
  dqfxnumice,afixnumice,afixnumliq,dqfxcldice (bug fix for SCAM).

models/atm/cam/src/dynamics/eul/iop.F90
. change declaration of lowername from char*8 to char*16 (bug fix for SCAM).

models/atm/cam/src/physics/cam/chem_surfvals.F90
. modify how ramp_co2_start_ymd works.  Rather than failing if the user
  doesn't set it, let the default be to start the co2 ramping at the
  beginning of the run.

models/atm/cam/src/physics/cam/cldwat2m.F90
. bug fix from sungsu, line 2879, add the terms mnucct(k)+msacwi(k) to tlat calc. 
  ((bergs(k)+psacws(k)+mnuccc(k)+mnucct(k)+msacwi(k))*cldm(i,k)+(mnuccr(k)+ &

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl370 TBL.sh fmo1.9dh off1.9x2.5 9s ...........................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_bam 9s ..................FAIL! rc= 7
061 bl991 TBL_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 7
064 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7
065 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 6

bangkok/lf95: All PASS except
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

The baseline failures are all expected (see below)
The SCAM failure is pre-existing.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: New climate for configurations that
  include the default MG microphysics (bug fix) or prognostic aerosols (due
  to the new CICE and CLM externals responding to deposition fluxes.
  BFB for ideal and adiabatic physics, and for cam3.

===============================================================
===============================================================

Tag name: cam3_6_31
Originator(s): eaton
Date: Fri Feb 27 13:45:55 MST 2009
One-line Summary: option to use "cam3_6" physics; add deposition fluxes for
                : prognostic BAM

** N.B. ** The current "out of the box" configuration matches that of the
   end of the modal branch, modal12_cam3_6_26, plus the bug fix mentioned
   below.  This is not a tuned configuration, and is not one of the configs
   being evaluated as the possible cam4.  The candidate cam4 configurations
   require setting various arguments to the configure command.  There is
   also a large amount of candidate code still on a branch which will be
   merged to the trunk in the near future.

Purpose of changes:

. Add capability to run with "cam3_6" physics, defined as cam3_5 + a
  version of MG microphysics prior to adding the new treatment for ice +
  prognostic BAM.  cam3_6 retains the camrt radiation package, the HB
  vertical diffusion code, the Hack Shallow convection, and the ZM deep
  convection w/ Neale/Richter modifications.  This option is configured by
  setting the argument "-phys cam3_6" to configure.  To run with prescribed
  instead of prognostic BAM add the argument "-chem none" to configure.

. Send the carbon and dust deposition fluxes to the coupler when prognostic
  BAM is active.

Bugs fixed (include bugzilla ID): in stratiform.F90

. Fix bug in stratiform.F90 (remove conditional surrounding the statement
  that sets the tendency of cloud ice number due to detrainment of Nc).

Describe any changes made to build system:

. Changes to configure: add valid option "-phys cam3_6".

Describe any changes made to the namelist:

. Move cloud_fraction namelist variables into their own namelist group.
  Change names: freeze_dry -> cldfrc_freeze_dry
                rhminl_31  -> cldfrc_rhminl_31
  Add cldfrc_ice to turn on/off the calculation of ice cloud fraction.

. Add variable atm_dep_flux to turn on sending deposition fluxes to the
  coupler.  This is set by build-namelist when the chemistry option is one
  that provides the desired fluxes.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/physics/cam3_6/cldwat2m.F90
. This is the version of cldwat2m being used for cam3_6.  It came
  originally from modal03_cam3_6_24 and has been modified for the "track2"
  runs.  This is temporary.  The physics that has been backed out of
  cldwat2m needs to be implemented with conditional logic in
  physics/cam/cldwat2m.F90.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add defaults for cldfrc_freeze_dry and cldfrc_ice
. add default for atm_dep_flux

models/atm/cam/bld/config_files/defaults_waccm_ghg.xml
models/atm/cam/bld/config_files/defaults_waccm_mozart.xml
. remove setting phys=waccm

models/atm/cam/bld/config_files/definition.xml
. add cam3_6 as valid value for phys
. remove waccm as a valid value for phys.  This removes an unnecessary
  dependence between the phys and chem parameters.
. remove setting the default value for phys.  configure needs to determine
  the physics package before the configure object is initialized.

models/atm/cam/bld/configure
. add cam3_6 option to -phys
. Move the determination of the physics package ahead of determining the
  chemistry package in configure.  The physics packages have different
  default chemistry packages, so the physics package needs to be set first.
  Also remove waccm as a valid physics package value.  This created an
  unnecessary dependence between the chemistry and physics package settings
  that was causing problems as more options are added.  configure can do
  whatever needs to be done for waccm by checking the value of the
  chemistry package.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. remove the phys="waccm" attributes.  In the gw_drag_file element the attribute
  was not needed.  In the solar_parms_file element it was replaced by
  duplicating the element and inserting chem="waccm_ghg" in one and
  chem="waccm_mozart" in the other.
. add defaults for cldfrc_freeze_dry and cldfrc_ice.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. move cloud_fraction namelist variables into namelist group cldfrc_nl
. rename freeze_dry -> cldfrc_freeze_dry
         rhminl_31  -> cldfrc_rhminl_31
. add cldfrc_ice to switch whether the ice cloud fraction calculation is done
. add atm_dep_flux to indicate when CAM will send deposition fluxes to the
  coupler. 

models/atm/cam/src/chemistry/mozart/chemistry.F90
. chem_timestep_tend - change intent of cam_out arg from in to inout.
. copy drydep for CB1 to cam_out%bcphodry
  copy drydep for CB2 to cam_out%bcphidry
  copy drydep for OC1 to cam_out%ocphodry
  copy drydep for OC2 to cam_out%ocphidry

models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
. add intent(out) arg drydepflx to gas_phase_chemdr, and set it.

models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
. copy wetdep for OC2 to cam_out%ocphiwet
  copy wetdep for CB2 to cam_out%bcphiwet

models/atm/cam/src/control/camsrfexch_types.F90
. use phys_control module to query whether atm will send deposition fluxes
  to the coupler.

models/atm/cam/src/control/runtime_opts.F90
. remove cloud fraction namelist vars from cam_inparm
. add call to cldfrc_readnl

models/atm/cam/src/physics/cam/aerosol_intr.F90
. add cam_out to calling args for dust_wet_intr and dust_drydep_intr

models/atm/cam/src/physics/cam/aer_rad_props.F90
. add AEROD_V to default history output

models/atm/cam/src/physics/cam/cloud_fraction.F90
. add method to read namelist cldfrc_nl
. use new namelist variable cldfrc_ice to control whether ice cloud
  fraction is computed, not the microphysics type

models/atm/cam/src/physics/cam/dust_intr.F90
. copy wetdep for 4 dust bins to cam_out%dstwet[1-4]
. copy drydep for 4 dust bins to cam_out%dstdry[1-4]

models/atm/cam/src/physics/cam/phys_control.F90
. add namelist variable atm_dep_flux.  access via the phys_getopts method.

models/atm/cam/src/physics/cam/stratiform.F90
. remove conditional around setting the tendency of cloud ice number due to
  detrainment of Nc.
. misc cleanup

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl370 TBL.sh fmo1.9dh off1.9x2.5 9s ...........................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_bam 9s ..................FAIL! rc= 7
058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
061 bl991 TBL_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 7
064 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 7
065 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 6

bangkok/lf95: all PASS except:

004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7

All baselines fail except adiabatic and ideal physics due to changes in the
cam3 configuration and due to the bug fix in MG microphysics which is the
default.  The SCAM test failure is pre-existing (fix coming soon).

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: different climate due to bug fix in MG
microphysics and change in cam3 configuration (returned the freeze_dry
setting to it's cam3 value).

===============================================================
===============================================================

Tag name: cam3_6_30
Originator(s): mvr
Date: Fri Feb 20 2009
One-line Summary: added testing of ccsm from with cam's test driver; updated 
run template scripts; new externals for timing and docn7; other small fixes

Purpose of changes:
will now test F (stand-alone cam default, prescribed ocn/ice) and E (cam mode 
with fully active ice and som ocean) configurations during required pretag testing 
via the ccsm scripts...

the run template scripts provided in the ~bld directory had not been updated since 
cice became the default sea ice model, requiring changes to the configure calls...

latest timing tag eliminated the need for an extra env var in cppdefs in order to 
limit the log output of the timing code...however, a change to the performance test 
script was required to account for unrelated format changes in the output...
	
Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:
- removed '-DHAVE_GETTIMEOFDAY' from cppdefs - no longer needed with new timing code

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 
D      models/atm/cam/test/system/TSB.ccsm.sh
D      models/atm/cam/test/system/TCT.ccsm.sh
- outdated scripts for testing ccsm from cam's test driver


List all subroutines added and what they do:
A      models/atm/cam/test/system/TCB_ccsm.sh
- new test script to test the configure and build of a ccsm executable
A      models/atm/cam/test/system/TEQ_ccsm.sh
- new test script to test the equivalence of a ccsm run vs a cam run
A      models/atm/cam/test/system/TER_ccsm.sh
- new test script to test that a ccsm run restarts b4b
A      models/atm/cam/test/system/TSM_ccsm.sh
- new test script to test that a ccsm runs to completion (smoke test)
A      models/atm/cam/test/system/TBL_ccsm.sh
- new test script to test that a ccsm run is b4b with a run using baseline code


List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_bluefire
M      models/atm/cam/test/system/tests_posttag_bluefire
- new ccsm tests will now be part of default/required pretag testing on bluefire

M      models/atm/cam/test/system/TPF.sh
- performance test script modified to reflect format changes in timing output 

M      models/atm/cam/test/system/input_tests_master
- test definitions modified with new ccsm tests; 
- bug fix to 1870 test to use proper 'use' case

M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/bld/run-lightning.csh
- run template scripts brought up to date to account for recent changes to configure 

M      models/atm/cam/bld/Makefile.in
- removed '-DHAVE_GETTIMEOFDAY' from cppdefs - no longer needed with new timing code
	
M      SVN_EXTERNAL_DIRECTORIES
 M     .
- new docn7 tag for som runs to work; new timing tag to eliminate need for 
  '-DHAVE_GETTIMEOFDAY' in cppdefs to cut down log output
	

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

061 bl991 TBL_ccsm.sh f19_f19 F 2d ................................FAIL! rc= 5
064 bl992 TBL_ccsm.sh f19_g15 E 2d ................................FAIL! rc= 5
065 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 6

sc001 is a pre-existing failure; bl991 and bl992 failed because these tests did 
not exist in the baseline code

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB 

===============================================================
===============================================================

Tag name: cam3_6_29
Originator(s): eaton
Date: Thu Feb 19 11:44:19 MST 2009
One-line Summary: fixes for cam3_5 version; no chem preproc for trop_bam;
                : update emissions

Purpose of changes:

. Apply fixes to restore the cam3_5 version (use "-phys cam3_5" option to
  configure).  This is a combination of adding some control logic in the
  source code, and appropriately setting the default values of some
  namelist variables which is accomplished via mods to build-namelist.  The
  changes are:
  - cloud_fraction fixed so the new algorithms for ice cloud fraction are
    only invoked for the MG microphysics package.
  - set the default value of fcrit2 in gw_drag to 0.5 for CAM3 and CAM3_5
    physics.  The default in the current code is 1.0.
  - set fft_flt=0 for CAM3 and CAM3_5 versions.  This only applies to the FV
    dycore.  The current default is fft_flt=1 (which required building with
    ALT_PFT defined in the CAM3 and CAM3_5 versions of the code).

  Note 1: There are still some differences from the CAM3_5 version of the physics
  present in the current code:
  - The radiation code now uses a mass based relative humidity (rh) calc
    rather than a mole based one.  This is for consistency with other calcs
    of rh in the moist physics.
  - The radiation code assumes that the constituents are dry mixing ratios
    rather than moist when computing optical depths.  
  - the sea salt optics for camrt are now computed using two bins (coarse
    and accumulation modes) instead of one.  These optics calculations now
    depend on the available optics files.  We'd need some code modification
    along with a new optics file to enable a 1-bin version of sea salt
    optics used by cam3_5.

  Note 2: The above changes also apply to the cam3 physics.  But cam3
  physics is still not working due to the Neale/Richter convection mods not
  being optional.  This is still on the to do list.

. Remove the need to run the chemistry preprocessor for prognostic BAM
  (trop_bam).

. Update srf emission and external forcing files for both BAM and MAM to use
  the AEROCOM files for year 2000 (trop_mam3 was already using these files)
 
. Update CICE to cice4_0_20090211

. Update the 1870_prog_aero use case to use the aerocom emissions.
  Update the 1870_control use case to remove the trop_mam3 attribute from
  the emission datasets.  These datasets are used by either BAM or MAM
  prognostic aerosols.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: 

. have build-namelist set the default values of the variables in the
  phys_control module, i.e., deep_scheme, eddy_scheme, shallow_scheme,
  srf_flux_avg, and microp_scheme, so that CAM version specific defaults
  will be set.  build-namelist also made responsible for setting fcrit2 and
  fft_flt.

List any changes to the defaults for the boundary datasets:

. use aerocom 2000 files for BAM and MAM
<!-- BAM and MAM aerosol emissions -->
<dms_emis_file	   >atm/cam/chem/trop_mozart_aero/emis/aerocom_DMS_2000.c080417.nc</dms_emis_file>
<cb1_emis_file	   >atm/cam/chem/trop_mozart_aero/emis/aerocom_CB1_2000.c080807.nc</cb1_emis_file>
<oc1_emis_file	   >atm/cam/chem/trop_mozart_aero/emis/aerocom_OC1_2000.nosoa.c080807.nc</oc1_emis_file>
<SOAG_emis_file	   >atm/cam/chem/trop_mozart_aero/emis/aerocom_SOAG_2000.c080926.nc</SOAG_emis_file>
<so2_emis_file	   >atm/cam/chem/trop_mozart_aero/emis/aerocom_SO2_surface_2000.c080807.nc</so2_emis_file>
<so4_emis_file	   >atm/cam/chem/trop_mozart_aero/emis/aerocom_SO4_surface_2000.c080807.nc</so4_emis_file>
<so2_vrt_emis_file >atm/cam/chem/trop_mozart_aero/emis/aerocom_SO2_vertical_2000.c080807.nc</so2_vrt_emis_file>
<so4_vrt_emis_file >atm/cam/chem/trop_mozart_aero/emis/aerocom_SO4_vertical_2000.c080807.nc</so4_vrt_emis_file>

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

Files from chemistry preprocessor added to src/chemistry/trop_bam/
A         chem_mods.F90
A         m_het_id.F90
A         mo_adjrxt.F90
A         mo_imp_sol.F90
A         mo_indprd.F90
A         mo_lin_matrix.F90
A         mo_lu_factor.F90
A         mo_lu_solve.F90
A         mo_nln_matrix.F90
A         mo_phtadj.F90
A         mo_prod_loss.F90
A         mo_setrxt.F90
A         mo_sim_dat.F90
A         m_rxt_id.F90
A         m_spc_id.F90

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update CICE to cice4_0_20090211

models/atm/cam/bld/build-namelist
. add defaults for deep_scheme, eddy_scheme, shallow_scheme, srf_flux_avg
. add default for fcrit2 (non-WACCM runs only)
. add default for fft_flt
. fix bug in sub add_default.  Needed to check for a defined return value
  from get_default_value rather than a true or false return value.  The
  valid return value "0" was causing the check to fail.

models/atm/cam/bld/configure
. add section analogous to the one for trop_mam3 in the section that
  invokes the chem preprocessor.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add default values for deep_scheme, eddy_scheme, shallow_scheme,
  srf_flux_avg 
. add default values for fcrit2 (depends of cam version)
. add default values for fft_flt (depends on cam version)
. use aerocom 2000 files for BAM and MAM

models/atm/cam/bld/namelist_files/namelist_definition.xml
. move the phys_control namelist variables into group phys_ctl_nl

models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
. Update the 1870_prog_aero use case to use the aerocom emissions.
  Update the 1870_control use case to remove the trop_mam3 attribute from
  the emission datasets.  These datasets are used by either BAM or MAM
  prognostic aerosols.  Currently these use cases are identical.

models/atm/cam/src/control/runtime_opts.F90
. replace phys_{default,set}opts methods by phys_ctl_readnl.  phys_control
  module now reads it's own namelist.
. remove unused indforce variable

models/atm/cam/src/physics/cam/cloud_fraction.F90
. add logic to only do new cloud ice fraction calculation for MG
  microphysics and to return the cloud fraction for cam3_5 physics
  overwise.

models/atm/cam/src/physics/cam/gw_drag.F90
. remove setting default value of fcrit2

models/atm/cam/src/physics/cam/phys_control.F90
. replace the phys_{default,set}opts methods with phys_ctl_readnl so this
  module reads it's own namelist.
. Since the default physics packages depend on what physics version we want
  to run, allow build-namelist to set the defaults rather than hardcoding
  them.  Remove the hardcoding of initial values in the module variables.

models/atm/cam/src/physics/cam/radiation.F90
. Remove radforce, indforce, and associated diagnostics.  This isn't
  supported by the new aerosol-radiation interfaces.

models/atm/cam/src/physics/rrtmg/radiation.F90
. Remove radforce and indforce module variables.  This isn't
  supported by the new aerosol-radiation interfaces.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
059 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 6

bl381 fails due to changing the emission datasets in the 1870_prog_aero use case
bl731 fails because it uses cam3 physics which changed (bug fixes)
sc001 is a pre-existing failure

bangkok/lf95: All PASS except:

037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7

bl315 fails due to changes in cam3 physics (bug fixes)

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except for configs using cam3 or
  cam3_5 physics, and for prognostic BAM due to updating the emission
  datasets (both present day (year 2000) and pre-industrial (year 1750)
  emissions).

===============================================================
===============================================================

Tag name: cam3_6_28
Originator(s): eaton, mflanner
Date: Tue Feb 10 09:23:00 MST 2009
One-line Summary: send trop_mam3 aerosol deposition fluxes to the coupler

Purpose of changes:

. Add the aerosol deposition fluxes to CAM's export state.  These fields
  are copied to the coupler.  Currently this is only being done for the
  trop_mam3 aerosols.  Eventually CAM will always be responsible for
  providing these fluxes, even in prescribed aerosol modes.

. Update CICE tag to cice4_0_20090209

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none known

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/chemistry/modal_aero/modal_aero_deposition.F90
. This module contains the subroutines that are responsible for
  partitioning the deposition fluxes of the modal aerosol components into
  the fluxes passed through the coupler.

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. Update CICE tag to cice4_0_20090209

models/atm/cam/bld/build-namelist
. use cice config cache filepath from config_cache file when issuing CICE
  build-namelist command. 

models/atm/cam/bld/config_files/definition.xml
. add cice_config_cache_file

models/atm/cam/bld/configure
. write the filepath for the CICE config_cache file to CAM's config_cache
  file so that CAM's configure knows where it is when it invokes the CICE
  build-namelist. 

models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
. add cam_out to arg list of mz_aero_{wet,dry}_intr
. add dry/wet fluxes for each modal constituent to local var
. call new methods, set_srf_drydep and set_srf_wetdep, to partition
  contributions from modal constituents into fields passed to coupler.

models/atm/cam/src/control/atm_comp_mct.F90
. copy fluxes from cam export state into coupler buffer

models/atm/cam/src/control/camsrfexch_types.F90
. add aerosol deposition fluxes to cam export type
. initialize values to 0. for trop_mam3, to shr_const_spval otherwise.

models/atm/cam/src/physics/cam/aerosol_intr.F90
. add cam_out to actual args of mz_aero_wet_intr and mz_aero_dry_intr
. add cam_out to dummy args of aerosol_wet_intr and aerosol_drydep_intr

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. add new method, diag_export, to make outfld calls for the deposition
  fluxes that are being passed to the coupler

models/atm/cam/src/physics/cam/physpkg.F90
. modify calling args to diag_surf (cleanup)

models/atm/cam/src/physics/cam/restart_physics.F90
. add 8 drydep components of cam_out to both the pio and serial code
  sections. 

models/atm/cam/src/physics/cam/tphysac.F90
. add cam_out to actual args of aerosol_drydep_intr

models/atm/cam/src/physics/cam/tphysbc.F90
. add cam_out to actual args of aerosol_wet_intr
. call diag_export at end of subroutine.  This is the state that is copied
  to the coupler.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
059 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 6

This failure is pre-existing.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB.

===============================================================
Tag name: cam3_6_27
Originator(s): eaton,andrew,mvr
Date: 02 Feb 2009
One-line Summary: Make trop_mam3 the default chemistry; integrate MAM with the MG microphysics.

Purpose of changes:

. Make trop_mam3 the default chemistry.
  - Don't require running the chemistry preprocessor for predefined chemistry
    schemes; currently only trop_mam3 has been reimplemented this way.
  - Add tuning to modal aerosols from Xiaohong.
  - Add boundary layer nucleation from Xiaohong.

. MG microphysics changes
  - add MG microphysics bug fix for diagnostic field used by wet dep codes
  - ice microphysics mods; MAM tuning
  - hook immersion freezing to modal dust

. Update RRTMG external
  - update rrtmg to latest tag, rrtmg_081203, which includes change to sw
    surface fluxes needed to balance the surface energy budget.

. changes for regression testing
  - modified the offline driver test to run at 1.9x2.5
  - change mo_apex.F90 to calculate latitude midpoints inline rather than
    relying on a quantity (clat_staggered) that's not available from all the
    dycores.  This is to get the regression tests working for the spectral
    dycores.
  - Removed the gensom and som config files from the regression tests.

. new external tags for almost all components to emulate current ccsm beta tags

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

. default chemistry set to trop_mam3

. Don't require running the chemistry preprocessor for predefined chemistry
  schemes; currently only trop_mam3 has been reimplemented this way.

. Refactor configure's -chem option.  This needed to be done to provide a way
  to turn off the default trop_mam3 chemistry.  At the same time, the
  overloaded use of "-chem none" to imply that the CAM3 prescribed aerosols
  and ozone were being used was removed.  Now "-chem none" is used to turn
  off all prognostic chemistry without implying which prescribed aerosols or
  ozone are used.  To do that new valid values, cam3 and cam3_5, have been
  added to the -phys argument.  "-phys cam3" now implies "-chem none" and
  that the CAM3 prescribed aerosols and ozone will be used.  This is not yet
  a completely implemented backwards compatibility switch for CAM3 physics
  because the Richter/Neale convection mods are still hardwired.  But the
  intention is to have the "-phys cam3" option eventually provide the
  complete CAM3 physics package.  "-phys cam3_5" also implies "-chem none",
  but instead of the CAM3 aerosols and ozone, the newer prescribed BAM
  aerosols and the ozone dataset from J.F. Lamarque will be used.

  In addition to the new configure functionality, quite a bit of new error
  checking has been added to try and prevent building the model with
  inconsistent physics packages.

. The -gensom and "-ocn som" options were removed from configure.  The new
  SOM functionality is currently only available via the CCSM scripts.

Describe any changes made to the namelist:
. option added to allow cam's build-namelist to call build-namelist for cice

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
. trop_mam3 is much more expensive than prescribed BAM

. the build will be faster when the chemistry preprocessor isn't needed

Code reviewed by: Brian Eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/config_files/f10sdm
D      models/atm/cam/test/system/config_files/f4gdh
D      models/atm/cam/test/system/config_files/f4sdh
D      models/atm/cam/test/system/config_files/e8sdm
D      models/atm/cam/test/system/config_files/e32sdh
D      models/atm/cam/test/system/config_files/s8sdm
D      models/atm/cam/test/system/config_files/e64sm
D      models/atm/cam/test/system/config_files/s32sdh
. obsolete test files containing configure options

D      models/atm/cam/test/system/tests_posttag_bluevista
. removed file for obsolete machine

List all subroutines added and what they do:
A  +   models/atm/cam/test/system/config_files/fmo1.9dh
- new test file containing configuration options for offline driver test

A  +   models/atm/cam/test/system/config_files/s8dm
. replacement test file containing configuration options

A  +   models/atm/cam/test/system/nl_files/off1.9x2.5
. new test file containing namelist options for offline driver test

A  +   models/atm/cam/bld/namelist_files/use_cases/1870_bam.xml
. new use case for prescribed BAM aerosols

A  +   models/atm/cam/src/chemistry/trop_mam3
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_lu_solve.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_setrxt.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_adjrxt.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_imp_sol.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/chem_mods.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_prod_loss.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_lin_matrix.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/m_rxt_id.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_phtadj.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_nln_matrix.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/m_het_id.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_lu_factor.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_indprd.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/mo_sim_dat.F90
A  +   models/atm/cam/src/chemistry/trop_mam3/m_spc_id.F90
. preprocessor output for trop_mam3

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TCB.sh
. added -cice_decomptype to configure call

M      models/atm/cam/test/system/tests_pretag_bluefire
. modified list of default tests for pretag testing of machine bluefire

M      models/atm/cam/test/system/config_files/f10c3dm
. use "-phys cam3" in place of "-chem none -microphys rk -rad camrt"

M      models/atm/cam/test/system/config_files/h16x4dm
. modified the test file used for configuration options for homme test

M      models/atm/cam/test/system/config_files/scm64bfbiop
M      models/atm/cam/test/system/config_files/e64bfbiop
M      models/atm/cam/test/system/config_files/scmarmiop
- added -chem "none" to configuration options of scam tests as temporary fix

M      models/atm/cam/test/system/tests_pretag_bangkok
. modified list of pretag tests to fit in time constraints

M      models/atm/cam/test/system/TBR.sh
. set the cice_ic var with the restart filename only (not absolute path)
. modified call to build-namelist for cice changes; cleanup

M      models/atm/cam/test/system/test_driver.sh
. added env var to allow specification of batch queue

M      models/atm/cam/test/system/TER.sh
. modified call to build-namelist for cice changes

M      models/atm/cam/test/system/nl_files/scm_prep
. changed the names in the fincl2 list to match the untruncated names

M      models/atm/cam/test/system/input_tests_master
. change the *382 tests to use the new use case 1870_bam.xml.  This
  preserves the test of prescribed bam aerosols.
. change e32sdh to e32dh
. change e64sm to e64m
. change e8sdm to e8dm
. change f10sdm to f10dm
. change f4gdh to f4dh
. change f4sdh to f4dh
. change s8sdm to s8dm

M      models/atm/cam/test/system/TSM.sh
. modified call to build-namelist for cice changes

M      models/atm/cam/bld/configure
. make trop_mam3 the default value for chem.
. add conditional logic to not call chem_preprocess when the chem package
  is trop_mam3.  This requires correctly setting $chem_nadv, $chem_cppdefs,
  and the 'chem_src_dir' entry in the configure object.
. fix bug in setting chem_pkg when phys is ideal or adiabatic
. modify how the default chemistry package is set.
. add error checking for inconsistent settings of physics and chemistry
  packages.
. add error checking for inconsistent settings of radiation and
  microphysics packages.  The defaults for both these packages has moved
  from the definition file to configure since they depend on the setting of
  the physics package.
. remove -gensom and "-ocn som" options.  SOM is only supported via the
  CCSM scripts.
. mods needed for cice build changes; additions for ocn,lnd,glc stub code

M      models/atm/cam/bld/Makefile.in
. -DHAVE_GETTIMEOFDAY added to cppdefs (required to control output of new
  timing code)

M      models/atm/cam/bld/config_files/definition.xml
. change valid value for phys: cam1 -> cam, and add cam3 and cam3_5.
. mods in connection with stub code additions

M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update filenames of aerocom emissions for 2000
. add dst_0.47x0.63_c081217.nc for 1/2 degree soil_erod default
. update the CLM entries to be as consistent with the CLM version as
  possible.
. Add the entries for fsnowoptics, fsnowaging, faerdep.

M      models/atm/cam/bld/namelist_files/namelist_definition.xml
. add definitions for fsnowoptics, fsnowaging, faerdep.

M      models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
. update for trop_mam3 chemistry

M      models/atm/cam/bld/build-namelist
. add defaults for fsnowoptics, fsnowaging, faerdep.
. add co2_ppmv.  Take this from the value set for CAM and convert vmr to
ppmv.
. change the way CAM3 physics is specified.  Currently uses $chem eq 'none'
  change to $phys eq 'cam3'.  The cam3_5 option should use the prescribed
  BAM aerosols and JF's prescribed ozone.
. Don't try to create CLM or CICE namelists if the physics mode doesn't use
  an active land or ice component.  Currently that's true for the ideal,
  adiabatic, and aqua_planet modes.
. option added to allow cam's build-namelist to call build-namelist for cice

M      models/atm/cam/bld/camdom.cpl7.template
M      models/atm/cam/bld/cam.cpl7.template
. update .template files for ccsm4_0_beta07 (and later) tags

M      models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. from rrtmg_081029 to rrtmg_081203

M      models/atm/cam/src/control/scamMod.F90
. change declarations for alphanam(pcnst) and dqfxnam(pcnst) from char*8 to
  char*16 so the names aren't truncated.

M      models/atm/cam/src/control/atm_comp_mct.F90
. compute nextsw_cday at init time for startup runs only

M      models/atm/cam/src/physics/cam/cldwat2m.F90
. remove temp vars nevapr1, evapsnow1, prain1, prodsnow1, cmeout1.  They
  were being zeroed incorrectly inside the iteration where they were
  supposed to be accumulating quantities over sub-steps.
. replace DOS with UNIX endlines
. immersion freezing hooks in modal dust

M      models/atm/cam/src/physics/cam/stratiform.F90
M      models/atm/cam/src/physics/cam/cloud_fraction.F90
M      models/atm/cam/src/physics/cam/wv_saturation.F90
. ice microphysics mods from Andrew Gettleman
. immersion freezing hooks in modal dust

M      models/atm/cam/src/physics/cam/aerosol_intr.F90
. immersion freezing hooks in modal dust

M      models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
M      models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
. fix declaration of dotend -- was pcnstxx, changed to pcnst.
. mods for boundary layer nucleation from xiaohong

M      models/atm/cam/src/physics/cam/tphysac.F90
M      models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M      models/atm/cam/src/chemistry/mozart/chemistry.F90
. mods for boundary layer nucleation from xiaohong

M      models/atm/cam/src/chemistry/mozart/mo_apex.F90
. replace reference to clat_staggered by inline calculation of latitude
midpoints.

M      models/atm/cam/src/chemistry/mozart/mo_drydep.F90
. In subroutine interp_map change veg_ext from 10 to 20.

M      models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
. Add tuning to modal aerosols from Xiaohong.

M      SVN_EXTERNAL_DIRECTORIES
. new tags for almost all components to emulate current ccsm beta tags

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
004 bl132 TBL.sh e32dh ghgrmp 9s ..................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4dh co2rmp 9s ...................................FAIL! rc= 7
019 bl332 TBL.sh f4dh ghgrmp 9s ...................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl370 TBL.sh fmo1.9dh off1.9x2.5 9s ...........................FAIL! rc= 5
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_bam 9s ..................FAIL! rc= 5
058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7
059 sc001 TSC.sh e64bfbiop scm_prep scm64bfbiop scm_b4b_o1 7s .....FAIL! rc= 4
- all baselines failed except for adiabatic and ideal physics (this was expected)
- scam test has been broken, a fix is in the works
	
bangkok/lf95:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8dm ghgrmp 9s ...................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
021 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
029 bl312 TBL.sh f10dm ghgrmp 9s ..................................FAIL! rc= 7
031 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
034 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
037 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
040 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
- all baselines failed except for adiabatic and ideal physics (this was expected)

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: new climate
. There are answer changes due to all of the following
  - Updates in both the MAM and MG microphysics, as well as integrating those
    packages to work together.
  - New RRTMG tag with modified SW surface fluxes.
  - Answer changes from updated CLM and CICE tags.

===============================================================
	
Tag name: cam3_6_26
Originator(s): Francis Vitt
Date: 24 Dec 2008
One-line Summary: Addition of the LLNL super fast chemistry 

Purpose of changes: 

  Provide a less expensive option for interactive chemistry

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

  Added configure option:
    -chem super_fast_llnl
	
Describe any changes made to the namelist:

  Replaced "photopath" namelist variable with "exo_coldens_file", 
  "tuv_xsect_file", and "o2_xsect_file". 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:
	
A    models/atm/cam/bld/config_files/defaults_super_fast_llnl.xml
  - configure defaults for the super_fast_llnl chem
	
A    models/atm/cam/src/chemistry/mozart/llnl_O1D_to_2OH_adj.F90
A    models/atm/cam/src/chemistry/mozart/llnl_set_chem_trop.F90
  - for super_fast_llnl chem
	
A    models/atm/cam/src/chemistry/mozart/lin_strat_chem.F90
A    models/atm/cam/src/chemistry/mozart/linoz_data.F90
  - for linoz ozone speicification in the stratosphere
	
List all existing files that have been modified, and describe the changes:


M    models/atm/cam/bld/configure
M    models/atm/cam/bld/config_files/definition.xml
  - configure -chem super_fast_llnl option added

M    models/atm/cam/bld/chem_preprocess.pl
  - changed location of the chemistry preprocessor to models/atm/cam/chem_proc
  - super_fast_llnl option added
	
M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
  - new chem IC files added
  - defaults for super_fast_llnl chemistry
	
M    models/atm/cam/bld/namelist_files/namelist_definition.xml
  - replaced "photopath" namelist variable with 
   "exo_coldens_file", "tuv_xsect_file", and "o2_xsect_file". 
  - linoz options added 
  - tropopause level options added
	
M    models/atm/cam/bld/build-namelist
  - changes for super_fast_llnl chem
  - replaced "photopath" namelist variable with "exo_coldens_file", 
    "tuv_xsect_file", and "o2_xsect_file". 
	
M    models/atm/cam/src/physics/cam/eddy_diff.F90
  - change to appease lf95 compiler
	
MM   models/atm/cam/src/chemistry/utils/tracer_data.F90
  - mods to read zonal-averaged LINOZ data
	
M    models/atm/cam/src/chemistry/mozart/mo_aero_settling.F90
  - fixed potential array out-of-boounds error
	
M    models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
  - changes for super_fast_llnl and linoz
	
M    models/atm/cam/src/chemistry/mozart/mo_seto2.F90
  - changed photopath to o2_xsect_file

M    models/atm/cam/src/chemistry/mozart/mo_tropopause.F90
  - cleanup
	
M    models/atm/cam/src/chemistry/mozart/mo_exp_sol.F90
  - added ability to specify top pressure level to apply solver

M    models/atm/cam/src/chemistry/mozart/mo_chemini.F90
  - chemistry options change
	
M    models/atm/cam/src/chemistry/mozart/mo_synoz.F90
M    models/atm/cam/src/chemistry/mozart/mo_fstrat.F90
  - SYNOZ bug fix
	
M    models/atm/cam/src/chemistry/mozart/mo_setinv.F90
  - change for super_fast_llnl
	
M    models/atm/cam/src/chemistry/mozart/chemistry.F90
  - chemistry options change
  - changes for super_fast_llnl and linoz
  
M    models/atm/cam/src/chemistry/mozart/mo_tuv_inti.F90
M    models/atm/cam/src/chemistry/mozart/mo_photo.F90
  - replaced "photopath" namelist variable with "exo_coldens_file", 
    "tuv_xsect_file", and "o2_xsect_file". 

M    models/atm/cam/src/chemistry/mozart/efield.F90
  - waccm change provided by HAO
	
M    models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
  - changes for super_fast_llnl and linoz
	
M    models/atm/cam/SVN_EXTERNAL_DIRECTORIES
M    SVN_EXTERNAL_DIRECTORIES
  - changed location of the chemistry preprocessor to models/atm/cam/chem_proc

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
  A science change in efield.F90 caused this failure

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_25
Originator(s): pworley
Date: Wed Dec 18 10:25:45 MST 2008
One-line Summary: generalize and optimize load balancing options

Purpose of changes: 

1) Generalize the definition of load balancing options
0, 1, 3, and 4 to be able to use more processes in the physics than in
the dynamics.

Previously there was support for using additional
processes in the physics only when specifying the most aggressive
load balancing (phys_loadbalance==2). The other options have been
generalized to assign work to all physics processes.
For example, phys_loadbalance==0 will now distribute work
to otherwise idle processes, but will (still) not trade work with
other processes active during the dynamics. When the number of
physics and dynamics processes are the same, the behavior of
the load balancing options is unchanged.

2) Introduce new default communication option for physics 
load balancing (phys_alltoall = -1) that uses information about
nature of the communication to choose between a point-to-point
algorithm and an MPI collective.

When using more physics processes than dynamics processes, and
when using load balancing options other than phys_loadbalance=2,
most processes send and receive data to/from only a small number of
the other processes. In these situations, a point-to-point implementation
of the data arrangment is often faster than calling MPI_Alltoallv.
This observation is now "implemented" in the code. It can be overridden
by setting phys_alltoall to 0 (to use collective) or 1 (to use
point-to-point algorithm).

3) Performance optimizations in FV (mod_comm and geopk_d) 
and dynamics/physics MPI communications (spmd_util).

Eliminated sending/receiving zero length messages in one
of the communication options in both the FV transposes and
in the physics/dynamics transposes. Also added support for
the mpi_isend/mpi_send option (modc_send_cdcore) to the
geopk_d algoritm.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: 

- Changed the range of phys_alltoall to include -1, and made -1 the default.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

- Performance improved at scale, especially when using more physics 
processes than dynamics processes

Code reviewed by: Mirin

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

   models/atm/cam/src/physics/cam:
     phys_grid.F90 - generalized load balancing options; 
                     changed phys_alltoall default

   models/atm/cam/src/utils:
     spmd_utils.F90 - eliminated zero-length messages when not using
                      handshaking protocol

   models/utils/pilgrim:
     mod_comm.F90  - eliminated zero-length messages when not using
                     handshaking protocol

   models/atm/cam/src/dynamics/fv:
     cd_core.F90       - changed parameters in call to geopk_d
     geopk.F90         - added modc_send_cdcore option to geopk_d
     dynamics_vars.F90 - updated comments
     spmd_dyn.F90      - updated comments
     dp_coupling.F90   - zeroed out uninitialized array elements being
                          communicated during load balancing

   models/atm/cam/src/dynamics/eul:
     spmd_dyn.F90      - initialized work array used in load balancing

   models/atm/cam/src/dynamics/sld:
     spmd_dyn.F90      - initialized work array used in load balancing

   models/atm/cam/bld/namelist_files:
      namelist_definition.xml - updated descriptions
	
   models/atm/cam/src/control:
      runtime_opts.F90 - updated comments
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: ALL PASS

bangkok/lf95: ALL PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): NO CHANGES (bfb)

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_6_24
Originator(s): eaton
Date: Fri Dec 12 15:02:11 MST 2008
One-line Summary: remove PIO as part of CAM component when building for CCSM

Purpose of changes:

. Remove PIO as part of CAM component when building for CCSM.  This backs
  out a hack added in cam3_6_19 for the CCSM build.

  *** This change doesn't affect the CAM standalone build and has not been
      run through all the usual pretag regression testing.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:

. As noted above when building for CCSM.

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/configure
. Don't build PIO as part of CAM component for CCSM build.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: not done.

bangkok/lf95: not done.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_23
Originator(s): eaton, pworley, mvertens
Date: Tue Dec  9 12:35:36 MST 2008
One-line Summary: update interpic_new, scripts tag; misc

Purpose of changes:

. Substantial update to interpic_new code.  See tools/interpic_new/README
  for details.  This includes mods from Mark Taylor to deal with large files.

. Mod to phys_grid.F90 that was left out of the cam3_6_21 commit (from
  Pat Worley). 

. Mods to run on BGP.

. Cleanup: put config_* files into config_files/*

. update scripts external to scripts4_081207.

. updated cam.cpl7.template file (from Mariana Vertens).

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/bld/config_defaults_eul.xml
models/atm/cam/bld/config_defaults_fv.xml
models/atm/cam/bld/config_defaults_homme.xml
models/atm/cam/bld/config_defaults_sld.xml
models/atm/cam/bld/config_defaults_trop_bam.xml
models/atm/cam/bld/config_defaults_trop_ghg.xml
models/atm/cam/bld/config_defaults_trop_mam3.xml
models/atm/cam/bld/config_defaults_trop_mam7.xml
models/atm/cam/bld/config_defaults_trop_mozart.xml
models/atm/cam/bld/config_defaults_waccm_ghg.xml
models/atm/cam/bld/config_defaults_waccm_mozart.xml
models/atm/cam/bld/config_definition.xml
models/atm/cam/bld/config_definition.xsl
models/atm/cam/bld/config_horiz_grid.xml
models/atm/cam/bld/config_sys_defaults.xml
. moved to subdirectory config_files/ and renamed

models/atm/cam/tools/interpic_new/interp_driver.F90
models/atm/cam/tools/interpic_new/varspecs_mod.F90

List all subroutines added and what they do:

models/atm/cam/bld/config_files/defaults_eul.xml
models/atm/cam/bld/config_files/defaults_fv.xml
models/atm/cam/bld/config_files/defaults_homme.xml
models/atm/cam/bld/config_files/defaults_sld.xml
models/atm/cam/bld/config_files/defaults_trop_bam.xml
models/atm/cam/bld/config_files/defaults_trop_ghg.xml
models/atm/cam/bld/config_files/defaults_trop_mam3.xml
models/atm/cam/bld/config_files/defaults_trop_mam7.xml
models/atm/cam/bld/config_files/defaults_trop_mozart.xml
models/atm/cam/bld/config_files/defaults_waccm_ghg.xml
models/atm/cam/bld/config_files/defaults_waccm_mozart.xml
models/atm/cam/bld/config_files/definition.xml
models/atm/cam/bld/config_files/definition.xsl
models/atm/cam/bld/config_files/horiz_grid.xml
models/atm/cam/bld/config_files/sys_defaults.xml
. moved from the bld/ subdirectory and renamed (remove config_ prefix)

models/atm/cam/tools/interpic_new/interp.F90
models/atm/cam/tools/interpic_new/interpolate_data.F90
models/atm/cam/tools/interpic_new/shr_kind_mod.F90
. interpic_new refactoring

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. change scripts external to scripts4_081207.

models/atm/cam/bld/build-namelist
. replace instances of $defaults->get_value by get_default_value.  This is
  so that the use case setting affects the default values.

models/atm/cam/bld/cam.cpl7.template
. cam's dtime is set based on $ATM_NCPL
. mods to incorporate $CAM_CONFIG_OPTS arg to configure.  This replaces the
  more specific $CAM_CHEM.
. remove broken CO2 cycle code.  Will reimplement as required.
. $CAM_USE_CASE replaced by $CAM_NML_USE_CASE.

models/atm/cam/bld/Makefile.in
. mods to the BGP section

models/atm/cam/bld/configure
. change names of config_*.xml files to config_files/*.xml

models/atm/cam/bld/namelist_files/use_cases/1870-2000_control.xml
.  Remove tracer_cnst_file from use case xml file since the default chem is
   not using prognostic aerosols.  Also remove the scon setting since that
   now comes from the general defaults.

models/atm/cam/test/system/test_driver.sh
. increase queue time on bluefire to 4:28 (from 3:28)

models/atm/cam/src/control/cam_history.F90
. remove endrun condition if LOGNAME isn't found in environment

models/atm/cam/src/control/ioFileMod.F90
. remove unused "use shr_sys_mod" and "use shr_file_mod

models/atm/cam/src/control/print_memusage.F90
. add BGP to the ifdef that avoids calling get_memusage

models/atm/cam/src/physics/cam/phys_grid.F90
. replace some mpigather* calls by fc_gather*

models/atm/cam/tools/interpic_new/Makefile
models/atm/cam/tools/interpic_new/README
models/atm/cam/tools/interpic_new/compare_var.F90
models/atm/cam/tools/interpic_new/control.F90
models/atm/cam/tools/interpic_new/cpvar.F90
models/atm/cam/tools/interpic_new/dimensions.F90
models/atm/cam/tools/interpic_new/driver.F90
models/atm/cam/tools/interpic_new/fill_positions.F90
models/atm/cam/tools/interpic_new/fmain.F90
models/atm/cam/tools/interpic_new/handle_special_cases.F90
models/atm/cam/tools/interpic_new/is_special_case.F90
models/atm/cam/tools/interpic_new/wrap_nf.F90
. update interpic_new

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_22
Originator(s): Xiaohong Liu, Francis Vitt
Date: 5 Dec 2008
One-line Summary: Incorporate the Modal Aerosol Model (MAM)

Purpose of changes:  

  Provide more aerosol model options. In addition the the bulk
  aerosol model, 3-mode and 7-mode modal models have been 
  incorporated with radiation feed-backs on the climate.  

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

 Changes to the configure utility:
  -chem options added:
     trop_mam3 (3-mode model)
     trop_mam7 (7-mode model)
  -chem option change:
     trop_aero --> trop_bam (bulk aerosol model)

Describe any changes made to the namelist:

 New namelist variables:
   modal_optics (char*256)
     dataset for modal aerosol optics

   aer_drydep_list (char*16(1000))
     list of modal aerosol species that undergo dry deposition

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D      models/atm/cam/bld/config_defaults_trop_aero.xml

List all subroutines added and what they do:

A      models/atm/cam/bld/config_defaults_trop_mam7.xml
A      models/atm/cam/bld/config_defaults_trop_mam3.xml
A      models/atm/cam/bld/config_defaults_trop_bam.xml
 - added configure options "-chem trop_mam7" and "-chem trop_mam3"
 - replaced the "-chem trop_aero" with "-chem trop_bam"
	
A      models/atm/cam/src/physics/cam/miesubs.F
A      models/atm/cam/src/physics/cam/modal_aer_opt.F90
A      models/atm/cam/src/physics/cam/ndrop.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_rename.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_coag.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_data.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_gasaerexch.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_initialize_data.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_wateruptake.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_calcsize.F90
A      models/atm/cam/src/chemistry/modal_aero/modal_aero_newnuc.F90
 - files added for MAM

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/test/system/config_files/fma1.9h
M      models/atm/cam/test/system/config_files/fma1.9m
 - change "-chem trop_aero" to "-chem trop_bam"
	
M      models/atm/cam/bld/configure
M      models/atm/cam/bld/chem_preprocess.pl
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/config_definition.xml
 - implemented configure and build-namelist changes for MAM 
	
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/wrap_nf.F90
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/filenames.F90
M      models/atm/cam/src/physics/cam/progseasalts_intr.F90
M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/cam/dust_intr.F90
M      models/atm/cam/src/physics/cam/tphysbc.F90
M      models/atm/cam/src/physics/cam/cldwat2m.F90
M      models/atm/cam/src/physics/cam/aer_rad_props.F90
M      models/atm/cam/src/physics/cam/radsw.F90
M      models/atm/cam/src/physics/cam/phys_prop.F90
M      models/atm/cam/src/physics/cam/stratiform.F90
M      models/atm/cam/src/physics/cam/radlw.F90
M      models/atm/cam/src/physics/cam/rad_constituents.F90
M      models/atm/cam/src/physics/cam/wetdep.F90
M      models/atm/cam/src/physics/cam/cloud_fraction.F90
M      models/atm/cam/src/physics/cam/carbon_intr.F90
M      models/atm/cam/src/physics/cam/sulchem.F90
M      models/atm/cam/src/physics/cam/wv_saturation.F90
M      models/atm/cam/src/physics/cam/aerosol_intr.F90
M      models/atm/cam/src/physics/cam/tphysac.F90
M      models/atm/cam/src/physics/cam/qneg3.F90
M      models/atm/cam/src/physics/cam/vertical_diffusion.F90
M      models/atm/cam/src/physics/rrtmg/radlw.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90
M      models/atm/cam/src/physics/rrtmg/radsw.F90
M      models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
M      models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
M      models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
M      models/atm/cam/src/chemistry/mozart/chemistry.F90
M      models/atm/cam/src/chemistry/mozart/mo_drydep.F90
M      models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
M      models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
M      models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
M      models/atm/cam/src/chemistry/mozart/mo_setsox.F90
 - source code files changed to implement MAM 

M      models/atm/cam/src/chemistry/mozart/mo_photo.F90
M      models/atm/cam/src/chemistry/mozart/mo_photoin.F90
 - changes needed to use fast-tuv photolyis in MAM

M      models/atm/cam/src/chemistry/mozart/mo_jlong.F90
M      models/atm/cam/src/chemistry/mozart/mo_chemini.F90
 - reduced the memory overhead for the table-lookup photolysis method
	
M      SVN_EXTERNAL_DIRECTORIES
 - new chem_proc tag (chemistry preprocessor)
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:

030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7

  These baseline failures are expected.  These are caused by changes in 
  the photolysis routines and input datasets.
	
bangkok/lf95: All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_21
Originator(s): Art Mirin, Pat Worley
Date: 
One-line Summary: Improvements to communication, other misc. improvements

Purpose of changes: Improve communication performance at scale.

Changes are bit-for-bit.

MPI performance in CAM for runs with large numbers of processes has proven 
to be erratic in certain circumstances, sometimes even leading to failures
due to exhaustion of system buffer space. Aspects of this behavior have been 
observed on three different platforms (Atlas at LLNL, Cray XT, and IBM BG/P),
and is likely to occur with some process count on all systems.

Through empirical experiments, we identified a number of communication protocols
that were implemented in the swapm routine in the spmd_utils module that eliminate 
these problems. However, no one protocol was best in all situations, so a number
of protocols were imported into the mod_comm irregular communication routines
(which are used for intra-FV-dynamics transposes, gathers and scatters,
and geopotential communications) and the choice of what to use can be 
specified at runtime. Reasonable defaults were determined, however.

As part of this exercise, we also cleaned up the swapm routine,
removing the options that are never exercised, so the logic in mod_comm and 
swapm are now very similar. 

(Fun fact: swapm communication protocols were originally developed for PSTSWM 
and were used in CCM/MP2D.)

The ALTGATHER logic, used to avoid problems on the Cray XT when too many "unexpected"
messages arrive at the root of the gather, is now supported within mod_comm as one
of the options, and is enabled by default. Similarly, new routines with robust 
behavior but without any performance degradation were made the defaults for I/O-related 
gathers for the spectral dycores.

The new communication options, implemented in the mod_comm mp_sendirr 
and mp_recvirr irregular communication routines, include:

(1) option to handshake; that is, the source will not post its send until the
corresponding receive has already been posted; this mitigates against unnecessary
contention and buffering; in this case, ready send is used instead of send.

(2) option to use blocking rather than nonblocking send.

(3) option to limit the number of outstanding message requests; this mitigates against 
exhausting buffer space and performance degradation when the number of sources and
destinations for a process during a collective operation becomes large.

(4) option to call MPI_Alltoallv. (Note, this is typically not the best choice within
the FV dycore on Atlas or on the Cray XT, but it usually is best on the IBM BG/P.)

(5) option to perform certain intra-FV-dynamics transposes in pairs.

(6) option to perform intra-FV-dynamics tracer transposes N at a time; irregular transpose 
structures were replaced with 4-D arrays; also, the partial real*4 tracer support was 
removed.

We also changed ordering of target tasks to dimensional-exchange ordering, as used in swapm,
rather than 1 to N; this mitigates against contention.

Changes were also made to the logic for error checking with the fast reproducible sum 
calculation; testing and warning message are now run-time options, off by default; in 
particular, the collective sums are computed once only unless the user requests error
checking.

Bugs fixed (include bugzilla ID): Temporary 1-line conditionally compilable patches
were added to six pio-related files, as workaround for ifort compiler bug.

Describe any changes made to build system:

Describe any changes made to the namelist: The following were added:

  modc_sw_dynrun     - mod_comm irregular underlying communication method for dyn_run/misc
  modc_hs_dynrun     - mod_comm irregular communication handshaking for dyn_run/misc (T/F)
  modc_send_dynrun   - mod_comm irregular communication send protocol for dyn_run/misc (T/F)
  modc_mxreq_dynrun  - mod_comm irregular communication nonblocking request throttle for dyn_run/misc

  modc_sw_cdcore     - mod_comm irregular underlying communication method for cd_core/geopk
  modc_hs_cdcore     - mod_comm irregular communication handshaking for cd_core/geopk (T/F)
  modc_send_cdcore   - mod_comm irregular communication send protocol for cd_core/geopk (T/F)
  modc_mxreq_cdcore  - mod_comm irregular communication nonblocking request throttle for cd_core/geopk

  modc_sw_gather     - mod_comm irregular underlying communication method for gather
  modc_hs_gather     - mod_comm irregular communication handshaking for gather (T/F)
  modc_send_gather   - mod_comm irregular communication send protocol for gather (T/F)
  modc_mxreq_gather  - mod_comm irregular communication nonblocking request throttle for gather

  modc_sw_scatter    - mod_comm irregular underlying communication method for scatter
  modc_hs_scatter    - mod_comm irregular communication handshaking for scatter (T/F)
  modc_send_scatter  - mod_comm irregular communication send protocol for scatter (T/F)
  modc_mxreq_scatter - mod_comm irregular communication nonblocking request throttle for scatter

  modc_sw_tracer     - mod_comm irregular underlying communication method for multiple tracers
  modc_hs_tracer     - mod_comm irregular communication handshaking for multiple tracers (T/F)
  modc_send_tracer   - mod_comm irregular communication send protocol for multiple tracers (T/F)
  modc_mxreq_tracer  - mod_comm irregular communication nonblocking request throttle for multiple tracers
  modc_onetwo        - one or two simultaneous mod_comm irregular communications (excl. tracers)
  modc_tracers       - max number of tracers for simultaneous mod_comm irregular communications; 
                       if 0, then use mp_sendirr/mp_recvirr to do one at a time

  fc_gather_flow_cntl - tuning option for flow-controlled gathers used by spectral dycores. 
                        Default should be sufficient, but if performance is suffering can try a 
                        different level of message request throttling.

List any changes to the defaults for the boundary datasets: NONE

Describe any substantial timing or memory changes: Certain configurations on
certain platforms run a lot faster at scale.

Code reviewed by: Eaton

List all subroutines eliminated:

  utils/pilgrim/mod_comm.F90:
    mp_swapmirr, mp_sendirr_fc, mp_sendirr_fc_r4, mp_sendirr_fc_i4

List all subroutines added and what they do:

  utils/pilgrim/mod_comm.F90:
    mp_sendtrirr,
    mp_recvtrirr  - versions of mp_sendirr/mp_recvirr for use with tracer advection

    mp_swapirr,
    mp_swapirr_i4,
    mp_swaptrirr - implements new flow-controlled and MPI_collective options, called 
                   within mp_sendirr, mp_sendirr_i4, and mp_sendtrirr, respectively

  atm/cam/src/utils/spmd_utils.F90:
    fc_gatherv,
    fc_gathervr4,
    fc_gathervint - flow-controlled gather algorithms, based on ALTGATHER code
                    formerly in control/wrap_mpi.F90 in the routines mpigatherv,
                    mpigathervr4, and mpigathervint, respectively.

    fc_gather_setopts - set fc_gather_flow_cntl, the maximum number of preposted 
                        receive requests allowed in the flow-controlled gather algorithm.
    fc_gather_defaultopts - return default value for fc_gather_flow_cntl (64)

  atm/cam/src/utils/repro_sum_mod.F90:
    repro_sum_tol_exceeded - reports whether difference between fast reproducible 
                             collective sum and fast nonreproducible collective sum
                             exceeds the specified tolerance. 

List all existing files that have been modified, and describe the changes:

  models/atm/cam/bld/namelist_files:
    namelist_definition.xml - registered new tuning parameters

  models/atm/cam/src/chemistry/utils:
    tracer_data.F90 - included pio patch for ifort on atlas

  models/atm/cam/src/control:
    binary_io.F90        - referenced renamed gather routines now included in spmd_utils.F90
    cam_history.F90      - referenced renamed gather routines now included in spmd_utils.F90
    hycoef.F90           - included pio patch for ifort on atlas
    interpolate_data.F90 - fixed syntax
    runtime_opts.F90     - included new tuning parameters
    wrap_mpi.F90         - eliminated gather and altalltoallv routines (now relocated in 
                           spmd_utils.F90). wrap_mpi.F90 is now just a wrapper for MPI calls.

  models/atm/cam/src/dynamics/eul:
    realloc4.F90 - added reference to altalltoallv in spmd_utils module
    realloc7.F90 - added reference to altalltoallv in spmd_utils module
    scan2.F90    - added reference to altalltoallv in spmd_utils module
    spmd_dyn.F90 - included FV-relevant performance options (for spmd_dyn.F90 consistency)

  models/atm/cam/src/dynamics/fv:
    advect_tend.F90    - adopted new tracer array structure
    benergy.F90        - adopted new tracer array structure
    cd_core.F90        - generalized interface to mod_comm, provided option to call multiple
                         simultaneous transposes
    d2a3dikj.F90       - incorporated summation modifications
    diag_dynvar_ic.F90 - adopted new tracer array structure
    diag_module.F90    - generalized interface to mod_comm
    dp_coupling.F90    - adopted new tracer array structure, generalized interface to mod_comm, 
                         fixed syntax
    dryairm.F90        - adopted new tracer array structure
    dyn_comp.F90       - adopted new tracer array structure, generalized interface to mod_comm, 
                         provided option to call multiple simultaneous transposes
    dynamics_vars.F90  - added performance parameters to FV datatype, adopted new tracer array 
                         structure
    fv_prints.F90      - incorporated summation modifications
    geopk.F90          - generalized interface to mod_comm
    inidat.F90         - adopted new tracer array structure, generalized interface to mod_comm
    io_dist.F90        - generalized interface to mod_comm
    mapz_module.F90    - adopted new tracer array structure
    mean_module.F90    - incorporated summation modifications
    p_d_adjust.F90     - adopted new tracer array structure, incorporated summation modifications
    par_xsum.F90       - incorporated summation modifications
    pfixer.F90         - generalized interface to mod_comm
    restart_dynamics.F90 - adopted new tracer array structure, eliminated real*4 tracer option, 
                           included pio patch for ifort on atlas
    spmd_dyn.F90       - included new tuning parameters
    stepon.F90         - adopted new tracer array structure
    te_map.F90         - adopted new tracer array structure
    trac2d.F90         - adopted new tracer array structure

  models/atm/cam/src/dynamics/homme:
    spmd_dyn.F90 - included FV-relevant performance options (for spmd_dyn.F90 consistency)

  models/atm/cam/src/dynamics/sld:
    realloc4.F90 - added reference to altalltoallv in spmd_utils module
    realloc7.F90 - added reference to altalltoallv in spmd_utils module
    scan2.F90    - added reference to altalltoallv in spmd_utils module
    spmd_dyn.F90 - included FV-relevant performance options (for spmd_dyn.F90 consistency)

  models/atm/cam/src/physics/cam:
    phys_buffer.F90 - included pio patch for ifort on atlas
    phys_gmean.F90  - incorporated summation modifications
    phys_grid.F90   - generalized interface to mod_comm
    restart_physics.F90 - included pio patch for ifort on atlas

  models/atm/cam/src/utils:
    repro_sum_mod.F90 - incorporated summation modifications
    spmd_utils.F90    - incorporated gather and altalltoallv routines from wrap_mpi.F90; 
                        introduced new flow-controlled gather routines;
                        modified swap software
    time_manager.F90  - included pio patch for ifort on atlas

  models/utils/pilgrim:
    debugutilitiesmodule.F90 - trivial change
    decompmodule.F90         - trivial change
    mod_comm.F90             - incorporated major communication options
    parutilitiesmodule.F90   - generalized interface to mod_comm
    pilgrim.F90              - trivial change

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: ALL PASS

bangkok/lf95: ALL PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_20
Originator(s): eaton
Date: Wed Nov 26 14:18:10 MST 2008
One-line Summary: Make RRTMG default; update default radiative forcings;
  misc fixes 

Purpose of changes:

. Make RRTMG the default radiation package.

. Update the namelist defaults so that the "out of the box" configuration
  uses the same forcings as the CCSM B_PRESENT_DAY cases.  This includes
  the solar constant, prescribed ozone, aerosols, and GHGs.

. misc fixes and compiler workarounds
  - Fix new logic in getfil to make PGI happy.
  - Fix PIO namelist variable definition (iotype_name)

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: 

. default values of forcings changed as described above

List any changes to the defaults for the boundary datasets:

. default values of forcings changed as described above

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/config_definition.xml
. set default value for "rad" to "rrtmg"

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. update defaults from 1990 to 2000

models/atm/cam/bld/namelist_files/namelist_definition.xml
. fix pio namelist variable iotype_name

models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
. remove the solar constant.  now build-namelist will use the value in
  namelist_defaults_cam.xml.

models/atm/cam/src/chemistry/mozart/tgcm_forcing.F90
. change dimension of dimids from 3 to 4 in tgcm_init

models/atm/cam/src/control/ioFileMod.F90
. fix getfil logic (test on optional arg iflag) to make PGI happy

models/atm/cam/src/physics/rrtmg/radiation.F90
. add :ncol bounds to array expression to make lf95/debug happy

models/atm/cam/test/system/config_files/f10c3dm
. add -rad camrt to get at cam3.5 configuration

models/atm/cam/test/system/nl_files/ghgrmp
. remove "doisccp=.true."

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 7
058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7

bangkok/lf95: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
023 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
033 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
049 bl511 TBL.sh s8t5mdm ttrac 9s .................................FAIL! rc= 7
053 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
055 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

These baseline comparisons are expected to fail due to making RRTMG the
default radiation package, and due to new default radiative forcings

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: New climate due to changing the default
  radiation and the default forcings.

===============================================================
===============================================================

Tag name: cam3_6_19
Originator(s): eaton
Date: Mon Nov 17 18:51:53 MST 2008
One-line Summary: CCSM/PIO build; BGP mods; getfil; extend build-namelist use_case

Purpose of changes:

. Modify CAM's configure so that when building the CAM component via the
  CCSM build scripts, PIO is built as part of CAM.  This is a temporary
  hack!

. Add standalone CAM build support for BGP.

. Modify getfil so that the default is to abort when a requested file isn't
  found.  This makes it easier to detect this common error.

. Extend the functionality of build-namelist so that use case
  specifications can contain variables that are not namelist variables just
  like the namelist_defaults_cam.xml file does.  This is needed to support
  building complex namelist values like those used by the chemistry code to
  specify the emission datasets for multiple constituents.

Bugs fixed (include bugzilla ID):

. fix initialization problem in FV offline mode that was causing sm355 to
  fail. 

Describe any changes made to build system:

. modified as described above for CCSM builds.

. support for BGP

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. Check the element names in the use case defaults file and if the name
  isn't in the definition file then don't add the name to the namelist.
. The namelist defaults object corresponding to the use case needs to be
  saved, and searched for default values before the base defaults file is
  searched.  Encapsulate this in a new routine, get_default_values.

models/atm/cam/bld/configure
. add utils/pio to Filepath produced for ccsm build.
. add -D_NETCDF macro to the $cfg_cppdefs for a ccsm build.
. add -D_USEBOX to $cfg_cppdefs

models/atm/cam/bld/Makefile.in
. remove -D_USEBOX

models/atm/cam/bld/cam.cpl7.template
. remove old unicos code

models/atm/cam/bld/config_sys_defaults.xml
. add bgp support (default is pure MPI)

models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
. remove tracer_cnst_file specifier which is inconsistent with the default
  prescribed BAM aerosols.  This was causing the failure of sm386.

models/atm/cam/src/control/iofilemod.F90
. change default behavior of getfil so that it aborts when requested file
  can't be found.

models/atm/cam/src/dynamics/fv/inidat.F90
. initialize dyn_in%u3s and dyn_in%v3s to zero for FV offline mode

models/atm/cam/src/physics/waccm/gw_drag.F90
. use getfil before trying to open a file


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 5

This baseline is failing because the smoke test sm355 fails for cam3_6_18.

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag: 

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_18
Originator(s): aconley, eaton
Date: Mon Nov  3 18:57:32 MST 2008
One-line Summary: RRTMG fixes and new cloud diagnostics

Purpose of changes:

. Update RRTMG external to 
  - Fixes bug in restart (some wrong intents)
  - Fixes problem with minimal solar zenith angle for WACCM.

. RRTMG diagnostics
  - Cleanup of addfld calls
  - Output aerosol masses as seen by radiation

. Cloud diagnostics moved into a new module, cloud_diagnostics.  This
  module is currently only implemented for RRTMG.

. Add capability to compute optical properties for volcanic aerosols.

. Extend the rad_constituents interface to allow setting gas species mixing
  ratios to zero.  This is done by using the specifier 'Z' in the
  appropriate namelist variable in place of 'P' or 'D'.

. Bugfix in new ISCCP simulator.

. Modify how radiation package is specified to configure.  The -rrtmg
  switch has been replaced by the argument -rad which takes either rrtmg or
  camrt as values.  The current default is camrt.

. Update test_driver.sh to use pgi-7.2-5 on bangkok and calgary.

Bugs fixed (include bugzilla ID):

. fix an index problem in the new ISCCP simulator

. change char*80 to 256 in filename declaration in mo_flbc.F90

Describe any changes made to build system:

. remove -rrtmg switch from configure.  replaced by -rad argument which
  takes either rrtmg or camrt as values.  The current default is camrt.

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/physics/rrtmg/param_cldoptics.F90
. not used -- much of this moved to cloud_diagnostics

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/cloud_diagnostics.F90
. stub function for so that cam can separate cloud physical diagnostics
  from radiation diagnostics 

models/atm/cam/src/physics/rrtmg/cloud_diagnostics.F90
. write cloud physical diagnostics (non-radiative diagnostics) to history
  file.

List all existing files that have been modified, and describe the changes:

models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. update RRTMG external to rrtmg_081029

models/atm/cam/bld/build-namelist
. fixes related to changing configuration parameter from rrtmg to rad
. add check for doisccp.  use it to set doisccp_38 if rrtmg is rad pkg

models/atm/cam/bld/config_definition.xml
. remove rrtmg and add generic rad

models/atm/cam/bld/configure
. remove the -rrtmg flag and add a more full featured -rad arg

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. change rrtmg attribute of physprop files

models/atm/cam/bld/namelist_files/use_cases/1870-2000_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
. add tracer_cnst_file setting so the use case doesn't break when the
  defaults in namelist_defaults_cam.xml change.

models/atm/cam/bld/perl5lib/Build/Namelist.pm
. fix code that limits the length of strings written to namelist output
  files 

models/atm/cam/src/chemistry/mozart/mo_flbc.F90
. change declaration of filename from char*80 to char*256

models/atm/cam/src/physics/cam/aer_rad_props.F90
. add radiation hooks for volcanic aerosol.
. fix indexing for output of SW aerosol OD's.
. update names in code to match names in aerosol files (lw_ext renamed to lw_abs)

models/atm/cam/src/physics/cam/icarus_scops_38.F90
. fix indexing bug

models/atm/cam/src/physics/cam/phys_prop.F90
. add functionality for volcanics
. update names in code to match names in aerosol files (lw_ext renamed to lw_abs)

models/atm/cam/src/physics/cam/physpkg.F90
. add call for cloud_diagnostics_init
. remove call for param_cldoptics_init

models/atm/cam/src/physics/cam/rad_constituents.F90
. specify masses that are not included in diagnostic radiation calls as
  having zero mass path. 
. add new props for volcanics to rad_cnst_get_clim_aer_props()

models/atm/cam/src/physics/cam/radae.F90
. make code robust for zero ozone concentrations (from Philip Cameron-Smith
  and Dan Bergmann)

models/atm/cam/src/physics/cam/radiation.F90
. move param_cldoptics initialization into camrt radiation.F90, since it is
  now a radiation utility 

models/atm/cam/src/physics/cam/tphysbc.F90
. add call to cloud_diagnostics

models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
. clean up diagnostic history tape calls
. remove unused pointers to CLD in physics buffer.

models/atm/cam/src/physics/rrtmg/radiation.F90
. remove obsolete "addfld" calls
. fix intent of fsds.  Was intent(out), but should be intent(inout) since
  it is only set on radiation timesteps.
. add calls to output aerosol masses as seen by radiation
. remove old isccp simulator -- can replace if we decide we really want to
  run this with rrtmg.

models/atm/cam/src/physics/rrtmg/radsw.F90
. change solvar_interface names for waccm

models/atm/cam/test/system/config_files/h16x4dm
models/atm/cam/test/system/config_files/h5x8adm
models/atm/cam/test/system/config_files/h5x8dm
models/atm/cam/test/system/config_files/h5x8idm
. add -hgrid values

models/atm/cam/test/system/CAM_runcmnd.sh
. remove hpmcount from bluefire (left in by mistake on previous commit)

models/atm/cam/test/system/test_driver.sh
. update to pgi-7.2-5 on bangkok and calgary
. return default queue on bluefire to regular

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

045 sm355 TSM.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 8
046 er355 TER.sh fmo2dh off2x2.5 4+5s .............................FAIL! rc= 5
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 4

The smoke test for these tests fails in cam3_6_17.

bangkok/lf95: All PASS except:

019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

There is a roundoff difference in these results.  Not sure why.  Validated
with a pergro test (need to set -microphys rk).

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB, except roundoff for non-debug
  production configurations under lf95.

===============================================================
===============================================================

Tag name: cam3_6_17
Originator(s):  Jim Edwards
Date: 
One-line Summary: Refactor restart files from binary to netcdf using PIO

Purpose of changes: Improved memory profile allow parallel IO for restart 
	in NetCDF format

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: Added external PIO library

Describe any changes made to the namelist:  Added pio_ctl namelist 
                        default           allowed values
	io_stride         1                 1 - n                    
	iotype_name     'netcdf'      'netcdf', 'pnetcdf'
	pio_restart      .false.             
	num_iotasks       n                 1 - n
        where n is the total number of compute tasks
        io_stride and num_iotasks control the number of tasks participating in IO, If only io_stride is set
	  num_iotasks will be adjusted automatically.   
	pio_restart can be used to turn off the pio facility and use the old binary restart.  
	If you find that you need to set this please let me know so that I can address the problem, we plan to make PIO
	the only option in an upcoming release. 
	iotype_name allows a choice of netcdf or pnetcdf libraries - currently netcdf appears to perform better but
	that may change depending on platform, decomposition and problem size.
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:     

Code reviewed by: self

List all subroutines eliminated:

List all subroutines added and what they do: 

List all existing files that have been modified, and describe the changes:
    models/atm/cam/test/system/TSB.ccsm.sh
    models/atm/cam/test/system/TCT.ccsm.sh
    models/atm/cam/test/system/TBL.sh
    models/atm/cam/test/system/TBR.sh
    models/atm/cam/test/system/test_driver.sh
    models/atm/cam/test/system/CAM_runcmnd.sh
    models/atm/cam/test/system/TEQ.sh
	removed bluevista, added firefly.  updated files_to_compare so that only history files are listed.
    models/atm/cam/test/system/nl_files/ghgrmp
    models/atm/cam/test/system/nl_files/off2x2.5
	added pio_restart=.true. so that pio is tested with all dycores as part of precommit tests.
	
    models/atm/cam/test/system/nl_files/aqua
	clean up of test namelist 
    models/atm/cam/test/system/input_tests_master
	added a homme ideal phys test

    models/atm/cam/bld/configure
    models/atm/cam/bld/namelist_files/namelist_definition.xml
    models/atm/cam/bld/Makefile.in
        added pio support
	
    models/atm/cam/src/control/rgrid.F90
	modified initialization so that default values are used instead of invalid values.

    models/atm/cam/src/physics/cam/physpkg.F90
    models/atm/cam/src/physics/cam/physics_types.F90
	added initialization of phys_state and tend data structures for improved error checking

    models/atm/cam/src/physics/cam/convect_shallow.F90
        changed cush declaration from a 3D variable (pverp) to a 2D.
	
    models/atm/cam/src/physics/cam/tphysac.F90
        added homme to dycores which need moist physics

    models/atm/cam/src/dynamics/eul/dyn_grid.F90
        new values in get_dyn_grid_parm for compatability

    models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
    models/atm/cam/src/dynamics/homme/external/edge_mod.F90
    models/atm/cam/src/dynamics/homme/dp_coupling.F90
    models/atm/cam/src/dynamics/homme/inidat.F90
    models/atm/cam/src/dynamics/homme/dyn_comp.F90
    models/atm/cam/src/dynamics/homme/restart_dynamics.F90
    models/atm/cam/src/dynamics/homme/inital.F90
        refactored model flow to better match other dycores.
	
    models/atm/cam/src/control/cam_restart.F90
    models/atm/cam/src/control/hycoef.F90
    models/atm/cam/src/control/cam_comp.F90
    models/atm/cam/src/utils/pio_utils.F90
    models/atm/cam/src/utils/time_manager.F90
    models/atm/cam/src/physics/cam/restart_physics.F90
    models/atm/cam/src/physics/cam/chemistry.F90
    models/atm/cam/src/physics/cam/buffer.F90
    models/atm/cam/src/physics/cam/phys_buffer.F90
    models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
    models/atm/cam/src/chemistry/utils/prescribed_aero.F90
    models/atm/cam/src/chemistry/utils/tracer_data.F90
    models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
    models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
    models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
    models/atm/cam/src/chemistry/mozart/chemistry.F90
    models/atm/cam/src/dynamics/sld/restart_dynamics.F90
    models/atm/cam/src/dynamics/eul/restart_dynamics.F90
    models/atm/cam/src/dynamics/fv/restart_dynamics.F90
    models/atm/cam/src/dynamics/fv/metdata.F90
       added support for PIO restart method

	
    SVN_EXTERNAL_DIRECTORIES
      updated PIO tag


	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

All tests were done twice, once with each restart format.
	
bluefire: All pass except
   058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL
      Fails due to continuing dycore development. 
	
bangkok/lf95:  All tests pass.

CAM tag used for the baseline comparison tests if different than previous
tag:

===============================================================
===============================================================

Tag name: cam3_6_16
Originator(s): Francis Vitt
Date: 
One-line Summary: Combine CAM-Chem and WACCM chemistry codes.

Purpose of changes: Ease of chemistry code mantainance  and
 provide more flexability in the aerosol and gas phase chemistry 
 configurations.
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

 Changes to configure:

  - new configure options :
      -prog_species  [SO4[,DST[,SSLT[,OC[,BC[,GHG[,CARBON16]]]]]]]
         Configure will generate a preprocessor input file
         for any combination of these predefined prognostics
         aerosol and ghg packages.
      -edit_chem_mech
         This allows the user to edit the mechanism file before
         it is processed.  Default editor is vi.  The user can
         specify another editor via the CAMCHEM_EDITOR environment
         variable.
      -usr_mech_infile $mechanism_file
         This allows the user to specify a preprocessor input file.

  - configure invokes the chemstry preprocessor to generate chemistry 
    solver code

  - predefined chemistry options:
      -chem trop_mozart | trop_ghg | trop_aero | waccm_mozart | waccm_ghg

  - when configured with the option -chem trop_mozart | waccm_mozart
     the preprocessor will use a predefined "standard" preprocessor input file

  - when configured with the option -chem trop_ghg | trop_aero | waccm_ghg
     or with the -prog_species  SO4 | DST | SSLT | OC | BC | GHG | CARBON16
     a preprocessor input file is created

 New features:
	
  - The ability to specify short-lived chemical tracers which will
    not be transported.  These species are specified via a "ShortLived"
    species designation in the preprocessor input file.

  - The ability to skip solving the chemical equations some time
    steps.  The chemical equation are solved each time step by
    default.  This can be changed via the chem_freq namelist variable.

  - The prescribed mozart ozone and aerosols for the radiation can now be used 
    with any chemistry configuration (and without any chemistry).
	
Describe any changes made to the namelist:

  Chemistry options are now read from "chem_inparm" namelist in atm_in.
	
  Pass "chem_rad_passive = .true." to build-namelist to set the rad_climate variable
  so that the chemical tracers are radiatively passive.

  emis_date --> srf_emis_date
  emis_type --> srf_emis_type

  WACCM
    now uses srf_emis_specifier as with CAM-chem
	
    lbc_file       --> flbc_file
    lbc_fixed_date --> flbc_date
    lbc_senario    --> flbc_type

    sad_fixed_date --> sad_date
    sad_scenario   --> sad_type

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

D     models/atm/cam/src/chemistry/trop_mozart
D     models/atm/cam/src/chemistry/trop_mozart_aero
D     models/atm/cam/src/chemistry/waccm_mozart
D     models/atm/cam/src/chemistry/trop_mozart_prescribed_aero
D     models/atm/cam/src/chemistry/trop_mozart_ghg_paero
 The source code in these directories are combined.  The preprocessor
 generated code is now generated by configure via the the chemistry
 preprocessor.

D     models/atm/cam/bld/config_defaults_trop_mozart_aero.xml
D     models/atm/cam/bld/config_defaults_trop_mozart_prescribed_aero.xml
D     models/atm/cam/bld/config_defaults_trop_mozart_ghg_paero.xml
 The -chem options trop_mozart_aero, trop_mozart_prescribed_aero, and
 trop_mozart_ghg_paero were removed.
	
D     models/atm/cam/src/physics/waccm/iondrag.F90
D     models/atm/cam/src/physics/waccm/chemistry.F90
D     models/atm/cam/src/physics/waccm/mo_solar_parms.F90
D     models/atm/cam/src/physics/waccm/mo_msis_ubc.F90
D     models/atm/cam/src/physics/waccm/upper_bc.F90
D     models/atm/cam/src/physics/waccm/msise00.F90
D     models/atm/cam/src/physics/waccm/tgcm_forcing.F90
 These were moved to the shared chemistry directory.
	
List all subroutines added and what they do:

A     models/atm/cam/bld/config_defaults_trop_aero.xml
A     models/atm/cam/bld/config_defaults_trop_ghg.xml
 Files added for the new -chem options "trop_aero" and "trop_ghg".
	
A     models/atm/cam/bld/chem_preprocess.pl
 Perl file added to invoke the chemistry preprocessor.
	
A     models/atm/cam/bld/namelist_files/use_cases/waccm_refb1.xml
A     models/atm/cam/bld/namelist_files/use_cases/1990_prog_aero.xml
 WACCM use cases added for the build-namelist util.
	
A     models/atm/cam/src/physics/waccm/gravity_waves_sources.F90
 new WACCM gravity wave drag code.

A     models/atm/cam/src/chemistry/utils/mo_constants.F90
A     models/atm/cam/src/chemistry/utils/prescribed_ghg.F90
A     models/atm/cam/src/chemistry/utils/mo_util.F90
A     models/atm/cam/src/chemistry/utils/prescribed_aero.F90
A     models/atm/cam/src/chemistry/utils/tracer_data.F90
A     models/atm/cam/src/chemistry/utils/prescribed_ozone.F90
A     models/atm/cam/src/chemistry/utils/mo_solar_parms.F90
A     models/atm/cam/src/chemistry/utils/mo_regrider.F90
A     models/atm/cam/src/chemistry/utils/time_utils.F90
A     models/atm/cam/src/chemistry/utils/mo_msis_ubc.F90
A     models/atm/cam/src/chemistry/utils/msise00.F90
A     models/atm/cam/src/chemistry/utils
A     models/atm/cam/src/chemistry/mozart/mo_aero_settling.F90
A     models/atm/cam/src/chemistry/mozart/mo_ghg_chem.F90
A     models/atm/cam/src/chemistry/mozart/mo_wavelen.F90
A     models/atm/cam/src/chemistry/mozart/mo_mean_mass.F90
A     models/atm/cam/src/chemistry/mozart/mo_airglow.F90
A     models/atm/cam/src/chemistry/mozart/mo_jlong.F90
A     models/atm/cam/src/chemistry/mozart/mo_setext.F90
A     models/atm/cam/src/chemistry/mozart/mo_airmas.F90
A     models/atm/cam/src/chemistry/mozart/mo_gas_phase_chemdr.F90
A     models/atm/cam/src/chemistry/mozart/charge_neutrality.F90
A     models/atm/cam/src/chemistry/mozart/mo_photoin.F90
A     models/atm/cam/src/chemistry/mozart/mo_setaer.F90
A     models/atm/cam/src/chemistry/mozart/mo_lightning.F90
A     models/atm/cam/src/chemistry/mozart/mo_tgcm_ubc.F90
A     models/atm/cam/src/chemistry/mozart/mo_trislv.F90
A     models/atm/cam/src/chemistry/mozart/spedata.F90
A     models/atm/cam/src/chemistry/mozart/mo_setair.F90
A     models/atm/cam/src/chemistry/mozart/mo_tracname.F90
A     models/atm/cam/src/chemistry/mozart/mo_waveall.F90
A     models/atm/cam/src/chemistry/mozart/mo_seto2.F90
A     models/atm/cam/src/chemistry/mozart/clybry_fam.F90
A     models/atm/cam/src/chemistry/mozart/solar_photons.F90
A     models/atm/cam/src/chemistry/mozart/mo_tropopause.F90
A     models/atm/cam/src/chemistry/mozart/mo_schu.F90
A     models/atm/cam/src/chemistry/mozart/mo_rtlink.F90
A     models/atm/cam/src/chemistry/mozart/upper_bc.F90
A     models/atm/cam/src/chemistry/mozart/mo_flbc.F90
A     models/atm/cam/src/chemistry/mozart/wei96.F90
A     models/atm/cam/src/chemistry/mozart/mo_jshort.F90
A     models/atm/cam/src/chemistry/mozart/mo_exp_sol.F90
A     models/atm/cam/src/chemistry/mozart/mo_sulf.F90
A     models/atm/cam/src/chemistry/mozart/mo_cph.F90
A     models/atm/cam/src/chemistry/mozart/mo_strato_rates.F90
A     models/atm/cam/src/chemistry/mozart/mo_chemini.F90
A     models/atm/cam/src/chemistry/mozart/tracer_cnst.F90
A     models/atm/cam/src/chemistry/mozart/mo_chm_diags.F90
A     models/atm/cam/src/chemistry/mozart/tracer_srcs.F90
A     models/atm/cam/src/chemistry/mozart/mo_lymana.F90
A     models/atm/cam/src/chemistry/mozart/set_cp.F90
A     models/atm/cam/src/chemistry/mozart/mo_setz.F90
A     models/atm/cam/src/chemistry/mozart/mo_calcoe.F90
A     models/atm/cam/src/chemistry/mozart/mo_aerosols.F90
A     models/atm/cam/src/chemistry/mozart/mo_zadj.F90
A     models/atm/cam/src/chemistry/mozart/mo_aurora.F90
A     models/atm/cam/src/chemistry/mozart/mo_airplane.F90
A     models/atm/cam/src/chemistry/mozart/mo_extfrc.F90
A     models/atm/cam/src/chemistry/mozart/solvar_interface.F90
A     models/atm/cam/src/chemistry/mozart/mo_pchem.F90
A     models/atm/cam/src/chemistry/mozart/mo_ps2str.F90
A     models/atm/cam/src/chemistry/mozart/mo_apex.F90
A     models/atm/cam/src/chemistry/mozart/mo_heatnirco2.F90
A     models/atm/cam/src/chemistry/mozart/woods.F90
A     models/atm/cam/src/chemistry/mozart/mo_fstrat.F90
A     models/atm/cam/src/chemistry/mozart/mo_sphers.F90
A     models/atm/cam/src/chemistry/mozart/mo_snoe.F90
A     models/atm/cam/src/chemistry/mozart/mo_sad.F90
A     models/atm/cam/src/chemistry/mozart/mo_setinv.F90
A     models/atm/cam/src/chemistry/mozart/euvac.F90
A     models/atm/cam/src/chemistry/mozart/chemistry.F90
A     models/atm/cam/src/chemistry/mozart/mo_setozo.F90
A     models/atm/cam/src/chemistry/mozart/m_types.F90
A     models/atm/cam/src/chemistry/mozart/solvar_woods.F90
A     models/atm/cam/src/chemistry/mozart/mo_drydep.F90
A     models/atm/cam/src/chemistry/mozart/iondrag.F90
A     models/atm/cam/src/chemistry/mozart/mo_photo.F90
A     models/atm/cam/src/chemistry/mozart/mo_sethet.F90
A     models/atm/cam/src/chemistry/mozart/efield.F90
A     models/atm/cam/src/chemistry/mozart/mo_setsoa.F90
A     models/atm/cam/src/chemistry/mozart/apex_subs.F90
A     models/atm/cam/src/chemistry/mozart/mz_aerosols_intr.F90
A     models/atm/cam/src/chemistry/mozart/mo_waccm_hrates.F90
A     models/atm/cam/src/chemistry/mozart/mo_mass_xforms.F90
A     models/atm/cam/src/chemistry/mozart/mo_tuv_inti.F90
A     models/atm/cam/src/chemistry/mozart/short_lived_species.F90
A     models/atm/cam/src/chemistry/mozart/mo_strato_sad.F90
A     models/atm/cam/src/chemistry/mozart/mo_waveo3.F90
A     models/atm/cam/src/chemistry/mozart/solvar_data.F90
A     models/atm/cam/src/chemistry/mozart/neckel.F90
A     models/atm/cam/src/chemistry/mozart/tgcm_forcing.F90
A     models/atm/cam/src/chemistry/mozart/mo_usrrxt.F90
A     models/atm/cam/src/chemistry/mozart/mo_jeuv.F90
A     models/atm/cam/src/chemistry/mozart/mag_parms.F90
A     models/atm/cam/src/chemistry/mozart/spehox.F90
A     models/atm/cam/src/chemistry/mozart/exbdrift.F90
A     models/atm/cam/src/chemistry/mozart/mo_setcld.F90
A     models/atm/cam/src/chemistry/mozart/mo_xsections.F90
A     models/atm/cam/src/chemistry/mozart/mo_inter.F90
A     models/atm/cam/src/chemistry/mozart/m_sad_data.F90
A     models/atm/cam/src/chemistry/mozart/mo_drydep_tables.F90
A     models/atm/cam/src/chemistry/mozart/mo_wavelab.F90
A     models/atm/cam/src/chemistry/mozart/mo_solarproton.F90
A     models/atm/cam/src/chemistry/mozart/mo_negtrc.F90
A     models/atm/cam/src/chemistry/mozart/mo_synoz.F90
A     models/atm/cam/src/chemistry/mozart/mo_params.F90
A     models/atm/cam/src/chemistry/mozart/mo_chem_utls.F90
A     models/atm/cam/src/chemistry/mozart/mo_srf_emissions.F90
A     models/atm/cam/src/chemistry/mozart/sv_decomp.F90
A     models/atm/cam/src/chemistry/mozart/mo_setsox.F90
A     models/atm/cam/src/chemistry/mozart/mo_jpl.F90
A     models/atm/cam/src/chemistry/mozart
  trop_mozart and waccm_mozart source code directories combined 

List all existing files that have been modified, and describe the changes:

M     models/atm/cam/bld/configure
M     models/atm/cam/bld/config_defaults_waccm_ghg.xml
M     models/atm/cam/bld/build-namelist
M     models/atm/cam/bld/config_definition.xml
 Implement new chem configure options and invoke chem preprocessor.
	
M     models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M     models/atm/cam/bld/namelist_files/namelist_definition.xml
 Chem namelist cleanup.
	
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1950_ramped.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1950_smax.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1953_ramped_qbo.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1995_climo.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1995_smin.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1995_smax.xml
M     models/atm/cam/bld/namelist_files/use_cases/waccm_1950_smin.xml
M     models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
M     models/atm/cam/bld/namelist_files/use_cases/1870-2000_control.xml
 Modified for namelist variables cleanup.

	
M     models/atm/cam/src/control/runtime_opts.F90
 Chem namelist cleanup.

M     models/atm/cam/src/physics/cam/initindx.F90
 Prescribed aerosols and ozone independent of chemistry.
 WACCM gravity wave drag.
	
M     models/atm/cam/src/physics/cam/trb_mtn_stress.F90
 WACCM change
	
M     models/atm/cam/src/physics/cam/radiation.F90
 Make restarts bit-for-bit regardless of number of steps in initial run.
	
M     models/atm/cam/src/physics/cam/tphysac.F90
M     models/atm/cam/src/physics/cam/tphysbc.F90
 Cleanup.  Change for short-lived waccm tracers.
	
M     models/atm/cam/src/physics/cam/phys_prop.F90
 Change in error message string.
	
M     models/atm/cam/src/physics/cam/advnce.F90
M     models/atm/cam/src/physics/cam/restart_physics.F90
 Changes for prescribed rad tracers independent of chem.
	
MM    models/atm/cam/src/physics/cam/chem_surfvals.F90
 Remove lbc* (old waccm) namelist variables.
	
	
M     models/atm/cam/src/physics/cam/physpkg.F90
 Change for short-lived chem tracers.
 Init prescribed rad tracer modules.
	
M     models/atm/cam/src/physics/cam/pkg_cld_sediment.F90
 WACCM adjustment
	
M     models/atm/cam/src/dynamics/fv/dp_coupling.F90
M     models/atm/cam/src/physics/cam/physics_types.F90
M     models/atm/cam/src/physics/cam/convect_deep.F90
M     models/atm/cam/src/physics/waccm/gw_drag.F90
 Changes for new waccm gravity wave drag.
	
M     models/atm/cam/src/physics/cam/chemistry.F90
 Change in namelist variable interface --> read "chem_parm" namelist.
	
M     models/atm/cam/src/physics/waccm/radheat.F90
 Change for waccm lower upper boundary (without ions)
	
M     models/atm/cam/src/dynamics/fv/cd_core.F90
M     models/atm/cam/src/dynamics/fv/sw_core.F90
 Changes for offline waccm (minor cleanup).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
	
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
 Sharing chemistry code changes answers for these configurations
 WACCM default aerosols for radiation are now the mozart prescribed aerosols
	
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 7
 Water vapor production from methane oxidation is now included
	
057 er731 TER.sh h16x4dm aqua 4+5s ................................FAIL! rc= 10
 This also failed in cam3_6_15
	
bangkok/lf95:
	
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
 This is expected to fail due to change in waccm_ghg implementation --
 now uses the mozart chemical equation solver.
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: trop_mozart and waccm_mozart codes are combined
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_15
Originator(s): eaton, aconley
Date: Sun Oct 12 16:31:36 MDT 2008
One-line Summary: RRTMG uses 3D CO2 and O2 fields.  Update externals for
                  consistency with CCSM tags.

Purpose of changes:

. Modify RRTMG to accept 3D fields of CO2 and O2.

. Remove output of the vertically integrated cloud diagnostics from RRTMG
  since those diagnostics aren't available.

. Fix logic so new ISCCP simulator is available for use with RRTMG.

. update driver code to drv/seq_mct/trunk_tags/drvseq2_0_33

. update cice code to cice/branch_tags/cice4_0_20080930b_brnchT_20081008

. update csm_share code to csm_share/trunk_tags/share3_081009
  - this includes larger than roundoff changes to the surface fluxes
    resulting from a bug fix introduce at share3_080811

. update the scripts code to scripts/trunk_tags/scripts4_081009

. Move the external definition for the RRTMG code into a new file,
  models/atm/cam/SVN_EXTERNAL_DIRECTORIES.  This was done to avoid the need
  for separate external definition for RRTMG in the CCSM tags.  The tag
  used for the CAM src will now automatically include the RRTMG external.

Bugs fixed (include bugzilla ID): described above

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:
. 1/2 and 1/4 degree versions of fatmlndfrc changed to use gx1v5

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/SVN_EXTERNAL_DIRECTORIES
. add external for RRTMG

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update driver, cice, csm_share, and scripts externals.
. remove external for RRTMG

models/atm/cam/bld/configure
. make commandline arg values of dynamics/physics/chemistry options case insensitive
. add check that RRTMG radiation only be turned on with MG microphysics.
. update CPP defines needed for new CICE tag

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add gx1v5 versions of fatmlndfrc files for 1/2 and 1/4 degree FV grids

models/atm/cam/bld/perl5lib/Build/Config.pm
models/atm/cam/bld/perl5lib/Build/Namelist.pm
models/atm/cam/bld/perl5lib/Build/NamelistDefaults.pm
models/atm/cam/bld/perl5lib/Build/NamelistDefinition.pm
. mods to make the interfaces case insensitive with respect to the namelist
  variable names.
. add some checking that the types of supplied namelist variable values
  match the types declared in the definition file.

models/atm/cam/src/physics/rrtmg/radiation.F90
models/atm/cam/src/physics/rrtmg/radlw.F90
models/atm/cam/src/physics/rrtmg/radsw.F90
. mods to pass 3D fields of O2 and CO2 into RRTMG

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 7
057 er731 TER.sh h16x4dm aqua 4+5s ................................FAIL! rc= 10
058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL! rc= 7

bangkok/lf95: All PASS except:

004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
023 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
033 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
049 bl511 TBL.sh s8t5mdm ttrac 9s .................................FAIL! rc= 7
053 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
055 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

. All baseline tests except for adiabatic and ideal physics fail as
  expected due to bugfix in csm_share code
. Test er731 is an unexpected failure which will be resolved in a future
  tag.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: There are larger than roundoff changes
  due to a bugfix in the surface fluxes that was incorporated via updating
  the csm_share external.

===============================================================
===============================================================

Tag name: cam3_6_14
Originator(s): mvertens
Date: Sun Sep 28 20:15:13 MDT 2008
One-line Summary: changes to cam.cpl7.template and camdom.cpl7.template for new scripts build

Purpose of changes: Bug fixes to cam.cpl7.template and camdom.cpl7.template to get it
   to work correctly with new build

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none (does not apply to cam build yet)

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      bld/camdom.cpl7.template
M      bld/cam.cpl7.template
       bug fixes to the way gmake is invoked for the new build

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: no testing since cam build/makefile was not touched

bangkok/lf95: no testing since cam build/makefile was not touched

Summarize any changes to answers: bfb in the cam build

===============================================================

Tag name: cam3_6_13
Originator(s): aconley, eaton
Date: Thu Sep 25 18:42:12 MDT 2008
One-line Summary: new cloud optics for RRTMG

Purpose of changes:

. Add new cloud optics for RRTMG.

  - Note 1: This code has been added to the trunk to provide early
    access for developers.  However, the port of the code from the Andrew's
    branch to the trunk has not yet been scientifically validated.

  - Note 2: The RRTMG code is not yet the default.  It is enabled by
    specifying -rrtmg on the configure commandline.  When this is done, the
    default for the cloud optics is set to be the mitchell ice cloud optics
    and the conley liquid cloud optics.  There is currently a capability to
    switch the cloud optics back to CAM3 versions by setting the namelist
    variables liqcldoptics='slingo' and icecldoptics='ebertcurry'.

  - Note 3: There is still alot of work to be done to clean up the new
    cloud optics code.  But exactly what needs to be done will depend on
    whether both the new and old cloud optics schemes need to be available
    for use with RRTMG.  The old optics will remain available for use in a
    CAM3 backwards compatibility mode in any case.

. Add new version (3.8) of the ISCCP cloud simulator.  This version only
  works with RRTMG.  The old cloud simulator is maintained to work with
  CAMRT.

Bugs fixed (include bugzilla ID):

. Some bug fixes in cam.cpl7.template needed for CCSM builds
  - fix the logic for the CAM_CHEM variable so that setting CAM_CHEM='none'
    results in setting the arg "-chem none" for configure.
  - remove the override that forced CAM to always be built with threading on.

Describe any changes made to build system: none

Describe any changes made to the namelist:

. Add the following variables for cloud optics:

  - liqcldoptics type="char*32" valid_values="slingo,conley"
    filepath and name for ice optics data for rrtmg

  - icecldoptics type="char*32" valid_values="ebertcurry,mitchell"
    filepath and name for ice optics data for rrtmg

  - iceopticsfile type="char*256"
    filepath and name for ice optics data for rrtmg

  - liqopticsfile type="char*256" 
    filepath and name for liquid cloud (gamma distributed) optics data for
    rrtmg

. Add new variable, doisccp_38, to turn on the new version of the isccp
  cloud simulator.  This is a logical variable and is false by default.

List any changes to the defaults for the boundary datasets: 

. New physprop files from Steve Ghan.  New variables have been added to the
  new set of files (*_c080918.nc), and all the existing variables have the
  same values as in the previous set of files (*_c080819.nc).

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/cloud_rad_props.F90
. this is currently stub code

models/atm/cam/src/physics/cam/cloudsimulator_38.F90
models/atm/cam/src/physics/cam/icarus_scops_38.F90
. new version (3.8) of the ISCCP cloud simulator

models/atm/cam/src/physics/rrtmg/cloud_rad_props.F90
models/atm/cam/src/physics/rrtmg/ebert_curry.F90
models/atm/cam/src/physics/rrtmg/oldcloud.F90
models/atm/cam/src/physics/rrtmg/param_cldoptics.F90
models/atm/cam/src/physics/rrtmg/slingo.F90
. code and interfaces to allow switching between new and old cloud optics
  for RRTMG only.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add defaults for new cloud optics variables when running with rrtmg.
. modify the filepaths produced for the -inputdata option to retain leading
  shell variables (e.g., $DIN_LOC_ROOT).

models/atm/cam/bld/cam.cpl7.template
. fix the logic for the CAM_CHEM variable so that setting CAM_CHEM='none'
  results in setting the arg "-chem none" for configure.
. remove the override that forced CAM to always be built with threading on.
. mods for using unified Makefile and Macros files for CCSM build.

models/atm/cam/bld/configure
. create stub versions of the misc.h and preproc.h files which are still
  reference by CLM code, but not used.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. new physprop files
. add defaults for new cloud optics variables.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. new namelist variables oldcldoptics, liqcldoptics, icecldoptics,
  iceopticsfile, liqopticsfile, doisccp_38
. update the documentation for the input_pathname attribute, and remove the
  attribute from the variables used to specify the restart files used for
  branch runs.

models/atm/cam/src/control/runtime_opts.F90
. add doisccp_38

models/atm/cam/src/physics/cam/aer_rad_props.F90
. change idxvis to idx_sw_diag

models/atm/cam/src/physics/cam/cldwat2m.F90
. add new diagnostic fields

models/atm/cam/src/physics/cam/phys_prop.F90
. change idxVIS to idx_sw_diag

models/atm/cam/src/physics/cam/physpkg.F90
. add call to cloud_rad_props_init
. remove init for cloudsimulator

models/atm/cam/src/physics/cam/rad_constituents.F90
. add public data for ice/liq optics files?

models/atm/cam/src/physics/cam/radconstants.F90
. wavelength band indices for diagnostic fields

models/atm/cam/src/physics/cam/radiation.F90
. add initialization of cloud simulator to radiation_init

models/atm/cam/src/physics/cam/stratiform.F90
. add microphysics fields to pbuf
. Change limiters on in-cloud ice and liquid mixing ratios.  These fields
  are only set by MG microphysics.  They are used in the new cloud optics
  routines, which means the new cloud optics won't work with RK
  microphysics. 

models/atm/cam/src/physics/rrtmg/radconstants.F90
. add wavelength band indexes for diagnostic fields

models/atm/cam/src/physics/rrtmg/radiation.F90
. mods for diagnostic calcs
. mods for cloud simulator.
. call cloudsimulator_init from radiation_init
. add diagnostic calc specific versions of output fields
. mods for cloud optics
. remove cicewp, cliqwp, rei, and rel from the args passed to 
  rad_rrtmg_{sw,lw}.
. add cloud optics fields as input args to the RT calls
. remove old cloud cover diagnostics that aren't consistent with mcica.

models/atm/cam/src/physics/rrtmg/radlw.F90
. change dummy arg from cldtau to tauc_lw which has a
  wavelength dependence (nbndlw).  Previously tauc_lw was a local var.
. remove input dummy args E_cicewp, E_cliqwp, E_rei, E_rel.  CAM is no
  longer providing these fields as input

models/atm/cam/src/physics/rrtmg/radsw.F90
. get idx_sw_diag from radconstants
. add args for cld optics to rad_rrtmg_sw
. remove input dummy args E_cicewp, E_cliqwp, E_rei, E_rel.  CAM is no
  longer providing these fields as input
. code for different versions of cloud optics -- maintain it all for now
. Remove public subroutine radsw_cldoptics (original implementation of old
  cloud optics for rrtmg)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB.  Note that there are currently no
regression tests for RRTMG.  The answers with RRTMG have changed due to new
cloud optics.

===============================================================
===============================================================

Tag name: cam3_6_12 
Originator(s): Jim Edwards
Date: 9-23-08
One-line Summary: Update of Homme dycore, code cleanup to prepare for IO changes

Purpose of changes:  Remove access to module pmgrid variables plat and plon and 
	require access through the dyn_grid module.

Bugs fixed (include bugzilla ID): Fixed a bug in boundary data, this bug
	manafest in the homme dycore only.

Describe any changes made to build system: Removed macros DYN_STATE_INTERFACE 
	and LSMLON, LSMLAT (except for the scam build) from configure. 

Describe any changes made to the namelist: 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: 

List all subroutines eliminated:
   models/atm/cam/src/dynamics/homme/external/flops_mod.F90
   models/atm/cam/src/dynamics/homme/external/forcing_mod.F90
   models/atm/cam/src/dynamics/homme/external/surfaces_mod.F90
   models/atm/cam/src/dynamics/homme/external/baroclinic_inst_mod.F90
   models/atm/cam/src/dynamics/homme/external/checksum_mod.F90
   models/atm/cam/src/dynamics/homme/external/timer_mod.F90

   Homme code not used in cam interface.

	
List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
 models/atm/cam/test/system/config_files/h16x4dm 
	removed reference to lapack lib - this is handled in configure
 models/atm/cam/bld/configure
        removed obsolete macros DYN_STATE_INTERFACE and LSMLON, LSMLAT 
	(except for scam case)
 models/atm/cam/bld/Makefile.in
        added LAPACK libs to Linux build (needed for homme)
        added NO_MPI2 macro to Linux build (needed for PIO)
 models/atm/cam/src/control/startup_initialconds.F90
 models/atm/cam/src/control/cam_restart.F90
 models/atm/cam/src/control/cam_comp.F90
        Removed DYN_STATE_INTERFACE clauses
 models/atm/cam/src/physics/cam/boundarydata.F90
        Fixed a bug in interpolation code used for homme dycore only	
 models/atm/cam/src/physics/cam/progseasalts_intr.F90
 models/atm/cam/src/physics/cam/acbnd.F90
 models/atm/cam/src/physics/cam/carbon_intr.F90
 models/atm/cam/src/physics/cam/spmd_phys.F90
 models/atm/cam/src/physics/cam/sulfur_intr.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_tropopause.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_flbc.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_sulf.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_aerosols.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_airplane.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_extfrc.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_regrider.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_fstrat.F90
 models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
 models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_photo.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_seasalt.F90
 models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_strato_sad.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_synoz.F90
 models/atm/cam/src/chemistry/trop_mozart/mo_srf_emissions.F90
        Removed reference to pmgrid module variables plon and plat and
	replaced with calls to get_dyn_grid_parm
 models/atm/cam/src/dynamics/sld/pmgrid.F90
 models/atm/cam/src/dynamics/sld/inidat.F90
 models/atm/cam/src/dynamics/sld/dyn_comp.F90
 models/atm/cam/src/dynamics/sld/inital.F90
 models/atm/cam/src/dynamics/sld/stepon.F90
 models/atm/cam/src/dynamics/sld/restart_dynamics.F90
 models/atm/cam/src/dynamics/eul/inidat.F90
 models/atm/cam/src/dynamics/eul/dyn_comp.F90
 models/atm/cam/src/dynamics/eul/inital.F90
 models/atm/cam/src/dynamics/eul/stepon.F90
 models/atm/cam/src/dynamics/eul/restart_dynamics.F90
        Added empty dyn state structure so that dyn interface
	matchs homme and fv and DYN_STATE_INTERFACE macro could
	be removed
 models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
 models/atm/cam/src/dynamics/homme/external/parallel_mod.F90
 models/atm/cam/src/dynamics/homme/external/reduction_mod.F90
 models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
 models/atm/cam/src/dynamics/homme/external/dimensions_mod.F90
 models/atm/cam/src/dynamics/homme/external/control_mod.F90
 models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
 models/atm/cam/src/dynamics/homme/external/interpolate_mod.F90
 models/atm/cam/src/dynamics/homme/external/element_mod.F90
 models/atm/cam/src/dynamics/homme/external/viscosity_mod.F90
 models/atm/cam/src/dynamics/homme/external/time_mod.F90
 models/atm/cam/src/dynamics/homme/external/hybvcoord_mod.F90
 models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
 models/atm/cam/src/dynamics/homme/external/edge_mod.F90
 models/atm/cam/src/dynamics/homme/external/dof_mod.F90
 models/atm/cam/src/dynamics/homme/external/physical_constants.F90
 models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
 models/atm/cam/src/dynamics/homme/external/bndry_mod.F90
        Ported to lf95 compiler and merged development from homme.
 models/atm/cam/src/dynamics/homme/stepon.F90
 models/atm/cam/src/dynamics/homme/dyn_comp.F90
        Ported to lf95 compiler
 SVN_EXTERNAL_DIRECTORIES
	Updated mct, drv, and scripts tags.
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:   all pass except
  058 bl731 TBL.sh h16x4dm aqua 9s ..................................FAIL
  expected failure due to homme dycore updates.

bangkok/lf95:   all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_6_11
Originator(s): eaton, fvitt
Date: Thu Sep 18 14:27:10 MDT 2008
One-line Summary: wet deposition bug fix

Purpose of changes:

. This bug fix removes the double counting of snow in both the total
  precipitation and total evaporation fields that were being passed to the
  gas phase chemistry and used in wet deposition.

Bugs fixed (include bugzilla ID):

. described above

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
. use physics buffer fields NEVAPR instead of TOTEVAPR, and PRAIN instead
  of TOTPRECP as actual args passed through the gas_phase_chemdr interface.

models/atm/cam/src/physics/cam/cldwat2m.F90
. fix the comments for prain and nevapr to indicate that they are totals of
  rain + snow.

models/atm/cam/src/physics/cam/stratiform.F90
. remove the fields TOTEVAPR (nevapr+evapsnow) and TOTPRECP
  (prain+prodsnow) from the physics buffer.  These fields were double
  counting the contribution from snow since it is already included in the
  prain and nevapr fields returned by subroutines pcond and mmicro_pcond.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7

These baselines fail because answers for both full chemistry and prognostic
aerosol codes have changed as a result of the wet deposition change.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except for runs with full chemistry
(-chem trop_mozart) or prognostic aerosols (-chem trop_mozart_aero).

===============================================================
===============================================================

Tag name: cam3_6_10
Originator(s): eaton
Date: Fri Sep 12 12:34:59 MDT 2008
One-line Summary: build-namelist fix and update driver

Purpose of changes:

. build-namelist was modified to properly produce the list of input
  datasets when the root directory has been specified as an environment
  variable reference, e.g., "-csmdata \$DIN_LOC_ROOT".  This is a
  requirement for how the CCSM scripts invoke build-namelist.

. Update to new driver code.  The new driver contains a workaround for the
  performance problem being encountered on bluefire when running more than
  1 thread per task.  Driver updated to drvseq2_0_27.

. pathf90 section of Makefile modified to turn off optimization for the 2
  RRTMG modules that take excess amounts of time to compile (or won't
  compile at all).

Bugs fixed (include bugzilla ID): 

. build-namelist (described above)

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none known

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update driver external to drvseq2_0_27

models/atm/cam/bld/config_definition.xml
. change valid value of lnd from clm2 to clm

models/atm/cam/bld/build-namelist
. modify so that the namelist files for the driver, CLM, and CICE are only
  written out for CAM standalone scripts.
. modify so that the list of inputdata file produced has the root directory
  properly stripped, even when it's in the form of an environment variable
  as is the case when the CCSM scripts invoke build-namelist.

models/atm/cam/bld/Makefile.in
. modify to remove optimization from build of rrtmg_sw_k_g.f90 and
  rrtmg_lw_k_g.f90 when using pathf90.

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add new namelist variables to seq_infodata_inparm group.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7

bangkok/lf95: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
023 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
049 bl511 TBL.sh s8t5mdm ttrac 9s .................................FAIL! rc= 7
053 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

The baseline test failures are due to roundoff level differences in the
driver code.  Many of the baseline tests pass either because the
configuration doesn't involve surface interactions (e.g., adiabatic, ideal
physics, aqua-planet), or due to some unknown coincidence all the FV
1.9x2.5 tests are passing.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_6_07

Summarize any changes to answers: BFB or roundoff.  The roundoff
differences were verified by looking at the differences in the cprnc output
for all fields at each timestep for a short run.  The normal perturbation
growth test isn't applicable because it uses aquaplanet mode which is BFB.

===============================================================
===============================================================

Tag name: cam3_6_09
Originator(s): Jim Edwards, Mark Taylor (HOMME dycore), Pat Worley (phys_grid.F90)
Date: 09-04-2008
One-line Summary: Update of HOMME dynamic core

Purpose of changes: Update of HOMME dynamic core

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: modified to allow HOMME dycore restart using PIO

Describe any changes made to the namelist: added pio_ctl namelist 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Eaton

List all subroutines eliminated:

List all subroutines added and what they do: 

            -   models/atm/cam/test/system/config_files/h16x4dm
            -   models/atm/cam/test/system/nl_files/aqua
        These were added in support of new homme aquaplanet test 731

A  +            -   models/atm/cam/src/utils/pio_utils.F90
	Added to support HOMME dycore restart, also added a new external
	utils/pio which is currently only compiled for the HOMME dycore.

List all existing files that have been modified, and describe the changes:
   models/ocn/dom/ocn_comp_mct.F90
   models/ice/csim4/ice_comp_mct.F90
   models/atm/cam/src/control/atm_comp_mct.F90
   models/atm/cam/src/physics/cam/phys_gmean.F90
 I made the phys_grid variable nlcols private and provided a method to copy it.
	
   models/atm/cam/test/system/tests_pretag_bluefire
 Removed the 711 tests and added the 731 tests	
	
   models/atm/cam/test/system/config_files/h5x8adm
 Added path to pnetcdf on bluefire
	
   models/atm/cam/test/system/TER.sh
 Revised pattern for cprnc tests so that netcdf restart files are not included.
 Improved error message for cice namelist
	
   models/atm/cam/test/system/input_tests_master
 Added tests for HOMME dycore aquaplanet configuration
	
   models/atm/cam/test/system/TSM.sh
 Improved error message for cice namelist

   models/atm/cam/bld/config_defaults_homme.xml
 Added support for ne=16 np=4 (~2 degree) HOMME dycore resolution
		
   models/atm/cam/bld/configure
   models/atm/cam/bld/Makefile.in
   models/atm/cam/bld/config_horiz_grid.xml
   models/atm/cam/bld/config_definition.xml
 Added support for building PIO and pnetcdf
	
   models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
   models/atm/cam/bld/namelist_files/namelist_definition.xml
   models/atm/cam/bld/build-namelist
 Added support for pio_ctl namelist, changed some HOMME dycore defaults
	
   models/atm/cam/src/control/cam_restart.F90
   models/atm/cam/src/control/cam_comp.F90
 Added support for PIO based restart in HOMME dycore

	
   models/atm/cam/src/utils/spmd_utils.F90
 Added method to export mpicom from this module
	
   models/atm/cam/src/physics/cam/boundarydata.F90
 Bug fix, this bug was exposed by the HOMME dycore only.
		
   models/atm/cam/src/physics/cam/physics_types.F90
 Changed a test to add homme to the list of dycores who do not need this subroutine 
	
   models/atm/cam/src/physics/cam/phys_grid.F90
 Made nlcols private and provided a method to retreve it's value. 
 Changed init method to make it more efficient for 1d horizontal grids.
	
   models/atm/cam/src/dynamics/homme/pmgrid.F90
   models/atm/cam/src/dynamics/homme/dycore.F90
   models/atm/cam/src/dynamics/homme/external/filter_mod.F90
   models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
   models/atm/cam/src/dynamics/homme/external/cg_mod.F90
   models/atm/cam/src/dynamics/homme/external/parallel_mod.F90
   models/atm/cam/src/dynamics/homme/external/derivative_mod.F90
   models/atm/cam/src/dynamics/homme/external/prim_si_mod.F90
   models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
   models/atm/cam/src/dynamics/homme/external/dimensions_mod.F90
   models/atm/cam/src/dynamics/homme/external/quadrature_mod.F90
   models/atm/cam/src/dynamics/homme/external/cube_mod.F90
   models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
   models/atm/cam/src/dynamics/homme/external/control_mod.F90
   models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
   models/atm/cam/src/dynamics/homme/external/interpolate_mod.F90
   models/atm/cam/src/dynamics/homme/external/linear_algebra_mod.F90
   models/atm/cam/src/dynamics/homme/external/element_mod.F90
   models/atm/cam/src/dynamics/homme/external/viscosity_mod.F90
   models/atm/cam/src/dynamics/homme/external/prim_si_ref_mod.F90
   models/atm/cam/src/dynamics/homme/external/time_mod.F90
   models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
   models/atm/cam/src/dynamics/homme/external/kinds.F90
   models/atm/cam/src/dynamics/homme/external/physical_constants.F90
   models/atm/cam/src/dynamics/homme/external/solver_mod.F90
   models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
   models/atm/cam/src/dynamics/homme/dyn_grid.F90
   models/atm/cam/src/dynamics/homme/initcom.F90
   models/atm/cam/src/dynamics/homme/dp_coupling.F90
   models/atm/cam/src/dynamics/homme/dyn_comp.F90
   models/atm/cam/src/dynamics/homme/inidat.F90
   models/atm/cam/src/dynamics/homme/stepon.F90
   models/atm/cam/src/dynamics/homme/restart_dynamics.F90
   models/atm/cam/src/dynamics/homme/commap.F90
   models/atm/cam/src/dynamics/homme/spmd_dyn.F90
   models/atm/cam/src/dynamics/homme/inital.F90
 Updated from development on homme_cam3_5_29 branch. 

	
   SVN_EXTERNAL_DIRECTORIES
 Added PIO external.

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:  all pass except er731, new test with no baseline to compare to. 

bangkok/lf95:  all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bfb
	
===============================================================

Tag name: cam3_6_08
Originator(s): eaton, jenkay, mvr
Date: Thur Sep  4 2008
One-line Summary: build-namelist fix; new radiation and microphysics 
	diagnostic fields

Purpose of changes:
. fix build-namelist to recognize the input datasets that occur in the
  rad_climate and rad_diag_N variables.  This is only relevent 
  for the -test option which checks that all required input datasets exist
  on a local disk, and for the -inputdata option which writes a list of the
  required input datasets to a file.

. Add precip fluxes calculations and output fields (MGFLXPRC, 
  MGFLXSNW) to cldwat2m.F90 (from Jen Kay).

. Add additional radiation fields (FLDS, FSUTOA) to radiation.F90 and 
  radsw.F90 (from Jen Kay).


Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:
- fix to build-namelist to recognize input datasets associated 
	with -test option

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/test_driver.sh
- increased wall clock for bluefire testing

M      models/atm/cam/bld/build-namelist
- fix to recognize input datasets associated with -test option

M      models/atm/cam/src/physics/cam/cldwat2m.F90
- add precip fluxes calculations and output fields (MGFLXPRC, MGFLXSNW)

M      models/atm/cam/src/physics/cam/radiation.F90
M      models/atm/cam/src/physics/cam/radsw.F90
M      models/atm/cam/src/physics/rrtmg/radiation.F90
M      models/atm/cam/src/physics/rrtmg/radsw.F90
- Add additional radiation fields (FLDS, FSUTOA)
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS 

bangkok/lf95: All PASS


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: b4b
	
===============================================================

Tag name: cam3_6_07
Originator(s): eaton, aconley, mvr
Date: Fri Aug 29 18:24:14 MDT 2008
One-line Summary: new physprop (optics + microphysics) files; fixes for
  RRTMG aerosol optics; build/run fixes for CICE

Purpose of changes:

. Update code to read new physprop datasets which contain updated aerosol
  optics and microphysical properties for both the CAMRT and RRTMG codes.
  These are the latest data from Steve Ghan that have been converted to CAM
  naming conventions by Andrew Conley.  These physprop datasets are the
  ones currently being used by the radiation team in the evaluation of the
  RRTMG code.

. Update the relative humidity calculation done in the CAMRT code to be
  consistent with the rh calcs in the moist physics code and with the
  value of rh written to the history output (i.e., rh=q/qsat).

. Fix bug in reading aerosol lw optical properties.  This bug was the cause
  of RRTMG solutions not being invariant when task and/or thread counts were
  changed.  This did not affect CAMRT simulations.

. Remove storage of optical depths from RRTMG code.
  - Update rrtmg external definition to trunk_tags/rrtmg_080826

. The cam3_6_05 commit included new driver code that allows different
  components to use different thread counts.  This is controlled using
  variables from the driver namelist group ccsm_pes.  Update build-namelist
  to write this namelist group to drv_in.  By default the *_nthreads
  variables are set to 1.  This means that runs using cam3_6_05 and
  cam3_6_06 will run with 1 thread in each task regardless of the setting
  of OMP_NUM_THREADS.  build-namelist will now set the value of *_nthreads
  to the value of OMP_NUM_THREADS.  Also, the user may explicitly set the
  values of *_nthreads to achieve a heterogeneous threading configuration.

. Fixes to regression tests on jaguar addressing CICE and quad-core issues.

Bugs fixed (include bugzilla ID):

. Fix bug in reading aerosol lw optical properties.

Describe any changes made to build system: none

Describe any changes made to the namelist:

. iradae is no longer used by RRTMG

List any changes to the defaults for the boundary datasets:

. new physprops datasets.

. change the focndomain defaults for 1/2 and 1/4 degree fv to use the gx1v5
  ocn grid rather than USGS.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 

models/atm/cam/src/physics/rrtmg/aer_rad_props.F90
. no longer needed since the physics/cam version of this file is identical
  to it after the relative humidity expression is updated

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update rrtmg external to trunk_tags/rrtmg_080826

models/atm/cam/bld/build-namelist
. set defaults and write the ccsm_pes namelist group to drv_in

models/atm/cam/bld/Makefile.in
. remove optimization from the PGI build of the RRTMG files
  rrtmg_lw_k_g.f90 and rrtmg_sw_k_g.f90.


models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. new physprops datasets

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add driver namelist group ccsm_pes to control the task/thread layout.

models/atm/cam/src/physics/cam/aer_rad_props.F90
. 

models/atm/cam/src/physics/cam/phys_prop.F90
. Update code to read new physprop datasets.  Mainly this is new variable
  names in the netcdf files.
. bugfix for reading lw_ext data.  flw_ext was dimensioned with nswbands
  instead of nlwbands.

models/atm/cam/src/physics/rrtmg/radiation.F90
models/atm/cam/src/physics/rrtmg/radlw.F90
models/atm/cam/src/physics/rrtmg/radsw.F90
. remove dotau option for controlling calculation frequency of optical
  depths.  This was previously set by using the iradae namelist variable
  which has now been removed from RRTMG.

models/atm/cam/test/system/TCB.sh
. modify code to look for 'csim4' in config_files to flag that cice is not
  the ice model

models/atm/cam/test/system/TBR.sh
models/atm/cam/test/system/TER.sh
. set OMP_NUM_THREADS to CAM_RESTART_THREADS before calling build-namelist
. put conditional around invocation of the cice build-namelist so that it's
  not invoked when csim4 is being used.

models/atm/cam/test/system/TSM.sh
. set OMP_NUM_THREADS to CAM_THREADS before calling build-namelist

models/atm/cam/test/system/CAM_runcmnd.sh
. generalized the call to aprun to assign the number of tasks per node
  based on the requested tasks and threads, assuming the use of quad-core
  nodes

models/atm/cam/test/system/test_driver.sh
. modified task/thread request for hybrid testing on jaguar to work
  with changes to test scripts for using the new cice model; fix to default
  workspace used for test output
. version of showproj - the utility to grab a charge account for a user -
  is now consistent with what ccsm is using...

models/atm/cam/test/system/config_files/f10c3dm
models/atm/cam/test/system/config_files/h5x8adm
models/atm/cam/test/system/config_files/h5x8dm
models/atm/cam/test/system/config_files/h5x8idm
. set  -ice csim4.  The f10c3dm config is designed to test the cam3.5
  configuration.  The homme tests aren't currently using a sea ice model,
  but when they do the csim4 model will probably be the easiest to work
  with initially.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

. The regression testing was carried out in two stages.  First, all changes
  except using the new optics/microphysics data for camrt and switching the
  expression for rh used by camrt were tested and shown to be bit-for-bit.
  Then those changes were made and the testing redone.  The second set of
  regression tests which include failed baseline tests is what is reported
  below. 

bluefire: All PASS except

004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 7

bangkok/lf95: All PASS except

004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
023 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 7
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
033 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 7
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 4
049 bl511 TBL.sh s8t5mdm ttrac 9s .................................FAIL! rc= 7
053 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
055 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

All baseline tests except the adiabatic and ideal physics tests fail due to
the changes in the camrt optics and the microphysics data.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: new climate -- validation runs are being
done by the radiation team.

===============================================================
===============================================================

Tag name: cam3_6_06
Originator(s): mvertens
Date: Wed Aug 27 10:45:00 MDT 2008
One-line Summary: removal of cpl6 refs and script mods for trigrid support

Purpose of changes: removal of all cpl6 references and cam.cpl7.template
changes needed for upcoming trigrid support

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none expected

Code reviewed by: eaton

List all subroutines eliminated:
D      models/atm/cam/bld/cam.cpl6.template
D      models/atm/cam/src/control/ccsm_msg.F90
D      models/atm/cam/src/control/con_cam.F90
       - removal of cpl6 references

D      models/atm/cam/bld/camsom.cpl7.template
D      models/atm/cam/bld/camcsim.cpl7.template
       - compsets for camsom and camcsim will no longer be there in cpl7 scripts

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/bld/configure
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/config_definition.xml
       - removed cpl6 references

M      models/atm/cam/bld/cam.cpl7.template
       - put in support needed for trigrid upcoming changes

M      models/atm/cam/src/control/mpishorthand.F
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/cam_comp.F90
M      models/atm/cam/src/utils/abortutils.F90
X      models/atm/cam/src/physics/rrtmg/ext
M      models/atm/cam/src/dynamics/sld/dynpkg.F90
M      models/atm/cam/src/dynamics/fv/trac2d.F90
M      models/atm/cam/src/dynamics/fv/cd_core.F90
       - removed references to COUPCSM_

M      models/atm/cam/src/control/runtime_opts.F90
       - removed references to COUPCSM_

M      SVN_EXTERNAL_DIRECTORIES
       - updated scripts to https://svn-ccsm-models.cgd.ucar.edu/scripts/trunk_tags/scripts4_080820b

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: all tests passed

bangkok/lf95: all tests passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: answers are bfb
	
===============================================================
===============================================================

Tag name: cam3_6_05
Originator(s): John T., Mariana V.
Date: 082208
One-line Summary:Put new CICE code on the trunk as default ice model

Purpose of changes:new cice code default, scam update

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:none

Describe any changes made to the namelist:none

List any changes to the defaults for the boundary datasets:added new
	cami_0000-01-01_64x128_T42_L26_c080822.nc

Describe any substantial timing or memory changes: Mariana reports a
	2%-3% hit to timing not sure of memory changes.

Code reviewed by:Mariana

List all subroutines eliminated:

List all subroutines added and what they do:
These are all new configure scripts and namelists for testing scam
A      models/atm/cam/test/system/config_files/scmarmiop
A      models/atm/cam/test/system/config_files/scm64bfbiop_35
A      models/atm/cam/test/system/config_files/e64bfbiop_35
A      models/atm/cam/test/system/nl_files/scm_prep_35
A      models/atm/cam/test/system/nl_files/scmarm

List all existing files that have been modified, and describe the changes:
    +----
    |  models/atm/cam/test/system/config_files/f10sdm
    |  models/atm/cam/test/system/config_files/e64sm
    |  models/atm/cam/test/system/config_files/f4sdh
    |  models/atm/cam/test/system/config_files/e8sdm
    |  models/atm/cam/test/system/config_files/e32sdh
    |  models/atm/cam/test/system/config_files/s8sdm
    |  models/atm/cam/test/system/config_files/s32sdh
    +--->  Got rid of old som tests

       models/atm/cam/test/system/config_files/h5x8dm
       models/atm/cam/test/system/config_files/h5x8adm
       models/atm/cam/test/system/config_files/h5x8idm

    +----
    |  models/atm/cam/test/system/config_files/scm64bfbiop_35
    |  models/atm/cam/test/system/config_files/e64bfbiop_35
    |  models/atm/cam/test/system/nl_files/scm_prep_35
    +--->  new scam tests
	
    +----
    |  models/atm/cam/test/system/tests_pretag_bangkok
    |  models/atm/cam/test/system/tests_posttag_bluefire
    |  models/atm/cam/test/system/tests_posttag_bluevista
    |  models/atm/cam/test/system/TCB.sh
    |  models/atm/cam/test/system/TBR.sh
    |  models/atm/cam/test/system/TER.sh
    |  models/atm/cam/test/system/TSM.sh
    |  models/atm/cam/bld/configure
    |  models/atm/cam/bld/build-namelist
    |  models/atm/cam/bld/config_definition.xml
    +--->  configuration/testing changes for new cice

       models/atm/cam/bld/Makefile.in
	   changed -qautoinit flag for ibm from 7FF7FFFF7FF7FFFF 
	   to 7FF7FFFF.  Fixed compilation warnings for
	   uninitialized data
	
       models/atm/cam/src/control/history_defaults.F90
	 Added new outfields for scam with MG microphysics

       models/atm/cam/src/control/scamMod.F90
	 Added new variables for scam with MG microphysics
       
       models/atm/cam/src/chemistry/trop_mozart/mo_regrider.F90
	 fix scam for running with MG microphysics

       models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
	 fix scam for running with new chem

       models/atm/cam/src/dynamics/eul/iop.F90
	 fix scam for running with MG microphysics

       models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
	 fix scam for running with MG microphysics

       SVN_EXTERNAL_DIRECTORIES
         updated to latest drv and cice code
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:None

bangkok/lf95:None

CAM tag used for the baseline comparison tests if different than previous
tag:No baseline since new cice changes answers

Summarize any changes to answers, i.e.,
- what code configurations:
	New CICE code
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 
	new climate

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,

Atmospheric Diagnostics at

- source tag 
	cice4_0_20080822
- platform/compilers:
	bluefire
	bangkok
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:
	/DBAILEY/csm/f40.033

URL for AMWG diagnostics output used to validate new climate:
	http://www.cgd.ucar.edu/cms/mvr/f40.033/f40.033-f40.017/


===============================================================
===============================================================

Tag name: cam3_6_04
Originator(s): eaton
Date: Wed Aug 20 11:00:34 MDT 2008
One-line Summary: Makefile mods for AIX; mods for RRTMG

Purpose of changes:

. Change the default optimization for AIX from -O3 to -O2.  This is to
  address an irreproducibility problem on bluefire resulting from compiling
  CLM at -O3.

  *** NOTE *** The change from -O3 to -O2 has triggered a new xlf11
      compiler problem.  CAM encounters a seg fault when built *without*
      threading enabled, i.e., either serial or pure mpi builds.  The
      workaround is to build for hybrid parallelization, which is the
      default way to build for the IBM power platforms.

. Other Makefile changes for AIX debug mode:
  - change setting of -qinitauto to a double precision signalling NAN
  - turn off the optimization that is implied by -qsmp by setting
    -qsmp=omp:noopt for threaded configs. 

. Various fixes for RRTMG code:
  - bugfix in aerosol optical properties passed to rrtmg
  - change index of the visible band from 9 to 10

. Note that we are not yet ready to start doing tests of RRTMG w/ aerosols
  due to issues with the latest physprop datasets.  Will resolve this in an
  upcoming commit.

. Change the cam*.cpl7.template files to force CCSM builds of CAM to enable
  threading. 

Bugs fixed (include bugzilla ID):

. aerosol optics for rrtmg

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/physics/rrtmg/aer_rad_props.F90
. version of aer_rad_props for rrtmg.  currently the only difference is
  that the physics/cam/aer_rad_props.F90 still contains the incorrect
  expression for relative humidity that was used in cam3.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/cam.cpl7.template
models/atm/cam/bld/camcsim.cpl7.template
models/atm/cam/bld/camdom.cpl7.template
models/atm/cam/bld/camsom.cpl7.template
. always set THREAD = TRUE.  This is to deal with a problem that has
  appeared on both bluevista and bluefire when trying to run in serial or
  pure mpi modes after we reduced the optimization from -O3 to -O2.

models/atm/cam/bld/Makefile.in
. Change default optimization for AIX to -O2 (was -O3)
. change value of -qinitauto (AIX) to a double precision signalling NAN.
. modify AIX section to avoid having -O2 turned on implicitly by -qsmp in
  debug mode

models/atm/cam/src/physics/cam/aer_rad_props.F90
. bugfix for diagnostic calculation of visible optical depth

models/atm/cam/src/physics/cam/cldwat2m.F90
. add some log output for the aerosol physical properties
. modify smcritfactor calculation to allow for hygro_aer=0

models/atm/cam/src/physics/rrtmg/radconstants.F90
. change idxVIS to 10 (from 9)

models/atm/cam/src/physics/rrtmg/radiation.F90
. remove unused calculation of relative humidity

models/atm/cam/src/physics/rrtmg/radsw.F90
. bugfix for aerosol properties that are passed to rrtmg_sw.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:

004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 7

The baseline tests fail due the change in compiler optimization.  This is
true for tests run in both debug and non-debug modes due to implicit
optimization that is turned on by -qsmp

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_6_01

Summarize any changes to answers: roundoff introduced due to change from
  -O3 to -O2.

===============================================================
===============================================================

Tag name: cam3_6_03
Originator(s): eaton
Date: Tue Aug 12 18:51:26 MDT 2008
One-line Summary: allow setting fcrit2 via namelist; add aerosol optical
depth diagnostics to history output

Purpose of changes:

. Provide a new namelist variable fcrit2 to allow setting the value in
  gw_drag.  The default is still fcrit2=1.0 which is the change made in
  cam3_5_50. 

. Add diagnostic output of the column integrated optical depth in the
  visible band for individual aerosol constituents that affect the climate
  simulation.  The names in the history file are of the form ODV_xxx where
  xxx is the constituent name as set by the parameterization that
  determines its mass distribution.  xxx is also the name that is used in
  the rad_climate namelist variable.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:

. add namelist variable fcrit2 to namelist group gw_drag_nl

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add variable fcrit2 to namelist group gw_drag_nl

models/atm/cam/src/control/runtime_opts.F90
. add call to new gw_drag_readnl routine

models/atm/cam/src/physics/cam/aer_rad_props.F90
. add diagnostic output of optical depth in the visible band for individual
  aerosol constituents in the climate list.  The diagnostics lists are not
  yet available.

models/atm/cam/src/physics/cam/gw_drag.F90
. add gw_drag_readnl routine to read namelist group gw_drag_nl which
  contains the variable fcrit2.  Remove hardcoded setting of fcrit2 from
  the gw_inti routine.

models/atm/cam/src/physics/cam/rad_constituents.F90
. add optional arg aernames to the rad_cnst_get_clim_info subroutine to
  give access to the aerosol names in either a climate or diagnostic list.

models/atm/cam/src/physics/waccm/gw_drag.F90
. changes to waccm version of gw_drag are necessary so that the modules
  have the same interfaces and can be swapped at build time


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_6_01

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_02
Originator(s): eaton
Date: Thu Aug  7 08:29:12 MDT 2008
One-line Summary: Enable building standalone CAM with CICE

Purpose of changes:

. In the near future the "prescribed" version of CICE will replace
  CSIM4 as the default sea ice model for the standalone CAM configuration.
  This commit is a step along that path; CICE has not yet been made the
  default.  It is currently enabled by giving the argument "-ice cice" to
  configure.

. Unlike CSIM4, CICE uses its own grid decomposition which is independent
  of CAM's.  This decomposition is specified by parameters that are set at
  build time, hence they are specified to configure.  There are two ways to
  do this:
  - Specify the number of tasks and/or threads for hybrid, pure mpi, or
    pure omp parallelism using the new configure options -ntasks, and
    -nthreads.  This will allow a default decomposition to be determined.
  - Specify the CICE decomposition explicitly via the new configure options 
    -cice_bsizex, -cice_bsizey, and -cice_maxblocks.

. Update the CICE external to cice4_0_20080718

. Modify the Makefile to allow faster compilation of the RRTMG modules
  rrtmg_lw_k_g.f90 and rrtmg_sw_k_g.f90.  Longer term solution is to read the
  data that's stored in these modules from a file.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:

. changes to configure to support building w/ CICE

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update CICE to cice4_0_20080718
. add external for stub sice

models/atm/cam/bld/configure
. add arguments -cice_bsizex, -cice_bsizey, -cice_maxblocks.
  These are used to explicitly set the CICE decomposition.  Note that they
  must be consistent with the number of tasks and threads used to run the
  executable.
. add arguments -ntasks and -nthreads.  If these are both specified then a
  script provided by CICE will be used to generate a default CICE
  decomposition.
  Setting -ntasks > 0 implies -spmd, and setting -nthreads > 0 implies
  -smp.  Serial mode is still set using "-nospmd -nosmp".
. add cice_decomptype to the config definition.  build-namelist needs access to
  it to call the CICE build-namelist

models/atm/cam/bld/config_definition.xml
. add cice_decomptype, ntasks, and nthreads

models/atm/cam/bld/build-namelist
. use the CICE build-namelist
. add -cice_nl argument as a way to pass values to the CICE build-namelist

models/atm/cam/bld/Makefile.in
. add special rules to AIX section to remove optimization from the
  compilation of rrtmg_lw_k_g.f90 and rrtmg_sw_k_g.f90

models/atm/cam/src/physics/cam/cldwat2m.F90
. change names in outfld calls for number concentrations of aerosols to
  avoid a name clash with the mixing ratios output by chemistry.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_6_01
Originator(s): mvr
Date: Wed Aug  6 2008
One-line Summary: fix to runtime bug with pgi compilers; began replacing 
unit 6 flush statements with those using a variable unit number; fix to 
ensure code dependencies are regenerated with each make

Purpose of changes:
any configuration other than adiabatic or ideal physics would die at runtime 
with a segfault in the radiation code, when using the pgi compilers on jaguar 
(version 7.1-6)...this was introduced in cam3_5_54

occasionally, messages from cam were not making it to log files when the coupled 
model would die at runtime...this was due to flush statements improperly using unit 6

bug 787 describes a problem where code could change between makes where dependencies 
may be altered, but make does not regenerate the Depends file
	
Bugs fixed (include bugzilla ID): 793 (partial), 787 (partial)

Describe any changes made to build system: 
mod to Makefile.in to ensure Depends file is regenerated with each make

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/bld/run-ibm.csh
- small bug fix to setenv statement with syntax error
	
M      models/atm/cam/src/control/cam_comp.F90
- flush calls now using iulog rather than unit 6

M      models/atm/cam/src/physics/cam/rad_constituents.F90
- fix to runtime bug (segfault) caught with pgi compilers 

M      models/atm/cam/bld/Makefile.in
- fix to ensure Depends file is recreated with each make	
	

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS:

bangkok/lf95: All PASS:

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: b4b

===============================================================
===============================================================

Tag name: cam3_6
Originator(s): eaton, andrew
Date: Fri Aug  1 11:27:59 MDT 2008
One-line Summary: make MG microphysics the default

Purpose of changes:

. MG microphysics is now the default.  This is controlled by the new
  "-microphys" argument to configure.  The valid values are "rk" (Rasch and
  Kristjansson), and "mg" (Morrison and Gettelman two moment scheme).  "mg"
  is the default.

  ** Note 1 ** This default needs to implemented in configure rather than
               build-namelist because it affects the total number of
               advected constituents which is a build time setting.

  ** Note 2 ** Since configure now knows what microphysics scheme is being
               used, build-namelist is able to automatically set the
               correct value of the namelist variable microp_scheme.  The
               user no longer needs to set that variable.

. Add bugfix to MG microphysics code (from Andrew Gettelman).

. A new argument, -nadv_tt, has been added to configure to specify the
  number of advected test tracers.  Previously this was done by using the
  -nadv argument which specifies the total number of advected tracers.
  That way of doing things resulted in having to redefine all the
  regression tests that include test tracers because the MG microphysics
  adds 2 advected constituents.  Deconvolving the specification of test
  tracers and total advected constituents makes the test specifications
  more robust, and provides an easier to use interface.

. The regression tests have been updated to use the new -nadv_tt argument
  to configure for specifying the number of advected test tracers.  Also,
  the special test for MG microphysics has been replaced by a test for the
  cam3.5 physics.

Bugs fixed (include bugzilla ID):

. Add bugfix to MG microphysics code (from Andrew Gettelman).

Describe any changes made to build system:

. configure has 2 new arguments: -microphys and -nadv_tt

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

. MG microphysics is more expensive than RK.  Don't have benchmarks yet.

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/test/system/config_files/e8c8mdm
. renamed e8t5mdm

models/atm/cam/test/system/config_files/f10c8mdm
. renamed f10t5mdm

models/atm/cam/test/system/config_files/s8c8mdm
. renamed s8t5mdm

models/atm/cam/test/system/config_files/f10c5dm
. renamed f10c3dm

models/atm/cam/test/system/nl_files/microp_mg
. special test for MG microphysics no longer needed

List all subroutines added and what they do:

models/atm/cam/test/system/config_files/e8t5mdm
models/atm/cam/test/system/config_files/f10t5mdm
models/atm/cam/test/system/config_files/s8t5mdm
. these files are for tests using test tracers.  The -nadv settings have
  all been replaced by settings for -nadv_tt

models/atm/cam/test/system/config_files/f10c3dm
. this file is used to test the cam3.5 physics, which is turned on by the
  setting "-chem none -microphys rk"

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add default for microp_scheme based on value from configure
. set tracers_flag=.true. if test tracers requested via configure

models/atm/cam/bld/config_defaults_trop_mozart.xml
models/atm/cam/bld/config_defaults_trop_mozart_aero.xml
models/atm/cam/bld/config_defaults_trop_mozart_ghg_paero.xml
models/atm/cam/bld/config_defaults_trop_mozart_prescribed_aero.xml
models/atm/cam/bld/config_defaults_waccm_ghg.xml
models/atm/cam/bld/config_defaults_waccm_mozart.xml
. remove default setting for nadv -- responsibility for setting this
  belongs in configure.

models/atm/cam/bld/config_definition.xml
. add parameter "microphys" with valid values "rk" or "mg", and set the
  default value to "mg"
. remove default value for nadv -- move all responsibility for setting
  this into configure
. add parameter "nadv_tt" to specify number of advected test tracers

models/atm/cam/bld/configure
. modify how nadv values are set depending on the specific chemistry and
  microphysics packages
. add commandline args for the new microphys and nadv_tt parameters

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add values for microp_scheme

models/atm/cam/doc/ChangeLog_template
. blueice changed to bluefire

models/atm/cam/src/physics/cam/cldwat2m.F90
. one line bugfix from Andrew Gettelman

models/atm/cam/src/physics/cam/phys_control.F90
. Remove the default setting for microp_scheme_default.  It is now the
  responsibility of configure to set this default.

models/atm/cam/src/physics/cam/stratiform.F90
. Add check that valid value of microp_scheme has been specified.

models/atm/cam/test/system/config_files/e64bfbiop
models/atm/cam/test/system/config_files/scm64bfbiop
. add "-microphys rk" for scam tests which are currently failing when the
  MG microphysics is enabled.

models/atm/cam/test/system/input_tests_master
. update test definitions to account for changed config file names
. replace special MG microphysics test with a test for the cam3.5 physics.
  currently this sets "-chem none -microphysics rk"  

models/atm/cam/test/system/nl_files/ttrac
models/atm/cam/test/system/nl_files/ttrac_lb1
models/atm/cam/test/system/nl_files/ttrac_lb2
models/atm/cam/test/system/nl_files/ttrac_lb3
. remove tracers_flag -- now set by build-namelist

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except:
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 7

bangkok/lf95: All PASS except:
004 bl111 TBL.sh e8t5mdm ttrac 9s .................................FAIL! rc= 5
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
023 bl311 TBL.sh f10t5mdm ttrac 9s ................................FAIL! rc= 5
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
033 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c3dm outfrq3s 9s ..............................FAIL! rc= 5
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
049 bl511 TBL.sh s8t5mdm ttrac 9s .................................FAIL! rc= 5
053 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
055 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

All baseline tests fail except for the adiabatic and ideal physics tests.
Some of the failures above are due to changing the names of config files.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: new climate in default model due to
  changing default microphysics to MG.  The answers for MG also change from
  the baseline due to the bug fix.

===============================================================
===============================================================

Tag name: cam3_5_55
Originator(s): eaton, santos, rneale 
Date: Wed Jul 30 11:22:12 MDT 2008
One-line Summary: fix compilation problems; new default files for full
chem; mods to generate input dataset lists

Purpose of changes:

. Fixes for compilation problems (with PGI) encountered during post-tag
  testing of previous tag.

. Add new default files so that build-namelist produces working namelists
  for 1 and 2 degree full trop chemistry runs.

. Mods to allow CCSM scripts to automatically retrieve missing input
  datasets from svn archive (from Sean Santos).

. Add log output to zm_conv to help diagnose ientropy errors (from Rich
  Neale). 

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. new input datasets for 1 and 2 degree full trop chemistry configs.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
models/atm/cam/bld/cam.cpl7.template
. Mods to allow CCSM scripts to automatically retrieve missing input
  datasets from svn archive.

models/atm/cam/bld/namelist_files/namelist_defaults.xml
. add files needed for 1 and 2 deg full trop chem runs

models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
. Change dummy arg "order" in both read_2d_trc and read_3d_trc from assumed
  shape to the correct explicit shape.

models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
. replace new "use share_const_mod" with constants from existing "use mo_constants"

models/atm/cam/src/physics/cam/zm_conv.F90
. add diagnostic output for ientropy errors

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except

044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7

This baseline test fails because the test code is using a new initial file
that contains spun up chemistry.

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_5_54
Originator(s): eaton, aconley, fvitt
Date: Thu Jul 24 10:48:30 MDT 2008
One-line Summary:  Add new radiative constituent interfaces.  Add RRTMG as
an option.  CAM3.5 configuration is now the default.

Purpose of changes:

. The new radiative constituent interface has been added.  This provides
  for an explicit specification of which constituents are radiatively
  active for both climate and diagnostic calculations.  The namelist
  variables rad_climate, rad_diag_1, rad_diag_2, ... rad_diag_10 are used
  to specify the constituents used for the climate and up to ten diagnostic
  calculations.  Each of the namelist variables specifies which
  constituents are used for the gas species, aerosol species, and a file
  that contains the optical and physical properties for each aerosol species.

  build-namelist constructs default values for rad_climate for each of the
  chemistry options.  There are no diagnostic calculations specified by
  default.  In this initial commit the diagnostic calculations for the CAM3
  radiation code are not implemented.  There is a partial implementation of
  the diagnostics for the RRTMG radiation.

  The functionality for controlling which aerosols were radiatively active
  was previously located in the aerosol_intr module.  The namelist
  variables previously used for this purpose have been removed.

. The RRTMG radiation code is present as a build time option.  It is
  enabled by specifying the flag -rrtmg to configure.  Implementing aerosol
  and cloud optics for RRTMG is not yet complete.

  The RRTMG code is accessed by CAM via an external definition of the 
  source tree directory models/atm/cam/src/physics/rrtmg/ext/

. MG microphysics now gets microphysical data for aerosols from the same
  files that provide the optics data.  This data was previously hardcoded
  in the prescribed_aerosols module.  That module has been removed.

. The 1990_control use case has been made the default configuration on the
  trunk.  This is the configuration used for CCSM3.5 1990 control
  runs.  The differences from the previous default configuration are:
  - The CAM-Chem prescribed aerosols replace the CAM3 aerosol climatology.
  - The GHG values (co2vmr, ch4vmr, n2ovmr, f11vmr, f12vmr) and scon are
    from the 1990_control use case.
  - The CAM-Chem prescribed ozone replaces the CAM3 ozone (from pcmdi).
  - The CAM-Chem options are enabled by making the configure option
    "-chem trop_mozart_prescribed_aero" the default chemistry mode.

. A new chemistry mode "-chem none" has been added to configure.
  Specifying this option turns on the CAM3 prescribed aerosols and ozone
  and makes them radiatively active.  The functionality to support the CAM3
  prescribed aerosols and ozone is implemented by the new cam3_aero_data
  and cam3_ozone_data modules.

. Modifications to CAM-Chem code:
  - The prescribed aerosol and ozone modules were modified to put the
    interpolated values (in mass mixing ratio units) into the physics
    buffer.
  - The namelist variable input has been redistributed so that it's not
    handled entirely by the chemistry module.
  - The names of the prescribed aerosols were changed.
  - Default value of xactive_drydep changed from .false. to .true.
  - More flexible tracer_data module.  Allow dimensions of the input data
    to occur in any order rather than restrict to (lon,lat,lev,tim).

. SVN_EXTERNAL_DIRECTORIES:
  - update to esmf_wrf_timemgr_080717
  - add external rrtmg_080606

Bugs fixed (include bugzilla ID):

. The CAM-Chem code that rebins the 4-bin sea salt into 2 bins for the
  CAM-RT optics was missing an initializer.

. The problem with the trop_mozart_ghg_paero mode running in debug mode
  under xlf11 has been fixed.  The problem was with date calculation code
  in tracer_data which has been updated to use time_manager methods (and
  required a mod to the esmf_wrf_timemgr code.

Describe any changes made to build system:

. add -rrtmg flag to configure to build CAM with RRTMG radiation

. modifications to make "trop_mozart_prescribed_aero" the default value of
  the -chem argument to configure

Describe any changes made to the namelist:

. namelist variables removed
  - rampyear_prescribed_sulfur
  - scenario_prescribed_sulfur
  - tauback
  - aeroptics
  - aero_feedback_carbon
  - aero_feedback_dust
  - aero_feedback_progsslt
  - aero_feedback_sea_salt
  - bndtvcarbonscale
  - carscl, dustscl, ssltscl, sulscl, volcscl
  - bgscl_rf, carscl_rf, dustscl_rf, ssltscl_rf, sulscl_rf, volcscl_rf
  - prescribed_sulfur
  - radforce
  - scenario_carbon_scale
  - use_cam_ghg_data, use_cam_ozone_data
  - use_data_co2, use_data_o3

. namelist variables added
  - cam3_ozone_data_on: enables the CAM3 prescribed ozone
  - cam3_aero_data_on:  enables the CAM3 prescribed aerosols
  - rad_climate
  - rad_diag_1, rad_diag_2, ..., rad_diag_10
  - prescribed_aero_datapath
  - prescribed_aero_file
  - prescribed_aero_filelist
  - prescribed_aero_rmfile
  - prescribed_aero_specifier
  - prescribed_aero_tod
  - prescribed_aero_type
  - prescribed_aero_ymd
  - prescribed_ghg_datapath
  - prescribed_ghg_file
  - prescribed_ghg_filelist
  - prescribed_ghg_rmfile
  - prescribed_ghg_specifier
  - prescribed_ghg_tod
  - prescribed_ghg_type
  - prescribed_ghg_ymd

. namelist variables modified
  - bndtvaer: moved from group cam_inparm to cam3_aero_data_nl
  - bndtvo: moved from group cam_inparm to cam3_ozone_data_nl
  - ozncyc: moved from group cam_inparm to cam3_ozone_data_nl

List any changes to the defaults for the boundary datasets:

. the namelist_defaults.xml file has been modified to remove all the
  resolution dependent start_ymd values.  This was origianlly implemented
  to ensure that a default initial file would be found without the user
  needing to know the corresponding date.  This feature was mainly for the
  regression testing.  But we now have the capability to specify
  -ignore_ic_date or -ignore_ic_year to build-namelist which is a more
  explicit and flexible way for the user to indicate that the exact date of
  the initial file isn't important.  The TBL.sh script uses the
  -ignore_ic_date arg in its build-namelist call.

  The result of this change is that some of our regression tests which
  previously got a resolution dependent start_ymd that was different from
  901 will now get the resolution independent default which has been
  changed to 101 for consistency with the CCSM scripts.

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/src/chemistry/trop_mozart/rad_cnst_data_interface.F90
. not needed.  prescribed aerosols now put in physics buffer and
  rad_constituents is responsible for knowing what to use for climate and
  diagnostic calcs.

models/atm/cam/src/physics/cam/aer_optics.F90
models/atm/cam/src/physics/cam/aerosol_index.F90
models/atm/cam/src/physics/cam/aerosol_radiation_interface.F90
. aerosol optical calcs moved to new aer_rad_props module

models/atm/cam/src/physics/cam/carbonscales.F90
. functionality replaced by providing time series data for carbon aerosol
  distributions. 

models/atm/cam/src/physics/cam/ozone_data.F90
. This module has been renamed cam3_ozone_data.

models/atm/cam/src/physics/cam/prescribed_aerosols.F90
. This module has been renamed cam3_aero_data.  All the functionality
  related to determining the aerosol mass for both the climate and
  diagnostic calculations now belongs in the rad_constituents module.

List all subroutines added and what they do:

models/atm/cam/src/chemistry/trop_mozart/prescribed_aero.F90
models/atm/cam/src/chemistry/trop_mozart/prescribed_ghg.F90
. New CAM-Chem code for prescribed aerosols and ozone.  The prescribed
  constituents are maintained in the physics buffer.

models/atm/cam/src/physics/cam/aer_rad_props.F90
. New module for computing aerosol radiative properties for both climate
  and diagnostic calculations.

models/atm/cam/src/physics/cam/cam3_aero_data.F90
. Responsible for putting the CAM3 aerosol mixing ratios into the physics
  buffer. 

models/atm/cam/src/physics/cam/cam3_ozone_data.F90
. Responsible for putting the CAM3 ozone mixing ratios into the physics
  buffer. 

models/atm/cam/src/physics/cam/hirsbt.f90
models/atm/cam/src/physics/cam/hirsbtpar.f90
. Diagnostic calculations of TOA brightness temperatures for 7 TOVS/HIRS
  channels and 4 TOVS/MSU channels.

models/atm/cam/src/physics/cam/phys_prop.F90
. responsible for maintaining the physical property data (includes optics)
  for the aerosols.

models/atm/cam/src/physics/cam/radconstants.F90
. constants for CAM-RT

models/atm/cam/src/physics/cam/sslt_rebin.F90
. rebins 4 sea salt bins into 2 bins.

models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/README
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/parrrtm.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_cld.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_con.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg01.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg02.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg03.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg04.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg05.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg06.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg07.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg08.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg09.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg10.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg11.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg12.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg13.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg14.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg15.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_kg16.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_ref.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_tbl.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_vsn.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrlw_wvn.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_cldprop.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_init.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_k_g.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_rad.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_rtrn.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_rtrnmr.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_setcoef.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_lw/rrtmg_lw_taumol.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/mcica_random_numbers.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/mcica_subcol_gen_lw.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/mcica_subcol_gen_sw.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/rrtmg_lw_cldprmc.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/rrtmg_lw_rad.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/rrtmg_lw_rtrnmc.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/rrtmg_sw_cldprmc.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/rrtmg_sw_rad.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_mcica/rrtmg_sw_spcvmc.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/README
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/parrrsw.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_aer.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_cld.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_con.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg16.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg17.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg18.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg19.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg20.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg21.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg22.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg23.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg24.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg25.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg26.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg27.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg28.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_kg29.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_ref.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_tbl.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_vsn.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrsw_wvn.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_cldprop.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_init.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_k_g.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_rad.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_reftra.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_setcoef.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_spcvrt.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_taumol.f90
models/atm/cam/src/physics/rrtmg/ext/rrtmg_sw/rrtmg_sw_vrtqdr.f90
. new RRTMG code.  This code is pulled in via an external definition.

models/atm/cam/src/physics/rrtmg/radconstants.F90
models/atm/cam/src/physics/rrtmg/radiation.F90
models/atm/cam/src/physics/rrtmg/radlw.F90
models/atm/cam/src/physics/rrtmg/radsw.F90
. CAM specific interface code to the RRTMG radiation parameterization.

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update to esmf_wrf_timemgr_080717
. add rrtmg_080606

models/atm/cam/bld/Makefile.in
. add suffix recognition and rules for compiling .f90 files

models/atm/cam/bld/build-namelist
. add defaults for the scon and GHG values
. only put absems_data into namelist when CAM-RT is active
. turn on the cam3 prescribed ozone and aerosols for configurations that
  don't yet work with the CAM-Chem versions (i.e., waccm)
. add appropriate defaults for the prescribed aerosols and ozone depending
  on whether cam3 or CAM-Chem versions being used (or both).
. construct new rad_climate specifier depending on the chem option
. remove old specifiers of aerosol feedback
. update namelist variables used by CAM-Chem options

models/atm/cam/bld/config_defaults_trop_mozart.xml
models/atm/cam/bld/config_defaults_trop_mozart_aero.xml
models/atm/cam/bld/config_defaults_trop_mozart_ghg_paero.xml
models/atm/cam/bld/config_defaults_trop_mozart_prescribed_aero.xml
. remove specification of cppdefs="-DTROPCHEM"

models/atm/cam/bld/config_definition.xml
. add parameter rrtmg
. modify chem parameter to accept 'none' as a valid value, and to make
  trop_mozart_prescribed_aero the default value.

models/atm/cam/bld/configure
. add -rrtmg option
. modify so that when the user specifies -nadv the value is not modified by
  configure 
. mod to supply the -DTROPCHEM cpp def when any trop_mozart* chemistry
  option is specified.  Then that specification may be removed from all the
  config_defaults_trop_mozart*.xml files

models/atm/cam/bld/mkSrcfiles
. update to recognize .f90 suffix for files that need to be built.  This
  was needed for building the rrtmg code.

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
. add Jan 1 IC file for T5
. add new defaults for aerosol optics
. add defaults for new prescribed ozone (same as 1990_control use case)
. add defaults for new prescribed aerosol (same as 1990_control use case)
. add defaults for GHGs and scon (same as 1990_control use case)

models/atm/cam/bld/namelist_files/namelist_definition.xml
. changes to namelist as described above

models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
. add GHG and scon settings consistent with 1870_control values used in
  CCSM3.5 simulations
. update for namelist changes in the CAM-Chem code

models/atm/cam/bld/namelist_files/use_cases/1870-2000_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1990_control.xml
. update for namelist changes in the CAM-Chem code

models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
. remove a bunch of namelist vars that have been moved to other modules

models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
. remove namelist variables from arg list that are now managed by module
  specific *_{default,set}opts methods.  Call new *_init methods.

models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
. Change default value of xactive_drydep from .false. to .true.

models/atm/cam/src/chemistry/trop_mozart/mo_airplane.F90
models/atm/cam/src/chemistry/trop_mozart/mo_jshort.F90
models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
. access parameter rearth from physconst rather than dycore specific
  dynconst module

models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
. remove set_aerosol_from_mz_prescribed routine

models/atm/cam/src/chemistry/trop_mozart/prescribed_ozone.F90
. add *_{default,set}opts methods
. put ozone in physics buffer in mass mixing ratio units

models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
. allocate memory if field not already in pbuf
. allow dimensions of input data to occur in any order
. use date calculation routines from time_manager

models/atm/cam/src/chemistry/trop_mozart/tracer_cnst.F90
models/atm/cam/src/chemistry/trop_mozart/tracer_srcs.F90
. add *_{default,set}opts methods

models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_sim_dat.F90
models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_sim_dat.F90
. change names of prescribed aerosols so that they can co-exist with the
  prognostic aerosols.

models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
. move namelist variables for prescribed_ozone, tracer_cnst, tracer_srcs
  modules into the *_{default,set}opts methods of those modules

models/atm/cam/src/chemistry/waccm_mozart/mo_sad.F90
. comment out sad_set_aer_mass routine which needs to be updated to use the
  physics buffer

models/atm/cam/src/control/cam_comp.F90
. add pbuf as actual arg in phys_init call

models/atm/cam/src/control/filenames.F90
. remove public module data bndtvaer, bndtvcarbonscale, aeroptics

models/atm/cam/src/control/runtime_opts.F90
. move bndtvaer, ozncyc to cam3_aero_data
. move bndtvo to cam3_ozone_data
. remove aeroptics, bndtvcarbonscale
  scenario_carbon_scale, scenario_prescribed_sulfur, rampyear_prescribed_sulfur,
  prescribed_sulfur, tauback, radforce
  aero_feedback_carbon, aero_feedback_sea_salt, aero_feedback_progsslt,
  aero_feedback_dust
  sulscl, carscl, ssltscl, dustscl, volcscl,
  sulscl_rf, carscl_rf, ssltscl_rf, dustscl_rf, volcscl_rf
  use_data_o3, use_data_co2, use_cam_ozone_data, use_cam_ghg_data
. added prescribed_ghg_specifier, prescribed_ghg_file, prescribed_ghg_filelist,
  prescribed_ghg_datapath, prescribed_ghg_type, prescribed_ghg_rmfile,
  prescribed_ghg_ymd, prescribed_ghg_tod,
  prescribed_aero_specifier, prescribed_aero_file,
  prescribed_aero_filelist, prescribed_aero_datapath, prescribed_aero_type, 
  prescribed_aero_rmfile, prescribed_aero_ymd, prescribed_aero_tod
. added *_{default,set}opts methods for tracer_cnst, tracer_srcs,
  prescribed_ozone, prescribed_ghg, prescribed_aero modules
. removed *_{default,set}opts methods for ozone_data, rad_constituents,
  aerosol_radiation_interface modules
. add methods to read module specific namelists for cam3_aero_data,
  cam3_ozone_data, rad_constituents modules

models/atm/cam/src/physics/cam/advnce.F90
. update interfaces for cam3 prescribed aerosols and ozone

models/atm/cam/src/physics/cam/aerosol_intr.F90
. remove variables that control whether aerosols are radiatively active
. remove set_aerosol_from_prognostics

models/atm/cam/src/physics/cam/cldwat2m.F90
. add addfld/add_default calls for existing outfld calls
. update rad_constituents interfaces
. comment output of aerosol number concentrations

models/atm/cam/src/physics/cam/phys_gmean.F90
models/atm/cam/src/dynamics/fv/mean_module.F90
models/atm/cam/src/dynamics/fv/d2a3dikj.F90
models/atm/cam/src/dynamics/fv/par_xsum.F90
models/atm/cam/src/dynamics/fv/p_d_adjust.F90
. comment out log messages about "fixed and floating point sums differ"

models/atm/cam/src/physics/cam/initindx.F90
. new register routines for cam3 aerosols and ozone
. new register routines for CAM-Chem prescribed ozone, aerosols, ghgs
. add log output after all pbuf fields registered

models/atm/cam/src/physics/cam/phys_buffer.F90
. new print method for log file info
. new query method pbuf_get_fld_name

models/atm/cam/src/physics/cam/physpkg.F90
. add pbuf to phys_init dummy args
. update init calls for cam3 aerosols and ozone
. new init calls for rad_constituents and aer_rad_props
. new init for the sea salt rebinning module

models/atm/cam/src/physics/cam/param_cldoptics.F90
models/atm/cam/src/physics/cam/pkg_cldoptics.F90
. add cloud optical depth calc

models/atm/cam/src/physics/cam/rad_constituents.F90
. implement new interface design that treats both gases and aerosols

models/atm/cam/src/physics/cam/radae.F90
. use radconstants

models/atm/cam/src/physics/cam/radiation.F90
. use radconstants
. remove calc of sat sp hum
. update rad_constituents interfaces
. new aer_rad_props interfaces
. temporarily remove diagnostic call and indirect call to radcswmx

models/atm/cam/src/physics/cam/radlw.F90
. use radconstants
. add aerosol optical depth arg to radclwmx
. add subroutine aer_trans_from_od

models/atm/cam/src/physics/cam/radsw.F90
. use radconstants
. remove rh arg from radcswmx
. add aerosol optical properties as args to radcswmx

models/atm/cam/src/physics/cam/stratiform.F90
. move addfld calls for MG microphysics quantities to cldwat2m.F90
. update the rad_constituent interfaces.  they are only used by MG.

models/atm/cam/src/physics/cam/tphysbc.F90
. Add a call to sslt_rebin_adv to rebin the seasalt from 4 into 2 bins.
  This is only need for the CAM-RT radiation code for which there are only
  optical characterizations of 2 sea salt bins.

models/atm/cam/src/physics/cam/volcanicmass.F90
. register the volcanic aerosol in pbuf and use pbuf to store the
  interpolated data
** this functionality is currently broken **

models/atm/cam/src/physics/waccm/nlte_lw.F90
. update to new rad_constituent interfaces

models/atm/cam/src/utils/repro_sum_mod.F90
. bug fix for non-spmd mode

models/atm/cam/src/utils/time_manager.F90
. add methods set_time_float_from_date and set_date_from_time_float

models/atm/cam/test/system/config_files/e64bfbiop
models/atm/cam/test/system/config_files/scm64bfbiop
. change configurations used to SCAM test to use "-chem none"

models/utils/esmf_wrf_timemgr/ESMF_TimeIntervalMod.F90
. enabled the d_ optional argument to ESMF_TimeIntervalSet


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: All PASS except
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
009 bl134 TBL.sh e32adh adia 9s ...................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
024 bl334 TBL.sh f4adh adia 9s ....................................FAIL! rc= 7
027 bl335 TBL.sh f4idh idphys 9s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 5

bangkok/lf95: All PASS except
004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
017 bl115 TBL.sh e8idm idphys 9s ..................................FAIL! rc= 7
019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
023 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
033 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
049 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 7
053 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
055 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

These baseline tests are expected to fail due to changed answers.  The
ideal physics and adiabatic configurations in tests bl115, bl334, and bl335
are actually BFB, but the test is failing due to the changes to the default
start_ymd values.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_52

Summarize any changes to answers:

Model configurations that are BFB with the baseline:
====================================================

. adiabatic and ideal physics

. full physics configurations in which the only radiatively active species
  are the gases.  If prescribed ozone is active, it must be the CAM3
  ozone. The CAM3 ozone is enabled by setting cam3_ozone_data_on=.true. in
  the namelist.  The aerosols are turned off in the baseline code by
  setting sulscl=dustscl=carscl=ssltscl=0.0 in the namelist.

  This was verified for the -chem options: trop_mozart_prescribed_aero,
  trop_mozart_ghg_paero, trop_mozart_aero, trop_mozart, waccm_ghg, and
  waccm_mozart.

Model configurations that have only roundoff differences with the baseline:
===========================================================================

. full physics configurations in which the only radiatively active species
  are the gases *and* the active ozone is the CAM-Chem prescribed ozone.
  This version of ozone is the now the default on the trunk.  The aerosols
  are turned off in the baseline code by setting
  sulscl=dustscl=carscl=ssltscl=0.0 in the namelist.

  This was verified via a pergro test for the -chem option
  trop_mozart_prescribed_aero.

. full physics configurations with CAM-Chem version of aerosols (prescribed
  or prognostic).

  In order to validate the roundoff diffs it is necessary to fix the bug in
  the baseline code that rebins the 4-bin sea salt into 2 bins.

  Configurations that were verified by pergro test are the -chem options:
  trop_mozart_prescribed_aero and trop_mozart_ghg_paero.

Model configurations with larger than roundoff differences from the baseline:
=============================================================================

. full physics configurations using the CAM3 prescribed aerosols.  The
  issue here is that these aerosol mixing ratios were incorrectly treated
  as moist mmr in CAM3 code.  This has been fixed.  The result is larger
  than roundoff differences (but presumably the same climate) have been
  introduced into these configurations.  That includes the waccm_ghg and
  waccm_mozart modes which aren't yet configured to use the new CAM-Chem
  prescribed aerosols.

Validation with MG microphysics enabled:
========================================

. The validation of the default configuration + MG microphysics is
  complicated by very large error growth when MG is enabled.  Our standard
  pergro test is not valid in this configuration.  So to attempt to validate
  MG I looked just at a 6 step run using the pergro/aqua_planet
  configuration, and looked at the output from cprnc for all fields written
  to the default history file.  The roundoff size differences are introduced
  at nstep=0, and it can be seen that all fields with differences show 12-16
  digits of agreement on average.  This isn't a stong test, but it did point
  out problems that resulted in larger than roundoff size differences at
  nstep=0.  In particular, to get this test to pass it was necessary to make
  a bugfix to the baseline code.  In stratiform_tend the conversion of aerosol
  mass to mmr made before calling the MG microphysics was using moist instead
  of dry air mass.

===============================================================
===============================================================

Tag name: cam3_5_53
Originator(s): mvr, jedwards, dbailey, pworley
Date: 17 July 2008
One-line Summary: bug fix for omp-only mode; code workaround for pathscale 
compiler problem; backed out timing library introduced in cam3_5_51; new 
cice tag with prescribed ice similar to csim

Purpose of changes: 
cam3_5_51 introduced a few things needing attention...omp-only mode needed 
a bug fix and posttag testing with pathscale was disabled due to new code 
that triggered a compiler problem...also, running with the ccsm scripts 
showed a problem with the timing library introduced

a new cice tag became available where the prescribed ice looks similar to 
csim...this is the next step on the path to replacing csim with cice
	
Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:
	
List all subroutines added and what they do:
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/bld/run-ibm.csh
- revised the list of ibm env vars (from jedwards)

M      models/atm/cam/bld/cam.cpl7.template
- cleanup, removed sourcing of ccsm env files; use_case now set from ccsm env var

M      models/atm/cam/bld/camsom.cpl7.template
M      models/atm/cam/bld/camcsim.cpl7.template
M      models/atm/cam/bld/camdom.cpl7.template
- cleanup, removed sourcing of ccsm env files

M      models/atm/cam/src/utils/repro_sum_mod.F90
- code workaround for pathscale compiler problem which surfaced with cam3_5_51
	
M      models/atm/cam/src/dynamics/fv/mean_module.F90
- bug fix for running in omp-only mode
	
 M     .
M      SVN_EXTERNAL_DIRECTORIES
- new clm, cice, timing, and scripts tag
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
052 sm382 TSM.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 8
053 er382 TER.sh fmgpa1.9dh outfrq3s+1870_control 4+5s ............FAIL! rc= 5
054 br382 TBR.sh fmgpa1.9dh outfrq3s+1870_control 6+3s ............FAIL! rc= 5
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 4
	
- "382" tests are existing failures which first occurred with introduction of XLF 
  11.1 compilers on the IBM's, which is the default on bluevista and bluefire
	
bangkok/lf95:
all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): bfb

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_5_52
Originator(s): pworley
Date: 11 July 2008
One-line Summary: use scalable reproducible sum logic in FV distributed sums

Purpose of changes: improve performance and memory scalability

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: Substantial performance
improvement for runs with large numbers of tracers; modest improvements in 
current FV production configurations.

Code reviewed by: Eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  M models/atm/cam/src/dynamics/fv/d2a3dikj.F90
  M models/atm/cam/src/dynamics/fv/fv_prints.F90
  M models/atm/cam/src/dynamics/fv/mean_module.F90
  M models/atm/cam/src/dynamics/fv/p_d_adjust.F90
  M models/atm/cam/src/dynamics/fv/par_xsum.F90

  - Replaced existing logic based on "master computes" with the scalable,
    reproducible algorithm implemented in repro_sum_module. If the relative
    difference between the sum produced by the reproducible fixed-point 
    algorithm and by the nonreproducible floating-point algorithm is greater 
    than repro_sum_rel_diff_max  (default 1.0e-13) and if repro_sum_recompute 
    is set equal to true (default .false.), then the sum is recomputed with
    the original (nonscalable) algorithm. Since this is done on a field-by-field
    basis, the memory requirements are less than in the original implementation,
    but the cost is potentially much greater.

  M models/atm/cam/src/dynamics/fv/FVperf_module.F90

  - defined the grid argument in FVstartclock, FVstopclock, and
    FVbarrierclock to be intent(in) instead of intent(inout) when
    GEOS_MODE is NOT defined. This removes an incompatibility introduced by
    using FVstart/stopclock in par_xsum.F90.

  M models/atm/cam/src/dynamics/fv/te_map.F90

  - in previous versions, par_xsum was not called when SPMD was not defined
    or when nprxy_x = 1. To preserve reproducibility when using the repro_sum 
    routine, te_map was modified to call par_xsum in all instances.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice:

015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
024 bl334 TBL.sh f4adh adia 9s ....................................FAIL! rc= 7
027 bl335 TBL.sh f4idh idphys 9s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7

Use of repro_sum algorithm in FV distributed sums introduces a roundoff level
difference in the numerics. All FV comparisons with the baseline code fail.

051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
052 sm382 TSM.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 8
053 er382 TER.sh fmgpa1.9dh outfrq3s+1870_control 4+5s ............FAIL! rc= 5
054 br382 TBR.sh fmgpa1.9dh outfrq3s+1870_control 6+3s ............FAIL! rc= 5
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 4

- "382" tests are existing failures which first occurred with introduction of XLF 
  11.1 compilers on the IBM's, which is the default on bluevista and bluefire

bangkok/lf95:

023 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
033 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7

Due to roundoff level difference in numerics, FV comparisons with the baseline 
code fail.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: FV dycore
- what platforms/compilers: all
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff? standard pergro test

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_5_51
Originator(s): pworley
Date: 10 July 2008
One-line Summary: BGP support; new timing library; new 
reproducible sum routine; new performance optimization options
in cd_core; ALTGATHER support; clean-up and bug fixes

Purpose of changes:

Bugs fixed (include bugzilla ID): omega diagnostic calculation
is now correct when geopktrans==1 (and 2)

Describe any changes made to build system: added support for BGP in 
Makefile and in configure. Adding ALTGATHER to CPPFLAGS may
eliminate the gather failure on the Cray XT without requiring setting
MPI environment variables.

Describe any changes made to the namelist: eliminated 
phys_float_repro_gmean, phys_fixed_repro_gmean, and 
phys_nonrepro_gmean; replaced phys_rdiff_warning_gmean with
repro_sum_rel_diff_max; added repro_sum_recompute, 
geopkblocks, and cd_core_swapm; added option 2 to geopktrans.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: performance improved 
for certain problems and platforms by setting geopktrans=2 and
geopkblocks appropriately, and/or by setting cd_core_swapm to .true.

Code reviewed by: Eaton

List all subroutines eliminated:
   in models/atm/cam/src/physics/cam/phys_gmean.F90
   1) phys_gmean_defaultopts
   2) phys_gmean_setopts
   3) gmean_nonrepro

List all subroutines added and what they do: 
   in new file models/atm/cam/src/utils/repro_sum_defaultopts.F90
   1) repro_sum_defaultopts   
      - get default runtime options (replacement for phys_gmean_defaultopts)
   2) repro_sum_setopts       
      - set runtime options (replacement for phys_gmean_setopts)
   3) repro_sum
      - calculate both fixed-point scalable, reproducible distributed sums
        and floating-point scalable, nonreproducible sums, returning
        fixed-point results and relative difference between two algorithms.

   in models/utils/pilgrim/mod_comm.F90
   1) mp_sendirr_fc
      - version of mp_sendirr with additional flow control
   2) mp_sendirr_fc_r4
      - version of mp_sendirr_r4 with additional flow control
   3) mp_sendirr_fc_i4
      - version of mp_sendirr_i4 with additional flow control
   4) mp_swapmirr
      - replacement for mp_sendirr/mp_recvirr that gives up
        support for one-sided and MPI datatype options and communication/
        computation overlap, but adds swap_comm protocol
        options, improved communication ordering, and the ability to 
        transpose multiple fields simultaneously.

   in models/atm/cam/control/wrap_mpi.F90
   1) mpigathervr4
      - version of mpigatherv for r4 data
   2) mpigathervint
      - version of mpigatherv for int data

   in models/atm/cam/dynamics/fv/geopk.F90
   1) geopk_d
      - implementation of same calculation as geopk without requiring 
        transpose. Calculation is reproducible, and numerics are identical
        to geopk. Performance is somewhat similar to geopk16.

List all existing files that have been modified, and describe the changes:

Timing library
  Updated to include a more recent version of Jim Rosinski's
  GPTL library, supporting global statistics, and improved control of 
  output

  M SVN_EXTERNAL_DIRECTORIES
    - updated to timing/trunk_tags/timing080629

  M models/atm/cam/bld/Makefile.in
    - added OpenMP-enabling flags to CFLAGS when SMP is defined
      for all platforms where missing. Note that have tested only
      on Bluefire, Bangkok, Cray XT4 (Jaguar), and IBM BG/P

ALTGATHER
  Defining ALTGATHER replaces mpi_gather in mpigatherv with a point-to-point
  implementation with additional flow control. It also calls new routines
  mp_sendirr_fc, mp_sendirr_fc_r4, and mp_sendirr_fc_i4 with additional
  flow control for gathers in FV I/O routines. This avoids many of the gather
  failures on the Cray XT. These may become unecessary when PIO becomes
  operational, but this approach is more robust than using MPI environment
  variables to avoid the gather error.

  M models/utils/pilgrim/mod_comm.F90
    - added mp_sendirr_fc, mp_sendirr_fc_r4, mp_sendirr_fc_i4

  M models/atm/cam/src/control/binary_io.F90
  M models/atm/cam/src/physics/cam/phys_grid.F90
  M models/atm/cam/src/control/cam_history.F90
    - call mpigathervr4 and mpigathervint instead of mpigatherv when
      gathering r4 and int data, respectively

  M models/atm/cam/src/dynamics/fv/io_dist.F90
    - if ALTGATHER defined, call mp_sendirr_fc, 
      mp_sendirr_fc_r4 and mp_sendirr_fc_i4 instead of
      mp_sendirr, mp_sendirr_fc and mp_sendirr_fc, respectively

  M models/atm/cam/src/control/wrap_mpi.F90
    - added new routines mpigathervr4 and mpigathervint; if ALTGATHER
      defined, use point-to-point implementations of the gather
      with flow control in mpigatherv, mpigathervr4, and migathervint
      instead of MPI_GATHERV

BG/P support:
  M models/atm/cam/bld/Makefile.in
    - added BGP section that works on ORNL BGP system; have not yet tried
      on ANL BGP system
  M models/atm/cam/bld/configure
    - added bgp as -target_os option
  M models/atm/cam/src/utils/abortutils.F90
    - added BGP to existing BGL ifdef
  M models/atm/cam/src/physics/cam/zm_conv_intr.F90
    - BGP compiler bug workaround (having to do with an
      optional parameter). Enabled only if BGP defined.

Reproducible distributed sum
  Extracted fixed-precision algorithm from phys_gmean and put into
  a new module. New algorithm can be used with any distributed sum, not
  just a global mean. Both fixed-precision and floating-point algorithms 
  are now always computed, and the relative difference is
  returned in an optional parameter. The error tolerance 
  repro_sum_rel_diff_max is used in the calling routine (phys_gmean here)
  to decide whether to just write out a warning message or to also
  recompute using the original "master computes" nonscalable algorithm. 
  The recalculation occurs in phys_gmean if the namelist parameter 
  repro_sum_recompute is set to .true.

  M models/atm/cam/src/control/runtime_opts.F90
    - eliminated phys_float_repro_gmean, phys_fixed_repro_gmean, 
      phys_nonrepro_gmean, and phys_rdiff_warning_gmean ; added
      repro_sum_rel_diff_max and repro_sum_recompute

  M models/atm/cam/src/physics/cam/phys_gmean.F90
    - replaced in-place algorithm with call to repro_sum
    - deleted public routines phys_gmean_defaultopts, phys_gmean_setopts, 
      and private routine gmean_nonrepro

  M models/atm/cam/src/physics/cam/phys_grid.F90
    - made nlcols public for use in phys_gmean

Alternative GEOPK routine
  The calculation of geopotential to the kappa (geopk) is one of the 
  more expensive operators in the FV dycore when using a 2D domain
  decomposition as it requires transposing from a YZ to an
  XY decompostion and back again for each call. An existing
  non-transpose-based alternative algorithm (geopk16) is not 
  reproducible unless quad precision is used, which is not 
  available on a number of platforms, such as the Cray XT. 
  A new optional algorithm, geopk_d, has been introduced that does 
  not require a transpose and is reproducible without requiring 
  quad precision. Performance using geopk_d is sometimes better 
  (and sometimes worse) than the other options. geopk_d
  is enabled by setting the namelist parameter geopktrans
  to 2. (Setting it to 0, the default, enbles geopk; setting it to 1 
  enables geopk16.) A tuning parameter geopkblocks is used with geopk_d 
  to define the amount of overlap to try to exploit in this 
  distributed algorithm. The default is 1 (no overlap), while the 
  optimal choice appears to be approximately 3 when using large 
  latitude decompositions. However, the optimum is dependent on problem 
  size, processor count, and platform. In the process of introducing
  this option, it was discovered that the non-transpose-based options
  were no longer working due to the reworking of the omega calculation.
  This has been fixed.

  M models/atm/cam/src/dynamics/fv/geopk.F90
    - added geopk_d

  M models/atm/cam/src/dynamics/fv/cd_core.F90
    - added call to geopk_d and bug fix

  M models/atm/cam/src/dynamics/fv/dyn_comp.F90
    - distributed algorithm bug fix

  M models/atm/cam/src/dynamics/fv/dynamics_vars.F90
  M models/atm/cam/src/dynamics/fv/spmd_dyn.F90
    - added support for geopk_d

  M models/atm/cam/src/control/runtime_opts.F90
    - added geopkblocks namelist parameter

  M models/atm/cam/src/dynamics/eul/spmd_dyn.F90
  M models/atm/cam/src/dynamics/homme/spmd_dyn.F90
  M models/atm/cam/src/dynamics/sld/spmd_dyn.F90
    - added geopkblocks to spmd_dyn_defaultopts and 
      spmd_dyn_setopts

Alternative transpose algorithm
  A major source of communication overhead in FV when using
  the 2D decomposition is the transposes between the YZ and XY
  decompositions. The current Pilgrim/mod_comm implementation
  supports both one-sided and two-sided MPI communication, and
  both explicit buffer packing and MPI datatypes. Every effort
  is made to overlap communication with computation by separating
  the commands mp_sendirr and mp_recvirr. As an evaluation tool,
  an alternative mechanism called mp_swapmirr has been introduced 
  that uses the swapm routine. mp_swapmirr gives up 
  the one-sided and MPI data type options and does not try to
  overlap the communication. but it does enable
  trying many different two-sided communication protocols, uses
  a more efficient communication ordering, and has the ability
  to transpose multiple fields simultaneously. This capability is
  introduced initially into cd_core only, and is enabled by
  setting the namelist parameter cd_core_swapm to .true.
  Initial experiments indicate that mp_swapmirr is sometimes 
  more efficient. If this holds upon further investigation, 
  the relevant functionality will either be introduced 
  into the standard mod_comm routines or the new routine
  will be used outside of cd_core as well.

  M models/atm/cam/src/dynamics/fv/cd_core.F90
    - added call to mp_swapmirr

  M models/utils/pilgrim/mod_comm.F90
    - added mp_swapmirr

  M models/atm/cam/src/control/runtime_opts.F90
    - added cd_core_swapm namelist parameter

  M models/atm/cam/src/dynamics/fv/dyn_comp.F90
  M models/atm/cam/src/dynamics/fv/spmd_dyn.F90
  M models/atm/cam/src/dynamics/fv/dynamics_vars.F90
    - added support for mp_swapmirr (cd_core_swapm)

  M models/atm/cam/src/utils/spmd_utils.F90
    - added communicator argument to swapm (so that could
      be used in FV); added optional parameters to override
      communication protocol defaults
    - changed default protocol to mpi_isend/mpi_irevc
      (from mpi_sendrecv) as a general performance optimization

  M models/atm/cam/src/control/wrap_mpi.F90
    - added communicator argument to swapm

  M models/atm/cam/src/dynamics/eul/spmd_dyn.F90
  M models/atm/cam/src/dynamics/homme/spmd_dyn.F90
  M models/atm/cam/src/dynamics/sld/spmd_dyn.F90
    - added cd_core_swapm to spmd_dyn_defaultopts and 
      spmd_dyn_setopts

MISCELLANEOUS

  M models/atm/cam/src/utils/spmd_utils.F90
    - changed default swapm MPI protocol to mpi_isend/mpi_irevc
      (from mpi_sendrecv) as a general performance optimization

  M models/atm/cam/src/physics/cam/phys_grid.F90
    - changed message tags to differentiate from dycore message tags

  M models/atm/cam/src/control/cam_comp.F90
    - disabled output of spmdstats files unless SPMDSTATS defined

  M models/atm/cam/src/dynamics/fv/stepon.F90
  M models/atm/cam/src/dynamics/fv/io_dist.F90
  M models/atm/cam/src/dynamics/fv/inidat.F90
  M models/atm/cam/src/dynamics/fv/dynamics_vars.F90
  M models/atm/cam/src/dynamics/fv/te_map.F90
  M models/atm/cam/src/dynamics/fv/dryairm.F90
    - deleted unnecessary use statements or unused elements
      in use statements
    - (for some) changed CCP_PRT_PREFIX definition

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire:
052 sm382 TSM.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 8
053 er382 TER.sh fmgpa1.9dh outfrq3s+1870_control 4+5s ............FAIL! rc= 5
054 br382 TBR.sh fmgpa1.9dh outfrq3s+1870_control 6+3s ............FAIL! rc= 5
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 4

- "382" tests are existing failures which first occurred with introduction of XLF 
  11.1 compilers on the IBM's, which is the default on bluevista and bluefire

bangkok/lf95:  all pass

jaguar: all pass (using posttag tests)

** ran tests both with and without cd_core_swapm = .true and
   geoptrans = 2, with identical results.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_5_50
Originator(s): mvr,jwolfe,pel,jrichter,jedwards
Date: 24 June 2008
One-line Summary: change to critical froude number; fix to fv polar 
filter; fix for memory bug in ccsm bgc runs; processor binding included 
with mpirun calls for bluefire in test and template scripts

Purpose of changes: 
	
Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: none

Describe any changes made to the namelist: 
-Implement fft_flt flag to switch between the FFT filter always and a
 combination FFT/algebraic filter.  Make default FFT always.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/tests_posttag_blueice
D      models/atm/cam/test/system/tests_pretag_blueice
-removed default test lists for decommissioned machine
	
List all subroutines added and what they do:
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TCT.ccsm.sh
-test script modified to use ccsm scripts from cam sandbox rather than 
 external ccsm tag

M      models/atm/cam/test/system/test_driver.sh
-top level test script modified to remove code for decommissioned machine, 
 blueice and updated aix environment variables for bluevista,bluefire

M      models/atm/cam/test/system/tests_posttag_bluefire
M      models/atm/cam/test/system/tests_posttag_bluevista
-modified sets of default pretag/posttag tests

M      models/atm/cam/test/system/input_tests_master
-added test of cam using cice as ice model (via ccsm scripts)
	
M      models/atm/cam/test/system/CAM_runcmnd.sh
-processor binding in mpirun.lsf calls; blueice cleanup
	
M      models/atm/cam/bld/run-ibm.csh
-processor binding in mpirun.lsf call; modified list of aix env vars
	
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
-add definition for fft_flt.  read from cam_inparm for now

M      models/atm/cam/src/control/runtime_opts.F90
-read fft_flt from cam_inparm namelist
	
M      models/atm/cam/src/control/atm_comp_mct.F90
-fix to bug which caused memory leak in bgc runs of ccsm
	
M      models/atm/cam/src/control/fv_control_mod.F90
-Add fft_flt flag (namelist) to switch between FFT filter always and a
 combination FFT/algebraic filter

M      models/atm/cam/src/physics/cam/gw_drag.F90
-change fcrit2 from 0.5 to 1.0

M      models/atm/cam/src/dynamics/fv/pft_module.F90
-Implement fft_flt flag to switch between the FFT filter always and a
 combination FFT/algebraic filter.  Make default FFT always.

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
019 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
021 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
024 bl334 TBL.sh f4adh adia 9s ....................................FAIL! rc= 7
027 bl335 TBL.sh f4idh idphys 9s ..................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
037 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
041 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
044 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
051 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
052 sm382 TSM.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 8
053 er382 TER.sh fmgpa1.9dh outfrq3s+1870_control 4+5s ............FAIL! rc= 5
054 br382 TBR.sh fmgpa1.9dh outfrq3s+1870_control 6+3s ............FAIL! rc= 5
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 4
057 bl711 TBL.sh h5x8adm adia 9s ..................................FAIL! rc= 5

- baseline tests failed due to change to gravity wave constant and mods to the 
  fv polar filter
	
- "382" tests are existing failures which first occurred with introduction of XLF 
  11.1 compilers on the IBM's, which is the default on bluevista and bluefire
	
bangkok/lf95:
004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
019 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
023 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
031 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
033 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
036 bl314 TBL.sh wg10dm outfrq3s 9s ...............................FAIL! rc= 7
039 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7
042 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
045 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
049 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 7
053 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
057 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

- baseline tests failed due to change to gravity wave constant and mods to the 
  fv polar filter
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): larger than roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

evaluations were assumed to have been done by the associated scientists 
providing the source mods:  Jaga Richter for the gravity wave change 
and Peter Lauritzen for the fv polar filter change
	
MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_5_49
Originator(s): mvr,mvertens
Date: 12 June 2008
One-line Summary: added support for new machine bluefire; enabled 
create_newcase (of the ccsm scripts) to be called from within cam;
added code work-around for older pgi compilers

Purpose of changes: 
bluefire (the new IBM clustered system at NCAR based on the Power6 chip) 
came online june 9th and blueice will be taken offline around june 16

we wanted the ability to do model runs from cam using the ccsm 
scripts in order to benefit from the features these scripts offer, like: 
swapping in other component models (like replacing csim for cice), 
use of the ccsm run database to document model runs, etc. 

fix that went into cam3_5_48 corrected problems for pgi and pathscale 
compilers as well as ifort, but not older versions (6.1-6) of pgi used 
on cgd machines bangkok and calgary; a code work-around was added to 
enable posttag testing on those machines while we wait for a compiler 
upgrade 


Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

List all subroutines added and what they do:
A      models/atm/cam/test/system/tests_pretag_bluefire
A      models/atm/cam/test/system/tests_posttag_bluefire
- default sets of tests for new machine bluefire
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/CAM_runcmnd.sh
M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/test/system/test_driver.sh
- added support for new machine bluefire
M      models/atm/cam/bld/cam.cpl7.template
- minor bug fixes
M      models/atm/cam/src/physics/cam/tidal_diag.F90
- code work-around for older versions of pgi compiler
	M     .
M      SVN_EXTERNAL_DIRECTORIES
- new clm, scripts, cice tags; now grabbing clm bld directory with checkouts
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluefire: 
052 sm382 TSM.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 8
053 er382 TER.sh fmgpa1.9dh outfrq3s+1870_control 4+5s ............FAIL! rc= 5
054 br382 TBR.sh fmgpa1.9dh outfrq3s+1870_control 6+3s ............FAIL! rc= 5
055 bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 4
- existing failures which first occurred with introduction of XLF 11.1 compilers
  on the IBM's, which is the default on bluevista and bluefire
	
bangkok/lf95: all pass

calgary/pgi: just baselines failed (due to compiler bug in baseline tag)

**additionally ran the ccsm test ERS_D.f19_f19.F.blueice (passed)
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): b4b

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_5_48
Originator(s): Francis Vitt
Date: 3 June 2008
One-line Summary: changes for ifort compiler

Purpose of changes: to compile with ifort compiler

Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/src/physics/cam/tidal_diag.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_apex.F90
M      models/atm/cam/src/chemistry/waccm_mozart/apex_subs.F90
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice: all pass

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 
cam3_5_47
If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_47
Originator(s): Francis Vitt
Date: 29 May 2008
One-line Summary: WACCM bug fixes and enhancements.

Purpose of changes:

  Enhance science in WACCM chemistry and fix a few bugs.  The enhancements
  and bug fixes include:
    - Updated chemistry to JPL-2006. 
    - Added ClOy and BrOy family tracers (CLY and BRY) to improve 
      conservation of Cl and Br during advection.
    - Made photolysis more flexible by using label tags in the
      preprocessor input file.
    - Don't allow wet removal above 300 mb in polar region.  
    - Added tidal diagnostics.
    - Updates in aurora code.
    - Added the ability to input surface fields that are lat, and time
      dependent only in addition to fields that are lon, lat, and time
      dependent.
    - Added F107, F107a, Kp, Ap to history tapes.
    - Added offline waccm driver capability.
    - Added capability to use the Judith Lean solar irradiance data.
    - Added the radiative feed back option for stratospheric sulfur aerosols

Bugs fixed (include bugzilla ID):

  Fixed bug in O2 data used in radsw for waccm

  Fixed inithist bug (bugzilla ID 715)

  Fixed a bug in mo_jlong which was producing jagged photolysis
  rate profiles.  There was in error in the calculation of the 
  ozone ratios used in the interpolations of the radiative source 
  functions.

  Fixed negative del_p bug in mo_jlong

Describe any changes made to build system:

  Increased the number of advected tracers by two for waccm_mozart chemistry

  Added build-namelist use_cases for waccm:
   - waccm_1950_smax
   - waccm_1950_smin
   - waccm_1995_smax
   - waccm_1995_smin
   - waccm_1950_ramped
   - waccm_1953_ramped_qbo

Describe any changes made to the namelist:

  Added new namelist options for offline driver
   - met_rlx_top
   - met_rlx_bot
   - met_max_rlx
   - met_fix_mass
   - met_shflx_name
   - met_qflx_name
   - met_shflx_factor
   - met_qflx_factor
   - solar_photons_file
   - strat_aero_feedback

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton, Francis Vitt

List all subroutines eliminated:

D    models/atm/cam/src/chemistry/waccm_mozart/mo_read_chm_sim.F90

List all subroutines added and what they do:

A    models/atm/cam/bld/namelist_files/use_cases/waccm_1950_ramped.xml
A    models/atm/cam/bld/namelist_files/use_cases/waccm_1950_smax.xml
A    models/atm/cam/bld/namelist_files/use_cases/waccm_1953_ramped_qbo.xml
A    models/atm/cam/bld/namelist_files/use_cases/waccm_1995_smin.xml
A    models/atm/cam/bld/namelist_files/use_cases/waccm_1995_smax.xml
A    models/atm/cam/bld/namelist_files/use_cases/waccm_1950_smin.xml
  * new waccm use cases

A    models/atm/cam/src/chemistry/waccm_mozart/clybry_fam.F90
  * module added to manage setting the family tracer before advection
    and to adjust the individual component species after advection

A    models/atm/cam/src/physics/cam/tidal_diag.F90
  * added tidal diagnostics for waccm

A    models/atm/cam/src/physics/cam/solvar_interface.F90
A    models/atm/cam/src/chemistry/waccm_mozart/solar_photons.F90
A    models/atm/cam/src/chemistry/waccm_mozart/solvar_woods.F90
A    models/atm/cam/src/chemistry/waccm_mozart/solvar_data.F90
  * Files added for the use of the Lean solar irradiance data

List all existing files that have been modified, and describe the changes:

M    models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
  * changed default namelist files
   - xs_short_file 
   - xs_long_file
   - rsf_file

M    models/atm/cam/src/control/runtime_opts.F90
M    models/atm/cam/bld/namelist_files/namelist_definition.xml
  * added new namelist options
   - met_rlx_top
   - met_rlx_bot
   - met_max_rlx
   - met_fix_mass
   - met_shflx_name
   - met_qflx_name
   - met_shflx_factor
   - met_qflx_factor
   - solar_photons_file
   - strat_aero_feedback

M    models/atm/cam/bld/namelist_files/use_cases/waccm_1995_climo.xml
  * added default start_ymd setting

M    models/atm/cam/bld/config_defaults_waccm_mozart.xml
  * increased nadv to 65 for waccm (BRY and CLY added)

M    models/atm/cam/src/control/cam_history.F90
  * fixed init hist bug
  * added time-dimensional only fields 'f107', 'f107a', 'ap', 'kp' to the
    history files in the same manor as 'co2vmr'

M    models/atm/cam/src/physics/cam/tphysbc.F90
  * invocation added to adjust the individual BRY and CLY family  
    tracers after advection

M    models/atm/cam/src/physics/cam/tphysac.F90
  * invocation added to set CLY and BRY family tracers before advection

M    models/atm/cam/src/physics/cam/cam_diagnostics.F90
  * added tidal diagnostics for waccm

M    models/atm/cam/src/chemistry/waccm_mozart/mo_jlong.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_jshort.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_waccm_photo.F90
  * changes for tagged photolysis rates scheme 
  * changed max solar zenith angle to 97.01 degrees
  * In subroutines jlong_hrates and jlong_photo corrected the 
    calculation of the O3 ratios used in the interpolations of 
    the radiative source functions
  * Files changed for the use of the Lean irradiance data

M    models/atm/cam/src/chemistry/waccm_mozart/mo_chemini.F90
M    models/atm/cam/src/physics/cam/aerosol_radiation_interface.F90
M    models/atm/cam/src/physics/cam/radsw.F90
M    models/atm/cam/src/chemistry/waccm_mozart/woods.F90
M    models/atm/cam/src/chemistry/waccm_mozart/solvar_interface.F90
  * Files changed for the use of the Lean irradiance data

M    models/atm/cam/src/chemistry/waccm_mozart/chem_surfvals.F90
  * set O2 mmr data to 0.23143
  * Added the ability to input surface fields that are lat, and time
    dependent only in addition to fields that are lon, lat, and time
    dependent. This is backwards compatible so the the "old" surface
    data file can still be used.

M    models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
  * history addfld calls added
  * call to advance Lean irradiance data added

M    models/atm/cam/src/chemistry/waccm_mozart/mo_gas_phase_chemdr.F90
  * history outfld calls added
  * wetdep interface change

M    models/atm/cam/src/chemistry/waccm_mozart/mo_wetdep.F90
  * changed min pressure where wet removal is applied to 
    300 mbar poleward of 60 degrees.

M    models/atm/cam/src/chemistry/waccm_mozart/efield.F90
  * write to iulog 

M    models/atm/cam/src/chemistry/waccm_mozart/mo_aurora.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mag_parms.F90
  *  Changes in aurora code supplied by Liying Qian

M    models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_strato_rates.F90
  * change for new JPL 2006 chemistry mechanism

M    models/atm/cam/src/chemistry/waccm_mozart/chem_mods.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_lu_solve.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_phtadj.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_nln_matrix.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_lu_factor.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_sim_dat.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_indprd.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_adjrxt.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_lin_matrix.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_setrxt.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_prod_loss.F90
M    models/atm/cam/src/chemistry/waccm_mozart/mo_usrrxt.F90
M    models/atm/cam/src/chemistry/waccm_mozart/m_het_id.F90
M    models/atm/cam/src/chemistry/waccm_mozart/m_spc_id.F90
M    models/atm/cam/src/chemistry/waccm_mozart/m_rxt_id.F90
  * new code generated by the chemistry preprocessor

M    models/atm/cam/src/chemistry/waccm_mozart/mo_sad.F90
  * JF's change on lightning factor implementation

M    models/atm/cam/src/dynamics/fv/inidat.F90
M    models/atm/cam/src/dynamics/fv/dyn_comp.F90
M    models/atm/cam/src/dynamics/fv/cd_core.F90
M    models/atm/cam/src/dynamics/fv/sw_core.F90
M    models/atm/cam/src/dynamics/fv/uv3s_update.F90
M    models/atm/cam/src/dynamics/fv/metdata.F90
  * changes for offline waccm driver
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice:
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
047 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
These are expected to fail due to changes in waccm chemistry and the offline driver.
	
bangkok/lf95:
all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_46
Originator(s): mvr,pworley,robj,eaton,mvertens
Date: Tue May  27 MDT 2008
One-line Summary: test scripts updated for new jaguar hardware and compilers;
updated to new clm,mct and scripts externals to address bugs; other bug fixes

Purpose of changes:
jaguar returned to production with new quad-core processors - the test 
scripts needed mods to work with the new hardware and pgi compilers (7.1-6)

a new mct tag was released that addressed several cam bugs - one with fv 
decomp and phys_loadbalance=0 on jaguar and the other with excessive writes 
from processors other than the master

a new clm tag addressed a bug in logic for do-albedo calculation

numerous ccsm tests were failing due to bugs in the scripts used by the coupled 
system, including a mismatch in the grids specified for the eul dycore

new default aquaplanet initial files added to help in running pergro tests
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
- mods to reflect dir name change from ~models/lnd/clm2 to ~models/lnd/clm
	
Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:
- added default initial files for running in aquaplanet mode

Describe any substantial timing or memory changes:

Code reviewed by: myself, eaton

List all subroutines eliminated:
D      models/atm/cam/bld/run-sgi.csh
- run template script for obsolete machine 'tempest' removed
	
List all subroutines added and what they do:
none
	
List all existing files that have been modified, and describe the changes:
M      models/ocn/dom/ocn_comp.F90
M      models/ocn/som/ocn_comp.F90
M      models/ice/csim4/ice_comp.F90
M      models/atm/cam/src/control/ncdio_atm.F90
- mods needed for fix to bug in fv decomp with phys_loadbalance=0 on jaguar

M      models/atm/cam/test/system/test_driver.sh
- top level test script enabled for jaguar quad-core and 7.1-6 pgi compilers

M      models/atm/cam/bld/configure
- mods to reflect dir name change from ~models/lnd/clm2 to ~models/lnd/clm

M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-lightning.csh
- run template scripts now default to validating archives to mss with file 
  comparison

M      models/atm/cam/bld/camsom.cpl7.template
M      models/atm/cam/bld/camcsim.cpl7.template
M      models/atm/cam/bld/cam.cpl7.template
M      models/atm/cam/bld/camdom.cpl7.template
- fixes for bugs when running as part of ccsm - including grid name mismatch 
  for eul dycore, initial file usage for start dates other than 1/1 and 9/1, and
  other cleanup
	
M      models/atm/cam/bld/build-namelist
- only check that user has specified start_ymd when ncdata has been
  specified when building namelists for standalone cam scripts.
	
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
- added default initial files for running in aquaplanet mode
	
 M     .
M      SVN_EXTERNAL_DIRECTORIES
- new external code for clm,mct, and scripts
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice:
all pass
	
bangkok/lf95:
004 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 7
008 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
012 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7
- sld baseline tests fail due to a doalb bug fix introduced in clm3_6_03
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): bit-for-bit

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_45
Originator(s): mvr,dennis,jedwards
Date: Thurs May  8 MDT 2008
One-line Summary: code work-arounds for bluevista compiler problems; 
new default initial conditions file for fv 0.47x0.63 and jan 1 start date

Purpose of changes:
we're still waiting for ibm to provide a fix for problems with the new 
xlf compiler (version 11.1)...in the meantime, jedwards has provided 
code work-arounds for two cam files to enable running with two of 
the configurations known to trigger problems...

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
	
Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets: 
added default initial conditions file at fv 0.47x0.63 w/ start date of jan 1

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/ocn/dom/ocn_comp.F90
M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
above files modified with code work-arounds for bluevista compiler problems
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
added default initial conditions file at fv 0.47x0.63 w/ start date of jan 1
M      models/atm/cam/bld/cam.cpl7.template
mod to make use of new default initial conditions file for fv 0.47x0.63, jan 1
M      models/atm/cam/test/system/test_driver.sh
minor fixes to top-level test script
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice: ALL PASS

bangkok/lf95: ALL PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_5_44
Originator(s): eaton
Date: Wed May  7 14:44:38 MDT 2008
One-line Summary: build-namelist mods

Purpose of changes:

. fix bug in waccm_1995_climo use case

. update the Build::NamelistDefinition module with methods for creating
  documentation from the definition xml file

. extend build-namelist to write the /modelio/ namelists used by components
  to redirect their log output to a named file.

Bugs fixed (include bugzilla ID):
. fixed bug in waccm_1995_climo use case

Describe any changes made to build system: none

Describe any changes made to the namelist:

. add namelist variables used by components to redirect their log output to
  named files.  The new variables are

  atm_logfile      - Name of file that the atmosphere component log messages will
                     be written to.  Default: none
  atm_logfile_diro - Absolute pathname of directory that the file specified
                     by atm_logfile will be written to.  Default: "./"
  cpl_logfile      - Name of file that the driver component log messages will
                     be written to.  Default: none
  cpl_logfile_diro - Absolute pathname of directory that the file specified
                     by cpl_logfile will be written to.  Default: "./"
  lnd_logfile      - Name of file that the land component log messages will
                     be written to.  Default: none
  lnd_logfile_diro - Absolute pathname of directory that the file specified
                     by lnd_logfile will be written to.  Default: "./"

  Having each component write to it's own named log file is the default
  when running with the ccsm4_alpha scripts.  These new variables allow the
  same flexibility when running with the standalone CAM scripts.  The
  default for the standalone CAM scripts remains that all components write
  their log messages to stdout.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. extend to write /modelio/ namelists to component specific files

models/atm/cam/bld/namelist_files/namelist_definition.xml
. add new namelist variables for named logfiles

models/atm/cam/bld/namelist_files/use_cases/waccm_1995_climo.xml
. fix broken root element (terminating tag missing leading slash)

models/atm/cam/bld/perl5lib/Build/Namelist.pm
. convert embedded newlines to spaces before _parse_next method is called
  by _split_namelist_value

models/atm/cam/bld/perl5lib/Build/NamelistDefaults.pm
. add check that the defaults xml file has a root element

models/atm/cam/bld/perl5lib/Build/NamelistDefinition.pm
. add methods for creating documentation from the definition xml file

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_5_43
Originator(s): mvertens,tcraig,mvr
Date: 080424
One-line Summary: update to externals list of ccsm4_0_alpha28; 
	removed all code related to permutation of grid points; 
	minor modifications to test scripts

Purpose of changes: permutation of grid points now handled within 
mct code, so update to latest mct tag allowed removal of this code

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: mvertens,tcraig

List all subroutines eliminated:
D      models/atm/cam/test/system/config_files/wg10dh
- configuration options file replaced with one for mpi-only
	
D      models/atm/cam/test/system/tests_pretag_bluevista
- pretag testing will now be required on blueice
	
List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/wg10dm
- new configuration options file for running test in mpi-only mode

A      models/atm/cam/test/system/tests_posttag_bluevista
- bluevista testing will now be done posttag
	
A      models/atm/cam/test/system/tests_pretag_blueice
- blueice will now be the required pretag platform for testing

List all existing files that have been modified, and describe the changes:
M      models/ocn/dom/ocn_comp_mct.F90
M      models/ocn/som/ocn_comp_mct.F90
M      models/ice/csim4/ice_comp_mct.F90
M      models/atm/cam/src/control/atm_comp_mct.F90
- removed code related to permutation of grid points
	
M      models/atm/cam/test/system/test_driver.sh
- testing on jaguar will now use charge account specific to user; other 
  minor fixes

M      models/atm/cam/test/system/TER.sh
- minor fix to restart test script when using fv 2d decomposition

M      models/atm/cam/test/system/input_tests_master
- mod needed to have test run in mpi-only mode on bangkok/calgary/lightning
	
M      models/atm/cam/doc/ChangeLog_template
- mod to reflect pretag testing now required on blueice rather than bluevista

 M     .
M      SVN_EXTERNAL_DIRECTORIES
- updated to externals of ccsm4_0_alpha28
	

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice:
ALL PASS
	
bangkok/lf95:
ALL PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change:  b4b

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_42
Originator(s): eaton, mvertens
Date: Thu, 17 Apr 2008 14:42:08
One-line Summary: misc mods for build, trop_mozart_prescribed_aero, cam-som

Purpose of changes:

. build-namelist mods:
  - when user specifies ncdata require that start_ymd also be specified
  - don't write dom namelist when ocn=none.  similarly for csim when
    ice=none. 

. configure mods:
  - don't put utils/timing in filepath for build using ccsm scripts (they
    build the timing lib separately)

. Modify behavior of "-chem trop_mozart_prescribed_aero".  This option has
  been changed to allow one to use the prescribed mozart ozone via the
  "prescribed_ozone_file" namelist option.  If "prescribed_ozone_file" is
  not set then the default cam ozone data is used for the radiation
  calculation, just as before.

. Modify DOM so that it writes TSOCN to CAM's initial file.  This is needed
  for CAM-SOM.

. Add ENDOFRUN option to the inithist namelist variable.  This allows an
  initial file to be written only at the end of the run.
  :N.B. this option won't be fully functional until mods are made to 
        CLM and to the driver code.

Bugs fixed (include bugzilla ID):
. bugID 739 - don't write dom and csim namelists unless needed

Describe any changes made to build system: none

Describe any changes made to the namelist: 
. add ENDOFRUN as possible value for inithist

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add check to require that the user specify start_ymd whenever ncdata has
  been specified. 
. don't write dom_inparm group to atm_in file if configuration ocn=none
. don't write csim_inparm group to atm_in file if configuration ice=none

models/atm/cam/bld/configure
. remove timing lib from filepath for ccsm build

models/atm/cam/bld/namelist_files/namelist_definition.xml
. make definition file consistent with new seq_timemgr_inparm and
  seq_infodata_inparm namelist groups.
. changes to quite a few "catagory" attributes for documentation purposes
. add ENDOFRUN as valid value of inithist

models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/chem_mods.F90
models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_sim_dat.F90
. allow use of CAM-Chem prescribed ozone in trop_mozart_prescribed_aero
  configuration.

models/atm/cam/src/control/cam_history.F90
models/atm/cam/src/control/runtime_opts.F90
. add ENDOFRUN option to inithist

models/ocn/dom/ocn_comp.F90
. write TSOCN to cam initial file.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice: All PASS except
015 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7

calgary/lf95:
004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 7
014 bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 7
023 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7

The failed tests are all baseline comparisons that fail due to the
appearance of a new field (TSOCN) in the initial file.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: none

===============================================================
===============================================================

Tag name: cam3_5_41
Originator(s): mvr,tcraig
Date: 080401

One-line Summary:
mods to test scripts in preparation of the decommission of machine 
tempest; enhanced post-tag testing on jaguar; fix to cleanup problems in 
cpl history file

Purpose of changes:
machine tempest is being decommissioned on 4/5. the default tests 
performed there as a requirement for committing to the cam developement 
trunk had to be farmed out to other platforms.  going forward, pretag 
testing will be required on just two platforms, bangkok/lahey and 
bluevista.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself,eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/config_files/fmgpa1.9h
D      models/atm/cam/test/system/config_files/fmgpa1.9m
- removed obsolete configure options files

D      models/atm/cam/test/system/tests_pretag_tempest
- machine tempest being decommissioned
	
D      models/atm/cam/test/system/tests_posttag_bluevista
- post-tag tests on bluevista folded into post-tag blueice suite
	
List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/e8dm
A      models/atm/cam/test/system/config_files/e8idm
A  +   models/atm/cam/test/system/config_files/fmgpa1.9dh
A  +   models/atm/cam/test/system/config_files/fmgpa1.9dm
- new configure options files required for test scripts
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/tests_pretag_bangkok
M      models/atm/cam/test/system/tests_pretag_bluevista
M      models/atm/cam/test/system/tests_posttag_blueice
M      models/atm/cam/test/system/tests_posttag_calgary
M      models/atm/cam/test/system/tests_posttag_lightning
- new default test lists reflecting tests inherited from tempest

M      models/atm/cam/test/system/tests_posttag_jaguar_cb
M      models/atm/cam/test/system/tests_posttag_jaguar
- enhanced list of tests for jaguar including performance testing, testing 
  of omp threading, pgi debug mode, and fv 2d decomposition
	
M      models/atm/cam/test/system/test_driver.sh
- removed references to machine tempest; minor fixes to jaguar directives

M      models/atm/cam/test/system/input_tests_master
- mods to master test list reflecting tweaks to tests farmed out of tempest

M      models/atm/cam/test/system/CAM_runcmnd.sh
- removed references to machine tempest; mod to jaguar run command enabling 
  ability to test in hybrid mode (spmd and smp)
	
M      models/atm/cam/doc/ChangeLog_template
- removed references to machine tempest

M      models/atm/cam/src/control/atm_comp_mct.F90
- minor fix from tonyc where uninitialized data was causing problems 
  in the cpl history file

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
bl382 TBL.sh fmgpa1.9dh outfrq3s+1870_control 9s ..............FAIL! rc= 5

bangkok/lf95:
bl114 TBL.sh e8dm co2rmp 9s ...................................FAIL! rc= 5
bl115 TBL.sh e8idm idphys 9s ..................................FAIL! rc= 5

- these baseline tests failed because their configurations were not 
  recognized by the scripts in the baseline code base
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:  cam3_5_40
Originator(s): Dani Coleman (bundy@ucar.edu)
Date: 28 Mar 2008
One-line Summary: Fix pdeldry bug and remove cnst_need_pdeldry option

Purpose of changes: 
The bug caused the EUL dycore to fail when run with phys_loadbalance=2 and
cnst_need_pdeldry. Now the model always saves pdeldry, regardless of the constituents.

Bugs fixed (include bugzilla ID): 388 (spmdbuf_siz needs to be increased in spectral Eulerian dycore)

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

Removed cnst_need_pdeldry logic in all modified subroutines (now model
runs as if cnst_need_pdeldry = .true. ) 
	
M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
M      models/atm/cam/src/physics/cam/phys_gmean.F90
M      models/atm/cam/src/physics/cam/constituents.F90
M      models/atm/cam/src/physics/cam/physics_types.F90
M      models/atm/cam/src/physics/cam/physpkg.F90
M      models/atm/cam/src/physics/cam/zm_conv_intr.F90
M      models/atm/cam/src/dynamics/eul/scanslt.F90
M      models/atm/cam/src/dynamics/eul/inidat.F90
M      models/atm/cam/src/dynamics/eul/prognostics.F90
M      models/atm/cam/src/dynamics/eul/scandyn.F90
M      models/atm/cam/src/dynamics/eul/scan2.F90
M      models/atm/cam/src/dynamics/eul/restart_dynamics.F90
M      models/atm/cam/src/dynamics/eul/tfilt_massfix.F90

Also changed buffer increment from 4 to 5.
M      models/atm/cam/src/dynamics/eul/dp_coupling.F90	line 146
M      models/atm/cam/src/dynamics/eul/spmd_dyn.F90     line 1065

Also calculate pdeldry in call to set_state_pdry. It either has to be
calculated here (like in the FV & SLD dycores) or passed back from the
dynamics (like in the EUL dycore) 
M      models/atm/cam/src/dynamics/homme/dp_coupling.F90
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all pass

tempest: all pass

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): n/a

If bitwise differences were observed, how did you show they were no worse
than roundoff? n/a

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,  
	n/a
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output: 

MSS location of control simulations used to validate new climate: n/a
URL for AMWG diagnostics output used to validate new climate: n/a


==============================================================

Tag name: cam3_5_39
Originator(s): mirin
Date: 3/21/08
One-line Summary: Advect tracers simultaneously and allow finer decomp. with FV

Purpose of changes: Several issues are addressed:

A. Ability to advect multiple tracers simultaneously with FV

Tracers may be divided into "trac_decomp" groups, with trac2d invoked
concurrently for the various groups. The additional groups are solved
using auxiliary computational processes. In particular, the kth group of
tracers is advected on the kth set of npes_yz processs. The relevant
namelist variable is trac_decomp, whose default is 1. The implementation
of this option is very similar to that of overlapping trac2d and
cd_core subcycles; however, these options are presently mutually exclusive.

B. Ability to use larger FV domain decomposition

The condition that a subdomain contain 3 vertical lines has been relaxed.
Subdomains need contain at least one vertical line.

C. Bug fix and minor modification to mod_comm

A bug was discovered that affects scenarios with more than 1024 processes
ONLY WHEN at least one of the modcomm_?? namelist variables equals 1.
This was remedied by changing some static arrays to allocatable.

Also, the quantity "alloc_slack_factor" was changed to 8, to accommodate
certain fine-domain-decomposition scenarios.

D. Allow new 64-bit netCDF format

This is necessary for some high-resolution scenarios. The relevant
namelist variable is use_64bit_nc, which defaults as .false.

E. Incorporate minor modification and bug fix from MVR

Bug fix involves use with PGI.

Bugs fixed (include bugzilla ID):

Mod_comm bug (see item C above) and Makefile.in bug (see item E above).

Describe any changes made to build system:

Describe any changes made to the namelist: Namelist variables trac_decomp and use_64bit_nc
added. See items A and D above.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Sawyer

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

models/atm/cam/dynamics/fv:

cd_core.F90 - post sends for simultaneous tracer advection; merge logic
   with that of overlapping cd_core and trac2d subcycles; calling
   arguments affected.

dyn_comp.F90 - insert main logic for simultaneous tracer advection; merge
   logic with that of overlapping cd_core and trac2d subcycles; these
   two options are mutually exclusive. 

dynamics_vars.F90 - initialize necessary quantities for simultaneous
   tracer advection.

spmd_dyn.F90 - add communicator logic for simultaneous tracer advection;
   relax requirement of 3 verticals per subdomain; fix a couple of minor
   allocation bugs with auxiliary processes.

trac2d.F90 - allow advection of a subset of tracers.

models/atm/cam/control:

cam_control_mod.F90 - add use_64bit_nc namelist variable for new 64-bit
   netCDF format.

cam_history.F90 - optionally invoke new 64-bit netCDF format when creating
   netCDF history file.

fv_control_mod.F90 - add trac_decomp namelist variable for concurrent
   tracer advection.

runtime_opts.F90 - add namelist variables use_64bit_nc and trac_decomp.

models/utils/pilgrim:

mod_comm.F90 - change InHandle and OutHandle from static to allocatable
   arrays; change alloc_slack_factor to 5; add comments.

models/atm/cam/bld:

Makefile.in - incorporate Mat's corrections for PGI.

cam.cpl7.template - allow one vertical per subdomain for FV

camsom.cpl7.template - incorporate Mat's corrections for ccsm4.

models/atm/cam/bld/namelist_files:

namelist_definition.xml - add use_64bit_namelist, trac_decomp, and
   ct_overlap (previously omitted).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:

tempest:

bangkok/lf95:

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff? Answers are BFB.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_38
Originator(s): mvr, mvertens
Date: 080314
One-line Summary: brought cam up to date with ccsm4_0_alpha25 driver 

Purpose of changes: To bring the ccsm4_0_alpha25 cam branch and other
	ccsm4_0_alpha25 externals (primarily the drvseq2_0_10 driver) onto
	the cam trunk. The cam "stand-alone" configuration (for both
	cam/dom and cam/som) will always be run with the new driver
	"ocean_tight_coupling" namelist option set to .true. The ocean
	tight coupling option treats ocean model like lnd/ice in
	coupling. When this is true, the updated state from the ocean is
	merged with the updated state from the land and ice to create the
	input atmospheric state. The updated state from the ocean is also
	used in the atm/ocn flux calculation. When this is not true
	(i.e. loose coupling) the previous state of the ocean is used
	along with the updated state from the land and ice to be merged
	into the input atmosphere. In addition, the previous state of the
	ocean is used in the atm/ocn flux calculation too. Loose coupling
	is the way pop2 is always coupled into the system and corresponds
	to the way a concurrent ocean would be run.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:  modified configure to 
	add new flexibility to bring in cice (which is
	not the default yet) and added COUP_DOM as a CPP variable.

Describe any changes made to the namelist: driver namelist modifications

List any changes to the defaults for the boundary datasets: the following
	sst datasets are now the defaults (since they have the correct
	time and calendar attributes to run with the cice in prescribed mode)
	
    <bndtvs hgrid="128x256"  >atm/cam/sst/sst_HadOIBl_bc_128x256_clim_c050526.nc</bndtvs>
    <bndtvs hgrid="64x128"   >atm/cam/sst/sst_HadOIBl_bc_64x128_clim_c050526.nc</bndtvs>
    <bndtvs hgrid="48x96"    >atm/cam/sst/sst_HadOIBl_bc_48x96_clim_c050526.nc</bndtvs>
    <bndtvs hgrid="8x16"     >atm/cam/sst/sst_HadOIBl_bc_8x16_clim_c050526.nc</bndtvs>
    <bndtvs hgrid="1.9x2.5"  >atm/cam/sst/sst_HadOIBl_bc_1.9x2.5_clim_c061031.nc</bndtvs>
    <bndtvs hgrid="4x5"      >atm/cam/sst/sst_HadOIBl_bc_4x5_clim_c061031.nc</bndtvs>
    <bndtvs hgrid="10x15"    >atm/cam/sst/sst_HadOIBl_bc_10x15_clim_c050526.nc</bndtvs>

Describe any substantial timing or memory changes:

Code reviewed by: mvertens

List all subroutines eliminated:
D      models/atm/cam/bld/run-pc-cice-docn7.csh
D      models/atm/cam/bld/run-ibm-cice-docn7.csh

List all subroutines added and what they do:
A  +   models/atm/cam/bld/cam.cpl7.template
A  +   models/atm/cam/bld/camdom.cpl7.template
A  +   models/atm/cam/bld/camsom.cpl7.template
A  +   models/atm/cam/bld/camcsim.cpl7.template
       - the above were modified to enable cam stand-alone configurations
	 to run out of the ccsm4_0_alpha25 (and later) scripts   

List all existing files that have been modified, and describe the changes:
M      models/ocn/dom/ocn_comp.F90
M      models/ocn/dom/ocn_comp_mct.F90
M      models/ocn/som/ocn_comp.F90
M      models/ocn/som/ocn_comp_mct.F90
       - interface changes needed to run with drvseq2_0_10

M      models/ice/csim4/ice_comp.F90
M      models/ice/csim4/ice_comp_mct.F90
       - interface changes needed to run with drvseq2_0_10
	
M      models/atm/cam/test/system/TCB.sh
M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TPF.sh
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/TER.sh
M      models/atm/cam/test/system/TSM.sh
       - changes needed to run with drvseq2_0_10 utilizing the 
	 ocean_tight_coupling driver namelist option (see above)	

M      models/atm/cam/bld/configure
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/config_definition.xml
       - added new flags for ocn and ice configurations
       - put in flexibility to run with cice in ccsm4_0_alpha25
       - modified driver namelist definition to be consistent with drvseq2_0_10
       - changed defaults sst datasets (see above)
       - set ocean_tight_coupling to .true. (see above)	  

M      models/atm/cam/src/control/runtime_opts.F90
       - removed shr_orb_mod from use
       - now broadcast obliqr,mvelpp,lambm0 instead of obliq,mvelp, iyear_ad 	
	
M      models/atm/cam/src/control/ccsm_msg.F90
       - removed psl as an allocatable array - now obtaining psl as in atm_comp_mct.F90
	 via cam_out%psl 
	
M      models/atm/cam/src/control/camsrfexch_types.F90
       - added psl to surface_state data type	 
	
M      models/atm/cam/src/control/cam_control_mod.F90
       - orbital variables modified to be consistent with drvseq2_0_10
	
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/cam_comp.F90
       - modifications made necessary for interacting with drvseq2_0_10
	
M      models/atm/cam/src/utils/time_manager.F90

M      models/atm/cam/src/physics/cam/tphysbc.F90
	- surface_state2d (or in ccsm_msg, cam_out%psl) is now filled in via the
	  call to diag_phys_writeout 
	
M      models/atm/cam/src/physics/cam/cam_diagnostics.F90
       - removed references to COUP_CSM - added psl as an optional argument to 
	 diag_phys_writeout instead of utilizing the COUP_CSM directive 
	
M      models/atm/cam/src/physics/cam/co2_cycle.F90
       - removed COUP_CSM if-def	
	
 M     .
M      SVN_EXTERNAL_DIRECTORIES
models/drv/seq_mct             https://svn-ccsm-models.cgd.ucar.edu/drv/seq_mct/trunk_tags/drvseq2_0_10
models/lnd/clm2/src            https://svn-ccsm-models.cgd.ucar.edu/clm2/branch_tags/ccsm4a_tags/ccsm4a03_clm3_5_18/src
models/ice/cice                https://svn-ccsm-models.cgd.ucar.edu/cice/trunk_tags/cice4_0_20080227
models/ocn/docn7               https://svn-ccsm-models.cgd.ucar.edu/docn7/branch_tags/drva_docn7_070824_tags/drva11_docn7_071129
models/csm_share               https://svn-ccsm-models.cgd.ucar.edu/csm_share/branch_tags/loga_share3_070903_tags/loga25_share3_071107
models/utils/esmf_wrf_timemgr  https://svn-ccsm-models.cgd.ucar.edu/esmf_wrf_timemgr/trunk_tags/esmf_wrf_timemgr_060616
models/utils/timing            https://svn-ccsm-models.cgd.ucar.edu/timing/trunk_tags/timing_070525
models/utils/mct               https://svn-ccsm-models.cgd.ucar.edu/mct/branch_tags/seqa_MCT2_3_0_070524_tags/seqa07_MCT2_4_2_071026
scripts                        https://svn-ccsm-models.cgd.ucar.edu/scripts/branch_tags/seqmct_scripts_070823_tags/seqmct44_scripts_080108

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice:
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
023 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
026 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
030 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
034 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
037 bl374 TBL.sh fm1.9dh outfrq3s 9s ..............................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
044 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
048 bl382 TBL.sh fmgpa1.9h outfrq3s+1870_control 9s ...............FAIL! rc= 7
052 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
059 bl551 TBL.sh s64h outfrq24h 2d ................................FAIL! rc= 7

tempest:
004 bl131 TBL.sh e32dh co2rmp 9s ..................................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h 2d ................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq3s 9s ...............................FAIL! rc= 7
021 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
035 bl531 TBL.sh s32dh co2rmp 9s ..................................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h 2d ................................FAIL! rc= 7

bangkok/lf95:
004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
016 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
029 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7
032 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
035 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
039 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 7
043 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
047 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: all
- what platforms/compilers: all
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): larger than roundoff but same climate

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):  ccsm4_0_alpha25
- platform/compilers: blueice
- configure commandline:
som:
create_newcase -mach blueice -compset F_CAMSOM_CSIM -res f19_f19 -case /ptmp/mvr/f40.021
dom:
create_newcase -mach blueice -compset F_CAMDOM_CSIM -res f19_f19 -case /ptmp/mvr/f40.017
	
- build-namelist command (or complete namelist):
see the entries for f40.017 and f40.021 in run database, http://ccsm-rundb.cgd.ucar.edu

	
- MSS location of output:
  som:  mss:/MVR/csm/f40.021
  dom:  mss:/MVR/csm/f40.017

- MSS location of control simulations used to validate new climate:
  som:  mss:/MVR/csm/seqnoflxave06_cam3_5_24_som4
  dom:  mss:/MVR/csm/seqnoflxave06_cam3_5_24
	
- URL for AMWG diagnostics output used to validate new climate:
  som:  mss:/MVR/csm/f40.021/f40.021-seqnoflxave06_cam3_5_24_som4.tar
        http://www.cgd.ucar.edu/cms/mvr/f40.021
  dom:  mss:/MVR/csm/f40.017/f40.017-seqnoflxave06_cam3_5_24.tar
        http://www.cgd.ucar.edu/cms/mvr/f40.017

	
===============================================================
===============================================================

Tag name: cam3_5_37
Originator(s): andrew, eaton
Date: Thu Mar 13 12:27:27 MDT 2008
One-line Summary: Mods and bug fixes in MG microphysics and CLDTOP/CLDBOT indexes. 

Purpose of changes:

. Mods and bug fixes for MG microphysics -- see details in changes to 
  prescribed_aerosols and cldwat2m modules below.

. Fix bug in UW shallow convection scheme that was setting cloud top and
  cloud bottom indexes incorrectly in cloud free columns.  The chemistry
  is the only parameterization affected by this bug.

. Change the default averaging flag for radiative forcing and aerosol
  indirect diagnostic output fields from 'I' to 'A'

Bugs fixed (include bugzilla ID): 

. bug in cldtop/cldbot indexes (bugz ID 716)
. bug fixes for MG microphysics

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not checked

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/physics/cam/prescribed_aerosols.F90
. modify dry_radaer for OCPHO,OCPHI,BCPHO,BCPHI,VOLC to 0.05e-6  (same as sulfate).
  [this changes answers slightly, and makes the microphysical distributions
   better in the model]

models/atm/cam/src/physics/cam/cldwat2m.F90
. several bug fixes for diagnostic CCN output only [does not change answers]
. fix prodprec (prain) variable [changes answers only with prognostic aerosols]
. additional mod: put prodsnow and evapsnow into prain, evaprain
  [changes answers only with prognostic aerosols: this fixes the
   wet-deposition]

models/atm/cam/src/physics/cam/mcshallow.F90
. In compute_mcshallow change the initializers for cnt_out to 1 and for
  cnb_out to pver.  Only do it in the last of the 4 places where the
  cnt_out/cnb_out values are set.  This appears to be the section of code
  that re-initializes values for columns with no convection.

models/atm/cam/src/physics/cam/radiation.F90
. change default averaging of radiative forcing diagnostics from 'I' to 'A'
. change default averaging of aerosol indirect forcing diagnostics from 'I' to 'A'

models/atm/cam/src/physics/waccm/gw_drag.F90
models/atm/cam/src/physics/waccm/mo_msis_ubc.F90
. get pi from CAM's physconst module rather than from shr_const_mod.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice: All PASS

tempest: All PASS

calgary/lf95: All PASS except

029 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7

bl315 is expected to fail due to changes to MG microphysics.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_34

Summarize any changes to answers: BFB except when MG microphysics is on
  due to bug fixes in that code.

  Andrew has verified this code is reasonable both with our microphysical
  diagnostics and with the standard diagnostics.

  Diagnostics at:
  http://www.cgd.ucar.edu/cms/andrew/diag/nmicro2.65_cam3_5_36-obs/

  Diagnostics for a pair of 2 year runs with the
  fixed version (nmicro2.68) and the current version on the trunk
  (cam3_5_36_MG) are at:

  http://www.cgd.ucar.edu/cms/andrew/diag/cam3_5_36_MG-nmicro2.68_cam3_5_36

  Note that both of these are with the Morrison-Gettelman microphysics.


===============================================================
===============================================================

Tag name: cam3_5_36
Originator(s): eaton
Date: Mon Mar  3 10:11:54 MST 2008
One-line Summary: bug fixes for build-namelist

Purpose of changes:

. Bug fixes for build-namelist -- see below.

. Reimplement the -test option to build-namelist.  This checks whether the
  input datasets exist on the local disk.  It's also an easy way to
  generate a list of the input datasets required for the run.

. Allow the phys_debug_util module to read its own namelist.  The
  implementation is meant to serve as an example for other modules for
  which it's appropriate to read namelist input.  The general design that
  we've been moving towards is for modules to read their own namelist
  rather than have all namelist variables live in one big namelist.  The
  new build-namelist utility makes it easy to define a new namelist group
  and have that namelist group be written to the atm_in file simply by
  adding an appropriate definition of the variables in the
  namelist_definition.xml file.  

Bugs fixed (include bugzilla ID):

. build-namelist wasn't validating namelist array variables that were specified
  in the input as array elements.

. build-namelist was not recognizing values in the -namelist argument when
  the string contained embedded newlines.  This happens when using the C
  shell and splitting the -namelist arg into multiple lines.

. build-namelist wasn't checking the date attributes in the default values
  for finidat.

Describe any changes made to build system: none

Describe any changes made to the namelist:

. phys_debug_lat and phys_debug_lon have moved to the new namelist group
  phys_debug_nl.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. modify so that when a new namelist group is defined for the CAM
  component that group will automatically be written to CAM's namelist
  file. 
. fix setting the default value of finidat to recognize the date
  attribute. 
models/atm/cam/bld/namelist_files/namelist_definition.xml
. move phys_debug_lat and phys_debug_lon into namelist group phys_debug_nl
models/atm/cam/bld/perl5lib/Build/NamelistDefinition.pm
. modify the _validate_pair method so that an index specifier is stripped
  off of the variable name before checking whether it's in the definition
  file.
models/atm/cam/bld/perl5lib/Build/Namelist.pm
. allow strings used to initialize Namelist objects to contain embedded
  newlines.

models/atm/cam/src/physics/cam/phys_debug_util.F90
. add subroutine phys_debug_readnl to read the namelist.
models/atm/cam/src/control/runtime_opts.F90
. remove phys_debug_lat, phys_debug_lon from cam_inparm
. add call to phys_debug_readnl

models/atm/cam/src/physics/cam/convect_shallow.F90
. add CLDTOP and CLDBOT to master field list for debugging.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice: All PASS.

tempest: All PASS.

calgary/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_34

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_5_35
Originator(s): sungsu, pjr, pworley, mvr, eaton
Date: Fri Feb 15 17:15:40 MST 2008
One-line Summary: Mods to PBL code; add physics debug utility; fix archiving script

Purpose of changes:

. Modifications to UW PBL scheme. (sungsu)

. Add HBR option to eddy_scheme. (pjr)

. Add flux_avg module which contains code to smooth the surface fluxes
  to reduce instabilities in the surface layer.  (pjr)

. Add physics debugging utility code that allows easy location of the
  closest column in the physics grid to a specified location. (pjr, pworley)

. Some debugging code to help analyze how PBL schemes are behaving near the
  surface has been left on the trunk until the CAM4 PBL scheme has been
  verified.  The debugging code will be removed once the verification has
  taken place.  (pjr, eaton)

. Update external for scripts directory.  *** N.B. *** This fixes a bug in
  the archiving scripts introduced at cam3_5_31. (mvr)

Bugs fixed (include bugzilla ID): Fix archiving script bug.

Describe any changes made to build system: none

Describe any changes made to the namelist: added variables

. logical rhminl_31 - to allow use of special value of rhminl in 31 layer model
                      (default: .false.)
. logical freeze_dry - to allow use of Vavrus "freeze dry" mod (default: .true.)
. integer srf_flux_avg - on=1/off=0 switch for code to adjust surface fluxes to
                         stabilize near surface layers (default: 0 if
                         eddy_scheme='HB', 1 otherwise )
. real(r8) phys_debug_lat - requested latitude for debugging physics (degrees)
. real(r8) phys_debug_lon - requested longitude for debugging physics (degrees)

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not tested

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/flux_avg.F90
. surface flux adjustments
models/atm/cam/src/physics/cam/phys_debug_util.F90
. physics debugging utility
models/atm/cam/src/physics/cam/phys_debug.F90
. user code for specific debugging output

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/namelist_files/namelist_definition.xml
models/atm/cam/src/control/runtime_opts.F90
. add new namelist variables freeze_dry, rhminl_31, do_flux_averaging,
  phys_debug_lat, phys_debug_lon
models/atm/cam/src/physics/cam/cam_diagnostics.F90
. don't make outfld call for PSDRY if atm is dry
models/atm/cam/src/physics/cam/check_energy.F90
. add message to log about status of printing conservation errors
models/atm/cam/src/physics/cam/cloud_fraction.F90
. add namelist variables
  - rhminl_31 to allow use of special value of rhminl in 31 layer model
    (default is .false.)
  - freeze_dry to allow use of Vavrus "freeze dry" mod (default is .true.)
. change rhminh from .9 to .85 for UW shallow scheme without MG
  microphysics, but leave it at .9 when UW is run w/ MG.
models/atm/cam/src/physics/cam/eddy_diff.F90
. change default averaging of diagnostic output from instantaneous to
  averaged
. mods from sungsu
models/atm/cam/src/physics/cam/hb_diff.F90
. mods for HBR option
. add temporary debug code
models/atm/cam/src/physics/cam/initindx.F90
. add register routine for flux averaging
models/atm/cam/src/physics/cam/mcshallow.F90
. change default averaging of diagnostic output from instantaneous to
  averaged
. set rdrag=1.0 (was 2.0)
. modify evprain expression
. change some hardcoded constants in qvten expression
models/atm/cam/src/physics/cam/phys_control.F90
. add check for eddy_scheme='HBR'
. add namelist variable srf_flux_avg to control whether the flux averaging
  code is turned on.
models/atm/cam/src/physics/cam/phys_grid.F90
. add subroutine phys_grid_find_col
models/atm/cam/src/physics/cam/physconst.F90
. add pi
models/atm/cam/src/physics/cam/physics_types.F90
. add temporary debug code
models/atm/cam/src/physics/cam/physpkg.F90
. add init call for physics_debug
. move tracer_init call to before exit for adiabatic/ideal physics
models/atm/cam/src/physics/cam/qneg4.F90
. modify warning message
models/atm/cam/src/physics/cam/rayleigh_friction.F90
. fix initialization of ptend
models/atm/cam/src/physics/cam/tphysac.F90
. add optional call for surface flux averaging
models/atm/cam/src/physics/cam/tphysbc.F90
. add temporary debug code
models/atm/cam/src/physics/cam/vertical_diffusion.F90
. mods to UW code by Sungsu
. add HBR option to eddy_scheme
. add eddy_scheme as actual arg to init_hb_diff
. change default averaging from I to A for UW PBL diagnostic fields
. add temporary debug code
models/atm/cam/src/physics/cam/zm_conv_intr.F90
. move assignment of nstep to top of zm_conv_tend

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: (used blueice due to XLF11 problem on bluevista): All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB.

===============================================================
===============================================================

Tag name: cam3_5_34
Originator(s): mvertens
Date: Tue Feb  5 23:19:00 MST 2008
One-line Summary: minor bug fixes for cpl6 mode compatibilty

Purpose of changes: fix a compiler problem on jaguar and put fix back
   in (that was taken out of cam3_5_33) for coupling every time step

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: mvertens

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      src/control/runtime_opts.F90
       - finished cleaning up uses of eshr_timemgr_mod and shr_inputinfo_mod
         that are no longer needed
M      src/control/ccsm_msg.F90
       - a fix was needed in ccsm_msg.F90 to match a corresponding correction 
         in the flux coupler to correctly specify the albedo shift and enable 
         communication every cam timestep - this fix was inadvertently taken
         out of cam3_5_33 - and has been put back in
M      src/control/cam_control_mod.F90
       - removed reference to flxave which was causing a compiler problem on 
         jaguar

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: 
all pass

tempest: 
all pass

bangkok/lf95:
all pass 

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_32

Summarize any changes to answers: none, answers are bfb

===============================================================
===============================================================

Tag name: cam3_5_33
Originator(s): mvertens
Date: Tue Feb  5 08:39:49 MST 2008
One-line Summary: migrated all cpl7 framework references to xxx_comp_mct.F90

Purpose of changes: enable cam-cpl6 to run without reference to any cpl7
   data structures and move move all cpl7 framework references to xxx_comp_mct.F90
   (e.g. remove all references from cam_comp.F90, etc).

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: new namelist, camcpl6_inparm, was introduced
   that is independent of any cpl7 utilities.

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: mvertens

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

   All framework specific data structures were moved into xxx_comp_mct.F90
   routies.

M      models/ocn/dom/ocn_comp.F90
M      models/ocn/dom/ocn_comp_mct.F90
M      models/ocn/som/ocn_comp.F90
M      models/ocn/som/ocn_comp_mct.F90
       - moved calls to routimemgr_init into ocn_comp_mct from ocn_comp.F90

M      models/atm/cam/src/control/runtime_opts.F90
       - removed all references to shr_input_info or eshr_timemgr module routines
         and variables. Obtaining data from sync clock, setting nsrest and getting 
         data from ccsminit object have been moved to atm_comp_mct.F90.
       - removed routine runtime_options, now call read_namelist directly in
         both cpl6 and cpl7 cam interfaces (call preset directly from read_namelist)
       - removed flxave from cam_inparm and placed it in camcpl6_inparm
       - removed broadcast for single column variables 

M      models/atm/cam/src/control/ccsm_msg.F90
M      models/atm/cam/src/control/con_cam.F90
       - eliminated shr_input_info and eshr_timemgr references 
       - explicit use now made of camcpl6_inparm namelist input

M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/cam_comp.F90

M      models/atm/cam/bld/cam.cpl6.template
       - modifications to get branch and hybrid tests working
M      models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
       - removed reference to flxave
M      models/atm/cam/bld/namelist_files/namelist_definition.xml
       - removed reference to flxave
M      models/atm/cam/bld/build-namelist
       - removed reference to flxave

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
all pass
	
tempest:
all pass
	
bangkok/lf95:
all pass
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: none, answers are bfb

===============================================================
===============================================================

Tag name: cam3_5_32
Originator(s): mvr,mvertens
Date: 080131
One-line Summary: mods to enable cam to work with cpl7

Purpose of changes: 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist: 
namelist 'timemgr_inparm' changed name to 'camcpl6_inparm'

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: mvertens,eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/bld/cam.cpl6.template
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/src/control/runtime_opts.F90
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: not tested

tempest: not tested

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_31
Originator(s): mvr
Date: 080130
One-line Summary: enable test_driver for jaguar (cray xt); now pulling in 
entire ccsm scripts directory as external; mod to allow communication with 
flux coupler every cam timestep
	
Purpose of changes:
there was a need to perform regular cam testing on jaguar as reliance
on this machine for production use increases 

a bug fix was added to the archiving scripts, so the external for 
its scripts tag needed updating...we eventually will need the ccsm 
scripts available as the two systems merge, so we decided to pull 
in the entire ccsm scripts directory as the external

a fix was needed in ccsm_msg.F90 to match a corresponding correction 
in the flux coupler to correctly specify the albedo shift and enable 
communication every cam timestep

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
pgi compiler flags now include -Kieee; non-debug pgi compiler settings 
now use '-fast -mvect=nosse' instead of -O1 

Describe any changes made to the namelist: 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: mvr,eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/config_files/fm2dh
- config options file with fv 2x2.5 replaced with one at fv 1.9x2.5

List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/wm1.9m
A      models/atm/cam/test/system/config_files/e64sm
A      models/atm/cam/test/system/config_files/fm1.9dh
A      models/atm/cam/test/system/config_files/fm1.9m
A      models/atm/cam/test/system/config_files/fma1.9m
A      models/atm/cam/test/system/config_files/e64pm
A      models/atm/cam/test/system/config_files/fmgpa1.9m
A      models/atm/cam/test/system/config_files/e64am
- new config options files required for testing on jaguar 

A      models/atm/cam/test/system/tests_posttag_jaguar
- new file containing the default set of tests for jaguar
A      models/atm/cam/test/system/tests_posttag_jaguar_cb
- set of tests for jaguar containing just the configure/build's 

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/test_driver.sh
- added functionality for testing on jaguar (cray xt)

M      models/atm/cam/test/system/tests_pretag_bluevista
M      models/atm/cam/test/system/tests_posttag_blueice
- modified default test lists for testing on ibm's to reflect testing 
  fv 1.9x2.5 rather that fv 2x2.5

M      models/atm/cam/test/system/input_tests_master
- master list of tests now include those added for jaguar 
	
M      models/atm/cam/test/system/CAM_runcmnd.sh
- code added to properly build the run command on jaguar 
	
M      models/atm/cam/bld/Makefile.in
- new default compiler settings for pgi
	
M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/bld/run-pc-cice-docn7.csh
M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-sgi.csh
M      models/atm/cam/bld/run-lightning.csh
- run template scripts modified to reflect new location of archive scripts

M      models/atm/cam/src/control/ccsm_msg.F90
- fix to specify albedo shift correctly and enable communication with coupler 
  every cam timestep
	
 M     .
M      SVN_EXTERNAL_DIRECTORIES
- now pulling in entire ccsm scripts directory as external


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
all pass
	
tempest:
all pass
	
bangkok/lf95:
all pass

calgary/pgf:
004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
016 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
029 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7
032 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
035 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
039 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 7
043 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
045 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
047 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

all baselines fail due to changes to pgf compiler flags

NOTE: tests of this cam tag within ccsm4 show that future mods will be required 
including a minor fix to the new build-namelist and fixes to cam.cpl6.template 

		
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: all
- what platforms/compilers: pgf compilers only
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff? pergro tests passed on calgary/pgf and jaguarcnl/pgf 

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_30
Originator(s): eaton
Date: Thu Jan 24 09:32:04 MST 2008
One-line Summary: new version of build-namelist

Purpose of changes:

. A new version of build-namelist has been implemented with new features
  which will make namelist generation more robust, as well as being easier
  to extend and maintain.

  From the user perspective the biggest differences with the old version
  are: 

  - All valid namelist variables are known to build-namelist.  So an
    incorrectly specified variable from the user (supplied either by the
    -infile or -namelist options) will cause build-namelist to fail with an
    error message telling which namelist variable is invalid.  This is a
    big improvement over a runtime failure caused by an invalid variable
    which typically gives no hint as to which variable caused the problem.

  - In addition to knowing all valid variable names and their types,
    build-namelist also knows which namelist group each variable belongs
    to.  This means that the user only needs to specify variable names to
    build-namelist and not the group names.  The -infile and -namelist
    options still require valid namelist syntax as input.  But the group
    name(s) is ignored.  So all variables can be put in a single group with
    an arbitrary name, for example, "&in ... /".

  From the developer perspective the main differences are:

  - New namelist variables added to existing namelist groups require adding
    an entry to the definition file (namelist_definition.xml).  If the new
    variable has default values these are provided by modifying the
    build-namelist script and possibly the defaults file
    (namelist_defaults_cam.xml).

  - Implementing a new namelist group no longer requires writing a new perl
    module.  The variables are added following the same procedure used to
    add a variable to an existing namelist group.

  The commandline interface to build-namelist has not been changed except
  to remove the -cam_cfg option.  This was used to specify the directory
  containing the CAM configuration files.  It's not needed because we
  assume the files are located in directories relative to the one that
  contains the build-namelist script being executed (which is known by
  looking at $0).

  The -test option has not yet been implemented.

  The -v (verbose) option no longer accepts a value.  It's an on switch.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: nrevsn

nrevsn has been given component specific names.  It's functionality is
unchanged.  The new names for each component are:

&cam_inparm nrevsn  --> cam_branch_file
&csim_inparm nrevsn --> csim_branch_file
&dom_inparm nrevsn  --> dom_branch_file
&som_inparm nrevsn  --> dom_branch_file


List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:
models/atm/cam/bld/CAM_config.pm
models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
models/atm/cam/bld/DefaultCCSM_INPARM_Namelist.xml
models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
models/atm/cam/bld/DefaultCSIM_INPARM_Namelist.xml
models/atm/cam/bld/DefaultCTL_NL_Namelist.xml
models/atm/cam/bld/DefaultDOM_INPARM_Namelist.xml
models/atm/cam/bld/DefaultFILTER_NL_Namelist.xml
models/atm/cam/bld/DefaultSOM_INPARM_Namelist.xml
models/atm/cam/bld/DefaultTIMEMGR_INPARM_Namelist.xml
models/atm/cam/bld/NamelistsDescriptions.xml
models/atm/cam/bld/SeqCCSM_namelist.pm
models/atm/cam/bld/cam_inparm.pm
models/atm/cam/bld/camexp.pm
models/atm/cam/bld/ccsm_inparm.pm
models/atm/cam/bld/clm_inparm.pm
models/atm/cam/bld/clmexp.pm
models/atm/cam/bld/compnl.pm
models/atm/cam/bld/csim_inparm.pm
models/atm/cam/bld/ctl_nl.pm
models/atm/cam/bld/dom_inparm.pm
models/atm/cam/bld/filter_nl.pm
models/atm/cam/bld/namelist.pm
models/atm/cam/bld/nl_descrips.pm
models/atm/cam/bld/prof_inparm.pm
models/atm/cam/bld/som_inparm.pm
models/atm/cam/bld/timemgr_inparm.pm
models/atm/cam/bld/use_cases/1870-2000_control.nl
models/atm/cam/bld/use_cases/1870_control.nl
models/atm/cam/bld/use_cases/1870_prog_aero.nl
models/atm/cam/bld/use_cases/1990_control.nl
models/atm/cam/bld/use_cases/waccm_1995_climo.nl

List all subroutines added and what they do:
models/atm/cam/bld/namelist_files/namelist_defaults_cam.xml
models/atm/cam/bld/namelist_files/namelist_definition.xml
models/atm/cam/bld/namelist_files/use_cases/1870-2000_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_control.xml
models/atm/cam/bld/namelist_files/use_cases/1870_prog_aero.xml
models/atm/cam/bld/namelist_files/use_cases/1990_control.xml
models/atm/cam/bld/namelist_files/use_cases/waccm_1995_climo.xml
models/atm/cam/bld/perl5lib/Build/Namelist.pm
models/atm/cam/bld/perl5lib/Build/NamelistDefaults.pm
models/atm/cam/bld/perl5lib/Build/NamelistDefinition.pm
. files to implement new build-namelist

List all existing files that have been modified, and describe the changes:
models/atm/cam/bld/build-namelist
models/atm/cam/bld/cam.cpl6.template
models/atm/cam/src/control/cam_restart.F90
models/atm/cam/src/control/runtime_opts.F90
. replace namelist variable nrevsn by cam_branch_file
models/atm/cam/test/system/TBR.sh
. change nrevsn to the component appropriate name.
models/atm/cam/test/system/TSM.sh
. remove -cam_cfg option from build-namelist command.
models/ice/csim4/ice_comp.F90
. replace namelist variable nrevsn by csim_branch_file
models/ocn/dom/ocn_comp.F90
. replace namelist variable nrevsn by dom_branch_file
models/ocn/som/ocn_comp.F90
. replace namelist variable nrevsn by som_branch_file

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS.

tempest: All PASS.

bangkok/lf95:  All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE

===============================================================
===============================================================

Tag name: cam3_5_29
Originator(s): andrew, edwards, worley, eaton
Date: Wed Jan  9 11:21:24 MST 2008
One-line Summary: bug fixes for MG microphysics, aerosol optics, & misc

| 24 Jan 2008, eaton, update ChangeLog for cam3_5_29 
|
| Andrew Conley let me know that the indexing bug in aer_optics.F90
| shouldn't affect the default physics because in the original prescribed
| aerosols the longwave effect of seasalt and dust was zero.  I verified
| this.  The ChangeLog documention has been updated accordingly.

Purpose of changes:

. Bug fixes and diagnostics changes for MG microphysics.  Also changed some
  diagnostics from RK microphysics.  Only affects simulations with MG
  microphysics turned on.

. Fix indexing bug in aer_optics.F90 which affects simulations where the
  new seasalt and dust aerosols are radiatively active.

. Add fix or workaround (not sure which) for a problem with the pgi
  compiler on jaguarcnl.  Compiler is failing on a declaration of a zero
  size array which uses a scalar initializer.

. Change entropy function (in zm_conv.F90) to return a real(r8) result.  It
  was returning a single precision result.  This results in a larger than
  roundoff difference in the simulations with default physics.

  Also replace the stop with an endrun call in the convergence checking
  loop of subroutine ientropy (in zm_conv.F90).


Bugs fixed (include bugzilla ID):

. bugz #683 - fix for single column output (was broken when making memory
              use improvements in cam3_5_26).

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/chemistry/trop_mozart/mo_extfrc.F90
. initialize arrays has_extfrc and spc_fnames, which can potentially be of
  size zero, in the extfrc_inti method rather than with initializers
models/atm/cam/src/control/cam_history.F90
. fix for single column output
models/atm/cam/src/physics/cam/aer_optics.F90
. fix indexing bug affecting new seasalt and dust optics
models/atm/cam/src/physics/cam/cldwat2m.F90
. Snow bug fixed (morrison email 27 Nov 2007) Line 1523 changed.  Top level
  autoconversion bug fixed (line 1515-1516) Rain diagnostic output changed
  to gridbox average (the first 2 change answers for MG microphysics only,
  the third is diagnostic)
models/atm/cam/src/physics/cam/stratiform.F90
. cloud fraction diagnostic calculations AFTER second cloud fraction call
  to make in-cloud values consistent with outputed cloud fraction.  changed
  for MG and RK microphysics.  This affects diagnostic in-cloud values in
  RK and MG microphysics (icimr, icwmr in RK) Also: cleaned up in-cloud
  diagnostics which were using ptend_loc after it was set to zero.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
017 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
023 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
026 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 4
030 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
034 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
037 bl354 TBL.sh fm2dh outfrq3s 9s ................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
044 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 7
048 bl382 TBL.sh fmgpa1.9h outfrq3s+1870_control 9s ...............FAIL! rc= 7
052 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
054 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 7
059 bl551 TBL.sh s64h outfrq24h 2d ................................FAIL! rc= 7

tempest: All PASS except:
004 bl131 TBL.sh e32dh co2rmp 9s ..................................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h 2d ................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq3s 9s ...............................FAIL! rc= 7
021 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
035 bl531 TBL.sh s32dh co2rmp 9s ..................................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h 2d ................................FAIL! rc= 7

bangkok/lf95: All PASS except:
004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
016 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
029 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7
032 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
035 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
039 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 7
043 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
045 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
047 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

** All baseline comparisons fail except for configurations using adiabatic or
   ideal physics.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers:

. There are larger than roundoff changes in the default physics
  configurations due to changing the entropy function from single to double
  precision.

. There are larger than roundoff changes to runs in which the new dust and
  seasalt aerosols are radiatively active.

. There are additional larger than roundoff changes in the MG microphysics
  due to bug fixes.

===============================================================
===============================================================

Tag name: cam3_5_28
Originator(s): eaton
Date: Fri Jan  4 16:34:15 MST 2008
One-line Summary: refactor the adiabatic and ideal physics options

Purpose of changes:

. The ideal physics mode was broken when using the FV dycore.  The
  process of fixing that configuration inspired a refactoring of the
  implementation of both adiabatic and ideal physics modes for all
  dycores.  The main features of the refactoring are:
  - The dry atmosphere is implemented by setting the specific humidity to
    zero rather than by setting physical constants for water vapor to
    those for dry air.  The Q field is no longer required on the initial
    file for these modes.
  - The condensed water species are no longer allocated and transported
    around as inert species.
  - The FV dycore is not called in a special mode but is called the same
    way as when full physics forcings are applied.
  - The adiabatic and ideal physics forcings are returned as tendencies and
    applied to the state in the identical way that full physics forcings
    are applied.
  - The energy conservation for the FV dycore which is done in the physics
    part of the code is now done in adiabatic and ideal modes identically
    to how it's done in full physics mode.
  - Eliminate write/read of fields from restart files that aren't used in
    ideal/adiabatic modes.

Bugs fixed (include bugzilla ID):
#677 - don't turn on co2 cycle code for CCSM_BGC==CO2A

Describe any changes made to build system:

. add "ideal" and "adiabatic" as valid values of configure's -phys option.
  The reason for making adiabatic and ideal physics build time options is
  that the condensed water species need not be allocated and transported
  for these dry atmosphere configurations.  For either of these physics
  options only one advected specie is allocated (by default).

Describe any changes made to the namelist:

. No namelist variables changed.  But since the adiabatic and ideal physics
  modes are specified to configure, build-namelist knows about these modes
  and can automatically add the appropriate namelist variable, i.e., either
  setting atm_ideal_phys=.true. or atm_adiabatic=.true..  So the use does
  not need to worry about setting a namelist variable for adiabatic or
  ideal physics modes.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: didn't check

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/test/system/config_files/e32adh
models/atm/cam/test/system/config_files/e32idh
models/atm/cam/test/system/config_files/f4adh
models/atm/cam/test/system/config_files/f4idh
models/atm/cam/test/system/config_files/h5x8adm
models/atm/cam/test/system/config_files/h5x8idm
models/atm/cam/test/system/config_files/s32adh
models/atm/cam/test/system/config_files/s32idh
. new config files which use the -phys arg to configure to build CAM
  for an adiabatic or ideal physics run.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
. remove unneeded PHYSICS attribute from ncdata entries so that the initial
  files can be used for ideal/adiabatic physics modes

models/atm/cam/bld/DefaultTIMEMGR_INPARM_Namelist.xml
. remove unneeded PHYSICS attributes.

models/atm/cam/bld/cam.cpl6.template
. don't set -co2_cycle flag to configure, and don't set namelist variable
  co2_flag=.true. when CCSM_BGC==CO2A

models/atm/cam/bld/ccsm_inparm.pm
. use config_cache.xml to set atm_adiabatic/atm_ideal_phys namelist vars.

models/atm/cam/bld/config_definition.xml
. add ideal and adiabatic as valid_values for phys.

models/atm/cam/bld/configure
. add ideal and adiabatic as valid options for the -phys arg.  These
  options decrement the number of advected species by 2 (cldliq and
  cldice).

models/atm/cam/src/control/cam_comp.F90
. remove actual arg etamid from call to phys_run1

models/atm/cam/src/control/cam_control_mod.F90
. add moist_physics

models/atm/cam/src/control/cam_history.F90
. comment out the 'outfld' event timer

models/atm/cam/src/control/hycoef.F90
. add etamid

models/atm/cam/src/control/runtime_opts.F90
. set moist_physics

models/atm/cam/src/control/startup_initialconds.F90
. allow setting bnd_topo=' ' to override default set in build-namelist

models/atm/cam/src/dynamics/eul/inidat.F90
. initialize q=0 in adiabatic or ideal physics modes

models/atm/cam/src/dynamics/fv/dp_coupling.F90
. remove full_phys dummy arg from d_p_coupling and p_d_coupling
. remove full_phys conditionals -- keep only the full_phys=.true. branches
. remove full_phys actual arg from call to p_d_adjust
. remove dummy arg adiabatic from d_p_coupling
. change timer event tag from 'DP_CPLN: ctem' to DP_CPLN_ctem

models/atm/cam/src/dynamics/fv/dyn_comp.F90
. make convt a module parameter set to .true., so the FV core is always
  called in its "full physics" mode.
. remove convt as a dummy arg from dyn_run
. remove addfld calls for constituent tendencies that don't have
  corresponding outfld calls.

models/atm/cam/src/dynamics/fv/inidat.F90
. initialize q=0 in adiabatic or ideal physics modes

models/atm/cam/src/dynamics/fv/p_d_adjust.F90
. remove full_phys dummy arg
. remove full_phys conditionals -- assume full_phys=.true.

models/atm/cam/src/dynamics/fv/stepon.F90
. remove full_phys logical.  
. don't set zvir=0 for adiabatic/ideal physics.  Set q=0 instead.
. use new moist_physics variable to control call to dryairm
  (moist_physics = .not. adiabatic .and. .not. ideal_physics) 
. remove full_phys as actual arg in calls to dyn_run, d_p_coupling,
  p_d_coupling
. moist_phys is only used in call to fv_out to control whether or not
  precip stats are output.
. remove adiabatic as actual arg in call to p_d_coupling

models/atm/cam/src/dynamics/sld/inidat.F90
. initialize q=0 in adiabatic or ideal physics modes

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. add outfld call for QRS to diag_init for ideal_phys run
. exit diag_init after basic state variables are added to history in case
  of adiabatic or ideal physics run
. don't output RELHUM for dry atm

models/atm/cam/src/physics/cam/check_energy.F90
. modify so that cloud liq/ice don't need to be present.

models/atm/cam/src/physics/cam/constituents.F90
. add init of names for constituent diagnostics to cnst_chk_dim

models/atm/cam/src/physics/cam/initindx.F90
. if ideal/adiabatic phys then don't call the physics register routines
. move the init of constituent diagnostic names to cnst_chk_dim
. replace cph2o by cpwv
. move setting sflxnam, apcnst, hadvnam, vadvnam, fixcnam, tendnam,
  ptendnam, dmetendname, tottnam to cnst_chk_dim subroutine in constituents
  module. 

models/atm/cam/src/physics/cam/physconst.F90
. set rh2o, cpvir, cpwv, zvir as parameters.
. remove rwat (duplicate of rh2o), and cph2o (duplicate of cpwv).

models/atm/cam/src/physics/cam/physics_types.F90
. add conditionals so special tests for cloud liq/ice aren't done when atm
  is dry.
. remove unused "use" statements in physics_tend_init

models/atm/cam/src/physics/cam/physpkg.F90
. phys_init
  - remove setting special values of physical constants for adiabatic/ideal
    physics modes
  - return early when ideal_phys or adiabatic
  - move call to diag_init to happen before early exit for
    ideal_phys/adiabatic modes
  - move call to check_energy_init to happen before early exit for
    ideal_phys/adiabatic modes
. phys_run1
  - remove dummy arg etamid
  - remove actual args etamid and cam_in from call to
    phys_run1_adiabatic_or_ideal 
  - move call to check_energy_gmean up so that it gets done whether using
    ideal or full physics.
. phys_run1_adiabatic_or_ideal:
  - remove call to geopotential_t since all versions of d_p_coupling make
    this call.
  - use physics_tend_init to initialize phys_tend
  - update calling args to tphysidl
  - remove dummy args cam_in, etamid

models/atm/cam/src/physics/cam/qneg3.F90
. use same criteria for printing error messages as is used by WACCM

models/atm/cam/src/physics/cam/restart_physics.F90
. don't write fields to restart files that aren't used when running
  adiabatic/ideal physics.

models/atm/cam/src/physics/cam/tphysidl.F90
. Remove args for taux and tauy.  These are inputs to the atm and are
  initialized elsewhere.  Don't know why tphysidl would be trying to set
  these to zero.
. Remove etamid arg -- use hycoef module
. Have ideal physics algorithms set values in ptend, i.e., set dry static
  energy tendency in ptend rather than temperature tendency in tend.
. use update_physics routine to update the output variable tend -- just like
  it's done for the full physics routines.

models/atm/cam/src/physics/cam/water_tracers.F90
. replace cph2o by cpwv

models/atm/cam/src/physics/cam/zm_conv.F90
. replace rwat by rh2o

models/atm/cam/test/system/input_tests_master
. move the specification for adiabatic and ideal physics tests out of the
  namelist template and into the configure arguments

models/atm/cam/test/system/nl_files/adia
. remove setting of atm_adiabatic -- done by build namelist based on
  configuration.

models/atm/cam/test/system/nl_files/idphys
. remove setting of atm_ideal_phys -- done by build namelist based on
  configuration.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

009 bl134 TBL.sh e32adh adia 9s ...................................FAIL! rc= 5
020 bl334 TBL.sh f4adh adia 9s ....................................FAIL! rc= 5
057 bl534 TBL.sh s32adh adia 9s ...................................FAIL! rc= 5

bl134 and bl534: Diffs in fields depending on Q since it's now set to zero, but
       identical otherwise.
bl334: Larger than roundoff diffs due to bug fixes.

tempest: All PASS except:

012 bl135 TBL.sh e32idh idphys 9s .................................FAIL! rc= 5
029 bl335 TBL.sh f4idh idphys 9s ..................................FAIL! rc= 5
043 bl535 TBL.sh s32idh idphys 9s .................................FAIL! rc= 5

bl135 and bl535: Q fields are different since now Q=0.  Roundoff diffs in the
       diagnostic field QRS.
bl335: Larger than roundoff diffs due to bug fixes.

bangkok/lf95: All PASS except:

012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
047 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

These baselines fail due to a roundoff size diff in first appears in the
field DTH. 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except roundoff in spectral dycores
with lf95, and larger that roundoff in FV ideal and adiabatic due to bug
fixes in those configurations.

===============================================================
===============================================================

Tag name:  cam3_5_27
Originator(s): mvr, mvertens
Date: 071212
One-line Summary:
CAM will now couple to the surface components every CAM time step in a way 
that mirrors the coupling mechanism in cpl6; orbital parameter orb_iyear_ad 
will now default to 1990 rather than 1950.

Purpose of changes:
This new coupling mechanism also solves the current problem whereby history 
files were not obtained in the last month of production runs. Now when cam 
and the surface components couple every cam time step, cam and clm do not 
communicate with the driver at nstep=0. Backwards compatibility was maintained 
to still permit the coupling of cam with the surface components on the cam 
radiation time step. The cam tests now use coupling every time step as the 
default approach.
Orbital parameter now matches that used in CCSM.

Bugs fixed (include bugzilla ID): 592

Describe any changes made to build system:

Describe any changes made to the namelist:
- default coupling frequency is value of dtime from atmnl

List any changes to the defaults for the boundary datasets:
- new default finidat, fatmlndfrc, focndomain files for fv1.9x2.5 at gx1v5

Describe any substantial timing or memory changes:

Code reviewed by: mvertens, eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/nl_files/outfrq2h
- obsolete namelist file with move to coupling every cam timestep

List all subroutines added and what they do:
A      models/atm/cam/test/system/nl_files/outfrq3s
- new namelist file needed for testing when coupling every cam timestep

List all existing files that have been modified, and describe the changes:
M      models/ocn/som/mixed_layer.F90
M      models/ocn/som/ocn_comp.F90
M      models/ocn/som/somini.F90
M      models/ocn/som/ocn_comp_mct.F90
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/ccsm_msg.F90
M      models/atm/cam/src/control/con_cam.F90
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/cam_comp.F90
- mods required for new default coupling frequency

M      models/atm/cam/test/system/test_driver.sh
- will now test ccsm with latest tag from ccsm3_9_beta series

M      models/atm/cam/test/system/input_tests_master
M      models/atm/cam/test/system/nl_files/fvvp_lb2
M      models/atm/cam/test/system/nl_files/ghgrmp
M      models/atm/cam/test/system/nl_files/aqpgro
M      models/atm/cam/test/system/nl_files/adia
M      models/atm/cam/test/system/nl_files/fv1d_lb2
M      models/atm/cam/test/system/nl_files/idphys
M      models/atm/cam/test/system/nl_files/co2rmp
M      models/atm/cam/test/system/nl_files/fv1d_4tsk
M      models/atm/cam/test/system/nl_files/fv2d_4tsk
M      models/atm/cam/test/system/nl_files/scm_prep
M      models/atm/cam/test/system/nl_files/fv1d_8tsk
M      models/atm/cam/test/system/nl_files/no_ttrac
M      models/atm/cam/test/system/nl_files/off2x2.5
M      models/atm/cam/test/system/nl_files/fv2d_8tsk
M      models/atm/cam/test/system/nl_files/ttrac_lb1
M      models/atm/cam/test/system/nl_files/microp_mg
M      models/atm/cam/test/system/nl_files/ttrac_lb2
M      models/atm/cam/test/system/nl_files/ttrac
M      models/atm/cam/test/system/nl_files/ttrac_lb3
M      models/atm/cam/test/system/nl_files/fvvp_lb0
- namelist and run length settings tweaked for test scripts to reflect new 
  coupling frequencies

M      models/atm/cam/bld/cam.cpl6.template
M      models/atm/cam/bld/timemgr_inparm.pm
M      models/atm/cam/bld/SeqCCSM_namelist.pm
- scripts modified to include only the required namelist vars for coupled runs

M      models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultTIMEMGR_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultDOM_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultCSIM_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultSOM_INPARM_Namelist.xml
- new default files at gx1v5 for fv1.9x2.5; orb_iyear_ad now 1990

 M     .
M      SVN_EXTERNAL_DIRECTORIES
- updated to drv/seq_mct/trunk_tags/drvseq1_0_62 and 
  clm2/branch_tags/seqccsm_clm3_5_08_tags/seqccsm10_clm3_5_11

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
004 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
009 bl134 TBL.sh e32dh adia 9s ....................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
017 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
020 bl334 TBL.sh f4dh adia 9s .....................................FAIL! rc= 7
023 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 5
026 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
030 bl371 TBL.sh f1.9dm fvvp_lb2 9s ...............................FAIL! rc= 7
034 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
037 bl354 TBL.sh fm2dh outfrq3s 9s ................................FAIL! rc= 5
040 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
044 bl381 TBL.sh fma1.9h outfrq3s+1870_prog_aero 9s ...............FAIL! rc= 5
048 bl382 TBL.sh fmgpa1.9h outfrq3s+1870_control 9s ...............FAIL! rc= 5
052 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
054 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 7
057 bl534 TBL.sh s32dh adia 9s ....................................FAIL! rc= 7
059 bl551 TBL.sh s64h outfrq24h 2d ................................FAIL! rc= 7
061 bl711 TBL.sh h5x8dm adia 9s ...................................FAIL! rc= 7

tempest:
004 bl131 TBL.sh e32dh co2rmp 9s ..................................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
012 bl135 TBL.sh e32dh idphys 9s ..................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h 2d ................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq3s 9s ...............................FAIL! rc= 5
021 bl331 TBL.sh f4gdh co2rmp 9s ..................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
029 bl335 TBL.sh f4dh idphys 9s ...................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
035 bl531 TBL.sh s32dh co2rmp 9s ..................................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 7
043 bl535 TBL.sh s32dh idphys 9s ..................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h 2d ................................FAIL! rc= 7

calgary/lf95:
004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 7
012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
016 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 7
029 bl315 TBL.sh f10c5dm microp_mg 9s .............................FAIL! rc= 7
032 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
035 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 4
039 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 7
043 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 7
045 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 7
047 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

-all baseline tests failed due to a combination of non-b4b changes introduced 
 and the altering of the test scripts that were not available in the baseline code

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_26

Summarize any changes to answers, i.e.,
- what code configurations: ALL
- what platforms/compilers: ALL
- nature of change: larger than roundoff but same climate

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):  seqnoflxave06_cam3_5_24
- platform/compilers: blueice/mpxlf90_r
- configure commandline: 
  som run:
  $cfgdir/configure -dyn fv -res 1.9x2.5 -ocn som

  dom run:
  $cfgdir/configure -dyn fv -res 1.9x2.5 -gensom
	
- build-namelist command (or complete namelist):
  som run:
  $cfgdir/build-namelist -s -case $case -runtype $runtype \
   -namelist "&camexp stop_option='nmonths', stop_n=$stop_n \
   bndtvs='/fis/cgd/cseg/people/mvr/cam_mydata/som/seqnoflxave06_cam3_5_24_0011-0020_qflux.nc' \
   focndomain='/fs/cgd/csm/inputdata/atm/cam/ocnfrac/domain.camocn.1.9x2.5_gx1v4_070807.nc' / &clmexp \
   fatmlndfrc='/fs/cgd/csm/inputdata/lnd/clm2/griddata/fracdata_1.9x2.5_gx1v4_060808.nc' \
   finidat='/fs/cgd/csm/inputdata/lnd/clm2/inidata_3.1/cam/clmi_0000-09-01_1.9x2.5_gx1v4_c070309.nc' /"

  dom run:
  $cfgdir/build-namelist -s -case $case -runtype $runtype \
   -namelist "&camexp stop_option='nmonths', stop_n=$stop_n start_ymd=101 / &clmexp \
   finidat='/fs/cgd/csm/inputdata/lnd/clm2/inidata_3.1/ccsm/clmi_0000-01-01_1.9x2.5_gx1v5_c070523.nc' /"

- MSS location of output:
  som:  mss:/MVR/csm/seqnoflxave06_cam3_5_24_som4
  dom:  mss:/MVR/csm/seqnoflxave06_cam3_5_24
	
- MSS location of control simulations used to validate new climate:
  som:  mss:/MVR/csm/cam3_5_24_som4
  dom:  mss:/MVR/csm/cam3_5_24

- URL for AMWG diagnostics output used to validate new climate:
  som:  mss:/MVR/csm/seqnoflxave06_cam3_5_24_som4/seqnoflxave06_cam3_5_24_som4-cam3_5_24_control_som.tar
  dom:  mss:/MVR/csm/seqnoflxave06_cam3_5_24/seqnoflxave06_cam3_5_24-cam3_5_24_control.tar


===============================================================
===============================================================

Tag name: cam3_5_26 
Originator(s): Jim Edwards
Date: 12/04/2007
One-line Summary: Remove memory consuming arrays from cam_history

Purpose of changes: Memory usage reduction

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
  The pflds array of cam_history.F90 was replaced by a linked list.  This  
  allows the masterlist to be allocated as needed instead of statically allocated
  to the largest anticipated size.  The hash table lookup feature of outfld is retained 
  by creating an array of pointers into the linked list.  The sum result is a slight reduction of 
  performance of the outfld subroutine with up to 2x reduction in memory high water as measured on 
  bluevista.  

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:
  add_entry_to_master - add an entry to the masterlist
  init_masterlinkedlist - initialize the linkedlist
  get_entry_by_name - lookup a masterlist entry by name


List all existing files that have been modified, and describe the changes:
  cam_history.F90 - modified to remove pflds from masterlist and from tape structures
                  these are now allocated structures.  pflds is now only used to support
                  reading fincl and fexcl from the namelist and has been reduced from 10000
                  to 500. Changes required moving location of the variable varid in the restart
                  file, so there is a change in restart file format from previous versions.
  cam_comp.F90 - call the init_masterlinkedlist function on startup

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all PASS except:
051 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: all PASS except:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: all PASS except:
038 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

br532, br531, and br511 are pre-existing failures

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_25
Originator(s): eaton
Date: Mon Dec  3 18:50:09 MST 2007
One-line Summary: misc bugfixes

Purpose of changes:

. Merge bugfixes from the ccsm35 branch (between tags ccsm35_03_cam3_5_07
  and ccsm35_12_cam3_5_07) onto the trunk.  

  These fixes change answers for the following CAM configurations.
  - All WACCM configurations
  - CAM-CHEM configurations "-chem trop_mozart" and "-chem
    trop_mozart_aero" with the prognostic dust radiatively passive and the
    old prescribed dust radiatively active.

. Makefile.in change in AIX section to support new timing library.

. Update the 1870-2000_control use case to use the version of prescribed
  aerosol datasets that contains 10-year climatologies.

. Update to the CAM-CHEM time interpolation codes to deal with input
  datasets that contain gaps in a time series of monthly averages.

. Change the check on the sum of cell areas when running with cpl6 from an
  absolute to a relative error check.

. Loosen check in interpolate_data module for what percent of interpolated
  grid points fall outside the range of the data points.  This check was
  causing a 31 level model version to fail when interpolating the
  noaamisc.r8.nc file for simple GHG chemistry.

. Bugfix in co2_data_flux module (missing mpibcast).


Bugs fixed (include bugzilla ID):

. Bugzilla id 667 - Fix iyear_ad bug in WACCM.

. WACCM bugfix for H2O saturation table.

. CAM-CHEM bug in old prescribed dust optics as described above.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. new default aerosol dataset for 1870-2000_control use case

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/Makefile.in
. changes in AIX section for new timing lib code

models/atm/cam/bld/SeqCCSM_namelist.pm
. add tracer_cnst_filelist to use case hack.

models/atm/cam/bld/use_cases/1870-2000_control.nl
. use aerosol dataset that contains 10 year climatologies

models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
. changes to namelist variables for 'INTERP_MISSING_MONTHS' option

models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
. add mz_prescribed_dust function for dust aerosol optics bugfix

models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
. implement 'INTERP_MISSING_MONTHS' interpolation option

models/atm/cam/src/chemistry/waccm_mozart/efield.F90
models/atm/cam/src/chemistry/waccm_mozart/exbdrift.F90
models/atm/cam/src/chemistry/waccm_mozart/mo_apex.F90
. replace iyear_ad by magfield_fix_year

models/atm/cam/src/chemistry/waccm_mozart/mo_jlong.F90
. bugfix - need ptarget declared real

models/atm/cam/src/chemistry/waccm_mozart/mo_sad.F90
. replace with version from tag
  waccm_qbo_cam3_5_04_tags/waccm_qbo04_cam3_5_18 (per Stacy).

models/atm/cam/src/control/cam_control_mod.F90
. add magfield_fix_year to set year of magnetic field in WACCM

models/atm/cam/src/control/ccsm_msg.F90
. Change check that cell areas sum to 4*pi from absolute to relative error.

models/atm/cam/src/control/interpolate_data.F90
. change check for %domain in extrapolation region -- was causing failure
  of 31 level model when interpolating the noaamisc.r8.nc file for simple
  GHG chemistry.

models/atm/cam/src/control/runtime_opts.F90
. add 'INTERP_MISSING_MONTHS' interpolation option for prescribed ozone,
  tracer_cnst, and tracer_srcs
. replace 'diag TKE' by 'diag_TKE'

models/atm/cam/src/physics/cam/aer_optics.F90
. bugfix - old prescribed dust needs old dust optics

models/atm/cam/src/physics/cam/cloud_fraction.F90
. WACCM tuning mod
. replace 'diag TKE' by 'diag_TKE'

models/atm/cam/src/physics/cam/co2_data_flux.F90
. BGC bugfix - add missing mpibcast

models/atm/cam/src/physics/cam/physpkg.F90
. WACCM bugfix - call qbo_init
. move call aer_optics_initialize to after chem init (needed for the new
  function mz_prescribed_dust)

models/atm/cam/src/physics/cam/radae.F90
. WACCM bugfix for H2O saturation table

models/atm/cam/src/physics/cam/convect_shallow.F90
models/atm/cam/src/physics/cam/phys_control.F90
models/atm/cam/src/physics/cam/vertical_diffusion.F90
. replace 'diag TKE' by 'diag_TKE'

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:
023 bl336 TBL.sh wm4h outfrq2h 4s .................................FAIL! rc= 7
037 bl354 TBL.sh fm2dh outfrq2h 4s ................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 4s ...............................FAIL! rc= 7
044 bl381 TBL.sh fma1.9h outfrq2h+1870_prog_aero 4s ...............FAIL! rc= 7
051 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

bl336 fails due to waccm bugfixes.
bl354, bl355, bl381 fail due to the dust optics bugfix
br532 is a pre-existing failure

tempest: All PASS except:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

br531 is a pre-existing failure

bangkok/lf95: All PASS except
038 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

br511 is a pre-existing failure

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except larger than roundoff changes in
- All WACCM configurations
- CAM-CHEM configurations "-chem trop_mozart" and "-chem
  trop_mozart_aero" with the prognostic dust radiatively passive and the
  old prescribed dust radiatively active.

===============================================================
===============================================================

Tag name: cam3_5_24
Originator(s): tcraig, dennis, eaton
Date: Tue Nov 27 18:32:47 MST 2007
One-line Summary: MPI fixes

Purpose of changes:

. Update the driver external to camxa01_drvseq1_0_57.  This tag is
  seqmct1_0_57 with mods from John Dennis to fix the
  mpicom problems and fix a memory leak.

. Add the file cam.cpl6.template to CAM's bld directory for CCSM build
  system modifications being implemented in the ccsm3_9_betaXX series.

Bugs fixed (include bugzilla ID): see above.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: tcraig

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/cam.cpl6.template
. used by new build system being implemented in ccsm3_9_betaXX series.

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. set external for models/drv/seq_mct to
  $REPO/drv/seq_mct/branch_tags/camxa_drvseq1_0_57_tags/camxa01_drvseq1_0_57

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all PASS except:
051 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: all PASS except:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: all PASS except:
038 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

br532, br531, and br511 are pre-existing failures

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_5_23
Originator(s): Art Mirin
Date: November 17, 2007
One-line Summary: Overlap of dynamics and tracer FV subcycles

Purpose of changes:
This version supports overlap of trac2d and cd_core subcycles. This refers to the
subcycles described by the "do 2000 n=1,n2" loop in dyn_run and has nothing to do
with the "do it=1,nsplit" lower-level subcycling. Each trac2d call (n), other
than the last, is overlapped with the subsequent cd_core 'series' (n+1).

This capability becomes relevant as we go to higher and higher resolution and
operate with more and more tracers. Best results are obtained when the dynamics
and tracer times are comparable (for example, operating with more than the default
number of tracers) and when there is a high degrees of subcycling (for example, at
0.47x0.63 with nspltrac=8).

The controlling namelist variable is ct_overlap. The overlapping trac2d calls are
carried out on the second set of npes_yz processes (npes_yz <= iam < 2*npes_yz).
The tracer arrays are sent to the auxiliary processes prior to the do-2000 loop.
During each subcycle (other than the last), the dp0 array is sent prior to the
cd_core series; arrays cx, cy, mfx, mfy are sent directly from cd_core during
the last call in the series (it=nsplit). At the completion of the last auxiliary
trac2d subcycle (n=n2-1), the updated tracer values are returned to the primary
processes; the last tracer subcycle (n=n2) is carried out on the primary processes.
Communication calls are nonblocking, with attempt to overlap computation to the
extent possible. The CCSM mpi layer (wrap_mpi) is used. Tags with values greater
than npes_xy are chosen to avoid possible interference between the messages sent
from cd_core and the geopk-related transpose messages called from cd_core
thereafter. The auxiliary processes must use values of jfirst, jlast, kfirst,
klast corresponding to their primary process antecedents, whereas by design
those values are (1,0,1,0), resp. (set in spmdinit_dyn). We therefore add
auxiliary subdomain limits to the grid datatype: jfirstct, jlastct, kfirstct,
klastct. For the primary processes, these are identical to the actual subdomain
limits; for the secondary processes, these correspond to the subdomain limits of
the antecedent primary process. These values are communicated to the auxiliary
processes during initialization (spmd_vars_init). During the auxiliary
calculations (and allocations) we temporarily set jfirst equal to jfirstct, etc.,
and when done, restore to the original values. Other information needed by the
auxiliary processes is obtained through the grid datatype.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
New variable ct_overlap (default 0). If nonzero, overlap cd_core and trac2d
subcycles as desdribed above; if nonzero, do not overlap. When overlapping,
the number of processes must be at least as large as twice the size of the
latitude-vertical decomposition.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Sawyer, Worley, Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
utils/pilgrim:
   mod_comm.F90 - compute process index relative to local communicator
src/control:
   fv_control_mod.F90 - add ct_overlap flag
   runtime_opts.F90 - add ct_overlap namelist variable
src/dynamics/fv:
   cd_core.F90 - post communication for arrays needed by trac2d on auxiliary processes
   dyn_comp.F90 - principal routine modified to accomplish cd_core/trac2d overlap
   dynamics_vars.F90 - communicate subdomain limits to auxiliary trac2d processes
   spmd_dyn.F90 - define additional 2yz communicator

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
051 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95:
038 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_22
Originator(s): mvr, mirin, eaton
Date: 071116
One-line Summary: added tests for running with fv decomposition; various 
other bug fixes
	
Purpose of changes:
needed to beef up testing of the various fv decomposition settings as features 
are being added; updating to newer drv tag fixes PGI testing (done post-tag) 
which started failing with cam3_5_19; files need to have the same name as the 
module they contain - an offender was introduced in cam3_5_20; build-namelist 
has not been placing certain variables that are required in multiple namelists  

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
	
Describe any changes made to the namelist:
build-namelist will now properly place bndtvs and focndomain into both the ocn 
and ice namelists 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: mvr,mirin,eaton

List all subroutines eliminated:
D      models/atm/cam/src/physics/cam/ghg_defaults.F90
- file renamed to match the module name it contains

List all subroutines added and what they do:
A  +   models/atm/cam/src/physics/cam/ghg_data.F90
- new filename to match the module name it contains
	
A      models/atm/cam/test/system/config_files/f1.9dm
- new configuration options file for testing fv decomposition in mpi only

A      models/atm/cam/test/system/nl_files/fvvp_lb2
A      models/atm/cam/test/system/nl_files/fv1d_lb2
A      models/atm/cam/test/system/nl_files/fv1d_4tsk
A      models/atm/cam/test/system/nl_files/fv1d_8tsk
A      models/atm/cam/test/system/nl_files/fvvp_lb0
- new namelist options files for testing fv decomposition in various modes

List all existing files that have been modified, and describe the changes:
 M     .
M      SVN_EXTERNAL_DIRECTORIES
- updated to drvseq1_0_57 which contain bug fixes to map_ocnaocn_mct.F90 - this
  was tripping up PGI testing; updated to latest tag for archiving scripts
	
M      models/atm/cam/test/system/tests_pretag_bangkok
M      models/atm/cam/test/system/tests_pretag_bluevista
M      models/atm/cam/test/system/tests_posttag_blueice
M      models/atm/cam/test/system/tests_posttag_calgary
M      models/atm/cam/test/system/tests_posttag_lightning
- added new tests of fv decomposition to default pre/post tag test lists
	
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/TER.sh
M      models/atm/cam/test/system/CAM_runcmnd.sh
- mods in support of new fv tests; increased wall clock for lightning testing

M      models/atm/cam/test/system/input_tests_master
- new fv tests; bug fix with specification of resolution for ccsm tests

M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/bld/run-pc-cice-docn7.csh
M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-sgi.csh
M      models/atm/cam/bld/run-lightning.csh
- modified the default long-term archive root path

M      models/atm/cam/bld/SeqCCSM_namelist.pm
- bug fix for namelist variables needing inclusion on multiple namelists (bndtvs, focndomain)

M      models/atm/cam/src/physics/cam/volcanicmass.F90
- small bug fix in volcanic_initialize

M      models/atm/cam/src/dynamics/fv/sw_core.F90
- fix to bug introduced in cam3_5_21 where the new coding excluded a needed 
  pole-related computation

M      models/atm/cam/src/dynamics/fv/spmd_dyn.F90
- bug fix in call to mpi_comm_split where the value of 'color' was set 
  to a negative number


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:
030 bl371 TBL.sh f1.9dm fvvp_lb2 4s ...............................FAIL! rc= 5
051 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
- bl371 is a new test, so a failure was expected with the baseline code
- br532 is pre-existing failure
	
tempest: All PASS except:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
- br531 is pre-existing failure

bangkok/lf95: All PASS except:
038 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11
- br511 is pre-existing failure

CAM tag used for the baseline comparison tests if different than previous
tag: 

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): b4b 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_21
Originator(s): Art Mirin
Date: November 6, 2007
One-line Summary: Addition of Rayleigh friction and Putman filtering (FV)

Purpose of changes:

CAM has been augmented with the capability to apply Rayleigh
friction or additional filtering (FV). The purpose is to counteract
the effects of a polar jet that appears in the upper portions
of the model, particularly at higher resolution. The jet, the 
extent of which is believed to be non-physical and progressively
worse as the resolution increases, can force the model to run at
a prohibitively low time step.

Additionally, an update to the Pilgrim parutilitiesmodule.F90,
courtesy of John Dennis, is included. The purpose of the
update is to reduce memory requirements. This is needed
particularly for running on BG/L at moderate to high resolution.

Also included in this update is pointing model/drv/seq_mct to 
drvseq1_0_56.

Rayleigh friction: Frictional term is applied with an adjustable
vertical profile based on hyperbolic tangent; lost kinetic energy
is converted to potential energy. Namelist variables are as follows:
   rayk0 - vertical index of peak (default 2).
   raykrange - determines width of profile; if 0., default width
      is chosen; see rayleigh_friction.F90.
   raytau0 - approximate decay time (days) at top of model;
      default of 0. means no Rayleigh friction.

Filtering: Capability to optionally filter intermediate c-grid winds,
courtesy of Bill Putman. Majority of code changes due to necessity
of computing c-grid winds before call to c_sw. Namelist variable is:
   filtcw - yes (1), no (0). Default is 0.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

New namelist variables are (for Rayleigh friction) rayk0, raykrange and
raytau0; and (for Putman filtering) filtcw. See above for descriptions.

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

src/physics/cam: rayleigh_friction.F90: new Rayleigh friction routine.

List all existing files that have been modified, and describe the changes:

utils/pilgrim/parutilitiesmodule.F90: added capability (courtesy
of John Dennis) to reduce memory of decompositions; see precompile
flag _SMEMORY, which is presently set at the beginning of
parutilitiesmodule.F90.

src/control:

fv_control_mod.F90: added filtcw flag (1 for Putman filtering,
0 for none; default is 0).

runtime_opts.F90: Read in 4 new namelist variables.

src/physics/cam:

physpkg.F90: call rayleigh_friction_init.
tphysac.F90: call rayleigh_friction_tend and subsequent physics_update.

src/dynamics/fv:

cd_core.F90: call new routine for c-grid winds (d2a2c_winds). 
Communicate prior to c_sw call. Eliminate ALT_PFT option. 

dyn_comp.F90: Pass through filtcw namelist variable.

dynamics_vars.F90: Pass through filtcw namelist variable.

inital.F90: Pass through filtcw namelist variable.

pft_module.F90: Eliminate ALT_PFT option.
restart_dynamics.F90: Pass through filtcw namelist variable.

sw_core.F90: Add subroutine d2a2c_winds. Eliminate coding that it replaced.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: (per Mat Rothstein)
045 br532 TBR.sh s32sdh ghgrmp 4+2s..............FAIL! rc=11

tempest:
034 br531 TBR.sh s32dh co2rmp 4+2s ..............FAIL! rc=11

bangkok/lf95:
037 br511 TBR.sh s8c8mdm ttrac 4+2s .............FAIL! rc=11

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_5_20
Originator(s): Andrew Conley
Date: 11/01/07
One-line Summary:
  Move (CAM) data descriptions of gas constituents to pbuf

Purpose of changes:
  Preparation for implementation of Radiative Constituents interface.
  Note that CAM/CHEM (MOZART) data gasses have not yet been moved.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:
  Memory for prescribed gas fields is now allocated in the
  physics buffer rather than module variables.  (Not
  substantial?)

Code reviewed by: myself, Brian Eaton

List all subroutines eliminated:
D models/atm/cam/src/physics/cam/rad_cnst_data_interface.F90
  Module no longer necessary for override from mozart/chem data
specification.

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M models/atm/cam/src/physics/cam/initindx.F90
  data models of gas distributions registrations with pbuf are called
M models/atm/cam/src/physics/cam/ghg_defaults.F90
  O2 added as a data model gas
  CO2 is now added as a data gas through this interface
  Access to pbuf is passed to this module
  ghg's register with pbuf
  ghg's update values with timestep (advnce)
  local memory deleted for data gasses
  remove "ghg_defaults_get_cnst()"
M models/atm/cam/src/physics/cam/radheat.F90
  add pbuf to radheat_tend argument list so that waccm override has access.
M models/atm/cam/src/physics/cam/radiation.F90
  O2 is now accessed from rad_constituents
  remove call to unused/inoperative aerosol_indirect method
  generalized co2_col_mean code to work for O2 and CO2
  pass o2 to radcswmx
M models/atm/cam/src/physics/cam/radsw.F90
  pass o2 rather than specifying it as a data statement
M models/atm/cam/src/physics/cam/chem_surfvals.F90
  add o2mmr data specification in this module
M models/atm/cam/src/physics/cam/ozone_data.F90
  use pbuf to store data description rather than local memory
  add "ozone_data_register"
  rm unused ozone_data_final
  add "ozone_data_get_cnst"
M models/atm/cam/src/physics/cam/physpkg.F90
  rm call to "ghg_defaults_init"
  add pbuf to call advnce(phys_state, pbuf)
M models/atm/cam/src/physics/cam/rad_constituents.F90
  modified logic to use pbuf representations of data gases,
    unless a number of complex overrides are present.  Read
    the logic for your particular case if interested.
M models/atm/cam/src/physics/cam/prescribed_aerosols.F90
  rm unused/inoperable aerosol_indirect subroutine
M models/atm/cam/src/physics/cam/advnce.F90
  add access to pbuf
M models/atm/cam/src/physics/waccm/nlte_lw.F90
  add access to pbuf so code can access data O3
M models/atm/cam/src/physics/waccm/radheat.F90
  add access to pbuf
M models/atm/cam/src/chemistry/trop_mozart/rad_cnst_data_interface.F90
  remove calls to CAM versions of data gasses.
M models/atm/cam/src/chemistry/waccm_mozart/chem_surfvals.F90
  add data prescription of oxygen

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
004 bl132 TBL.sh e32sdh ghgrmp 4s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 2s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
017 bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
023 bl336 TBL.sh wm4h outfrq2h 4s .................................FAIL! rc= 7
026 bl337 TBL.sh f4dh fv2d_8tsk 4s ................................FAIL! rc= 7
028 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
031 bl354 TBL.sh fm2dh outfrq2h 4s ................................FAIL! rc= 7
034 bl355 TBL.sh fmo2dh off2x2.5 4s ...............................FAIL! rc= 7
038 bl381 TBL.sh fma1.9h outfrq2h+1870_prog_aero 4s ...............FAIL! rc= 7
042 bl382 TBL.sh fmgpa1.9h outfrq2h+1870_control 4s ...............FAIL! rc= 7
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
046 bl532 TBL.sh s32sdh ghgrmp 4s .................................FAIL! rc= 7
053 bl551 TBL.sh s64h outfrq24h 2d ................................FAIL! rc= 7

tempest:
004 bl131 TBL.sh e32dh co2rmp 4s ..................................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 4s .................................FAIL! rc= 7
009 bl133 TBL.sh e32pdh aqpgro 2s .................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h 2d ................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq2h 4s ...............................FAIL! rc= 7
021 bl331 TBL.sh f4gdh co2rmp 4s ..................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
035 bl531 TBL.sh s32dh co2rmp 4s ..................................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 4s .................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h 2d ................................FAIL! rc= 7


calgary/lf95:
004 bl111 TBL.sh e8c8mdm ttrac 4s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 4s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 2s ..................................FAIL! rc= 7
012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
016 bl311 TBL.sh f10c8mdm ttrac 4s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 4s .................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 2s .................................FAIL! rc= 7
029 bl315 TBL.sh f10c5dm microp_mg 4s .............................FAIL! rc= 7
032 bl317 TBL.sh f10dm fv2d_4tsk 4s ...............................FAIL! rc= 7
034 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11
038 bl511 TBL.sh s8c8mdm ttrac 4s .................................FAIL! rc= 7
042 bl512 TBL.sh s8sdm ghgrmp 4s ..................................FAIL! rc= 7
046 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

The following failures were preexisting:
bluevista
 045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
tempest
 034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
calgary/lf95
 037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

Almost all baseline tests fail since this commits a roundoff level change.
This code produces roundoff level changes since we use a mass-weighted
average value of a constant value instead of the constant value for CO2 
and O2.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: waccm/mozart prognostic O2 is now used by
radiation
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): roundoff, verified by cprncdf and visual inspection.
            larger than "roundoff" for waccm/mozart

If bitwise differences were observed, how did you show they were no worse
than roundoff? cprncdf on Temperature field

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

Summarize any changes to answers: roundoff

===============================================================
===============================================================

Tag name: cam3_5_19
Originator(s): mvertens
Date: Wed Oct 31 13:59:52 MDT 2007
One-line Summary: updated externals to ccsm4_0_alpha07

Purpose of changes: Bring cam trunk up to date with sequential ccsm 
  code base

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: see below

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: tcraig

List all subroutines eliminated: none

List all subroutines added and what they do:
   A bld/run-ibm-cice-docn7.csh
     - temporary script to run with cice-docn7 outside of cpl7 scripts
       (recommendation is to always use cpl7 scripts) 

List all existing files that have been modified, and describe the changes:

   M models/ocn/dom/ocn_comp_mct.F90
   M models/ocn/som/ocn_comp_mct.F90
   M models/ice/csim4/ice_comp_mct.F90
   M models/atm/cam/src/control/atm_comp_mct.F90
      - made routines compatible with drvseq1_0_55

   M models/atm/cam/src/control/con_cam.F90
      - removed call to shr_inputInfo_initRestArchive
   M models/atm/cam/src/control/print_memusage.F90
      - added BGL flag

   M models/atm/cam/bld/configure
      - stand-alone: added drv/seq_mct/driver to Filepath 
      - cpl7: added drv/seq_mct/driver to Filepath and ccsm_seq flag to specify that cam 
              is being built from cpl7 scripts	
   M models/atm/cam/bld/config_definition.xml
      - added ccsm_seq switch

   M SVN_EXTERNAL_DIRECTORIES 
       - using following new externals (https://svn-ccsm-models.cgd.ucar.edu is implied in path below)
       models/drv/seq_mct             drv/seq_mct/trunk_tags/drvseq1_0_55
       models/lnd/clm2/src            clm2/branch_tags/seqccsm_clm3_5_08_tags/seqccsm08_clm3_5_11/src
       models/ice/cice/src            cice/trunk_tags/cice4_0_20071022
       models/ocn/docn7               docn7/branch_tags/drva_docn7_070824_tags/drva05_docn7_070824
       models/csm_share               csm_share/branch_tags/loga_share3_070903_tags/loga15_share3_071012
       models/utils/esmf_wrf_timemgr  esmf_wrf_timemgr/trunk_tags/esmf_wrf_timemgr_060616
       models/utils/timing            timing/trunk_tags/timing_070525
       models/utils/mct               mct/branch_tags/seqa_MCT2_3_0_070524_tags/seqa06_MCT2_4_2_071026
       models/atm/cam/archiving       scripts/trunk_tags/scripts_070907b/ccsm_utils/Tools/archiving

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all tests passed except for
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 9

tempest: all tests passed except for
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

bangkok/lf95: all tests passed except for 
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 9

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: none, answers are bfb 

===============================================================
===============================================================

Tag name: cam3_5_18
Originator(s): Jim Edwards
Date: 10/24/07
One-line Summary: update of homme dycore

Purpose of changes: merge recent development of homme dycore into trunk

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:  
	added support for homme ne21np4 resolution

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself, Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:
	get_dyn_grid_parm added to dyn_grid.F90 for all dycores
	given a string name of an integer parameter, return the value
	of that parameter, return -1 if that parameter is not valid in a
	given dycore.

List all existing files that have been modified, and describe the changes:
	     Bulk update of HOMME dycore from development in the standalone homme 
	     repository and in branch homme_cam3_5_01 
M            6985   models/atm/cam/src/dynamics/homme/restart_dynamics.F90
M            6985   models/atm/cam/src/dynamics/homme/external/filter_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/diffusion_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/forcing_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/parallel_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/reduction_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/schedule_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/derivative_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/prim_si_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/domain_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/dimensions_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/surfaces_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/control_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/physics_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/interpolate_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/element_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/time_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/hybvcoord_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/baroclinic_inst_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/dof_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/solver_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/external/bndry_mod.F90
M            6985   models/atm/cam/src/dynamics/homme/dycore.F90
M            6990   models/atm/cam/src/dynamics/homme/dyn_grid.F90
M            6985   models/atm/cam/src/dynamics/homme/initcom.F90
M            6985   models/atm/cam/src/dynamics/homme/dp_coupling.F90
M            6985   models/atm/cam/src/dynamics/homme/stepon.F90
M            6985   models/atm/cam/src/dynamics/homme/dyn_comp.F90

         Added get_dyn_grid_parm which replaces use pmgrid functionality
	 and allows the removal of several #ifdef macros in cam_history
M            6985   models/atm/cam/src/dynamics/sld/dyn_grid.F90
M            6985   models/atm/cam/src/dynamics/eul/dyn_grid.F90
M            6985   models/atm/cam/src/dynamics/fv/dyn_grid.F90
M            6985   models/atm/cam/src/control/cam_history.F90

	Support for homme grid resolution ne21np4
M            6985   models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
M            6985   models/atm/cam/bld/config_horiz_grid.xml
                     


	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:  All pass except preexisting and homme 
 055 bl711 TBL.sh h5x8dm adia 4s ...................................FAIL! rc= 7
 since have not yet established a climate for the homme dycore no perturbation growth was run.

tempest: All pass except preexisting.

bangkok/lf95: All pass except preexisting.

The following failures were preexisting:
bluevista
 045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
tempest
 034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
bangkok/lf95
 037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_17
Originator(s): Pat Worley, Brian Eaton, James B. White III
Date: 10/18/07
One-line Summary: introduction of scalable gmean algorithms; 
replacement of gavglook by gmean_mass (which calls gmean)
	
Purpose of changes: improve performance and memory scalability of
field mean calculations in the physics

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: cam_inparm (in atm_in)
has optional parameters phys_float_repro_gmean, phys_fixed_repro_gmean, 
phys_nonrepro_gmean, phys_rdiff_warning_gmean (see descriptions below)

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: for large processor counts, 
significant improvement in performance

Code reviewed by: Worley and Eaton

List all subroutines eliminated: 

 gavglook (in physpkg.F90)
 - replaced by gmean_mass

List all subroutines added and what they do: 

 phys_gmean_defaultopts (in phys_gmean.F90)
 - get default phys_gmean runtime options

 phys_gmean_setopts (in phys_gmean.F90)
 - set phys_gmean runtime options

 gmean_mass (in phys_gmean.F90)
 - compute global mean mass of constituent fields on physics decomposition
 - replacement for gavglook; calls gmean

 gmean_float_repro (in phy_gmean.F90 - private to module)
 - gmean algorithm used in cam3_5_16 (preserved until future clean-up check-in)
 - implementation calls gather_chunk_to_field and computes 2D mean on masterproc
 - selected by setting phys_float_repro_gmean = .true. in cam_inparm namelist
 - if selected, this value is used instead of that produced by other gmean
    algorithms

 gmean_fixed_repro (in phy_gmean.F90 - private to module)
 - fixed-point-based, scalable, reproducible gmean algorithm 
 - implementation calls mpi_allreduce twice
 - on by default, but can be turned on/off by setting 
    phys_fixed_repro_gmean = .true./.false. in cam_inparm namelist

 gmean_nonrepro (in phy_gmean.F90 - private to module)
 - floating-point-based, scalable, nonreproducible gmean algorithm 
 - implementation calls mpi_allreduce once
 - on by default, but can be turned on/off by setting 
    phys_nonrepro_gmean = .true./.false. in cam_inparm namelist
 - when used with gmean_fixed_repro, result from gmean_nonrepro used only
    to check that gmean_fixed_repro result is accurate; error criterion
    set using phys_rdiff_warning_gmean mac_inparm namelist. Default value is 
    phys_rdiff_warning_gmean = 1.e-13_r8

List all existing files that have been modified, and describe the changes:

 atm/cam/src/control/cam_comp.F90
 atm/cam/src/physics/cam/physpkg.F90
 - gmean_mass replacement for gavglook

 atm/cam/src/control/cam_history.F90
 - fix of SYPD performance calculation when doing restarts

 atm/cam/src/control/ccsm_msg.F90
 atm/cam/src/dynamics/eul/dyn_grid.F90
 atm/cam/src/dynamics/fv/dyn_grid.F90
 atm/cam/src/dynamics/homme/dyn_grid.F90
 atm/cam/src/dynamics/sld/dyn_grid.F90
 atm/cam/src/physics/cam/phys_grid.F90
 - change in get_horiz_grid_d call to return both areas and integration
    weights (optional parameters); used to eliminate necessity of dycore-specific
    implementations in new gmean algorithms

 atm/cam/src/control/mpishorthand.F
 atm/cam/src/utils/spmd_utils.F90
 - support for fixed-precision gmean algorithm

 atm/cam/src/control/runtime_opts.F90
 - gmean runtime options

 atm/cam/src/physics/cam/phys_gmean.F90
 - new and old gmean algorithms and routines to control which to use
 - gmean_mass replacement for gavglook

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: ALL PASS except

015 bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
017 bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
023 bl336 TBL.sh wm4h outfrq2h 4s .................................FAIL! rc= 7
026 bl337 TBL.sh f4dh fv2d_8tsk 4s ................................FAIL! rc= 7
028 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
031 bl354 TBL.sh fm2dh outfrq2h 4s ................................FAIL! rc= 7
038 bl381 TBL.sh fma1.9h outfrq2h+1870_prog_aero 4s ...............FAIL! rc= 7
042 bl382 TBL.sh fmgpa1.9h outfrq2h+1870_control 4s ...............FAIL! rc= 7
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: ALL PASS except

017 bl314 TBL.sh wg10dh outfrq2h 4s ...............................FAIL! rc= 7
021 bl331 TBL.sh f4gdh co2rmp 4s ..................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: ALL PASS except

016 bl311 TBL.sh f10c8mdm ttrac 4s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 4s .................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 2s .................................FAIL! rc= 7
029 bl315 TBL.sh f10c5dm microp_mg 4s .............................FAIL! rc= 7
032 bl317 TBL.sh f10dm fv2d_4tsk 4s ...............................FAIL! rc= 7
034 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

The following failures were preexisting:
bluevista
 045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
tempest
 034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
bangkok/lf95
 037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

Changing the gmean calculation is not bit-for-bit when using the
FV dycore (but is for the spectral dycores). Thus all FV comparisons
to the baseline failed. 
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: FV dycore using new gmean algorithms. Using old
   algorithm (phys_float_repro_gmean), the results are bit-for-bit
- what platforms/compilers: all
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff? perturbation growth test on bluevista

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_5_16
Originator(s): mvr, mvertens, mirin
Date: 071009
One-line Summary: bug fix for gensom utility (temporary); cleanup of 
getfil routine; line length bug fix for code entered in prev tag; new 
resolutions for ocnfrac input files

Purpose of changes: the gensom utility broke with cam3_5_01 where 
the string variables passed between components were being truncated 
when the max length was exceeded - a temporary fix, extending the 
length of the strings was put into the drv code...the getfil routine 
still had logic trying to locate files remotely if not present on 
local disc - this should have been cleaned up with cam3_5_11...lines 
of fortran code cannot exceed 132 chars on tempest compilers - new 
code from cam3_5_15 needed to be split into two lines  

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:
new ocnfrac datasets at 1,1/2,1/4 deg fv 

Describe any substantial timing or memory changes:

Code reviewed by: mvr,mvertens

List all subroutines eliminated:
none

List all subroutines added and what they do:
none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/bld/DefaultDOM_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultCSIM_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultSOM_INPARM_Namelist.xml
- new resolutions added to default settings for ocnfrac files
M      models/atm/cam/src/control/ioFileMod.F90
- further cleanup of getfil to only search local disc for file
M      models/atm/cam/src/physics/cam/stratiform.F90
- shortened length of line that trips up compiler on tempest (sgi/irix)
M      SVN_EXTERNAL_DIRECTORIES
 M     .
- updated drv branch tag to pull in temporary fix for lengths of strings 
  passed between components


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice: All PASS except:

045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: All PASS except:

034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: All PASS except:

037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

The failures are pre-existing.

CAM tag used for the baseline comparison tests if different than previous
tag: needed to use cam3_5_14 on tempest to get around compiler problem 
with line length

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_15
Originator(s): andrew, eaton
Date: Thu Oct  4 18:44:20 MDT 2007
One-line Summary: fix MG microphysics diagnostics; update CLM datasets; new
  use cases

Purpose of changes:

. MG microphysics: Add fixes for diagnostics and add new radar reflectivity
  diagnostics.

. Update the CLM datasets for 1 degree and higher resolutions.

. Add new build-namelist -use_case options:
  1870-2000_control -- CAM configuration for running 1870-2000 CCSM controls
  waccm_1995_climo  -- WACCM 1995 climatology

. Modify co2vmr value in 1990_control use case to be consistent with the
  value in the CCSM scripts.

. Modify WACCM code not to use iyear_ad because it is not available when
  running in the CCSM environment.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

. Updated the CLM datasets for 1 degree and higher resolutions

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/use_cases/1870-2000_control.nl
models/atm/cam/bld/use_cases/waccm_1995_climo.nl
. new use case files

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. look for valid use case names in the use_cases directory.  Now this file
  doesn't need to be updated when new use cases are added.

models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
. update a WACCM lbc_file entry

models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
. update CLM files for 1 degree and higher resolutions

models/atm/cam/bld/SeqCCSM_namelist.pm
. add code to add the data root directory to the relative pathnames
  that are specified in the use case namelist files.

models/atm/cam/bld/cam_inparm.pm
models/atm/cam/bld/dom_inparm.pm
. mods so that relative paths can be specified in use case files

models/atm/cam/bld/namelist.pm
. modify code in sub parse that's responsible for finding the line of the
  input file that contains the namelist group name.

models/atm/cam/bld/use_cases/1990_control.nl
. update co2vmr to match specification in CCSM

models/atm/cam/src/chemistry/waccm_mozart/exbdrift.F90
. use the model year instead of iyear_ad in call to subsol.  iyear_ad is
  currently not available to CAM when running in CCSM.

models/atm/cam/src/control/srfxfer.F90
. always set cam_out%co2diag; not just when co2_transport==.true.

models/atm/cam/src/physics/cam/cldwat2m.F90
. mods for radar reflectivity calculation

models/atm/cam/src/physics/cam/prescribed_aerosols.F90
. fix units of aerosol number concentration fields in history files

models/atm/cam/src/physics/cam/stratiform.F90
. add radar reflectivity fields
. use state instead of state1 in call to collect_sw_aer_masses

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

023 bl336 TBL.sh wm4h outfrq2h 4s .................................FAIL! rc= 7
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: All PASS except:

034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: All PASS except:

037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

bl336 is failing due to using the model year rather than iyear_ad in the
WACCM code for the ExB calculation.

br511, br531, br532 are pre-existing failures.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_10

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_5_14
Originator(s): mvr
Date: 070925
One-line Summary: all writes of model log output to unit 6 were replaced 
with writes to a variable logical unit - allows for a move to a unique 
unit number with assigned log file in the future 

Purpose of changes: sorting through the log output of a coupled 
run was complicated by various components all dumping to stdout; 
assigning unique unit numbers with associated log files for each 
component will clear some of the confusion

Bugs fixed (include bugzilla ID): 447 (partially)

Describe any changes made to build system:
- added option to configure to indicate that CAM is being built from within 
sequential CCSM scripts

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself, mvertens, eaton

List all subroutines eliminated:
D      models/atm/cam/src/control/linebuf_stdout.c
- removed obsolete code

List all subroutines added and what they do:
A      models/atm/cam/src/control/cam_logfile.F90
- added new module for managing the logical unit of cam's output log

List all existing files that have been modified, and describe the changes:

- too many to list!!
- every file with writes to stdout was modified to use a variable unit number 
  instead...what follows are mods made in addition to these

M      models/atm/cam/bld/configure
M      models/atm/cam/bld/config_definition.xml
- added option to indicate that CAM is being built from within sequential 
  CCSM scripts

M      models/atm/cam/src/control/con_cam.F90
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/cam_comp.F90
- moved call to spmdinit up one level to ease the redirection of share 
  output to cam's log output

M      models/atm/cam/src/physics/cam/convect_ke_intr.F90
M      models/atm/cam/src/physics/cam/icarus_scops.F90
- replaced usage of hardcoded unit numbers with calls to share code for 
  unique unit numbers

M      input_tests_master
- modified resolutions used for testing of ccsm through cam

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: All PASS except:

034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

calgary/lf95: All PASS except:

037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

The failures are pre-existing.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_13
Originator(s): eaton
Date: Thu Sep 20 17:45:00 MDT 2007
One-line Summary: Reduce memory use

Purpose of changes: 

. Reduce memory use.

. Update the csm_share tag to trunk_tags/share3_070918

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

.  Memory use in the FV core was reduced by eliminating the allocation of 4
   unnecessary 3D arrays in inidat.

.  Memory use was reduced when absorptivity/emissivity restart files are
   read/written by breaking the read and write of the abs/ems arrays into
   smaller pieces so no more than a single 3D global array of temporary
   storage is required.  Previously PLEVP 3D arrays were being
   simultaneously allocated. 

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. change csm_share to trunk_tags/share3_070918

models/atm/cam/src/dynamics/fv/inidat.F90
. remove 4 unneeded 3D arrays

models/atm/cam/src/physics/cam/restart_physics.F90
. Break the read and write of the abs/ems arrays into smaller pieces so no
  more than a single 3D global array of temporary storage is required.
  Previously PLEVP 3D arrays were being simultaneously allocated.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: All PASS except:

034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: All PASS except:

037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

The failures are pre-existing.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_10

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_5_12
Originator(s): jet, mariana
Date: Tue Sep 18 15:00:16 MDT 2007

One-line Summary: SCM fixes, brought clm external up to latest commit, 
	added focndomain changes.

Purpose of changes:  Fixed outstanding problem with SCM not being able
	to read land initial data, also refactored the way scm mode 
	determines whether land/ocn/ice is present by using new focndomain
	boundary dataset.  Required analogous changes to drv,share,clm
	externals.

Bugs fixed (include bugzilla ID): 480, 612

Describe any changes made to build system:  new focndomain file is now
	provided by configure

Describe any changes made to the namelist: ocn_in has focndomain boundary
	data file 

List any changes to the defaults for the boundary datasets:  new focndomain
	file is now required to have ocean fraction data. 

Describe any substantial timing or memory changes:none

Code reviewed by:jet

List all subroutines eliminated:

D      models/atm/cam/src/control/setlatlonidx.F90

	moved this file's functionality into a share module that all
	components can use.
	
List all subroutines added and what they do:

	
List all existing files that have been modified, and describe the changes:
        M      models/ocn/dom/sst_data.F90 - uses new shr_scam_mod_file 
	M      models/ocn/dom/ocn_comp.F90 - fixes for focndomain
	M      models/ocn/dom/ocn_comp_mct.F90 - fixes for focndomain
	M      models/ocn/som/ocn_comp.F90 - fixes for focndomain
	M      models/ocn/som/ocn_comp_mct.F90 - fixes for focndomain
	M      models/ice/csim4/ice_data.F90 - uses new shr_scam_mod_file 
	M      models/ice/csim4/ice_comp.F90 - fixes for focndomain
	M      models/ice/csim4/ice_comp_mct.F90 - fixes for focndomain
	M      models/atm/cam/bld/som_inparm.pm - fixes for focndomain
	M      models/atm/cam/bld/configure - fixes for focndomain
	M      models/atm/cam/bld/run-pc-cice-docn7.csh - fixes for focndomain
	M      models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml - fixes for focndomain
	M      models/atm/cam/bld/cam_inparm.pm - fixes for focndomain
	M      models/atm/cam/bld/DefaultDOM_INPARM_Namelist.xml - fixes for focndomain
	M      models/atm/cam/bld/dom_inparm.pm - fixes for focndomain
	M      models/atm/cam/bld/DefaultCSIM_INPARM_Namelist.xml - fixes for focndomain
	M      models/atm/cam/bld/DefaultSOM_INPARM_Namelist.xml - fixes for focndomain
	M      models/atm/cam/bld/csim_inparm.pm - fixes for focndomain
	M      models/atm/cam/src/control/runtime_opts.F90 - fixes for focndomain
	M      models/atm/cam/src/control/ncdio_atm.F90 - scam bug fix
	M      models/atm/cam/src/control/scamMod.F90 - uses new shr_scam_mod_file 
	M      models/atm/cam/src/control/startup_initialconds.F90 - merge marianas mods for focndomain
	M      models/atm/cam/src/control/filenames.F90 - merge marianas mods for focndomain
	M      models/atm/cam/src/control/cam_history.F90 - uses new shr_scam_mod_file 
	M      models/atm/cam/src/physics/cam/prescribed_aerosols.F90 - uses new shr_scam_mod_file 
	M      models/atm/cam/src/physics/cam/gw_drag.F90 - scam bug fix
	M      models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90 - uses new shr_scam_mod_file 
	M      models/atm/cam/src/dynamics/eul/iop.F90 - scam refactor changes
	M      SVN_EXTERNAL_DIRECTORIES - point to new external directories
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

All ccsm tests fail due to new external shr code requirements for clm, atm, and, drv
	
bluevista:
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95:
037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

	
CAM tag used for the baseline comparison tests if different than previous
tag: cam3_5_08

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff? bfb

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:   cam3_5_11
Originator(s): mvr
Date: 7 Sep 2007
One-line Summary: replacing inline archiving of model output with 
scripts for archiving after completion of model run 

Purpose of changes: it's been a long-time desire to make the archiving 
of model output a post-processing activity, similar to running with ccsm; 
ideally, we'd like both systems to use the same scripts; this should 
allow for adding support for more machines and storage systems, inside 
and eventually outside ncar...

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: removed share code from 
filepath for coupled runs

Describe any changes made to the namelist: archiving options removed

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself, eaton

List all subroutines eliminated:
D      models/atm/cam/test/system/nl_files/off2x2.5p
- removed namelist options file no longer used by test scripts
	
List all subroutines added and what they do:
none
	
List all existing files that have been modified, and describe the changes:
M      SVN_EXTERNAL_DIRECTORIES
M     .
- added external for archiving scripts which will reside in the ccsm scripts;
  updated to new share tag which has cleanup of restart pointer files for drv

M      models/ocn/dom/ocn_comp.F90
M      models/ocn/dom/ocn_comp_mct.F90
M      models/ocn/som/ocn_comp.F90
M      models/ocn/som/ocn_comp_mct.F90
M      models/ice/csim4/ice_comp.F90
M      models/ice/csim4/ice_comp_mct.F90
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/ccsm_msg.F90
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/filenames.F90
M      models/atm/cam/src/control/cam_restart.F90
M      models/atm/cam/src/control/ioFileMod.F90
M      models/atm/cam/src/control/cam_comp.F90
M      models/atm/cam/src/control/cam_history.F90
M      models/atm/cam/src/physics/cam/restart_physics.F90
M      models/atm/cam/bld/NamelistsDescriptions.xml
- removed code related to inline archiving of model output; now forcing restart 
  pointer files to reside in run directory

M      models/atm/cam/test/system/test_driver.sh
- made 'regular' the default queue for bluevista testing; increased wall clock
  limit for lightning testing; removed redundant setting of LD_LIBRARY_PATH on bangkok

M      models/atm/cam/test/system/nl_files/ghgrmp
M      models/atm/cam/test/system/nl_files/aqpgro
M      models/atm/cam/test/system/nl_files/adia
M      models/atm/cam/test/system/nl_files/outfrq24h
M      models/atm/cam/test/system/nl_files/idphys
M      models/atm/cam/test/system/nl_files/co2rmp
M      models/atm/cam/test/system/nl_files/fv2d_4tsk
M      models/atm/cam/test/system/nl_files/scm_b4b_o1
M      models/atm/cam/test/system/nl_files/scm_prep
M      models/atm/cam/test/system/nl_files/no_ttrac
M      models/atm/cam/test/system/nl_files/off2x2.5
M      models/atm/cam/test/system/nl_files/fv2d_8tsk
M      models/atm/cam/test/system/nl_files/outfrq2h
M      models/atm/cam/test/system/nl_files/ttrac_lb1
M      models/atm/cam/test/system/nl_files/microp_mg
M      models/atm/cam/test/system/nl_files/ttrac_lb2
M      models/atm/cam/test/system/nl_files/ttrac
M      models/atm/cam/test/system/nl_files/ttrac_lb3
- removed specifications of restart pointer files in test scripts and any archive settings

M      models/atm/cam/test/system/input_tests_master
- post-tag testing of ccsm will now exercise 1870_control compset

M      models/atm/cam/bld/configure
- removed share code from filepath in support of having csm_share build as library in 
  coupled mode

M      models/atm/cam/bld/run-ibm.csh
M      models/atm/cam/bld/run-pc-cice-docn7.csh
M      models/atm/cam/bld/run-pc.csh
M      models/atm/cam/bld/run-sgi.csh
M      models/atm/cam/bld/run-lightning.csh
- enabled template run scripts with calls to new archive scripts

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95:
037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

- branch tests br511, br531, br532 failed in the previous tag
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_10
Originator(s): Art Mirin, Pat Worley
Date: 9/5/07
One-line Summary: Enable different numbers of processes for different portions of the calculation

Purpose of changes: Improve scalability and make minor changes to physics
tuning for 0.5-deg and 0.25-deg FV.

CAM is now able to utilize different numbers of processes for different
portions of the calculation. More specifically:

(1) CAM/FV can run with a smaller latitude-vertical decomposition than
longitude-latitude decomposition.

(2) CAM can run with more physics processes than dynamics processes, or with
inactive processes. Inactive physics processes are enabled by assigning zero chunks.
The current restrictions are as follows: If phys_loadbalance equals 0 or 3, then the
physics process count will equal the dynamics process count, and additional processes will be
idle throughout. If phys_loadbalance equals 2, all processes will be assigned to
the physics and a prescribed subset to the dynamics. The current capability holds for FV,
EUL and SLD dynamical cores.

Also, a few physics tuning parameters relevant to running the FV dycore at
0.5-deg or finer have been modified. 

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist: added nspltrac, dyn_npes, dyn_npes_stride
nspltrac: number of tracer timesteps per physics timestep for FV; if 0,
resolution-dependent defaults are enacted
dyn_npes: number of dynamics processes for EUL/SLD
dyn_npes_stride: stride for dynamics processes for EUL/SLD

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes: ability to use more physics
than dynamics processes improves throughput of physics; ability to use more
lon-lat processes than lat-vert processes for FV improves throughput of parts of FV dynamics

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

src/physics/cam:

check_energy.F90 - inactive physics processes
cldwat.F90 - tuning; icritc for 0.5- and 0.25-deg FV
cloud_fraction.F90 - tuning; premit for 0.5- and 0.25-deg FV
gw_drag.F90 -writing effgw_oro and kwv to stdout
hk_conv.F90 - tuning; c0 for 0.5- and 0.25-deg FV, and writing cmftau and c0 to stdout
phys_grid.F90 -chunk creation and allocation changes to support inactive processes in 
   the dynamics; use correct communicator and dimensions with mod_comm options in 
   transpose routines.
physpkg.F90 - automatic => allocatable arrays in gavglook  (Note: if/when gavglook is 
   optimized a la phys_gmean, this will be unnecessary)

src/control:

cam_comp.F90 - fix timers bug
fv_control_mod.F90 - declare nspltrac for tracer subcycling
runtime_opts.F90 - add namelist variables for active dynamics processes (EUL/SLD) and 
   tracer subcycling (FV)

src/utils:

spmd_utils.F90 - trivial clean-up of appearance and comments
 
src/dynamics/fv:

FVperfmod.F90 - add communicators to barrier calls
benergy.F90 - add communicator to calls
cd_core.F90 - flexible dynamics decompositions and add communicators to calls
d2a3d_ijk.F90 - add communicator to calls
d2a3d_ikj.F90 - add communicator to calls
diag_module.F90 - flexible dynamics decompositions and add communicator to calls
dp_coupling.F90 - flexible dynamics and physics decompositions
dyn_comp.F90 - flexible dynamics decompositions and add communicator to calls
dynamics_vars.F90 - flexible dynamics decompositions, add communicator to calls, and 
   tracer subcycling
epvd.F90 - add communicator to calls
fv_prints.F90 - flexible dynamics and physics decompositions
geopk.F90 - flexible dynamics decompositions and add communicator to calls; fix 
   placement of precompile flag
inidat.F90 - flexible dynamics decompositions and add communicator to calls
inital.F90 - tracer subcycling
io_dist.F90 - add communicator to calls
mapz_module.F90 - add diagnostics
mean_module.F90 - flexible dynamics decompositions
metdata.F90 - add communicator to calls
pfixer.F90 - add communicator to calls
pmgrid.F90 - remove superfluous decompositions
restart_dynamics.F90 - flexible dynamics decompositions and tracer subcycling
spmd_dyn.F90 - flexible dynamics decompositions, adding new EUL/SLD namelist 
   arguments in spmd_dyn_defaultopts and spmd_dyn_setopts (as no-ops)
stepon.F90 - add communicator to calls and tracer subcycling
te_map.F90 - add communicator to calls
trac2d.F90 - add communicator to calls
uv3s_update.F90 - add communicator to calls

src/dynamics/eul:

bndexch.F90 - support for inactive processes in dynamics (communication restricted to 
   active processes)
comspe.F90 - support for inactive processes in dynamics (wave number decomposition 
   only over active processes)
realloc4.F90 - support for inactive processes in dynamics (communication restricted to 
   active processes for grid-point/spectral transposes)
realloc7.F90 - support for inactive processes in dynamics (array initialization)
scan2.F90 - support for inactive processes in dynamics (array initialization)
scanslt.F90 - support for inactive processes in dynamics (communication restricted to 
   active processes for halo updates)
spmd_dyn.F90 - support for inactive processes in dynamics (defining decomposition, 
   assigning zero work to idle processes, and adding new namelist options to control active 
   process placement)

src/dynamics/sld:

comspe.F90 - support for inactive processes in dynamics (wave number decomposition 
   only over active processes)
realloc4.F90 - support for inactive processes in dynamics (communication restricted to 
   active processes for grid-point/spectral transposes)
realloc7.F90 - support for inactive processes in dynamics (array initialization)
scan2.F90 - support for inactive processes in dynamics (array initialization)
scanslt.F90 - support for inactive processes in dynamics (defining decomposition, 
   communication restricted to active processes for halo updates)
spmd_dyn.F90 - support for inactive processes in dynamics (defining decomposition, 
   assigning zero work to idle processes, and adding new namelist options to control active 
   process placement)

src/dynamics/homme:

spmd_dyn.F90 - adding new EUL/SLD namelist arguments in spmd_dyn_defaultopts 
   and spmd_dyn_setopts (as no-ops)

models/utils/pilgrim:

mod_comm.F90 - numerous changes to support different sized decompositions and 
   multiple communicators
parutilitesmodule.F90 - numerous changes to support different sized decompositions and 
   multiple communicators
puninterfaces.F90 - add communicator to calls

models/ocn/dom:

ocn_spmd.F90 - corrected comments

models/ice/csim4:

ice_spmd.F90 - corrected comments

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: br532 (known failure)

tempest: br531 (known failure)

bangkok/lf95: br511 (known failure)

CAM tag used for the baseline comparison tests if different than previous
tag: 3_5_08; actually, this tag 3_5_10 and 3_5_09 are identical except
for the ChangeLog file

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

Answers are BFB except for 0.5-deg and 0.25-deg FV due to different
tuning parameters.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
Tag name: cam3_5_09
See tag cam3_5_10; only difference between 3_5_10 and 3_5_09 is ChangeLog file.
===============================================================

Tag name: cam3_5_08
Originator(s): andrew, eaton
Date: Wed Aug 15 15:44:58 MDT 2007
One-line Summary: add Morrison-Gettleman microphysics code; 2-bin sea salt optics

Purpose of changes:

. The Morrison-Gettleman microphysics code has been added as an option to
  replace the default Rasch-Kristjansson microphysics.  To enable this
  option:
  -- configure must add 2 additional constituents.  If no other optional
     constituents are enabled then the number of constituents needs to be
     increased from its default value of 3 to 5 via setting the configure 
     arg "-nadv 5".
  -- set the namelist variable microp_scheme='MG'

. An option to produce radiation fields used to diagnose the indirect
  effect has been added.  It is off by default.  To enable it set the
  namelist variable indforce=.true.

. The aerosol optics for sea salt has been changed to use 2 sea salt size
  bins.  The previous sea salt optics assumed only 1 bin.  This results in
  larger than roundoff changes to the climate simulation.

. Add restart and baseline tests to the regression suite for running with
  the MG microphysics enabled.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: added microp_scheme and indforce

List any changes to the defaults for the boundary datasets: 

. add default CLM fsurdat files for 0.23x0.31 and 0.47x0.63 resolutions

Describe any substantial timing or memory changes: none (new microphysics
  not on by default)

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/physics/cam/cldwat2m.F90
. new MG microphysics parameterization

models/atm/cam/test/system/config_files/f10c5dm
models/atm/cam/test/system/nl_files/microp_mg
. new tests for MG microphysics

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/physics/cam/cloud_fraction.F90
models/atm/cam/src/physics/cam/phys_control.F90
models/atm/cam/src/physics/cam/physics_types.F90
models/atm/cam/src/physics/cam/pkg_cldoptics.F90
models/atm/cam/src/physics/cam/radsw.F90
models/atm/cam/src/physics/cam/stratiform.F90
. mods for MG microphysics

models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
models/atm/cam/src/physics/cam/aer_optics.F90
models/atm/cam/src/physics/cam/aerosol_index.F90
models/atm/cam/src/physics/cam/aerosol_intr.F90
models/atm/cam/src/physics/cam/aerosol_radiation_interface.F90
models/atm/cam/src/physics/cam/prescribed_aerosols.F90
models/atm/cam/src/physics/cam/seasalt_intr.F90
. mods for 2-bin sea salt optics

models/atm/cam/src/control/runtime_opts.F90
. add namelist variables microp_scheme and indforce

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. clarify long_names of precip fields

models/atm/cam/src/physics/cam/radiation.F90
. add radiation calc for indirect effect diagnostics

models/atm/cam/src/physics/cam/sulchem.F90
. limiter to keep pH positive

models/atm/cam/src/physics/cam/wetdep.F90
. bound variable fracev

models/atm/cam/src/physics/cam/zm_conv.F90
. remove unused variable conke

models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
. add fsurdat defaults for 0.23x0.31 and 0.47x0.63 resolutions

models/atm/cam/bld/Makefile.in
. modify linux section to allow not specifying the mpi location when
  SPMD=TRUE 

models/atm/cam/test/system/input_tests_master
models/atm/cam/test/system/tests_posttag_calgary
models/atm/cam/test/system/tests_posttag_lightning
models/atm/cam/test/system/tests_pretag_bangkok
. add new tests for MG microphysics

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all PASS except

004 bl132 TBL.sh e32sdh ghgrmp 4s .................................FAIL! rc= 7
006 bl133 TBL.sh e32pdh aqpgro 2s .................................FAIL! rc= 7
011 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
015 bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
017 bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
023 bl336 TBL.sh wm4h outfrq2h 4s .................................FAIL! rc= 7
026 bl337 TBL.sh f4dh fv2d_8tsk 4s ................................FAIL! rc= 7
028 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
031 bl354 TBL.sh fm2dh outfrq2h 4s ................................FAIL! rc= 7
034 bl355 TBL.sh fmo2dh off2x2.5 4s ...............................FAIL! rc= 7
038 bl381 TBL.sh fma1.9h outfrq2h+1870_prog_aero 4s ...............FAIL! rc= 7
042 bl382 TBL.sh fmgpa1.9h outfrq2h+1870_control 4s ...............FAIL! rc= 7
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
046 bl532 TBL.sh s32sdh ghgrmp 4s .................................FAIL! rc= 7
053 bl551 TBL.sh s64h outfrq24h 2d ................................FAIL! rc= 7

tempest: all PASS except

004 bl131 TBL.sh e32dh co2rmp 4s ..................................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 4s .................................FAIL! rc= 7
009 bl133 TBL.sh e32pdh aqpgro 2s .................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h 2d ................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq2h 4s ...............................FAIL! rc= 7
021 bl331 TBL.sh f4gdh co2rmp 4s ..................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
035 bl531 TBL.sh s32dh co2rmp 4s ..................................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 4s .................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h 2d ................................FAIL! rc= 7

bangkok/lf95: all PASS except

004 bl111 TBL.sh e8c8mdm ttrac 4s .................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 4s ..................................FAIL! rc= 7
010 bl113 TBL.sh e8pdm aqpgro 2s ..................................FAIL! rc= 7
012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
016 bl311 TBL.sh f10c8mdm ttrac 4s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 4s .................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 2s .................................FAIL! rc= 7
029 bl315 TBL.sh f10c5dm microp_mg 4s .............................FAIL! rc= 5
032 bl317 TBL.sh f10dm fv2d_4tsk 4s ...............................FAIL! rc= 7
034 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 5
037 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11
038 bl511 TBL.sh s8c8mdm ttrac 4s .................................FAIL! rc= 7
042 bl512 TBL.sh s8sdm ghgrmp 4s ..................................FAIL! rc= 7
046 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7


These are the expected results.  The baseline tests fail due to the change
in the sea salt optical treatment.  The SLD branch test failures are a
pre-existing problem.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: 
- what code configurations: default
- what platforms/compilers: all
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): larger than roundoff, but same climate

10 year runs were done (by Andrew Gettleman) with cam3_5_04 and
nmicro2_3_cam3_5_04 in their default configurations.  The only difference
between these runs is the treatment of sea salt optical properties (use 2
size bins instead of 1).  The output from the AMWG diagnostics package is
here:
http://www.cgd.ucar.edu/cms/andrew/diag/nmicro2_3_cam3_5_04_2-cam3_5_04

===============================================================
===============================================================

Tag name: cam3_5_07
Originator(s): eaton, mirin, fvitt
Date: Tue Aug 14 13:38:57 MDT 2007
One-line Summary: increase max number of history fields; modify
  tracer_suite; add namelist utility; fix cyclic mode

Purpose of changes:

. Increase size of master field list.  This was needed to allow running a
  CCSM configuration that turns on full trop_mozart chemistry.

  Also made a couple of changes to eliminate adding names to the master
  field list that have no corresponding outfld calls.

. Fix a bug in trop_mozart data reading code.  This affects performance but
  the answers are identical.

. Modifications to the tracers_suite module to allow easily creating many
  test tracers.  The original 5 tracers (which have no emission, source, or
  sink terms) are copied as many time as necessary to produce the requested
  number of test tracers.

  This option is used by setting the configure -nadv option to the total
  number of advected tracers, and by setting the namelist variable
  tracers_flag=.true.  The total number of test tracers will be the number
  set by the -nadv option, minus the number present by default (the water
  substance tracers) and the number registered by any other packages.

. Utility code has been added which will position an input file at the
  first record of a specified namelist group.  This simplifies reading a
  specific namelist from an input file that contains multiple namelists.

Bugs fixed (include bugzilla ID): #563

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

. The size of the history master field list was increased.
. The size of the primary hash table for the master field list was
  increased.

  Note that the primary reason these data array sizes need to be increased
  is that there are 10 or so diagnostic fields that occur for each
  constituent, and they are registered in the master list whether the
  diagnostic is being computed or not.  Better control logic needs to be
  added to the diagnostic code so that these fields are not registered in
  the master list unless the diagnostic is going to be computed and written
  to a history file.

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/src/utils/namelist_utils.F90
. add utility code to search for a specified namelist group name in an
  input file and leave the file positioned at the record containing that
  group name

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/control/cam_history.F90
. increase pflds to 10000
. increase tbl_hash_pri_sz_lg2 to 16.

models/atm/cam/src/control/runtime_opts.F90
. use subroutine find_group_name from new namelist_utils module to find the
  cam_inparm namelist group in the input file.

models/atm/cam/src/dynamics/fv/dyn_comp.F90
. comment out addfld calls for per constituent diagnostics of 
  hadvnam, vadvnam, tendnam, fixcnam.  There are no matching outfld calls
  for these fields.  (The spectral cores do have outfld calls for these
  fields.) 

models/atm/cam/src/physics/cam/cam_diagnostics.F90
. if diag_cnst_conv_tend='none' or 'q_only' don't add the per constituent
  names for DCxxxx to the master field list

models/atm/cam/src/physics/cam/constituents.F90
. add cnst_num_avail function to return the number of available slots in
  the constituent array.

models/atm/cam/src/physics/cam/tracers_suite.F90
. modify to enable up to 999 copies of each of the 5 basic tracer types.
  That's a total of up to 5000 tracers.

models/atm/cam/src/physics/cam/tracers.F90
. modify tracers_register to query the constituent module for the number of
  available slots in the constituent array, and to register test tracers in
  all available slots.  This assumes that the test tracers are registering
  last.

models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
. bug fix for cyclic mode.  

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except

045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: All PASS except

034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: All PASS except

034 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

These are expected failures.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: none.

===============================================================
===============================================================

Tag name: cam3_5_06
Originator(s): mvertens
Date: Mon Aug  6 10:07:59 MDT 2007
One-line Summary: cam and surface components may now couple every cam time step

Purpose of changes: There is now the capability to have cam and the surface components
couple every cam time step. This capability can be invoked by simply setting the 
namelist variable, atm_cpl_dt in drv_in equal to the cam timestep (by default it is
set to 3600 seconds). The default behavior of the system is to still couple on the
cam shortwave radiation timestep. All tests have maintained this behavior. 

Bugs fixed (include bugzilla ID): 493

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None expected

Code reviewed by: myself

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

M  SVN_EXTERNAL_DIRECTORIES
   - updated models/lnd/clm code to pftintdat08_clm3_5_05 (modified lnd_comp_mct.F90 to permit
     either hourly coupling or coupling on the cam time step)
   - update drv/seq_mct code to drvseq1_0_42 (seq_flux_mct.F90 only does
     albedo calculation for ocn or ice if nextsw_cday is not -1
M  models/atm/cam/src/control/atm_comp_mct.F90
   - put in capability to couple either on the short wave radiative time step or
     every cam time step
M  atm/cam/src/control/ccsm_msg.F90
   - one line fix for bugzilla #493

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
	
tempest:
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11	
	
bangkok/lf95:
034 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bit-for-bit with cam3_5_05.
In addition, bfb restults with cam3_4_15 can be shown with coupling
every cam timestep, if the cam3_4_15 ice_comp.F90 code is modified
such that the zenith angle is updated on the timestep before cam needs
the albedos (as is done in clm).

===============================================================
===============================================================

Tag name: cam3_5_05
Originator(s): eaton
Date: Tue Jul 24 09:17:11 MDT 2007
One-line Summary: add use case for 1990 control.  bug fixes.

Purpose of changes:

. add use case for 1990 control runs to build namelist

Bugs fixed (include bugzilla ID):

. fix bug in configure's -test option

. fix bug in setting nlend

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/use_cases/1990_control.nl
. ghg values, ozone, and aerosol datasets for 1990.

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add 1990_control as use case

models/atm/cam/bld/configure
. fix bug in configure's -test option

models/atm/cam/src/control/atm_comp_mct.F90
. fix bug in setting nlend

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all PASS except

045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: all PASS except

034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: all PASS except

034 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

These branch test failures are pre-existing.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bit-for-bit

===============================================================
===============================================================

Tag name:  cam3_5_04
Originator(s): mvr,rneale,jrichter
Date: 18 Jul 2007
One-line Summary: Addition of convective momentum transport fixes 
plus tuning parameter updates

Purpose of changes: a bug was discovered in the cmt code and 
energy balancing was required for the spinup of biogeochemistry 
3.5 coupled runs

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: rneale,jrichter

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      cloud_fraction.F90
- tuning of cloud parameters
M      zm_conv_intr.F90
M      zm_conv.F90
- cmt bug fixes

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

blueice:
bl132 TBL.sh e32sdh ghgrmp 4s .................................FAIL! rc= 7
bl133 TBL.sh e32pdh aqpgro 2s .................................FAIL! rc= 7
bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
bl336 TBL.sh wm4h outfrq2h 4s .................................FAIL! rc= 7
bl337 TBL.sh f4dh fv2d_8tsk 4s ................................FAIL! rc= 7
bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
bl354 TBL.sh fm2dh outfrq2h 4s ................................FAIL! rc= 7
bl355 TBL.sh fmo2dh off2x2.5 4s ...............................FAIL! rc= 7
bl381 TBL.sh fma1.9h outfrq2h+1870_prog_aero 4s ...............FAIL! rc= 7
bl382 TBL.sh fmgpa1.9h outfrq2h+1870_control 4s ...............FAIL! rc= 7
br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
bl532 TBL.sh s32sdh ghgrmp 4s .................................FAIL! rc= 7
bl533 TBL.sh s32pdh aqpgro 2s .................................FAIL! rc= 7
bl551 TBL.sh s64h outfrq24h 2d ................................FAIL! rc= 7

tempest:
bl131 TBL.sh e32dh co2rmp 4s ..................................FAIL! rc= 7
bl132 TBL.sh e32sdh ghgrmp 4s .................................FAIL! rc= 7
bl133 TBL.sh e32pdh aqpgro 2s .................................FAIL! rc= 7
bl152 TBL.sh e64o outfrq24h 2d ................................FAIL! rc= 7
bl314 TBL.sh wg10dh outfrq2h 4s ...............................FAIL! rc= 7
bl331 TBL.sh f4gdh co2rmp 4s ..................................FAIL! rc= 7
bl332 TBL.sh f4sdh ghgrmp 4s ..................................FAIL! rc= 7
bl333 TBL.sh f4pdh aqpgro 2s ..................................FAIL! rc= 7
bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
bl531 TBL.sh s32dh co2rmp 4s ..................................FAIL! rc= 7
bl532 TBL.sh s32sdh ghgrmp 4s .................................FAIL! rc= 7
bl533 TBL.sh s32pdh aqpgro 2s .................................FAIL! rc= 7
bl552 TBL.sh s64o outfrq24h 2d ................................FAIL! rc= 7

bangkok/lf95:
bl111 TBL.sh e8c8mdm ttrac 4s .................................FAIL! rc= 7
bl112 TBL.sh e8sdm ghgrmp 4s ..................................FAIL! rc= 7
bl113 TBL.sh e8pdm aqpgro 2s ..................................FAIL! rc= 7
bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 7
bl311 TBL.sh f10c8mdm ttrac 4s ................................FAIL! rc= 7
bl312 TBL.sh f10sdm ghgrmp 4s .................................FAIL! rc= 7
bl313 TBL.sh f10pdm aqpgro 2s .................................FAIL! rc= 7
bl317 TBL.sh f10dm fv2d_4tsk 4s ...............................FAIL! rc= 7
bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11
bl511 TBL.sh s8c8mdm ttrac 4s .................................FAIL! rc= 7
bl512 TBL.sh s8sdm ghgrmp 4s ..................................FAIL! rc= 7
bl513 TBL.sh s8pdm aqpgro 2s ..................................FAIL! rc= 7
bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 7

-all baseline tests (other than ideal physics or adiabatic tests) were 
 expected to fail...the branch test with sld has been failing for reasons 
 unrelated to this commit

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change :  new climate!

If bitwise differences were observed, how did you show they were no worse
than roundoff?  
- cmt mods were validated in a 10yr stand-alone cam run using cam3_3_3
- tuning mods are being validated in a 18mo F run, using ccsm3_5_beta06 
  plus the mods for this commit
- climate to be verified in an upcoming 50yr ccsm coupled run

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_5_03
Originator(s): eaton, fvitt, jwolfe
Date: Thu Jul  5 18:58:40 MDT 2007
One-line Summary: Vertical interp of prescribed constituents modified; PGI
 compiler workarounds; tuning mod; new dust optics.

Purpose of changes:

. Use hybrid coefficients and surface pressure if available to
  construct a pressure field to vertically interpolate the prescribed
  constituents.  Otherwise use the variable "lev" to vertically
  interpolate the prescribed constituents.  (fvitt)

. Mod to cam_diagnostics so that diagnostics needed by the AMWG package are
  always on the default history file.

. Mod to check_energy so that when printing of detailed column by column
  conservation errors is on (it's off by default), it's on for all
  processes and not just the masterproc.

. Tuning mod: reduce rhminh from .80 to .79

. Add default 30 level initial files for FV, 1.9x2.5, for running w/ UW
  PBL scheme.

. Change CLM to branch_tags/pftintdat06_clm3_5_05/.  This provides a fix
  for effective porosity having zero values, which apparently was not
  affecting the simulation, but was preventing us from running some tests
  in debug mode.

. PGI compiler (6.2-5) was failing to recognize aliases made in use statements.
  Workaround by using CAM's physconst module in place of share_const_mod. (jwolfe)

  Also modify code to avoid creating zero length substrings which are
  causing problems for the pgi compiler.

. Update the aerosol optics file.  The new file is backwards compatible
  with the previous one when using the old prescribed aerosol distributions
  (which is still the default).  It contains new optics for the prognostic
  dust (and the new prescribed dust) due to differences in how the size
  distribution is binned.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

. SVN_EXTERNAL_DIRECTORIES
  - change CLM to branch_tags/pftintdat04_clm3_5_04

. models/atm/cam/src/chemistry/trop_mozart/tracer_cnst.F90
  - remove '_trcnst' suffix from fields output by this module

. models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
  - mods to use PS in vertical interpolation if present

. models/atm/cam/src/control/wrap_nf.F90
  - add optional arg to wrap_inq_varid to allow return of control to caller
    rather than just aborting if a variable isn't in the netcdf file
  - add wrap_get_scalar_realx

. models/atm/cam/src/physics/cam/aer_optics.F90
  - replace the netcdf variable names *_dust by *_dust_pres
  - replace the netcdf variable names *_dust_mod by *_dust_prog
  - The get variable id call for abs_cff_mss_aer needs the same logic
    as the shortwave optics.  
    Use abs_cff_mss_aer_prog for the prognostic and new prescribed dust, and
    abs_cff_mss_aer for the old prescribed dust.

. models/atm/cam/src/physics/cam/cam_diagnostics.F90
  - Mod to cam_diagnostics so that diagnostics needed by the AMWG package are
    always on the default history file.

. models/atm/cam/src/physics/cam/check_energy.F90
  - remove "if (masterproc)" from prints in check_energy_chng

. models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
. models/atm/cam/src/chemistry/trop_mozart/prescribed_ozone.F90
. models/atm/cam/src/chemistry/trop_mozart/tracer_cnst.F90
  - use physconst module instead of shr_const_mod.  This is a workaround for
    a PGI compiler problem encountered on jaguar.

. models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
  - Mod to avoid creating zero length substring.  Using the zero length 
    substring in a fortran intrinsic function resulted in an allocation 
    error using pgi6.2-5.

. models/atm/cam/src/physics/cam1/cloud_fraction.F90
  - change rhminh from .80 to .79

. models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
  - add initial files for FV, 1.9x2.5, 30 levels, Jan 1 and Sep 1 start dates. 
  - update aeroptics file to use AerosolOptics_c060817nat.nc

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

028 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
031 bl354 TBL.sh fm2dh outfrq2h 4s ................................FAIL! rc= 7
034 bl355 TBL.sh fmo2dh off2x2.5 4s ...............................FAIL! rc= 7
038 bl381 TBL.sh fma1.9h outfrq2h+1870_prog_aero 4s ...............FAIL! rc= 7
042 bl382 TBL.sh fmgpa1.9h outfrq2h+1870_control 4s ...............FAIL! rc= 7
045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11

tempest: All PASS except:

031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11

bangkok/lf95: All PASS except:

031 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7
034 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11

. The branch tests br511, br531, br532 also failed in the previous tag.

. The baseline tests bl381 and bl382 fail due to
  - the vertical interpolation change for prescribed constituents
  - new CAM tuning for FV 1.9x2.5 and 2x2.5
  - new dust optics

. The baseline tests bl375, bl376, bl377 failed due to
  - new CAM tuning for FV 1.9x2.5 and 2x2.5

. The baseline tests bl354 and bl355 failed due to
  - new CAM tuning for FV 1.9x2.5 and 2x2.5
  - new dust optics

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except for FV 1.9x2.5 and 2x2.5 due
 to CAM tuning, and all trop_mozart_* runs due to new dust optics.

===============================================================
===============================================================

Tag name: cam3_5_02
Originator(s): bundy
Date: Fri Jun 29 08:30:08 MDT 2007
One-line Summary: Modifications to UW PBL scheme (non-default option)

Purpose of changes: Update the version of the UW PBL scheme in CAM to
the latest from the UW development group.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/src/physics/cam/mcshallow.F90
M      models/atm/cam/src/physics/cam/convect_shallow.F90
M      models/atm/cam/src/physics/cam/cloud_fraction.F90
M      models/atm/cam/src/physics/cam/eddy_diff.F90
M      models/atm/cam/src/physics/cam/vertical_diffusion.F90
All changes affect only the CAM UW scheme (shallow convection and eddy
diffusivity).

  

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.


bluevista: 045 br532 TBR.sh s32sdh ghgrmp 4+2s
 ...............................FAIL! rc= 11

tempest:   034 br531 TBR.sh s32dh co2rmp 4+2s
................................FAIL! rc= 11

bangkok/lf95: 034 br511 TBR.sh s8c8mdm ttrac 4+2s
...............................FAIL! rc= 11

These tests are expected to fail although the branch capability that
is being tested is apparently okay. 


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: 
  None to default CAM
  New climate for UW PBL configuration

===============================================================

Tag name: cam3_5_01
Originator(s): mvertens
Date: Thu Jun 28 09:50:19 MDT 2007
One-line Summary: CAM now couples to surface components only on shortwave timestep

Purpose of changes:

* The following changes force CAM to couple to the surface components on
  its shortwave radiation timestep only (currently this is hourly). This
  is the same coupling constraint that is currently used in ccsm
  mode. CAM now averages its output precipitation fluxes over the hour
  period and receives hourly averaged fluxes from the surface
  components. All states exchanged between CAM and the surface
  componenents are instantaneous. CAM also sends to all the surface
  components the calendar to use for the next zenith angle contribution
  to the albedo computation.

* The CAM-csim and CAM-dom/som components now have an hourly timestep
  and only calculate the albedos hourly. Previously, the CAM-csim and
  CAM-dom/som components updated the zenith angle every CAM timestep,
  which was incorrect, since CAM was updating its zenith angle only
  hourly (i.e. on the shortwave radiation computation).

* As a result of these changes, the CCSM CICE and DOCN7 componenents can
  now couple to CAM via the sequential driver (either on the CAM grid or
  on the displaced pole grid). CICE and DOCN7 will now be checked out
  with the CAM code and a new script in the bld directory,
  run-pc-cice-docn7.csh, accompanies this tag. This script permits CAM
  to couple to CICE/DOCN7 at T31 (thermodynamic ice mode only) or at
  T31_gx3v5.  Furthermore, the DOCN7 can be run either in prescribed SST
  mode or som mode. This script is a starting point for bringing the
  CCSM ice and ocn surface components into stand-alone CAM.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:

* Changed the specification of coupling fields so that only one file is
  needed now, seq_flds_mod.F90. Optional coupling fields are now
  specified via the use of CPP directives in this file (i.e. GENSOM,
  DUST, PROGSSLT). This removes the needed for a different file and
  therefore a different filepath for every new coupling scenario. Changed
  configure to reflect this modification.

* Changed configure to permit the addition of CICE and DOCN7 as alternative
  ice and ocean components. The following new options can be provided to configure
     -ocn <name>        Build CAM with data SSTs or slab ocean model [dom | som | docn7]
     -ice <name>        Build CAM with sea ice model [csim4 | cice]

* If cice is selected for the -ice option then the following additional settings can be added
     -cice_nbx <n>      Number of cice blocks in x on 1 processor (default 4)
     -cice_nby <n>      Number of cice blocks in y on 1 processor (default 4)
     -cice_nlon <n>     Number of ocean/ice longitudes (only used for cice/docn7)
     -cice_nlat <n>     Number of ocean/ice latitudes  (only used for cice/docn7)
     -cice_ntasks <n>   Number of MPI tasks used to set cice block decomposition (default not set)

Describe any changes made to the namelist:

* The atm_cpl_dt is now set to 3600 by default in DefaultTIMEMGR_INPARM_Namelist.xml

* In additin, in SeqCCSM_namelist.pm, the coupling frequency of all
  components is now set to atm coupling frequency. In the future the ocn
  component (i.e. POP2) will be allowed to couple at a different
  frequency.

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None expected (not tested yet)

Code reviewed by: myself, Brian Eaton, Erik Kluzek

List all subroutines eliminated:
  (all removed files  are in the testing system and described below)

List all subroutines added and what they do:
  (all added files are in the testing system and described below)

List all existing files that have been modified, and describe the changes:

M      SVN_EXTERNAL_DIRECTORIES
       - updated to the following externals
            models/drv/seq_mct             https://svn-ccsm-models.cgd.ucar.edu/drv/seq_mct/trunk_tags/drvseq1_0_37
            models/lnd/clm2/src            https://svn-ccsm-models.cgd.ucar.edu/clm2/trunk_tags/clm3_5_04/src
            models/ice/cice/src            https://svn-ccsm-models.cgd.ucar.edu/cice/trunk_tags/cice4_0_20070605/src
            models/ocn/docn7               https://svn-ccsm-models.cgd.ucar.edu/docn7/trunk_tags/docn7_070605
            models/csm_share               https://svn-ccsm-models.cgd.ucar.edu/csm_share/trunk_tags/share3_070626
            models/utils/esmf_wrf_timemgr  https://svn-ccsm-models.cgd.ucar.edu/esmf_wrf_timemgr/trunk_tags/esmf_wrf_timemgr_060616
            models/utils/timing            https://svn-ccsm-models.cgd.ucar.edu/timing/trunk_tags/timing_070525
            models/utils/mct               https://svn-ccsm-models.cgd.ucar.edu/mct/trunk_tags/MCT2_3_0_070524
        - note that lnd_comp_mct.F90 now performs time averages over the coupling interval for its output fluxes)
        - note that the cice and docn7 timesteps are hourly)
        - note that seq_flds_mod.F90 i drvseq1_0_37 has a different specification for optional fields, see above)
        - note that driver sync clock is advanced at the beginning of the time step now

M      models/ocn/dom/ocn_filenames.F90
       - removed previous interface and put in new interface for
         specifying restart filename from input year, month, day, secs
M      models/ocn/dom/ocn_time_manager.F90
       - time step is no longer advanced on restart
M      models/ocn/dom/ocn_comp.F90
       - sync clock dtime is now the atm coupling interval (1 hour) and not
         the atm time step
       - no longer read FLAND as option (not needed)
       - restart filename determined from sync clock time and no longer from rsfilename_spec_ocn
M      models/ocn/dom/ocn_comp_mct.F90
       - since driver sync clock is advanced at the beginning of the time step now, check of internal
         clock with sync clock is now made at the end of ocn_run_mct        

M      models/ocn/som/ocn_filenames.F90
       - removed previous interface and put in new interface for
         specifying restart filename from input year, month, day, secs
M      models/ocn/som/ocn_time_manager.F90
       - time step is no longer advanced on restart
M      models/ocn/som/ocn_comp.F90
       - sync clock dtime is now the atm coupling interval (1 hour) and not
         the atm time step
       - no longer read FLAND as option (not needed)
       - restart filename determined from sync clock time and no longer from rsfilename_spec_ocn
M      models/ocn/som/ocn_comp_mct.F90
       - since driver sync clock is advanced at the beginning of the time step now, check of internal
         clock with sync clock is now made at the end of ocn_run_mct        

M      models/ice/csim4/ice_filenames.F90
       - removed previous interface and put in new interface for
         specifying restart filename from input year, month, day, secs
M      models/ice/csim4/ice_types.F90
       - added fswabs to ice_out derived type
M      models/ice/csim4/ice_srf.F90
       - added fsns update for dom mode (currently only done for som mode) 
M      models/ice/csim4/ice_comp.F90
       - sync clock dtime is now the atm coupling interval (1 hour) and not
         the atm time step
       - restart filename determined from sync clock time and no longer from rsfilename_spec_ice
M      models/ice/csim4/albice.F90
       - removed zenith angle calculation from code (now done independently in driver as is the case
         in cpl6
       - note again that ice zenith angle and albedo now updated only on the atm/surface model coupling interval,
         (i.e. cam sw radiation) and not every cam time step
M      models/ice/csim4/ice_comp_mct.F90
       - the merge to ocean now multiplies melth by aice (to be able to couple in cice) - so now divide melth by
         aice in the ice_import_mct routine since the merge to ocn will now multiply it back in
       - since driver sync clock is advanced at the beginning of the time step now, check of internal
         clock with sync clock is now made at the end of ice_run_mct        

M      models/atm/cam/src/control/atm_comp_mct.F90
       - removed all references to infobuf (shr_intputInfo will now be used for this information)
       - CAM now returns control to the driverafter it completes its shortwave radiation computation (i.e. hourly).
         However, since the sw computation is done one timestep into the hour (except for SLD), the CAM time
         will generally be shifted relative to the sync clock time step by one CAM timestep. As a result, 
         if iradsw is not 1, then an offset of -dtime is used to check consistency with sync clock at the 
         end of atm_run_mct routine.
       - CAM now averages precipation between coupling intervals and sends averaged precipitation back to the
         surface components (as is done in cpl6). 
       - CAM sends calendar day of next radation computation back to the surface components, and albedos will be
         computed for the surface components utilizing this calendar day.
       - restart filenames are now set by the sync clock date and not by the CAM internal date (see below)
M      models/atm/cam/src/control/filenames.F90
M      models/atm/cam/src/control/cam_restart.F90
M      models/atm/cam/src/control/cam_comp.F90
M      models/atm/cam/src/control/cam_history.F90
M      models/atm/cam/src/physics/cam/restart_physics.F90
       - for above five routines, now pass in 
         [yr_spec, mon_spec, day_spec, sec_spec] 
         as optional arguments to set the name of the restart file 
         (this will enable restart file name to trigger off of  the sync clock time 
         rather than the internal cam time, which for non-sld mode will be shifted by 
         a time step ahead of the sync clock time)
M      models/atm/cam/src/utils/time_manager.F90
       - removed dtime_in as argument (note that for cam_comp.F90, dtime_cam is no longer
         passed as an argument to eshr_timemgr_clockGet, but is now set to get_step_size()
         after the call to timemgr_init

M      models/atm/cam/bld/configure
A  +   models/atm/cam/bld/run-pc-cice-docn7.csh
M      models/atm/cam/bld/DefaultTIMEMGR_INPARM_Namelist.xml
M      models/atm/cam/bld/timemgr_inparm.pm
M      models/atm/cam/bld/SeqCCSM_namelist.pm
M      models/atm/cam/bld/config_definition.xml
       - see above description of bld changes

M      models/atm/cam/test/system/TSB.ccsm.sh
D      models/atm/cam/test/system/config_files/fmo2m
D      models/atm/cam/test/system/config_files/f2c11m
D      models/atm/cam/test/system/config_files/e128m
A  +   models/atm/cam/test/system/config_files/f4gdh
D      models/atm/cam/test/system/config_files/f4c11gdh
D      models/atm/cam/test/system/config_files/e128c11m
A  +   models/atm/cam/test/system/config_files/fma1.9h
D      models/atm/cam/test/system/config_files/fm1.9m
D      models/atm/cam/test/system/config_files/f1.9pm
D      models/atm/cam/test/system/config_files/e32c11dh
D      models/atm/cam/test/system/config_files/s32c11dh
A  +   models/atm/cam/test/system/config_files/fmgpa1.9h
D      models/atm/cam/test/system/config_files/e128pm
M      models/atm/cam/test/system/TCT.ccsm.sh
D      models/atm/cam/test/system/tests_posttag_phoenix
M      models/atm/cam/test/system/TBR.sh
D      models/atm/cam/test/system/tests_posttag_bluesky
D      models/atm/cam/test/system/tests_pretag_bluesky
M      models/atm/cam/test/system/TER.sh
M      models/atm/cam/test/system/test_driver.sh
D      models/atm/cam/test/system/posttag_cron_bluesky.sh
M      models/atm/cam/test/system/tests_pretag_bluevista
M      models/atm/cam/test/system/nl_files/ghgrmp
D      models/atm/cam/test/system/nl_files/outfrq3s
M      models/atm/cam/test/system/nl_files/aqpgro
M      models/atm/cam/test/system/nl_files/adia
M      models/atm/cam/test/system/nl_files/idphys
A  +   models/atm/cam/test/system/nl_files/co2rmp
M      models/atm/cam/test/system/nl_files/fv2d_4tsk
M      models/atm/cam/test/system/nl_files/scm_prep
D      models/atm/cam/test/system/nl_files/pghgsul
M      models/atm/cam/test/system/nl_files/off2x2.5
M      models/atm/cam/test/system/nl_files/no_ttrac
M      models/atm/cam/test/system/nl_files/fv2d_8tsk
A  +   models/atm/cam/test/system/nl_files/outfrq2h
M      models/atm/cam/test/system/nl_files/ttrac_lb1
M      models/atm/cam/test/system/nl_files/ttrac_lb2
M      models/atm/cam/test/system/nl_files/ttrac
M      models/atm/cam/test/system/nl_files/ttrac_lb3
M      models/atm/cam/test/system/tests_posttag_blueice
M      models/atm/cam/test/system/input_tests_master
D      models/atm/cam/test/system/tests_posttag_robin
M      models/atm/cam/test/system/CAM_runcmnd.sh
M      models/atm/cam/test/system/TSM.sh
       - the above testing changes needed to account for the fact that atm->surface
         component coupling only occurs on the cam shortwave radiation time
         step and that the GENSOM and DUST fields transferred no longer involve a 
         change to the filepath but rather require the specification of a CPP variable

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
   045 br532 TBR.sh s32sdh ghgrmp 4+2s ...............................FAIL! rc= 11
   (note that the branch actually was bfb, but a history restart file was written on
   the initial part of this run, giving rise to a fail status for this test)

tempest:
   034 br531 TBR.sh s32dh co2rmp 4+2s ................................FAIL! rc= 11
   (note that the branch actually was bfb, but a history restart file was written on
   the initial part of this run, giving rise to a fail status for this test)

calgary/lf95:
   034 br511 TBR.sh s8c8mdm ttrac 4+2s ...............................FAIL! rc= 11
   (note that the branch actually was bfb, but a history restart file was written on
   the initial part of this run, giving rise to a fail status for this test)

Summarize any changes to answers:
- what code configurations: 
    NOTE ***all SLD configurations will be  bfb with cam3_4_15***
    NOTE ***all non-SLD runs are larger than roundoff but same climate (see below) ***
- what platforms/compilers: All
- nature of change: larger than roundoff but same climate

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced:
- source tag (all code used must be in the repository):
    hourly coupling: https://svn-ccsm-models.cgd.ucar.edu/cam1/branch_tags/seqflxave_cam3_4_01_tags/seqflxave10_cam3_4_11   
    control: https : https://svn-ccsm-models.cgd.ucar.edu/cam1/branch_tags/conv_cam3_4_03_tags/conv09_cam3_4_03    
- platform/compilers: 
    ibm-sp( blueice )
- configure commandline:
    configure -spmd -smp -dyn fv -res 1.9x2.5 -ocn dom  (for hourly_cpl-f1.9m_conv09 below)
    configure -spmd -smp -dyn fv -res 1.9x2.5 -ocn som  (for hourly_cpl_som-cam_som below)
- build-namelist command (or complete namelist):
  for dom:
   $cfgdir/build-namelist -s -case $case -runtype $runtype -config $blddir/config_cache.xml \
    -namelist "&camexp mss_irt=0 stop_option='nmonths', stop_n=$stop_n doisccp=.true. fincl1='CLDST' \
     ncdata='/fis/cgd/cms/rneale/cam_mydata/atm/cam3_2_59_bvc.cam2.i.0023-01-01-00000.nc' start_ymd=101 \
     restart_pfile='$rundir/rpointer.drv' rest_pfile='$rundir/rpointer.cam' /  \
     &dom_inparm rest_pfile='$rundir/rpointer.dom' / \
     &som_inparm rest_pfile='$rundir/rpointer.som' / \
     &csim_inparm rest_pfile='$rundir/rpointer.csim' / \
     &clmexp rpntpath='$rundir/rpointer.clm' \
     finidat='/fs/cgd/csm/inputdata/lnd/clm2/inidata_3.1/ccsm/clmi_0000-01-01_1.9x2.5_gx1v4_c070311.nc' /" \
     || echo "build-namelist failed" && exit 1
   for som:
   $cfgdir/build-namelist -s -case $case -runtype $runtype -config $blddir/config_cache.xml \
    -namelist "&camexp mss_irt=0 stop_option='nmonths', stop_n=$stop_n doisccp=.true. fincl1='CLDST' \
     ncdata='/fis/cgd/cms/rneale/cam_mydata/atm/cam3_2_59_bvc.cam2.i.0023-01-01-00000.nc' start_ymd=101 \
     bndtvs='/fis/cgd/cseg/people/mvr/cam_mydata/som/cam3_4_11_with_correct_pft_0000-0020_qflux.nc' \
     restart_pfile='$rundir/rpointer.drv' rest_pfile='$rundir/rpointer.cam' /  \
     &dom_inparm rest_pfile='$rundir/rpointer.dom' / \
     &som_inparm rest_pfile='$rundir/rpointer.som' / \
     &csim_inparm rest_pfile='$rundir/rpointer.csim' / \
     &clmexp rpntpath='$rundir/rpointer.clm' \
     finidat='/fs/cgd/csm/inputdata/lnd/clm2/inidata_3.1/ccsm/clmi_0000-01-01_1.9x2.5_gx1v4_c070311.nc' /" \
     || echo "build-namelist failed" && exit 1
MSS location of output:
     /MVR/csm/seqflxave10_cam3_4_11/hour_cpl
     /MVR/csm/seqflxave10_cam3_4_11/hour_cpl_som
MSS location of control simulations used to validate new climate:
    *** to be filled in by mvr ***
URL for AMWG diagnostics output used to validate new climate:
   http://www.cgd.ucar.edu/cms/rneale/runs/cam/hourly_cpl-f1.9m_conv09
   http://www.cgd.ucar.edu/cms/rneale/runs/cam/hourly_cpl_som-cam_som


===============================================================

Tag name: cam3_4_15
Originator(s): eaton, fvitt
Date: Fri Jun 15 15:30:19 MDT 2007
One-line Summary: mod to trop_mozart boundary dataset reader

Purpose of changes:

. Modify the dataset reader in the trop_mozart tracer_data module so that the
  dataset does not need a time coordinate variable.  This reader is being used
  for oxidant datasets that use an integer date variable instead of a time
  coordinate. 

. update the use case "1870_prog_aero" to specify that the oxidant dataset
  should be treated as cyclic for year 1870.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

. models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
  - mod to relax requirement that datasets have a time coordinate variable

. models/atm/cam/bld/use_cases/1870_prog_aero.nl
  - specify the oxidant dataset as cyclic.  The earlier version of
    tracer_data.F90 didn't support a cyclic dataset option.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE

===============================================================
===============================================================

Tag name: cam3_4_14
Originator(s): eaton, fvitt
Date: Fri Jun  8 10:42:45 MDT 2007
One-line Summary: add initial file; trop_mozart prescribed aerosol bug fix

Purpose of changes:

. Add an FV 1.9x2.5 initial file valid for Jan 01 which is the initial date
  normally used for CCSM runs.

. Changed the 1870 use cases for build-namelist to start simulations in
  year 0 rather than 1870, which is the convention for climatological runs.

Bugs fixed (include bugzilla ID):

. Apply bug fix from Francis to the trop_mozart prescribed aerosol code
  (fix the molecular weights of the aerosol species).

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

. models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
  - add Jan 1 initial file for FV 1.9x2.5

. models/atm/cam/bld/use_cases/1870_control.nl
. models/atm/cam/bld/use_cases/1870_prog_aero.nl
  - Removed the setting start_ymd=18700901 from these files which are used to
    implement the build-namelist use cases.  So by default the simulations
    will start in year 0 which is the convention for climatological runs.

. models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_imp_sol.F90
  - new preprocessor output -- doesn't affect prescribed aerosols

. models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_sim_dat.F90
. models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_sim_dat.F90
  - fix molecular weights of aerosol species

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: none

===============================================================
===============================================================

Tag name: cam3_4_13
Originator(s): eaton, fvitt
Date: Tue Jun  5 09:26:59 MDT 2007
One-line Summary: updates to trop_mozart; add build-namelist use cases; misc bug fixes

Purpose of changes: 

. Updates to trop_mozart code to assume constituents use dry mass mixing
  ratios (fvitt).

. Fix the sea salt mass passed to the aerosol optics code by summing masses
  from the 4 sea salt bins into the 1 bin currently used by the optics
  (fvitt).

. Add new chemistry option which includes a simple GHG chemistry (CH4, N2O,
  CFC11, CFC12) in addition to the prescribed aerosols.  This is intended
  to replace the simple GHG chemistry that was enabled in CAM by setting
  the namelist variable trace_gas=.true..  This option is set by invoking
  configure with the arg "-chem trop_mozart_ghg_paero".  This option
  additionally allows reading the prescribed ozone from a 3D dataset which
  is spatially interpolated to the model grid.  (fvitt)

. Add ability to cycle the prescribed aerosol datasets.  This is needed for
  the 1870 and present day control runs. (fvitt)

. Add "-use_case" option to build-namelist to provide a single switch for
  setting up runs that require setting many namelist parameters.  Two use
  cases have been implemented:
  1870_prog_aero -- sets up run that was used to produce the 1870 aerosol
                    climatology 
  1870_control   -- sets up the 1870 control run which uses a simple GHG
                    chemistry, the 1870 prescribed aerosol climatology, an
                    1870 prescribed ozone climatology, and sets the solar
                    constant to 1366.5 W/m^2

. Update to mct/trunk_tags/MCT2_3_0_070524.  This fixes a memory leak.

. Update to timing/trunk_tags/timing_070525.  This fixes a problem with the
  timers that caused a seg fault on lightning (w/ pathscale) when a t_stopf
  call was made without a matching t_startf.

Bugs fixed (include bugzilla ID):

. defineqflux was broken on 64-bit platforms due to stdlib.h not being
  included (it's needed to provide the correct declaration of malloc).

. Fix compilation failure on IBM when compiling for pure OMP.

Describe any changes made to build system: none

Describe any changes made to the namelist:

. New namelist vars for trop_mozart chemistry
  character(len=16)  :: prescribed_ozone_name     ! prescribed ozone field name in netCDF
  character(len=256) :: prescribed_ozone_file     ! prescribed ozone file
  character(len=256) :: prescribed_ozone_filelist ! list of prescribed data files (series of files)
  character(len=256) :: prescribed_ozone_datapath ! absolute path of prescribed data files 
  character(len=8)   :: prescribed_ozone_type     ! 'CYCLICAL' | 'SERIAL' (default)
  logical :: prescribed_ozone_rmfile              ! remove data file from local disk (default .false.)
  integer :: prescribed_ozone_ymd                 ! yyyymmdd - start date of the prescribed data (default is current model date)
  integer :: prescribed_ozone_tod                 ! start time of day (seconds) of the prescribed data (default is current model time)
  character(len=256) :: tracer_cnst_datapath      ! absolute path of prescribed data files 
  character(len=8)   :: tracer_cnst_type          ! 'CYCLICAL' | 'SERIAL' (default)
  character(len=256) :: tracer_srcs_datapath      ! absolute path of prescribed data files 
  character(len=8)   :: tracer_srcs_type          ! 'CYCLICAL' | 'SERIAL' (default)

List any changes to the defaults for the boundary datasets:

. Defaults have been changed for emission datasets used by trop_mozart_aero
  to match the datasets used to produce the prescribed aerosol distributions
  to be used in future CCSM simulations.

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/config_defaults_trop_mozart_ghg_paero.xml
models/atm/cam/src/chemistry/trop_mozart/mo_ghg_chem.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_lu_solve.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_setrxt.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/m_rxt_id.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_phtadj.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_nln_matrix.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_adjrxt.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/m_het_id.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_lu_factor.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_indprd.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_sim_dat.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/m_spc_id.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_imp_sol.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/chem_mods.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_prod_loss.F90
models/atm/cam/src/chemistry/trop_mozart_ghg_paero/mo_lin_matrix.F90
. implement new trop_mozart_ghg_paero chemistry option

models/atm/cam/src/chemistry/trop_mozart/prescribed_ozone.F90
. allows trop_mozart options to read the 3D prescribed ozone datasets and
  spatially interpolate them to the model grid.

models/atm/cam/bld/use_cases/1870_prog_aero.nl
. implements the use case 1870_prog_aero

models/atm/cam/bld/use_cases/1870_control.nl
. implements the use case 1870_control

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/build-namelist
. add "-use_case" commandline arg to be used to specify a use case
. add use case for 1870_prog_aero
. add use case for 1870_control
. add "-ignore_ic_year" commandline arg.  This is analogous to the
  -ignore_ic_date option except that the month/day part of the date are
  still matched.  This allows a run starting at 18700901 to use a
  climatological initial file with a date 901.

models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
. update names of some trop_mozart_aero files
. add prescribed aerosol dataset for 1870 climatology

models/atm/cam/bld/cam_inparm.pm
. changed defaults so that prognostice aerosols are radiatively passive
. update trop_mozart_aero
. update trop_mozart_prescribed_aero
. add trop_mozart_ghg_paero

models/atm/cam/bld/config_definition.xml
models/atm/cam/bld/configure
. add new -chem option trop_mozart_ghg_paero 

models/atm/cam/bld/SeqCCSM_namelist.pm
. add code to build method to parse the namelist file that's providing the
  use case defaults

models/atm/cam/bld/compnl.pm
. modify attribute matching in defaults files to allow only a month/day
  match of the ic_ymd attribute

models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
. specify dry mmr when adding constituents

models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
. fix mass calculations to assume dry mixing ratios
. sum the masses of the 4 sea salt constituents to provide the single sea
  salt bin requested by current radiative optics package.

models/atm/cam/src/chemistry/trop_mozart/tracer_cnst.F90
. fix mass to volume mixing ratio conversions to assume dry mixing ratios

models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
. add fix to init of file%filenames
. Replace hardcoded Fortran unit numbers by calls to the shr_file_getUnit
  and shr_file_freeUnit routines in the shr_file_mod module.
. add '/' separator between path and fname parts of filepath.

models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
models/atm/cam/src/chemistry/trop_mozart/mo_fstrat.F90
models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
models/atm/cam/src/chemistry/trop_mozart/mo_mean_mass.F90
models/atm/cam/src/chemistry/trop_mozart/mo_sulf.F90
models/atm/cam/src/chemistry/trop_mozart/mo_tropopause.F90
models/atm/cam/src/chemistry/trop_mozart/rad_cnst_data_interface.F90
models/atm/cam/src/chemistry/trop_mozart/tracer_cnst.F90
models/atm/cam/src/chemistry/trop_mozart/tracer_data.F90
models/atm/cam/src/chemistry/trop_mozart/tracer_srcs.F90
. mods for trop_mozart_ghg_paero package

models/atm/cam/src/control/runtime_opts.F90
. remove initialization of scon from preset.  Move to cam_control_mod.F90.
. add namelist variables for reading prescribed ozone
. add namelist variables to specify whether the prescribed data is serial
  or cyclical

models/atm/cam/src/control/cam_control_mod.F90
. add initializer for scon (1367 W/m^2)

models/atm/cam/src/control/ccsm_msg.F90
. Move the t_startf/t_stopf calls to fix a bug that resulted from the calls
  to t_adj_detailf(+2) during initialization (this prevented a t_startf
  call from being made in initialization whose matching t_stopf call during
  the run phase then became unmatched).

models/atm/cam/src/dynamics/fv/dyn_comp.F90
. Move !$omp directive inside the SPMD ifdef at line 1392.  Otherwise a
  syntax error (on ibm) was encountered when compiling for no SPMD.

models/atm/cam/tools/defineqflux/timediddle_mavg.c
. Include the stdlib.h header file -- needed for correct malloc declaration.

models/drv/seq_mct/seq_flux_mct.F90
. Move calls to mct_gGrid_exportRAttr so they are only called once rather
  than every step.  This avoids a memory leak discovered in the mct code.
  It's also a better to just make these calls once even without a memory
  leak. 


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

037 bl354 TBL.sh fm2dh outfrq3s 9s ................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7

These baseline tests should fail due to changing the treatment of constituents
by trop_mozart from wet to dry mixing ratio.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB except for trop_mozart_* chemistry

===============================================================
===============================================================

Tag name: cam3_4_12
Originator(s): Francis Vitt, eaton
Date: Wed May  2 16:02:20 MDT 2007
One-line Summary: 
    Addition of prescribed aerosols chemistry package with changes 
    to dust and trop_mozart external forcings.

Purpose of changes:  
    The new chemistry package and code changes are needed to be able to
    read the prescribed aerosol distributions that will be generated by
    runs with the prognostic aerosol package which was added at cam3_4_11.
    Note that both new aerosol packages are undergoing testing and 
    should not be used for scientific purposes.  CAM by default is still
    using the CAM-3.0 prescribed aerosol climatology.

    Update CLM to clm3_4_1.

    Update the CLM namelist defaults file.

Bugs fixed (include bugzilla ID): 
   - vertical emissions altitude (external forcing) is now set to
     height relative to surface     
   - trop_mozart interactive dry deposition broadcast days of 
     climatological soil water data to all MPI tasks 

Describe any changes made to build system: 
   chemistry option added to configure script
	-chem trop_mozart_prescribed_aero

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:
    Update the CLM namelist defaults to use the correct PFT file, 
    the latest fsurdat file for FV 1.9x2.5, and a fully spun up IC file
    for FV 1.9x2.5.

Describe any substantial timing or memory changes: not yet tested...

Code reviewed by:  Brian Eaton, Francis Vitt

List all subroutines eliminated:

List all subroutines added and what they do:
--- models/atm/cam/bld/config_defaults_trop_mozart_prescribed_aero.xml
      needed to configure new trop_mozart_prescribed_aero chemistry package

--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_lu_solve.F90       
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_setrxt.F90         
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/m_rxt_id.F90          
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_phtadj.F90         
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_nln_matrix.F90     
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_adjrxt.F90         
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/m_het_id.F90          
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_lu_factor.F90      
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_indprd.F90         
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_sim_dat.F90        
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/m_spc_id.F90          
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_imp_sol.F90        
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/chem_mods.F90         
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_prod_loss.F90      
--- models/atm/cam/src/chemistry/trop_mozart_prescribed_aero/mo_lin_matrix.F90     
      code files for the new trop_mozart_prescribed_aero chemistry package

List all existing files that have been modified, and describe the changes:
--- models/atm/cam/bld/configure 
--- models/atm/cam/bld/config_definition.xml    
      added -chem trop_mozart_prescribed_aero configure option

--- models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml   
--- models/atm/cam/bld/cam_inparm.pm    
      default namelist settings for the trop_mozart_prescribed_aero chemistry

--- models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml   
      new PFT file, updated fsurdat file for FV 1.9x2.5, new spun-up IC
      file for FV 1.9x2.5

--- models/atm/cam/src/control/runtime_opts.F90 
      replaced pcnst with MAXTRCS to allow then number of prescribed tracers
      to excede the number of prognostic tracers

--- models/atm/cam/src/physics/cam/dust_intr.F90      
      Natalie's tuned dust module  

--- models/atm/cam/src/physics/cam/aerosol_radiation_interface.F90     
      allow radiative feedbacks from prescribed aerosols 

--- models/atm/cam/src/chemistry/trop_mozart/mo_setext.F90
--- models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90    
      invoke external forcing routine (vert emis) with relative height      

--- models/atm/cam/src/chemistry/trop_mozart/mo_tropopause.F90  
      don't do anything if trop_mozart does not solve for any species (gascnt < 1) 

--- models/atm/cam/src/chemistry/trop_mozart/mo_sulf.F90        
      don't do anything if trop_mozart does not have any "user" reactions 

--- models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90     
      changed some log messages

--- models/atm/cam/src/chemistry/trop_mozart/tracer_cnst.F90    
      changed some log messages      

--- models/atm/cam/src/chemistry/trop_mozart/mo_extfrc.F90      
      added diagnostic output to history

--- models/atm/cam/src/chemistry/trop_mozart/chemistry.F90  
      chem_is_active = .false. if imozart < 1    

--- models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90      
      don't try to open data files if number of dry dep tracers is zero
      MPI broadcast days of the climatology soil data

--- models/atm/cam/src/chemistry/trop_mozart_aero/mo_setrxt.F90 
      change rates of CB1->CB2 and OC1->OC2 transitions

--- models/atm/cam/src/chemistry/trop_mozart_aero/mo_imp_sol.F90   
      xnox species added to preprossor -- no real change for trop_mozart_aero     

--- models/atm/cam/src/chemistry/trop_mozart_aero/chem_mods.F90 
      preprocessor changes for label rxt rates output -- no real change for trop_mozart_aero

--- SVN_EXTERNAL_DIRECTORIES    
      new CLM external

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
037 bl354 TBL.sh fm2dh outfrq3s 9s ................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
  Changes to the dust caused changes to the chemical species via the 
  interactive photolysis rates which in turn changed radiation 
  feedbacks via the sulfur aerosol cycle.

tempest: All Pass

bangkok/lf95: All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:  cam3_4_11 with the CLM namelist defaults modified to use the same new
      files as this tag so that the baseline tests would pass.

Summarize any changes to answers: BFB except for trop_mozart 

===============================================================
===============================================================

Tag name: cam3_4_11
Originator(s): eaton, fvitt
Date: Fri Apr 20 16:40:53 MDT 2007
One-line Summary: mods to deep convection, cloud fraction and aerosols;
                  update CLM and timing lib externals

Purpose of changes:

. Add dilute plume and convective momentum transport mods from Neale and
  Richter to ZM deep convection parameterization.

. Add a call to the cloud fraction routine after pcond (cloud microphysics)
  and move the outfld calls for the cloud fraction fields to be after this
  new call to cldfrc (Sungsu Park).

. Add the Vavrus "freeze dry" mod.

. Update to latest timing library tag (timing_070328).  This fixes the
  regression tests that were failing on tempest.

. Update to the latest CLM trunk tag (clm3_expa_98).

. The initial version of a new aerosol package is included, but should not
  be used for scientific purposes.  It will be updated shortly with mods
  required to produce an acceptable aerosol simulation.

. Add debug flags for pathscale to fix a problem with the regression tests
  on lightning (fix from Jim Edwards).

. Update the sample run scripts (from Mat Rothstein)

Bugs fixed (include bugzilla ID): 

 ID 409 - aqua-planet tests in cam3_4_04 fail on tempest
 ID 434 - fix fsnsoi gensom problem

Describe any changes made to build system:

. the new aerosol package is enabled by specifying "-chem trop_mozart_aero"
  to configure

Describe any changes made to the namelist: 

. some emissions datasets names have been added to build-namelist, but the
  datasets have not yet been moved to the standard locations.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

models/atm/cam/bld/config_defaults_trop_mozart_aero.xml
. configuration file for new chemistry package

models/atm/cam/src/chemistry/trop_mozart_aero/chem_mods.F90
models/atm/cam/src/chemistry/trop_mozart_aero/m_het_id.F90
models/atm/cam/src/chemistry/trop_mozart_aero/m_rxt_id.F90
models/atm/cam/src/chemistry/trop_mozart_aero/m_spc_id.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_adjrxt.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_imp_sol.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_indprd.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_lin_matrix.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_lu_factor.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_lu_solve.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_nln_matrix.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_phtadj.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_prod_loss.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_setrxt.F90
models/atm/cam/src/chemistry/trop_mozart_aero/mo_sim_dat.F90
. source code for new chemistry package

List all existing files that have been modified, and describe the changes:

SVN_EXTERNALS_DIRECTORIES
. update CLM and timing lib externals

models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
. new files for trop_mozart_aero package

models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
. update fsurdat file for FV 1.9x2.5 only

models/atm/cam/bld/cam_inparm.pm
. add support for trop_mozart_aero namelist vars

models/atm/cam/bld/config_definition.xml
models/atm/cam/bld/configure
. add "trop_mozart_aero" option to -chem arg of configure

models/atm/cam/bld/Makefile.in
. add -trapuv -Wuninitialized to debug flags for pathf90

models/atm/cam/bld/run-ibm.csh
models/atm/cam/bld/run-pc.csh
models/atm/cam/bld/run-sgi.csh
models/atm/cam/bld/run-lightning.csh
models/atm/cam/bld/run-darwin.csh
. updates to the sample run scripts

models/atm/cam/src/chemistry/trop_mozart/mo_airplane.F90
models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
models/atm/cam/src/chemistry/trop_mozart/mo_extfrc.F90
models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
models/atm/cam/src/chemistry/trop_mozart/mo_setext.F90
models/atm/cam/src/chemistry/trop_mozart/mo_strato_sad.F90
models/atm/cam/src/chemistry/trop_mozart/mo_sulf.F90
models/atm/cam/src/chemistry/trop_mozart/mo_usrrxt.F90
models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
models/atm/cam/src/physics/cam/sulchem.F90
. mods for new chem package

models/atm/cam/src/physics/cam/cloud_fraction.F90
. add Vavrus "freeze dry" mod

models/atm/cam/src/physics/cam/physconst.F90
. add some constants for water (values from shr_const_mod)

models/atm/cam/src/physics/cam/radiation.F90
. remove concld from dummy args of radiation_tend -- use physics buffer

models/atm/cam/src/physics/cam/stratiform.F90
. remove concld from dummy args of stratiform_tend -- use physics buffer
. add call to cldfrc after pcond
. move outfld calls for cloud fraction fields to after cldfrc after pcond

models/atm/cam/src/physics/cam/tphysbc.F90
. remove local var concld as actual arg to stratiform_tend and
  radiation_tend calls

models/atm/cam/src/physics/cam/zm_conv.F90
. add mods for convective momentum transport and dilute plumes

models/atm/cam/src/physics/cam/zm_conv_intr.F90
. add calls for convective momentum transport to zm_conv_tend
. add diagnostic output

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

014 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
018 bl331 TBL.sh f4c11gdh pghgsul 9s ..............................FAIL! rc= 7
034 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
056 bl711 TBL.sh h5x8dm adia 9s ...................................FAIL! rc= 7

. The Eulerian and FV baselines fail (bl151, bl375) due to a roundoff diff in
  a single diagnostic field (SWCF) introduced at cam3_4_07

. The HOMME baseline fails (bl711) due to answer changes introduced at cam3_4_10.

. The FV baseline that tests the gensom mode (bl331) fails due to the gensom
  bugfix.

tempest: All PASS except:

021 bl331 TBL.sh f4c11gdh pghgsul 9s ..............................FAIL! rc= 7

. bl331 fails for the same reason as on bluevista.

. Note that updating to the new timing lib fixed the problems with the
  aqua-planet tests.

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag: conv09_cam3_4_03 -- *** NOTE *** this tag was used for baseline
     comparisons to validate that the new physics was merged from the
     branch to the trunk correctly.  All baseline tests that exercise the
     standard physics will fail when this code is compared to cam3_4_10.

Summarize any changes to answers, i.e.,
- what code configurations: All that use standard cam physics
- what platforms/compilers: All
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): new climate

If bitwise differences were observed, how did you show they were no worse
than roundoff? N.A.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository): conv09_cam3_4_03
- platform/compilers: CrayXT (jaguar) / pgi-6.2.5 (-fast optimization)
- configure commandline:

  configure -fc ftn -dyn fv -res 1.9x2.5 -fopt "-fast" -spmd -nosmp -cppdefs "-DCATAMOUNT"

- build-namelist command (or complete namelist):

  build-namelist -s -case f1.9m_conv09 -config $blddir/config_cache.xml \
	-namelist "&camexp start_type='startup' stop_option='nmonths' stop_n=1
                   mss_irt=0 restart_option='monthly' restart_n=1
                   phys_loadbalance=2 npr_yz=32,8,8,32
                   rest_pfile='./rpointer.cam' /
                   &clmexp rpntpath='./rpointer.clm' 
                   finidat='/tmp/work/eaton/inputdata/clmi_0000-09-01_1.9x2.5_gx1v4_c070311.nc' /"

- MSS location of output:

  Only climo files used to produce AMWG diagnostics were saved.
  mss:/EATON/CASE/conv09_cam3_4_03/f1.9m_conv09/climo_0001-0006.tar

MSS location of control simulations used to validate new climate:

  This run was compared against the simulation done with conv07_cam3_4_03
  mss:/EATON/CASE/conv07_cam3_4_03/f1.9h_conv07/climo_0001-0006.tar

URL for AMWG diagnostics output used to validate new climate:

  http://www.cgd.ucar.edu/cms/rneale/runs/cam/cam3_4_03_conv09-cam3_4_03_conv07/


===============================================================
===============================================================

Tag name: cam3_4_10
Originator(s):  Jim Edwards
Date: 4-16-07
One-line Summary: Fix problems commited in cam3_4_09

Purpose of changes: cam3_4_09 had problems which made it unusable

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
models/atm/cam/src/dynamics/fv/inidat.F90
models/atm/cam/src/physics/cam/co2_cycle.F90 
models/atm/cam/src/control/ncdio_atm.F90 

Fixed formatting and module use errors that managed to get past the 
precommit testing for cam3_4_09 
	
models/atm/cam/test/system/CAM_runcmnd.sh
models/atm/cam/test/system/test_driver.sh
fixes to test system on bangkok
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:   All passed except:
    bl711 TBL.sh h5x8dm adia 9s  
	 HOMME Dycore test expected failure due to restructuring

tempest: all pass except
008 sm133 TSM.sh e32pdh aqpgro 3s .................................FAIL! rc= 8
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 4
025 sm333 TSM.sh f4pdh aqpgro 3s ..................................FAIL! rc= 8
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 4
039 sm533 TSM.sh s32pdh aqpgro 3s .................................FAIL! rc= 8
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 4

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:  cam3_4_08

Summarize any changes to answers, i.e.,
	- what code configurations: - what platforms/compilers: - nature
	of change (roundoff; larger than roundoff but same climate; new
	climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_4_09 
Originator(s): Jim Edwards 
Date:  04-13-07
One-line Summary:  Merge of HOMME dycore development branch

Purpose of changes: Update with latest HOMME development

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

Code reviewed by: myself, Eaton

List all subroutines eliminated:  
D    models/atm/cam/src/dynamics/homme/external/math_constants.F90
D    models/atm/cam/src/dynamics/homme/external/stats.h
D    models/atm/cam/src/dynamics/homme/external/preq_init_mod.F90
D    models/atm/cam/src/dynamics/homme/external/utils_mod.F90
D    models/atm/cam/src/dynamics/homme/external/locate.F90
D    models/atm/cam/src/dynamics/homme/external/torus_mod.F90
D    models/atm/cam/src/dynamics/homme/external/stats.F90
D    models/atm/cam/src/dynamics/homme/external/field_mod.F90
D    models/atm/cam/src/dynamics/homme/external/types_mod.F90
D    models/atm/cam/src/dynamics/homme/external/generic_list.F90
D    models/atm/cam/src/dynamics/homme/external/ref_state_mod.F90
D    models/atm/cam/src/dynamics/homme/external/vertex_mod.F90
D    models/atm/cam/src/dynamics/homme/external/rotation_init.F90
D    models/atm/cam/src/dynamics/homme/external/vertical_mod.F90
D    models/atm/cam/src/dynamics/fv/xpavg.F90
	
List all subroutines added and what they do:
A    models/atm/cam/src/dynamics/homme/external/prim_driver_mod.F90
     driver module for the HOMME dycore
A    models/atm/cam/src/utils/xpavg_mod.F90
     moved from dynamics/fv/xpavg.F90 to facilitate use in ncdio.F90
	
List all existing files that have been modified, and describe the changes:
U    models/atm/cam/test/system/config_files/h5x8dm
U    models/atm/cam/bld/DefaultCTL_NL_Namelist.xml
     Added -lapack_libdir argument and modified namelist for h5xdm testcase

U    models/atm/cam/src/control/ncdio_atm.F90
U    models/atm/cam/src/control/startup_initialconds.F90
U    models/atm/cam/src/control/cam_comp.F90
U    models/atm/cam/src/physics/cam/aer_optics.F90
U    models/atm/cam/src/physics/cam/physpkg.F90
U    models/atm/cam/src/physics/cam/prescribed_aerosols.F90
U    models/atm/cam/src/physics/cam/phys_buffer.F90
U    models/atm/cam/src/physics/cam/phys_grid.F90
U    models/atm/cam/src/dynamics/sld/inidat.F90
U    models/atm/cam/src/dynamics/sld/inital.F90
U    models/atm/cam/src/dynamics/eul/inidat.F90
U    models/atm/cam/src/dynamics/eul/inital.F90
U    models/atm/cam/src/dynamics/fv/inidat.F90
U    models/atm/cam/src/dynamics/fv/p_d_adjust.F90
U    models/atm/cam/src/dynamics/fv/inital.F90
     moved initialization of fields used only in physics from 
     dynamics/*/inidat.F90 to physpkg.F90 and moved around 
     initialization to handle this change this allowed us to remove
     code duplicated for each dycore and avoid a special case for HOMME
     initialization.  However a special case was inserted in ncdio.F90 
     for the fv core initialization to handle the pole average scheme 
     xpavg.F90, this was done to maintain bfb results with that core. 

U    models/atm/cam/src/physics/cam/co2_cycle.F90
     fixed a bug in constituent initialization
	
U    models/atm/cam/src/dynamics/homme/external/flops_mod.F90
U    models/atm/cam/src/dynamics/homme/external/filter_mod.F90
U    models/atm/cam/src/dynamics/homme/external/diffusion_mod.F90
U    models/atm/cam/src/dynamics/homme/external/mass_matrix_mod.F90
U    models/atm/cam/src/dynamics/homme/external/forcing_mod.F90
U    models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
U    models/atm/cam/src/dynamics/homme/external/cg_mod.F90
U    models/atm/cam/src/dynamics/homme/external/reduction_mod.F90
U    models/atm/cam/src/dynamics/homme/external/schedule_mod.F90
U    models/atm/cam/src/dynamics/homme/external/spacecurve_mod.F90
U    models/atm/cam/src/dynamics/homme/external/derivative_mod.F90
U    models/atm/cam/src/dynamics/homme/external/prim_si_mod.F90
U    models/atm/cam/src/dynamics/homme/external/gridgraph_mod.F90
U    models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
U    models/atm/cam/src/dynamics/homme/external/metagraph_mod.F90
U    models/atm/cam/src/dynamics/homme/external/dimensions_mod.F90
U    models/atm/cam/src/dynamics/homme/external/surfaces_mod.F90
U    models/atm/cam/src/dynamics/homme/external/quadrature_mod.F90
U    models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
U    models/atm/cam/src/dynamics/homme/external/coordinate_systems_mod.F90
U    models/atm/cam/src/dynamics/homme/external/cube_mod.F90
U    models/atm/cam/src/dynamics/homme/external/control_mod.F90
U    models/atm/cam/src/dynamics/homme/external/interpolate_mod.F90
U    models/atm/cam/src/dynamics/homme/external/linear_algebra_mod.F90
U    models/atm/cam/src/dynamics/homme/external/element_mod.F90
U    models/atm/cam/src/dynamics/homme/external/prim_si_ref_mod.F90
U    models/atm/cam/src/dynamics/homme/external/time_mod.F90
U    models/atm/cam/src/dynamics/homme/external/hybvcoord_mod.F90
U    models/atm/cam/src/dynamics/homme/external/baroclinic_inst_mod.F90
U    models/atm/cam/src/dynamics/homme/external/checksum_mod.F90
U    models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
U    models/atm/cam/src/dynamics/homme/external/edge_mod.F90
U    models/atm/cam/src/dynamics/homme/external/ll_mod.F90
U    models/atm/cam/src/dynamics/homme/external/thread_mod.F90
U    models/atm/cam/src/dynamics/homme/external/dof_mod.F90
U    models/atm/cam/src/dynamics/homme/external/physical_constants.F90
U    models/atm/cam/src/dynamics/homme/external/solver_mod.F90
U    models/atm/cam/src/dynamics/homme/external/timer.h
U    models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
U    models/atm/cam/src/dynamics/homme/external/bndry_mod.F90
U    models/atm/cam/src/dynamics/homme/external/timer_mod.F90
U    models/atm/cam/src/dynamics/homme/external/metis_mod.F90
U    models/atm/cam/src/dynamics/homme/external/hybrid_mod.F90
U    models/atm/cam/src/dynamics/homme/dyn_grid.F90
U    models/atm/cam/src/dynamics/homme/initcom.F90
U    models/atm/cam/src/dynamics/homme/dp_coupling.F90
U    models/atm/cam/src/dynamics/homme/stepon.F90
U    models/atm/cam/src/dynamics/homme/inidat.F90
U    models/atm/cam/src/dynamics/homme/dyn_comp.F90
U    models/atm/cam/src/dynamics/homme/restart_dynamics.F90
U    models/atm/cam/src/dynamics/homme/inital.F90

     A cleanup and restructuring of the HOMME dycore interface.  
     Variables that do not need to be exposed to the model interface
     are now hidden.   A number of subroutines that are not used by
     cam have been removed.
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:   All passed except:
    bl711 TBL.sh h5x8dm adia 9s  
	 HOMME Dycore test expected failure due to restructuring
	
tempest:  All passed except problems carried over from previous commit: 
008 sm133 TSM.sh e32pdh aqpgro 3s .................................FAIL! rc= 8
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 4
025 sm333 TSM.sh f4pdh aqpgro 3s ..................................FAIL! rc= 8
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 4
039 sm533 TSM.sh s32pdh aqpgro 3s .................................FAIL! rc= 8
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 4

bangkok/lf95: All passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_4_08
Originator(s): mvr, eaton
Date: 29 Mar 2007

One-line Summary:
svn external definitions simplified; changes to ccsm testing from within cam; 
directory name change: physics/cam1 -> physics/cam; ccsm filepath will now 
be identical to stand-alone cam; several unrelated bug fixes

Purpose of changes:
attempting to clean up some long standing issues with regards to multiple 
external definitions for a single component and directory structure 
differences between ccsm and stand-alone cam...this will help with testing 
ccsm from within cam
	
Bugs fixed (include bugzilla ID): 420 & 425

Describe any changes made to build system: 
ccsm filepath now identical to stand-alone cam...the external definitions for
ccsm tags using this cam tag (and thereafter) will need to reflect these mods

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: mvr, eaton

List all subroutines eliminated:
D      models/atm/cam/src/physics/cam1 
- directory and contents moved to ~physics/cam

List all subroutines added and what they do:
A      models/atm/cam/src/physics/cam
- directory and contents moved from ~physics/cam1

List all existing files that have been modified, and describe the changes:
 M     .
M      SVN_EXTERNAL_DIRECTORIES
- condensed number of external definitions; now pulling in all csm_share code
M      models/ocn/dom/ocn_comp_mct.F90
- bug fix for restart_option="none" (bug# 425)
M      models/atm/cam/test/system/TSB.ccsm.sh
- mod to run ccsm tests in regular queue by default rather than premium
M      models/atm/cam/test/system/TCT.ccsm.sh
- mods to run ccsm tests either with just the cam code from users sandbox or
  with all available sandbox code if env var is set
M      models/atm/cam/test/system/test_driver.sh
- will now grab latest ccsm tag in 3_5 beta sequence for testing; increase 
  job time for posttag testing on lightning
M      models/atm/cam/test/system/tests_posttag_bluevista
M      models/atm/cam/test/system/tests_pretag_bluevista
M      models/atm/cam/test/system/tests_posttag_blueice
- change default test lists to move all ccsm testing to posttag
M      models/atm/cam/bld/configure
- mods to support directory name change of physics/cam1 -> physics/cam;
  ccsm filepath will now be the same as for stand-alone cam
M      models/atm/cam/src/control/cam_history.F90
- bug fix for restarts of fixed length intervals (bug# 420)
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all PASS

tempest: 
008 sm133 TSM.sh e32pdh aqpgro 3s .................................FAIL! rc= 8
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 4
025 sm333 TSM.sh f4pdh aqpgro 3s ..................................FAIL! rc= 8
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 4
039 sm533 TSM.sh s32pdh aqpgro 3s .................................FAIL! rc= 8
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 4
- carried over from previous commit

bangkok/lf95: all PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_4_07
Originator(s): John Truesdale
Date: 
One-line Summary: SCM mode cleanup and additional namelist 
	functionality

Purpose of changes: replace scm specific netcdf routines with
	standard model calls and add surface forcing functionality
	to scm cam mode.  Also added hooks for relaxation to 
	obs and column radiation only modes to scm.

Bugs fixed (include bugzilla ID): na

Describe any changes made to build system: na

Describe any changes made to the namelist:  Added some new
	namelist variables for control of single column mode
	of scam.  New namelist variables are
	scm_iop_srf_prop = .TRUE. if using iop surface properties
	scm_relaxation   = .TRUE. if relaxing solution back to obs
	scm_diurnal_avg  = .TRUE. currently just a place holder for 
	                   diurnal averaging
        scm_crm_mode     = .TRUE. run scm in column radiation mode

List any changes to the defaults for the boundary datasets: na

Describe any substantial timing or memory changes: na

Code reviewed by: truesdale

List all subroutines eliminated: 

	getnetcdfdata.F90 - extracted the setlatlonidx functionality from this
	                    routine and got rid of the rest.  Created new
			    subroutine for setlatlonidx.

List all subroutines added and what they do:

	setlatlonidx.F90 - determines closest boundary dataset lat lon to
	                   that specified in the namelist for single column mode.

List all existing files that have been modified, and describe the changes:

	The following changes removed scam specific netcdf code and
	replaced it with standard cam netcdf calls.

	models/atm/cam/src/control/ncdio_atm.F90
	models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90
	models/atm/cam/src/physics/cam1/iop.F90
	models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
	models/lnd/clm2/src/biogeochem/STATICEcosysDynMod.F90
	models/lnd/clm2/src/main/iniTimeConst.F90
	models/lnd/clm2/src/main/ncdio.F90
	models/lnd/clm2/src/main/surfrdMod.F90
	models/ice/csim4/ice_data.F90
	models/ocn/dom/sst_data.F90
	

	The following changes added new scm functionality to CAM.

	models/atm/cam/src/control/atm_comp_mct.F90
	models/atm/cam/src/control/history_scam.F90
	models/atm/cam/src/control/runtime_opts.F90
	models/atm/cam/src/control/scamMod.F90
	models/atm/cam/src/dynamics/eul/dynpkg.F90
	models/atm/cam/src/dynamics/eul/forecast.F90
	models/atm/cam/src/physics/cam1/physics_types.F90
	models/atm/cam/src/physics/cam1/physpkg.F90
	models/atm/cam/src/physics/cam1/radiation.F90
	models/atm/cam/src/physics/cam1/radlw.F90
	models/atm/cam/src/physics/cam1/radsw.F90


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
	035 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
	059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

	Notes:  test 059 is a known failure for the last few commits.
	        test 035 failed on the history tape compare for one value of one 
	                 the SWCF field. I reran the test per Eaton's suggestion 
	                 compiling with debug on and it passed.  Conclusion is 
	                 that the models are bit for bit in the prognostics but
	                 because of a compiler optimization are getting a least
	                 significant bit flip in one diagnostic field.

tempest:
	008 sm133 TSM.sh e32pdh aqpgro 3s .................................FAIL! rc= 8
	009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 4
	025 sm333 TSM.sh f4pdh aqpgro 3s ..................................FAIL! rc= 8
	026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 4
	039 sm533 TSM.sh s32pdh aqpgro 3s .................................FAIL! rc= 8
	040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 4

	These aquaplanet tests are known failures for the previous few commits.

bangkok/lf95:
	All tests pass

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_4_06

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): bit-for-bit on all platforms.  One roundoff diagnostic on bluevista
	which subsequently passed when run with debug turned on.

If bitwise differences were observed, how did you show they were no worse
than roundoff?  Turn on debug and they went away.  Also the difference in
	absolute values was in the least significant bit of one number in
	the domain.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_4_06
Originator(s): eaton
Date: Wed Mar 14 12:12:51 MDT 2007
One-line Summary: refactor configure script

Purpose of changes:

. Refactor the configure script by moving the generic functionality of
  managing a configuration file into a new module (Build::Config), and
  leave the CAM specific parts in the configure script.  A detailed design
  with instructions for how to modify and extend configure is being
  prepared as part of a new CAM Developer's Guide.

  configure's commandline interface contains the following changes:

  .  -nlat, -nlon, -trk, -trm, -trn have been removed as well as removing the
     "custom" option to -res.  A new resolution is added by putting the
     appropriate entry in the config_horiz_grid.xml file.

  .  The -res argument is being replaced by the option -hgrid to specify the
     horizontal grid.  The -res argument will be supported for backwards
     compatibility.

  .  -nnadv has been removed since the feature of "non-advected
     constituents" was removed at cam3_3_47.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: 

. new configure script.
. build-namelist updated to use new Build::Config module to read the
  config_cache.xml file (which has a new structure).

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

models/atm/cam/bld/config_cam_eul_defaults.xml
models/atm/cam/bld/config_cam_fv_defaults.xml
models/atm/cam/bld/config_cam_homme_defaults.xml
models/atm/cam/bld/config_cam_sld_defaults.xml
models/atm/cam/bld/config_trop_chem_mozart_defaults.xml
models/atm/cam/bld/config_waccm_ghg_defaults.xml
models/atm/cam/bld/config_waccm_mozart_defaults.xml
models/atm/cam/bld/resolution_parameters.xml
models/atm/cam/bld/system_defaults.xml

List all subroutines added and what they do:

models/atm/cam/bld/config_defaults_eul.xml
models/atm/cam/bld/config_defaults_fv.xml
models/atm/cam/bld/config_defaults_homme.xml
models/atm/cam/bld/config_defaults_sld.xml
models/atm/cam/bld/config_defaults_trop_mozart.xml
models/atm/cam/bld/config_defaults_waccm_ghg.xml
models/atm/cam/bld/config_defaults_waccm_mozart.xml
. The new defaults files contain just the values that need to be set

models/atm/cam/bld/config_definition.xml
. The configuration definition lives in this file.  This file contains
  information about the config parameters such as valid values, and whether
  the parameter can take a list of values.  The config_cache.xml file
  output by configure has the same structure and will contain the same
  parameters as this file (though not in the same order).

models/atm/cam/bld/config_definition.xsl
. An XSLT stylesheet for the config_definition.xml file.

models/atm/cam/bld/config_horiz_grid.xml
. The horizonal grid specifiers are defined here.

models/atm/cam/bld/config_sys_defaults.xml
. This is the old system_defaults.xml file renamed for consistency with the
  other config_* files.

models/atm/cam/bld/perl5lib/Build/Config.pm
. New Build::Config module.

models/atm/cam/bld/perl5lib/t/01.t
models/atm/cam/bld/perl5lib/t/config_cache.xml
models/atm/cam/bld/perl5lib/t/config_definition.xml
models/atm/cam/bld/perl5lib/t/config_setup_eul.xml
models/atm/cam/bld/perl5lib/t/debug.t
. test code for the Build::Config module

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/perl5lib/XML/Changes
models/atm/cam/bld/perl5lib/XML/Lite.pm
models/atm/cam/bld/perl5lib/XML/Lite/Element.pm
models/atm/cam/bld/perl5lib/XML/README
models/atm/cam/bld/perl5lib/XML/man3/XML::Lite.3
models/atm/cam/bld/perl5lib/XML/man3/XML::Lite::Element.3
. The XML::Lite module has just been moved under perl5lib

models/atm/cam/bld/CAM_config.pm
models/atm/cam/bld/build-namelist
. Update build-namelist to use the Build::Config module to read the
  config_cache.xml file produced by configue.

models/atm/cam/bld/configure
. complete refactoring to make use of new Build::Config module

models/atm/cam/bld/mkDepends
. add fix for emacs fontlock


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

The CCSM test is failing due to a share code inconsistency.

tempest: All PASS except:

008 sm133 TSM.sh e32pdh aqpgro 3s .................................FAIL! rc= 8
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 4
025 sm333 TSM.sh f4pdh aqpgro 3s ..................................FAIL! rc= 8
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 4
039 sm533 TSM.sh s32pdh aqpgro 3s .................................FAIL! rc= 8
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 4

The smoke tests started failing in cam3_4_04.  Still looking into this.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_4_03.

Summarize any changes to answers: none -- BFB.

===============================================================
===============================================================

Tag name: cam3_4_05
Originator(s): mvertens
Date: Tue Mar 13 11:04:53 MDT 2007
One-line Summary: upgraded to drvseq1_0_12

Purpose of changes:Updated component codes and driver to have flexibility 
to recognize active versus data/dead atm/land components. This is needed to
optimize performance for4 certain component combinations such as datm/land coupling.

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: myself

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

M SVN_EXTERNAL_DIRECTORIES
  - updated drv/seqmct to drvseq1_0_12
  - updated csm_share/[shr/eshf/flds] to share3_070305
  - updated clm2 to prof_clm3_expa_92_tags/prof02_clm3_expa_92  

M models/ocn/dom/ocn_time_manager.F90
M models/ocn/dom/ocn_comp_mct.F90
  updated to drvseq1_0_12

M models/ocn/som/ocn_time_manager.F90
M models/ocn/som/ocn_comp_mct.F90
  updated to drvseq1_0_12

M models/ice/csim4/ice_time_manager.F90
M models/ice/csim4/ice_comp_mct.F90
  updated to drvseq1_0_12

M models/atm/cam/src/control/atm_comp_mct.F90
  updated to drvseq1_0_12

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except
059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

tempest: All PASS except 
008 sm133 TSM.sh e32pdh aqpgro 3s .................................FAIL! rc= 8
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 4
025 sm333 TSM.sh f4pdh aqpgro 3s ..................................FAIL! rc= 8
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 4
039 sm533 TSM.sh s32pdh aqpgro 3s .................................FAIL! rc= 8
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 4

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: none

===============================================================
===============================================================

Tag name: cam3_4_04
Originator(s): pworley
Date: Fri Mar 9 09:00:00 EST 2007
One-line Summary: new profiling interface; one processor EUL/SLD MPI fix

Purpose of changes:

. Add new profiling interface, isolating all calls to underlying timing
  library in perf_mod.F90

. Replace compile time profiling options with runtime options via
  a new namelist prof_inparm (in drv_in)

. Add support for one process MPI runs in the EUL and SLD dycores

Bugs fixed (include bugzilla ID):

. disabled a few shr_sys_flush(6) calls that caused the code
  to crash on UNICOSMP systems (Cray X1/X1E)

Describe any changes made to build system:

Describe any changes made to the namelist:

. Added prof_inparm namelist:  
   profile_disable, profile_barrier, profile_single_file, 
   profile_depth_limit, profile_detail_limit, profile_timer
  to drv_in

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: pworley

List all subroutines eliminated: 

. ccsm_seq_timer_init (in con_cam.F90 and in seq_ccsm_drv.F90)

List all subroutines added and what they do:

in perf_mod.F90:
  t_initf: replacement for ccsm_seq_timer_init, including support
    for new namelist prof_inparm
  t_profile_onf: logical function indicating whether profiling is active
    at this point in the code
  t_barrier_onf: logical function indicating whether timing barriers are
    enabled
  t_single_filef: logical function indicating whether one file or one
    file per process should be generated for timing and spmdstats data
  t_adj_detailf: increment or decrement timing detail level
  t_barrierf: if enabled, t_startf(XXX), shr_sys_barrier, t_stopf(XXX)
  t_finalizef: timing library clean-up

in FVperf_module.F90:
  FVbarrierclock: if enabled, t_startf(XXX), mp_barrier, t_stopf(XXX)

List all existing files that have been modified, and describe the changes:

in CAM:
atm/cam/bld/NamelistsDescriptions.xml
atm/cam/bld/SeqCCSM_namelist.pm
atm/cam/bld/camexp.pm
atm/cam/bld: prof_inparm.pm
. added support to generate new namelist (prof_inparm) within drv_in
  (contributed by Brian Eaton)

atm/cam/src/dynamics/eul/spmd_dyn.F90
atm/cam/src/dynamics/sld/spmd_dyn.F90
. added support for 1 processor MPI (SPMD) runs

atm/cam/src/chemistry/trop_mozart/chemistry.F90
atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
atm/cam/src/chemistry/trop_mozart/tracer_data.F90
atm/cam/src/chemistry/waccm_mozart/chemistry.F90
atm/cam/src/chemistry/waccm_mozart/iondrag.F90
atm/cam/src/chemistry/waccm_mozart/mo_gas_phase_chemdr.F90
atm/cam/src/chemistry/waccm_mozart/spedata.F90
atm/cam/src/control/cam_history.F90
atm/cam/src/control/ccsm_msg.F90
atm/cam/src/control/wrap_mpi.F90 (when WRAP_MPI_TIMING defined)
atm/cam/src/dynamics/eul/dyndrv.F90
atm/cam/src/dynamics/eul/dynpkg.F90
atm/cam/src/dynamics/eul/scandyn.F90
atm/cam/src/dynamics/eul/stepon.F90
atm/cam/src/dynamics/fv/metdata.F90
atm/cam/src/dynamics/homme/dp_coupling.F90
atm/cam/src/dynamics/homme/dyn_comp.F90
atm/cam/src/dynamics/homme/stepon.F90
atm/cam/src/dynamics/sld/dyndrv.F90
atm/cam/src/dynamics/sld/dynpkg.F90
atm/cam/src/dynamics/sld/scandyn.F90
atm/cam/src/dynamics/sld/stepon.F90
atm/cam/src/physics/cam1/advnce.F90
atm/cam/src/physics/cam1/cloudsimulator.F90
atm/cam/src/physics/cam1/convect_ke_intr.F90
atm/cam/src/physics/cam1/molec_diff.F90
atm/cam/src/physics/cam1/phys_gmean.F90
atm/cam/src/physics/cam1/prescribed_aerosols.F90
atm/cam/src/physics/cam1/radiation.F90
atm/cam/src/physics/cam1/stratiform.F90
atm/cam/src/physics/cam1/sulchem.F90
atm/cam/src/physics/cam1/tphysac.F90
atm/cam/src/physics/cam1/tphysbc.F90
atm/cam/src/physics/cam1/vertical_diffusion.F90
atm/cam/src/physics/cam1/zm_conv_intr.F90
atm/cam/src/physics/waccm/radheat.F90
ice/csim4/ice_comp.F90
ice/csim4/ice_comp_mct.F90
ice/csim4/ice_dh.F
ice/csim4/ice_srf.F90
ocn/dom/ocn_comp.F90
ocn/dom/ocn_comp_mct.F90
ocn/som/mixed_layer.F90
ocn/som/ocn_comp.F90
ocn/som/ocn_comp_mct.F90
utils/pilgrim/mod_comm.F90 (when TIMING defined)
utils/pilgrim/unit_testers/ghosttest.F90  (when MODCM_TIMING defined)
utils/pilgrim/unit_testers/parpatterntest.F90  (when MODCM_TIMING defined)
utils/pilgrim/unit_testers/redistributetest.F90  (when MODCM_TIMING defined)
. added 'use perf_mod'

atm/cam/src/control/atm_comp_mct.F90
. added 'use perf_mod' and one new timer event

atm/cam/src/dynamics/eul/courlim.F90
atm/cam/src/dynamics/eul/linemsdyn.F90
atm/cam/src/dynamics/eul/scan2.F90
atm/cam/src/dynamics/eul/scanslt.F90
atm/cam/src/dynamics/eul/spegrd.F90
atm/cam/src/dynamics/sld/courlim.F90
atm/cam/src/dynamics/sld/scan2.F90
atm/cam/src/dynamics/sld/scanslt.F90
atm/cam/src/dynamics/sld/spegrd.F90
atm/cam/src/physics/cam1/phys_grid.F90
atm/cam/src/dynamics/eul/dp_coupling.F90
atm/cam/src/dynamics/fv/dp_coupling.F90
atm/cam/src/dynamics/fv/dyn_comp.F90
atm/cam/src/dynamics/fv/stepon.F90
atm/cam/src/dynamics/sld/dp_coupling.F90
. added 'use perf_mod', added mpicom definition for no-SPMD case
  where necessary, and replaced TIMING_BARRIERS logic with t_barrierf

atm/cam/src/control/cam_comp.F90
. added 'use perf_mod', added mpicom definition for no-SPMD case,
  replaced TIMING_BARRIERS logic with t_barrierf, eliminated (via ifdef)
  shr_sys_flush(6) for UNICOSMP, and replaced MULTIPLE_PERF_FILES
  logic with t_single_filef logic for spmdstats

atm/cam/src/control/con_cam.F90
. added 'use perf_mod', removed call to usetlbuf (on CATAMOUNT),
  replaced definition and call to ccsm_seq_timer_init with call to
  t_initf, moved timer initialization, added t_adj_detailf(+2/-2)
  to 'hide' initialization in default timing, added additional
  timers (many sets, to match seq_ccsm_drv), modified t_prf call,
  and added new t_finalizef call

atm/cam/src/dynamics/fv/FVperf_module.F90
. added 'use perf_mod' (when not in GEOS_MODE) and added
  FVbarrierclock (as interface to t_barrierf, eventually;
  implemented exlicitly until mpicom is exposed in Pilgrim
  and modcomm calls)

atm/cam/src/dynamics/fv/cd_core.F90
atm/cam/src/dynamics/fv/trac2d.F90
. replaced TIMING_BARRIERS logic with FVbarrierclock

atm/cam/src/physics/cam1/physpkg.F90
. added 'use perf_mod', added mpicom definition for no-SPMD case,
  replaced TIMING_BARRIERS logic with t_barrierf, added t_adj_detailf(+1/-1)
  to hide instrumentation inside chunking loops

in CLM2
lnd/clm2/src/main/atmdrvMod.F90
lnd/clm2/src/main/clm_comp.F90
lnd/clm2/src/main/clm_csmMod.F90
lnd/clm2/src/main/program_csm.F90
lnd/clm2/src/main/program_off.F90
. added 'use perf_mod'

lnd/clm2/src/main/lnd_comp_mct.F90
lnd/clm2/src/riverroute/RtmMod.F90
lnd/clm2/src/main/driver.F90
. added 'use perf_mod', added mpicom definition for no-SPMD case where
  necessary, and replaced TIMING_BARRIERS logic with t_barrierf

lnd/clm2/src/main/decompMod.F90
. eliminated (via ifdef) shr_sys_flush(6) for UNICOSMP

in DRV
drv/seq_mct/seq_ccsm_drv.F90
. added 'use perf_mod', removed call to usetlbuf (on CATAMOUNT),
  replaced definition and call to ccsm_seq_timer_init with call to
  t_initf, moved timer initialization, added t_adj_detailf(+2/-2)
  to 'hide' initialization in default timing, replaced TIMING_BARRIERS
  logic with t_barrierf, remove MULTIPLE_PERF_FILES logic and use
  modified t_prf call, added new t_finalizef call, deleted stop 0.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except

059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

This test was also failing in the previous tag.

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

===============================================================
===============================================================

Tag name: cam3_4_03
Originator(s): mvertens, andrew, eaton
Date: Fri Mar  2 08:15:42 MST 2007
One-line Summary: restart bug fix; mod in radforce for lf95/debug

Purpose of changes:

. Fix restart bug (see below).

. Add mod to radforce code to make lf95/debug work.  This is just changing 
  a full array copy (1:pcols) to a copy of only the subsection (1:ncol).

Bugs fixed (include bugzilla ID):

. [ID 405] The code currently crashes when writing the restart pointer
  files for the dom, som, and csim components unless the user has
  explicitly set these names via the namelist.  This has be fixed by
  providing appropriate default values.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/ice/csim4/ice_comp.F90
models/ocn/dom/ocn_comp.F90
models/ocn/som/ocn_comp.F90
. add default for rest_pfile

models/atm/cam/test/system/nl_files/aqpgro
models/atm/cam/test/system/nl_files/fv2d_4tsk
models/atm/cam/test/system/nl_files/fv2d_8tsk
models/atm/cam/test/system/nl_files/ghgrmp
models/atm/cam/test/system/nl_files/no_ttrac
models/atm/cam/test/system/nl_files/off2x2.5
models/atm/cam/test/system/nl_files/off2x2.5p
models/atm/cam/test/system/nl_files/outfrq24h
models/atm/cam/test/system/nl_files/outfrq3s
models/atm/cam/test/system/nl_files/pghgsul
models/atm/cam/test/system/nl_files/scm_b4b_o1
models/atm/cam/test/system/nl_files/scm_prep
models/atm/cam/test/system/nl_files/ttrac
models/atm/cam/test/system/nl_files/ttrac_lb1
models/atm/cam/test/system/nl_files/ttrac_lb2
models/atm/cam/test/system/nl_files/ttrac_lb3
. remove setting of rest_pfile (the default is what we want to use)

models/atm/cam/src/physics/cam1/radiation.F90
. replace whole array assignments of pmxrgnrf and nmxrgnrf with versions
  that copy the array section 1:ncol.  This is to make lf95/debug happy.


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except

059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

This test was also failing in the previous tag.

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: none

===============================================================
===============================================================

Tag name: cam3_4_02
Originator(s): cchen, sawyer, eaton
Date: Wed Feb 28 08:37:57 MST 2007
One-line Summary: fix FV omega calc, misc bug fixes

Purpose of changes:

. A new implementation of the omega calculation fix originally applied in
  cam3_3_3 was provided by Jack Chen, and made to work with OMP by Will
  Sawyer.

. A new subroutine, pbuf_setval, was added to the physics buffer module to
  allow fields to be initialized to values other than the default (NaN).

Bugs fixed (include bugzilla ID):

. [ID387] Fix bug in FV mode reading an initial file that contains the
  field DELP.

. Fix for subroutine fstrat_inti in mo_fstrat.F90 (trop_mozart chem).

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: cchen, sawyer, eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/src/dynamics/fv/dyn_comp.F90
models/atm/cam/src/dynamics/fv/diag_module.F90
models/atm/cam/src/dynamics/fv/cd_core.F90
models/atm/cam/src/dynamics/fv/te_map.F90
. FV omega fix

models/atm/cam/src/physics/cam1/phys_buffer.F90
. add pbuf_setval method for initializing physics buffer fields to values
  other than the default (NaN).

models/atm/cam/src/chemistry/trop_mozart/mo_fstrat.F90 (fstrat_inti)
. remove inappropriate uses of beglat, endlat.  This fix didn't affect
  results in the configurations tested by the regression tests.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: PASS except

001 sb998 TSB.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 5
019 bl331 TBL.sh f4c11gdh pghgsul 9s ..............................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
027 bl334 TBL.sh f4dh adia 9s .....................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
035 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
038 bl354 TBL.sh fm2dh outfrq3s 9s ................................FAIL! rc= 7
041 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

The CCSM test fails for same reason as in previous tag.

The failed baseline tests are expected failures due to the change in the
diagnostic FV omega calculation.  The only fields with diffs are OMEGA,
OMEGAT, UW3d and WTH3d.

tempest: PASS except

017 bl314 TBL.sh wg10dh outfrq3s 9s ...............................FAIL! rc= 7
021 bl331 TBL.sh f4c11gdh pghgsul 9s ..............................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
029 bl335 TBL.sh f4dh idphys 9s ...................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7

The failed baseline tests are expected failures due to the change in the
diagnostic FV omega calculation.  The only fields with diffs are OMEGA,
OMEGAT, UW3d and WTH3d.

bangkok/lf95: PASS except

016 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 7
029 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 7
031 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7

These are expected failures due to the change in the diagnostic FV omega
calculation.  The only fields with diffs are OMEGA and OMEGAT.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: Answers are BFB except for the diagnostic
 FV omega calculation.

===============================================================
===============================================================

Tag name:  cam3_4_01
Originator(s):  mvr, mvertens
Date: 27 Feb 2007
One-line Summary: cam dom/som now called after cam run phase

Purpose of changes:
Summary: Moved the ocean component to now be run after atmospheric component to 
	 permit incorporation of an active ocean component that is only called 
	 once per day. Made the driver code and specification of surface fields 
	 exchanged between components part of SVN_EXTERNAL_DIRECTORIES.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
- Introduced separate hard-wired namelist files for cam (atm_in),
  cam-dom/som (ocn_in), cam-csim (ice_in) and the sequential driver (drv_in). 
	
- The new cam-csim namelist is as follows:
  namelist /csim_inparm/ prognostic_icesnow, reset_csim_iceprops, &
  ice_conschk_frq, icecyc, rest_pfile, nrevsn
	
- The new cam-dom namelist is as follows:
  namelist /dom_inparm/ sstcyc, nrevsn, rest_pfile
	
- The new cam-som namelist is as follows:	
  namelist /som_inparm/ sstcyc, som_conschk_frq, rest_pfile, nrevsn
	
- The new driver namelist file contains the namelists 	
  ccsm_inparm and timemgr_inparm (which were previous in single namelist file "namelist") 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: mvertens, mvr

List all subroutines eliminated:
D      models/drv
- directory removed and made external
D      models/atm/cam/bld/atmlndnl.pm
	
List all subroutines added and what they do:
A  +   models/ocn/dom/ocn_filenames.F90
A  +   models/ocn/dom/ocn_time_manager.F90
A  +   models/ocn/som/ocn_filenames.F90
A  +   models/ocn/som/ocn_time_manager.F90
A  +   models/ice/csim4/ice_filenames.F90
A  +   models/ice/csim4/ice_time_manager.F90
- Made cam-dom, cam-som and cam-csim no longer dependent on the cam time 
  manager. Now each of these components has a separate time manager module 
  that is initialized from the sync clock the same way as the cam time manager 
  is initialized from the sync clock.  Also made cam-dom, cam-som and cam-csim 
  have a cam-independent specification for their restart file names. These 
  routines (ocn_filenames.F90 and ice_filenames.F90 now utilize the component 
  specific time manager routines rather than the cam time manager).
	
A  +   models/ocn/som/ocn_constants.F90
- Added new module to specify tfrez and cpw independent of the cam-csim code. 
  This removed an implicit dependency between the cam-som and cam-csim code.
	
A  +   models/atm/cam/bld/som_inparm.pm
A  +   models/atm/cam/bld/DefaultDOM_INPARM_Namelist.xml
A  +   models/atm/cam/bld/dom_inparm.pm
A  +   models/atm/cam/bld/DefaultCSIM_INPARM_Namelist.xml
A  +   models/atm/cam/bld/compnl.pm
A  +   models/atm/cam/bld/DefaultSOM_INPARM_Namelist.xml
A  +   models/atm/cam/bld/csim_inparm.pm
- new files needed for the breakout of the namelists

List all existing files that have been modified, and describe the changes:
M      models/ocn/dom/ocn_spmd.F90
- removed #SPMD if def	
M      models/ocn/dom/sst_data.F90
- removed boudning of sst temp by freezing point of water:	 
  !  Bound the sst temp by the freezing point of sea water.
  !  sst(i,lchnk) = max(sst(i,lchnk),tsice)
  the logic is now consistent with that utilized in docn7 dom mode
- also minor cleanup of logic to get code to work with moving the ocn call to after the
  atmosphere call
M      models/ocn/dom/ocn_types.F90
- removed lwup from ocn_types	
M      models/ocn/dom/ocn_comp.F90
- incorporated cam-dom specific namelist, time manager and restart file naming utility
M      models/ocn/dom/ocn_comp_mct.F90
- introduced new cdata input data structure that his info buf flag capability 
- modified domain generation such that it removed maxfrac as an attribute of dom_o 
  and added aream as a new attribute (area from SCRIP mapping file)
	
M      models/ocn/som/mixed_layer.F90
- removed #ifdef SPMD, removed extra call to time mixed_layer2
- removed "use ice_constants" for tref by adding new ocn_constants module 
M      models/ocn/som/ocn_spmd.F90
- removed #ifdef SPMD	
M      models/ocn/som/ocn_types.F90
- removed tsocn(:) (no longer needed)	
M      models/ocn/som/somint.F90
- removed "use cam_control_mod, only: sstcyc", now obtained from cam-som namelist
- replaced "use time_manager" (cam time manager) with "use ocn_time_manager"
M      models/ocn/som/ocn_comp.F90
- incorporated cam-dom specific namelist, time manager and restart file naming utility
M      models/ocn/som/ocean_data.F90
- introduced module variable sstcyc which is now set from som specific namelist
M      models/ocn/som/somini.F90
- removed "use cam_control_mod, only: sstcyc", now obtained from cam-som namelist
- replaced "use time_manager" (cam time manager) with "use ocn_time_manager"
- removed ifdef SPMD	
M      models/ocn/som/ocn_comp_mct.F90
- introduced new cdata input data structure that his info buf flag capability 
- modified domain generation such that it removed maxfrac as an attribute of dom_o 
  and added aream as a new attribute (area from SCRIP mapping file)
	
M      models/ice/csim4/ice_spmd.F90
- removed #ifdef SPMD	
M      models/ice/csim4/ice_data.F90
- removed #ifdef SPMD
- removed "use ocn_comp, only : sst_file_get_id"
- removed reference to aqua_planet	
- replaced "use time_manager" (cam time manager) with "use ocn_time_manager"
M      models/ice/csim4/ice_dh.F
- added module variables prognostic_icesnow, reset_csim_iceprops that will now be used by
  cam-csim namelist
M      models/ice/csim4/ice_srf.F90
- removed use statements for cam_history and cam_control_mod	
M      models/ice/csim4/ice_comp.F90
- incorporated cam-dom specific namelist, time manager and restart file naming utility
- removed module variables asdirice, aldirice, asdifice, aldifice
- moved addfld calls to cam_diagnostics
M      models/ice/csim4/ice_diagnostics.F
- removed use of cam time manager and introduced use of ice time manager 	
M      models/ice/csim4/ice_comp_mct.F90
- introduced new cdata input data structure that his info buf flag capability 
- modified domain generation such that it removed maxfrac as an attribute of dom_o 
  and added aream as a new attribute (area from SCRIP mapping file)

M      models/atm/cam/test/system/TBL.sh
- mod to diagnostic output message

M      models/atm/cam/test/system/TMC.sh
- bug fix to parsing of tracer output for mass conservation test

M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TSM.sh
M      models/atm/cam/test/system/TER.sh
- namelist broken out into individual files for each component; branch test needed 
  pointers to restart files specified in build-namelist call

M      models/atm/cam/test/system/nl_files/ghgrmp
M      models/atm/cam/test/system/nl_files/outfrq3s
M      models/atm/cam/test/system/nl_files/off2x2.5p
M      models/atm/cam/test/system/nl_files/aqpgro
M      models/atm/cam/test/system/nl_files/outfrq24h
M      models/atm/cam/test/system/nl_files/adia
M      models/atm/cam/test/system/nl_files/idphys
M      models/atm/cam/test/system/nl_files/fv2d_4tsk
M      models/atm/cam/test/system/nl_files/scm_prep
M      models/atm/cam/test/system/nl_files/scm_b4b_o1
M      models/atm/cam/test/system/nl_files/pghgsul
M      models/atm/cam/test/system/nl_files/off2x2.5
M      models/atm/cam/test/system/nl_files/no_ttrac
M      models/atm/cam/test/system/nl_files/fv2d_8tsk
M      models/atm/cam/test/system/nl_files/ttrac_lb1
M      models/atm/cam/test/system/nl_files/ttrac_lb2
M      models/atm/cam/test/system/nl_files/ttrac
M      models/atm/cam/test/system/nl_files/ttrac_lb3
- all namelist options files modified with new pointers to component restart files

M      models/atm/cam/bld/config_cam_eul_defaults.xml
M      models/atm/cam/bld/configure
M      models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
M      models/atm/cam/bld/config_trop_chem_mozart_defaults.xml
M      models/atm/cam/bld/camexp.pm
M      models/atm/cam/bld/filter_nl.pm
M      models/atm/cam/bld/config_waccm_ghg_defaults.xml
M      models/atm/cam/bld/clm_inparm.pm
M      models/atm/cam/bld/config_waccm_mozart_defaults.xml
M      models/atm/cam/bld/config_cam_fv_defaults.xml
M      models/atm/cam/bld/DefaultCTL_NL_Namelist.xml
M      models/atm/cam/bld/cam_inparm.pm
M      models/atm/cam/bld/NamelistsDescriptions.xml
M      models/atm/cam/bld/timemgr_inparm.pm
M      models/atm/cam/bld/ctl_nl.pm
M      models/atm/cam/bld/config_cam_homme_defaults.xml
M      models/atm/cam/bld/CAM_config.pm
M      models/atm/cam/bld/clmexp.pm
M      models/atm/cam/bld/SeqCCSM_namelist.pm
M      models/atm/cam/bld/ccsm_inparm.pm
M      models/atm/cam/bld/build-namelist
M      models/atm/cam/bld/config_cam_sld_defaults.xml
M      models/atm/cam/bld/DefaultFILTER_NL_Namelist.xml
- mods required to account for breakout of the namelists

M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/cam_control_mod.F90
- removed cam namelists for the following variables
  sstcyc, icecyc, prognostic_icesnow, reset_csim_iceprops, ice_conschk_frq, som_conschk_frq
M      models/atm/cam/src/control/ccsm_msg.F90
- moved addfld for history variables calls to cam_diagnostics.F90 (see below)
M      models/atm/cam/src/control/con_cam.F90
- hardwired atm.stdin as namelist for nlfilename argument to cam_init
M      models/atm/cam/src/control/atm_comp_mct.F90
- introduced the possibility to do flux averaging of precipitation (as is done in cpl6)
  this will be required when cam communicates with the sequential driver only on time steps when
  the short wave computation is done
- introduced new cdata input data structure that his info buf flag capability 
- moved verification of surface fractions from mrg_x2a_mct.F90 to this module (do not want
  to do this verification for dead components)
- modified domain generation such that it removed maxfrac as an attribute of dom_o 
  and added aream as a new attribute (area from SCRIP mapping file)
M      models/atm/cam/src/control/cam_comp.F90
- hard-wired atm_in and argument to NLFileName in call to cam_initial 
- moved call to intht to the initialization phase of cam	
- moved calls to addfld of FSNSOI, FLNSOI, LHFLXOI and SHFLXOI from atm_comp_mct.F90 to this module	
M      models/atm/cam/src/utils/spmd_utils.F90
- added public attribute to mpicom module variable when SPMD is not defineda
M      models/atm/cam/src/physics/cam1/radiation.F90
- added new routine, radiation_newsw_cday, which returns the calendar day of the
  next sw radiation calculation
- added optional input variable, "timestep", to function radiation_do()
M      models/atm/cam/src/physics/cam1/cam_diagnostics.F90
- moved the addfld calls from som/ocn_comp.F90 to  this module
- moded the addfld calls from dom/ocn_comp.F90 to tihs module	 
- moved the addfld calls from ccsm_msg.F90 to this module
- moded the addfld calls from ice/csim/ice_comp.F90 to this module
M      SVN_EXTERNAL_DIRECTORIES
- externals now include drv code and updated to clm3_expa_92
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
all baseline tests fail due to change in answers; ccsm test fails because 
latest ccsm tag does not yet have necessary mods...when a ccsm sandbox 
was created with ccsm3_1_beta44, clm updated to clm3_expa_91, csm_share 
updated to share3_070220, MCT updated to MCT2_3_0_070206, and scripts 
updated with small change to cam.template for new namelists, the ccsm 
test passes

tempest:
all baseline tests fail due to change in answers

bangkok/lf95:
all baseline tests fail due to change in answers

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: ALL
- what platforms/compilers: ALL
- nature of change: larger than roundoff but same climate

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):  drvord13_cam3_3_43
- platform/compilers: bluevista/mpxlf90_r
- configure commandline: 
  som run:
  $cfgdir/configure -spmd -smp -dyn fv -res 1.9x2.5 -ocn som

  dom run:
  $cfgdir/configure -spmd -smp -dyn fv -res 1.9x2.5
	
- build-namelist command (or complete namelist):
  som run:
  &ccsm_inparm
   case_name		= 'camrun_som'
   start_type		= "continue"
  /
  &timemgr_inparm
   atm_cpl_dt		= 1800
   orb_iyear_ad		= 1950
   restart_option		= 'monthly'
   start_ymd		= 101
   stop_n		= 24
   stop_option		= 'nmonths'
  /
  &cam_inparm
   absems_data		= '/fs/cgd/csm/inputdata/atm/cam/rad/abs_ems_factors_fastvx.c030508.nc'
   aeroptics		= '/fs/cgd/csm/inputdata/atm/cam/rad/AerosolOptics_c050419.nc'
   bnd_topo		= '/fs/cgd/csm/inputdata/atm/cam/topo/USGS-gtopo30_1.9x2.5_remap_c050602.nc'
   bndtvaer		= '/fs/cgd/csm/inputdata/atm/cam/rad/AerosolMass_V_1.9x2.5_clim_c040811.nc'
   bndtvo		= '/fs/cgd/csm/inputdata/atm/cam/ozone/pcmdio3.r8.64x1_L60_clim_c970515.nc'
   bndtvs		= '/fis/cgd/cms/rneale/cam_mydata/som/cam3_2_59_bvc_0005-0020_qflux.nc'
   doisccp		= .true.
   dtime		= 1800
   fincl1		= 'CLDST'
   isccpdata		= '/fs/cgd/csm/inputdata/atm/cam/rad/isccp.tautab_invtau.nc'
   ncdata		= '/fis/cgd/cms/rneale/cam_mydata/som/cam3_2_59_som0.cam2.i.0050-01-01-00000.nc'
  /
  &clm_inparm
   dtime		= 1800
   finidat		= '/fis/cgd/cms/rneale/cam_mydata/som/cam3_2_59_som0.clm2.r.0050-01-01-00000.nc'
   fpftcon		= '/fs/cgd/csm/inputdata/lnd/clm2/pftdata/pft-physiology-cn16.c040719'
   fsurdat		= '/fs/cgd/csm/inputdata/lnd/clm2/srfdata/cam/clms_3.1_1.9x2.5_c050603.nc'
  /

  dom run:
  &ccsm_inparm
   case_name		= 'camrun_dom'
   start_type		= "continue"
  /
  &timemgr_inparm
   atm_cpl_dt		= 1800
   orb_iyear_ad		= 1950
   restart_option		= 'monthly'
   start_ymd		= 101
   stop_n		= 24
   stop_option		= 'nmonths'
  /
  &cam_inparm
   absems_data		= '/fs/cgd/csm/inputdata/atm/cam/rad/abs_ems_factors_fastvx.c030508.nc'
   aeroptics		= '/fs/cgd/csm/inputdata/atm/cam/rad/AerosolOptics_c050419.nc'
   bnd_topo		= '/fs/cgd/csm/inputdata/atm/cam/topo/USGS-gtopo30_1.9x2.5_remap_c050602.nc'
   bndtvaer		= '/fs/cgd/csm/inputdata/atm/cam/rad/AerosolMass_V_1.9x2.5_clim_c040811.nc'
   bndtvo		= '/fs/cgd/csm/inputdata/atm/cam/ozone/pcmdio3.r8.64x1_L60_clim_c970515.nc'
   bndtvs		= '/fs/cgd/csm/inputdata/atm/cam/sst/sst_HadOIBl_bc_1.9x2.5_clim_c040810.nc'
   doisccp		= .true.
   dtime		= 1800
   fincl1		= 'CLDST'
   isccpdata		= '/fs/cgd/csm/inputdata/atm/cam/rad/isccp.tautab_invtau.nc'
   ncdata		= '/fis/cgd/cms/rneale/cam_mydata/atm/cam3_2_59_bvc.cam2.i.0023-01-01-00000.nc'
 /
  &clm_inparm
   dtime		= 1800
   finidat		= '/fis/cgd/cms/rneale/cam_mydata/lnd/cam3_2_59_bvc.clm2.i.0023-01-01-00000.nc'
   fpftcon		= '/fs/cgd/csm/inputdata/lnd/clm2/pftdata/pft-physiology-cn16.c040719'
   fsurdat		= '/fs/cgd/csm/inputdata/lnd/clm2/srfdata/cam/clms_3.1_1.9x2.5_c050603.nc'
  /

- MSS location of output:
/MVR/csm/camrun_som
/MVR/csm/camrun_dom
	
MSS location of control simulations used to validate new climate:
/RNEALE/csm/cam3_2_59_som0/atm/hist
/RNEALE/csm/cam3_2_59_bvc/atm/hist
	
URL for AMWG diagnostics output used to validate new climate:
MSS:/MVR/csm/camrun_som/camrun_som-cam3_2_59_som0.tar
MSS:/MVR/csm/camrun_dom/camrun_dom-cam3_2_59_bvc.tar
	
===============================================================
===============================================================

Tag name: cam3_4_00
Originator(s): erik
Date: Thu Feb 22 16:04:59 MST 2007
One-line Summary: Update CLM and csm_share

Purpose of changes: Update CAM to use latest CLM with new hydrology changes in it

Bugs fixed (include bugzilla ID): 307

Describe any changes made to build system: Add SEQ_MCT CPP token for seqCCSM driver 
	Need to use different CAM_CCSMROOT for CCSM tests see below

Describe any changes made to the namelist: None 

List any changes to the defaults for the boundary datasets: New datasets for CLM 

Describe any substantial timing or memory changes: None 

Code reviewed by: eaton 

List all SVN Externals updated:

Update csm_share to share3_070220 -- Has new share freezing constants
Update CLM to clm3_expa_91 --------- New hydrology
Update MCT to MCT2_3_0_070206 ------ New features added to mpi-serial needed for CLM

List all subroutines eliminated:

D      models/atm/cam/test/system/scamtest.sh -- no longer used by test_driver.sh

List all subroutines added and what they do:

None, other than updates to new externals.

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/test/system/TSC.sh -- leave SCAM files if CAM_RETAIN_FILES is true
M      models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml -- Add new CLM hydrology datasets
M      models/atm/cam/bld/Makefile.in -- Add SEQ_MCT define to build
M      models/drv/seq_mct/flux_ao.F90 -- rm a shr_const_ value now defined in shr_const_mod.F90

Add CPP Token SEQ_MCT to SEQ_MCT drivers for each model component.

M      models/ocn/dom/ocn_comp_mct.F90
M      models/ocn/som/ocn_comp_mct.F90
M      models/ice/csim4/ice_comp_mct.F90
M      models/atm/cam/src/control/atm_comp_mct.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:    All PASS except TBL tests -- because answers change

005 bl131 TBL.sh e32c11dh pghgsul 9s ..............................FAIL! rc= 7
008 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
010 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
013 bl134 TBL.sh e32dh adia 9s ....................................FAIL! rc= 7
015 bl151 TBL.sh e64h outfrq24h 2d ................................FAIL! rc= 7
019 bl331 TBL.sh f4c11gdh pghgsul 9s ..............................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
024 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
027 bl334 TBL.sh f4dh adia 9s .....................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
033 bl337 TBL.sh f4dh fv2d_8tsk 9s ................................FAIL! rc= 7
035 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
038 bl354 TBL.sh fm2dh outfrq3s 9s ................................FAIL! rc= 7
041 bl355 TBL.sh fmo2dh off2x2.5 9s ...............................FAIL! rc= 7
045 bl531 TBL.sh s32c11dh pghgsul 9s ..............................FAIL! rc= 7
048 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
050 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 7
053 bl534 TBL.sh s32dh adia 9s ....................................FAIL! rc= 7
055 bl551 TBL.sh s64h outfrq24h 2d ................................FAIL! rc= 7

setenv CAM_CCSMROOT /fis/cgd/home/erik/ccsm3_1_beta44+clm91+shr+mct

(this is a CCSM sandbox with ccsm3_1_beta44, clm updated to clm3_expa_91, 
 csm_share updated to share3_070220 and MCT updated to MCT2_3_0_070206)

tempest:      All PASS except TBL tests -- because answers change

004 bl131 TBL.sh e32c11dh pghgsul 9s ..............................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 9s .................................FAIL! rc= 7
009 bl133 TBL.sh e32pdh aqpgro 3s .................................FAIL! rc= 7
012 bl135 TBL.sh e32dh idphys 9s ..................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h 2d ................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq3s 9s ...............................FAIL! rc= 7
021 bl331 TBL.sh f4c11gdh pghgsul 9s ..............................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9s ..................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 3s ..................................FAIL! rc= 7
029 bl335 TBL.sh f4dh idphys 9s ...................................FAIL! rc= 7
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7
035 bl531 TBL.sh s32c11dh pghgsul 9s ..............................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 9s .................................FAIL! rc= 7
040 bl533 TBL.sh s32pdh aqpgro 3s .................................FAIL! rc= 7
043 bl535 TBL.sh s32dh idphys 9s ..................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h 2d ................................FAIL! rc= 7

bangkok/lf95: All PASS except TBL tests -- because answers change

004 bl111 TBL.sh e8c8mdm ttrac 9s .................................FAIL! rc= 5
008 bl112 TBL.sh e8sdm ghgrmp 9s ..................................FAIL! rc= 5
010 bl113 TBL.sh e8pdm aqpgro 3s ..................................FAIL! rc= 5
012 bl153 TBL.sh e64m outfrq24h 2d ................................FAIL! rc= 5
016 bl311 TBL.sh f10c8mdm ttrac 9s ................................FAIL! rc= 5
024 bl312 TBL.sh f10sdm ghgrmp 9s .................................FAIL! rc= 5
026 bl313 TBL.sh f10pdm aqpgro 3s .................................FAIL! rc= 5
029 bl317 TBL.sh f10dm fv2d_4tsk 9s ...............................FAIL! rc= 5
031 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 5
035 bl511 TBL.sh s8c8mdm ttrac 9s .................................FAIL! rc= 5
039 bl512 TBL.sh s8sdm ghgrmp 9s ..................................FAIL! rc= 5
041 bl513 TBL.sh s8pdm aqpgro 3s ..................................FAIL! rc= 5
043 bl553 TBL.sh s64m outfrq24h 2d ................................FAIL! rc= 4

Summarize any changes to answers, i.e.,
- what code configurations: All
- what platforms/compilers: All
- nature of change (new CLM climate, and ice freezing point change)

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
In run database...

	http://ccsm-rundb.cgd.ucar.edu/case_display.php?case=b31.020ws

MSS location of control simulations used to validate new climate: /CCSM/csm/b31.020ws

Note --this case does NOT include the TKFRZ constant change.

URL for AMWG diagnostics output used to validate new climate:

	http://www.cgd.ucar.edu/tss/clm/diagnostics/ccsm2_prod/b31.020ws_atma-b31.002_atma/sets.htm

===============================================================
===============================================================

Tag name: cam3_3_51
Originator(s): mvr
Date: 9 Feb 2007
One-line Summary: Test driver enabled for blueice; bug fix for the use 
	of env var CAM_ACCOUNT to specify charge account

Purpose of changes: the new ibm machine blueice cam online feb 1; the 
	recent implementation of the environment variable CAM_ACCOUNT 
	failed to use the account specified when spawning the CCSM tests

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself

List all subroutines eliminated:
none
	
List all subroutines added and what they do:
A      README_EXTERNALS
- documentation for how to work with cam's external directories
A      models/atm/cam/test/system/tests_posttag_blueice
- default list of tests to run posttag on blueice

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TSB.ccsm.sh
M      models/atm/cam/test/system/TCT.ccsm.sh
- CCSM test scripts enabled for use on blueice; now uses CAM_ACCOUNT setting 
  for spawning CCSM tests with user-specified charge account
M      models/atm/cam/test/system/tests_posttag_bluesky
M      models/atm/cam/test/system/tests_pretag_bluesky
- default set of tests on bluesky now include tests for homme and scam
M      models/atm/cam/test/system/test_driver.sh
- top level test script enabled for use on blueice; now exports CAM_ACCOUNT
M      models/atm/cam/test/system/CAM_runcmnd.sh
- script enabled to construct run command appropriate for blueice


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all PASS

tempest: all PASS

bangkok/lf95: all PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_50
Originator(s): eaton, mvr, jedwards
Date: Sun Feb  4 15:01:47 MST 2007
One-line Summary: fixes for file archiving & eshr time manager; test suite enhancements

Purpose of changes:

. Fix problems observed in recent NCAR production runs involving failed
  transfers to MSS and failed restarts on automatic resubmissions.  Part of
  the problem appears to be due to the LSF batch system killing msrcp
  processes when the CAM processes are finished.  The LoadLeveler batch
  system did not do this.  The fix implemented was designed to restore the
  same behavior we had under LoadLeveler by issuing the msrcp commands that
  occur on the final timestep syncronously, i.e., don't let CAM finish
  until the requested file transfers are successful.

  Note that having CAM be responsible for file archiving is undesirable for
  several reasons, chief among them being that the implementation is not
  portable.  We intend to implement a file archiving script for CAM similar
  to the file harvester used by CCSM.  But the current ability of CAM to
  archive files at NCAR will be maintained until a better solution is in
  place.

. Fix logic for determining the last timestep in share code for ESMF
  time manager.  This eliminates the need to use the optional arg nextstep
  to get the correct behavior.

. Enhancements to test suite (from mvr) include:

  - Allow user to specify a project number on SCD machines via the
    CAM_ACCOUNT environment variable.

  - Print summary of the cprnc output to the log file, including a list of
    fields that contain differences.

Bugs fixed (include bugzilla ID):

. Fix problem in boundarydata.F90 (from jedwards) that was causing seg
  fault trying to interpolate unstructured grid cyclic dataset between
  December and January.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

SVN_EXTERNAL_DIRECTORIES
. update csm_share externals to point to csm_share/branch_tags/scmshr_tags/scmshr02

models/csm_share/eshr/eshr_timemgr_mod.F90
. fix logic in eshr_timeMgr_clockisOnLastStep
. change eshr_timemgr_clockAlarmIsOnRes to call
  eshr_timeMgr_clockisOnLastStep without optional nextStep=.true. arg
. add method eshr_timemgr_curTimeLEstopTime which returns true when the 
  current time is <= the stop time.

models/atm/cam/src/control/atm_comp_mct.F90
. remove nextstep=.true. arg from call to eshr_timeMgr_clockIsOnLastStep
  that sets nlend.

models/atm/cam/src/control/con_cam.F90
. remove unused reference to eshr_timemgr_clockIsOnLastStep

models/drv/seq_mct_drv/seq_ccsm_drv.F90
. use new method eshr_timeMgr_curTimeLEstopTime in timestep loop
. remove nextstep=.true. from call to eshr_timeMgr_clockisOnLastStep which
  sets the logical for removing files
. modify the last msrcp call, which is for the driver restart file, to be
  synchronous. 

models/atm/cam/src/control/ioFileMod.F90
. modify putfil so that at the end of run when the files are not to be
  removed after archiving, the archiving commands are issued
  synchronously.  This is to avoid having the batch queue kill the
  processes that are trying to archive files.

models/atm/cam/src/physics/cam1/boundarydata.F90
. fix allocate statement that was causing seg fault trying to interpolate
  unstructured grid cyclic dataset between december and january.

models/atm/cam/bld/DefaultTIMEMGR_INPARM_Namelist.xml
. add default start_ymd for HOMME ne5np8 resolution initial file.

models/atm/cam/bld/DefaultCTL_NL_Namelist.xml
. change statefreq to 60 from 1 (per J Edwards).

models/atm/cam/test/system/TBL.sh
. Remove grepping for non-zero comparisons in cprnc output -- this belongs
  in the CAM_compare.sh script

models/atm/cam/test/system/CAM_compare.sh
. Enhance to print summary of cprnc output to the log file, including a
  list of fields that contain differences.

models/atm/cam/test/system/test_driver.sh
. Allow user to specify project number on IBMs via CAM_ACCOUNT environment
  variable.
. Modify LD_LIBRARY_PATH to include pgi libs even when using lf95 for
  testing on CGD clusters.  This is because cprnc was built with pgi.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except:

  057 bl711 TBL.sh h5x8dm adia 9s ...................................FAIL! rc= 7

  This failure is expected since I fixed the start_ymd to be consistent with
  the initial file, and changed the value of statefreq.

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bit-for-bit

===============================================================
===============================================================

Tag name: cam3_3_49
Originator(s): Will Sawyer, Lawrence Takacs, Bill Putman
Date: Thu Feb  1 11:41:00 MST 2007
One-line Summary: Merge of GEOS5 and CAM fv-dycores

Purpose of changes:

	o  Added mass fluxes to the output of the FV dycore (Putman)

	o  Added cubic vertical interpolation (Takacs) to used optionally
	   (flag te_method=1) in the remapping.

	o  More FV constants were cleaned up in a consistent way (Bug #214)
           in particular, pi=4*atan(1.0) was replaced by F90 parameter with
	   sufficient significant digits (cause non-zero differences!)

	o  Refactoring to remove many CPP #if defined(GEOS_MODE) distinctions
	
Bugs fixed (include bugzilla ID):  #214

Describe any changes made to build system:  none

Describe any changes made to the namelist:  none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: no difference

Code reviewed by:  Sawyer, Takacs, Suarez, Putman

List all subroutines eliminated:  none

List all subroutines added and what they do: c2a3d (cubic interpolation
	from a C to an A grid) in module dynamics_vars.F90.

List all existing files that have been modified, and describe the changes:

	In models/atm/cam/src/dynamics/fv

fill_module.F90:	revised definition of PI (R16), no longer 4*atan(1)

dyn_comp.F90:		Horizontal mass fluxes (Putman), remapping method 
			switch (te_method).

mapz_module.F90:	Cubic interpolation (Takacs), removed references to 
			state and grid, in particular clocks.

inital.F90:		dyn_init call now has TE_METHOD as an argument

cd_core.F90:		bug fix:  zero out the first latitude of UC (which 
			should never be used, but *is* written to the restart.

dynamics_vars.F90:	c2a3d (Putman), removed all references to ESMF 
			(GEOS_MODE), PI passed in as argument

te_map.F90:		Horizontal mass fluxes (Putman), optional use
			of cubic interpolation (activated by te_method flag)
			Isolated magic numbers as F90 parameters.
			Partial remapping (Takacs et al.), considerable 
			code restructuring (zero difference changes)

restart_dynamics.F90:	dyn_init call now has TE_METHOD as an argument

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:    Fails baseline tests (bl331,332, 333, 334, 336, 337, 354, 
	      355, 375) due to PI roundoff.  Passes perturbation growth test.
	      Fails cs998 (CCSM run -- known problem)
tempest:      passes all tests
bangkok/lf95: passes all tests

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_3_48 (previous tag)

Summarize any changes to answers, i.e.,
- what code configurations:  WACCM, FV
- what platforms/compilers:  Bluevista
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):  roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff?    perturbation growth test

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_48
Originator(s): Stacy Walters, Francis Vitt
Date: 25 Jan 2007
One-line Summary:
	Scientific updates for WACCM

Purpose of changes:
	- Improved WACCM gravity wave drag
	- Enhanced diagnostic outputs
	- Added QBO forcing in WACCM physics
	- Added NOx and HOx production from solar proton events (SPE)

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

  logical :: qbo_use_forcing              ! .true. => qbo forcing used; default = .false.

  character(len=256) :: qbo_forcing_file  ! qbo forcing data file; default = 'NO_QBO_FILE'
                                          ! if qbo_use_forcing == .true. this must be set

  logical :: qbo_cyclic                   ! .true. => qbo forcing file is to be used with
                                          ! a 28 month periodicity otherwise model time is
                                          ! used to access qbo_forcing_file dataset

  real(r8) :: t_pert_ubc                  ! temperature pertubation to apply to the msis
                                          ! temperature at the upper boundary in Kelvin
                                          ! degrees; default value = 0._r8

  real(r8) :: no_xfac_ubc                 ! nitrogen oxide concentration multiplicative
                                          ! factor to be applied to the SNOE no values
                                          ! at the upper boundary; default = 1._r8


  ! waccm solor proton event (SPE) data variables
  logical :: spe_remove_file              ! true => the offline spe file will be removed
        
  logical :: spe_restart                  ! true => restart from a previous run with SPEs

  character(len=256) :: spe_data_file     !  name of file that contains the spe data

  character(len=256) :: spe_filenames_list ! file that lists a series of spe files 

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton, Stacy Walters, Francis Vitt

List all subroutines eliminated:

List all subroutines added and what they do:

A       models/atm/cam/src/physics/waccm/qbo.F90
- new routine to allow for a forced qbo
A       models/atm/cam/src/chemistry/waccm/spedata.F90
- new routine to allow for solar proton events
A       models/atm/cam/src/chemistry/waccm/spehox.F90
- new routine to allow for hox production from solar proton events
A       models/atm/cam/src/chemistry/waccm/mo_solarproton.F90
- new routine to allow for solar proton events

List all existing files that have been modified, and describe the changes:

M       models/atm/cam/src/control/runtime_opts.F90
- added the above listed changes to the namelist
M       models/atm/cam/src/physics/cam1/check_energy.F90
- changed default value of print_energy_errors from .false. to .true.
 	(Francis you might want to check with Brian about this)
M       models/atm/cam/src/physics/cam1/physics_types.F90
- added real variable uzm, the zonally averaged u wind, for the qbo option
M       models/atm/cam/src/physics/cam1/advnce.F90
- added use association and call to qbo_timestep_init for qbo initialization
   on a time step basis
M       models/atm/cam/src/physics/cam1/tphysac.F90
- added use association and call to qbo_relax for qbo
- added preprocessing tokens to differentiate call to ion_drag depending on
   whether the simulation is waccm_mozart or waccm_ghg
M       models/atm/cam/src/physics/cam1/nlte_fomichev.F90
- changed constant 1 to 1._r8
M       models/atm/cam/src/physics/cam1/nlte_lw.F90
- changed longname for QRLNLTE in addfld call
- add addfld call for QNO; nitrogen oxide cooling rate
M       models/atm/cam/src/physics/cam1/ctem.F90
- extensive changes to allow the "transformed eulerian mean" variables to
   be computed and output properly with either a one or two dimensional
   physical grid decomposition
M       models/atm/cam/src/physics/waccm/gw_drag.F90
- added resolution cases for waccm gravity wave drag
M       models/atm/cam/src/physics/waccm/tgcm_forcing.F90
- added preprocessing token to limit the diagnotic output
M       models/atm/cam/src/chemistry/waccm_mozart/svdcmp.F90
- modification to svd routines to make them fortran90 compliant
M       models/atm/cam/src/chemistry/waccm_mozart/mo_setext.F90
- added code to handle insitu production from solar proton events
M       models/atm/cam/src/chemistry/waccm_mozart/mo_gas_phase_chemdr.F90
- corrected error in the cloud ice buffer index
M       models/atm/cam/src/chemistry/waccm_mozart/mo_tgcm_ubc.F90
- restricted diagnostic output to the masterproc and with preprocessing tokens
M       models/atm/cam/src/chemistry/waccm_mozart/upper_bc.F90
- added code to implement t_pert_ubc and no_xfac_ubc the temperature and
   nitrogen oxide perturbations at the upper boundary.  The resultant temperature
   and nitrogen oxide concentration are checked for non-negativity
M       models/atm/cam/src/chemistry/waccm_mozart/chem_surfvals.F90
- restricted diagnostic output to the masterproc and with preprocessing tokens
M       models/atm/cam/src/chemistry/waccm_mozart/mo_cph.F90
- removed use of molecular nitrogen concentration in chemical heating rates
M       models/atm/cam/src/chemistry/waccm_mozart/mo_chemini.F90
- added solar proton event initialization
M       models/atm/cam/src/chemistry/waccm_mozart/mo_indprd.F90
- added solar proton event insitu forcing
M       models/atm/cam/src/chemistry/waccm_mozart/mo_aurora.F90
- restricted diagnostic output to the masterproc and with preprocessing tokens
M       models/atm/cam/src/chemistry/waccm_mozart/mo_imp_sol.F90
- cosmetic changes and removed removed reference to mpi process identifier "iam"
M       models/atm/cam/src/chemistry/waccm_mozart/mo_snoe.F90
- restricted diagnostic output to the masterproc and with preprocessing tokens
M       models/atm/cam/src/chemistry/waccm_mozart/euvac.F90
- restricted diagnostic output to the masterproc and with preprocessing tokens
M       models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
- added call to advance_spedata to update the solar proton event forcing to present
   time step
- added call to addfld for spe related production for ground and excited state
   atomic nitrogen and oh
M       models/atm/cam/src/chemistry/waccm_mozart/iondrag.F90
- extensive update to waccm_mozart chemistry case wherein ion and electron
   concentrations are directly utilized
M       models/atm/cam/src/chemistry/waccm_mozart/mo_setrxt.F90
- removed all vector function sections
M       models/atm/cam/src/chemistry/waccm_mozart/efield.F90
- added use association for the svd routines
- restricted diagnostic output to the masterproc and with preprocessing tokens
M       models/atm/cam/src/chemistry/waccm_mozart/chem_mods.F90
- new module consistent with solar proton event insitu forcing
M       models/atm/cam/src/chemistry/waccm_mozart/mo_prod_loss.F90
- added code to handle solar proton insitu forcing
M       models/atm/cam/src/chemistry/waccm_mozart/neckel.F90
- restricted diagnostic output to the masterproc and with preprocessing tokens
M       models/atm/cam/src/chemistry/waccm_mozart/mo_srf_emissions.F90
- altered flux initialization from gas_pcnst to gas_pcnst-1
M       models/atm/cam/src/dynamics/fv/pmgrid.F90
- added decomptype strip2dx for modified ctem.F90 routines
M       models/atm/cam/src/dynamics/fv/dp_coupling.F90
- added dynamics block decomposition x and y index ranges to subroutine
   definition of d_p_coupling
- modified code to handle both one and two dimensional grid decomposition
- modified code to properly interface with the modified ctem.F90 routines
M       models/atm/cam/src/dynamics/fv/spmd_dyn.F90
- created decomptype strip2dx for modified ctem.F90 routines
M       models/atm/cam/src/dynamics/fv/dynamics.F90
- created decomptype strip2dx for modified ctem.F90 routines
M       models/atm/cam/src/dynamics/fv/stepon.F90
- added dynamics block decomposition x and y index ranges to calling sequence of
   d_p_coupling
M       models/atm/cam/src/dynamics/fv/restart_dynamics.F90
- added code to output variables needed for restarting with solar proton event

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
030 bl336 TBL.sh wm4h outfrq3s 9s .................................FAIL! rc= 7
 - expected to fail due to WACCM changes
059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2
 - this failed in cam3_3_47 and is not expected to pass in this version
	
tempest:
017 bl314 TBL.sh wg10dh outfrq3s 9s ...............................FAIL! rc= 7
 - expected to fail due to WACCM changes
	
bangkok/lf95: All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_47
Originator(s): eaton
Date: Tue Jan 23 08:54:59 MST 2007
One-line Summary: Remove non-advected constituents option; misc bug fixes & enhancements.

Purpose of changes:

. Remove the "non-advected" constituents option.  This option allowed
  constituent transport by the physics parameterizations, but disabled
  large-scale advective transports.  It was used by the original prognostic
  cloud water scheme, but is no longer needed.

. Add configurations for 1/4 and 1/2 degree FV grids.  Add
  dycore/resolution specific parameters in cldwat and cloud_fraction
  modules. 

. Fix interpolation code diagnostic that caused cam to quit if all columns
  in a process fell into an "extrapolation region" of the input dataset.
  The test only makes sense when interpolating on the global grid; not on
  sub-domains.

. Fix bug in driver that was preventing the CAM banner from being printed.

. Modify build-namelist defaults for FV, 1.9x2.5.  The default landfrac is
  now consistent with the coupled model resolution 1.9x2.5_gx1v4.

. Modify build-namelist to fail with informative message if user specifies
  ncdata but not start_ymd.  This is because build-namelist has default
  values for start_ymd which correspond to the default datasets used for
  ncdata.  If the user overrides the default ncdata, then the default
  start_ymd should also be overridden since the default may be inconsistent
  with the dataset specified for ncdata.

. add fix to XML::Lite parser code to recognize attributes when there is
  optional white space between the equals sign and the value.  Also allow
  the attribute values to be enclosed in single quotes as well as double
  quotes.

. modify build for a homme run

. Add some initializers for index values in FV (from Art Mirin).

. replace deprecated float() intrinsic with real().

. fix for spaces in the name of the spmdstats file (from Pat Worley).

. update mct external to trunk tag MCT2_3_0_070112

Bugs fixed (include bugzilla ID):

. Bugzilla bug 89:
  Change to cd_core.F90 required to enable the ifort compiler to compile the
  omp directive surrounding "do 4500" loop.

. Bugzilla bug 65:
  Remove a informative print statement from inside an CSD region (caused
  problem on Cray-X1E).

. add fix for intermittent problem Tony found running in coupled mode on
  bassi (NERSC IBM p5).  Add initializer for srfflx_state2d%qref.

. fix ctl_nl.pm (a homme namelist) so that it doesn't ignore the resolution
  found in the config_cache.xml file.  Remove the hardcoded value of "ne"
  from Default_CTL_NL_Namelist.xml.

. NOTE -- initial commit and tag contained problem with svn external
  definitions.  Deleted that tag, fixed definitions, recommitted and
  retagged.

Describe any changes made to build system: none

Describe any changes made to the namelist: 

. Add checks to build-namelist to fail if ncdata is specified without
  specifying start_ymd.

List any changes to the defaults for the boundary datasets:

. New CLM datasets for FV, 1.9x2.5.  These datasets are consistent with the
  landfraction used for CCSM runs (1.9x2.5_gx1v4).

Describe any substantial timing or memory changes: none

Code reviewed by: myself

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

. update mct external to trunk tag MCT2_3_0_070112
 SVN_EXTERNAL_DIRECTORIES

. Mods to add 1/4 and 1/2 degree FV grids
 models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
 models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
 models/atm/cam/bld/resolution_parameters.xml
 models/atm/cam/src/physics/cam1/cldwat.F90
 models/atm/cam/src/physics/cam1/cloud_fraction.F90
 models/atm/cam/src/physics/cam1/hk_conv.F90
 models/atm/cam/src/physics/cam1/zm_conv.F90
 models/atm/cam/src/dynamics/fv/dycore.F90
 models/atm/cam/src/dynamics/fv/dyn_comp.F90

. modify warning about extrapolating too much of grid
 models/atm/cam/src/control/interpolate_data.F90

. bug fix for CAM banner in output log
 models/drv/seq_mct/seq_ccsm_drv.F90

. Modify build-namelist defaults for FV, 1.9x2.5.
 models/atm/cam/bld/cam_inparm.pm
 models/atm/cam/bld/clm_inparm.pm
 models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
 models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml

. add check to force user to also specify start_ymd if ncdata has been
  specified. 
 models/atm/cam/bld/SeqCCSM_namelist.pm

. add fix to XML::Lite parser code to recognize attributes when there is
  optional white space between the equals sign and the value.  Also allow
  the attribute values to be enclosed in single quotes as well as double
  quotes. 
 models/atm/cam/bld/XML/Lite/Element.pm

. add missing initializer for srfflx_state2d%qref.
 models/atm/cam/src/control/camsrfexch_types.F90

. mods for homme build
 models/atm/cam/bld/config_cam_homme_defaults.xml
 models/atm/cam/bld/ctl_nl.pm
 models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
 models/atm/cam/bld/DefaultCTL_NL_Namelist.xml
 models/atm/cam/bld/DefaultTIMEMGR_INPARM_Namelist.xml

. add some initializers for index values in FV (from Art Mirin).
 models/atm/cam/src/dynamics/fv/d2a3dijk.F90
 models/atm/cam/src/dynamics/fv/d2a3dikj.F90
 models/atm/cam/src/dynamics/fv/spmd_dyn.F90

. Replace deprecated float() intrinsic with real():
 models/atm/cam/src/physics/cam1/mcshallow.F90
 models/atm/cam/src/physics/cam1/convect_ke.F
 models/atm/cam/src/physics/cam1/uw_conv.F

. Bugzilla bug 89:
 models/atm/cam/src/dynamics/fv/cd_core.F90

. Bugzilla bug 65
 models/atm/cam/src/dynamics/fv/fill_module.F90

. Put shr_sys_flush calls inside "#ifndef UNICOSMP" as a workaround for a bug
  on the Cray-X1E.
. fix spmdstats filename so that it doesn't contain spaces
 models/atm/cam/src/control/cam_comp.F90

. Mods to remove the "non-advected" species option.  Remove all occurances
  of pnats and ppcnst, and change the cnst_add interface to remove the
  'type' argument.
 models/ocn/som/mixed_layer.F90
 models/utils/pilgrim/mod_comm.F90
 models/atm/cam/test/unit/control/file_test.pl
 models/atm/cam/test/unit/ocnsice/dom/params.h
 models/atm/cam/tools/scam/configure
 models/atm/cam/tools/scam/scm_init/forecast.F90
 models/atm/cam/tools/scam/obj/Makefile
 models/atm/cam/bld/CAM_config.pm
 models/atm/cam/src/control/ccsm_msg.F90
 models/atm/cam/src/control/wtrc_flxoce.F90
 models/atm/cam/src/control/srfxfer.F90
 models/atm/cam/src/control/history_scam.F90
 models/atm/cam/src/control/cam_history.F90
 models/atm/cam/src/control/history_defaults.F90
 models/atm/cam/src/control/camsrfexch_types.F90
 models/atm/cam/src/control/ncdio_atm.F90
 models/atm/cam/src/control/iop.F90
 models/atm/cam/src/physics/cam1/tphysidl.F90
 models/atm/cam/src/physics/cam1/tphysbc.F90
 models/atm/cam/src/physics/cam1/drydep_mod.F90
 models/atm/cam/src/physics/cam1/restart_physics.F90
 models/atm/cam/src/physics/cam1/hk_conv.F90
 models/atm/cam/src/physics/cam1/constituents.F90
 models/atm/cam/src/physics/cam1/water_tracers.F90
 models/atm/cam/src/physics/cam1/hb_diff.F90
 models/atm/cam/src/physics/cam1/convect_shallow.F90
 models/atm/cam/src/physics/cam1/convect_deep.F90
 models/atm/cam/src/physics/cam1/buffer.F90
 models/atm/cam/src/physics/cam1/zm_conv.F90
 models/atm/cam/src/physics/cam1/qneg4.F90
 models/atm/cam/src/physics/cam1/vertical_diffusion.F90
 models/atm/cam/src/physics/cam1/initindx.F90
 models/atm/cam/src/physics/cam1/seasalt_intr.F90
 models/atm/cam/src/physics/cam1/tracers.F90
 models/atm/cam/src/physics/cam1/progseasalts_intr.F90
 models/atm/cam/src/physics/cam1/dust_intr.F90
 models/atm/cam/src/physics/cam1/stratiform.F90
 models/atm/cam/src/physics/cam1/carbon_intr.F90
 models/atm/cam/src/physics/cam1/co2_cycle.F90
 models/atm/cam/src/physics/cam1/chemistry.F90
 models/atm/cam/src/physics/cam1/aerosol_intr.F90
 models/atm/cam/src/physics/cam1/sulfur_intr.F90
 models/atm/cam/src/physics/cam1/tracers.F90
 models/atm/cam/src/physics/cam1/radiation.F90
 models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
 models/atm/cam/src/physics/cam1/cam_diagnostics.F90
 models/atm/cam/src/physics/cam1/upper_bc.F90
 models/atm/cam/src/physics/cam1/physics_types.F90
 models/atm/cam/src/physics/cam1/physpkg.F90
 models/atm/cam/src/physics/cam1/constituent_burden.F90
 models/atm/cam/src/physics/cam1/tphysac.F90
 models/atm/cam/src/physics/waccm/tracers.F90
 models/atm/cam/src/physics/waccm/chemistry.F90
 models/atm/cam/src/physics/waccm/gw_drag.F90
 models/atm/cam/src/physics/waccm/upper_bc.F90
 models/atm/cam/src/physics/waccm/mo_msis_ubc.F90
 models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
 models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
 models/atm/cam/src/chemistry/waccm_mozart/upper_bc.F90
 models/atm/cam/src/chemistry/waccm_mozart/mo_gas_phase_chemdr.F90
 models/atm/cam/src/chemistry/waccm_mozart/mo_tgcm_ubc.F90
 models/atm/cam/src/chemistry/waccm_mozart/chem_surfvals.F90
 models/atm/cam/src/chemistry/waccm_mozart/mo_snoe.F90
 models/atm/cam/src/chemistry/waccm_mozart/mo_waccm_hrates.F90
 models/atm/cam/src/dynamics/sld/linemsdyn.F90
 models/atm/cam/src/dynamics/sld/spegrd.F90
 models/atm/cam/src/dynamics/sld/prognostics.F90
 models/atm/cam/src/dynamics/sld/scanslt.F90
 models/atm/cam/src/dynamics/sld/scan2.F90
 models/atm/cam/src/dynamics/sld/restart_dynamics.F90
 models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
 models/atm/cam/src/dynamics/sld/dp_coupling.F90
 models/atm/cam/src/dynamics/sld/inidat.F90
 models/atm/cam/src/dynamics/sld/dyn_comp.F90
 models/atm/cam/src/dynamics/sld/spmd_dyn.F90
 models/atm/cam/src/dynamics/sld/diag_dynvar_ic.F90
 models/atm/cam/src/dynamics/eul/linemsdyn.F90
 models/atm/cam/src/dynamics/eul/spegrd.F90
 models/atm/cam/src/dynamics/eul/scanslt.F90
 models/atm/cam/src/dynamics/eul/prognostics.F90
 models/atm/cam/src/dynamics/eul/scandyn.F90
 models/atm/cam/src/dynamics/eul/restart_dynamics.F90
 models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
 models/atm/cam/src/dynamics/eul/diag_dynvar_ic.F90
 models/atm/cam/src/dynamics/eul/dp_coupling.F90
 models/atm/cam/src/dynamics/eul/dyn_comp.F90
 models/atm/cam/src/dynamics/eul/inidat.F90
 models/atm/cam/src/dynamics/eul/spmd_dyn.F90
 models/atm/cam/src/dynamics/fv/stepon.F90
 models/atm/cam/src/dynamics/fv/dp_coupling.F90
 models/atm/cam/src/dynamics/fv/dyn_comp.F90
 models/atm/cam/src/dynamics/fv/spmd_dyn.F90
 models/atm/cam/src/dynamics/fv/inital.F90
 models/atm/cam/src/dynamics/fv/restart_dynamics.F90
 models/atm/cam/src/advection/slt/qmassa.F90
 models/atm/cam/src/dynamics/homme/dp_coupling.F90



If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: all PASS except:
035 bl375 TBL.sh f1.9h outfrq24h 2d ...............................FAIL! rc= 7
059 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

tempest: all PASS except
031 bl376 TBL.sh f1.9o outfrq24h 2d ...............................FAIL! rc= 7

bangkok/lf95: all PASS except:
031 bl377 TBL.sh f1.9m outfrq24h 2d ...............................FAIL! rc= 7

The failure of the FV, 1.9x2.5 baseline comparisons are expected due to a
change in the default landfrac file for that case.

The failure of the CCSM restart test is still under investigation.  The
latest CCSM tag in collections (ccsm3_1_beta42) is also failing with
cam3_3_46 which means the failure is not associated with the mods in this
commit.


CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_3_46 
Originator(s): mvr,jet,eaton,aconley
Date: 10 Jan 2007
One-line Summary: test_driver mods, consolidation of external 
definitions in top directory, various bug fixes

Purpose of changes:
-having external definitions in multiple places led to some confusion
-previously had no pretag tests at fv 1.9x2.5, an important production res
-wanted some posttag testing to occur on calgary as alternative linux cluster
-testing of fv 2d decomposition needed bolstering and multiple platforms
-needed test of an extended run (several months) to catch certain run-time bugs
-added lightning test environment setting to override that of users 
-branch test again branches from an earlier restart file than the last created
 (broken since cam3_3_15)

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself,eaton

List all subroutines eliminated:
D      models/utils/SVN_EXTERNAL_DIRECTORIES
D      models/SVN_EXTERNAL_DIRECTORIES
- files no longer needed with consolidation of external defs to top dir
D      models/atm/cam/test/system/config_files/f2h
D      models/atm/cam/test/system/config_files/f2m
D      models/atm/cam/test/system/config_files/f2o
- fv tests at "production" settings moved from fv2x2.5 to fv1.9x2.5
D      models/atm/cam/test/system/tests_posttag_bangkok
- posttag testing of linux cluster moved from bangkok to calgary
D      models/atm/cam/test/system/TRX.sh
- restart test while toggling fv 2d decomp settings merged with TER.sh

List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/f4h
- new configuration options file for performance/extended-run test
A      models/atm/cam/test/system/config_files/f1.9o
- new configuration options file for "production" setting on tempest
A      models/atm/cam/test/system/nl_files/fv2d_4tsk
A      models/atm/cam/test/system/nl_files/fv2d_8tsk
- new namelist options files for testing of fv 2d decomposition
A      models/atm/cam/test/system/tests_posttag_calgary
- posttag testing of linux cluster moved from bangkok to calgary
A      SVN_EXTERNAL_DIRECTORIES
- new, consolidated list of all cam external definitions

List all existing files that have been modified, and describe the changes:
 M     .
- set externals property on top level dir
 M     models
 M     models/utils
- deleted externals properties where they previously existed
M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TSM.sh
- modified to handle new syntax for run length
M      models/atm/cam/test/system/TER.sh
- modified to handle new syntax for run length; restart now toggles resources 
  appropriately if running fv 2d decompostion
M      models/atm/cam/test/system/tests_pretag_tempest
- now running "production" test at fv 1.9x2.5
M      models/atm/cam/test/system/tests_pretag_bangkok
M      models/atm/cam/test/system/tests_posttag_lightning
- added test for fv 2d decomp and now running "production" test at fv 1.9x2.5
M      models/atm/cam/test/system/tests_posttag_bluesky
M      models/atm/cam/test/system/tests_pretag_bluesky
M      models/atm/cam/test/system/tests_pretag_bluevista
- changed test for fv 2d decomp and now running "production" test at fv 1.9x2.5
M      models/atm/cam/test/system/tests_posttag_bluevista
- added extended run (two months) and moved the performance test from 10d to 2m
M      models/atm/cam/test/system/test_driver.sh
- modified settings for calgary; bug fix for lightning environment
M      models/atm/cam/test/system/nl_files/pghgsul
- added namelist settings for freq of restart writes
M      models/atm/cam/test/system/input_tests_master
- modified syntax for run length of tests - needed to specify something other 
  than timesteps or days; addition and deletion of tests mentioned
M      models/atm/cam/test/system/CAM_runcmnd.sh
- modified setting for calgary
M      models/atm/cam/src/control/getnetcdfdata.F90
- SCM bug fix for setlatlonidx routine when determining closest model column to 
  given lat/lon pair
M      models/atm/cam/src/physics/cam1/aerosol_radiation_interface.F90
- fix to memory bug when calling radforce with omp enabled
M      models/atm/cam/src/physics/cam1/phys_gmean.F90
- fix to memory leak introduced in cam3_3_35; whitespace cleanup
M      models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
- fixed bug in reading PS data from Match.  Bug introduced in cam3_3_43

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
- all baseline tests failed due to the changes in the testing scripts and in 
  some cases the fixing of bugs - when a baseline was set up with the same 
  script changes and bug fixes, all baseline tests passed

tempest:
- all baseline tests failed due to the changes in the testing scripts and in 
  some cases the fixing of bugs - when a baseline was set up with the same 
  script changes and bug fixes, all baseline tests passed

bangkok/lf95:
- all baseline tests failed due to the changes in the testing scripts and in 
  some cases the fixing of bugs - when a baseline was set up with the same 
  script changes and bug fixes, all baseline tests passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:  cam3_3_45
Originator(s):  Dani Bundy Coleman, Jerry Olson
Date: 8 Jan 2007
One-line Summary:  Alternative convection & PBL schemes, forecast mode

Purpose of changes: Allow users to run the UW PBL scheme or the Emanuel
	deep convection scheme. Add rough code to run in forecast mode.

 The UW PBL scheme requires:
	configuration option:	nlev = 30
	namelist options:  	shallow_scheme = 'UW'
				eddy_scheme = 'diag TKE'
 The Emanuel deep convection requires:
	namelist options:  	deep_scheme = 'KE'

Bugs fixed (include bugzilla ID):  none

Describe any changes made to build system: none

Describe any changes made to the namelist: 

character(len=16) :: shallow_scheme   ! 'Hack' (default),'UW','off'
!                       'Hack'    = Hack shallow convection (default)
!                       'UW' = original McCaa UW pbl scheme, modified by Sungsu Park
!                       'off'     = no shallow convection
!
character(len=16) :: deep_scheme  ! 'ZM' (default), 'KE',  'off'
!                       'ZM' = Zhang-McFarlane (default)
!                       'KE' = Kerry Emanuel's scheme
!                       'off'  no deep convection
!
character(len=16) :: eddy_scheme  ! 'HB' (default), 'diag TKE'
!                      'HB'       = Holtslag and Boville (default)
!                      'diag TKE' = diagnostic tke version of Grenier and Bretherton

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Brian Eaton

List all subroutines eliminated: none

List all subroutines added and what they do:

A      models/atm/cam/src/utils/error_function.F90
	provides an erfc function for the UW PBL scheme
A      models/atm/cam/src/physics/cam1/phys_control.F90
	Control interface to CAM physics packages
A      models/atm/cam/src/physics/cam1/mcshallow.F90
	UW PBL shallow convection package
A      models/atm/cam/src/physics/cam1/convect_ke_intr.F90
	Interface to Kerry Emanuel's deep convection scheme
A      models/atm/cam/src/physics/cam1/convect_ke.F
	Kerry Emanuel's deep convection scheme
A      models/atm/cam/src/physics/cam1/zm_conv_intr.F90
	Interface to Zhang-McFarlane deep convection scheme
	(used to be convect_deep.F90)
A      models/atm/cam/src/physics/cam1/eddy_diff.F90
	UW PBL eddy diffusivity package
A      models/atm/cam/src/physics/cam1/uw_conv.F90
	UW PBL shallow convection package
	
List all existing files that have been modified, and describe the changes:

Forecast mode changes:
M      models/atm/cam/src/control/cam_history.F90
M      models/atm/cam/src/physics/cam1/check_energy.F90
M      models/atm/cam/src/physics/cam1/cam_diagnostics.F90
M      models/atm/cam/src/dynamics/sld/spegrd.F90
M      models/atm/cam/src/dynamics/sld/linemsdyn.F90
M      models/atm/cam/src/dynamics/sld/scanslt.F90
M      models/atm/cam/src/dynamics/sld/dyn_comp.F90
M      models/atm/cam/src/dynamics/sld/inidat.F90
M      models/atm/cam/src/dynamics/sld/grmult.F90
M      models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
M      models/atm/cam/src/dynamics/eul/linemsdyn.F90
M      models/atm/cam/src/dynamics/eul/inidat.F90
M      models/atm/cam/src/dynamics/eul/dyn_comp.F90
M      models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
M      models/atm/cam/src/dynamics/fv/initcom.F90
M      models/atm/cam/src/dynamics/fv/inidat.F90
M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
M      models/atm/cam/src/dynamics/fv/commap.F90
M      models/atm/cam/src/dynamics/fv/diag_dynvar_ic.F90
M      models/atm/cam/src/dynamics/fv/uv3s_update.F90
M      models/atm/cam/src/dynamics/fv/stepon.F90
	
Convection option changes:
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/physics/cam1/initindx.F90
M      models/atm/cam/src/physics/cam1/param_cldoptics.F90
M      models/atm/cam/src/physics/cam1/physpkg.F90
M      models/atm/cam/src/physics/cam1/cloud_fraction.F90
M      models/atm/cam/src/physics/cam1/gw_drag.F90
M      models/atm/cam/src/physics/cam1/phys_buffer.F90
M      models/atm/cam/src/physics/cam1/zm_conv.F90
M      models/atm/cam/src/physics/cam1/cldwat.F90
M      models/atm/cam/src/physics/cam1/vertical_diffusion.F90
M      models/atm/cam/src/physics/cam1/convect_shallow.F90
	This is now the interface to all shallow convection schemes
M      models/atm/cam/src/physics/cam1/convect_deep.F90
	This is now the interface to all deep convection schemes
	
Convection and Forecast-mode changes:
M      models/atm/cam/src/physics/cam1/tphysbc.F90
M      models/atm/cam/src/physics/cam1/stratiform.F90
M      models/atm/cam/src/physics/cam1/constituents.F90	
M      models/atm/cam/src/physics/cam1/tphysac.F90

Miscellaneous changes:
M      models/atm/cam/test/system/TBL.sh
	Add more information to output
M      models/atm/cam/test/system/test_driver.sh
	Change bluevista gmake option from "-j" to "-j8"
M      models/atm/cam/src/physics/cam1/acbnd.F90
	Check that oxidant file has correct vertical dimensions
M      models/atm/cam/src/physics/cam1/radiation.F90
M      models/atm/cam/src/physics/cam1/radsw.F90
M      models/atm/cam/src/physics/cam1/radlw.F90
	Calculate clearsky solor & longwave heating rates
	New output fields: QRSC, QRSC_RF, QRLC
M      models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
	stdout

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
Some code was moved from timestepping routines to initialization
routines. In cldwat.F90, this causes a roundoff change
on bluevista that causes the following baseline tests to fail:
005 bl131 TBL.sh e32c11dh pghgsul 9
008 bl132 TBL.sh e32sdh ghgrmp 9 
015 bl151 TBL.sh e64h outfrq24h -2
019 bl331 TBL.sh f4c11gdh pghgsul 9
022 bl332 TBL.sh f4sdh ghgrmp 9 
030 bl336 TBL.sh wm4h outfrq3s 9
034 bl351 TBL.sh f2h outfrq24h -2
037 bl354 TBL.sh fm2dh outfrq3s 9
040 bl355 TBL.sh fmo2dh off2x2.5 9
054 bl551 TBL.sh s64h outfrq24h -2
	
tempest:
The roundoff difference as seen on bluevista seems to
show up in a waccm test that fails:	
017 bl314 TBL.sh wg10dh outfrq3s 9

The baseline model field DTCOND included the effects of the energy 
fixer (which is actually a fix to the nonconservation of the
dynamics). We moved the call to diag_conv_tend_ini from its position
above the energy fixer to below it, which makes the field different
and allows the heat budget to work out. This causes the following tests to
fail (only DTCOND is different):
021 bl331 TBL.sh f4c11gdh pghgsul 9
024 bl332 TBL.sh f4sdh ghgrmp 9 
031 bl352 TBL.sh f2o outfrq24h -2


bangkok/lf95:
Failed because of fixed DTCOND (only DTCOND is different)
016 bl311 TBL.sh f10c8mdm ttrac 9 
024 bl312 TBL.sh f10sdm ghgrmp 9
028 bl353 TBL.sh f2m outfrq24h -2 
	
CAM tag used for the baseline comparison tests if different than previous
tag: cam3_3_44

Summarize any changes to answers, i.e.,
- what code configurations:
	Any configuration on bluevista, although the sulfur cycle is particularly sensitive.
	WACCM on tempest was also sensitive to the roundoff change
	
- what platforms/compilers:
	bluevista, tempest
	
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 
	roundoff
If bitwise differences were observed, how did you show they were no worse
than roundoff?
	pergro test, tracking roundoff change to culprit code

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_44 
Originator(s): Jim Edwards
Date: 12-13-2006
One-line Summary: Update of homme dynamics, update of tests and timing utils

Purpose of changes: Merge homme dynamics development branch.

Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: 
   Added a default homme core build
        M            2606   models/atm/cam/bld/config_cam_homme_defaults.xml
	M            2606   models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
	M            2606   models/atm/cam/bld/DefaultCTL_NL_Namelist.xml
	
Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets: 

Describe any substantial timing or memory changes:

Code reviewed by: myself Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
	updated for new timings tag:
          models/utils/SVN_EXTERNAL_DIRECTORIES 
        
	added a homme test and updated the CCSM test:
	A               0   models/atm/cam/test/system/config_files/h5x8dm
	M            2606   models/atm/cam/test/system/TCT.ccsm.sh
	M            2606   models/atm/cam/test/system/tests_pretag_bluevista
	M            2606   models/atm/cam/test/system/input_tests_master

	ccsm tests will now pull in share code from tester's sandbox by default...
	added environment variable (CAM_USE_SHR) to control behavior

	Added support for homme grid in energy calculation
	M            2606   models/atm/cam/src/physics/cam1/phys_gmean.F90
        Replaced some data statements with parameter declarations
	M            2606   models/atm/cam/src/physics/cam1/radae.F90

        Removed some debugging code
	M            2606   models/atm/cam/src/physics/cam1/physpkg.F90
	M            2606   models/atm/cam/src/physics/cam1/qneg3.F90
       
        Removed some timers that were causing a problem on bluevista - 
	this is a hack, it looks like there is a memory problem associated
	with fmo2dh - I will continue to investigate. 
	models/atm/cam/src/dynamics/fv/dyn_comp.F90
	
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: 056 bl711 TBL.sh h5x8dm adia 9  FAIL (no existing baseline)
        
	   058 cs998 TCS.ccsm.sh ERS f19_g13 K
	   040 bl355 TBL.sh fmo2dh off2x2.5 9  
           FAILED against cam3_3_43 PASS against cam3_3_42 this is due to 
	   problems introduced in 3_3_42
	
tempest: none

bangkok/lf95: none

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_43
Originator(s): John Truesdale
Date: 4 Dec 2006
One-line Summary: Added single column mode to CAM

Purpose of changes:  

	This commit adds a single column mode (SCM) to CAM.  The scam 
	GUI is being refactored and has been removed from the 
	trunk.  The CAM single column mode is controlled via the 
	standard cam namelist.  Additional namelist parameters allow
	cam to be forced using a standard IOP dataset. Future commits 
	will add back much of the original scam and column radiation 
	capablity as well as an updated GUI. 

	To run cam in single column mode you need to invoke the standard
	cam configure script with the -scam option and compile the model
	as usual. Although single column mode only runs with the eularian 
	dynamics most other options for configuring cam (resolution, external
	libraries, etc) will work.  Next invoking the build-namelist
	script will provide a namelist template for running with the
	default ARM IOP.  The build-namelist procedure requires the user
	to supply namelist values for the latitude and longitude of the
	IOP column using the namelist variables scmlat and scmlon.
	In practice though the user must also specify the starting date
	and timesteps to run as well as an appropriate initial condition.  
	The following parameters to the build-namelist script may be used for
	running with the various IOP datasets.  The initial data being read
	in and used as a background for each of the IOPs is the standard
	SEP 1 initial condition.  It is suggested that the user generate an
	initial condition closer to the starting date of the IOP.
        Once the namelist is generated the user may run cam and analyze the
	standard history tape produced for the IOP column with any netcdf
	visualization tool.

	The relavent namelist parameters for use with the single column mode
	of cam are:
	
	single_column = .true.
	scmlat = xxx  ! scm latitude to use for the model run
	scmlon = xxx  ! scm longitude to use for the model run
	iopfile = 'xxx' ! iop boundary condition file

	
build-namelist script params for the ARM IOP

build-namelist -namelist \
"&camexp \
mss_irt=0 \
scmlat=36.6 \
scmlon=262.5  \
start_ymd=19950718 \
start_tod=19800 \
stop_n=1259 \
stop_option='nsteps' \
iopfile='/fs/cgd/csm/inputdata/atm/cam/scam/iop/arm0795v1.2.nc' \
ncdata ='/fs/cgd/csm/inputdata/atm/cam/inic/gaus/cami_0000-09-01_64x128_L26_c030918.nc' \
mfilt=1400 \
nhtfrq=1/"

build-namelist script params for the Gate IOP
	
build-namelist -namelist \
"&camexp \
mss_irt=0 \
scmlat=9. \
scmlon=336.  \
start_ymd=19740830 \
start_tod=0 \
stop_n=1440 \
stop_option='nsteps' \
iopfile='/fs/cgd/csm/inputdata/atm/cam/scam/iop/gate0874v1.2.nc' \
ncdata ='/fs/cgd/csm/inputdata/atm/cam/inic/gaus/cami_0000-09-01_64x128_L26_c030918.nc' \
mfilt=1500 \
nhtfrq=1/"
	
build-namelist script params for GCSS IOP
	
build-namelist -namelist \
"&camexp \
mss_irt=0 \
scmlat=-2. \
scmlon=155.  \
start_ymd=19921220 \
start_tod=0 \
stop_n=505 \
stop_option='nsteps' \
iopfile='/fs/cgd/csm/inputdata/atm/cam/scam/iop/gcss1292v1.2.nc' \
ncdata ='/fs/cgd/csm/inputdata/atm/cam/inic/gaus/cami_0000-09-01_64x128_L26_c030918.nc' \
mfilt=1500 \
nhtfrq=1/"
	

	In addition to the standard IOP datasets the single column version
	of CAM may be forced with an intial condition file and a "pseudo
	IOP" history file generated from a previous global CAM run. This
	mode is useful for getting a feel for how new physics modules
	behave given forcing from an actual CAM run.  To generate an
	initial condition and IOP style forcing data from a standard cam
	run configure the model using the new -camiop option of the
	configure script.  The build-namelist script has been modified to
	generate a namelist which will create an initial condition for a
	scm model run as well as an auxillary history tape containing the
	IOP fields needed to drive a single column version of CAM.  Both
	the initial conditions file and the IOP forcing history tape are 3
	dimensional.  When running with these datasets in SCM mode the
	user can choose which column will be used via the namelist
	parameters scmlat and scmlon.

	The relavent namelist parameters for generating an CAMIOP are

	 fincl2 = 'Ps','u','v','t','q','omega','phis','Prec','lhflx','shflx',\
           'Tsair','Tg','divq3d','divT3d','dcldice','dcldliq','beta',\
	   'fixmas','afixq','afixcldl','afixcldi','dqfxq','dqfxcldl',\
           'dqfxcldi','CLAT','T','Q'
	 inithist       = 'CAMIOP'
	 mfilt          = 1,10
	 nhtfrq         = 0,1
	
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system: Added -scam and -camiop options
	to configure script.  The -scam option will configure cam for
	single column mode.  The -camiop option will configure cam to produce
	an iop initial condition file and a  boundary forcing history tape
	to be used in single column mode.
	
Describe any changes made to the namelist:  Added namelist parameters for
	single column mode.  Since all surface models need single column 
	control information the following namelist variables were added 
	to ccsm_inparm

	! enable single_column mode
	logical	 ::   single_column   ! default false set to true to
	                              ! enable single column mode

	! single column longitude 
	real(r8) ::   scmlon          ! longitude setting used by cam in
	                              ! scm mode
	! single column latitude 
	real(r8) ::   scmlat          ! latitude setting used by cam in
	                              ! scm mode

	The following namelist variable was added to the cam_inparm namelist

	! iop boundary file
	integer, parameter :: max_chars = 128
	character(len=max_chars) iopfile      !IOP Boundary condition file


	Added the CAMIOP option to the inithist namelist variable.  This
	option will produce an initial condition for use with a cam
	generated iop forcing history tape.

	! inithist   Generate initial dataset as auxillary history file
	!            can be set to '6-HOURLY', 'DAILY', 'MONTHLY', 
	!            'YEARLY', 'CAMIOP',  or 'NONE'. 
	!                      default: 'YEARLY'
	

List any changes to the defaults for the boundary datasets:  
       Added a namelist option to specify an IOP file for SCM mode.
	
Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

    configuration/namelist/script files for testing of scm cam mode:

	models/atm/cam/test/system/config_files/scm64bfbiop
        models/atm/cam/test/system/config_files/e64bfbiop
	models/atm/cam/test/system/nl_files/scm_prep
	models/atm/cam/test/system/nl_files/scm_b4b_o1
	models/atm/cam/test/system/TSC.sh

    Files adding scm capability to cam:
	models/atm/cam/src/control/scamMod.F90
	models/atm/cam/src/control/getnetcdfdata.F90
	models/atm/cam/src/dynamics/eul/forecast.F90
	models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90
	models/lnd/clm2/src/main/getnetcdfdata.F90
	
List all existing files that have been modified, and describe the changes:
The majority of the modifications had to do with removing the 
#define SCAM sections of code.  There is still some duplication of
functionality that will be cleaned up in future commits (reading of
netcdf data).  The pieces of independent single column mode code
are delineated now by a run time 'if (single_column)' test.  The single_column
logical is defined in the ccsm_inparm namelist and is available to all component
models.  Files in the test and bld subdirectories were modified to allow
bit for bit testing of scam against a control run of the 3d model as well
as adding functionality to the build-namelist and configure scripts to make
running in single column mode easier.
	
        models/ocn/dom/sst_data.F90
	models/ice/csim4/ice_data.F90
        models/atm/cam/test/system/tests_pretag_bangkok
	models/atm/cam/test/system/TPF.sh

	TPF.sh:  the script for testing performance problems was modified to
	reflect	the move to a single timing file introduced in cam3_3_42

	models/atm/cam/test/system/tests_pretag_bluevista
	models/atm/cam/test/system/nl_files/scm_prep
	models/atm/cam/test/system/nl_files/scm_b4b_o1
	models/atm/cam/test/system/input_tests_master
	models/atm/cam/test/system/TSC.sh
	models/atm/cam/test/system/TCT.sh

	TCT.sh:  all ccsm tests through cam's test suite will now use the
	csm_share and clm code from the cam sandboxes rather than that
	from the latest ccsm tag (up to now it used just the cam code)

	models/atm/cam/test/system/tests_posttag_lightning
	models/atm/cam/bld/configure
	models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
	models/atm/cam/bld/cam_inparm.pm
	models/atm/cam/bld/NamelistsDescriptions.xml
	models/atm/cam/bld/resolution_parameters.xml
	models/atm/cam/bld/CAM_config.pm
	models/atm/cam/bld/ccsm_inparm.pm
	models/atm/cam/src/control/readinitial.F90
	models/atm/cam/src/control/history_defaults.F90
	models/atm/cam/src/control/runtime_opts.F90
	models/atm/cam/src/control/ncdio_atm.F90
	models/atm/cam/src/control/rgrid.F90
	models/atm/cam/src/control/interpolate_data.F90
	models/atm/cam/src/control/con_cam.F90
	models/atm/cam/src/control/atm_comp_mct.F90
	models/atm/cam/src/control/startup_initialconds.F90
	models/atm/cam/src/control/history_scam.F90
	models/atm/cam/src/control/cam_comp.F90
	models/atm/cam/src/control/cam_history.F90
	models/atm/cam/src/physics/cam1/initindx.F90
	models/atm/cam/src/physics/cam1/radiation.F90
	models/atm/cam/src/physics/cam1/radsw.F90
	models/atm/cam/src/physics/cam1/cam_diagnostics.F90
	models/atm/cam/src/physics/cam1/physics_types.F90
	models/atm/cam/src/physics/cam1/radlw.F90
	models/atm/cam/src/physics/cam1/physpkg.F90
	models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
	models/atm/cam/src/physics/cam1/aerosol_index.F90
	models/atm/cam/src/physics/cam1/gw_drag.F90
	models/atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
	models/atm/cam/src/dynamics/sld/dyn_comp.F90
	models/atm/cam/src/dynamics/eul/sphdep.F90
	models/atm/cam/src/dynamics/eul/initcom.F90
	models/atm/cam/src/dynamics/eul/scanslt.F90
	models/atm/cam/src/dynamics/eul/inidat.F90
	models/atm/cam/src/dynamics/eul/getinterpnetcdfdata.F90
	models/atm/cam/src/dynamics/eul/inital.F90
	models/atm/cam/src/dynamics/eul/dycore.F90
	models/atm/cam/src/dynamics/eul/iop.F90
	models/atm/cam/src/dynamics/eul/dynpkg.F90
	models/atm/cam/src/dynamics/eul/diag_dynvar_ic.F90
	models/atm/cam/src/dynamics/eul/scan2.F90
	models/atm/cam/src/dynamics/eul/stepon.F90
	models/atm/cam/src/dynamics/eul/restart_dynamics.F90
	models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
	models/SVN_EXTERNAL_DIRECTORIES
	models/drv/seq_mct_drv/seq_ccsm_drv.F90
	models/drv/seq_mct/mrg_x2a_mct.F90
        models/csm_share/shr/shr_inputinfo_mod.F90
	models/lnd/clm2/src/main/inicFileMod.F90
	models/lnd/clm2/src/main/driver.F90
	models/lnd/clm2/src/main/ncdio.F90
	models/lnd/clm2/src/main/initializeMod.F90
	models/lnd/clm2/src/main/iniTimeConst.F90
	models/lnd/clm2/src/main/restFileMod.F90
	models/lnd/clm2/src/main/controlMod.F90
	models/lnd/clm2/src/main/lnd_comp_mct.F90
	models/lnd/clm2/src/main/surfrdMod.F90
        models/lnd/clm2/src/biogeochem/STATICEcosysDynMod.F90
        models/lnd/clm2/src//main/clm_varctl.F90
	
	The following files were deleted. As stated above
	the GUI version of SCAM is being refactored.  An 
	impoved GUI will be added in the future.

       scam
       scam/configure
       scam/crm
       scam/GNUmakefile
       scam/.scam_defaults
       scam/README
       scam/tools
       scam/tools/sdev
       scam/tools/sdev/sdev
       scam/tools/sdev/sdev.C
       scam/tools/sdev/Makefile
       scam/tools/sdev/README
       scam/tools/ncmult
       scam/tools/ncmult/ncmult.C
       scam/tools/ncmult/Makefile
       scam/tools/ncmult/README
       scam/tools/nctrans
       scam/tools/nctrans/nctrans
       scam/tools/nctrans/nctrans.C
       scam/tools/nctrans/Makefile
       scam/tools/nctrans/README
       scam/tools/diurnal_ave
       scam/tools/diurnal_ave/diurnal_ave
       scam/tools/diurnal_ave/diurnal_ave.C
       scam/tools/diurnal_ave/Makefile
       scam/tools/diurnal_ave/README
       scam/tools/intercomparison-post-processing
       scam/tools/intercomparison-post-processing/ncfile.C
       scam/tools/intercomparison-post-processing/field.C
       scam/tools/intercomparison-post-processing/post
       scam/tools/intercomparison-post-processing/ncfile.H
       scam/tools/intercomparison-post-processing/post.C
       scam/tools/intercomparison-post-processing/field.H
       scam/tools/intercomparison-post-processing/intercompare.scm
       scam/tools/intercomparison-post-processing/Makefile
       scam/tools/intercomparison-post-processing/process
       scam/tools/ncadd
       scam/tools/ncadd/ncadd
       scam/tools/ncadd/ncadd.C
       scam/tools/ncadd/Makefile
       scam/tools/ncadd/README
       scam/tools/pdf
       scam/tools/pdf/ferret.jnl
       scam/tools/pdf/pdf
       scam/tools/pdf/pdf.C
       scam/tools/pdf/Makefile
       scam/tools/pdf/README
       scam/tools/ccm2iop
       scam/tools/ccm2iop/ncfile.C
       scam/tools/ccm2iop/ncfile.cpp
       scam/tools/ccm2iop/ioerr.h
       scam/tools/ccm2iop/ncfile.h
       scam/tools/ccm2iop/Makefile
       scam/tools/ccm2iop/ccm2iop.C
       scam/tools/ccm2iop/test.nc
       scam/getlatlon.pl
       scam/testscript
       scam/html
       scam/html/userguide.html
       scam/html/tdiff-cam2.gif
       scam/html/gif
       scam/html/gif/tdiff-cam2.gif
       scam/html/gif/plot.gif
       scam/html/gif/tdiff3.2.gif
       scam/html/gif/tdiff3.6.gif
       scam/html/gif/post.gif
       scam/html/gif/formula1.gif
       scam/html/gif/formula2.gif
       scam/html/gif/iop.gif
       scam/html/gif/formula3.gif
       scam/html/gif/formula4.gif
       scam/html/gif/qdiff.gif
       scam/html/gif/formula5.gif
       scam/html/gif/formula6.gif
       scam/html/gif/tdiff.gif
       scam/html/gif/mainwnd.gif
       scam/html/gif/qls.gif
       scam/html/gif/global.gif
       scam/html/gif/sls.gif
       scam/html/gif/mainwin.gif
       scam/html/gif/uls.gif
       scam/html/gif/vls.gif
       scam/html/gif/w.gif
       scam/html/gif/option.gif
       scam/html/gif/g2.gif
       scam/html/gif/uphys.gif
       scam/html/gif/selectdata.gif
       scam/html/gif/vphys.gif
       scam/html/tdiff3.6.gif
       scam/html/index.html
       scam/scm_init
       scam/scm_init/init_model.F90
       scam/scm_init/misc.h
       scam/scm_init/scam_srfdata.F90
       scam/scm_init/drand48_.c
       scam/scm_init/get_levels.F90
       scam/scm_init/scam_srfdata_MCT.F90
       scam/scm_init/runtype.h
       scam/scm_init/scam_rpc.x
       scam/scm_init/calcdate.F90
       scam/scm_init/comfrc.h
       scam/scm_init/fortran.h
       scam/scm_init/ipc.h
       scam/scm_init/setlatlon.F90
       scam/scm_init/forecast.F90
       scam/scm_init/scam_run.F90
       scam/scm_init/myhandler.F
       scam/scm_init/realtype.h
       scam/scm_init/inital.F90
       scam/scm_init/readpressdata.F90
       scam/scm_init/c_outfld.c
       scam/scm_init/scamMod.F90
       scam/scm_init/c_outfld.h
       scam/scm_init/interplevs.F90
       scam/scm_init/getnetcdfdata.F90
       scam/scm_init/preproc.h
       scam/scm_init/setiopupdate.F90
       scam/scm_init/scam.c
       scam/scm_init/scam_fifo.c
       scam/scm_init/getinterpncdata.F90
       scam/scm_init/readiopdata.F90
       scam/scm_init/readsaveinit.F90
       scam/scm_init/max.h
       scam/scm_init/scam_fifo.h
       scam/INSTALL
       scam/mymods
       scam/mymods/README
       scam/userdata
       scam/userdata/crmtest18.in
       scam/userdata/crmtest26.out
       scam/userdata/crmdarwintest26.out
       scam/userdata/crmtest200.in
       scam/userdata/README
       scam/userdata/crmtest26.in
       scam/data
       scam/data/README
       scam/obj
       scam/obj/makdep.linux
       scam/obj/makdep
       scam/obj/Makefile
       scam/ui
       scam/ui/timeconvert.cpp
       scam/ui/PostPlottingDlg.h
       scam/ui/OptionsDlg.ui.h
       scam/ui/LoadData.ui
       scam/ui/utils.h
       scam/ui/history.h
       scam/ui/IOPSelectDateDlg.ui
       scam/ui/PlistDlgImpl.h
       scam/ui/rpcmodel.h
       scam/ui/defaults.h
       scam/ui/map.cpp
       scam/ui/PlistDlg.ui
       scam/ui/datasetselector.cw
       scam/ui/plot.cpp
       scam/ui/manager.h
       scam/ui/map.xbm
       scam/ui/msgdlg.h
       scam/ui/field.cpp
       scam/ui/globalmap.cw
       scam/ui/crm.h
       scam/ui/fieldlistbox.cpp
       scam/ui/dataset.h
       scam/ui/Platform.Notes
       scam/ui/ncarg.cpp
       scam/ui/observer.h
       scam/ui/IOPSelectDateDlg.ui.h
       scam/ui/PostPlottingDlg.cpp
       scam/ui/IOPSelectDateDlgImpl.cpp
       scam/ui/ncfile.cpp
       scam/ui/PlotDlg.ui
       scam/ui/LoadDataImpl.h
       scam/ui/history.cpp
       scam/ui/ascii_dataset.h
       scam/ui/globalmap.h
       scam/ui/fifomodel.cpp
       scam/ui/rpcmodel.cpp
       scam/ui/plot.cw
       scam/ui/GNUmakefile
       scam/ui/defaults.cpp
       scam/ui/ncarg
       scam/ui/ncarg/c.h
       scam/ui/SelectGlobalDataDlg.ui
       scam/ui/msgdlg.cpp
       scam/ui/sicfile.cpp
       scam/ui/list.h
       scam/ui/crm.cpp
       scam/ui/dbgmodel.h
       scam/ui/plot.h
       scam/ui/PostPlottingDlgImpl.h
       scam/ui/dataset.cpp
       scam/ui/MainWnd.ui
       scam/ui/world.xbm
       scam/ui/LoadDataImpl.cpp
       scam/ui/PlotDlgImpl.h
       scam/ui/fieldlistbox.h
       scam/ui/ncarg.h
       scam/ui/model.cpp
       scam/ui/configure
       scam/ui/IOPSelectDateDlgImpl.h
       scam/ui/map.cw
       scam/ui/OptionsDlgImpl.cpp
       scam/ui/ChangeAxisScaleDlg.ui
       scam/ui/ncfile.h
       scam/ui/SelectGlobalDataDlgImpl.h
       scam/ui/fifomodel.h
       scam/ui/ncarg_stubs.cpp
       scam/ui/fieldplotwidget.cw
       scam/ui/dbgmodel.cpp
       scam/ui/PostPlottingDlgImpl.cpp
       scam/ui/fortran.h
       scam/ui/numlined.h
       scam/ui/sicfile.h
       scam/ui/images
       scam/ui/images/editcopy
       scam/ui/images/editcut
       scam/ui/images/fileopen
       scam/ui/images/editpaste
       scam/ui/images/textbold
       scam/ui/images/undo
       scam/ui/images/searchfind
       scam/ui/images/filenew
       scam/ui/images/redo
       scam/ui/images/print
       scam/ui/images/filesave
       scam/ui/main.cpp
       scam/ui/MainWndImpl.h
       scam/ui/ioerr.h
       scam/ui/PlotDlgImpl.cpp
       scam/ui/ld.man
       scam/ui/ChangeAxisScaleDlgImpl.h
       scam/ui/utils.cpp
       scam/ui/SelectGlobalDataDlgImpl.cpp
       scam/ui/configure.works
       scam/ui/PlistDlgImpl.cpp
       scam/ui/timeconvert.h
       scam/ui/model.h
       scam/ui/OptionsDlgImpl.h
       scam/ui/manager.cpp
       scam/ui/OptionsDlg.ui
       scam/ui/fieldlistbox.cw
       scam/ui/MainWndImpl.cpp
       scam/ui/c.h
       scam/ui/field.h
       scam/ui/sst
       scam/ui/max.h
       scam/ui/ChangeAxisScaleDlgImpl.cpp

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:

The following test failed as part of the cam3_3_42 commit and also fail as part
of this commit.
	
038 sm355 TSM.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 8
039 er355 TER.sh fmo2dh off2x2.5 4+5 ..............................FAIL! rc= 5
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 4

        All ccsm tests through cam's test suite will now use the
	csm_share and clm code from the cam sandboxes rather than that
	from the latest ccsm tag (up to now it used just the cam code)

	
tempest:

bangkok/lf95:

CAM tag used for the baseline comparison tests if different than previous
tag:cam3_3_42

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

	NONE

If bitwise differences were observed, how did you show they were no worse
than roundoff?

	NA
	
If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

	NA
	
MSS location of control simulations used to validate new climate:

	NA
	
URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_3_42
Originator(s): Patrick Worley
Date: 24 Nov 2006
One-line Summary: refactored timer instrumentation and support for single timing output file

Purpose of changes:

	To update timing instrumentation to reflect recent model changes,
	and to improve 'coverage' by adding timers for all top level events.

	To improve usability on large numbers of processes by decreasing number 
	of process count-dependent files and lines of output:
	  - added option to generate single timing and spmdstats files
	    (containing all of the information that had been spread between
	     multiple files before)
	  - added option to restrict reporting of many runtime options and 
	    memory usage statistics to process 0
	These new options are enabled by default

Bugs fixed (include bugzilla ID):
        'debugging' shr_sys_flush call in seq_domain_mct.F90 erroneously left in 
	during earlier check-in caused error on Cray X1E

Describe any changes made to build system:
	Added new CPP flags:
	- MULTIPLE_PERF_FILES: if defined, timing and output files will be
	  created for each process (the previous default)
	- WRAP_MPI_TIMING: if defined, timing events are defined for each MPI
	  call in wrap_mpi.F90 (the previous default)

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Patrick Worley

List all subroutines eliminated:

List all subroutines added and what they do:
	t_pr_onef in utils/timing/f_wrappers.c:
	  variant of t_prf that write all timing data in one file
	t_enablef in utils/timing/f_wrappers.c,
	GPTL_enable in utils/timing/gptl.c:
	  runtime timing routine enabler
	t_disablef in utils/timing/f_wrappers.c,
	GPTL_disable in utils/timing/gptl.c:
	  runtime timing routine disabler

List all existing files that have been modified, and describe the changes:

	SVN_EXTERNAL_DIRECTORIES
	  using clm3_expa_79

	utils/SVN_EXTERNAL_DIRECTORIES
	  using timing_061124

        atm/cam/src/control/atm_comp_mct.F90
        atm/cam/src/control/cam_comp.F90
        atm/cam/src/control/wrap_mpi.F90
        atm/cam/src/dynamics/eul/dp_coupling.F90
        atm/cam/src/dynamics/eul/dyndrv.F90
        atm/cam/src/dynamics/eul/dynpkg.F90
        atm/cam/src/dynamics/eul/scan2.F90
        atm/cam/src/dynamics/eul/scandyn.F90
        atm/cam/src/dynamics/eul/scanslt.F90
        atm/cam/src/dynamics/eul/stepon.F90
        atm/cam/src/dynamics/fv/cd_core.F90
        atm/cam/src/dynamics/fv/dp_coupling.F90
        atm/cam/src/dynamics/fv/dyn_comp.F90
        atm/cam/src/dynamics/fv/mapz_module.F90 
        atm/cam/src/dynamics/fv/stepon.F90
        atm/cam/src/dynamics/fv/trac2d.F90
        atm/cam/src/dynamics/sld/dp_coupling.F90
        atm/cam/src/dynamics/sld/dyndrv.F90
        atm/cam/src/dynamics/sld/dynpkg.F90
        atm/cam/src/dynamics/sld/scan2.F90
        atm/cam/src/dynamics/sld/scandyn.F90
        atm/cam/src/dynamics/sld/scanslt.F90
        atm/cam/src/dynamics/sld/stepon.F90
        atm/cam/src/physics/cam1/convect_deep.F90
        atm/cam/src/physics/cam1/convect_shallow.F90
        atm/cam/src/physics/cam1/diffusion_solver.F90
        atm/cam/src/physics/cam1/physpkg.F90
        atm/cam/src/physics/cam1/radiation.F90
        atm/cam/src/physics/cam1/tphysac.F90
        atm/cam/src/physics/cam1/tphysbc.F90
        atm/cam/src/physics/cam1/vertical_diffusion.F90
        atm/cam/src/physics/cam1/zm_conv.F90
        drv/seq_mct_drv/seq_ccsm_drv.F90
        ice/csim4/ice_comp.F9
        ice/csim4/ice_comp_mct.F90
        ice/csim4/ice_srf.F90
        lnd/clm2/src/main/clm_comp.F90
        lnd/clm2/src/main/driver.F90
        lnd/clm2/src/main/lnd_comp_mct.F90
        ocn/dom/ocn_comp.F90
        ocn/dom/ocn_comp_mct.F90
        ocn/som/ocn_comp.F90
        ocn/som/ocn_comp_mct.F90
	  modified performance timer logic

        atm/cam/src/control/cam_comp.F90
          single spmdstats output file option
	
        atm/cam/src/control/cam_history.F90
          process 0-only reporting (eliminating unnecessary output)

        atm/cam/src/control/print_memusage.F90
          process 0-only reporting memory usage. Old default restored 
	  by defining DEBUG.

        atm/cam/src/dynamics/eul/spmd_dyn.F90
        atm/cam/src/dynamics/sld/spmd_dyn.F90
          process 0-only reporting of SPMD buffer allocation.

        atm/cam/src/physics/cam1/chem_surfvals.F90
        atm/cam/src/physics/cam1/prescribed_aerosols.F90
	  process 0-only reporting of runtime options

        drv/seq_mct/seq_domain_mct.F90
	  deleted 'call shr_sys_flush(25+iam)'
	
        drv/seq_mct_drv/seq_ccsm_drv.F90
	  disabled CATAMOUNT-specific call to usetlbuf; I/O buffering is now
	   the system default, and usetlbuf is unecessary
	  added option to create a single timing output file

        lnd/clm2/src/main/restFileMod.F90
	  (ask T. Craig or M. Vertenstein)

        utils/timing/f_wrappers.c 
	  added t_pr_onef, t_enablef, t_disablef

        utils/timing/gptl.c
        utils/timing/gptl.h
	  added GPTL_enable, GPTL_disable
	  modified GPTLpr to create either one timer output file,
	   or one file per process
          process 0-only reporting timing options. Old default restored 
           by defining DEBUG.

        utils/timing/gptl_papi.c
	  modified error message (mod. from J. Edwards)

        utils/timing/private.h
	  increased timing event name length

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASSED

tempest: All PASSED

bangkok/lf95: All PASSED

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_3_41
Originator(s): Francis Vitt
Date: 15 Nov 2006
One-line Summary: Added functionality and flexibility to the trop_mozart chemistry.

Purpose of changes:  

	To implement flexibility in the chemical mechanism used in trop_mozart 
	chemistry package.  This flexibility is provided
	via:
	 - flexible namelist variables
	 - helper functions which use data provided by the chemical preprocessor

	Use cam implemented prognostic sea salt and dust with the trop_mozart
	chemistry package.

	Use cam implemented rain out of trop_mozart aerosols.

	Provide the ability to use cam sulfur chemistry routines with trop_mozart
	chemistry package.

	Provide the ability to use prescribed chemical constituents and sources
	in trop_mozart chemistry package.

	Fix bug in the offline driver on bluevista.

Bugs fixed (include bugzilla ID): 
	#239 fv offline driver fails in cam on bluevista

Describe any changes made to build system:

Describe any changes made to the namelist:

	Added several namelist variables for trop_mozart chemistry package 
	for the flexable chemical mechanism implementation.  These are:
	
	! trop_mozart surface emissions:
	character(len=256) :: srf_emis_specifier(pcnst) ! string array where each 
	! string contains the constituent name and filepath separated by "->", e.g.
	! srf_emis_specifier = 'CO -> /path/CO_emis_file.nc','NO -> /path/NO_emis_file.nc',...
	character(len=8)   :: emis_type      ! 'CYCLICAL' | 'SERIAL' | 'FIXED'
	integer            :: emis_date      ! yyyymmdd for SERIAL(yyyy) or FIXED
	integer            :: emis_yr_offset ! yrs added to current model year for CYCLICAL

	! trop_mozart chem sources(sinks):
	character(len=256) :: ext_frc_specifier(pcnst) ! string array where each 
	! string contains the constituent name and filepath separated by "->", e.g.
	! ext_frc_specifier = 'CO -> /path/CO_extfrc_file.nc','NO -> /path/NO_extfrc_file.nc',...
	character(len=8)   :: ext_frc_type      ! 'CYCLICAL' | 'SERIAL' | 'FIXED'
	integer            :: ext_frc_date      ! yyyymmdd for SERIAL(yyyy) or FIXED
	integer            :: ext_frc_yr_offset ! yrs added to current model year for CYCLICAL

	! trop_mozart fixed lower boundary:
	character(len=16)  :: flbc_list(pcnst) ! list of constituents
	character(len=256) :: flbc_file         ! lower boundary data file
	character(len=8)   :: flbc_type         ! 'CYCLICAL' | 'SERIAL' | 'FIXED'
	integer            :: flbc_date         ! yyyymmdd for SERIAL(yyyy) or FIXED 
	integer            :: flbc_yr_offset    ! yrs added to current yr for CYCLICAL

	! trop_mozart constituents that have dry deposition
	character(len=16) :: drydep_list(pcnst)

	! trop_mozart constituents that are constrained in the stratosphere
	character(len=16)  :: fstrat_list(pcnst) ! list of constituents
	character(len=256) :: fstrat_file  ! data file for fixed stratosphere constituents
	character(len=256) :: trop_pause_file

	! trop_mozart aerosol constituents that have wet deposition
	character(len=16)  :: aer_wetdep_list(pcnst)

	! trop_mozart use CAM sulfur chemistry driver rather than mo_setsox
	logical            :: use_cam_sulfchem   
	! trop_mozart use CAM prescribed ozone for radiation rather than trop_moz prescribed data
	logical            :: use_cam_ozone_data
	! trop_mozart use CAM prescribed green house gases for radiation rather than trop_moz prescribed data
	logical            :: use_cam_ghg_data
	
	! trop_mozart prescribed constituents
	character(len=256) :: tracer_cnst_file              ! prescribed data file
	character(len=256) :: tracer_cnst_filelist          ! list of prescribed data files (series of files)
	character(len=256) :: tracer_cnst_specifier(pcnst) ! string array where each 
	! string contains the prescribed constituent name and field name in the data file separated by ":", e.g.
	! ext_frc_specifier = 'CO : CO_VMR','OH : OH_VMR',...
	logical :: tracer_cnst_rmfile ! remove data file from local disk (default .false.)
	integer :: tracer_cnst_ymd    ! yyyymmdd - start date of the prescribed data (default is current model date)
	integer :: tracer_cnst_tod    ! start time of day (seconds) of the prescribed data (default is current model time)

	! trop_mozart prescribed constituent sourrces/sinks
	character(len=256) :: tracer_srcs_file              ! prescribed data file
	character(len=256) :: tracer_srcs_filelist          ! list of prescribed data files (series of files)
	character(len=256) :: tracer_srcs_specifier(pcnst) ! string array where each 
	! string contains the constituent source name and field name in the data file separated by ":", e.g.
	! ext_frc_specifier = 'CO : CO_SRC','OH : OH_SRC',...
	logical :: tracer_srcs_rmfile ! remove data file from local disk (default .false.)
	integer :: tracer_srcs_ymd    ! yyyymmdd - start date of the prescribed data (default is current model date)
	integer :: tracer_srcs_tod    ! start time of day (seconds) of the prescribed data (default is current model time)
	
	Replaced the namelist variables for the individual species emissions 
	files with the srf_emis_specifier variable.

	Replaced trop_mozart ub and lb variables for individual species with 
	corresponding specifier variables as described above.
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

     atm/cam/src/chemistry/trop_mozart/mo_ch4_lbc.F90
     atm/cam/src/chemistry/trop_mozart/mo_lb_vals.F90
     atm/cam/src/chemistry/trop_mozart/mo_ub_vals.F90
     atm/cam/src/chemistry/trop_mozart/mo_wetdep.F90

List all subroutines added and what they do:

     atm/cam/src/chemistry/trop_mozart/mo_chem_utls.F90
	provides helper functons to allow easier changes in chemical mechanisms
	
     atm/cam/src/chemistry/trop_mozart/mo_extfrc.F90
	provides the ability to include external (or prescribed) sources (or sinks)
	
     atm/cam/src/chemistry/trop_mozart/mo_flbc.F90
	applies fixed lower boundary conditions to constituents
	
     atm/cam/src/chemistry/trop_mozart/mo_fstrat.F90
	applies constraints to constituents in the stratosphere
	
     atm/cam/src/chemistry/trop_mozart/mo_sethet.F90
	replaces mo_wetdep module -- set heterogeneous reaction rates
	
     atm/cam/src/chemistry/trop_mozart/mo_synoz.F90
	implements synthetic ozone scheme in the stratosphere
	
     atm/cam/src/chemistry/trop_mozart/mz_aerosols_intr.F90
	handles the wet depostion of trop_mozart aerososl as well as the
	operation of cam implemented sulfur chemistry routines on trop_mozart
	constituents

     atm/cam/src/chemistry/trop_mozart/tracer_cnst.F90
     atm/cam/src/chemistry/trop_mozart/tracer_data.F90
     atm/cam/src/chemistry/trop_mozart/tracer_srcs.F90
	These provide the ability to use prescribed constituents as well as 
	sources for the trop_mozart chemical mechanism.

     atm/cam/src/chemistry/trop_mozart/rad_cnst_data_interface.F90
	Overrides the cam routines that set radiative constituents to prescribed 
	data to use trop_mozart prescribed data.
	
     atm/cam/src/physics/cam1/rad_cnst_data_interface.F90
	provides the chemistry packages the opportunity to override procedures 
	that set the radiative constituents from prescribed data
	
     atm/cam/src/dynamics/fv/advect_tend.F90
	Handles the computation and history output of advection tendency.

List all existing files that have been modified, and describe the changes:

    atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
	Change defualt upper boundary data files and dust input files.
	
    atm/cam/bld/cam_inparm.pm
	Made changes to accommodate the namelist changes for the trop_mozart
	chemistry package.
	Set default aero_feedback=.false. since a special aerosol optics 
	file is required for dust.
	
    atm/cam/bld/config_trop_chem_mozart_defaults.xml
	set prog_aero="dust,seasalt" and nadv=98 for default trop_mozart chemistry
	
    atm/cam/bld/configure
	- allow prog_aero seasalt without dust for trop_mozart chemistry
	- set cppdef DUST for seasalt or dust when trop_mozart is used
	- disallow prog_aero sulfur and caer (carbon aerosols) when 
	  trop_mozart is used
	
    atm/cam/src/chemistry/trop_mozart/chem_mods.F90
    atm/cam/src/chemistry/trop_mozart/chemistry.F90
    atm/cam/src/chemistry/trop_mozart/m_het_id.F90
    atm/cam/src/chemistry/trop_mozart/m_spc_id.F90
    atm/cam/src/chemistry/trop_mozart/mo_aerosols.F90
    atm/cam/src/chemistry/trop_mozart/mo_airplane.F90
    atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
    atm/cam/src/chemistry/trop_mozart/mo_constants.F90
    atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
    atm/cam/src/chemistry/trop_mozart/mo_exp_sol.F90
    atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
    atm/cam/src/chemistry/trop_mozart/mo_imp_sol.F90
    atm/cam/src/chemistry/trop_mozart/mo_indprd.F90
    atm/cam/src/chemistry/trop_mozart/mo_jlong.F90
    atm/cam/src/chemistry/trop_mozart/mo_jshort.F90
    atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
    atm/cam/src/chemistry/trop_mozart/mo_lin_matrix.F90
    atm/cam/src/chemistry/trop_mozart/mo_lu_factor.F90
    atm/cam/src/chemistry/trop_mozart/mo_lu_solve.F90
    atm/cam/src/chemistry/trop_mozart/mo_mass_xforms.F90
    atm/cam/src/chemistry/trop_mozart/mo_nln_matrix.F90
    atm/cam/src/chemistry/trop_mozart/mo_photo.F90
    atm/cam/src/chemistry/trop_mozart/mo_photoin.F90
    atm/cam/src/chemistry/trop_mozart/mo_prod_loss.F90
    atm/cam/src/chemistry/trop_mozart/mo_rtlink.F90
    atm/cam/src/chemistry/trop_mozart/mo_seasalt.F90
    atm/cam/src/chemistry/trop_mozart/mo_setaer.F90
    atm/cam/src/chemistry/trop_mozart/mo_setext.F90
    atm/cam/src/chemistry/trop_mozart/mo_setinv.F90
    atm/cam/src/chemistry/trop_mozart/mo_setrxt.F90
    atm/cam/src/chemistry/trop_mozart/mo_setsoa.F90
    atm/cam/src/chemistry/trop_mozart/mo_setsox.F90
    atm/cam/src/chemistry/trop_mozart/mo_sim_dat.F90
    atm/cam/src/chemistry/trop_mozart/mo_srf_emissions.F90
    atm/cam/src/chemistry/trop_mozart/mo_strato_sad.F90
    atm/cam/src/chemistry/trop_mozart/mo_tropopause.F90
    atm/cam/src/chemistry/trop_mozart/mo_usrrxt.F90
	Changes in the trop_mozart chemistry are mostly for:
	- the addition to SYNOZ/O3RAD ozone formulation and NH4/H2SO4 chemistry
	- flexible namelist variables
	- addition of helper functions to allow flexibility in terms of 
	  chemical mechanisms facilitated by the chemical preprocessor

    atm/cam/src/chemistry/waccm_mozart/chemistry.F90
	interface changes that correspond to the interface changes of
	trop_mozart/chemistry.F90

    atm/cam/src/control/atm_comp_mct.F90
	Added a check to insure that dust constituents are in the 
	simulation before setting the dust surface fluxes.
	
    atm/cam/src/control/runtime_opts.F90
	Added several namelist variables for trop_mozart chemistry package 
	for the flexible chemical mechanism implementation (see above).
	Added a check to not allow trace_gas = .true. when trop_mozart 
	chemistry package is used.

    atm/cam/src/dynamics/fv/dyn_comp.F90
	Changed the actual argument "dyn_state%grid" to "grid" to
	subroutines metdata_dyn_init, get_met_fields and adjust_press.
	
    atm/cam/src/dynamics/fv/metdata.F90
	Removed the unnecessary ghosting of US and VS in the get_us_vs
	subroutine.
	
    atm/cam/src/dynamics/fv/stepon.F90
	Added calls to compute and output advection tendencies.
	
    atm/cam/src/physics/cam1/aerosol_intr.F90
	Moved the call to hub2atm_sepopts to aerosol_register_cnst
	from the dust_intr module -- this is to allow one to have
	sea salt constituents without dust constituents.
	Disabled the register call for dust and sea salts when 
	trop_mozart chemistry package is used.
	Added the invocation of wet deposition of trop_mozart aerosols.
	
    atm/cam/src/physics/cam1/aerosol_radiation_interface.F90
	added optical depth history outputs of carbon and dust
	
    atm/cam/src/physics/cam1/chemistry.F90
	interface changes that correspond to the interface changes of
	trop_mozart/chemistry.F90

    atm/cam/src/physics/cam1/convect_deep.F90
	add prognostics outputs of convective mass fluxes
	
    atm/cam/src/physics/cam1/drydep_mod.F90
	don't allow surface friction velocity returned from calcram
	to be equal to zero -- zero fv causes a float point exception
	in the dry deposition calculation of dust and sea salt
	
    atm/cam/src/physics/cam1/dust_intr.F90
	changes dust names
	a lot of code cleanup
	added the public interfaces: 
	   dust_set_idx, dust_names, and dust_has_wet_dep
		
    atm/cam/src/physics/cam1/progseasalts_intr.F90
	changes sea salt names
	a lot of code cleanup
	added the public interfaces: 
	   progseasalts_set_idx, progseasalt_names, and progseasalt_has_wet_dep
	
    atm/cam/src/physics/cam1/rad_constituents.F90
	added string variables to be used for radiative constituent names 
	
    atm/cam/src/physics/cam1/radiation.F90
	replaced hard wired radiative constituent names with string 
	variables defined on the rad_constituents module
	
    atm/cam/src/physics/cam1/restart_physics.F90
	added a call to write and read chemistry data to restart file
	
    atm/cam/src/physics/cam1/sulchem.F90
	created a sulfur chemistry driver seperate from the wet deposition
	-- this gives the trop_mozart chemistry the opportunity to use 
	the "cam" sulfur chemistry routines without the wet deposition.
	
    atm/cam/src/physics/cam1/sulfur_intr.F90
	moved some of the addfld calls to sulchem.F90 -- where the
	fields are output to history
	
    atm/cam/src/physics/waccm/chemistry.F90
	interface changes that correspond to the interface changes of
	trop_mozart/chemistry.F90

    drv/seq_flds/dust/seq_flds_mod.F90
	corrected fortran syntax errors and made changes for ibm compile

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:

037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 5
These failures are expected due to changes in trop_mozart chemistry package.	

tempest:  All Pass

bangkok/lf95:  All Pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_40
Originator(s): eaton
Date: Tue Nov  7 10:19:16 MST 2006
One-line Summary: Misc updates

Purpose of changes:

. Replace all occurances of 273.16 either by SHR_CONST_TKFRZ or by tmelt
  which is the CAM specific constant that's set to SHR_CONST_TKFRZ in the
  physconst module.

. Remove the cfort.h file -- put the Fortran name mangling CPP macro into 
  CAM and SCAM's configure.

. Remove cfort.h from the timing library.  This required creating a new
  trunk_tag for the timing library (timing_061028) and updating CAM's
  external property to use it.

. Update MCT to trunk_tag MCT2_2_3_061018.

. Update CLM to trunk_tag clm3_expa_76.

. Remove excessive info/debug print statements (there is more to do).

. Fix bug (introduced at cam3_3_34) to enable running w/ HOMME dycore.


Bugs fixed (include bugzilla ID):

. bugID 224 -- fix for SHR_CONST_TKFRZ

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

. possible performance improvements on certain platforms due to update of
  MCT and CLM externals

Code reviewed by: eaton

List all subroutines eliminated:

  atm/cam/src/utils/cfort.h

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

. SHR_CONST_TKFRZ mods in:
  models/atm/cam/src/physics/cam1/stratiform.F90
  models/atm/cam/src/physics/cam1/wetdep.F90
  models/atm/cam/src/physics/cam1/sulchem.F90
  models/atm/cam/src/physics/cam1/water_isotopes.F90
  models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90

. mods to remove cfort.h in:
  models/atm/cam/bld/configure
  models/atm/cam/bld/Makefile.in
  models/atm/cam/tools/scam/configure
  models/atm/cam/src/control/get_memusage.c
  models/atm/cam/src/control/linebuf_stdout.c
  models/atm/cam/src/control/uselbuf.c
  models/utils/timing/f_wrappers.c      # create trunk_tag timing_061028

. update external for timing library, MCT, and CLM
  models/SVN_EXTERNAL_DIRECTORIES
  models/utils/SVN_EXTERNAL_DIRECTORIES

. remove excessive info print statements
  models/atm/cam/src/physics/cam1/phys_grid.F90
  models/atm/cam/src/control/cam_history.F90

. Replace deprecated float intrinsic by real
  models/atm/cam/src/control/interpolate_data.F90


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista: All PASS except expected failures of offline trop_mozart tests:

038 sm355 TSM.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 8
039 er355 TER.sh fmo2dh off2x2.5 4+5 ..............................FAIL! rc= 5
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 4

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: BFB

===============================================================
===============================================================

Tag name: cam3_3_39
Originator(s): mvertens
Date: Fri Nov  3 16:40:37 MST 2006
One-line Summary: Top level driver now invokes cam as one run phase
	
Purpose of changes: To have CAM called as one run phase from the top level driver.
This is necessary if the surface components are to couple to cam at frequencies
other than the cam time step (a feature that will be required for a sequential CCSM).

Bugs fixed (include bugzilla ID): #255

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: eaton

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:
   M   atm/cam/tools/scam/scm_init/init_model.F90
   M   atm/cam/tools/scam/scm_init/scam_run.F90
   M   atm/cam/src/control/atm_comp_mct.F90
   M   drv/seq_mct_drv/seq_ccsm_drv.F90
       - Seq_ccsm_drv.F90 and scam_run.F90 will now call only one run phase of cam. 
         The basic idea is that the first time the cam run phase is called outside 
         of the time loop, it will only call tphysbc. Within the run loop the cam 
         mct levelrun phase will call tphysac, update the cam time and then call tphysbc.

   M   drv/seq_mct/seq_domain_mct.F90
       - removed extra writes 

   M   drv/seq_mct/seq_flux_mct.F90
       - fixed bug #255

   M   drv/seq_flds/dust/seq_flds_mod.F90
   M   drv/seq_flds/default/seq_flds_mod.F90
   M   drv/seq_flds/gensom/seq_flds_mod.F90
   M   drv/seq_flds_indices/seq_flds_indices.F90
       - Added Foxx_salt to drv->ocn fields
         Note needed now, but will be needed when pop is used for active ocn

   M   drv/seq_mct/mrg_x2o_mct.F90
       - Fixed bugs for fields needed in merging when active ocean will be 
         utilized

   M   ice/csim4/ice_data.F90
   M   ice/csim4/ice_dh.F
   M   ice/csim4/ice_srf.F90
   M   ice/csim4/ice_comp.F90
   M   atm/cam/src/control/runtime_opts.F90
   M   atm/cam/src/control/cam_control_mod.F90
       - moved input namelist variables prognostic_icesnow and reset_csim_iceprops
         from ice_dh to cam_control_mod.F90. This will make it possible to replace
         cam-csim with cice4.   

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
019 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 7
- this test failed due to a sign change implemented for the latent/sensible 
  oi gensom fluxes (this was a bug introduced in cam3_3_37 that did not get picked
  up in the testing. 
038 sm355 TSM.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 8
039 er355 TER.sh fmo2dh off2x2.5 4+5 ..............................FAIL! rc= 5
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 4
- these tests began failing with the upgrade of the compilers on bluevista 
  around 060918...a retest of a previous tag (cam3_3_28) where these tests 
  had passed, showed these tests now fail as well...it fails run-time as it 
  tries to read in the met data...see bug #239

tempest: All tests passed except for
021 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 7
- this tested failed due to the same gensom bug fix as appeared in bluevista
  test 19

bangkok/lf95: All tests passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: None, answers are bfb except for gensom oi diagnostics
          
===============================================================
===============================================================

Tag name:  cam3_3_38
Originator(s):  mvr
Date: 20061027
One-line Summary:  mods to resolve naming conflict when cam is used in 
a ccsm single-executable; bluevista replaces bluesky as required pretag 
test platform; mods to conform to changes in ccsm's test scripts

Purpose of changes: one more naming conflict in ccsm single-executable 
that was overlooked; bluesky is scheduled for decommission by the end 
of the year, so bluevista will now be the platform required for testing 
cam prior to commits; ccsm changed its default behavior for cleanup 
of files after successful tests - a change was made to specifically 
turn off this cleanup and let cam's test scripts handle the cleanup

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself

List all subroutines eliminated:
D      models/atm/cam/src/control/restart.F90
- just a rename required to clear up name conflict in ccsm single-executable

List all subroutines added and what they do:
A  +   models/atm/cam/src/control/cam_restart.F90
- newly named file and mods to clear up name conflict in ccsm single-executable
A      models/atm/cam/test/system/tests_pretag_bluevista
- new file with test ids to run by default for pretag testing on bluevista

List all existing files that have been modified, and describe the changes:
M      models/ocn/dom/ocn_comp.F90
M      models/ocn/som/ocn_comp.F90
M      models/ice/csim4/ice_comp.F90
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/ccsm_msg.F90
M      models/atm/cam/src/control/cam_comp.F90
M      models/drv/seq_mct/mrg_x2a_mct.F90
- files modified to reflect name change: restart -> cam_restart

M      ChangeLog_template
M      models/atm/cam/test/system/TSB.ccsm.sh
M      models/atm/cam/test/system/TCT.ccsm.sh
M      models/atm/cam/test/system/tests_posttag_bluesky
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/tests_posttag_bluevista
- mods to test scripts to have bluevista replace bluesky as the required 
  platform for pretag testing, utilize mods in ccsm scripts for the bluevista16
  machine definition, and turned off ccsm's cleanup functionality
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluevista:
038 sm355 TSM.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 8
039 er355 TER.sh fmo2dh off2x2.5 4+5 ..............................FAIL! rc= 5
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 4
- these tests began failing with the upgrade of the compilers on bluevista 
  around 060918...a retest of a previous tag (cam3_3_28) where these tests 
  had passed, showed these tests now fail as well...it fails run-time as it 
  tries to read in the met data...see bug #239

tempest:
all pass
	
bangkok/lf95:
all pass
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_37
Originator(s): mvertens
Date: Tue Oct 24 22:58:04 MDT 2006
One-line Summary: use cpl6 ocn/atm flux calculation and surface flux sign convention

Purpose of changes: To bring the current sequential system in line with the 
  concurrent system atm/ocn flux calculation, ocn and ice and merge functionalities,
  and ccsm surface flux sign convention. In addition, to remove the need for the ice
  and ocean components to know pass any landfrac information to the top level driver.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none (to the best of my knowledge)

Code reviewed by: mvertens, rjacob, tcraig

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

   M  ocn/dom/ocn_comp.F90
      - Removed all references to lwup
   M  ocn/dom/ocn_comp_mct.F90
      - Removed latr and lonr from dom_o - conversion is now done in seq_flux_mct.F90
      - Removed o2x_o(index_o2x_Faoo_lwup,ig) - (now done in atm/ocn flux calc)
      - Removed setting of maxfrac to 1.-landfrac in dom_o

   M  ocn/som/ocn_types.F90
      - Removed lwup from ocn_out type
   M  ocn/som/ocn_comp.F90
      - Removed computation of lwup (now done in atm/ocn flux calc)
      - Removed lwup from restart file
   M  ocn/som/ocn_comp_mct.F90
      - Removed latr and lonr from dom_o - conversion is now done in seq_flux_mct.F90
      - Removed o2x_o(index_o2x_Faoo_lwup,ig) - (now done in atm/ocn flux calc)
      - Removed setting of maxfrac to 1.-landfrac in dom_o
      - Set sign convention to fluxes are positive downwards
      - Moved multiplication of fswabs, shflx, lhflx, lwdn and lwup by (1.-aice)
        to mrg_x2o_mct.F90 (this is consistent now with ocn merging in cpl6)

   M  ice/csim4/ice_types.F90
      - Made cflx component of ice_out one-dimensional
      - Made qbot component of ice_in one-dimensional
      - Removed reference to pcnst
   M  ice/csim4/ice_srf.F90
      - Fluxes are now positive downwards for lwup, shflx, lhflx, taux, tauy, qflx
      - Removed setting of non-water constituent fluxes to zero
      - Arguemnts qbot and qflx no longer depend on pcnst+pnats
   M  ice/csim4/ice_diagnostics.F
      - Made qbot component of ice_in one-dimensional
   M  ice/csim4/ice_comp.F90
      - Sign convention for lwup is now that fluxes are positive downwards
      - Removed references to aqua-planet
   M  ice/csim4/ice_comp_mct.F90
      - Removed i2x_i%rAttr(index_i2x_Si_aice,ig) and set i2x_i%rAttr(index_i2x_Si_ifrac,ig) 
        to now correspond to fraction of ice with respect to ocean part of gridcell

   M  atm/cam/test/system/test_driver.sh
      - Updates to lightning and bluevista tests
      - Replaced x2a_a%rAttr(index_x2a_Faoo_lwup,n) with x2a_a%rAttr(index_x2a_Faox_lwup,n)

   M  atm/cam/src/control/atm_comp_mct.F90
      - Sign convention is that all fluxes from driver are positive downwards

   M  drv/seq_flds/dust/seq_flds_mod.F90
   M  drv/seq_flds/default/seq_flds_mod.F90
   M  drv/seq_flds/gensom/seq_flds_mod.F90
   M  drv/seq_flds_indices/seq_flds_indices.F90
      - Added fields and indices to get closer to cpl_fields_mod. This involved adding:
         'So_u'            ! velocity, zonal                 DEF
         'So_v'            ! velocity, meridional            DEF
         'So_s'            ! salinity                        DEF
         'So_dhdx'         ! surface slope, zonal            DEF
         'So_dhdy'         ! surface slope, meridional       DEF
         'Si_ifrac'        ! state: ice fraction wrt ocean   DEF
         'Sa_pslv'         ! state: sea level pressure       DEF
         'Foxx_lwup'       ! heat flux: long-wave up         DEF
         'Foxx_prec'       ! water flux: rain+snow           DEF
         'Foxx_snow'       ! water flux: snow                DEF
         'Foxx_rain'       ! water flux: rain                DEF
         'Foxx_evap'       ! water flux: evap                DEF
         'Foxx_meltw'      ! water flux: melt                DEF
         'Forr_roff'       ! water flux: runoff              DEF
         'Faoo_lwup'       ! shortwave: net absorbed         DEF 
         'Faox_lwup'       ! upward longwave heat flux       DEF 
      and removed Si_aice and changed the previous functionality of Si_ifrac
      Some of the above fields are not currently used - but are place holders for
      when the ccsm components will be put in.

   M  atm/cam/tools/scam/scm_init/init_model.F90
      - Added domain information to mapping initialization

   M  drv/seq_mct_drv/seq_ccsm_drv.F90
      - Added domain information to mapping initialization

   M  drv/seq_mct/mrg_x2a_mct.F90
      - Replaced index_o2x_Faoo_lwup with index_xao_Faox_lwup 

   M  drv/seq_mct/mrg_x2o_mct.F90
      - Merging functionality for input to ocn component is now same as cpl6

   M  drv/seq_mct/seq_domain_mct.F90
      - maxfrac_o = 1.- maxfrac_l is set for points where maxfrac_l > 0 and
        maxfrac_l < 1. The same is true for maxfrac_i. As a result, the ocean 
        and ice components need not know the land fraction in the gridcell.
        Furthermore, the ice fraction need only be scaled as that relative to
        the total gridcell for merging functionality from drv->atm. The ice fraction
        is only needed relative to the ocean part of the gridcell for merging 
        functionality from drv->ocn.

   M  drv/seq_mct/seq_flux_mct.F90
      - xao_o%rAttr(index_xao_Faox_lwup,n) is now used (instead of lwup
        being calculated by the ocean components)
      - flux_albo is not identical to cpl6 code

   M  drv/seq_mct/flux_ao.F90
      - This code is now the same as the flux_atmOcn routine in the cpl6 flux_mod.F90.
        Both this routine and flux_atmOcn will be migrated to a csm_share/shr/shr_flux_mod.F90
        code base in upcoming tags.

   M  drv/seq_mct/seq_mct_mod.F90
      - Added use aliases for mct_aVectimport Rattr and mct_aVect_exportRattr

   M  drv/seq_mct/map_atmice_mct.F90
      - Obtain maxfrac_ice on atmosphere decomp, needed for merging to atmosphere grid
        when all components are on same grid and when partial land cover in ice gridcell.
      - Added domain information to initialization phase 

   M  drv/seq_mct/map_atmlnd_mct.F90
   M  drv/seq_mct/map_iceocn_mct.F90
   M  drv/seq_mct/map_atmocn_mct.F90
      - Added domain information to initialization phases 

   SVN_EXTERNALS has been updated to clm3_expa_75
   M  lnd/clm2/src/main/clm_time_manager.F90
      - Removed write statement to fort.30
   M  lnd/clm2/src/main/lnd_comp_mct.F90
      - Changed sign convention of fluxes sent to driver to be consistent 
        with those used by concurrent ccsm

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: all tests passed except for

  005 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
  015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 7
  019 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 7
  030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 7
  034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
  037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
  044 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
  047 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
  054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 5

  the above were bfb except for the TREFHT output (which is not totally different)

  008 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
  022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
  040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7

  the above represent round-off level diffs for som tests

tempest: all tests passed except for

  004 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
  014 bl152 TBL.sh e64o outfrq24h -2 ................................FAIL! rc= 7
  017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 7
  021 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 7
  031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
  035 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
  045 bl552 TBL.sh s64o outfrq24h -2 ................................FAIL! rc= 7

  the above were bfb except for the TREFHT output (which is not totally different)

  007 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
  024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
  038 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7

  the above represent round-off level diffs for som tests

bangkok/lf95: all tests passed except for

  004 bl111 TBL.sh e8c8mdm ttrac 9 ..................................FAIL! rc= 7
  016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
  024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 7
  032 bl511 TBL.sh s8c8mdm ttrac 9 ..................................FAIL! rc= 7

  the above were bfb except for the TREFHT output (which is not totally different)

  012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
  028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
  040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7

  the above represent round-off level diffs due to higher optimization levels 
  than the 9 timestep tests 

  008 bl112 TBL.sh e8sdm ghgrmp 9 ...................................FAIL! rc= 7
  036 bl512 TBL.sh s8sdm ghgrmp 9 ...................................FAIL! rc= 7

  the above represent round-off level diffs for som tests

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- nature of change (larger than roundoff but same climate)

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,

- source tag (all code used must be in the repository): 
  cam3_3_37
- platform/compilers: 
  ibm (bluesky)
- configure commandline:
  configure -ocn dom -dyn fv -spmd -smp -test -res 4x5 -gensom
- build-namelist command (or complete namelist):
  &ccsm_inparm
   case_name	= 'cam3_3_34_nonbfb_fv4x5dom'
   start_type	= "startup"
  /
  &timemgr_inparm
   atm_cpl_dt	= 1800
   orb_iyear_ad	= 1950
   restart_option= 'monthly'
   start_ymd	= 10101
   stop_n	= 4000
   stop_option	= 'ndays'
  /
  &cam_inparm
   absems_data	= '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/abs_ems_factors_fastvx.c030508.nc'
   aeroptics	= '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/AerosolOptics_c050419.nc'
   bnd_topo	= '/fis/cgd/cseg/csm/inputdata/atm/cam/topo/USGS-gtopo30_4x5_remap_c050520.nc'
   bndtvaer	= '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/AerosolMass_V_4x5_clim_c031022.nc'
   bndtvo	= '/fis/cgd/cseg/csm/inputdata/atm/cam/ozone/pcmdio3.r8.64x1_L60_clim_c970515.nc'
   bndtvs	= '/fis/cgd/cseg/csm/inputdata/atm/cam/sst/sst_HadOIBl_bc_4x5_clim_c030228.nc'
   dtime	= 1800
   ncdata	= '/fis/cgd/cseg/csm/inputdata/atm/cam/inic/fv/cami_0001-01-01_4x5_L26_c060608.nc'
  /
  &clm_inparm
   dtime	= 1800
   fpftcon	= '/fis/cgd/cseg/csm/inputdata/lnd/clm2/pftdata/pft-physiology-cn16.c040719'
   fsurdat	= '/fis/cgd/cseg/csm/inputdata/lnd/clm2/srfdata/cam/clms_3.1_4x5_c050523.nc'
  /
  
MSS location of output:
  /MVERTENS/csm/cam3_3_34_nonbfb_fv4x5dom

MSS location of control simulations used to validate new climate:
  /MVERTENS/csm/cam3_3_34_nonbfb_fv4x5dom_0

URL for AMWG diagnostics output used to validate new climate:
http://www.cgd.ucar.edu/cms/rneale/runs/cam/cam3_3_34_nonbfb_fv4x5dom-cam3_3_34_nonbfb_fv4x5dom_0/
===============================================================
===============================================================

Tag name: cam3_3_36
Originator(s): mvertens
Date: Tue Oct 24 21:58:40 MDT 2006
One-line Summary: non-bfb changes corresponding to cam3_3_37

Purpose of changes: to create the minimal code base that generates the
  greater than round-off changes in cam3_3_37. Since cam3_3_37 will
  contain number round-off level changes for som, it is useful to isolate
  the few pieces of code that produced the greater than round-off differences.a

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: mvertens
   M models/ocn/dom/ocn_comp.F90
     - Computation of lwup is occuring before temperature is updated. This is
       now consistent with obtaining lwup from atm/ocn flux computation. This
       will ensure that all fluxes in atm/ocn flux computation (including lwup)
       are based on the same surface temperature.
   M models/ocn/som/ocn_comp.F90
     - No longer multiplying onf by 1.-aice. Now doing this to each component of
       onf in ocn_comp_mct.F90
   M models/ocn/som/ocn_comp_mct.F90
     - Now multiplying Foxx_melth, Foxx_swnet, Foxx_sen, Foxx_lat and Foxx_lwdn, 
       and lwup by 1.-aice.
   M models/atm/cam/src/control/atm_comp_mct.F90
     - At first time step determine the longwave up flux from the surface
       temperature. This is identical to what is being done in ccsm_msg.F90
   M models/drv/seq_mct/seq_flux_mct.F90
     - Put in computation to no longer require lat/lon to be passed in radians
       from the ocean domain. Ocean domain will now pass lat/lon in degrees and 
       will convert to radians.
     - Set ocean albedos to 1. when coszen < 0.
   M models/drv/seq_mct/flux_ao.F90
     - Set umin to 0.5_r8 
       This is the only answer changing modification between this code and the 
       atm/ocn flux calcuation code in cpl6. The goal is for both the concurrent 
       and sequential ccsm to use the same atm/ocn flux calculation code base.
       Note that the diagnostic TREF will be totally different when the cpl6 
       atm/ocn flux calculation is utilized

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: all passed except for following baseline comparisons
   005 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
   008 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
   010 bl133 TBL.sh e32pdh aqpgro 3 ..................................FAIL! rc= 7
   015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 7
   019 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 7
   022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
   024 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 7
   030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 7
   034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
   037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
   040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
   044 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
   047 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
   049 bl533 TBL.sh s32pdh aqpgro 3 ..................................FAIL! rc= 7
   054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 7

tempest: all passed except for following baseline comparisons
   004 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 5
   007 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 5
   009 bl133 TBL.sh e32pdh aqpgro 3 ..................................FAIL! rc= 5
   012 bl135 TBL.sh e32dh idphys 9 ...................................FAIL! rc= 5
   014 bl152 TBL.sh e64o outfrq24h -2 ................................FAIL! rc= 5
   017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 5
   021 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 5
   024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 5
   026 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 5
   029 bl335 TBL.sh f4dh idphys 9 ....................................FAIL! rc= 5
   031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 5
   035 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 5
   038 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 5
   040 bl533 TBL.sh s32pdh aqpgro 3 ..................................FAIL! rc= 5
   043 bl535 TBL.sh s32dh idphys 9 ...................................FAIL! rc= 5
   045 bl552 TBL.sh s64o outfrq24h -2 ................................FAIL! rc= 5

bangkok/lf95: all passed except for following baseline comparisons
   004 bl111 TBL.sh e8c8mdm ttrac 9 ..................................FAIL! rc= 7
   008 bl112 TBL.sh e8sdm ghgrmp 9 ...................................FAIL! rc= 7
   010 bl113 TBL.sh e8pdm aqpgro 3 ...................................FAIL! rc= 7
   012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
   016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
   024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 7
   026 bl313 TBL.sh f10pdm aqpgro 3 ..................................FAIL! rc= 7
   028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
   032 bl511 TBL.sh s8c8mdm ttrac 9 ..................................FAIL! rc= 7
   036 bl512 TBL.sh s8sdm ghgrmp 9 ...................................FAIL! rc= 7
   038 bl513 TBL.sh s8pdm aqpgro 3 ...................................FAIL! rc= 7
   040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7

CAM tag used for the baseline comparison tests if different than previous
tag: 

Summarize any changes to answers, i.e.,
- nature of change (larger than roundoff but same climate)
  see complete documentation of runs to evaluate changes in cam3_3_37 tag info

===============================================================
===============================================================

Tag name: cam3_3_35
Originator(s): Jim Edwards
Date: 10-11-2006
One-line Summary: homme dycore development, replacement of cam common blocks

Purpose of changes: development, code clean-up

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: refined build support for target_os=bgl 

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:

Code reviewed by: self

List all subroutines eliminated:
D            2094   models/atm/cam/src/control/comtfc.h
D            2094   models/atm/cam/src/control/comfft.h
D            2094   models/atm/cam/src/control/comctl.h
D            2094   models/atm/cam/src/control/comqfl.h
D            2094   models/atm/cam/src/control/perturb.h
D            2094   models/atm/cam/src/physics/cam1/comsol.h
D            2094   models/atm/cam/src/physics/cam1/comtsc.h
D            2094   models/atm/cam/src/physics/cam1/comadj.h

List all subroutines added and what they do:
These are data modules which replace the common blocks eliminated above, 
because the fv_control_mod contains namelist variables it needs to be compiled
regardless of dycore - thus it's location in the control directory.   
	
A  +            -   models/atm/cam/src/control/cam_control_mod.F90
A  +            -   models/atm/cam/src/control/fv_control_mod.F90
A  +            -   models/atm/cam/src/dynamics/sld/sld_control_mod.F90
A  +            -   models/atm/cam/src/dynamics/eul/eul_control_mod.F90


List all existing files that have been modified, and describe the changes:
Changes related to the continuing development of the homme dycore:
M            2094   models/atm/cam/src/dynamics/homme/external/forcing_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/parallel_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/element_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/dof_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/bndry_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/diffusion_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/baroclinic_inst_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/external/edge_mod.F90
M            2094   models/atm/cam/src/dynamics/homme/README
M            2094   models/atm/cam/src/dynamics/homme/dp_coupling.F90
M            2094   models/atm/cam/src/dynamics/homme/stepon.F90
M            2094   models/atm/cam/src/dynamics/homme/inidat.F90
M            2094   models/atm/cam/src/dynamics/homme/dyn_comp.F90
M            2094   models/atm/cam/src/dynamics/homme/restart_dynamics.F90
M            2094   models/atm/cam/src/dynamics/homme/inital.F90
C            2094   models/ocn/dom/sst_data.F90
M            2094   models/atm/cam/tools/interpic_new/README
M            2094   models/atm/cam/bld/configure
M            2094   models/atm/cam/bld/Makefile.in
M            2094   models/atm/cam/src/control/cam_history.F90
M            2094   models/atm/cam/src/utils/abortutils.F90
M            2094   models/atm/cam/src/physics/cam1/tphysidl.F90

Changes related to the elemination of common blocks (note: there is some overlap in these lists): 
C            2094   models/ocn/dom/sst_data.F90
M            2094   models/ocn/dom/ocn_comp.F90
M            2094   models/ocn/som/somint.F90
M            2094   models/ocn/som/ocn_comp.F90
M            2094   models/ocn/som/somini.F90
M            2094   models/ice/csim4/ice_data.F90
C            2094   models/ice/csim4/ice_comp.F90
M            2094   models/atm/cam/tools/scam/scm_init/init_model.F90
M            2094   models/atm/cam/tools/scam/scm_init/forecast.F90
M            2094   models/atm/cam/tools/scam/scm_init/inital.F90
M            2094   models/atm/cam/tools/scam/scm_init/readiopdata.F90
M            2094   models/atm/cam/src/control/readinitial.F90
M            2094   models/atm/cam/src/control/history_defaults.F90
M            2094   models/atm/cam/src/control/runtime_opts.F90
M            2094   models/atm/cam/src/control/ncdio_atm.F90
M            2094   models/atm/cam/src/control/srfxfer.F90
M            2094   models/atm/cam/src/control/restart.F90
M            2094   models/atm/cam/src/control/startup_initialconds.F90
M            2094   models/atm/cam/src/control/history_scam.F90
C            2094   models/atm/cam/src/control/cam_comp.F90
M            2094   models/atm/cam/src/control/cam_history.F90
M            2094   models/atm/cam/src/physics/cam1/initindx.F90
M            2094   models/atm/cam/src/physics/cam1/zenith.F90
M            2094   models/atm/cam/src/physics/cam1/radiation.F90
M            2094   models/atm/cam/src/physics/cam1/tphysbc.F90
M            2094   models/atm/cam/src/physics/cam1/check_energy.F90
M            2094   models/atm/cam/src/physics/cam1/restart_physics.F90
M            2094   models/atm/cam/src/physics/cam1/cam_diagnostics.F90
M            2094   models/atm/cam/src/physics/cam1/phys_gmean.F90
M            2094   models/atm/cam/src/physics/cam1/stratiform.F90
M            2094   models/atm/cam/src/physics/cam1/physics_types.F90
M            2094   models/atm/cam/src/physics/cam1/radlw.F90
M            2094   models/atm/cam/src/physics/cam1/tsinti.F90
M            2094   models/atm/cam/src/physics/cam1/co2_data_flux.F90
M            2094   models/atm/cam/src/physics/cam1/physpkg.F90
M            2094   models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
M            2094   models/atm/cam/src/physics/cam1/dadadj.F90
M            2094   models/atm/cam/src/physics/cam1/chemistry.F90
M            2094   models/atm/cam/src/physics/cam1/phys_buffer.F90
M            2094   models/atm/cam/src/physics/cam1/ramp_scon.F90
M            2094   models/atm/cam/src/physics/cam1/phys_grid.F90
M            2094   models/atm/cam/src/physics/cam1/advnce.F90
M            2094   models/atm/cam/src/physics/cam1/tphysac.F90
M            2094   models/atm/cam/src/physics/cam1/zm_conv.F90
M            2094   models/atm/cam/src/physics/cam1/cldwat.F90
M            2094   models/atm/cam/src/physics/waccm/nlte_fomichev.F90
M            2094   models/atm/cam/src/physics/waccm/chemistry.F90
M            2094   models/atm/cam/src/chemistry/waccm_mozart/mo_gas_phase_chemdr.F90
M            2094   models/atm/cam/src/chemistry/waccm_mozart/solvar_interface.F90
M            2094   models/atm/cam/src/chemistry/waccm_mozart/mo_apex.F90
M            2094   models/atm/cam/src/chemistry/waccm_mozart/efield.F90
M            2094   models/atm/cam/src/chemistry/waccm_mozart/mo_waccm_hrates.F90
M            2094   models/atm/cam/src/chemistry/waccm_mozart/exbdrift.F90
M            2094   models/atm/cam/src/dynamics/sld/spegrd.F90
M            2094   models/atm/cam/src/dynamics/sld/linemsdyn.F90
M            2094   models/atm/cam/src/dynamics/sld/initcom.F90
M            2094   models/atm/cam/src/dynamics/sld/scanslt.F90
M            2094   models/atm/cam/src/dynamics/sld/inidat.F90
M            2094   models/atm/cam/src/dynamics/sld/dyn_comp.F90
M            2094   models/atm/cam/src/dynamics/sld/hordif.F90
M            2094   models/atm/cam/src/dynamics/sld/spetru.F90
M            2094   models/atm/cam/src/dynamics/sld/scan2.F90
M            2094   models/atm/cam/src/dynamics/sld/restart_dynamics.F90
M            2094   models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
M            2094   models/atm/cam/src/dynamics/eul/spegrd.F90
M            2094   models/atm/cam/src/dynamics/eul/initcom.F90
M            2094   models/atm/cam/src/dynamics/eul/linemsdyn.F90
M            2094   models/atm/cam/src/dynamics/eul/scanslt.F90
M            2094   models/atm/cam/src/dynamics/eul/inidat.F90
M            2094   models/atm/cam/src/dynamics/eul/dyn_comp.F90
M            2094   models/atm/cam/src/dynamics/eul/hordif.F90
M            2094   models/atm/cam/src/dynamics/eul/spetru.F90
M            2094   models/atm/cam/src/dynamics/eul/scan2.F90
M            2094   models/atm/cam/src/dynamics/eul/restart_dynamics.F90
M            2094   models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
M            2094   models/atm/cam/src/dynamics/fv/pmgrid.F90
M            2094   models/atm/cam/src/dynamics/fv/initcom.F90
M            2094   models/atm/cam/src/dynamics/fv/dryairm.F90
M            2094   models/atm/cam/src/dynamics/fv/inidat.F90
M            2094   models/atm/cam/src/dynamics/fv/dyn_comp.F90
M            2094   models/atm/cam/src/dynamics/fv/inital.F90
M            2094   models/atm/cam/src/dynamics/fv/stepon.F90
M            2094   models/atm/cam/src/dynamics/fv/restart_dynamics.F90
M            2094   models/atm/cam/src/dynamics/fv/metdata.F90
M            2094   models/atm/cam/src/advection/slt/difcor.F90
C            2094   models/drv/seq_mct/mrg_x2l_mct.F90

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: none

tempest: none

bangkok/lf95: none

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
	- what code configurations: - what platforms/compilers: - nature
	of change (roundoff; larger than roundoff but same climate; new
	climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_34
Originator(s): Will Sawyer
Date: Wed Oct 11 03:05:07 MDT 2006
One-line Summary: Reduce init time (#213), clean up FV constants (#214), allocate status (#166)

Purpose of changes:

	o  PILGRIM initialization time has been reduced (Bug #213).  This has 
	   been achieved by removing the communications for XZY index and replacing
	   them by XYZ communication patterns.  These are assembled by generating
	   an XY decomposition comm. pattern, then extending it to 3D in the 
	   (undistributed) Z direction.  This reduces initialization time, drastically
	   in the case of high resolution.  Note that this change required extensive
	   restructuring of cam_history.

	o  The status of allocation of large 3-D arrays in FV is checked (Bug #166)

	o  FV constants were cleaned up in a consistent way (Bug #214), e.g.,
	
  	     real(r8), parameter ::  D0_0                    =  0.0_r8
	     real(r8), parameter ::  D0_5                    =  0.5_r8
	     real(r8), parameter ::  D1_0                    =  1.0_r8
	     real(r8), parameter ::  D1_5                    =  1.5_r8
	
Bugs fixed (include bugzilla ID):  #166, #213, #214

Describe any changes made to build system:  none

Describe any changes made to the namelist:  none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:  FV initialization time is
	now much faster, especially so for high resolutions.

Code reviewed by:  myself

List all subroutines eliminated:  none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

	models/atm/cam/src/control/cam_history.F90:  Extensive changes to use 
	    XYZ indexing to gather and scatter arrays.  Now only one type of 
	    PILGRIM gather/scatter operation (fv_gather_??, fv_scatter_??)
	    is used.  Addition of routines to copy the *local* portion of the 
	    array from XYZ -> XZY (loc_xyz_to_xzy) and XZY -> XYZ (loc_xzy_to_xyz)
	    decompositions.  Performing this local give a minor performance 
	    improvement.  Overall this reduces the length and complexity of the
	    module. Treats the writing of the staggered U-winds field (which 
	    has 1 less latitude than other fields) in a cleaner way.  Now
	    writes all fields to restart consistently in XYZ indexing.
	    
	models/atm/cam/src/dynamics/fv/benergy.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/cd_core.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/d2a3dijk.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/d2a3dikj.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/dp_coupling.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/dyn_grid.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/dynconst.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/epvd.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/fill_module.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/fv_prints.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/geopk.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/inital.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/initcom.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/mapz_module.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/mean_module.F90: new treatment of constants, e.g.,
	models/atm/cam/src/dynamics/fv/metdata.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/p_d_adjust.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/par_vecsum.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/pfixer.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/pft_module.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/stepon.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/sw_core.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/te_map.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/trac2d.F90: new treatment of constants
	models/atm/cam/src/dynamics/fv/tp_core.F90: new treatment of constants, cleaning
	models/atm/cam/src/dynamics/fv/xpavg.F90: new treatment of constants

	models/atm/cam/src/dynamics/fv/dyn_comp.F90: new treatment of constants, test return
	            status of allocations

	models/atm/cam/src/dynamics/fv/inidat.F90: new treatment of constants, test return
	    status of allocations, use new naming scheme for scatter/gather comm. patterns

	models/atm/cam/src/dynamics/fv/restart_dynamics.F90: new treatment of constants;
	   use new naming scheme for scatter/gather comm. patterns

	models/atm/cam/src/dynamics/fv/io_dist.F90: extensive cleaning.  Removed old 
	   methods for writing and reading; scheme is now consistent with
	   fv_read/write_r4/r8/i4 and fv_scatter/gather_r4/r8/i4 routines.

	models/atm/cam/src/dynamics/fv/dynamics_vars.F90: removed (unused) ESMF code
	   revised naming scheme for gather/scatter comm. patterns now consistent,
	   added PI argument to dynamics_init, dynpkg_init;  XYZ patterns generated
	   by XY pattern with extension in Z; new treatment of constants

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:  Failed on tests 030 (bl336), 034 (bl351), 055 (cs998), probably 
	  because of new treatment of constants, specifically removal of
	  4.0*atan(1.0) as definition of PI.  Perturbation growth tests by
	  Brian Eaton indicate that these are roundoff differences.  Check-in
	  OK'ed by Mathew Rothstein.
	   
tempest:  passes all tests

bangkok/lf95: passes all tests

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_3_33 (previous tag)

Summarize any changes to answers, i.e.,
- what code configurations:  WACCM, FV
- what platforms/compilers:  Bluesky
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):  roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff?    perturbation growth test (by Eaton)

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

===============================================================

Tag name: cam3_3_33
Originator(s): eaton
Date: Fri Oct  6 16:22:01 MDT 2006
One-line Summary: Enable linking to external ESMF library

Purpose of changes:

. Changes to configure and Makefile.in to allow linking to ESMF library
  This can be done by:
  1. setting the new -esmf_libdir option,
  or
  2. by setting the environment variable ESMF_LIBDIR.

  Either of these methods will cause configure to check that the
  files libesmf.a or libesmf.so and esmf.mk are present in the specified
  directory.  The esmf.mk file is produced when the ESMF library is built
  and contains Makefile macros that CAM's Makefile will reference when
  compiling and linking to the external library.

. Remove interactive mode from configure.

. Cleanup of Makefile.in.  Remove untested SUN and OSF1 sections.

Bugs fixed (include bugzilla ID):

. Fix bug in fv/inidat.F90 applying perturbation to initial temperature
  field.

. Fixed SCAM build on bangkok.

Describe any changes made to build system:

. Add ability to link to an external ESMF library.  The default remains to use
  the WRF_ESMF time manager code.

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

models/atm/cam/bld/configure
. Add capability to specify that an external ESMF library should be used.
. Add test for linking to the ESMF library to test suite invoked by
  configure's -test option.
. Add ability to try running a successfully built test.  This helps to
  identify problems related shared libraries not being found.
. Remove interactive mode.
. Simplify verbose mode; now set by "-v" option without a numeric argument.

models/atm/cam/bld/Makefile.in
. Include the esmf.mk file if ESMF_LIBDIR is defined.
. use ESMF_F90COMPILEPATHS from esmf.mk to set search path for esmf module file .
. Use ESMF_F90LINKPATHS and ESMF_F90ESMFLINKLIBS from esmf.mk to set search
  path and library name for linking to external esmf lib.
. Remove 32-bit addressing option for AIX.  If this is needed somewhere it
  should be re-implemented in configure rather than by requiring editing of the
  Makefile.
. Remove unused SUN and OSF1 sections.
. Substantial cleanup.  Tried to eliminate duplicated code from the
  architecture specific sections of the Makefile.  Tried to organize the
  architecture specific sections to more or less follow the same order of
  setting macros.

models/atm/cam/src/dynamics/fv/inidat.F90
. fix bug in how perturbation was applied to initial temperature field.

models/atm/cam/test/system/test_driver.sh
. increase to bluevista time limit from 2:28 to 4:28 to account for
  slowdown in compilation times
. update pathscale compiler version to 2.4 from 2.2.1 (on lightning)

models/atm/cam/tools/scam/ui/configure
. add -lpgc to the LINK_LIBS macro in the Linux section.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_32
Originator(s): mvertens
Date: Mon Oct  2 21:03:25 MDT 2006
One-line Summary: Have SCAM driver determine the fractional
   land cover in any gridcell.

Purpose of changes: remove SCAM if-defs in lnd_comp_mct.F90
  and put the logic in SCAM driver.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: erik, eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:
   M   ocn/dom/ocn_comp_mct.F90
       - removed SCAM if-def
   M   ocn/som/ocn_comp_mct.F90
       - removed SCAM if-def
   M   atm/cam/tools/scam/scm_init/init_model.F90
   M   atm/cam/tools/scam/scm_init/scamMod.F90
       - changes enable SCAM to read in landfrac for the gridcell and determine
         if the land model should be called
   M   SVN_EXTERNAL_DIRECTORIES
       - updated to clm_exp_73
   M   drv/seq_mct_drv/seq_ccsm_drv.F90
       - formatting change
   M   lnd/clm2/src/main/lnd_comp_mct.F90
       - removed SCAM if-defs 

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: ALL TESTS PASSED
tempest: ALL TESTS PASSED
bangkok/lf95: ALL TESTS PASSED

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE
===============================================================
===============================================================

Tag name: cam3_3_31
Originator(s): mvertens
Date: Tue Sep 26 19:48:56 MDT 2006
One-line Summary: made surface components mpi utilities and clm time manager independent of cam 

Purpose of changes: cam surface components no longer "use" cam communicator group settings
   and clm no longer uses cam time manager when in COUP_CAM mode

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist:
   M atm/cam/bld/clm_inparm.pm
   M atm/cam/bld/SeqCCSM_namelist.pm
     - added dtime to clm namelist input

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton, tcraig, robj

List all subroutines eliminated: none

List all subroutines added and what they do:

   A  ocn/dom/ocn_spmd.F90
      - determine communicator group and masterproc, iam, npes for ocn
   A  ocn/som/ocn_spmd.F90
      - determine communicator group and masterproc, iam, npes for ocn
   A  ice/csim4/ice_spmd.F90
      - determine communicator group and masterproc, iam, npes for ice
   A  drv/seq_mct/seq_communicator.F90
      - determine communicator group and masterproc, iam, npes for drv routines

List all existing files that have been modified, and describe the changes:

   M   ocn/dom/sst_data.F90
       - replace "use mpishorthand" with "use ocn_utils"
       - made explicit calls to mpi_bcast rather than the interfaces in mpishorthand
   M   ocn/dom/ocn_comp.F90
       - replace "use spmd_utils" with "use ocn_utils"
       - ocn_mpicom now passed in as argument and used to initialize ocn communicator
         group, masterproc, iam and npes 
   M   ocn/dom/ocn_comp_mct.F90
       - ocn_mpicom now passed in as argument
       - replaced call to module routine seq_init_SetgsMap with call to mct routine
         mct_gsMap_init in order to initialize gsmap
     
   M   ocn/som/mixed_layer.F90
       - replace "use mpishorthand" with "use ocn_utils"
       - made explicit calls to mpi_bcast rather than the interfaces in mpishorthand
   M   ocn/som/ocn_comp.F90
       - replace "use spmd_utils" with "use ocn_utils"
       - ocn_mpicom now passed in as argument and used to initialize ocn communicator
         group, masterproc, iam and npes 
       - fixed bug in conservation check equation (this is turned off in all tests)
         ocn_in(c)%netfocn replaced with ocn_in(c)%melth 
   M   ocn/som/somini.F90
       - replace "use mpishorthand" with "use ocn_utils"
       - made explicit calls to mpi_bcast rather than the interfaces in mpishorthand
   M   ocn/som/ocn_comp_mct.F90
       - ocn_mpicom now passed in as argument
       - replaced call to module routine seq_init_SetgsMap with call to mct routine
         mct_gsMap_init in order to initialize gsmap
     
   M   ice/csim4/ice_data.F90
       - replace "use spmd_utils" with "use ice_utils"
       - made explicit calls to mpi_bcast rather than the interfaces in mpishorthand
   M   ice/csim4/print_coverage.F90
       - replace "use spmd_utils" with "use ice_utils"
   M   ice/csim4/ice_comp.F90
       - replace "use spmd_utils" with "use ice_utils"
       - made explicit calls to mpi_bcast rather than the interfaces in mpishorthand
   M   ice/csim4/ice_comp_mct.F90
       - added ICEID and mpicom_ice to input arguments
       - replaced call to module routine seq_init_SetgsMap with call to mct routine
         mct_gsMap_init in order to initialize gsmap

   M   atm/cam/tools/scam/scm_init/init_model.F90
       - put in changes analogous to those in seq_ccsm_drv.F90
   M   atm/cam/tools/scam/scm_init/scam_run.F90
       - separated calls to ocn_run_mct and atm/ocn flux calculation into two separate blocks
   M   atm/cam/tools/scam/scm_init/scamMod.F90
       - added dtime_out as argument to scam_clm_default_opts (see clm notes below

   M   atm/cam/src/control/con_cam.F90
       - removed call to cam_init2 (call to cam_init1 now is call to cam_init)
       - removed call to spmdinit
       - mpicom now passed as argument to cam_init
   M   atm/cam/src/control/atm_comp_mct.F90
   M   atm/cam/src/control/cam_comp.F90
       - removed cam_init2 and replaced cam_init1 with cam_init
       - call to intht is now done on first call of cam_comp
   M   atm/cam/src/utils/spmd_utils.F90
       - no longer calls mpi_init when COUP_CSM ins not defined
       - removed code-block for if-defined IRIX (no longer needed)
       - mpicom_atm passed as now as argument
   M   atm/cam/src/utils/time_manager.F90
       - removed module variables perpetual_ymd and perpetual_run (no longer needed)

   M   SVN_EXTERNAL_DIRECTORIES
       - now using clm3_expa_73 
       - clm3_expa_73 no longer uses the cam time manager and as a result dtime needs to be
         specified explicitly in the clm namelist 
       - clm3_expa_73 also no longer obtains irad from the call to the cam routine radiation_get
         as a result bugzilla #228 has been added

   M   drv/seq_mct_drv/seq_ccsm_drv.F90
       - removed call to atm_init2
       - mpi now initialized in seq_ccsm_drv.F90 rather than in the cam routine spmdinit
       - currently it is assumed that cam and all the surface components will utilize the global
         communicator group
       - mpicom_glob now passed as an argument to cam and the surface components
       - replaced calls to mrg_x2*_alloc_mct with mrg_x2*_init_mct, and removed the original calls
         to mrg_x2*

   M   drv/seq_mct/seq_init_mct.F90
       - now calls mpi_init (rather than in cam routine spmdinit)
       - removed routine seq_init_setgsmap (see above)
   M   drv/seq_mct/seq_domain_mct.F90
       - replaced "use mpishorthand" with "use seq_comunicator"
       - removed explicit setting of mpicom=1 when SPMD is not defined
   M   drv/seq_mct/seq_flux_mct.F90
       - replaced "use mpishorthand" with "use seq_comunicator"
       - removed explicit setting of mpicom=1 when SPMD is not defined
   M   drv/seq_mct/mrg_x2a_mct.F90
       - replaced "use mpishorthand" with "use seq_comunicator"
       - replaced hard-wired copies for each field with mct call to mct_aVect_copy.
   M   drv/seq_mct/mrg_x2i_mct.F90
       - replaced "use mpishorthand" with "use seq_comunicator"
         all common attribute vector components from one attribute vector to another.
       - replaced hard-wired copies for each field with mct call to mct_aVect_copy (only
         rain and snow are now hard-wired in the copy command). mct_aVect_copy will copy
       - removed explicit setting of mpicom=1 when SPMD is not defined
   M   drv/seq_mct/mrg_x2l_mct.F90
       - replaced "use mpishorthand" with "use seq_comunicator"
       - removed explicit setting of mpicom=1 when SPMD is not defined
       - replaced hard-wired copies for each field with mct call to mct_aVect_copy.
   M   drv/seq_mct/mrg_x2o_mct.F90
       - replaced "use mpishorthand" with "use seq_comunicator"
       - removed explicit setting of mpicom=1 when SPMD is not defined

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: ALL PASS
tempest: ALL PASS
bangkok/lf95: ALL PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE

===============================================================
===============================================================

Tag name: cam3_3_30
Originator(s): Jim Edwards
	       Pat Worley (phys_grid)
Date: 09-21-2006
One-line Summary: homme dycore development

Purpose of changes: homme dycore development

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: added build for bluegene

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Edwards, Eaton

List all subroutines eliminated: 

List all subroutines added and what they do: added dynamics/homme/external

List all existing files that have been modified, and describe the changes:

	Improved documentation for creating initial and boundary files
	for the homme dycore
M      models/atm/cam/tools/interpic_new/README
	
       Added support for bluegene system at NCAR (frost)
	and improved support for homme dycore.
M      models/atm/cam/bld/configure
M      models/atm/cam/bld/Makefile.in
M      models/atm/cam/bld/namelist.pm
A  +   models/atm/cam/bld/filter_nl.pm
M      models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
M      models/atm/cam/bld/system_defaults.xml
A  +   models/atm/cam/bld/DefaultCTL_NL_Namelist.xml
M      models/atm/cam/bld/cam_inparm.pm
M      models/atm/cam/bld/resolution_parameters.xml
A  +   models/atm/cam/bld/ctl_nl.pm
M      models/atm/cam/bld/config_cam_homme_defaults.xml
M      models/atm/cam/bld/SeqCCSM_namelist.pm
A  +   models/atm/cam/bld/DefaultFILTER_NL_Namelist.xml

	Improved the interface that allows reading multiple namelists from multiple source code files.
	Fixed a problem with the dyn_grid -> phys_grid mapping apparent in the homme dycore.
	
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/con_cam.F90
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/cam_comp.F90
M      models/atm/cam/src/control/cam_history.F90
M      models/atm/cam/src/physics/cam1/boundarydata.F90
M      models/atm/cam/src/physics/cam1/physpkg.F90
M      models/atm/cam/src/physics/cam1/phys_grid.F90
M      models/atm/cam/src/physics/cam1/cldwat.F90
M      models/atm/cam/src/dynamics/fv/inital.F90

Continued development of the homme dycore: the external directory represents a 
	mirror of the files in repository 
	https://svn-homme-model.cgd.ucar.edu/trunk/src/share
	
A  +   models/atm/cam/src/dynamics/homme/external
A  +   models/atm/cam/src/dynamics/homme/external/flops_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/filter_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/math_constants.F90
A  +   models/atm/cam/src/dynamics/homme/external/forcing_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/stats.h
A  +   models/atm/cam/src/dynamics/homme/external/preq_init_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/interface.h
A  +   models/atm/cam/src/dynamics/homme/external/schedule_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/reduction_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/parallel_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/spacecurve_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/utils_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/derivative_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/prim_state_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/dimensions_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/locate.F90
A  +   models/atm/cam/src/dynamics/homme/external/prim_restart_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/torus_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/quadrature_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/coordinate_systems_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/global_norms_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/control_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/element_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/time_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/prim_si_ref_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/stats.F90
A  +   models/atm/cam/src/dynamics/homme/external/hybvcoord_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/checksum_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/prim_advection_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/directions.F90
A  +   models/atm/cam/src/dynamics/homme/external/thread_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/dof_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/physical_constants.F90
A  +   models/atm/cam/src/dynamics/homme/external/kinds.F90
A  +   models/atm/cam/src/dynamics/homme/external/solver_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/restart_io_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/namelist_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/perfmodel_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/bndry_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/metis_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/params_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/field_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/diffusion_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/mass_matrix_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/prim_advance_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/cg_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/prim_si_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/types_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/domain_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/gridgraph_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/metagraph_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/generic_list.F90
A  +   models/atm/cam/src/dynamics/homme/external/ref_state_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/vertex_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/cube_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/physics_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/rotation_init.F90
A  +   models/atm/cam/src/dynamics/homme/external/interpolate_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/linear_algebra_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/baroclinic_inst_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/edge_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/ll_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/vertical_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/timer.h
A  +   models/atm/cam/src/dynamics/homme/external/timer_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/state_mod.F90
A  +   models/atm/cam/src/dynamics/homme/external/hybrid_mod.F90
A  +   models/atm/cam/src/dynamics/homme/io_dist.F90
M      models/atm/cam/src/dynamics/homme/dyn_grid.F90
M      models/atm/cam/src/dynamics/homme/dp_coupling.F90
M      models/atm/cam/src/dynamics/homme/dyn_comp.F90
M      models/atm/cam/src/dynamics/homme/inidat.F90
M      models/atm/cam/src/dynamics/homme/stepon.F90
M      models/atm/cam/src/dynamics/homme/spmd_dyn.F90
M      models/atm/cam/src/dynamics/homme/inital.F90
	

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: passed

tempest: passed

bangkok/lf95: passed

CAM tag used for the baseline comparison tests if different than previous
tag:  cam3_2_28

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_3_29
Originator(s): jwolfe, eaton
Date: Wed Sep 20 17:08:08 MDT 2006
One-line Summary: fix for single executable CCSM

Purpose of changes: fix for single executable CCSM

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

In con_cam.F90 change this:

#ifdef SINGLE_EXEC
   call MPH_get_argument("THREADS", nthreads, "atm")
   call OMP_SET_NUM_THREADS(nthreads)
#endif

to this:

#ifdef SINGLE_EXEC
   call MPH_get_argument("THREADS", nThreads, "atm")
#ifdef _OPENMP
   call OMP_SET_NUM_THREADS(nThreads)
#endif
#endif

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: not done

tempest: not done

bangkok/lf95: not done

Tests not done because this change is inside an ifdef that isn't turned on
for any of CAM's current regression tests.

===============================================================
===============================================================

Tag name:  cam3_3_28 
Originator(s): mvr, jwolfe
Date:  060914
One-line Summary:  implemented last remaining items needed for cam to 
be included in a ccsm single-executable; bug fix to enable scam to compile

Purpose of changes: ccsm single-executable required a few more mods, 
including one name conflict that was overlooked; a compile-time bug was 
introduced to the scam build in cam3_3_27

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself, eaton, mvertens

List all subroutines eliminated: 
D      models/atm/cam/src/physics/cam1/diagnostics.F90
- just a rename required to clear up name conflict in ccsm single-executable

List all subroutines added and what they do:
A  +   models/atm/cam/src/physics/cam1/cam_diagnostics.F90
- newly named file and mods to clear up name conflict in ccsm single-executable
	
List all existing files that have been modified, and describe the changes:
M      models/ice/csim4/ice_comp.F90
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/con_cam.F90
M      models/atm/cam/src/physics/cam1/tphysbc.F90
M      models/atm/cam/src/physics/cam1/physpkg.F90
- files modified to reflect name change: diagnostics -> cam_diagnostics

M      models/atm/cam/tools/scam/scm_init/init_model.F90
- bug fix to enable scam to compile
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
ALL PASS

tempest:
ALL PASS

bangkok/lf95:
ALL PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_27
Originator(s): mvertens
Date: Mon Sep 11 21:44:10 MDT 2006
One-line Summary: moved atm/ocn flux calculation to top level

Purpose of changes:

Moved the atmosphere/ocean flux calculation out of the ocn (dom/som)
models and up to the top level driver. This is a necessary stop in constructing
a sequential ccsm system. It will also enable the use of the cpl6 atm/ocn flux
calculation to be utilized in both the sequential and concurrent system. 

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: Probably none (this should be checked)

Code reviewed by: eaton, erik (briefly)

List all subroutines eliminated: 

    D      ocn/dom/albocean.F90
             - calculation now done in seq_flux_mct.F90 (see below)
    D      ocn/dom/print_coverage.F90
             - not used by any code in dom/
    D      ocn/dom/parpbl.h
             - only used in flxoce.F90 - which is no longer utilized
    D      ocn/dom/albedo.h
             - not used by any code in dom/
    D      ocn/dom/wtrc_flxoce.F90
             - moved to atm/cam/src/control
    D      ocn/dom/flxoce.F90
             - replaced by flux_ao routine (see below)
    D      ocn/dom/srfoce.F90
             - see below

    D      ocn/som/albocean.F90
             - calculation now done in seq_flux_mct.F90 (see below)
    D      ocn/som/mixed_layer_globalcalcs.F90
    D      ocn/som/ocn_srf.F90
             - ocn_srf.F90 and mixed_layer_globalcalcs.F90 merged into mixed_layer.F90
    D      ocn/som/parpbl.h
             - only used in flxoce.F90 - which is no longer utilized
    D      ocn/som/flxoce.F90
             - replaced by flux_ao routine (see below)

List all subroutines added and what they do:

    A      ocn/som/mixed_layer.F90
             - merge of mixed_layer_globalcalcs.F90 and ocn_srf.F90

    A      atm/cam/src/control/wtrc_flxoce.F90
             - moved computation of water tracer exchange from ocean into atmospheric code base
               to reduce number of fields that need to be exchanged between ocean and atmosphere

    A      drv/seq_mct/seq_flux_mct.F90
    A      drv/seq_mct/flux_ao.F90
             - performs calculation previously done in dom/flxocn.F90 and som/flxocn.F90
             - also calculates ocean albedo and net shortwace absorbed by surface

List all existing files that have been modified, and describe the changes:

    M      ocn/dom/sst_data.F90
    M      ocn/dom/ocn_types.F90
    M      ocn/dom/ocn_comp.F90
    M      ocn/dom/ocn_comp_mct.F90
            - see below 

    M      ocn/som/ocn_types.F90
    M      ocn/som/ocn_comp.F90
    M      ocn/som/ocn_comp_mct.F90
            - see below 

    M      atm/cam/tools/scam/scm_init/init_model.F90
    M      atm/cam/tools/scam/scm_init/scam_srfdata_MCT.F90
    M      atm/cam/tools/scam/scm_init/scam_run.F90
            - put in changes to incorporate xao_o and xao_a along with calls to ocean/atmosphere
              flux calculation from top level driver

    M      atm/cam/src/control/ccsm_msg.F90
    M      atm/cam/src/control/camsrfexch_types.F90
            - added "rho, netsw, ustar, re, ssq" as  cam_out components in camsrfexch_types.F90
    M      atm/cam/src/control/srfxfer.F90
            - removed rho and netsw as module variables in ccsm_msg.F90
    M      atm/cam/src/control/atm_comp_mct.F90
            - introduced call to wtrc_flxoce if trace_water is true
            - replace call to atm_init1_mct with atm_init_mct
            - added ustar, re and ssq to x1a_a input

    M      drv/seq_flds/dust/seq_flds_mod.F90
    M      drv/seq_flds/default/seq_flds_mod.F90
    M      drv/seq_flds/gensom/seq_flds_mod.F90
             - see below

    M      drv/seq_mct_drv/seq_ccsm_drv.F90
    M      drv/seq_mct/mrg_x2a_mct.F90
             - replaced o2x_a components that are now calculated in seq_flux_mct with xao_a components 
    M      drv/seq_mct/mrg_x2i_mct.F90
             - removed index_o2x_So_tsocn from o2x_i and x2i_i
    M      drv/seq_mct/mrg_x2o_mct.F90
             - removed unnecessary a2x_o (this is now utilized in atm/ocn flux calculatin in seq_flux_mct)
    M      drv/seq_flds_indices/seq_flds_indices.F90
             - put in changes necessary for new atm/ocn flux computation at top level (see below)

    Summary: New attribute vectors xao_o and xao_a were introduced at the top level 
             to account for the calculation of the atm/ocn flux calculation. 

             The routines dom/srfoce.F90, dom/flxoce.F90 and som/flxoce.F90 were replaced with 
             drv/seq_mct/flux_ao.F90 and drv/seq_mct/seq_flux_mct.F90.
             The current form of flx_ao.F90 is such that it can be replaced with
             the equivalent coupler code once sign conventions are addressed. (Note,
             to increase clarity som/ocn_srf.F90 and som/mixed_layer_globalcalcs.F90 were
             merged to create som/mixed_layer.F90).

             The ocean albedo calculation was also moved out of the ocean code and 
             put into seq_flux_mct.F90. As a result, ocn/som/albocean.F90 and
             ocn/dom/albedo.h are no longer needed). The new routine to calculate ocean albedos, 
             seq_flux_albo_mct, is now contained in seq_flux_mct.F90.

	     Ocean input information was significantly altered as a result of bringing the atm/ocn
             flux calculation out of the ocean code base. The CAM DOM code now does not need any 
             input information. The CAM SOM code also requires significantly less input information
	     (only netsw from the atmosphere). 

             It is important to note that lwup is still being computed in the ocean code. The 
             impact on SOM needs to be evaluated when moving this calculation to the 
             atm/ocean flux routine (as is done in the cpl6 code).
             
             The routine, wtrc_flxoce.F90 (isotope calculation) was moved out of the ocean model 
             and into atm/cam/src/control. The extra fields necessary to do this 
             computation (ustar, re, ssq) were added to the x2a attribute vector.
             Note that this feature is currently not tested.
            
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: ALL PASSED
tempest: ALL PASSED
bangkok/lf95: ALL PASSED except for
   012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
   028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
   040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7
   - the above difference appear to be roundoff errors that set in very early
   - note that all other tests (including on all other platforms) produced bfb 
     baseline comparisons

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE
===============================================================
===============================================================

Tag name: cam3_3_26
Originator(s): mvertens
Date: Sun Sep 10 20:22:42 MDT 2006
One-line Summary: Changes necessary for moving atm/ocn flux calc to top level

Purpose of changes:

Incorporated changes necessary to move the atm/ocn flux calculation out of the dom/som
ocean code and into the top level application driver. 

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: eaton

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

    M  ocn/dom/ocn_comp.F90
	- Moved update of ocean temperature to after calculation of ocean surface/fluxes
          This was done to be consistent with SOM update and to be able to move the atm/ocean
          surface flux calculation to the top level driver without introducint cpp ifdefs. 
          This change also required writing the surface temperature to the ocean restart file.
          This modification will result in greater than round-off level differences with cam3_3_25.
        - removed the call to sstan and made the conversion from degees K to C explicit
        
    M  ice/csim4/ice_types.F90
    M  ice/csim4/ice_comp.F90
    M  ice/csim4/ice_diagnostics.F
        - Removed "precsc, precsl, precc, precl" as ice_in types and replaced them with "snow"
          since only snow is needed as input to csim. This change should only result in round-off
          level differences with cam3_3_25.
    M  ice/csim4/ice_comp_mct.F90
	- In addition to only using "snow" as input from the application driver, also removed 
          x2i_i%rAttr(index_x2i_So_tsocn,g) as input and instead used  
          x2i_i%rAttr(index_x2i_So_t,g)-SHR_CONST_TKFRZ. This change should only result in
          round-off level differences with cam3_3_25.       

    M  drv/seq_flds/dust/seq_flds_mod.F90
    M  drv/seq_flds/default/seq_flds_mod.F90
    M  drv/seq_flds/gensom/seq_flds_mod.F90
    M  drv/seq_mct/mrg_x2i_mct.F90
    M  drv/seq_flds_indices/seq_flds_indices.F90
         - replaced  'Faxa_rainc', Faxa_rainl','Faxa_snowc','Faxa_snowl' as input to ice
           with 'Faxa_rain' and :Faxa_snow'        

    M  drv/seq_mct/mrg_x2a_mct.F90
         - Removed calculation of ts for non-fractional grid box 
           This makes the merge consistent with that done in cpl6.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All tests passed (no baseline compare was done)
tempest: All tests passed (no baseline compare was done)
bangkok/lf95: All tests passed (no baseline compare was done)

Summarize any changes to answers, i.e.,
- what code configurations: see above
- what platforms/compilers: effects all platforms
- nature of change: larger than roundoff but same climate

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,

- source tag (all code used must be in the repository): cam3_3_26
- platform/compilers: bluesky 

- configure commandline: 
configure -ocn dom -dyn fv -spmd -smp -test -res 4x5

- build-namelist command (or complete namelist):
&ccsm_inparm
 case_name	= 'cam3_3_24_fluxao_fv4x5dom'
 start_type	= "continue"
/
&timemgr_inparm
 atm_cpl_dt	= 1800
 orb_iyear_ad	= 1950
 restart_option	= 'monthly'
 start_ymd	= 10101
 stop_n		= 720
 stop_option	= 'ndays'
/
&cam_inparm
 dtime		= 1800
 absems_data	= '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/abs_ems_factors_fastvx.c030508.nc'
 aeroptics	= '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/AerosolOptics_c050419.nc'
 bnd_topo	= '/fis/cgd/cseg/csm/inputdata/atm/cam/topo/USGS-gtopo30_4x5_remap_c050520.nc'
 bndtvaer	= '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/AerosolMass_V_4x5_clim_c031022.nc'
 bndtvo		= '/fis/cgd/cseg/csm/inputdata/atm/cam/ozone/pcmdio3.r8.64x1_L60_clim_c970515.nc'
 bndtvs		= '/fis/cgd/cseg/csm/inputdata/atm/cam/sst/sst_HadOIBl_bc_4x5_clim_c030228.nc'
 ncdata		= '/fis/cgd/cseg/csm/inputdata/atm/cam/inic/fv/cami_0001-01-01_4x5_L26_c060608.nc'
/
&clm_inparm
 fpftcon	= '/fis/cgd/cseg/csm/inputdata/lnd/clm2/pftdata/pft-physiology-cn16.c040719'
 fsurdat	= '/fis/cgd/cseg/csm/inputdata/lnd/clm2/srfdata/cam/clms_3.1_4x5_c050523.nc'
/

- MSS location of output:
/MVERTENS/csm/cam3_3_24_fluxao_fv4x5dom/hist    (cam3_3_24+ current mods)

MSS location of control simulations used to validate new climate:
/MVERTENS/csm/cam3_3_24_fluxao_fv4x5dom_0/hist  (cam3_3_24)

URL for AMWG diagnostics output used to validate new climate:
http://www.cgd.ucar.edu/cms/rneale/runs/cam/cam3_3_24_fluxao_fv4x5dom-cam3_3_24_fluxao_fv4x5dom_0/

===============================================================
===============================================================

Tag name: cam3_3_25
Originator(s): eaton
Date: Tue Sep  5 08:53:01 MDT 2006
One-line Summary: add spun-up CLM initial files

Purpose of changes:

. add spun-up CLM initial files for FV 1.9x2.5.  There are files for both
  0000-01-01 and 0000-09-01

. Fixed syntax of some attributes in the default XML files.  XML requires
  that attribute values are quoted, and there were unquoted values in the
  files.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

. add spun-up CLM initial files for FV 1.9x2.5.  There are files for both
  0000-01-01 and 0000-09-01

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

. models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
. models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE

===============================================================
===============================================================

Tag name: cam3_3_24
Originator(s): mvr, jwolfe
Date: 060830 
One-line Summary: mods to eliminate naming conflicts in the ccsm 
single executable; increased max fields for history tapes; 
minor test driver enhancements

Purpose of changes: the move to a single executable for running 
cam as part of ccsm introduced some naming conflicts that needed 
to be resolved; running cam in ccsm and turning on the chemistry 
and co2 blew out the maximum allowed fields on a history tape

Bugs fixed (include bugzilla ID): 

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself, eaton

List all subroutines eliminated:
D      models/atm/cam/src/control/history.F90
- renamed due to conflict in the ccsm single executable
	
List all subroutines added and what they do:
A  +   models/atm/cam/src/control/cam_history.F90
- newly named to work with the ccsm single executable
- also modified the maximum number of fields allowed on history tapes
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TSB.ccsm.sh
- modified to use resource settings returned from ccsm scripts 
- ccsm tests now use default queue on phoenix 
	
M      models/atm/cam/test/system/test_driver.sh
- machine calgary now supported by test driver; 
- increased wall clock limit for default testing on bluevista
	
M      models/atm/cam/test/system/CAM_runcmnd.sh
- added code in support of machine calgary
	
M      models/ocn/dom/ocn_comp.F90
M      models/ocn/som/ocn_srf.F90
M      models/ocn/som/ocn_comp.F90
M      models/ice/csim4/ice_srf.F90
M      models/ice/csim4/ice_comp.F90
M      models/atm/cam/tools/scam/scm_init/init_model.F90
M      models/atm/cam/tools/scam/scm_init/forecast.F90
M      models/atm/cam/src/control/history_defaults.F90
M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/ccsm_msg.F90
M      models/atm/cam/src/control/srfxfer.F90
M      models/atm/cam/src/control/restart.F90
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/atm/cam/src/control/filenames.F90
M      models/atm/cam/src/control/history_scam.F90
M      models/atm/cam/src/control/cam_comp.F90
M      models/atm/cam/src/utils/time_manager.F90
M      models/atm/cam/src/physics/cam1/seasalt_intr.F90
M      models/atm/cam/src/physics/cam1/tphysidl.F90
M      models/atm/cam/src/physics/cam1/progseasalts_intr.F90
M      models/atm/cam/src/physics/cam1/tracers.F90
M      models/atm/cam/src/physics/cam1/param_cldoptics.F90
M      models/atm/cam/src/physics/cam1/diagnostics.F90
M      models/atm/cam/src/physics/cam1/radiation.F90
M      models/atm/cam/src/physics/cam1/dust_intr.F90
M      models/atm/cam/src/physics/cam1/tphysbc.F90
M      models/atm/cam/src/physics/cam1/aerosol_radiation_interface.F90
M      models/atm/cam/src/physics/cam1/radsw.F90
M      models/atm/cam/src/physics/cam1/check_energy.F90
M      models/atm/cam/src/physics/cam1/stratiform.F90
M      models/atm/cam/src/physics/cam1/water_tracers.F90
M      models/atm/cam/src/physics/cam1/radlw.F90
M      models/atm/cam/src/physics/cam1/ozone_data.F90
M      models/atm/cam/src/physics/cam1/physpkg.F90
M      models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
M      models/atm/cam/src/physics/cam1/convect_shallow.F90
M      models/atm/cam/src/physics/cam1/convect_deep.F90
M      models/atm/cam/src/physics/cam1/carbon_intr.F90
M      models/atm/cam/src/physics/cam1/sulchem.F90
M      models/atm/cam/src/physics/cam1/co2_cycle.F90
M      models/atm/cam/src/physics/cam1/chemistry.F90
M      models/atm/cam/src/physics/cam1/gw_drag.F90
M      models/atm/cam/src/physics/cam1/sulemis.F90
M      models/atm/cam/src/physics/cam1/aerosol_intr.F90
M      models/atm/cam/src/physics/cam1/cloudsimulator.F90
M      models/atm/cam/src/physics/cam1/zm_conv.F90
M      models/atm/cam/src/physics/cam1/sulfur_intr.F90
M      models/atm/cam/src/physics/cam1/constituent_burden.F90
M      models/atm/cam/src/physics/cam1/vertical_diffusion.F90
M      models/atm/cam/src/physics/waccm/iondrag.F90
M      models/atm/cam/src/physics/waccm/tracers.F90
M      models/atm/cam/src/physics/waccm/nlte_lw.F90
M      models/atm/cam/src/physics/waccm/chemistry.F90
M      models/atm/cam/src/physics/waccm/ctem.F90
M      models/atm/cam/src/physics/waccm/radheat.F90
M      models/atm/cam/src/physics/waccm/gw_drag.F90
M      models/atm/cam/src/physics/waccm/tgcm_forcing.F90
M      models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
M      models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
M      models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
M      models/atm/cam/src/chemistry/trop_mozart/mo_aerosols.F90
M      models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
M      models/atm/cam/src/chemistry/trop_mozart/mo_seasalt.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_aero_settling.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_airglow.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_jlong.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_setext.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_gas_phase_chemdr.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_waccm_photo.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_jshort.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_cph.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_chm_diags.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_aurora.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_apex.F90
M      models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
M      models/atm/cam/src/chemistry/waccm_mozart/iondrag.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_waccm_hrates.F90
M      models/atm/cam/src/chemistry/waccm_mozart/mo_jeuv.F90
M      models/atm/cam/src/chemistry/waccm_mozart/exbdrift.F90
M      models/atm/cam/src/dynamics/sld/spegrd.F90
M      models/atm/cam/src/dynamics/sld/linemsdyn.F90
M      models/atm/cam/src/dynamics/sld/dyn_comp.F90
M      models/atm/cam/src/dynamics/sld/diag_dynvar_ic.F90
M      models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
M      models/atm/cam/src/dynamics/eul/spegrd.F90
M      models/atm/cam/src/dynamics/eul/linemsdyn.F90
M      models/atm/cam/src/dynamics/eul/dyn_comp.F90
M      models/atm/cam/src/dynamics/eul/diag_dynvar_ic.F90
M      models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
M      models/atm/cam/src/dynamics/fv/inidat.F90
M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
M      models/atm/cam/src/dynamics/fv/diag_dynvar_ic.F90
M      models/atm/cam/src/dynamics/fv/uv3s_update.F90
- mods to eliminate naming conflicts when used in the ccsm single executable: 
  (mods included 'use' statements, documentation, and whitespace formatting)
	subroutine write_restart -> cam_write_restart 
	subroutine read_restart  -> cam_read_restart 
	module history           -> cam_history 

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
ALL PASS
tempest:
ALL PASS
bangkok/lf95:
ALL PASS
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_23
Originator(s): eaton
Date: Sun Aug 27 14:17:37 MDT 2006
One-line Summary: fix some intent attributes in various high level interfaces

Purpose of changes:

. Some of the intents for derived types that contain pointer components are
  wrong in the FV interface routines.  In this situation the intent refers to
  the association status of the pointer, not to the target of the pointer.
  Fix these intents in fv/stepon.F90 and fv/dyn_comp.F90.

. cam_run1 has args cam_in and cam_out declared intent(inout).  Most of the
  components of these user defined types are arrays of length pcols, but
  we're adding components that are pointers, and probably all the
  components should be pointers.  Since for pointer components the
  intent(inout) doesn't make sense, and for non-pointer components it's the
  default, this intent has been removed.  Also switched the order of these
  args to match the convention of listing input args first.

. replace the variables surface_state2d and srfflx_state2d by cam_out and
  cam_in respectively in physpkg.  There are alot of other places where
  this still needs to happen.

. utils/timing/f_wrappers.c was missing the header file string.h.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  models/utils/timing/f_wrappers.c
  . add missing include of string.h

  models/atm/cam/src/dynamics/fv/stepon.F90
  . remove the intent(out) attributes of dummy args dyn_in and dyn_out in
    both stepon_init and stepon_run1.  That intent
    implies that the pointer components should be associated in this
    routine.  But the pointers were previously associated in
    dyn_create_interface and the targets are what is being set here.

  models/atm/cam/src/dynamics/fv/dyn_comp.F90
  . remove the intent(inout) attributes of dummy args dyn_in and dyn_out in
    dyn_run

  models/atm/cam/src/control/cam_comp.F90
  . remove the intent(inout) attribute of args cam_in and cam_out in
    cam_run1 interface.  Also switched the order of these
    args to match the convention of listing input args first.
  . order actual args (.., cam_in, cam_out) in call to phys_run1

  models/atm/cam/src/control/con_cam.F90
  . switch order of actual args in call to cam_run1

  models/atm/cam/src/control/atm_comp_mct.F90
  . switch order of actual args in call to cam_run1

  models/atm/cam/src/physics/cam1/physpkg.F90
  . replace surface_state2d by cam_out and replace srfflx_state2d by cam_in
  . order dummy args (.., cam_in, cam_out) in definition of phys_run1

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE

===============================================================
===============================================================

Tag name:  cam3_3_22
Originator(s): erik
Date: Fri Aug 18 10:18:32 MDT 2006
One-line Summary:  fix restart_option=end, get_perp_date bugs

Purpose of changes:

Bugs fixed (include bugzilla ID): 107, 185

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: self

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:

M cam/test/unit/control/run_time_test
         Add tests for perpetual case and other restart_options
M atm/cam/test/unit/control/test_time.F90
         Add tests for perpetual case and other restart_options
M atm/cam/src/utils/time_manager.F90
         Add ability to use offset optional argument for get_perp_date

Externals updated:

  csm_share to share3_060814
  clm2      to clm3_expa_69

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: bit-for-bit

===============================================================
===============================================================

Tag name: cam3_3_21
Originator(s): eaton, klindsay, mirin
Date: 2006-08-17
One-line Summary: Update icesst tools; add column burden diags; FV fixes/cleanup.

Purpose of changes:

. Update the icesst tool to recognize the new datasets being provided by
  Dennis Shea.  These have a CF-conforming time coordinate and the date
  information in YYYYMMDD format is moved to a new date variable.
  Also needed to change some fixed sizes in bcgen/solver.f90 to allow for
  the new datasets starting from 1870 rather than 1949.
 
. Add hist_fld_active query function to history.F90.  Returns whether or
  not a field is active on any history file.  This enables the ability to
  not perform expensive diagnostic calculations if they aren't being asked
  for in the history output.  (Contributed by Keith Lindsay.)
 
. Add column burden diagnostics for all constituents except water vapor.
  These are not put on the history tapes by default.  The names of the
  output variables are of the form 'TM'//cnst_name.  Not enabled for SCAM.
  (Contributed by Keith Lindsay.)

. Add modcomm_gatscat to namelist (bugfix); fix defaults for some modcomm
  options; cleanup of comments.  (Contributed by Art Mirin.)

Bugs fixed (include bugzilla ID):

. Add modcomm_gatscat to namelist

Describe any changes made to build system: none

Describe any changes made to the namelist: 

. Add modcomm_gatscat to namelist

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated:

  models/atm/cam/tools/icesst/README.bfb

List all subroutines added and what they do:

. column burden diagnostics for all constituents except water vapor
  models/atm/cam/src/physics/cam1/constituent_burden.F90

List all existing files that have been modified, and describe the changes:

. enable icesst tools to read new input datasets
  models/atm/cam/tools/icesst/README
  models/atm/cam/tools/icesst/bcgen/solver.f90
  models/atm/cam/tools/icesst/regrid/regrid.f90
  models/atm/cam/tools/icesst/regrid/wrap_nf.f90

. add column burden diagnostics
  models/atm/cam/src/physics/cam1/diagnostics.F90

. add new query function to history
  models/atm/cam/src/control/history.F90

. FV and modcomm bugfixes and cleanup
  models/atm/cam/src/control/runtime_opts.F90
  models/atm/cam/src/dynamics/fv/dyn_comp.F90
  models/atm/cam/src/dynamics/fv/spmd_dyn.F90
  models/utils/pilgrim/mod_comm.F90


If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: NONE

===============================================================
===============================================================

Tag name: cam3_3_20
Originator(s): erik
Date: Wed Aug 16 09:34:33 MDT 2006
On-line Summary: Fix bugs from cam3_3_15 for working on phoenix

Purpose of changes: Changes needed for CCSM to work on phoenix.

Bugs fixed (include bugzilla ID): 204 and 205

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: self, jwolfe

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      models/atm/cam/test/unit/control/run_time_test 
	    Remove old style namelists for comparision, add netcdf directories
	    explicitly for bangkok.
M      models/atm/cam/src/control/con_cam.F90 
	    Move start of timers to earlier in program.
M      models/SVN_EXTERNAL_DIRECTORIES 
	    Update to share3_060814. Fixes problem in shr_file_mod for phoenix.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:   all tests pass

tempest:   all tests pass

bangkok/lf95:   all tests pass

Summarize any changes to answers: bit-for-bit

===============================================================
===============================================================

Tag name: cam3_3_19
Originator(s): Jim Edwards (homme, history, phys_grid), 
	       Rory Kelly (homme), 
	       Pat Worley (phys_grid)
Date: 8-14-2006
One-line Summary: Moved dynamic core specific functions from history
	to specific cores.  

Purpose of changes: Continuing work on general dynamics/physics API

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Originators, Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do: 

List all existing files that have been modified, and describe the changes:

	The dynamics fields that were previously added to the history output from
	the history_defaults file have been moved to dyn_init so that each dycore
	is responsible for declaring the fields for which outfld calls will be made
	using the dynamics decomposition.

	Moving addfld calls into dyn_init created a circular dependency, i.e.,

	 dyn_comp -> history -> io_dist -> dyn_comp

	io_dist uses dyn_state (in dyn_comp) to access the decomposition info
	needed for gathers.  We broke the chain by putting dyn_state in a separate
	module, i.e.,

	 dyn_comp -> history -> io_dist -> dyn_internal_state

	Another side effect of moving addfld calls into dyn_init was to require
	moving the setting of the dyngrid_set variable (and give it the more
	appropriate name dyndecomp_set) to a place in front of these calls.  It was
	previously being set in initcom which is after the dyn_init call.  It
	should be set as soon as the parameters that determine the dynamics
	decomposition are known.  It can probably still be set earlier than it is
	currently.

	The gather/scatter methods in phys_grid have been modified to work when the
	global field is on either a lat/lon grid or an unstructured grid.
	(Contributed by Pat Worley.)

	The wrapper routines in wrap_nf have been moved into a module.  This
	provides interface checking for these routines.

	More work has been done to the dycore interface for HOMME in the
	dynamics/homme directory.  This work is still in progress.

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: all tests pass

tempest: all tests pass

bangkok/lf95: all tests pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:  cam3_3_18
Originator(s): bundy (Dani Bundy Coleman)
Date: Aug 11 2006
One-line Summary: Fix and improve prognostic aerosol packages

Purpose of changes: Some of the existing prognostic aerosol packages
did not function out-of-the-box. Furthermore, the dust package was
outdated, the sea salt was actually diagnostic and the carbon 
offered only one simple scenerio.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system:
Added configure option for prognostic aerosol packages
	-prog_aero sulfur,caer4,caer16,dust,seasalt
Invoke with comma-separated list of any combination of the above.
This adds the correct number of advected constituents to the build and
defines cpp tokens required for dust, seasalt and the new 16-constituent
carbon aerosol package. 
	
Describe any changes made to the namelist:
The configure option for prognostic aerosols is used by build-namelist to
	set namelist variables related to the aerosol packages.
Added namelist variables to control implementation & feedback of dust & sea salt.
   aero_progsslt         
		Set to .TRUE. to turn on prognostic seal salt aerosols
                should be set by build-namelist, as needs cppdefs too
   aero_feedback_progsslt
		Set to .TRUE. to enable feedback of prognostic sea salt
		aerosols. NOT YET IMPLEMENTED
   aero_dust          
		Set to .TRUE. to turn on dust prognostic aerosols
                should be set by build-namelist, as needs cppdefs too
   aero_feedback_dust
	        Set to .TRUE. to enable feedback of dust
                prognostic aerosols.

To avoid confusion with the existing co_emis_file namelist variable, 
	renamed emissions file for prognostic carbon aerosol:
OLD co_emis 
NEW caer_emis
	
List any changes to the defaults for the boundary datasets: none
	
Describe any substantial timing or memory changes: none
When run without aerosols, there are no changes. 

Code reviewed by: Brian Eaton

List all subroutines eliminated:
models/atm/cam/src/physics/cam1/dust.F90  
	module information moved to (existing) dust_intr.F90
	
List all subroutines added and what they do:
models/atm/cam/src/physics/cam1/progseasalts_intr.F90
  new module includes methods for registering, initializing, setting
  indices, and calculating sinks of prognostic sea salt aerosol
	  progseasalts_register_cnst
	  progseasalts_init_cnst
	  set_progseasalts_idx
	  progseasalts_initialize
	  progseasalts_time_interp      
	  ProgseasaltsDryDep
models/atm/cam/src/control/camsrfexch_types.F90
	  hub2atm_setopts
	  called by dust.F90:dust_register_cnst to allocate ram1 & fv in srfflx_state
models/atm/cam/src/physics/cam1/aerosol_intr.F90
	  aerosol_getopts                            ! get runtime options

Also added
models/drv/seq_flds/dust
models/drv/seq_flds/dust/seq_flds_mod.F90
	  add tokens for new exchange components in x2a and l2x strings
	
List all existing files that have been modified, and describe the changes:

M models/atm/cam/bld/CAM_config.pm
 add AEROSOLS attribute

M models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
 changed co_emis to caer_emis
 add caer_emis_16

M models/atm/cam/bld/cam_inparm.pm
 Add AEROSOLS attribute to namelist object
 Use settings from config_cache to set aero_carbon and caer_emis
 All carbon surface emissions in caer_emis
 Use config_cache to set prognostic_sulfur and prescribed_sulfur
 Use config_cache to set soil_erod

M models/atm/cam/bld/config_cam_eul_defaults.xml
M models/atm/cam/bld/config_cam_fv_defaults.xml
M models/atm/cam/bld/config_cam_homme_defaults.xml
M models/atm/cam/bld/config_cam_sld_defaults.xml
M models/atm/cam/bld/config_trop_chem_mozart_defaults.xml
M models/atm/cam/bld/config_waccm_ghg_defaults.xml
M models/atm/cam/bld/config_waccm_mozart_defaults.xml
 add prog_aero to defaults xml files

M models/atm/cam/bld/configure
 add "-prog_aero <list>" option
 add consistency check for specified packages
 increment nadv with the number of constituents in specified packages

M models/atm/cam/src/control/atm_comp_mct.F90
 transfer fv, ram1 & dust fluxes if dust or progseasalt is running

M models/atm/cam/src/control/camsrfexch_types.F90
  add ram1,fv to srfflx_state type definition
  add subroutine hub2atm_setopts( aero_dust_in )
      called by dust.F90:dust_register_cnst
      to allocate ram1 & fv pointers

M models/atm/cam/src/control/runtime_opts.F90
   change namelist var co_emis to caer_emis
   changed comments about sea salt to diagnostic
   added namelist variables for prognostic sea salt & dust

M models/atm/cam/src/physics/cam1/aer_optics.F90
  if prognostic dust is running, use different optics

M models/atm/cam/src/physics/cam1/aerosol_intr.F90
  new subroutine aerosol_getopts to get run-time settings
  add dust & progseasalt implementation & control flags
  take out old ifdef DUSTs
  initialize dry deposition module if any aerosol is running
  generalize interfaces to carbon_intr

M models/atm/cam/src/physics/cam1/caer.F90
  add new carbon aerosol scenario with 16 constituents
      invoke with configure -prog_aero caer16

M models/atm/cam/src/physics/cam1/caerbnd.F90
  add new caer16 carbon emission scenario

M models/atm/cam/src/physics/cam1/carbon_intr.F90
  generalize interface for both caer4 & caer16 packages

D models/atm/cam/src/physics/cam1/dust.F90
  moved information into dust_intr.F90

M models/atm/cam/src/physics/cam1/dust_intr.F90
  move calcarm, d3ddflux subroutines to drydep_mod.F90
  moved dust.F90 information into dust_intr.F90

M models/atm/cam/src/physics/cam1/hk_conv.F90
 modify checks for small constituent values 
 causes roundoff diffs to any constituent with mixing ration < 1.e-300

M models/atm/cam/src/physics/cam1/physpkg.F90
 remove ram1, fv from comsrf

A models/atm/cam/src/physics/cam1/progseasalts_intr.F90
  new module to handle prognostic sea salt aersols

M models/atm/cam/src/physics/cam1/seasalt_intr.F90
  added method to return ixsslt

M models/atm/cam/src/physics/cam1/sulchem.F90
  add wet deposition diagnostics to dummy args of chemwdepdr

M models/atm/cam/src/physics/cam1/sulfur_intr.F90
 add SO4 wet deposition diagnostics to history (not default)
 remove call to inidrydep (now down in aerosol_intr if any aerosol is running)
 move outfld calls to sulfur_wet_intr from chemwdepdr

M models/atm/cam/src/physics/cam1/tphysac.F90
 remove fv and ram1 dummy args (in srfflx_state2d?)
 pass srfflx_state2d to aerosol_drydep_intr instead of its components

M models/atm/cam/src/physics/cam1/wetdep.F90
 add optional args to wetdepa

A models/drv/seq_flds/dust
A models/drv/seq_flds/dust/seq_flds_mod.F90
  added directory for configure-time dust options
  add tokens for new exchange components in x2a and l2x strings

M models/drv/seq_flds_indices/seq_flds_indices.F90
 add indices for fv, ram1, flxdst[1-4] in x2a, l2x sections (no ifdefs here)

M models/drv/seq_mct/mrg_x2a_mct.F90
 copy from surface attribute vectors to atm attvec

NOTE these land mods were checked into the clm trunk with clm3_expa_64
M      src/biogeochem/DUSTMod.F90
       OLD     dmt_vma = 2.524e-6_r8 ! [m] Mass median diameter analytic       She84 p.75 Table1
       NEW     dmt_vma = 3.500e-6_r8 ! [m] Mass median diameter analytic 
M      src/main/clm_atmlnd.F90
       add land-to-atmosphere communication of fv,ram1 & dust fluxes
       (only active if defined DUST or PROGSEASALT )
M      src/main/lnd_comp_mct.F90
       add land-to-atmosphere communication of fv,ram1 & dust fluxes
       (only active if defined DUST or PROGSEASALT )

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL!
	Round-off changes to chemistry constituents Np and N2p are caused
	by a modification to the Hack shallow convection scheme
	models/atm/cam/src/physics/cam1/hk_conv.F90

tempest: all PASS

bangkok/lf95: all PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: waccm_mozart
- what platforms/compilers: bluesky tested, probably all
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff? cprnc output shows 2 diffs in an array of 218592 elements;
code change only operates on numbers less than 1.e-300

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
	
===============================================================

Tag name:  cam3_3_17
Originator(s): mvr
Date: 
One-line Summary: update to clm3_expa_66; work-around for bluevista 
compiler bug; update to new pgi compiler and libs

Purpose of changes: wanted to use new pgi compilers which meant an 
update to clm tag with work-around for code the compilers didn't like;
new operating system on bluevista forced some mods in the build 
system and test scripts

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:
- removed noopt flag from compile and link commands in debug,smp mode

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:
- added spun-up CAM and CLM initial files for the FV 0.9x1.25 resolution.

Describe any substantial timing or memory changes:

Code reviewed by: myself, eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TSB.ccsm.sh
M      models/atm/cam/test/system/TCT.ccsm.sh
- modified for ccsm test to work in new bluevista os 

M      models/atm/cam/test/system/TBL.sh
M      models/atm/cam/test/system/TBR.sh
M      models/atm/cam/test/system/TER.sh
M      models/atm/cam/test/system/TRX.sh
M      models/atm/cam/test/system/TEQ.sh
- test scripts modified to do ALL output file comparisons, even if one fails

M      models/atm/cam/test/system/test_driver.sh
- modified for new bluevista os; updated bangkok libraries and 6.1-3 pgi compiler

M      models/atm/cam/tools/scam/ui/configure
- updated to link with pgi 6.1-3 libraries

M      models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
- added spun-up CAM and CLM initial files for the FV 0.9x1.25 resolution.

M      models/atm/cam/bld/Makefile.in
- removed noopt flag from compile and link commands in debug,smp mode (work-
  around for bluevista compiler bug)

M      models/atm/cam/bld/run-ibm.csh
- updated to work on bluevista as well as bluesky

M      models/atm/cam/bld/run-pc.csh
- updated bangkok libraries and 6.1-3 pgi compiler

M      models/atm/cam/src/dynamics/fv/dynamics_vars.F90
- bug fix for out-of-bounds array reference caught by pgi compiler

M      models/SVN_EXTERNAL_DIRECTORIES
- updated to new clm tag (clm3_expa_66) 

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
005 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
008 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
010 bl133 TBL.sh e32pdh aqpgro 3 ..................................FAIL! rc= 7
013 bl134 TBL.sh e32dh adia 9 .....................................FAIL! rc= 7
019 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
024 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 7
027 bl334 TBL.sh f4dh adia 9 ......................................FAIL! rc= 7
037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
044 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
047 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
049 bl533 TBL.sh s32pdh aqpgro 3 ..................................FAIL! rc= 7
052 bl534 TBL.sh s32dh adia 9 .....................................FAIL! rc= 7
055 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

-all baseline tests in debug mode running omp fail due to removal of noopt flag
-ccsm test fails, but passes when using ccsm sandbox with upcoming mods

tempest:
all PASS

bangkok/lf95:
012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 5

-these were deemed acceptable roundoff errors

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations: non-debug
- what platforms/compilers: bangkok/lf95
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): roundoff

If bitwise differences were observed, how did you show they were no worse
than roundoff? analysis of nstep0 differences

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
Tag name: cam3_3_16
Originator(s): Will Sawyer, Art Mirin
Date: Wed Jul 19 02:15:17 MDT 2006
One-line Summary:

Purpose of changes:   Upgrade to newest pilgrim version;
	streamlining of FV to remove unneeded allocations;
	resynching FV dycore with that from GEOS5;
	corrections in namelists for high resolution runs;
	update of FV namelist options (removal of set_eta);
	update of benergy to run with XY decomposition
	
Bugs fixed (include bugzilla ID):  (following have no bugzilla ID)
	D-resolution runs on Phoenix (reported by Worley)
	Conservative-mode bug (reported by Suarez in GEOS5)
	Compilation bug tp_core.F90 (reported by Trayanov in GEOS5)
	Tracer transpose bug on certain architectures (e.g. Linux)
	  with mod_method=1 (reported by Mirin, et al.)

Describe any changes made to build system:  none

Describe any changes made to the namelist:  
	Removed use_eta (comctl)
	Added dyn_conservative (comctl)
	Changes to the names of Topo, SST and initial files for 
  	0.9x1.25 and 0.5x0.625 resolutions.

List any changes to the defaults for the boundary datasets:
	RESOLUTION="0.9x1.25">atm/cam/topo/USGS-gtopo30_0.9x1.25_remap_c051027.nc
	RESOLUTION="0.5x0.625" >atm/cam/sst/sst_HadOIBl_bc_0.5x0.625_1949_2001_c040402.nc

Describe any substantial timing or memory changes:
	FV memory usage has decreased -- intermediate buffering of
	tracers is being avoided.

Code reviewed by:  ourselves

List all subroutines eliminated:  
	set_decomp, y_decomp (mod_comm)  -- no longer used
	create_vars, restore_vars, record_state, record_vars,
	destroy_state, destroy_vars (dyn_comp) -- no longer used

List all subroutines added and what they do:  none

List all existing files that have been modified, and describe the changes:

	
M      models/utils/pilgrim/parutilitiesmodule.F90
	-- Changes to initialization routine to support revised mod_comm
	-- Changed default communication method to mod_method=0
	-- MPI types only initialized for mod_method=1
	-- Updated documentation
	
M      models/utils/pilgrim/mod_comm.F90
	-- Extensive refactoring and updates to documentation
	-- Dynamic allocation of buffers (minimalistic, local allocation)
	-- Removal of mod_method=3  (MPI1)
	
M      models/atm/cam/bld/DefaultCLM_INPARM_Namelist.xml
M      models/atm/cam/bld/DefaultCAM_INPARM_Namelist.xml
	-- Changed default files for 0.9x1.25 and 0.5x0.625 resolutions.

M      models/atm/cam/src/control/runtime_opts.F90
M      models/atm/cam/src/control/comctl.h
	-- Added dyn_conservative, modcomm_gatscat
	-- removed use_eta, tracertrans
	
M      models/atm/cam/src/physics/cam1/phys_grid.F90
	-- Changes to modmax_alltoall method (now method 13)
	
M      models/atm/cam/src/dynamics/sld/spmd_dyn.F90
M      models/atm/cam/src/dynamics/eul/spmd_dyn.F90
	-- Added dyn_conservative, modcomm_gatscat
	-- removed use_eta, tracertrans

M      models/atm/cam/src/dynamics/fv/pmgrid.F90
	-- Added mod_gatscat method, default = 0
	
M      models/atm/cam/src/dynamics/fv/benergy.F90
	-- Extensively rewritten to support XY decomposition (instead of YZ)
	
M      models/atm/cam/src/dynamics/fv/tp_core.F90
	-- Compilation bug fixed (reported by Trayanov in GEOS5)
	
M      models/atm/cam/src/dynamics/fv/par_xsum.F90
	-- Sequential execution bug fix, refactoring
	
M      models/atm/cam/src/dynamics/fv/dp_coupling.F90
M      models/atm/cam/src/dynamics/fv/dryairm.F90
	-- Introduced T_TRACERS type for constituents
	
M      models/atm/cam/src/dynamics/fv/inidat.F90
	-- Introduced T_TRACERS type for constituents
	-- T3 array has become i,j,k (was i,k,j)
	
M      models/atm/cam/src/dynamics/fv/dyn_comp.F90
	-- Introduced T_TRACERS type for constituents
	-- Introduced dyn_conservative mode
	-- Removed unneeded allocations, removed unneeded subroutines
	-- Moved location of call to benergy into XY decomposition section
	
M      models/atm/cam/src/dynamics/fv/p_d_adjust.F90
	-- Introduced T_TRACERS type for constituents

M      models/atm/cam/src/dynamics/fv/spmd_dyn.F90
	-- Added dyn_conservative, modcomm_gatscat
	-- removed use_eta, tracertrans
	-- changed location and argument list of parinit()
	
M      models/atm/cam/src/dynamics/fv/inital.F90
	-- Revised call to dyn_init
	
M      models/atm/cam/src/dynamics/fv/cd_core.F90
	-- cosmetic changes to FVstart/stopclock
	
M      models/atm/cam/src/dynamics/fv/sw_core.F90
	-- loop index bug fixed (reported by Putman)
	
M      models/atm/cam/src/dynamics/fv/diag_dynvar_ic.F90
	-- T3 array has become i,j,k (was i,k,j)
	-- Introduced T_TRACERS type for constituents

M      models/atm/cam/src/dynamics/fv/dynamics_vars.F90
	-- Bug fix for conservation mode  (now: grid%klastp = km_in+1)
	-- Added ACOSU
	
M      models/atm/cam/src/dynamics/fv/geopk.F90
	-- Changes for mod_geopk mode to reduce MPI_TYPE usage
	
M      models/atm/cam/src/dynamics/fv/stepon.F90
	-- Removed set_eta code (namelist variable: use_eta)
	-- Introduced T_TRACERS type for constituents
	
M      models/atm/cam/src/dynamics/fv/fv_prints.F90
	-- Introduced T_TRACERS type for constituents

M      models/atm/cam/src/dynamics/fv/restart_dynamics.F90
	-- Introduced T_TRACERS type for constituents
	-- Revised call to dyn_init

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All tests pass except the CCSM comparison test

  055 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

  Justification: was failing in cam3_3_14 and 15.  See explanations there.

tempest:  all tests passed

bangkok/lf95:  all tests passed

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:  
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

	==> No changes to answers

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate: no change

URL for AMWG diagnostics output used to validate new climate: no change

===============================================================
===============================================================

Tag name: cam3_3_15
Originator(s): Erik Kluzek
Date:  Thu Jul 13 21:17:44 MDT 2006
One-line Summary:

Purpose of changes: Put in top level initialization and clock objects at driver level
  for moving forward with sequential CCSM.

  This separates out the driver from the internals of the CAM time-manager. Making 
  the top level driver separable from CAM itself, and moves it toward a Sequential 
  CCSM where the sub-components can be swapped for other CCSM components (such 
  as the CCSM data models or active ice and active ocean models).

Bugs fixed (include bugzilla ID): 153

  Fix bug in test_driver.sh where if BL_ROOT was NOT set -- it would erase the
  entire contents of your /ptmp/$USER directory after it was finished.

Describe any changes made to build system: Add csm_share/eshr directory to Filepath

Describe any changes made to the namelist: Split into 4 namelists.

  ccsm_inparm ----- Sequential CCSM driver level initialization information
		    (passed to all subcomponent models: atm, lnd, ice, ocn)
  timemgr_inparm -- Sequential CCSM driver level clock information
		    (passed to all subcomponent models: atm, lnd, ice, ocn)
  cam_inparm ------ CAM specific namelist
  clm_inparm ------ CLM specific namelist

The ccsm_inparm namelist is managed by the shr_inputInfo_mod.F90 module and objects.
The timemgr_inparm namelist is managed by the eshr_timemgr_mod.F90 module and objects.
These are both sequential CCSM top level driver objects that are passed into
sub-components (atmosphere, land, sea-ice, and ocean) to manage information that is
shared between sub-components.

CHANGE SO THAT THE NAMELIST IS NO LONGER READ FROM STDIN -- THE NAMELIST NAME IS
ASSUMED AND THE FILE OPENED EXPLICITLY. When namelists read the file is opened, and 
namelists are read until the correct one is found, then the file is closed. If the
needed namelist does not exist -- OR THERE IS AN ERROR IN IT -- the program will abort
with an error.

The interface to build-namelist still uses the input namelists of: camexp and clmexp
and will divide the relevant namelist items to the appropriate namelists.

Option added to build-namelist: -ignore_ic_date

by default build-namelist will match the start date/time (start_ymd,start_tod) for
initial condition datasets. If a suitable dataset with the correct starting date
(as well as resolution and other matching criteria) isn't found -- an initial condition
dataset will NOT be provided.

If you use the -ignore_ic_date option is used datasets will be matched without 
examining the starting date/time of the dataset.

Namelist items removed:

  restart_nsteps --> use restart_option and restart_n
  restart_nhours --> use restart_option and restart_n
  restart_ndays ---> use restart_option and restart_n
  restart_monthly -> use restart_option and restart_n
  restart_yearly --> use restart_option and restart_n
  no_restart ------> use restart_option and restart_n
  nelapse ---------> use stop_option and stop_n
  nestep ----------> Functionality removed
  nsrest ----------> Use start_type

Namelist items moved to different namelist:

  Old namelist item     New namelist used in
  =================     ====================
  archive_dir           ccsm_inparm (now refers to the top level archive directory)
  aqua_planet           ccsm_inparm
  brnch_retain_casename ccsm_inparm
  mss_irt               ccsm_inparm
  mss_wpass             ccsm_inparm
  calendar              timemgr_inparm
  stop_ymd              timemgr_inparm
  stop_tod              timemgr_inparm
  start_ymd             timemgr_inparm
  start_tod             timemgr_inparm
  ref_ymd               timemgr_inparm
  ref_tod               timemgr_inparm
  perpetual_run         timemgr_inparm
  perpetual_ymd         timemgr_inparm

Namelist items that changed names:

  Old namelist item   New namelist item name  New namelist used in
  =================   ======================  ====================
  eccen               orb_eccen               timemgr_inparm
  obliq               orb_obliq               timemgr_inparm
  mvelp               orb_mvelp               timemgr_inparm
  iyear_AD            orb_iyear_AD            timemgr_inparm
  ctitle              case_desc               ccsm_inparm
  caseid              case_name               ccsm_inparm
  adiabatic           atm_adiabatic           ccsm_inparm
  ideal_phys          atm_ideal_phys          ccsm_inparm

Namelist items added:

  Namelist item               Description                             New namelist used in
  =========================   ======================================  ====================
  start_type ---------------> How simulation will startup              ccsm_inparm
                              Valid options:

                              startup  = Use initial files
                              continue = Use restart files to continue simulation
                              branch   = Use restart files to branch simulation

  restart_pfile ------------> Driver level restart pointer file name   ccsm_inparm
  restart_file -------------> Driver level restart file name           ccsm_inparm
  restart_file_override ----> Override list of items from restart file ccsm_inparm **
  restart_file_TGRoverride -> Override list of items from restart file ccsm_inparm **
  restart_option -----------> Driver level restart frequency type      timemgr_inparm
                              Valid options:

                              nsteps ---- Write restarts every restart_n time-steps
                              ndays ----- Write restarts every restart_n days
                              nmonths --- Write restarts every restart_n months
                              nyears ---- Write restarts every restart_n years
                              monthly --- Write restarts at beginning of each month
                              yearly ---- Write restarts at beginning of the year
                              end ------- Write restarts only at end of simulation
                              none ------ Don't write any restarts

  restart_n ----------------> Driver level restart frequency value     timemgr_inparm
  stop_option --------------> Driver level restart frequency type      timemgr_inparm
                              Valid options:

                              nsteps ---- Stop after stop_n time-steps
                              ndays ----- Stop after stop_n days
                              nmonths --- Stop after stop_n months
                              nyears ---- Stop after stop_n years
                              date ------ Stop at stop_ymd/stop_tod date/time

  stop_n -------------------> Driver level restart frequency value       timemgr_inparm
  stop_final_ymd -----------> The final date to run to (YYYYMMDD format) timemgr_inparm
  atm_cpl_dt ---------------> Atmosphere coupling frequency (sec)        timemgr_inparm

Example creation of the old and new namelist using build-namelist:

With cam3_3_14: 

  build-namelist -runtype initial -namelist "&camexp nelapse=-1, restart_monthly=.true., iyear_AD=1990/ "

with cam3_3_15:

  build-namelist -runtype startup -namelist "&camexp stop_option='ndays', stop_n=1, restart_option='monthly' , orb_iyear_AD=1990 /"

So build-namelist figures out that all of the above options belong in the timemgr_inparm namelist
and deal with it appropriately.  And results in the following namelist:

&ccsm_inparm
 case_name              = 'camrun'
 start_type             = "startup"
/
&timemgr_inparm
 atm_cpl_dt             = 1200
 orb_iyear_ad           = 1950
 restart_option         = 'monthly'
 start_ymd              = 901
 stop_n         = 1
 stop_option            = 'ndays'
/
&cam_inparm
 absems_data            = '/fs/cgd/csm/inputdata/atm/cam/rad/abs_ems_factors_fastvx.c030508.nc'
 aeroptics              = '/fs/cgd/csm/inputdata/atm/cam/rad/AerosolOptics_c050419.nc'
 bnd_topo               = '/fs/cgd/csm/inputdata/atm/cam/topo/USGS-gtopo30_64x128_c050520.nc'
 bndtvaer               = '/fs/cgd/csm/inputdata/atm/cam/rad/AerosolMass_V_64x128_clim_c031022.nc'
 bndtvo         = '/fs/cgd/csm/inputdata/atm/cam/ozone/pcmdio3.r8.64x1_L60_clim_c970515.nc'
 bndtvs         = '/fs/cgd/csm/inputdata/atm/cam/sst/sst_HadOIBl_bc_64x128_clim_c020411.nc'
 dtime          = 1200
 ncdata         = '/fs/cgd/csm/inputdata/atm/cam/inic/gaus/cami_0000-09-01_64x128_L26_c030918.nc'
/
&clm_inparm
 fpftcon                = '/fs/cgd/csm/inputdata/lnd/clm2/pftdata/pft-physiology-cn16.c040719'
 fsurdat                = '/fs/cgd/csm/inputdata/lnd/clm2/srfdata/cam/clms_3.1_64x128_c050523.nc'
/

How to override information on the restart file from the namelist: **

  By default for a continue or branch type of simulation -- driver information is
  read from the restart file and namelist information is ignored. In order to explicitly
  use driver level restart information you have to do the following:

  1.) Set given namelist item(s) you want to override.
  2.) Set restart_file_override (or restart_file_TGRoverride for timemgr_inparm namelist)
      to include the colon delimited list of items you want to override on the namelist.
  3.) To override the case_name -- set the brnch_retain_casename namelist item to true.

  List of ccsm_inparm items that can be overridden: mss_irt, mss_wpass, and case_desc
     (and case_name is brnch_retain_casename is set to true)
  List of timemgr_inparm items that can be overridden: restart_option, restart_n

  Examples

  build-namelist -runtype continue -namelist \
  "&camexp mss_irt=45, mss_wpass='example', restart_file_override='mss_irt:mss_wpass' /"

  The above example will override the values of mss_irt, mss_wpass from the restart file
  with those given on the namelist. Note if restart_file_override were missing, the
  values on the restart file would be used an the values on the namelist ignored.

  build-namelist -runtype continue -namelist \
  "&camexp restart_option='nyears', restart_n=2, restart_file_TGRoverride='restart_option:restart_n' /"

  The above example will override the values of restart_option, and restart_n from 
  the restart file with those given on the namelist. Note if restart_file_override 
  were missing, the values on the restart file would be used an the values on the 
  namelist ignored.

List any changes to the defaults for the boundary datasets: make sure IC file names are
  consistent with dates in file.
  Also add ic_ymd and ic_tod to describe the date (YYYYMMDD format) and time-of-day (sec)
  that the given initial condition file represents.

Describe any substantial timing or memory changes: none

Code reviewed by: Brian Eaton, Mariana Vertenstein, Mat Rothstein

Externals updated:
    share3_060710 ------------ Add shr_inputinfo_mod/eshr_timemgr_mod codes.
    clm3_expa_65 ------------- Use new share objects.
    esmf_wrf_timemgr_060616 -- Same behavior as ESMF, changes needed for new share.
    MCT2_2_1_060706 ---------- Changes get_zeits.c to work on new bangkok compiler.

List all subroutines eliminated:

  In models/atm/cam/src/control/restart.F90 <-- determine if restart from SyncClock
     restart_init
     restart_is_write_step
     update_next_write_time
  In models/atm/cam/src/utils/time_manager.F90 <-- remove unused functions.
     get_clock
     get_curr_ESMF_Time
     calc_nestep <---- not needed as SynClock determines stop-time.

List all subroutines added and what they do:

   runtime_opts_setNLFile (runtime_opts.F90) -- Set the namelist filename.
   ccsmini_sendgridgetorb (ccsm_msg.F90) ------ Send grid and get orbit info 
                                                at initialization.
   get_calendar (time_manager.F90) ------------ Get calendar type using.
   timemgr_check_restart (time_manager.F90) --- Check the restart info for consistency.

List all files eliminated:

   atm/cam/bld/DefaultCLMEXPNamelist.xml (change name)
   atm/cam/bld/clm2exp.pm                (change name)
   atm/cam/bld/CAM_namelist.p            (change name)
   atm/cam/bld/DefaultCAMEXPNamelist.xml (change name)

List all files added and what they do:

   atm/cam/test/unit/control/filterhead.pl -- filters unit test log data to compare results
       with a different version.

   atm/cam/bld/nl_descrips.pm --------------------- Describes the driver level namelists.
   atm/cam/bld/clm_inparm.pm ---------------------- Manages the clm_inparm namelist.
   atm/cam/bld/DefaultCAM_INPARM_Namelist.xml ----- Default values for the cam_inparm namelist.
   atm/cam/bld/DefaultCLM_INPARM_Namelist.xml ----- Defaults for the clm_inparm 
                                                    namelist (renamed from old CAMEXP file)
   atm/cam/bld/DefaultTIMEMGR_INPARM_Namelist.xml - Default values for the timemgr_inparm namelist.
   atm/cam/bld/DefaultCCSM_INPARM_Namelist.xml ---- Default values for the ccsm_inparm namelist.
   atm/cam/bld/NamelistsDescriptions.xml ---------- List of items on driver level namelists.
   atm/cam/bld/timemgr_inparm.pm ------------------ Manages the timemgr_inparm namelist.
   atm/cam/bld/cam_inparm.pm ---------------------- Manages the cam_inparm namelist.
   atm/cam/bld/SeqCCSM_namelist.pm ---------------- Manages all namelists needed.
   atm/cam/bld/ccsm_inparm.pm --------------------- Manages the ccsm_inparm namelist

List all existing files that have been modified, and describe the changes:

   Pass CCSMInit and SyncClock objects down to sub-models.

    ocn/dom/ocn_comp_mct.F90
    ocn/som/ocn_comp_mct.F90
    ice/csim4/ice_comp_mct.F90

   Update unit tests for time_manager module.

    atm/cam/test/unit/control/configure
    atm/cam/test/unit/control/run_time_test
    atm/cam/test/unit/control/test_time.F90

   Change test_driver system to work with new build-namelist options and new
   namelist behavior and changes to namelist item names.

    atm/cam/test/system/test_driver.sh
    atm/cam/test/system/TSB.ccsm.sh
    atm/cam/test/system/TBR.sh
    atm/cam/test/system/TER.sh
    atm/cam/test/system/TRX.sh
    atm/cam/test/system/TSM.sh
    atm/cam/test/system/nl_files/idphys
    atm/cam/test/system/nl_files/ghgrmp
    atm/cam/test/system/nl_files/outfrq3s
    atm/cam/test/system/nl_files/aqpgro
    atm/cam/test/system/nl_files/no_ttrac
    atm/cam/test/system/nl_files/off2x2.5
    atm/cam/test/system/nl_files/pghgsul
    atm/cam/test/system/nl_files/ttrac_lb1
    atm/cam/test/system/nl_files/ttrac_lb2
    atm/cam/test/system/nl_files/ttrac
    atm/cam/test/system/nl_files/ttrac_lb3
    atm/cam/test/system/nl_files/adia
    atm/cam/test/system/nl_files/outfrq24h
 
   Pass CCSMInit and SyncClock objects down as appropriate into scam. Upgrade
   make to work with new PGI compiler on bangkok.

    atm/cam/tools/scam/configure
    atm/cam/tools/scam/testscript
    atm/cam/tools/scam/userdata/crmtest26.out <--- Needed for compiler upgrade on bangkok.
    atm/cam/tools/scam/ui/configure
    atm/cam/tools/scam/scm_init/init_model.F90
    atm/cam/tools/scam/scm_init/scam_srfdata_MCT.F90
    atm/cam/tools/scam/scm_init/scam_run.F90
    atm/cam/tools/scam/scm_init/inital.F90
    atm/cam/tools/scam/scm_init/scamMod.F90
    atm/cam/tools/scam/scm_init/setiopupdate.F90

   Work with new PGI compiler on bangkok. Add eshr to Filepath.
   Changes to get Darwin (Mac OS-X) to work. Remove HIDE_SHR_MSG as
   unneeded now.

    atm/cam/bld/configure
    atm/cam/bld/Makefile.in

   Change to work in the context of the 4 new namelists. Add -ignore_ic_date option
   in. Have CAM_config.pm keep track of new items added to the XML configuration file.

    atm/cam/bld/build-namelist
    atm/cam/bld/clmexp.pm
    atm/cam/bld/namelist.pm
    atm/cam/bld/camexp.pm
    atm/cam/bld/atmlndnl.pm
    atm/cam/bld/CAM_config.pm

   Change run scripts to work with new build-namelist and do NOT redirect stdin.

    atm/cam/bld/run-ibm.csh
    atm/cam/bld/run-pc.csh
    atm/cam/bld/run-sgi.csh
    atm/cam/bld/run-lightning.csh
    atm/cam/bld/run-darwin.csh

   Pass CCSMInit and SyncClock objects down as needed. Use them to
   initialize CAM internal data.

    atm/cam/src/control/readinitial.F90
    atm/cam/src/control/runtime_opts.F90
    atm/cam/src/control/restart.F90
    atm/cam/src/control/history.F90
    atm/cam/src/control/atm_comp_mct.F90
    atm/cam/src/control/startup_initialconds.F90
    atm/cam/src/control/units.F90
    atm/cam/src/control/filenames.F90
    atm/cam/src/control/ioFileMod.F90
    atm/cam/src/control/cam_comp.F90
    atm/cam/src/utils/time_manager.F90
    atm/cam/src/dynamics/fv/metdata.F90

   Create CCSMInit and SyncClock driver level data at top level concurrent CAM
   driver pass down as needed. Set orbital information in SyncClock from data sent
   from coupler.

    atm/cam/src/control/con_cam.F90
    atm/cam/src/control/ccsm_msg.F90

   Remove dependence on CAM specific data and modules and use CCSMInit
   and SyncClock driver level objects.

    drv/seq_mct_drv/seq_ccsm_drv.F90
    drv/seq_mct/mrg_x2a_mct.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All tests pass except the CCSM comparison test

  055 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2

  CCSM failed because the new CCSM scripts for this tag don't work with the old CAM
  Thus the comparison to the old CCSM tag and cam3_3_14 had to be done by hand.
  The comparison is exact if esmf_wrf_timemgr is updated in cam3_3_14 to
  esmf_wrf_timemgr_051212. If not the difference is bit-for-bit until the 25th time-step
  when the difference is off by roundoff. This was documented in the cam3_3_4 commit
  where we had a roundoff difference due to the new esmf_wrf_timemgr.

  For running CCSM test use:

  env CAM_CCSMROOT=/fs/cgd/csm/models/atm/newchg_ccsm3_1_beta34

tempest: none

bangkok/lf95: none

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_3_14

Summarize any changes to answers: none (bit-for-bit)
                                  CCSM (changes to roundoff)

  CCSM answers change because esmf_wrf_timemgr updated from an
  older version 050309 to the version used here 060616.

===============================================================
===============================================================

Tag name:  cam3_3_14
Originator(s): mvr
Date: 060612
One-line Summary: 
Update the ccsm tests within cam's test suite to reflect new changes to 
ccsm's scripts; minor bug fixes to test scripts; cray x1 mods in newcprnc

Purpose of changes: new naming conventions were introduced to ccsm's 
test scripts; newcprnc required mods for cray x1

Bugs fixed (include bugzilla ID): applied fix for bug #43 to cam's newcprnc 
code just as it was applied to clm's

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself

List all subroutines eliminated:
D      models/atm/cam/tools/newcprnc/cprnc.f90
- file renamed due to pre-processor directives added for cray x1

List all subroutines added and what they do:
A  +   models/atm/cam/tools/newcprnc/cprnc.F90
- new file with directives for cray x1
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TSB.ccsm.sh
- mods to reflect name changes introduced in ccsm scripts; added cleanup after 
  successful ccsm test; minor bug fixes
M      models/atm/cam/test/system/TCT.ccsm.sh
- mods to reflect name changes introduced in ccsm scripts; now dumps output 
of create_test to output log
M      models/atm/cam/test/system/test_driver.sh
- test suite now uses prod queue rather than debug on phoenix
M      models/atm/cam/test/system/gen_test_table.sh
- utility updated to include all platforms supported by cam's test driver
M      models/atm/cam/test/system/input_tests_master
- mods to reflect name changes introduced in ccsm scripts
M      models/atm/cam/test/system/TCB.ccsm.sh
- mods to reflect name changes introduced in ccsm scripts
M      models/atm/cam/tools/newcprnc/nfwrappers.f90
- bug fix for intent of variables in wrap_open (see bug #43)
M      models/atm/cam/tools/newcprnc/Makefile
- added mods for cray x1
M      posttag_cron_bangkok.sh
M      posttag_cron_bluesky.sh
M      posttag_cron_lightning.sh
M      posttag_cron_bluevista.sh
- cron scripts modified to make use of "collections" area for cam tags
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
055 cs998 TCS.ccsm.sh ERS f19_g13 K ...............................FAIL! rc= 2
- ccsm test fails when comparing to baseline due to changes in naming 
  conventions...tests were verified by hand

tempest: all pass

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name: cam3_3_13
Originator(s): Jim Edwards
Date: 060606   
One-line Summary: addition of HOMME dynamic core, removal of plat/plon from physics

Purpose of changes: development of a new dynamic core prototype, generalization of
	model to non-rectangular horizontal grids

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:  Added support for homme dynamics in configure.

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself, Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do: a dynamics/homme subdirectory was added
	with stubs to interface the (external) homme model
A    models/atm/cam/src/dynamics/homme
	A    models/atm/cam/src/dynamics/homme/initcom.F90
	A    models/atm/cam/src/dynamics/homme/pmgrid.F90
	A    models/atm/cam/src/dynamics/homme/dp_coupling.F90
	A    models/atm/cam/src/dynamics/homme/dycore.F90
	A    models/atm/cam/src/dynamics/homme/dyn_comp.F90
	A    models/atm/cam/src/dynamics/homme/inidat.F90
	A    models/atm/cam/src/dynamics/homme/stepon.F90
	A    models/atm/cam/src/dynamics/homme/restart_dynamics.F90
	A    models/atm/cam/src/dynamics/homme/commap.F90
	A    models/atm/cam/src/dynamics/homme/spmd_dyn.F90
	A    models/atm/cam/src/dynamics/homme/dyn_grid.F90
	A    models/atm/cam/src/dynamics/homme/README
	A    models/atm/cam/src/dynamics/homme/inital.F90
	A    models/atm/cam/bld/config_cam_homme_defaults.xml
List all existing files that have been modified, and describe the changes:
        Changed FV CPP macro STAGGERED to the more appropriate and general DYN_STATE_INTERFACE
	
        U    models/atm/cam/src/control/runtime_opts.F90
	U    models/atm/cam/src/control/ccsm_msg.F90
	U    models/atm/cam/src/control/startup_initialconds.F90
	U    models/atm/cam/src/control/cam_comp.F90
	U    models/atm/cam/src/utils/time_manager.F90

        Removed references to plat and plon. 
	
	U    models/atm/cam/src/physics/cam1/comsrf.F90
	U    models/atm/cam/src/physics/cam1/dmsbnd.F90
	U    models/atm/cam/src/physics/cam1/acbnd.F90
	U    models/atm/cam/src/physics/cam1/dust_intr.F90
	U    models/atm/cam/src/physics/cam1/tracers_suite.F90
	U    models/atm/cam/src/physics/cam1/boundarydata.F90
	U    models/atm/cam/src/physics/cam1/drydep_mod.F90
	U    models/atm/cam/src/physics/cam1/restart_physics.F90
	U    models/atm/cam/src/physics/cam1/stratiform.F90
	U    models/atm/cam/src/physics/cam1/water_tracers.F90
	U    models/atm/cam/src/physics/cam1/co2_data_flux.F90
	U    models/atm/cam/src/physics/cam1/volcanicmass.F90
	U    models/atm/cam/src/physics/cam1/physpkg.F90
	U    models/atm/cam/src/physics/cam1/wetdep.F90
	U    models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
	U    models/atm/cam/src/physics/cam1/carbon_intr.F90
	U    models/atm/cam/src/physics/cam1/sulchem.F90
	U    models/atm/cam/src/physics/cam1/co2_cycle.F90
	U    models/atm/cam/src/physics/cam1/sulbnd.F90
	U    models/atm/cam/src/physics/cam1/soxbnd.F90
	U    models/atm/cam/src/physics/cam1/caerbnd.F90
	U    models/atm/cam/src/physics/cam1/aerosol_intr.F90
	U    models/atm/cam/src/physics/cam1/advnce.F90
	U    models/atm/cam/src/physics/cam1/sulfur_intr.F90

        Added support for HOMME dycore
	
	U    models/atm/cam/bld/configure
	U    models/atm/cam/bld/resolution_parameters.xml
	


	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: none 
	tested with CAM_CCSMROOT=/fs/cgd/csm/collections/ccsm3_1_beta29
	
tempest: none

bangkok/lf95:  none 

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

Tag name:  cam3_3_12
Originator(s): mvr, jedwards
Date: 060602
One-line Summary: test suite now supports phoenix (cray x1); 
	added testing of coupled model to bluevista; bug fix 
	for fv coupled runs

Purpose of changes: wanted test coverage of cray x1; testing 
	of coupled model had been restricted to just bluesky;
	new features in ccsm's scripts available for use

Bugs fixed (include bugzilla ID): 

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets:
- added DMS_emmissions, oxid, and SOx_emissions files for fv 2x2.5
- updated to newer SOx_emissions file for T85
	
Describe any substantial timing or memory changes:

Code reviewed by: myself

List all subroutines eliminated:
none

	
List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/fmo2m
A      models/atm/cam/test/system/config_files/f2c11m
A      models/atm/cam/test/system/config_files/e128m
A      models/atm/cam/test/system/config_files/e128c11m
A      models/atm/cam/test/system/config_files/fm1.9m
A      models/atm/cam/test/system/config_files/f1.9pm
A      models/atm/cam/test/system/config_files/f1.9m
A      models/atm/cam/test/system/config_files/e128pm
- new configuration options for testing on phoenix

A      models/atm/cam/test/system/nl_files/off2x2.5p
- new namelist options for testing on phoenix
	
A      models/atm/cam/test/system/TCT.ccsm.sh
- new test script needed for testing of coupled model
	
A      models/atm/cam/test/system/tests_posttag_phoenix
A      models/atm/cam/test/system/tests_posttag_robin
- new sets of default posttag tests for robin and phoenix

	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TSB.ccsm.sh
M      models/atm/cam/test/system/TCB.ccsm.sh
- scripts for testing of coupled model now supports bluevista, phoenix;
  build of coupled model can now be done separately prior to run;
  updated to take advantage of new features in ccsm scripts

M      models/atm/cam/test/system/tests_posttag_bluesky
M      models/atm/cam/test/system/tests_pretag_bluesky
- defaults test sets modified to have fv ccsm test be pretag, eul posttag 

M      models/atm/cam/test/system/tests_posttag_bluevista
- default posttag tests on bluevista now include ccsm tests
	
M      models/atm/cam/test/system/test_driver.sh
- support added for robin/phoenix; MPI_TYPE_MAX now set for all platforms
	
M      models/atm/cam/test/system/input_tests_master
M      models/atm/cam/test/system/CAM_runcmnd.sh
- new tests added to master list for phoenix

M      models/atm/cam/bld/camexp.pm
- mod to allow for casenames of length 80 characters
	
M      models/atm/cam/bld/DefaultCAMEXPNamelist.xml
- added default input files for fv 2x2.5; updated to a newer T85 file
	
M      models/atm/cam/src/control/ccsm_msg.F90
M      models/atm/cam/src/control/history.F90
- bug fixes to remove call to getfil for files not yet in existence - 
  would fail on phoenix when it tried to find it on mass store

M      models/atm/cam/src/chemistry/trop_mozart/mo_imp_sol.F90
- bug fix for line length exceeding max number of characters
	
M      models/atm/cam/src/dynamics/fv/dyn_grid.F90 
- bug fix for problem introduced in cam3_3_11 for fv coupled runs

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: 
001 sb998 TSB.ccsm.sh ER.01a 1.9x2.5_gx1v3 K ......................FAIL! rc= 6
055 cs998 TCS.ccsm.sh ER.01a 1.9x2.5_gx1v3 K ......................FAIL! rc= 2
- failed due to mods in test scripts; test passes when run manually

tempest:
all pass
	
bangkok/lf95:
all pass
	
CAM tag used for the baseline comparison tests if different than previous
tag: fv ccsm test used cam3_3_10

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff? b4b

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
Tag name: cam3_3_11
Originator(s): pworley, Jim Edwards
Date: 5/25/2006
One-line Summary: phys_grid changes for single index method to support non-rectangular grids

Purpose of changes: to support non-rectangular grids
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:  myself, Brian Eaton, Mariana, Pat Worley

List all subroutines eliminated:  
	cam_domain, 
	get_cid_all_p, 
	get_chunk_coord_owner_p, 
        get_chunk_owner_p
	get_cid_p
	get_block_coord_d
	get_block_coord_cnt_d
        get_block_col_cnt_d
        get_lon_d
	get_lat_d
	
	
	
	
List all subroutines added and what they do: 
	get_gcol_all_p,  get the global column id for all columns in the chunk
        get_area_all_p,  get the area of all columns in the chunk
        get_block_gcol_d  get column indices for given block
	get_gcol_block_d    get global block indices and local columns index for given global column index
	get_horiz_grid_d: provides the total number of global columns visible to the physics
	                  the lat, lon location and the surface area of each column

	(functions)
	get_area_p : get area of column
	get_gcol_p : get gcol id of column
	get_gcol_owner_p : get task of column gcol in physics
	get_block_gcol_cnt_d : get number of columns in given block
	get_gcol_block_cnt_d :  get number of blocks containing data
	                        from a given global column index
	get_horiz_grid_cnt_d : get number of columns in dynamics grid (visible to physics)
	

List all existing files that have been modified, and describe the changes:

         The cam_domain module was removed and these files modified to
	 get the mct grid initialization data directly from the physics 
	 chunk on the task.  This is both a simplification and a generalization
	 of the method introduced in cam3_3_9
        
	M      models/ocn/dom/ocn_comp_mct.F90
	M      models/ocn/som/ocn_comp_mct.F90
	M      models/ice/csim4/ice_comp_mct.F90
	M      models/atm/cam/src/control/ccsm_msg.F90
	M      models/atm/cam/src/control/atm_comp_mct.F90
	M      models/atm/cam/src/control/cam_comp.F90
	M      models/drv/seq_mct/seq_domain_mct.F90
            
        Chunks (decomposed grid in the physics) were changed from 
	2-D arrays in the horizontal to 1D.  
	This allows the generalization of cam physics to
	non-rectangular grids.  
	
	M      models/atm/cam/src/physics/cam1/physics_types.F90
	M      models/atm/cam/src/physics/cam1/phys_grid.F90
	M      models/atm/cam/src/dynamics/sld/dyn_grid.F90
	M      models/atm/cam/src/dynamics/eul/dyn_grid.F90
	M      models/atm/cam/src/dynamics/fv/dyn_grid.F90

	Support for the historical reduced grid method has been removed
	if a reduced grid is reintroduced in the future it should use the
	more general method introduced here.  
	M      models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_ub_vals.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_tropopause.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_sulf.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_airplane.F90
	M      models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_lb_vals.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_photo.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_ch4_lbc.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_strato_sad.F90
	M      models/atm/cam/src/chemistry/trop_mozart/mo_srf_emissions.F90
	M      models/atm/cam/src/chemistry/waccm_mozart/mo_tgcm_ubc.F90
	M      models/atm/cam/src/chemistry/waccm_mozart/mo_sulf.F90
	M      models/atm/cam/src/chemistry/waccm_mozart/mo_airplane.F90
	M      models/atm/cam/src/chemistry/waccm_mozart/mo_drydep.F90
	M      models/atm/cam/src/chemistry/waccm_mozart/mo_srf_emissions.F90

	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All tests pass

tempest:  All tests pass

bangkok/lf95: All tests pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_10
Originator(s): mvr
Date: 060524
One-line Summary: added gensom option to configure; added test of gensom 
	vars to test suite; updated externals to new timing files; cleanup 

Purpose of changes: SOM input fields should not be generated and written 
	to history tapes by default; unused integer return codes of some 
	timing routines were causing problems on phoenix; write statements 
	and empty directories were left behind from previous commits
	

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: -gensom option added to configure

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: not including the SOM 
	input fields by default may show slight improvement

Code reviewed by: myself, eaton

List all subroutines eliminated: 
D      models/atm/cam/test/system/config_files/f4c11dh
- config options file replaced with one that includes -gensom option for testing
D      models/atm/cam/src/ocnsice
D      models/atm/cam/src/ocnsice/dom
D      models/atm/cam/src/ocnsice/som
- removed empty directories left behind from previous commit
	
List all subroutines added and what they do:
A      models/atm/cam/test/system/config_files/f4c11gdh
- replacement config options file with -gensom option for testing 

List all existing files that have been modified, and describe the changes:
M      models/utils/SVN_EXTERNAL_DIRECTORIES
- updating to new timing tag with mods for replacing int return codes with void
M      models/atm/cam/test/system/input_tests_master
- adding test of the new configure option (gensom) to an existing test
M      models/atm/cam/bld/configure
- modified to handle new option for generating SOM input fields
M      models/atm/cam/bld/config_cam_eul_defaults.xml
M      models/atm/cam/bld/config_trop_chem_mozart_defaults.xml
M      models/atm/cam/bld/config_waccm_ghg_defaults.xml
M      models/atm/cam/bld/config_waccm_mozart_defaults.xml
M      models/atm/cam/bld/config_cam_fv_defaults.xml
M      models/atm/cam/bld/config_cam_sld_defaults.xml
- added default values for gensom
M      models/atm/cam/src/control/atm_comp_mct.F90
M      models/drv/seq_mct/mrg_x2a_mct.F90
M      models/drv/seq_mct/seq_domain_mct.F90
- removed write statements left behind from previous commits

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
019 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 5
- failed because this is a new test and did not exist in previous tag
	
tempest:
021 bl331 TBL.sh f4c11gdh pghgsul 9 ...............................FAIL! rc= 5
- failed because this is a new test and did not exist in previous tag

bangkok/lf95:
none
	
CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_9
Originator(s): Mariana Vertenstein
Date: Wed May 17 13:05:13 MDT 2006
One-line Summary: created new generate som mode for mct coupling

Purpose of changes: Remove output of ice/ocn specific fields from
   mrg_x2a_mct.F90 and move then to atm_comp_mct.F90. All routines
   in mct_drv/ should be devoid of cam specific information.

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: default seq_flds_mod.F90
   to be used is currently in drv/seq_flds/gensom. This corresponds
   to extra fields being sent to the atm which would only be used
   for SOM input fields generation. Changes need to be made to
   the testing scripts and configure to support a gensom option.

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: The extra
  fields being sent to atm_comp_mct.F90 might have a very small
  performance penalty. However, a fix for this is expected in the
  very near future.

Code reviewed by: Myself (discussed these changes with Brian Eaton)

List all subroutines eliminated: 

List all subroutines added and what they do:

   A drv/seq_flds/gensom/seq_flds_mod.F90
        sends fields to atm that are needed for SOM input data generation

List all existing files that have been modified, and describe the changes:

   M atm/cam/src/control/history_defaults.F90
   M atm/cam/src/physics/cam1/diagnostics.F90
   M ocn/som/ocn_comp.F90
        moved history file initialization from diagnostics.F90 and history_defaults.F90 for:
        TSOCN&IC, QFLUX, QFLUX_FT, QFLUX_TH, QFLUX_A2, FOCN, OIE, OIERATE, ONF, MLDANN  
   M ice/csim4/ice_comp.F90
        moved history file initialization from diagnostics.F90 and history_defaults.F90 for:
        MELTB   ,MELTT   ,MELTL   ,GROWB   ,FRAZIL  ,FLOOD   ,FRZMLT  ,NRGERROR,DELTAICE
        NRGICE  ,IIERATE ,F_ICE   ,F_OCN   ,FRZMLTMX,IMBAL   ,EICEIN  ,EICEOUT , TSICERAD&IC 
   M atm/cam/src/control/ccsm_msg.F90
        moved history file initialization from diagnostics.F90 and history_defaults.F90 for:
        CPLRAINC,CPLRAINL,CPLSNOWC,CPLSNOWL,CPLPRCER
   
   M atm/cam/tools/scam/scm_init/scam_run.F90
   M drv/seq_mct_drv/seq_ccsm_drv.F90
        removed call to mrg_x2a_run1_mct
        renamed call to mrg_x2a_run2_mct as call to mrg_x2a_run_mct
   M drv/seq_mct/mrg_x2a_mct.F90
        removed subroutine mrg_x2a_run1_mct 
        renamed subroutine mrg_x2a_run2_mct as call to mrg_x2a_run_mct

   M atm/cam/bld/configure
        set default path for seq_flds to $srcdir/drv/seq_flds/gensom

   M atm/cam/src/control/atm_comp_mct.F90
        added private subroutines atm_gensom1_mct and atm_gensom2_mct
        that provide fuctionality previously done in 
        mrg_x2a_run1_mct and mrg_x2a_run2_mct - they are only invoked
        if indices in seq_flds_indices for SOM generation fields are
        non-zero (this will only be the case if 
        $srcdir/drv/seq_flds/gensom/seq_flds_mod.F90 is used.

   M drv/seq_flds_indices/seq_flds_indices.F90                                                                                                                            added indices necessary for SOM data generation
 
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: all pass

tempest: all pass

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_8
Originator(s): Mariana Vertenstein
Date: Sat May 13 17:48:49 MDT 2006
One-line Summary: to implement MCT domains in each component

Purpose of changes: To implement MCT domains and implement
   a top level domain checker for cam and the surface components
   using these domains (this replaces use statements within clm)
   Note that cam3_3_7 was identical to this tag - but was tagged
   with the wrong land externals - this tag fixes this problem.	    
	
Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None
  all changes are in the initialization phase - however,
  the impact of timing due to initialization has not been tested

Code reviewed by: Tony Craig and Rob Jacob

List all subroutines eliminated: None

List all subroutines added and what they do:

   A  models/atm/cam/src/control/cam_domain.F90
        A new routine that can be used by both ccsm_msg.F90 and the 
        atm_comp_mct.F90 routine to calculate the cam grid and areas 
        (this code was previously contained in ccsm_msg.F90).

List all existing files that have been modified, and describe the changes:

   M  models/atm/cam/src/control/atm_comp_mct.F90
   M  models/ocn/dom/ocn_comp_mct.F90
   M  models/ocn/som/ocn_comp_mct.F90
   M  models/ice/csim4/ice_comp_mct.F90
   M  models/lnd/clm2/src/main/lnd_comp_mct.F90
   M  models/atm/cam/tools/scam/scm_init/init_model.F90
   M  models/atm/cam/tools/scam/scm_init/scam_srfdata_MCT.F90
   M  models/drv/seq_mct_drv/seq_ccsm_drv.F90
   M  models/drv/seq_mct/seq_mct_mod.F90
   D  models/drv/seq_mct/seq_mct_init.F90 => A models/drv/seq_mct/seq_init_mct.F90
      In the above routines: 
      * domains were implemented using the MCT general grid data structures
      * the current general grid components that I am defining are
        lon,lat,area,mask and maxfrac (maxfrac is the maximum fraction
        that the model can have on any gridcell - for the landthis
        corresponds to the landfrac, for the ocn and ice this should
        correspond to 1.-landfrac when everyone is on the same grid)
      * domain checking is only done on the master processor at
        initialization (via an MCT gather on the general grid)
      * essentially, domains enable grid and fraction checking to be done
        at the top level by the master processor and eliminates the use
        statements contained in the land model. The consistency check for
        fractional land is somewhat different than in the current flux
        coupler. Basically, when all the models are on the same grid, you
        want the "maximum fraction" from each component to be consistent.
        What this boils down to is that the max_frac from the ocn/ice must
        equal (1.-landfrac)to within some eps (I have specified 1.e-13).      
        In the ccsm cpl6 system, the ocn determines the landfrac,and on the
        ocean grid maxfrac is either 1 or 0. This is clearly different
        than in the current system.

   M  models/atm/cam/src/physics/cam1/comsrf.F90
   M  models/atm/cam/src/physics/cam1/restart_physics.F90
   M  models/atm/cam/src/dynamics/sld/inidat.F90
   M  models/atm/cam/src/dynamics/eul/inidat.F90
   M  models/atm/cam/src/dynamics/fv/inidat.F90
       -removed landfrac_glob.F90 from above routines

   M  models/atm/cam/src/control/ccsm_msg.F90
      - made changes to use cam_domain.F90 for determining grid information

   M  models/ocn/dom/ocn_comp.F90
   M  models/ocn/som/ocn_comp.F90
   M  models/ice/csim4/ice_comp.F90
   M  atm/cam/src/physics/cam1/diagnostics.F90
      - moved calls for the following initial file fields:  
          SNOWHICE&IC, ICEFRAC&IC, SICTHK&IC, TSICERAD&IC 
        to models/ice/csim4/ice_comp.F90 
      - moved calls for the following initial file fields:
          TSOCN&IC
        to models/ocn/som/ocn_comp.F90 and models/ocn/dom/ocn_comp.F90 
      - removed references to initial file file fields TS&IC since this 
        intiial field it was not being used by any routine

   M  atm/cam/src/physics/cam1/restart_physics.F90
      - removed references to landfrac_glob and all COUP_CSM if-defs

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: all pass

tempest: all pass

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================
	
Tag name: cam3_3_7
Originator(s): Mariana Vertenstein
Date: Sat May 13 17:48:49 MDT 2006
One-line Summary: to implement MCT domains in each component

Note that tag had a problem with the land externals - another tag
was made using the correct land externals
	
===============================================================
===============================================================

Tag name: cam3_3_6
Originator(s): eaton, tcraig
Date: Mon May  8 11:26:41 MDT 2006
One-line Summary: Fix CAM log problem in CCSM runs

Purpose of changes:

  . Fix problem with CAM log file not being written during CCSM run.  The
    fix was provide by tcraig in bugzilla bug 102.

  . Set MPI_TYPE_MAX environment variable for testing on tempest
    (sgi-o3800).  This problem started in cam3_3_3 with FV code updates.
    It is only a problem on machines that have a default value which is too
    small.  Currently setting MPI_TYPE_MAX=100000 is sufficient.  The
    problem has also been observed on phoenix (cray-x1e).

Bugs fixed (include bugzilla ID): 102

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself, tcraig

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  models/atm/cam/src/control/con_cam.F90
  . rearrange initialization as follows:
     call cpl_interface_init(cpl_fields_atmname, mpicom)   ! call mpi_init
     call spmdinit()                                       ! set masterproc
     call shr_msg_chdir('atm')                             ! all PE's chdir
     call shr_msg_chStdin('atm')                           ! all PE's redirect unit 5
     if (masterproc) call shr_msg_chStdout('atm')          ! redir unit 6
     call ESMF_Initialize()                                ! init ESMF time manager
     call ccsm_seq_timer_init()                            ! init timing library

  models/atm/cam/test/system/test_driver.sh
  . add "export MPI_TYPE_MAX=100000" for testing on tempest

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: Only ran CCSM test -- PASS.

tempest: All PASS.

bangkok/lf95: no tests done -- none of the code mods are exercised on bangkok

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_5
Originator(s): sawyer, eaton
Date: Sun May  7 14:58:53 MDT 2006
One-line Summary: Fix omega calc for FV offline mode

Purpose of changes: Fix omega calc for FV offline mode

Bugs fixed (include bugzilla ID):

  The fix for the FV omega calc added in cam3_3_3 was inadvertently left
  out of the offline version of FV.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: myself, sawyer

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  models/atm/cam/src/dynamics/fv/dyn_comp.F90
  . call compute_vdot_gradp for both prognostic and offline FV

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS except:

  040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7

  This baseline test is expected to fail.  Only the OMEGA field is different.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_4
Originator(s): Erik Kluzek
Date:  May/01/2006
One-line Summary: Update clm, csm_share, and esmf_wrf_timemgr, use shr_file_mod for archiving

Purpose of changes: First step in moving toward using ESMF clock interface at top level
    use shr_file_mod syntax for archive_dir.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Tony Craig, Mariana Vertenstein, Brian Kauffman (csm_share and clm)

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

M      models/drv/seq_mct_drv/seq_ccsm_drv.F90

M      test/unit/control/configure
M      test/unit/control/run_time_test
M      tools/scam/scm_init/init_model.F90
M      src/control/ccsm_msg.F90
M      src/control/con_cam.F90
M      src/control/history.F90
M      src/control/filenames.F90
M      src/control/ioFileMod.F90
M      src/physics/waccm/chemistry.F90

Also use new version of CLM (shrgetput08_cammct05_clm3_expa_58), csm_share (share3_060428) and 
esmf_wrf_timemgr (esmf_wrf_timemgr_060501)

Changes needed to use new versions of above libraries. Make sure a getfil is done before
a open-file. All programs need to do a ESMF_Initialize. ioFileMod uses shr_file_mod.F90 rather
than it's own functionality. filenames sets up archive_dir for shr_file_mod.F90 syntax (with
mss: prescript). Time unit tests use Lahey instead of PGI compiler on Linux.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: None

tempest: None

bangkok/lf95:
012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7

esmf_wrf_timemgr real-r8 julian day calculations are off by roundoff on Linux platforms.
It's off by roundoff on other platforms after 4-years. According to the unit tests it
remains within roundoff even for a very long simulation time.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_3_3

Summarize any changes to answers, i.e.,
- what code configurations: outfrq24
- what platforms/compilers: Linux lf95/pgi

If bitwise differences were observed, how did you show they were no worse
than roundoff? cprnc shows RMS difference in the 1e-17-1.e-20 range
	Also unit-tests for time-manager shows that answers for julian day remain
	bounded within roundoff even for a very long simulation time.

===============================================================
===============================================================

Tag name: cam3_3_3
Originator(s): sawyer, eaton
Date: Tue Apr 25 16:17:05 MDT 2006
One-line Summary: FV dycore improvements, fix omega diagnostic

Purpose of changes:
   o  The XY decomposition is now the only one which is
      visible to the outside user (YZ is hidden).  This 
      simplifies the CAM-specific part of FV (code inside 
      the dynamics/fv directory but outside of the portable
      FV core) enormously.
     
   o  A dynamical core interface has
      been written which is ESMF-like (init, run, final)
      using an import and export container, and implementing
      a dynamics state.
 
   o  Correct calculation of OMEGA, and related diagnostics.
 
   o  Resynchronized versions of FV dycores and PILGRIM
      between GEOS5 and CAM (except GEOS5 vertical remapping).  
 
   o  Numerous other software engineering improvements 
      (all bit-for-bit).

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

  The timings for the FV dycore are roughly the same on bluevista.  There
  is about a 10% slowdown on phoenix.

Code reviewed by: sawyer, eaton

List all subroutines eliminated:

  models/atm/cam/src/dynamics/fv/FVCAM_GridCompMod.F90
  . renamed dyn_comp.F90
  models/atm/cam/src/dynamics/fv/gmean.F90
  . move this subroutine into the new module mean_module.F90
  models/atm/cam/src/dynamics/fv/prognostics.F90
  . prognostic state info now in dyn_import and dyn_export

List all subroutines added and what they do:

  models/atm/cam/src/dynamics/fv/diag_module.F90
  . contains the new routine compute_vdot_gradp which supplies a fix for
    the OMEGA calculation
  models/atm/cam/src/dynamics/fv/dyn_comp.F90
  . was FVCAM_GridCompMod.F90
  models/atm/cam/src/dynamics/fv/mean_module.F90
  . new module contains the old gmean.F90 and new XY version of gmean

List all existing files that have been modified, and describe the changes:

  models/atm/cam/src/control/history.F90
  . add ability to work with FV fields using XY decomp -- it appears that the
    ability to use YZ decomp has been maintained.
  . generalize the beg/end index names
  . allow history restart write/read to work with XY decomp 

  models/atm/cam/src/control/cam_comp.F90
  models/atm/cam/src/control/restart.F90
  models/atm/cam/src/control/startup_initialconds.F90
  . add STAGGERED ifdef to support passing dynamics import/export types through top
    level interfaces

  models/atm/cam/src/dynamics/fv/diag_dynvar_ic.F90
  . use XY decomp only

  models/atm/cam/src/dynamics/fv/dp_coupling.F90
  . use XY decomp only
  . use dyn import/export types

  models/atm/cam/src/dynamics/fv/dryairm.F90
  . modify for XY decomp

  models/atm/cam/src/dynamics/fv/dynamics_vars.F90
  . move ESMF code inside GEOS_MODE ifdefs
  . remove some tracertrans related code

  models/atm/cam/src/dynamics/fv/epvd.F90
  . update for XY decomp

  models/atm/cam/src/dynamics/fv/fv_prints.F90
  . converted to XY decomp
  . ifdef out unused code to find max/min constituent values

  models/atm/cam/src/dynamics/fv/inidat.F90
  . use dyn_import/export_t containers
  . remove dependency on prognostics
  . input fields now scattered to XY decomp

  models/atm/cam/src/dynamics/fv/inital.F90
  . use dyn_import/export_t containers
  . remove dependency on prognostics

  models/atm/cam/src/dynamics/fv/io_dist.F90
  . add methods needed for read/write of XY decomp from/to restart files

  models/atm/cam/src/dynamics/fv/mapz_module.F90
  . add option for cubic interpolation

  models/atm/cam/src/dynamics/fv/metdata.F90
  . remove unneeded ghosting of met_us, met_vs (it's done in cd_core).

  models/atm/cam/src/dynamics/fv/p_d_adjust.F90
  . modify to use XY decomp only

  models/atm/cam/src/dynamics/fv/par_xsum.F90
  . remove CPP conditional surrounding par_xsum_r4

  models/atm/cam/src/dynamics/fv/pfixer.F90
  . remove SPMD ifdefs that surrounded !$omp directives.

  models/atm/cam/src/dynamics/fv/restart_dynamics.F90
  . remove prognostics module
  . add dyn_out as intent(in) arg to write_restart_dynamics
  . modify read/write methods to work with XY decomp
  . add dyn_in/out as intent(out) args to read_restart_dynamcis

  models/atm/cam/src/dynamics/fv/spmd_dyn.F90
  . remove tracertrans-related variables

  models/atm/cam/src/dynamics/fv/stepon.F90
  . remove prognostics by adding dyn_state to dyn_comp
  . use dyn_import_t and dyn_export_t from dyn_comp
  . get rid of lots of local xy arrays that are now part of the import/export
    states
  . add dyn_in, dyn_out dummy args to stepon_init
  . the components of dyn_in are being initialized rather than local variables
  . add dyn_in, dyn_out as dummy args to stepon_run1
  . replace actual args to diag_dynvar_ic with components of dyn_out
    (previously used prognostics module data).
  . replace actual args to dyn_run with dyn_state, dyn_in, dyn_out.
    Previously passed prognostics module vars and local xy vars.
  . use dyn_out as actual arg to d_p_coupling instead of all the local xy
    arrays. 
  . add dyn_in, dyn_out as intent(out) args to stepon_run2
  . use dyn_in as actual arg to p_d_coupling instead of mix of prognostics
    and local xy arrays
  . add dyn_in, dyn_out as intent(out) args to stepon_run3
  . pass components of dyn_out as actual args to fv_out

  models/atm/cam/src/dynamics/fv/sw_core.F90
  . change an index range in one calc

  models/atm/cam/src/dynamics/fv/te_map.F90
  . added some SPMD ifdefs

  models/atm/cam/src/dynamics/fv/trac2d.F90
  . add local variable frac to private declaration in !$omp and !CSD$ directives

  models/atm/cam/src/dynamics/fv/uv3s_update.F90
  . update to use XY decomp.  Note that u3s and v3s are no longer passed with
    ghost regions because the ghost region is taken care of in local variables.

  models/atm/cam/src/dynamics/eul/dyn_grid.F90
  models/atm/cam/src/dynamics/fv/dyn_grid.F90
  models/atm/cam/src/dynamics/sld/dyn_grid.F90
  . move ptimelevels from prognostics to here.

  models/atm/cam/src/physics/cam1/phys_buffer.F90
  models/atm/cam/src/physics/cam1/restart_physics.F90
  . get ptimelevels from dyn_grid instead of prognostics

  models/utils/pilgrim/mod_comm.F90
  models/utils/pilgrim/parutilitiesmodule.F90
  models/utils/pilgrim/puminterfaces.F90
  models/utils/pilgrim/redistributemodule.F90
  . merge with GEOS5 version of pilgrim

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS except:

  019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
  022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
  027 bl334 TBL.sh f4dh adia 9 ......................................FAIL! rc= 7
  030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 7
  034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
  037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7

tempest: All PASS except:

  017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 7
  021 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
  024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
  029 bl335 TBL.sh f4dh idphys 9 ....................................FAIL! rc= 7
  031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7

bangkok/lf95: All PASS except:

  016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
  024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 7
  028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7

  All the baseline tests that fail on bluesky, tempest, and bangkok do so
  due to changes in the diagnostic OMEGA and OMEGAT fields.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_3_1

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_2
Originator(s): Jim Edwards
Date: 4/24/2006
One-line Summary: Eliminate common block comlun

Purpose of changes: code clean up

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: self

List all subroutines eliminated:  

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
In control directory:
file comlun.h removed 
readinitial.F90 - converted to netcdf f90 interface, modified for ncol format 
	 initial file
runtime_opts.F90, history.F90 - removed reference to ncid_ini and ncid_topo 
startup_initial_cond.F90 - made ncid_ini and ncid_topo module variables
	added function interfaces  initial_file_get_id and topo_file_get_id
	to allow read only access to these.
ioFileMod.F90 - made info messages print from masterproc only 
error_messages.F90 - added an option integer variable in handle_ncerr to
	print the error line number
physics/waccm/tgcm_forcing.F90: removed unused reference to comlun.h
physics/waccm/chemistry.F90: removed unused reference to ncid_trc and comlun.h
physics/cam1/co2_data_flux.F90: removed unused reference to comlun.h
physics/cam1/boundarydata.F90: changed calls to handle_ncerr to add line number
dynamics/*/inidat.F90: changed read_inidat to pass in ncid_ini, ncid_topo 
	{eul,sld}/spegrd.F90
	{eul,sld}/linemsdyn.F90
	sld/tfilt_massfix.F90 - removed unused refs to comlun.h
tools/scam/scm_init/inital.F90
tools/scam/scm_init/init_model.F90 - removed refs to comlun.h 
ice/csim4/ice_comp.F90
ice/csim4/ice_data.F90 
ocn/som/somini.F90
ocn/som/ocn_comp.F90
ocn/som/somint.F90
ocn/dom/ocn_comp.F90
ocn/dom/sst_data.F90 - replaced refs to comlun.h with calls to functions or
	 local variables as appropriate.
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All pass

tempest: All pass

bangkok/lf95: All pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_1
Originator(s): Mariana Vertnestein
Date: 4/18/2006
One-line Summary: bug fixes necessary for CCSM phoenix 

Purpose of changes: Implemented several minor bugs fixes necessary
   to run CAM in CCSM on phoenix (Cray X1)

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: myself, Jon Wolfe, Brian Eaton

List all subroutines eliminated: None

List all subroutines added and what they do: None

List all existing files that have been modified, and describe the changes:
  M  src/control/con_cam.F90
	Modifications put in so that only the lead/master MPI process
	redirects its stdout to the appropriate component model log file when
	running fully coupled, instead of having every process "open" the same
	log file.  This change solves the problem of logs getting trashed on
	phoenix (which has been recently experienced).  The only down side is
	that warning and error messages generated by other processes
	(non-master processes) get stuck in the job's stdout file, so users
	may want to archive job output files as well as component model logs.
	In addition, when debugging problems with the model system, certain
	error messages which may have previously appeared in component model
	logs may now appear in the job output.

   M src/dynamics/fv/trac2d.F90
   M src/dynamics/fv/cd_core.F90
        Removed streaming directives for COUP_CSM mode where a routine is called
        from within a streaming region. This problem does not exist in stand-alone
        CAM mode, but causes the system to hang or crash in coupled mode. This is   
        bug will be reported to Cray, but a fix has currently been implemented so
        that production runs can occur on phoenix.
        the following changes was made for cpp directives:
        #if defined(USE_OPM => #if (!definedUSE_OMP) && (!defined COUP_CSM)

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: no pre-tag testing was done

tempest: no pre-tag testing was done

bangkok/lf95: no pre-tag testing was done

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_3_0
Originator(s): Mariana Vertenstein
Date: 4/18/2006
One-line Summary: Directory restructuring for sequential ccsm

Purpose of changes: 
  Create new directory structure and mct file renaming for 
  the next step in the creation of a sequential ccsm starting
  from stand-alone cam and for the next step in the ESMF stage
  1 evaluation effort.  

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: 
   bld/configure was changed to take into account the new directory
   structure and to remove the obsolete mode for the sea ice package "ccmice"

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes: None

Code reviewed by: Myself, Brian Eaton

List all subroutines eliminated:
List all subroutines added and what they do:
The following lists the directory restucturing and file renaming that was done

    D atm/cam/src/ocnsice/dom/sst_data.F90         => A  models/ocn/dom/sst_data.F90	     
    D atm/cam/src/ocnsice/dom/ocn_types.F90	   => A  models/ocn/dom/ocn_types.F90	     
    D atm/cam/src/ocnsice/dom/albocean.F90	   => A  models/ocn/dom/albocean.F90	     
    D atm/cam/src/ocnsice/dom/print_coverage.F90   => A  models/ocn/dom/print_coverage.F90    
    D atm/cam/src/ocnsice/dom/parpbl.h		   => A  models/ocn/dom/parpbl.h		     
    D atm/cam/src/ocnsice/dom/ocn_comp.F90	   => A  models/ocn/dom/ocn_comp.F90	     
    D atm/cam/src/ocnsice/dom/albedo.h		   => A  models/ocn/dom/albedo.h		     
    D atm/cam/src/ocnsice/dom/wtrc_flxoce.F90	   => A  models/ocn/dom/wtrc_flxoce.F90	     
    D atm/cam/src/ocnsice/dom/MCT_ocn_comp.F90	   => A  models/ocn/dom/flxoce.F90	     
    D atm/cam/src/ocnsice/dom/flxoce.F90	   => A  models/ocn/dom/ocn_comp_mct.F90	     
    D atm/cam/src/ocnsice/dom/srfoce.F90	   => A  models/ocn/dom/srfoce.F90	     

    D atm/cam/src/ocnsice/som/ocn_types.F90	   => A  models/ocn/som/ocn_types.F90		      
    D atm/cam/src/ocnsice/som/albocean.F90	   => A  models/ocn/som/albocean.F90		    
    D atm/cam/src/ocnsice/som/mixed_layer_globalcalcs.F90  => A  models/ocn/som/mixed_layer_globalcalcs.F90  
    D atm/cam/src/ocnsice/som/ocn_srf.F90	   => A  models/ocn/som/ocn_srf.F90		    
    D atm/cam/src/ocnsice/som/parpbl.h		   => A  models/ocn/som/parpbl.h			    
    D atm/cam/src/ocnsice/som/somint.F90	   => A  models/ocn/som/somint.F90		    
    D atm/cam/src/ocnsice/som/ocn_comp.F90	   => A  models/ocn/som/ocn_comp.F90		    
    D atm/cam/src/ocnsice/som/ocean_data.F90	   => A  models/ocn/som/ocean_data.F90		    
    D atm/cam/src/ocnsice/som/somini.F90	   => A  models/ocn/som/somini.F90		    
    D atm/cam/src/ocnsice/som/MCT_ocn_comp.F90	   => A  models/ocn/som/flxoce.F90		    
    D atm/cam/src/ocnsice/som/flxoce.F90	   => A  models/ocn/som/ocn_comp_mct.F90             

    D ice/csim4/MCT_ice_comp.F90                   => A  models/ice/csim4/ice_comp_mct.F90

                                                      A  models/drv/seq_mct/seq_mct_mod.F90  
    D atm/cam/src/control/MCT_atmocn_cpl.F90       => A  models/drv/seq_mct/map_atmocn_mct.F90
    D atm/cam/src/control/MCT_atmlnd_cpl.F90       => A  models/drv/seq_mct/map_atmlnd_mct.F90
    D atm/cam/src/control/MCT_iceocn_cpl.F90       => A  models/drv/seq_mct/map_iceocn_mct.F90
    D atm/cam/src/control/MCT_atmice_cpl.F90       => A  models/drv/seq_mct/map_atmice_mct.F90
    D atm/cam/src/control/MCT_lndhub_comp.F90      => A  models/drv/seq_mct/mrg_x2l_mct.F90
    D atm/cam/src/control/MCT_atmhub_comp.F90      => A  models/drv/seq_mct/mrg_x2a_mct.F90
    D atm/cam/src/control/MCT_icehub_comp.F90      => A  models/drv/seq_mct/mrg_x2i_mct.F90
    D atm/cam/src/control/MCT_ocnhub_comp.F90      => A  models/drv/seq_mct/mrg_x2o_mct.F90
    D atm/cam/src/control/MCT_seq.F90              => A  models/drv/seq_mct/seq_mct_init.F90 
    D atm/cam/src/control/cam.F90                  => A  models/drv/seq_mct_drv/seq_ccsm_drv.F90
    D atm/cam/src/control/seq_fields_indices.F90   => A  models/drv/seq_flds_indices/seq_flds_indices.F90
    D atm/cam/src/control/seq_fields_mod.F90       => A  models/drv/seq_flds/default/seq_flds_mod.F90

    D atm/cam/src/control/MCT_atm_comp.F90         => A  models/atm/cam/src/control/atm_comp_mct.F90

List all existing files that have been modified, and describe the changes:

    M atm/cam/tools/scam/configure
    M atm/cam/tools/scam/scm_init/init_model.F90
    M atm/cam/tools/scam/scm_init/scam_srfdata_MCT.F90
    M atm/cam/tools/scam/scm_init/scam_run.F90
    M atm/cam/bld/configure
        Modified these files to work with above directory restructuring and file renaming

    M models/SVN_EXTERNAL_DIRECTORIES
        Modified to use clm branch tag cammct05_clm3_expa_58

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  => All failed tests must be justified.

bluesky: None

tempest: None

bangkok/lf95: None

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_2_60 (this is the previous tag)

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_60
Originator(s): Mariana Vertenstein
Date: 4/11/2006
One-line Summary: Introduction of MCT CAM-surface coupling 

Purpose of changes:
   Incoporate MCT cam-surface component coupling for all
   CAM surface components. Introduce the appropriate thin-layer
   design for MCT coupling that can also be extended to ESMF.

Bugs fixed (include bugzilla ID): None

Describe any changes made to build system: None

Describe any changes made to the namelist: None

List any changes to the defaults for the boundary datasets: None

Describe any substantial timing or memory changes:
   ***These have to still be determined***

Code reviewed by:
   Erik Kluzek

List all subroutines eliminated:
  D atm/cam/src/physics/cam1/camhub_comp.F90

List all subroutines added and what they do:

  A atm/cam/src/control/MCT_atmhub_comp.F90
  A atm/cam/src/control/MCT_lndhub_comp.F90
  A atm/cam/src/control/MCT_ocnhub_comp.F90
  A atm/cam/src/control/MCT_icehub_comp.F90
   -introduced these routines to merge necessary
    input for atm, lnd, ocn and ice states
    (e.g. MCT_atm_hub_comp.F90 merges lnd,ocn and ice
     states and fluxes to create the necessary input 
     atm attribute vector)
    These hub component routines act only on MCT attribute vectors

  A atm/cam/src/control/MCT_atmlnd_cpl.F90
  A atm/cam/src/control/MCT_iceocn_cpl.F90
  A atm/cam/src/control/MCT_atmocn_cpl.F90
  A atm/cam/src/control/MCT_atmice_cpl.F90
  A atm/cam/tools/scam/scm_init/scam_srfdata_MCT.F90
   -introduced new MCT couplers 
    (e.g. MCT_atmlnd_cpl.F90 maps between atm and lnd domains)
    These couplers act only on MCT attribute vectors

  A atm/cam/src/ocnsice/dom/ocn_types.F90
    -introduced new dom specific data structures (ocn_in, ocn_out)
     so that MCT could map directory to the dom input/output states
  A atm/cam/src/ocnsice/som/ocn_types.F90
    -introduced new som specific data structures (ocn_in, ocn_out)
     so that MCT could map directory to the dom input/output states
  A ice/csim4/ice_types.F90
    -introduced new csim specific data structures (ice_in, ice_out)
     so that MCT could map directory to the dom input/output states

  A ice/csim4/MCT_ice_comp.F90
    -introduced MCT_ocn_comp.F90 that map MCT attribute vectors
     to ice_in and ice_out to MCT attribute vectors
  A atm/cam/src/ocnsice/dom/MCT_ocn_comp.F90
    -introduced MCT_ocn_comp.F90 that map MCT attribute vectors
     to ocn_in and ocn_out to MCT attribute vectors
  A atm/cam/src/ocnsice/som/MCT_ocn_comp.F90
    -introduced MCT_ocn_comp.F90 that map MCT attribute vectors
     to ocn_in and ocn_out to MCT attribute vectors

  A atm/cam/src/control/seq_fields_indices.F90
    -contains integer indices for all possible character strings that 
     represent cam and cam surface model couling
  A atm/cam/src/control/con_cam.F90
    -replaced part of cam.F90 that dealt with running cam in COUP_CSM mode

List all existing files that have been modified, and describe the changes:

  M ice/csim4/ice_data.F90
    -removed srfflx_state2d from input argument and replaced it with frac 
     (frac a frac_t defined type now specific to ice/csim4)
  M ice/csim4/ice_dh.F
    -renamed surface_state2d -> ice_in (where ice_in is now of type ice_in_t not surface_state)
  A ice/csim4/print_coverage.F90 -> D atm/cam/src/ocnsice/som/print_coverage.F90
  M ice/csim4/ice_srf.F90
    -renamed surface_state2d -> ice_in (where ice_in is now of type ice_in_t not surface_state)
  M ice/csim4/ice_diagnostics.F
    -renamed surface_state2d -> ice_in (where ice_in is now of type ice_in_t not surface_state)
  D ice/csim4/camice.F90-> A ice/csim4/ice_comp.F90
   -renamed camice.F90 -> ice_comp.F90 and introduced ice_in and ice_out
     states to replace srfflx_parm2d_ocn, srfflx_state2d. 
   -added functionality to read landfrac from cam initial file and store it
     as a module variable, rather than use it from camsrf. 

  M atm/cam/tools/scam/configure
  M atm/cam/tools/scam/testscript
  M atm/cam/tools/scam/scm_init/init_model.F90
  M atm/cam/tools/scam/scm_init/scam_srfdata.F90
  M atm/cam/tools/scam/scm_init/scam_run.F90
  M atm/cam/tools/scam/scm_init/inital.F90
  M atm/cam/tools/scam/scm_init/scamMod.F90
  M atm/cam/tools/scam/ui/configure
   -incorporated changes into above scam routines so that
    they could work with new MCT coupling to surface models 

  M atm/cam/tools/cprnc/Makefile

  M atm/cam/src/control/MCT_atm_comp.F90
   -introduced MCT_ocn_comp.F90 that map MCT attribute vectors
    to cam_in and cam_out to MCT attribute vectors
  M atm/cam/src/control/ccsm_msg.F90
   -extended restart functionality to use logic previously in restart_physics
  M atm/cam/src/control/cam.F90
   -this is now a top level MCT coupling driver for stand-alone CAM
  M atm/cam/src/control/seq_fields_mod.F90
   -generalized routine to account for cam-ice and cam-ocn coupling
  M atm/cam/src/control/restart.F90
   -made changes to removed srfflx_parm and srfflx_state from camsrfexch_typees
  M atm/cam/src/control/startup_initialconds.F90
   -removed call to close ncid_topo
   -removed srfflx_state2d argument to read_inidat and initial_conds 
  M atm/cam/src/control/cam_comp.F90
   -removed srfflx_parm from camsrfexch_types use
   -removed cam_in from call to cam_initial and read_restart
   -added call to hub2atm_alloc

  M atm/cam/src/physics/cam1/comsrf.F90
   -removed snowhland, tsocn and renamed landfrac_field->landfrac_glob
  M atm/cam/src/physics/cam1/diagnostics.F90
   -removed outfld calls for TBOT,SNOWHLND,TSOCN
   -removed comsrf uses for tsocn
   -removed snowhland as input argument
  M atm/cam/src/physics/cam1/tphysbc.F90
   -removed snowh ans input argument
  M atm/cam/src/physics/cam1/restart_physics.F90
   -removed calls to output srfflx_state2d fields - moved these to 
    ccsm_msg.F90 and MCT_atmhub_comp.F90.
  M atm/cam/src/physics/cam1/physpkg.F90
  D atm/cam/src/physics/cam1/camsrfexch_types.F90 -> A atm/cam/src/control/camsrfexch_types.F90
   -removed module routines bounding, verify_fractions, srfflx_parm_reset, 
    srfcomp2hub_alloc 
   -renamed atm2srf_alloc->atm2hub->alloc
   -removed srfflx_parm derived type and added snowhland as part of srfflx_state 
    definition
  D atm/cam/src/physics/cam1/srfxfer.F90 -> A atm/cam/src/control/srfxfer.F90
   -cosmetic changes only
  M atm/cam/src/physics/cam1/tphysac.F90
   -removed snowh as input argument
  M atm/cam/src/ocnsice/dom/sst_data.F90
   - removed landfrac from argument list
  M atm/cam/src/ocnsice/dom/albocean.F90
   - removed landfrac from argument list
  D atm/cam/src/ocnsice/dom/camoce.F90 -> A atm/cam/src/ocnsice/dom/ocn_comp.F90
   -renamed camoce.F90 -> ocn_comp.F90 and introduced ocn_in and ocn_out
     states to replace srfflx_parm2d_ocn, srfflx_state2d. 
   -added functionality to read landfrac from cam initial file and store it
     as a module variable, rather than use it from camsrf. 
   -introuced ocn_IC_OUTPUT routine to output TSOCN to initial file.

  M atm/cam/src/ocnsice/som/albocean.F90
   - removed landfrac from argument list
  D atm/cam/src/ocnsice/som/print_coverage.F90
   -removed routine, no longer needed
  M atm/cam/src/ocnsice/som/mixed_layer_globalcalcs.F90
   -added landfrac_glob to argument list, replace landfrac_field->landfrac_glob
  M atm/cam/src/ocnsice/som/ocn_srf.F90
   -removed Tffresh, rhow, cp_ocn from ice_constants use statement and used 
    SHR_CONST_ROWSW, SHR_CONST_CPSW and SHR_CONST_TKFREZ from shr_const_mod instead
  D atm/cam/src/ocnsice/som/somoce.F90 ->  A atm/cam/src/ocnsice/som/ocn_comp.F90
   -renamed somoce.F90 -> ocn_comp.F90 and introduced ocn_in and ocn_out
     states to replace srfflx_parm2d_ocn, srfflx_state2d. 
   -added functionality to read landfrac from cam initial file and store it
     as a module variable, rather than use it from camsrf. 
   -introuced ocn_IC_OUTPUT routine to output TSOCN to initial file.
   -added landfrac_glob as argument to gmean and check_conservation calls
   -repalce Focn->ocn_out%frzmlt
   -removed use of camice (Focn, frzmlt, aice, sicthk, snowhice now obtained
    via ocn_in and ocn_out) 
   -removed ice_constants use for rhow, cp_ocn and used 
    SHR_CONST_ROWSW, SHR_CONST_CPSW from shr_const_mod instead

  M atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
  M atm/cam/src/chemistry/trop_mozart/chemistry.F90
   -removed snowhland from camsrf use and added to argument list (part of cam_in)
  
  M atm/cam/src/dynamics/sld/stepon.F90
  M atm/cam/src/dynamics/eul/stepon.F90
    -removed srfflx_state and srfflx_parm use statements

  M atm/cam/src/dynamics/sld/inidat.F90
  M atm/cam/src/dynamics/eul/inidat.F90
  M atm/cam/src/dynamics/fv/inidat.F90
    -changed varialbe names (surface_state->cam_out)
    -introduced landfrac_glob and removed use of landfrac from comsrf
    -removed srfflx_state use from camsrfexch_types 

  M atm/cam/src/dynamics/sld/inital.F90
  M atm/cam/src/dynamics/eul/inital.F90
  M atm/cam/src/dynamics/fv/inital.F90
    -changed varialbe names (surface_state->cam_out)    
    -removed srfflx_state2d as input argument
    -removed call to hub2atm_alloc and  renamed atm2srf_alloc->atm2hub_alloc

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
  005 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
  008 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
  015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 7
  019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
  022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
  030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 7
  034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
  037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
  040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
  044 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
  047 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
  054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 7
  All these tests only contain differences in the following fields 
     LHFLXOI, SHFLXOI, FSNSOI
  with RMS values on the order of 1.e-15   
  In addition, TBL.f2h.outfrq24h contained a difference in QFLX on the order of 1.-e23
  So even though the TBL tests fail, this tag does not change answers.

tempest:
  014 bl152 TBL.sh e64o outfrq24h -2 ................................FAIL! rc= 7
    diffs set in at NSTEP=47
  021 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
    only QRS is different in cprnc.out with an RMS on the order of 3.e-24
  024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
    only SNOWHICE is different in cprnc.out with an RMS on the order of 1.e-23 
  031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
    only VD01 is different in cprnc.out with an RMS on the order of 4.e-25

bangkok/lf95:
  012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
    diffs set in at NSTEP=29
  016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
    differences are only in SHOWHICE with RMS value of 5.e-21
  028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
    diffs set in at nstep=9
  040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7
    diffs set in at nstep=3

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:       cam3_2_59
Originator(s):  mvr, eaton, edwards
Date:           4/6/06
One-line Summary: collection of bug fixes

Purpose of changes:
bug fixes for ccsm testing, cray directive on phoenix, compiler workaround 
on bluevista, coupled runs on tempest; added cron scripts to repository
	
Bugs fixed (include bugzilla ID):
bug#68 is resolved
	
Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by:  myself, eaton, edwards

List all subroutines eliminated: 
D      models/atm/cam/test/system/td_nightly_aix.sh
D      models/atm/cam/test/system/td_nightly_linux.sh
- post-tag cron jobs were renamed

List all subroutines added and what they do:
A  +   models/atm/cam/test/system/posttag_cron_bangkok.sh
A  +   models/atm/cam/test/system/posttag_cron_bluesky.sh
A      models/atm/cam/test/system/posttag_cron_lightning.sh
A      models/atm/cam/test/system/posttag_cron_bluevista.sh
- post-tag cron job scripts for machine-specific testing of cam
	
List all existing files that have been modified, and describe the changes:
M      models/atm/cam/test/system/TSB.ccsm.sh
M      models/atm/cam/test/system/TCB.ccsm.sh
- mods to make cam's ccsm test scripts compatible with changes in ccsm scripts
	
M      models/atm/cam/test/system/test_driver.sh
M      models/atm/cam/test/system/CAM_runcmnd.sh
- test scripts now use unix utility 'hostname' to determine local machine
	
M      models/atm/cam/src/physics/cam1/dmsbnd.F90
- removed debug print statement left behind - trips up coupled runs on tempest
	
M      models/atm/cam/src/physics/cam1/physpkg.F90
- added workaround for code introduced in cam3_2_58 which trips xlf bug on bluevista
	
M      models/atm/cam/src/dynamics/fv/fv_prints.F90
- fix of bug in cpp definition CPP_PRT_PREFIX on phoenix


	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: all PASS

tempest: all PASS

bangkok/lf95: all PASS

CAM tag used for the baseline comparison tests if different than previous
tag: 

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_58
Originator(s): Jim Edwards
Date: 4/4/2006
One-line Summary: changes for ncol dataset support

Purpose of changes: Allows data input on non-rectangular grids using an alternative input file format

Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets: none, no new boundary datasets 
	 are provided at this time

Describe any substantial timing or memory changes:

Code reviewed by: myself, Eaton

List all subroutines eliminated: renamed file zonalbndydata.F90 to boundarydata.F90

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
	renamed file zonalbndydata.F90 to boundarydata.F90
	dmsbnd.F90 prescribed_aerosols.F90 : added support for ncol based input dataset
	chemistry.F90 ozone_data.F90: changed module names from zonalndydata to boundarydata
	

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: one fails
  055 cs999 TCS.ccsm.sh ER.01a T31_gx3v5 K ..........................FAIL! rc= 2

  That's due to a change in the CCSM scripts in ccsm3_1_beta24.  The test
  passes when run in ccsm3_1_beta23.  Mat is modifying the CAM test to work
  with the new CCSM scripts.

tempest: all pass

bangkok/lf95: all pass

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_57
Originator(s): pworley
Date: Sun Apr  2 12:22:18 MDT 2006
One-line Summary: Performance optimizations, primarily for Cray-X1E

Purpose of changes:

  To restore X1E performance lost in recent check-ins; to fix X1E and XT3
  bugs. 

Bugs fixed (include bugzilla ID):

  PGI compile problem; aqua planet error on X1E.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

  Performance on X1E doubled compared to 3_2_56 when running T85 on 128
  processors.

Code reviewed by: myself, eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  a) Vectorized routines chunk_to_buff and buff_to_chunk used by MCT in
     land/atmosphere communication and in coupler/atmosphere communication:
  
  M atm/cam/src/physics/cam1/phys_grid
   - buff_to_chunk, chunk_to_buff: interface clean up and vector-friendly 
  reimplementation
  
  M atm/cam/src/control/ccsm_msg.F90
  M atm/cam/src/control/MCT_atm_comp
   - changed parameters in calls to buff_to_chunk and chunk_to_buff
  
  b) Fixed bug on X1E caused by diagnostic message output inside streamed 
     code segment
  
  M atm/cam/src/dynamics/fv/fill_module.F90
   - surrounded (non fatal) error test with ifdef DEBUG cpp logic
  
  c) Introduced workaround for PGI compiler bug
  
  M lnd/clm2/src/biogeophys/Hydrology2Mod.F90
   - removed unnecessary "use" of spmdMod
  
  d) Optimized performance of MCT Rearranger routine
  
  M utils/mct/mct/m_Rearranger
   - added new optional parameter ALLTOALL and modified code in rearrange_
     to implement an MPI_Alltoallv option for interprocessor communication.
   - reordered the send/receive pattern for the non-ALLTOALL implementation
     to decrease link and processor contention.
   - Reduced number of allocate/deallocate requests.
  
  M utils/mct/mpi-serial/collective.c
  M utils/mct/mpi-serial/mpi.h
   - add mpi_alltoallv interfaces (from Ray Loy)

  M lnd/clm2/src/main/MCT_atmlnd_cpl
   - added optional parameters VECTOR and ALLTOALL to calls to MCT_Rearrange,
     setting VECTOR to .true. if CPP_VECTOR is defined, and setting
     ALLTOALL to .true. if SYSUNICOS is defined. Otherwise they are
     set to .false. .
  
     Note that ALLTOALL=.true. may be a better choice for all systems,
     but I have only verified this on the X1E.
  
  e) Improved vector performance in CLM/MCT interface.
  
  M lnd/clm2/src/main/MCT_lnd_comp
   - made minor change to index logic to improve vectorization on the X1E
  
  f) Improved performance (both vector and nonvector) in routines that 
     map to/from CLM grid
  
  M areaMod
   - added support for mapping multiple fields in one call to 
     gridmap_mapparray
   - reimplemented gridmap_mapparray to improve vector performance, 
     incuding changing calling interface
  
  M clm_atmlnd
   - modified logic in clm_mapa2l and clm_mall2a to call gridmap_array once
     for all fields
   - made other minor modifications to improve vectorization

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS except:
  055 cs999 TCS.ccsm.sh ER.01a T31_gx3v5 K ..........................FAIL! rc= 2

  That's due to a change in the CCSM scripts in ccsm3_1_beta24.  The test
  passes when run in ccsm3_1_beta23.  Mat is modifying the CAM test to work
  with the new CCSM scripts.

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_56
Originator(s): mvr
Date: 3/27/06
One-line Summary:  
test_driver.sh made to run interactive; test scripts modified for use 
on lightning, bluevista; new tests added; some bugs fixes

Purpose of changes: 
wanted to test on lightning, bluevista

Bugs fixed (include bugzilla ID): 
ccsm tests work again

Describe any changes made to build system: 
LAPACK library replaced with ESSL library as default for WACCM_MOZART 
configurations on AIX 

Describe any changes made to the namelist:

List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: myself, eaton

List all subroutines eliminated:
D      atm/cam/test/system/input_tests_aix
D      atm/cam/test/system/input_tests_linux
D      atm/cam/test/system/input_tests_irix
D      atm/cam/test/system/input_tests_aix_nightly
D      atm/cam/test/system/input_tests_linux_nightly
- these files were renamed 


List all subroutines added and what they do:
A  +   atm/cam/test/system/tests_pretag_bluesky
A  +   atm/cam/test/system/tests_pretag_bangkok
A  +   atm/cam/test/system/tests_pretag_tempest
A  +   atm/cam/test/system/tests_posttag_bluesky
A  +   atm/cam/test/system/tests_posttag_bangkok
- newly renamed files

A      atm/cam/test/system/tests_posttag_bluevista
A      atm/cam/test/system/tests_posttag_lightning
- new files containing tests for respective platforms

A      atm/cam/test/system/config_files/f1.9h
- new config options file for testing fv 1.9x2.5 resolution
A      atm/cam/test/system/TPF.sh
- new test script for performance testing 


List all existing files that have been modified, and describe the changes:
M      atm/cam/test/system/test_driver.sh
- made to run interactive (ie will create/spawn command file to machine's 
  batch queue); added support for lightning, bluevista; added env var to 
  specify ccsm tag to be used for testing
M      atm/cam/test/system/CAM_runcmnd.sh
- added logic for setting run command on lightning, bluevista
M      atm/cam/test/system/TCB.sh
- uses new env var for setting options to configure
M      atm/cam/test/system/TSB.ccsm.sh
- bug with ccsm test now fixed - files/dirs now compatible with ccsm scripts
M      atm/cam/test/system/TCB.ccsm.sh
- now specifies resources for ccsm test; general cleanup
M      atm/cam/test/system/TBL.sh
- minor cleanup
M      atm/cam/test/system/td_nightly_aix.sh
- posttag cron script modified with new call to test_driver.sh;
  now spawns testing on lightning, bluevista
M      atm/cam/test/system/td_nightly_linux.sh
- posttag cron script modified with new call to test_driver.sh
M      atm/cam/test/system/input_tests_master
- added performance test, ccsm test w/bgc, ccsm test w/trop_mozart chemistry
M      atm/cam/test/system/tag_email.sh
- posttag cron script now used 'mail' to notify developers of new tag
M      atm/cam/bld/configure
- now uses ESSL rather than LAPACK library for waccm_mozart on aix
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
055 cs999 TCS.ccsm.sh ER.01a T31_gx3v5 K ..........................FAIL! rc= 2
- compatibility bug w/ccsm scripts fixed, this test should pass going forward 

tempest:
- none

bangkok/lf95:
004 bl111 TBL.sh e8c8mdm ttrac 9 ..................................FAIL! rc= 5
008 bl112 TBL.sh e8sdm ghgrmp 9 ...................................FAIL! rc= 5
010 bl113 TBL.sh e8pdm aqpgro 3 ...................................FAIL! rc= 5
012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 5
016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 5
024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 5
026 bl313 TBL.sh f10pdm aqpgro 3 ..................................FAIL! rc= 5
028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 5
032 bl511 TBL.sh s8c8mdm ttrac 9 ..................................FAIL! rc= 5
036 bl512 TBL.sh s8sdm ghgrmp 9 ...................................FAIL! rc= 5
038 bl513 TBL.sh s8pdm aqpgro 3 ...................................FAIL! rc= 5
040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 5
- baseline tests failed due to change in env vars used in testing; these tests  
  should pass going forward

CAM tag used for the baseline comparison tests if different than previous
tag: ccsm testing used cam3_2_51 

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_55
Originator(s): Francis Vitt
Date: Fri Mar 24 16:51:04 MST 2006
One-line Summary: Fixed bug in mo_drydep.F90

Purpose of changes: To compile and run on lighting

Bugs fixed (include bugzilla ID): 60

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: 

Code reviewed by: Jeff Lee ( Yen-Huei Lee)

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
U    models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
	changed parameter n_drydep_species from 52 to 53
	

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:

037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
	Dry deposition species have changed.  Bit for bit comparison to
	previous version is expected to fail.
055 cs999 TCS.ccsm.sh ER.01a T31_gx3v5 K ..........................FAIL! rc= 2
	CCSM scripts have changed causing this test to fail
	
tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_54
Originator(s): Jim Edwards
Date:  03/21/06 12:36PM
One-line Summary: addresses bug reported in http://bugs.cgd.ucar.edu/show_bug.cgi?id=56

Purpose of changes: 

Bugs fixed (include bugzilla ID): 56 ccsm cannot read co2 data file

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: 

Describe any substantial timing or memory changes:

Code reviewed by:

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:
  co2_data_flux.F90 changed variable for date and sec to explicitly allocated 
	arrays.   
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

This file is used only with ccsm, no stand-alone tests are available.  We have confirmed the 
change using ccsm3_1_beta23.
	
===============================================================
===============================================================

Tag name:      cam3_2_53
Originator(s): Francis Vitt
Date:          Thu Mar 16 09:00:35 MST 2006

One-line Summary:
	Changes to trop_mozart chemistry for CCSM coupled mode.

Purpose of changes:
	To run CAM with trop_mozart in CCSM and pass acceptance tests
	
Bugs fixed (include bugzilla ID):

Describe any changes made to build system:

Describe any changes made to the namelist:
	New initial coniditions files are used from trop_mozart chemistry.
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

List all subroutines added and what they do:

List all existing files that have been modified, and describe the changes:

  models/atm/cam/bld/DefaultCAMEXPNamelist.xml
	changed IC data files for trop_mozart
	
  models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
	Changed loop indexing where constituent fields are output
	to history file to be compatable with BGC package
	
  models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
	Added H2 to the dry deposition species list
	
  models/atm/cam/src/chemistry/trop_mozart/mo_srf_emissions.F90
	Initialize surface fluxes to zero before setting to data
	
  models/atm/cam/src/chemistry/trop_mozart/mo_strato_sad.F90
	Increaesed the length of filename to 265 characters

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:

037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
	These bit-for-bit comparisons to the previous version of trop_mozart
	chemistry are expected fail since H2 was added to dry deposition
	and different initial conditions are used
	
055 cs999 TCS.ccsm.sh ER.01a T31_gx3v5 K ..........................FAIL! rc= 2
	CCSM scripts have changed causing this test to fail

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name:cam3_2_52 
Originator(s): Jim Edwards
Date: Thu Mar  9 17:11:49 MST 2006
One-line Summary: netcdf f90 interface, interpaerosols update

Purpose of changes: non lat/lon grid integration

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Brian Eaton

List all subroutines eliminated: copies of bilin and kinds were eleminated from
	the interpaerosols directory;  subroutine lininterp was overloaded to 
         avoid several names for the same basic functionality
	
List all subroutines added and what they do: lininterp2d1d - interpolate from a 2d lat/lon field to a 1d ncols field - this subroutine is private in interpolate_data.F90 and accesible through the lininterp interface.

List all existing files that have been modified, and describe the changes:
A host of files were changed in the physics/cam1 directory to move from netcdf f77 interface to the f90 interface.   
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:

tempest:

bangkok/lf95:

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

===============================================================

Tag name: cam3_2_51
Originator(s): eaton
Date: Fri Feb 17 18:27:20 MST 2006
One-line Summary: configure and Makefile mods

Purpose of changes:

  . Modify Makefile to enable threading with lf95 and pathf90.
    *** N.B. *** lf95 (v6.2) still has severe per thread stacksize limits.
    I was only able to get threading to work with the --threadheap option
    which puts the thread memory on the heap.  That option however doesn't
    work with debug flags -g, --chk, or --chkglobal.  Set up the Makefile
    to allow threading only in non-debug mode.

  . Modify configure so that the checks for include files and libraries are
    not done when the -ccsm flag is set since the CAM Makefile is not used
    in that case.

  . Modify configure to require that the configure script and all
    associated configuration files live in a specified subdirectory of the
    source tree for the source being built.  This is for robustness.  Using
    configure with source or configuration files from outside a source tree
    that represents a fixed source version is fraught with peril.

  . Add -linker option to the configure script to enable specifying a
    linker which is different from the Fortran compiler.  This is
    particulary useful on Linux platforms where specifying mpif90 as the
    linker automatically provides the correct linkage for the MPI
    libraries.  Note that this depends on the user's PATH being set so that
    the correct mpif90 is used, i.e., the one that's consistent with the
    Fortran compiler being used.

  . Modify configure to run its tests in a subdirectory of the CAM build
    directory.  This avoids having the Makefile build the dependency list
    for the full CAM just to run the tests, and consequently they run much
    faster.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: described above

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: 

  bld/Makefile  -- renamed Makefile.in

List all subroutines added and what they do:

  bld/Makefile.in  -- was Makefile

List all existing files that have been modified, and describe the changes:

  bld/configure
  . Remove -cam_cfg option and CAM_CFGDIR environment variable: require all
    configuration files to be in the same directory as the configure script.
  . remove -cam_root option and CAM_ROOT environment variable: require
    configure to be located in the CAM src tree.
  . Modifications for CCSM build: delete setting of locations for all
    external include/mod/lib directories.  These are only needed for the CAM
    Makefile which is not produced when doing a CCSM build.  
  . Remove -esmf_* options.  This was used with the ESMF prototype library
    which is no longer supported.  Will re-implement ESMF options when we
    start linking the new ESMF library.
  . add -linker option
  . use it to set the USER_LINKER macro in the Makefile
  . Run tests in a subdirectory of the CAM build directory.

  bld/Makefile.in
  . add "--openmp --threadheap 4096" to FFLAGS and LDFLAGS when SMP is
    defined for lf95 compiler
  . add -mp to FFLAGS and LDFLAGS when SMP is defined for pathf90 compiler
  . Remove default settings of macros that are set by configure.
  . Remove ESMF macros except for ESMF_MOD and ESMF_LIB.  Currently these are
    not set by configure, but they will be when we start linking to the ESMF
    library. 
  . add LINKER macro to be used to link cam executable.
  . set LINKER to $(USER_LINKER) if it's defined, otherwise use platform
    default which is $(FC) on most platforms, but is "$(CC) -f90lib" on the
    SX6 and ES.

  bld/mkDepends
  . add fix from Tom Henderson to include Fortran syntax includes in the
    dependencies (previously only recognized cpp syntax).

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:      All PASS.

tempest:      All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

  NONE

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_50
Originator(s): eaton
Date: Sat Feb  4 08:28:03 MST 2006
One-line Summary: Fix FV memory leak & non-adv tracers.  SCAM bugfixes.  Fix Cray build problem.

Purpose of changes:

  1. Fix for FV memory leak found by Siddhartha Ghosh

  2. Mods FV dycore from Jean-Francois Lamarque to advect only the advected
     constituents

  3. Mod from Rob Jacob to fix the MCT problem on the Cray (replace
     "system" call with "ishell")

  4. Bug fixes for scam from John Truesdale
     . Corrects a C++ usage error when using the newest gcc compiler
     . Allows the model to use scam generated initial conditions.
     . Allows the model to use user generated data for input.

Bugs fixed (include bugzilla ID):

  Described in Purpose of changes section.  The memory leak in FV is
  bugzilla ID 26.

Describe any changes made to build system:

  Define the SYSUNICOS cpp macro when running on Cray.

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  1. FV memory leak
  dynamics/fv/FVCAM_GridCompMod.F90
  . move allocation of q_internal to top of run method, and deallocation to
    bottom of method -- like all the rest of the allocation/deallocation
    pairs.

  2. Mods FV dycore
  dynamics/fv/FVCAM_GridCompMod.F90
  . call create_vars with ntotq as actual arg rather than nq
  dynamics/fv/inital.F90
  . use pcnst as actual arg corresponding to dummy arg nq in Initialize arg
    list 
  dynamics/fv/restart_dynamics.F90
  . use pcnst as actual arg corresponding to dummy arg nq in Initialize arg
    list 

  3. Mod to fix the MCT problem on the Cray
  bld/Makefile
  . add -DSYSUNICOS to FPPFLAGS for UNICOS/mp build

  4. Bug fixes for scam
   scm_init/runtype.h
   scm_init/readsaveinit.F90
   ui/LoadData.ui
   ui/plot.h
   ui/dataset.cpp
   ui/LoadDataImpl.cpp
   ui/ncfile.h

  Changes to external code:

  The following fix was made in $SVNREPOS/mct/trunk/mpeu
  m_FileResolv.F90
  . use ishell rather than system command when SYSUNICOS is #define'd

  A new tag for MCT was created: $SVNREPOS/mct/mct/trunk_tags/MCT2_2_0_060203
  and CAM's external property for MCT was changed to that tag.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_2_49

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_49
Originator(s): Tony Craig
Date: Thu Feb  2 11:10:17 MST 2006
One-line Summary:

  Update CLM source code to clm3_expa_56

Purpose of changes:

  Bring in a latest version of clm3 which includes changes in
  infrastructure to support finemesh integrations.  This version
  of clm is 100% backward compatable with namelist and datasets
  and is bfb with recent version of clm3.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: new optional namelist
  added to clm, fatmgrid.

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: tcraig, mvr

List all subroutines eliminated: No changes in CAM

List all subroutines added and what they do:  No changes in CAM

List all existing files that have been modified, and describe the changes: 
  No changes in CAM

models/lnd/clm2/src/main:    
  initGridIndexMod.F90,lnd2atmMod.F90,CNiniTimeVar.F90,
  abortutils.F90,clm_comp.F90,driver.F90,clm_camMod.F90,atmdrvMod.F90,
  subgridRestMod.F90,accFldsMod.F90,clmtypeInitMod.F90,initializeMod.F90,
  pftdynMod.F90,iniTimeConst.F90,histFileMod.F90,program_csm.F90,
  clm_atmlnd.F90,clm_varsur.F90,clm_csmMod.F90,restFileMod.F90,
  surfFileMod.F90,controlMod.F90,initSurfAlbMod.F90,initSubgridMod.F90,
  clm_varctl.F90,ndepFileMod.F90,initGridCellsMod.F90,MCT_lnd_comp.F90,
  program_off.F90,domainMod.F90,decompMod.F90,areaMod.F90,clmtype.F90,
  histFldsMod.F90
	
models/lnd/clm2/src/riverroute:    
  RtmMod.F90

models/lnd/clm2/src/biogeochem:    
  CASAMod.F90,DUSTMod.F90,CNPhenologyMod.F90,STATICEcosysDynMod.F90,
  DGVMMod.F90,CNrestMod.F90,VOCEmissionMod.F90,CNNDynamicsMod.F90,
  CNVegStructUpdateMod.F90

models/lnd/clm2/src/biogeophys:    
  BalanceCheckMod.F90,SurfaceRadiationMod.F90,SoilTemperatureMod.F90,
  Biogeophysics1Mod.F90,Biogeophysics2Mod.F90,FrictionVelocityMod.F90,
  Hydrology1Mod.F90,Hydrology2Mod.F90,BiogeophysicsLakeMod.F90,
  HydrologyLakeMod.F90,BareGroundFluxesMod.F90,CanopyFluxesMod.F90
  SurfaceAlbedoMod.F90	

Code changes:  *** Only in clm code ***
  Merge atm2lnd_state_type, atm2lnd_flux_type.  Same for lnd2atm state/flux.
    Related changes in clm3 and elsewhere in code.
  Add domainMod.F90 and domain_type.  Migrate grid data into domain type.
    Instantiate adomain(atm/coarse), ldomain(lnd/finemesh), rdomain(rtm),
    ddomain(atmdrv external data) in model.
  Add lats, latn, lonw, lone 2d arrays and associated code changes.
  Cleanup areaMod.F90; merging subroutines, removing redundant code, eliminate
    *_point routines.
  Remove numlon
  Add decomp_type for gcelldc and gcellsn.  Remove redundant data in other
    arrays related to addressing physical space and logical space.
  Clean up interface in set_landunit subroutines.  Remove redundant code.
  Clean up procs and clumps datatypes, removing redundant data.
  Migrate clm3 topology data to pointers from copies
  Add gridmap_type for interpolation and associated code and routines to
    support the type.
  Add clm_atmlnd.F90 file for upscale/downscale code.  Add clm_mapa2l
    and clm_mapl2a to carry out mapping associated with upscale/downscale.
  Add gridmap_setmapsFM for generation of weights for downscale/upscale
    routines.
  forc_ndep should not be in atm2lnd_type.
  Reuse new code as much as possible throughout.
  Rename latixy and longxy to latc and lonc.
  Remove fullgrid attribute.
  Add pftm to domain datatype and history file
  Modify coupling to handle coarse <-> finemesh for standlaone, cam, and
    ccsm.
  Add normalized area to history files
  Add lat_a, lon_a, latdeg_a, londeg_a to clm3 datatype for atm lats/lons.  
    required in SurfaceAlbedo computation where the the zenith angle has
    to be based on the atm (coarse) grid, not the fine clm grid.
	
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_2_48

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

    Answers are bit-for-bit.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================

===============================================================

Tag name: cam3_2_48
Originator(s): Francis Vitt
Date: 
One-line Summary:

  Update to the tropospheric chemistry code and fixes to the offline driver.

Purpose of changes:

  The updates to the tropospheric chemistry code where done to include 
  into CAM the latest MOZART chemistry and to provide the option to 
  to use interactive dry deposition and interactive photolysis rates
  rather than the prescribed table look up methods.

  Changes to the offline dynamics driver were done to fix a total energy 
  conservation issue that was evident with simulations longer than two 
  months.  A fix to a bug which occurred in high resolution runs is also
  included.

Bugs fixed (include bugzilla ID):

Describe any changes made to build system: none

Describe any changes made to the namelist: 

added:

  character(len=256) :: depvel_file
  character(len=256) :: depvel_lnd_file
  character(len=256) :: clim_soilw_file
  character(len=256) :: season_wes_file
  character(len=256) :: trop_pause_file
  character(len=256) :: lght_landmask_file
  real(r8)           :: lght_no_prd_factor
  logical            :: xactive_prates      
  logical            :: xactive_drydep      
  character(len=256) :: photopath      
  character(len=8)   :: emis_type
  integer            :: emis_date
  integer            :: emis_yr_offset
  character(len=256) :: met_filenames_list

removed:
  chem_config
	
List any changes to the defaults for the boundary datasets:

Describe any substantial timing or memory changes:

Code reviewed by: Brian Eaton

List all subroutines eliminated:

    models/atm/cam/src/chemistry/trop_mozart/mo_waccm_photo.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_read_chm_sim.F90
    models/atm/cam/src/chemistry/trop_mozart/phtadj.F90
    models/atm/cam/src/chemistry/trop_mozart/rxtmod.F90

List all subroutines added and what they do:

    models/atm/cam/src/chemistry/trop_mozart/mo_wavelen.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_cnum.F90
    models/atm/cam/src/chemistry/trop_mozart/mak_grp_vmr.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_phtadj.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_airmas.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_photoin.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_setaer.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_trislv.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_setair.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_waveall.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_seto2.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_tropopause.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_schu.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_rtlink.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_addpnt.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_constants.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_sim_dat.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_lymana.F90
    models/atm/cam/src/chemistry/trop_mozart/time_utils.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_setz.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_calcoe.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_zadj.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_pchem.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_ps2str.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_sphers.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_setozo.F90
    models/atm/cam/src/chemistry/trop_mozart/m_types.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_photo.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_tuv_inti.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_strato_sad.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_waveo3.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_rxt_mod.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_setcld.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_xsections.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_drydep_tables.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_inter.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_wavelab.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_params.F90

List all existing files that have been modified, and describe the changes:

    models/atm/cam/bld/config_trop_chem_mozart_defaults.xml
	the number of advected constituents has changed to 99 for the tropospheric chemistry
    models/atm/cam/bld/camexp.pm
    models/atm/cam/bld/DefaultCAMEXPNamelist.xml
	made changes to be consistent with the changes to the namelist variables
    models/atm/cam/src/control/readinitial.F90
	moved from stepon the adjustment to the top interface pressure when zero
    models/atm/cam/src/control/runtime_opts.F90
	see namelist changes above
    models/atm/cam/src/control/wrap_nf.F90
	added subroutines wrap_inq_varndims and wrap_get_vara_text
    models/atm/cam/src/control/history.F90
	made module variable fieldname_len public and increase its value to 16
    models/atm/cam/src/utils/string_utils.F90
	made GLC function public
    models/atm/cam/src/physics/cam1/comsrf.F90
	added fsds field
    models/atm/cam/src/physics/cam1/diagnostics.F90
	increased the length of string variable dcconnam
    models/atm/cam/src/physics/cam1/tphysbc.F90
	changed the intent on fsds argument variable to inout
    models/atm/cam/src/physics/cam1/check_energy.F90
	don't adjust the total global energy in offline mode
    models/atm/cam/src/physics/cam1/restart_physics.F90
    models/atm/cam/src/physics/cam1/constituents.F90
	increased the length of string variable names
    models/atm/cam/src/physics/cam1/physpkg.F90
	removed module variable fsds
    models/atm/cam/src/physics/cam1/chemistry.F90
	made the chemistry interface consistent with trop_mozart
    models/atm/cam/src/physics/cam1/tphysac.F90
	the arguments to subroutine chem_timestep_tend has changed
    models/atm/cam/src/physics/cam1/vertical_diffusion.F90
	increased the length of vdiffnam string variable
    models/atm/cam/src/physics/waccm/chemistry.F90
	made the chemistry interface consistent with trop_mozart
    models/atm/cam/src/chemistry/trop_mozart/mo_lu_solve.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_mean_mass.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_jlong.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_nln_matrix.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_lu_factor.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_ub_vals.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_indprd.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_aerosols.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_adjrxt.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_imp_sol.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_lin_matrix.F90
    models/atm/cam/src/chemistry/trop_mozart/m_rxt_id.F90
    models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_wetdep.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_setrxt.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_seasalt.F90
    models/atm/cam/src/chemistry/trop_mozart/chem_mods.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_prod_loss.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_usrrxt.F90
    models/atm/cam/src/chemistry/trop_mozart/m_het_id.F90
    models/atm/cam/src/chemistry/trop_mozart/m_spc_id.F90
    models/atm/cam/src/chemistry/trop_mozart/mo_srf_emissions.F90
	update the tropospheric chemistry code to be consistent with MOZART 4
    models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
	made the chemistry interface consistent with trop_mozart
    models/atm/cam/src/dynamics/fv/pfixer.F90
	changed variable names and cleaned up code
    models/atm/cam/src/dynamics/fv/spmd_dyn.F90
	fixed a bug in compute_gsfactors which occurs when 2D decomposition is used
    models/atm/cam/src/dynamics/fv/stepon.F90
	removed the adjustment to the top interface pressure if zero
    models/atm/cam/src/dynamics/fv/metdata.F90
	Made changes to get the observed surface pressure at sub-timestep
	interval times.  This is needed for the high resolution bug fix.
    models/atm/cam/src/dynamics/fv/FVCAM_GridCompMod.F90
        Made changes needed to fix the bug in the offline driver used in 
	high resolution simulations.
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:

037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7

Changes to the trop_mozart chemistry have caused the base line comparison
to fail as expected.

tempest: All PASS

bangkok/lf95: All PASS

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_47
Originator(s): eaton, mvr
Date: Thu Jan 19 12:01:57 MST 2006
One-line Summary: 

  Workaround for xlf90 (v9.1.0.3) bug (on bluevista) & test script updates.

Purpose of changes:

  The workaround for the compiler bug allows running on bluevista.  Note
  that there is still an unresolved bug on the platform affecting the
  trop_mozart chemistry mode.

  The TBR.sh test script has been modified to work around a GPFS
  problem (sometimes files that have just been copied don't appear in the
  output from an "ls" command executed in the directory that the files were
  just copied to) which causes the branch test to fail intermittently on bluesky.

  Misc changes in the overnight test scripts.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: eaton, mvr

List all subroutines eliminated:

  models/atm/cam/test/system/update_collections.sh

List all subroutines added and what they do:

  models/atm/cam/test/system/tag_email.sh

List all existing files that have been modified, and describe the changes:

  models/atm/cam/src/physics/cam1/physpkg.F90
  . in phys_init pass phys_state(begchunk:endchunk) to chem_init and
    ozone_data_init

  models/atm/cam/test/system/TBR.sh
  models/atm/cam/test/system/td_nightly_aix.sh
  models/atm/cam/test/system/td_nightly_linux.sh

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_2_46

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

  Answers are bit-for-bit.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_46
Originator(s): eaton
Date: Mon Jan  9 16:58:42 MST 2006
One-line Summary: refactor restart logic and fix restart bug

Purpose of changes:

  Provide control of when restart files are written that is decoupled from
  the behavior of CAM's history file writes.  

  Also did some cleanup work:
    . get rid of anncyc, nlhst, itsst
    . move nlres and lbrnch into restart module  -- get it out of comctl.h
    . call set_restart_filepath from restart_setopts -- remove from runtime_opts
    . move the restart filepaths into the restart module -- get them out of filepaths.F90

Bugs fixed (include bugzilla ID):

  At cam3_2_24 the restart writes for fields needed by CAM's ocean and sea
  ice modules were moved into the run methods for those modules.  This broke
  the writing of restart files in all situations except at the end of the
  model run when the restart triggers off the nlend flag.

  The problem is that the calls to write the restart files for the ocean and
  ice models are made before atm_run4 which makes the calls to write CAM's
  history file.  Since the old logic to determine when it's time to write a
  restart file depended on the state in CAM's history module, and that state
  was being updated after the calls to write the ocean and ice restart files,
  the ocn and ice restarts were out of sync with CAM's restarts except when
  nlend=.true.  The fix was to implement a separate logic for writing restart
  files that doesn't depend on the state of CAM's history module.

Describe any changes made to build system: none

Describe any changes made to the namelist:

  The namelist variables nrefrq and itsst have been eliminated.

  New namelist variables added:
     logical :: no_restart      ! true => turn off all restart writes (default: false)
     integer :: restart_nsteps  ! restart interval in steps
     integer :: restart_nhours  ! restart interval in hours
     integer :: restart_ndays   ! restart interval in days
     logical :: restart_monthly ! true => write restart at begining of each month (default: true)
     logical :: restart_yearly  ! true => write restart at begining of each year

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: mvertens reviewed CLM code changes

List all subroutines eliminated:

  control/rstwr.F90
  . remove this file -- subroutine added to restart module

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

  control/cam.F90
  . change rstwr from external to local variable.  add init before timestep
    loop. 
  . add rstwr as actual arg to ocn_run, ice_run, atm_run4
  . add rstwr actual arg to clm_camRun (lnd_run)
  
  control/cam_comp.F90
  . add rstwr dummy arg to cam_run4 and remove the external declaration
  . change write_restart call logic to only use rstwr
  . set rstwr using restart_is_write_step method

  control/ccsm_msg.F90
  . add rstwr intent(out) arg to ccsm_run and remove the external declaration
  . move the logic to set rstwr from the old rstwr function into ccsm_run
  . change write_restart_ccsm call logic to only use rstwr
  
  control/comctl.h
  . remove nrefrq
  . remove anncyc -- no longer used
  . remove nlhst -- it is equivalent to lbrnch
  . remove itsst -- obsolete and broken
  . move nlres and lbrnch to restart.F90
  
  control/filenames.F90
  . remove comctl.h
  . remove nrefrq dependence on initializing rest_pfile
  . move nrevsn and rest_pfile to restart module
  
  control/history.F90
  . add rstwr dummy arg to wrapup and remove the external declaration
  
  control/restart.F90
  . extend functionality of this module to include the control of setting the
    restart write time.
  . add restart_is_write_step method.  This started as the rstwr
    function in rstwr.F90.
  . add restart_init to initialize the restart write time
  . add restart_{default,set}opts methods for namelist
  . restart_setopts provides checking of the namelist settings and echos a
    summary to the log file.
  . add next_write_{ymd,tod} to restart file
  . replace use of nlhst with lbrnch
  . add nlres and lbrnch control variables (moved here from comctl.h)
  . add nsrest as intent(in) arg of the restart_setopts method - it's needed
    to set the values of nlres and lbrnch
  . remove comctl.h -- no longer needed
  
  control/runtime_opts.F90
  . remove nrefrq
  . add restart write interval namelist variables
  . add restart_{default,set}opts calls
  . add mpibcast calls
  . replace use of nlhst with lbrnch
  . add nlres and lbrnch control variables (moved here from comctl.h)
  . add nsrest as intent(in) arg of the restart_setopts method - it's needed
    to set the values of nlres and lbrnch
  . remove comctl.h -- no longer needed
  
  control/startup_initialconds.F90
  . add restart_init call to setup_initial method
  
  control/time_manager.F90
  . cleanup some comments
  . remove target attribute from tm_cal
  . remove public attribute from tm_clock
  . add new methods:
      timemgr_time_ge   ! check if time2 is later than or equal to time1
      timemgr_time_inc  ! increment time instant by a given time interval
  
  dynamics/eul/initcom.F90
  . use nsrest instead of nlres in conditional

  ice/csim4/camice.F90
  . remove comctl.h from camice_write_restart -- not used
  . add rstwr dummy arg to camice_run and remove the external declaration
  . change camice_write_restart call logic to only use rstwr
  . remove unused ref to nrevsn
  
  ocnsice/dom/camoce.F90
  . add rstwr dummy arg to camoce_run and remove the external declaration
  . change camoce_write_restart call logic to only use rstwr
  . remove anncyc -- no longer used
  . remove itsst -- obsolete and broken
  . remove unused ref to nrevsn
  
  ocnsice/som/somoce.F90
  . add rstwr dummy arg to somoce_run and remove the external declaration
  . change somoce_write_restart call logic to only use rstwr
  . remove unused ref to nrevsn
  
  test/system/nl_files/pghgsul
  test/system/nl_files/ttrac
  . add restart_nsteps setting to match history write frequency (these are
    the only namelists used in the TBR tests)
  
  tools/scam/scm_init/scam_run.F90
  . add rstwr actual arg to ocn_run and ice_run calls.  Hardwire value to
    .false. (scam doesn't ask cam to write a restart file)

  Mods were made to the following CLM routines.  These mods are accessed
  via the external code svn:/clm2/branch_tags/clm3_expa_53_brnchT_cam01

  clm/src/main/clm_camMod.F90
  . add rstwr intent(in) arg to clm_camRun and use it as actual arg in call to
    clm_run2
  . remove setting of cam_nhtfrq, cam_mfilt to nhtfrq, mfilt.

  clm/src/main/clm_comp.F90
  . add rstwr intent(in) arg to clm_run2 and use it as actual arg in call to
    driver2. 

  clm/src/main/clm_varctl.F90
  . remove cam_nhtfrq and cam_mfilt -- no longer used

  clm/src/main/controlMod.F90
  . remove overwritting of hist_nhtfrq, hist_mfilt with cam_nhtfrq, cam_mfilt

  clm/src/main/driver.F90
  . add rstwr optional intent(in) arg to driver2 and use it in conditional for call to
    restFile_write.
  . check for presence of rstwr arg and use it to set local logical variable,
    or use the do_restwrite method if it's not present.  This allows driver2
    to continue to be used by the program_csm and program_off drivers.

  *** NOTE *** The following files have been moved from cam/src/control/ 
  to cam/src/utils/.  (The reason is that by moving utility functions into
  a separate directory it's easier to build unit testers using CAM's build
  procedure which requires that all source files in each specified
  directory be built.)
  abortutils.F90
  cfort.h
  spmd_utils.F90
  string_utils.F90
  time_manager.F90

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky: All PASS.

tempest: All PASS.

bangkok/lf95: All PASS.

CAM tag used for the baseline comparison tests if different than previous
tag: cam3_2_45

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

  Answers are bit-for-bit.

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_45
Originator(s): eaton
Date: Sun Dec 18 14:55:02 MST 2005
One-line Summary: Bug fixes for memory leak and misc.

Purpose of changes:  bug fixes

Bugs fixed (include bugzilla ID):

1. Fix memory leak introduced in cam3_0_20.  Briefly the problem is that the
   overloaded .not. operator defined in diffusion_solver.F90 returns an object
   of type vdiff_selector for which memory is allocated, but this operator is
   used as an actual argument in the call to compute_vdiff in
   vertical_diffusion.F90, and so the memory is never assigned to a variable
   which can be deallocated.

2. The T field in initial files for FV when 2D decomp is used are bad.
   This was caused by a problem with an array index in
   fv/diag_dynvar_ic.F90

3. The history restart files were being removed at the end of the run.  The
   normal CAM behavior is to not remove any files written at the end of the
   run. 

4. The filepath for tgcm data was being truncated at 80 characters.

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes:
 Memory leak fixed.  The severity of this problem depends on what the
 compiler did with an object returned by a function that was being used as
 an actual argument.  The problem was most severe with the lf95 compiler.

Code reviewed by: myself

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

Bug 1.

physics/cam1/vertical_diffusion.F90
. replace fieldlist by fieldlist_moist
. add fieldlist_dry to module data and replace .not.fieldlist w/ fieldlist_dry
. add fieldlist_dry as actual arg to init_vdiff
. use fieldlist_dry in 2nd call to compute_vdiff
physics/cam1/diffusion_solver.F90
. add fieldlist_dry as dummy arg to init_vdiff and initialize it

Bug 2.

dynamics/fv/diag_dynvar_ic.F90
. The outfld call for T&IC needs the array referenced as t3(1,kfirst,j),
  not t3(1,1,j).

Bug 3.

control/history.F90
. Change the argument in the putfil call that determines whether the file
  is removed after it is archived from .true. to .not.nlend.
. Add nlend as a dummy arg to write_restart_history
control/restart.F90
. add nlend to the actual args of write_restart_history

Bug 4.

physics/waccm/tgcm_forcing.F90
. Change "character*80 locfn" to "character*256 locfn" at line 158

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
All PASS except:
004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 10
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 10
043 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9

tempest:
All PASS except:
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9

bangkok/lf95:
All PASS except:
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9

These tests are all expected to fail due to a bug in the current logic for
writing restart files.

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): 

If bitwise differences were observed, how did you show they were no worse
than roundoff?  Answers are BFB.

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_44
Originator(s): Mariana Vertenstein, Rob Jacob
Date: 2005-12-16
One-line Summary: Incorprated MCT for cam-clm coupling 

Purpose of changes: Replaced current cam-clm lp-coupling scheme with
  new MCT coupling and interfaces.

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: MCT is now built as part of the
  CAM executable (since it is all F90 code) - configure was changed so
  that the MCT filepath could be incorporated into the CAM build

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none (from a preliminary
  analysis of timing numbers). A more detailed timing analysis is planned.

Code reviewed by: Mariana Vertenstein, Rob Jacob

List all subroutines eliminated: none

List all subroutines added and what they do:
	
    control/seq_fields_mod.F90
       provides list of fields to be coupled using same mechanism as in 
       concurrent ccsm mode
	
    control/MCT_seq.F90
    control/MCT_atm_comp.F90
       provide new MCT coupling interfaces
	
List all existing files that have been modified, and describe the changes:
	
     physics/cam1/camhub_comp.F90
        cleaned up interfaces	
	
     physics/cam1/prescribed_aerosols.F90
        bug fix (provided by Andrew Conley) - does not change answers 
        in current tests
	
     atm/cam/tools/scam/configure
     atm/cam/tools/scam/scm_init/init_model.F90
     atm/cam/tools/scam/scm_init/scam_run.F90
	changes to SCAM in order to run with MCT cam-clm coupling
	and also use new camhub_comp changes
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:

   004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
   018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
   043 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 10
	
tempest:
	
   003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
   020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
   034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9
	
bangkok/lf95:
	
   003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
   015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
   031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9

CAM tag used for the baseline comparison tests if different than previous
tag: previous tag

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate): results were bit-for-bit

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

Tag name: cam3_2_43
Originator(s): Mariana Vertenstein, Mat Rothstein
Date: 2005-12-15
One-line Summary: Updated clm code to clm3_expa_52

Purpose of changes:
Update clm code base to clm3_expa_52

Bugs fixed (include bugzilla ID): none

Describe any changes made to build system: none

Describe any changes made to the namelist: none

List any changes to the defaults for the boundary datasets: none

Describe any substantial timing or memory changes: none

Code reviewed by: Mariana Vertenstein, Keith Oleson

List all subroutines eliminated: none

List all subroutines added and what they do: none

List all existing files that have been modified, and describe the changes:

 src/biogeochem/CASAMod.F90
 src/biogeochem/DGVMEstablishmentMod.F90
 src/biogeophys/CanopyFluxesMod.F90
 src/main/clm_varcon.F90
 src/main/time_manager.F90

 - Put in changes to use esmf_wrf_timemgr code base
 - Changes to clm_varcon.F90 and CanopyFluxesMod.F90 are
   Changes made to the clm hydrology in tag clm3_expa_46 that were
   increased the conductance of heat and moisture between the soil and the
   canopy air space. This leads to the following changes in land climatology: global
   increase in soil evaporation and a decrease in transpiration
   and in the soil surface temperature.

If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
005 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
008 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 7
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 10
019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 7
034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
044 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
047 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 7

tempest:
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
004 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h -2 ................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 7
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
021 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9
035 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h -2 ................................FAIL! rc= 7

bangkok/lf95:
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
004 bl111 TBL.sh e8c8mdm ttrac 9 ..................................FAIL! rc= 7
008 bl112 TBL.sh e8sdm ghgrmp 9 ...................................FAIL! rc= 7
012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 7
028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9
032 bl511 TBL.sh s8c8mdm ttrac 9 ..................................FAIL! rc= 7
036 bl512 TBL.sh s8sdm ghgrmp 9 ...................................FAIL! rc= 7
040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7

CAM tag used for the baseline comparison tests if different than previous
tag:

Summarize any changes to answers: The above changes to clm lead to a new climate

If bitwise differences were observed, how did you show they were no worse
than roundoff? NA

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced:

- source tag (all code used must be in the repository):
 cam3_2_40 (with clm source code corresponding to clm3_expa_48)

- platform/compilers:
 bluesky

- configure commandline:
 configure -ocn dom -dyn fv -spmd -smp -test -res 4x5

- build-namelist command (or complete namelist):
&camexp
absems_data    = '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/abs_ems_factors_fastvx.c030508.nc'
aeroptics      = '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/AerosolOptics_c050419.nc'
bnd_topo       = '/fis/cgd/cseg/csm/inputdata/atm/cam/topo/USGS-gtopo30_4x5_remap_c050520.nc'
bndtvaer       = '/fis/cgd/cseg/csm/inputdata/atm/cam/rad/AerosolMass_V_4x5_clim_c031022.nc'
bndtvo         = '/fis/cgd/cseg/csm/inputdata/atm/cam/ozone/pcmdio3.r8.64x1_L60_clim_c970515.nc'
bndtvs         = '/fis/cgd/cseg/csm/inputdata/atm/cam/sst/sst_HadOIBl_bc_4x5_clim_c030228.nc'
caseid         = 'cam3_2_40_fv4x5dom'
dtime          = 1800
iyear_ad       = 1950
ncdata         = '/fis/cgd/cseg/csm/inputdata/atm/cam/inic/fv/cami_0000-09-01_4x5_L26_c031217.nc'
nelapse        = -1
nsrest         = 0
/
&clmexp
fpftcon        = '/fis/cgd/cseg/csm/inputdata/lnd/clm2/pftdata/pft-physiology-cn16.c040719'
fsurdat        = '/fis/cgd/cseg/csm/inputdata/lnd/clm2/srfdata/cam/clms_3.1_4x5_c050523.nc'
/

- MSS location of output:
 /OLESON/csm/cam3_2_40_fv4x5dom

MSS location of control simulations used to validate new climate
 /OLESON/csm/cam3_2_29_fv4x5dom

URL for AMWG diagnostics output used to validate new climate:
http://www.cgd.ucar.edu/tss/clm/diagnostics/cam_clm2/cam3_2_40_fv4x5dom-cam3229_fv4x5dom/sets.htm

=============================================================== 
===============================================================

Tag name:  cam3_2_42
Originator(s):  mvr
Date:  051213
One-line Summary:  csm_share, esmf_wrf_timemgr, timing now from 
external sources; updated to share3_051205; new ChangeLog format

Purpose of changes:  taking advantage of some subversion features

Bugs fixed (include bugzilla ID):  none

Describe any changes made to build system:  none

Describe any changes made to the namelist:  none

List any changes to the defaults for the boundary datasets:  none

Describe any substantial timing or memory changes:  none

Code reviewed by:  mvr, eaton

List all subroutines eliminated:  all csm_share, esmf_wrf_timemgr, and 
timing files; 
D      models/utils/timing
D      models/utils/timing/private.h
D      models/utils/timing/gptl_papi.c
D      models/utils/timing/rtcrate.F90
D      models/utils/timing/gptlutil.c
D      models/utils/timing/threadutil.c
D      models/utils/timing/gptl.c
D      models/utils/timing/f_wrappers.c
D      models/utils/timing/gptl.h
D      models/utils/timing/README
D      models/utils/timing/gptl.inc
D      models/utils/esmf_wrf_timemgr
D      models/utils/esmf_wrf_timemgr/ESMF_AlarmClockMod.F90
D      models/utils/esmf_wrf_timemgr/ESMF_CalendarMod.F90
D      models/utils/esmf_wrf_timemgr/ESMF_BaseMod.F90
D      models/utils/esmf_wrf_timemgr/ESMF_TimeMgr.inc
D      models/utils/esmf_wrf_timemgr/ESMF_Mod.F90
D      models/utils/esmf_wrf_timemgr/c_esmc_subroutines.F90
D      models/utils/esmf_wrf_timemgr/ESMF_BaseTimeMod.F90
D      models/utils/esmf_wrf_timemgr/ESMF_ClockMod.F90
D      models/utils/esmf_wrf_timemgr/ESMF_AlarmMod.F90
D      models/utils/esmf_wrf_timemgr/ESMF_TimeMod.F90
D      models/utils/esmf_wrf_timemgr/ESMF_Macros.inc
D      models/utils/esmf_wrf_timemgr/ESMF_Stubs.F90
D      models/utils/esmf_wrf_timemgr/ESMF_TimeIntervalMod.F90
D      models/utils/esmf_wrf_timemgr/wrf_error_fatal.F90
D      models/utils/esmf_wrf_timemgr/ESMF_FractionMod.F90
D      models/utils/esmf_wrf_timemgr/Makefile
D      models/csm_share
D      models/csm_share/ChangeLog
D      models/csm_share/unit_testers
D      models/csm_share/unit_testers/test_shr_sys.F90
D      models/csm_share/unit_testers/test_shr_orb.F90
D      models/csm_share/unit_testers/Makefile
D      models/csm_share/ChangeSum
D      models/csm_share/shr
D      models/csm_share/shr/shr_date_mod.F90
D      models/csm_share/shr/shr_map_mod.F90
D      models/csm_share/shr/shr_sys_mod.F90
D      models/csm_share/shr/shr_file_mod.F90
D      models/csm_share/shr/shr_vmath_mod.F90
D      models/csm_share/shr/shr_timer_mod.F90
D      models/csm_share/shr/shr_orb_mod.F90
D      models/csm_share/shr/shr_kind_mod.F90
D      models/csm_share/shr/shr_tInterp_mod.F90
D      models/csm_share/shr/shr_mpi_mod.F90
D      models/csm_share/shr/shr_const_mod.F90
D      models/csm_share/shr/shr_msg_mod.F90
D      models/csm_share/shr/shr_stream_mod.F90
D      models/csm_share/shr/shr_ncread_mod.F90
D      models/csm_share/shr/shr_alarm_mod.F90
D      models/csm_share/shr/shr_cal_mod.F90
D      models/csm_share/shr/shr_vmath_fwrap.c
D      models/csm_share/shr/shr_string_mod.F90
D      models/csm_share/README
D      models/csm_share/cpl
D      models/csm_share/cpl/cpl_kind_mod.F90
D      models/csm_share/cpl/cpl_const_mod.F90
D      models/csm_share/cpl/cpl_infobuf_mod.F90
D      models/csm_share/cpl/cpl_fields_mod.F90.CO2A
D      models/csm_share/cpl/cpl_fields_mod.F90.CO2B
D      models/csm_share/cpl/cpl_comm_mod.F90
D      models/csm_share/cpl/cpl_fields_mod.F90.CO2_DMSA
D      models/csm_share/cpl/cpl_iobin_mod.F90
D      models/csm_share/cpl/cpl_interface_mod.F90
D      models/csm_share/cpl/cpl_fields_mod.F90
D      models/csm_share/cpl/cpl_domain_mod.F90
D      models/csm_share/cpl/cpl_bundle_mod.F90
D      models/csm_share/cpl/cpl_contract_mod.F90
D      models/csm_share/cpl/cpl_map_mod.F90
D      models/csm_share/cpl/cpl_control_mod.F90
D      models/csm_share/cpl/cpl_mct_mod.F90
D      models/csm_share/cpl/cpl_iocdf_mod.F90
D      models/csm_share/README.scm
- all these replaced with subversion external directories 

D      models/atm/cam/doc/BaseModelSum
D      models/atm/cam/doc/BaseModelLog
- some documentation cleanup 

List all subroutines added and what they do:
A      models/utils/SVN_EXTERNAL_DIRECTORIES
A      models/SVN_EXTERNAL_DIRECTORIES
- contain definitions for the external directories 

A  +   models/atm/cam/doc/Copyright
- copy of the copyright information that'll be picked up by ccsm external pull
	
A      models/atm/cam/doc/ChangeLog_template
- template for new ChangeLog format  

List all existing files that have been modified, and describe the changes:
 M     models
 M     models/utils
- directories modified with properties for the external definitions 

M      models/atm/cam/doc/ChangeLog
- added documentation for this tag
	
If there were any failures reported from running test_driver.sh on any test
platform, and checkin with these failures has been OK'd by the gatekeeper,
then copy the lines from the td.*.status files for the failed tests to the
appropriate machine below.  All failed tests must be justified.

bluesky:
004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 10
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
043 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9

tempest:
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9

bangkok/lf95:
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9


CAM tag used for the baseline comparison tests if different than previous
tag:  prev

Summarize any changes to answers, i.e.,
- what code configurations:
- what platforms/compilers:
- nature of change (roundoff; larger than roundoff but same climate; new
  climate):  b4b

If bitwise differences were observed, how did you show they were no worse
than roundoff?

If this tag changes climate describe the run(s) done to evaluate the new
climate in enough detail that it(they) could be reproduced, i.e.,
- source tag (all code used must be in the repository):
- platform/compilers:
- configure commandline:
- build-namelist command (or complete namelist):
- MSS location of output:

MSS location of control simulations used to validate new climate:

URL for AMWG diagnostics output used to validate new climate:

===============================================================
===============================================================

cam3_2_41
Originator: jet ( John Truesdale)
Date: Fri Dec  9 11:56:01 MST 2005
Model: CAM
Version: CAM3.2.41
One-line Summary: Fixed SCAM bugs, added SCAM tests to testscript, made SCAM datasets consistent with CAM
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no

Substantial timing or memory changes: no
Requires change in run script: no

Ran test_driver.shl script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none (Get clearance for failed tests, enter lines from td.*.status files that fail)

bangkok:
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9

tempest:
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9

bluesky:
004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 10
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 10


Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)

Changes to CLM land-model: One - fixed bug with scam specific code.
	
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

This is basically a bug fix for SCAM as well as adding some
small changes to get rid of autopromotion dependency in SCAM.
Changes are bit for bit for CAM/CCSM.  I did update the datasets
used by SCM to by consistent with the latest datasets for CAM
so the CRM test output also needed to be updated to reflect this.

A list of files changed follows:
	
history_defaults.F90 - added cpp def BFB_CAM_SCAM_IOP around cam/scam 
	               bfb specific code
runtime_opts.F90 - scam initializes with the name of the topo and initial 
	           conditions datasets
startup_initialconds.F90 - made changes to include this file in scam 
	                   intial calls
inidat.F90 - changed scam specific code to use topo info off of topo dataset
.scam_defaults - updated to use topo file and newer boundary dataset files
scam/configure - Brian's changes to get rid of autopromotion
scam/testscript - added tests to check consistency of .scam_defaults 
	          datasets with CAM namelist.
                  added tests for scam to run in default mode.
getnetcdfdata.F90 - Brian's changes to get rid of autopromotion
init_model.F90 - add topo dataset to scam
inital.F90 - call cam routine setup_initial from scam specific code.
ipc.h - added topo dataset to scam
runtype.h - added topo dataset to scam
scamMod.F90 - let scam initialize topo and initial conditions dataset names
scam_fifo.c - pass topo dataset to scam initialization
scam_run.F90 - fix bug with scam - don't run lsm if no land present
setlatlon.F90 - fix bug with scam - don't error out in iop run if iop 
	        dataset has different column latitude and longitude than 
	        initial data.
IOPSelectDateDlgImpl.cpp - cleanup
OptionsDlg.ui - add topo dataset to scam dataset tab in gui
OptionsDlgImpl.cpp - add topo dataset to scam dataset tab in gui
crm.cpp - add topo dataset to scam
dataset.cpp - add topo dataset to scam
fifomodel.cpp - add topo dataset to scam
manager.cpp - add topo dataset to scam
rpcmodel.cpp - add topo dataset to scam
crmtest26.out - crm radiation values changed slightly when we changed 
	        the default datasets to match the current cam defaults
clm_camMod.F90 - fix bug with scam - don't run lsm if no land present also 
	         get rid of spurious SCAM returns in this file

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_40
Originator: jedwards ( James Edwards)
Date: Fri Dec  2 17:24:53 MST 2005
Model: CAM
Version: CAM3.2.40
One-line Summary: minor cleanup and extended testing of cam3_2_39 commit
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes 
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: testing was repeated against 3_2_38
bangkok:
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 3 ..................................FAIL! rc= 7
028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9
040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7

tempest:
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 7
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
021 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 7
031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9

bluesky:
004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 7
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
024 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 7
034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
043 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 10
054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 7

Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton
Restart files change: no
Changes answers:  Yes (same-to-roundoff against 3_2_38)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
All reference to macros __FILE__ and __LINE__ have been removed.  
File ozone_data.F90 was cleaned up to remove variables which are no longer used.
A further pergrow test was conducted with chemistry enabled since some of the changes in the previous commit involved chemistry but the pergrow test did not.  This is why the test were rerun against 3_2_38 instead of 3_2_39.

Besides we wanted to close the CVS repository with a nice even number. :-)

===============================================================
===============================================================

cam3_2_39
Originator: jedwards ( James Edwards)
Date: Fri Dec  2 10:48:22 MST 2005
Model: CAM
Version: CAM3.2.39
One-line Summary: Consolidated zonal data input methods used by cam 1 chemistry and ozone files. 
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.shl script: yes 
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: 
bluesky:
015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 7
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 10
019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
024 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 7
034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
043 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 10
054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 7
tempest:
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 7
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
021 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
026 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 7
031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9
bangkok:
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 7
026 bl313 TBL.sh f10pdm aqpgro 3 ..................................FAIL! rc= 7
028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9
040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7
041 sc999 scamtest.sh .............................................FAIL! rc= 4

6+3 tests are expected to fail due to problems in the testing procedure introduced in cam3_2_37.
TBL tests failed due to order of operation changes.  A perturbation growth test was conducted and passed to show these are errors are order round-off.
The scamtest does not work for me in the test script, the scamtest was sucessfully run by hand.  

Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (same-to-roundoff - details noted above.)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
Added file physics/cam1/zonalbndrydata.F90
moved netcdf interface in chemistry.F90 and ozone_data.F90 to this new file.
In the past the chemistry file read a full years data at the initial time and held it in memory while the ozone file read two months data and updated during the run when it needed new data.  The new file supports both methods but requires that you choose one or the other at compile time.  The second method is now the default.  

Several minor changes were made in other files, mostly removing unused references to plat and plon.  The interface was changed for one chemistry routine which required changes in all flavors of the chemistry files and dynamics inidat files. Below is a complete list of changed files:

       models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
       models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
       models/atm/cam/src/control/interpolate_data.F90
       models/atm/cam/src/control/runtime_opts.F90
       models/atm/cam/src/dynamics/eul/inidat.F90
       models/atm/cam/src/dynamics/fv/inidat.F90
       models/atm/cam/src/dynamics/sld/inidat.F90
       models/atm/cam/src/physics/cam1/advnce.F90
       models/atm/cam/src/physics/cam1/aerosol_intr.F90
       models/atm/cam/src/physics/cam1/chemistry.F90
       models/atm/cam/src/physics/cam1/drydep_mod.F90
       models/atm/cam/src/physics/cam1/ozone_data.F90
       models/atm/cam/src/physics/cam1/physpkg.F90
       models/atm/cam/src/physics/cam1/ramp_scon.F90
       models/atm/cam/src/physics/cam1/seasalt_intr.F90
       models/atm/cam/src/physics/cam1/stratiform.F90
       models/atm/cam/src/physics/cam1/tphysidl.F90
       models/atm/cam/src/physics/cam1/tracers.F90
       models/atm/cam/src/physics/cam1/volcanicmass.F90
       models/atm/cam/src/physics/waccm/chemistry.F90


===============================================================
===============================================================

cam3_2_38
Originator: mirin ( Arthur Andrew Mirin)
Date: Tue Nov 29 16:50:01 MST 2005
Model: CAM
Version: CAM3.2.38
One-line Summary: (1) Restore FV options; (2) Cray-X1E communications, threading, streaming
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
No changes to file/directory structure
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: TBR.sh (Get clearance for failed tests, enter lines from td.*.status files that fail)
004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9 (bluesky)
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 10 (bluesky)
043 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9 (bluesky)
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9 (tempest)
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9 (tempest)
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9 (tempest)
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9 (bangkok)
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9 (bangkok)
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9 (bangkok)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer, Worley
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: Cray-X1E OpenMP/CSD compatibility
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:
(1) Restored nonworking FV options (geopktrans, tracertrans, modcomm-transpose,
modcomm_geopk)
(2) Added Shmem capability to Cray-X1E (USE_SHMEM if-def - affects mod_comm.F90)
(3) Allowed coexistence of OpenMP and CSD's on Cray-X1E provided they do not operate
on same loop index
(4) Removed nested OpenMP capability
Files changed:
models/atm/cam/bld: CAM_config.pm, config_trop_chem_mozart_defaults.xml, Makefile,
config_waccm_ghg_defaults.xml, config_cam_eul_defaults.xml, config_waccm_mozart_defaults.xml,
config_cam_fv_defaults.xml, configure, config_cam_sld_defaults.xml
models/atm/cam/src/control: runtime_opts.F90
models/atm/cam/src/dynamics/eul: dyndrv.F90, realloc4.F90, scan2.F90, scanslt.F90
models/atm/cam/src/dynamics/fv: FVCAM_GridCompMod.F90, geopk.F90, sw_core.F90,
cd_core.F90, pmgrid.F90, tp_core.F90, dynamics_vars.F90, spmd_dyn.F90, trac2d.F90
models/atm/cam/src/dynamics/sld: realloc4.F90, scan2.F90
models/atm/cam/src/physics/cam1: phys_grid.F90, radlw.F90
models/lnd/clm2/src/main: areaMod.F90, driver.F90, histFileMod.F90, atmdrvMod.F90,
filterMod.F90, initializeMod.F90
models/lnd/clm2/src/riverroute: RtmMod.F90
lnd/clm2/tools/mksurfdata: mkdynpftMod.F90, mklaiMod.F90, pmkpftMod.F90, mksoitex.F90,
mkglacier.F90, mklanwat.F90, mksoicol.F90, mkurban.F90
models/utils/pilgrim: mod_comm.F90
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_37
Originator: mvr ( Mathew Rothstein)
Date: Fri Nov 18 16:43:50 MST 2005
Model: CAM
Version: CAM3.2.37
One-line Summary: Bug fix for cam in ccsm; removed cam-specific code from csm_share;  mod to branch test and other test suite cleanup
cam-bugs Requests resolved: none
Requires change in build system: yes
returned spmd mode to builds for ccsm (mistakenly removed with cam3_2_35)
Substantial timing or memory changes: yes, using spmd again in coupled mode
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: 

bluesky
004 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
005 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 6
008 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 6
010 bl133 TBL.sh e32pdh aqpgro 3 ..................................FAIL! rc= 6
013 bl134 TBL.sh e32dh adia 9 .....................................FAIL! rc= 6
015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 6
018 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 6
022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 6
024 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 6
027 bl334 TBL.sh f4dh adia 9 ......................................FAIL! rc= 6
030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 6
034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 6
037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 6
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 6
043 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9
044 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 6
047 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 6
049 bl533 TBL.sh s32pdh aqpgro 3 ..................................FAIL! rc= 6
052 bl534 TBL.sh s32dh adia 9 .....................................FAIL! rc= 6
054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 6
055 cs999 TCS.ccsm.sh ER.01a T31_gx3v5 K ..........................FAIL! rc= 2

tempest
003 br131 TBR.sh e32c11dh pghgsul 6+3 .............................FAIL! rc= 9
004 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 6
007 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 6
009 bl133 TBL.sh e32pdh aqpgro 3 ..................................FAIL! rc= 6
012 bl135 TBL.sh e32dh idphys 9 ...................................FAIL! rc= 6
014 bl152 TBL.sh e64o outfrq24h -2 ................................FAIL! rc= 6
017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 6
020 br331 TBR.sh f4c11dh pghgsul 6+3 ..............................FAIL! rc= 9
021 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 6
024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 6
026 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 6
029 bl335 TBL.sh f4dh idphys 9 ....................................FAIL! rc= 6
031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 6
034 br531 TBR.sh s32c11dh pghgsul 6+3 .............................FAIL! rc= 9
035 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 6
038 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 6
040 bl533 TBL.sh s32pdh aqpgro 3 ..................................FAIL! rc= 6
043 bl535 TBL.sh s32dh idphys 9 ...................................FAIL! rc= 6
045 bl552 TBL.sh s64o outfrq24h -2 ................................FAIL! rc= 6

bangkok
003 br111 TBR.sh e8c8mdm ttrac 6+3 ................................FAIL! rc= 9
004 bl111 TBL.sh e8c8mdm ttrac 9 ..................................FAIL! rc= 6
008 bl112 TBL.sh e8sdm ghgrmp 9 ...................................FAIL! rc= 6
010 bl113 TBL.sh e8pdm aqpgro 3 ...................................FAIL! rc= 6
012 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 6
015 br311 TBR.sh f10c8mdm ttrac 6+3 ...............................FAIL! rc= 9
016 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 6
024 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 6
026 bl313 TBL.sh f10pdm aqpgro 3 ..................................FAIL! rc= 6
028 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 6
031 br511 TBR.sh s8c8mdm ttrac 6+3 ................................FAIL! rc= 9
032 bl511 TBL.sh s8c8mdm ttrac 9 ..................................FAIL! rc= 6
036 bl512 TBL.sh s8sdm ghgrmp 9 ...................................FAIL! rc= 6
038 bl513 TBL.sh s8pdm aqpgro 3 ...................................FAIL! rc= 6
040 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 6

Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

M models/atm/cam/bld/configure
- bug fix for running cam in coupled mode with spmd

M models/atm/cam/src/advection/slt/phcs.F90
M models/atm/cam/src/chemistry/waccm_mozart/apex_subs.F90
M models/atm/cam/src/control/gauaw_mod.F90
M models/atm/cam/src/dynamics/fv/cd_core.F90
M models/atm/cam/src/dynamics/fv/fill_module.F90
M models/atm/cam/src/dynamics/fv/geopk.F90
M models/atm/cam/src/dynamics/fv/pft_module.F90
M models/atm/cam/src/dynamics/fv/sw_core.F90
M models/csm_share/shr/shr_kind_mod.F90
- moved cam-specific code out of csm_share 

M models/atm/cam/test/system/TBR.sh
M models/atm/cam/test/system/input_tests_master
- modified branch test to branch from an earlier restart file

M models/atm/cam/test/system/TCB.ccsm.sh
M models/atm/cam/test/system/TSB.ccsm.sh
M models/atm/cam/test/system/test_driver.sh
- cleaned up use of environment vars CAMROOT and CAM_ROOT

M models/atm/cam/test/system/td_nightly_aix.sh
M models/atm/cam/test/system/td_nightly_linux.sh
- just updating repository with mods to nightly scripts

M models/atm/cam/test/system/TCB.ccsm.sh
- ccsm test will now use tags from ccsm3_1_beta* sequence 

M models/atm/cam/test/system/TBL.sh
M models/atm/cam/test/system/nl_files/adia
M models/atm/cam/test/system/nl_files/aqpgro
M models/atm/cam/test/system/nl_files/ghgrmp
M models/atm/cam/test/system/nl_files/idphys
M models/atm/cam/test/system/nl_files/no_ttrac
M models/atm/cam/test/system/nl_files/off2x2.5
M models/atm/cam/test/system/nl_files/outfrq24h
M models/atm/cam/test/system/nl_files/outfrq3s
M models/atm/cam/test/system/nl_files/pghgsul
M models/atm/cam/test/system/nl_files/ttrac
M models/atm/cam/test/system/nl_files/ttrac_lb1
M models/atm/cam/test/system/nl_files/ttrac_lb2
M models/atm/cam/test/system/nl_files/ttrac_lb3
- test suite now outputting history/restart files for each time sample


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_36
Originator: jedwards ( James Edwards)
Date: Fri Nov 11 09:58:15 MST 2005
Model: CAM
Version: CAM3.2.36
One-line Summary: rework of new interpolation method, bug fix in phys_gmean, clean up in waccm_mozart
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton
Restart files change: no
Changes answers: no 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Reworked recently introduced interpolation changes to contain the method within a physics chunk and eliminate dependence on the phys_grid module.

Fixed a bug in phys_gmean in which the number of fields passed in was hardcoded, and the incoming number of fields argument was ignored. 

Removed unused 'use ' statements in waccm_mozart.
===============================================================
===============================================================

cam3_2_35
Originator: erik ( Erik Kluzek)
Date: Tue Nov  8 12:41:27 MST 2005
Model: CAM
Version: CAM3.2.35
One-line Summary: Remove prototype ESMF and use WRF implimentation of ESMF_2_1_0 API for time-manager, allow build to use external ESMF
cam-bugs Requests resolved: none
Requires change in build system: yes
	(Configure changed so that Filepath also points to models/utils/esmf_wrf_timemgr)
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Remove: models/utils/esmf:
  Remove all prototype ESMF files. 

Add: models/utils/esmf_wrf_timemgr:
  Put in WRF implementation of ESMF_2_1_0 time-manager API.

Changes to build:
  Change build so default is to build with WRF ESMF time-manager. Can also use 
  externally compiled ESMF_2_1_0.
  
  Linking with external ESMF: non-default, have to build ESMF externally
   and send appropriate command-line options to configure to use this option.

  Get rid of ESMF_ROOT as unneeded now. Now have three
  tokens for dealing with ESMF: ESMF_BLD, ESMF_LIB, and ESMF_MOD.
  Setting any of those threes means to link with external ESMF.
  If ESMF_BLD is set, the Makefile will figure out the path
  based on uname and debug option to the default version of ESMF.
  If ESMF_LIB and ESMF_MOD are set the full paths will be used
  for these two. The external version of ESMF that you link to is
  assumed to be a current download of ESMF, which has it's own build
  system. The current ESMF does not have a build for several important
  platforms: Cray, Pathscale, ES, NEC etc, therefore only the esmf_wrf_timemgr
  version can be used there. Also there were bugs with linking that will
  need to be worked out on our standard platforms, before this will work
  reliably

  Change configure so SPMD information isn't duplicated in configure output 
  files.

Changes to time_manager:

  Update time_manager.F90 so uses the ESMF_2_1_0 API instead of the prototype
  ESMF API. Create unit-tests in models/atm/cam/tests/unit/control to do
  extensive testing of the time-manager interface. Runs different time-intervals  and different ways of setting the stop-date, with one simulation period from
  year 0 to year 9999. Answers were compared to the previous time-manager and
  found to be bit-for-bit on IBM, SGI and Linux-PGI compilers.

  Calendar can not be set to GREGORIAN right now, only NOLEAP is allowed.
  esmf_wrf_timemgr could be extended to allow both calendars, or we can start
  using ESMF externally to handle both calendars.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_34
Originator: jedwards ( James Edwards)
Date: Thu Nov  3 17:00:55 MST 2005
Model: CAM
Version: CAM3.2.34
One-line Summary: interpolation method changed in waccm chemistry
cam-bugs Requests resolved: none

Requires change in build system: no

Substantial timing or memory changes: Yes reduced memory profile of waccm/chemistry
Requires change in run script: no
Ran test_driver.shl script: yes 
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

plat and plon dependence were removed from waccm/chemistry.F90
following the same method as cam1/chemistry.F90
The method in cam1 was modified to read only on the masterproc, this does
not change the memory profile.  

===============================================================
===============================================================

cam3_2_32
Originator: mvr ( Mathew Rothstein)
Date: Fri Oct 28 16:58:34 MDT 2005
Model: CAM
Version: CAM3.2.32
One-line Summary: Update csm_share to share3_051025; update remaining clm files to clm3_expa_45 that were missed with previous tag
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.sh script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM : yes
Tested to work with SCAM : yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: yes, updated doc files to clm3_expa_45
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

M models/csm_share/ChangeLog
M models/csm_share/ChangeSum
M models/csm_share/cpl/cpl_contract_mod.F90
M models/csm_share/cpl/cpl_domain_mod.F90
M models/csm_share/cpl/cpl_fields_mod.F90
M models/csm_share/cpl/cpl_fields_mod.F90.CO2A
M models/csm_share/cpl/cpl_fields_mod.F90.CO2B
M models/csm_share/cpl/cpl_fields_mod.F90.CO2_DMSA
M models/csm_share/cpl/cpl_interface_mod.F90
M models/csm_share/shr/shr_const_mod.F90
M models/csm_share/shr/shr_map_mod.F90
M models/csm_share/shr/shr_ncread_mod.F90
M models/csm_share/shr/shr_stream_mod.F90
M models/csm_share/shr/shr_timer_mod.F90
M models/csm_share/unit_testers/test_shr_orb.F90
M models/csm_share/unit_testers/test_shr_sys.F90
- these are the files that changed between share3_050909 and share3_051025

M models/lnd/clm2/doc/ChangeLog
M models/lnd/clm2/doc/ChangeSum
- these are the files missed in updating between clm3_expa_29 and clm3_expa_45

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_31
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Oct 26 15:24:06 MDT 2005
Model: CAM
Version: CAM3.2.31
One-line Summary: updated clm to clm3_expa_45 (removed condition that clm and cam grid had to be bfb)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes (describe)
Requires change in run script: no
Ran test_driver.shl script: No (does all of the following tests)
Machines tested: IBM (ran 2 climate simulations on IBM - see below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes
Changes answers: Yes (same-climate)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
	
No cam physics code was modified. Only clm interface code was modified.
Modified models/lnd/clm2/src/main/clm_camMod.F90 (only several lines of clm code 
were commented out) so that cam and clm grid do not have to be bfb. The 
tolerance is that the grid latitudes/longitudes grids match to 1.e-12. 
The fractional land however, must be identical. The clm code base has 
now been updated to clm3_expa_45.

Two 10 year integration for the entire set of physics changes using climatological SSTs
were performed. See:
/MVERTENS/csm/cam3_2_29_fv4x5dom (cam3_2_29 with changes to clm_camMod.F90) 
	 vs
MVERTENs/csm/cam3_2_29_cam3_2_29_fv4x5dom_0 (cam3_2_29 with no changes)

Diagnostic output is at:	
http://www.cgd.ucar.edu/~mvertens/AMWG_diag/cam3229_fv4x5dom-cam3229_fv4x5dom_0/
===============================================================
	
===============================================================

cam3_2_30
Originator: mvr ( Mathew Rothstein)
Date: Thu Oct 20 09:49:40 MDT 2005
Model: CAM
Version: CAM3.2.30
One-line Summary: mods / new scripts added to cam's test suite for automated testing of new tags
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM : yes
Tested to work with SCAM : yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

A models/atm/cam/test/system/input_tests_aix_nightly
- test ids to run as part of nightly testing of new cam tags on bluesky (aix)
A models/atm/cam/test/system/input_tests_linux_nightly
- test ids to run as part of nightly testing of new cam tags on bangkok (linux)
A models/atm/cam/test/system/td_nightly_aix.sh
- cron script for overnight testing of new cam tag on bluesky (aix)
A models/atm/cam/test/system/td_nightly_linux.sh
- cron script for overnight testing of new cam tag on bangkok (linux)
A models/atm/cam/test/system/update_collections.sh
- cron script for overnight loading of latest cam tag on machine sanitas
M models/atm/cam/test/system/TCB.ccsm.sh
- added command to modify directory path to finite volume code in ccsm scripts 
M models/atm/cam/test/system/input_tests_master
- added ccsm tests for running coupled model with finite volume dycore

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_29
Originator: eaton ( Brian Eaton)
Date: Tue Oct 18 10:52:05 MDT 2005
Model: CAM
Version: CAM3.2.29
One-line Summary: add LANDFRAC file, move inti.F90 into phys_init
cam-bugs Requests resolved: bugzilla #19
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Added the ability to specify the file that contains the LANDFRAC field.
The namelist variable bnd_landfrac is used to specify the path of this
file.  If not specified the default is to use the file that the topography
fields are read from.

Moved the physics initialization routines into phys_init.  Removed
subroutine inti.  Also add initialization of grid information to the
physics_state objects that are allocated in phys_init.  This information is
needed to be passed to the physics init routines that do spatial
interpolation of boundary data.

Misc:
. Fix for problem with WACCM_MOZART on SGI: was failing to write abs/ems
  restart file.  Resolves bugzilla #19.
. Bugfix in lf95 section of Makefile (reference to apex_subs.F changed to
  apex_subs.F90). 

===============================================================
===============================================================

cam3_2_28
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Oct 17 09:35:36 MDT 2005
Model: CAM
Version: CAM3.2.28
One-line Summary: updated clm code clm3_expa_44
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes (all clm restarts, other than history restarts, are now NetCDF)
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: yes
        Updated clm code to clm3_expa_44	
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
	Updated clm code to clm3_expa_44. Interfaces between cam and clm
	(in clm_camMod.F90) have been modified to be consistent with
	making clm a gridded component. The clm driver routine has now
	also been split into two phases as part of this process.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_27
Originator: jedwards ( James Edwards)
Date: Fri Oct 14 10:20:58 MDT 2005
Model: CAM
Version: CAM3.2.27
One-line Summary: consolidated linear interpolation schemes
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no  (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Merged lininterp.F90 bilin.F90 vertinterp.F90 and timinterp.F90 into a single module.  added use statements for this module where appropriate

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_26
Originator: pworley ( Patrick H Worley)
Date: Wed Oct 12 21:20:24 MDT 2005
Model: CAM
Version: CAM3.2.26
One-line Summary:  Cray X1(E) optimizations for FV
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes  - much faster on the X1E when using FV
Requires change in run script: no
Ran test_driver.shl script: yes 
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: failed all baseline comparisons tests for FV on bluesky. 
019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
024 bl333 TBL.sh f4pdh aqpgro 3 ...................................FAIL! rc= 7
027 bl334 TBL.sh f4dh adia 9 ......................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 7
034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
All other tests passed, and all tests passed on other two systems. pergro test
for FV on bluesky passed, indicating that change was within roundoff.
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Art Mirin, Will Sawyer
Restart files change: no
Changes answers: No for EUL and SLD, No for FV on SGI and Linux-Lahey, Yes for FV on IBM (same-to-roundoff)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
Synchronizing FV with NASA version introduced code that does run
efficiently on the Cray vector system (and probably not on the Earth Simulator
either). These changes bring performance back to what it was before, as well
as vectorizing buffer copies in the communication layer.

dynamics/fv/cd_core.F90, dynamics/fv/sw_core.F90
  eliminated unnecessary array segment specifications in subroutine calls where it
  was causing array copying 
dynamics/fv/mapz_module.F90
  restructured recently added code to improve vectorization
dynamics/fv/trac2d.F90
  replaced pointer-based implementation of double buffering algorithm with an 
  equivalent index-based implementation, working around a problem on the Cray X1E
utils/pilgrim/mod_comm.F90, utils/pilgrim/parutilitiesmodule.F90
  restructured buffer copy loops for improved vectorization; general clean-up and optimization

Some of the timer logic was also broken in a recent check-in:
control/cam.F90, control/cam_comp.F90
  fixed timer logic
utils/timing/gptl.c
  fixed problems in mpi_wtime support in timing routines


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_25
Originator: jeff ( Yen-Huei Lee)
Date: Fri Oct  7 09:16:46 MDT 2005
Model: CAM
Version: CAM3.2.25
One-line Summary: user specified constant co2 when running in ccsm
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none (Get clearance for failed tests, enter lines from td.*.status files that fail)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Brian Eaton, Mathew Rothstein 
Restart files change: no
Changes answers: no (bit-for-bit) 
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

modified the following files:

models/atm/cam/src/control/runtime_opts.F90 
models/atm/cam/src/physics/cam1/radiation.F90
models/atm/cam/src/physics/cam1/chem_surfvals.F90
models/atm/cam/src/chemistry/waccm_mozart/chem_surfvals.F90
- add one namelist variable to allow user to specify a constant co2 (vmr)
  for radiation calculation when running in CCSM, indepedent of other settings
  of co2.

models/atm/cam/src/control/ccsm_msg.F90
- mod to support 1x1.25 resolution when running in CCSM.

models/atm/cam/test/systems/TSB.ccsm.sh
- mod to run ccsm test effectively.   

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_24
Originator: erik ( Erik Kluzek)
Date: Mon Oct  3 13:21:24 MDT 2005
Model: CAM
Version: CAM3.2.24
One-line Summary: Move time-loop to top driver, make multiple run methods in cam_comp and
	stepon modules to reduce code duplication
cam-bugs Requests resolved: none
Requires change in build system: no (Remove auto-promotion on Darwin)
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton, mvertens, mvr (testscript changes)
Restart files change: yes
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Yes! (clm_camMod only,  move allocation method inside, create final method)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

High level structure changes:

Make multiple run methods in cam_comp and stepon to reduce duplication and move
the time-loop up to the top level driver seq_ccsm -- still called cam.F90.
Remove nlend from comctl and make local data, passing down to relevant subroutines
and functions that need it.  Make Gaussian weights and etamid module data
in cam_comp. Move all initialization calls for ocean or ice into one initialization
call (calls to read_restart_xxx moves to inside relevant initialize subroutine). And
move write_restart_xxx calls for ice and ocn inside of ice and ocean run method. Create
final methods for all component models (ice, ocn, land, atm). Use ncol in derived types
rather than using get_ncols_p method. Move tssub from surface_state derived type to private
data inside of camice. Move allocation of input/output derived types from driver to inside
of relevant component (ice, ocean, or land). Remove the temporary place-holder
restart_camsrf.F90 surface restart file. Remove ice_frac in camice and start using areafrac
and move merge of fractions to camhub_comp. This takes care of CCSM/ESMF Stage 1-2.6, 1.4
and 1.7, and some work on 1.9.1. This creates drivers and component modules that have the
bulk of the Pre-ESMF work complete.

See the "CCSM/ESMF Stage-1 Release Schedule" at...

       http://swiki.ucar.edu/start/66

SCAM Changes:

Get SCAM and testscript to run on Darwin. Make Eulerian data dimensioned plat/2 to (plat+1)/2,
so will compile correctly with SCAM. Add "skip" and "noclean" as command-line arguments to
SCAM testscript to skip the CAM build/run and/or don't clean before the build of CAM or SCAM.
These are both useful for using testscript interactively for debugging running SCAM. Add
ability to testscript to run CAM at different resolutions and operate over any point
given (it gets the latitude and longitude needed for SCAM from the IOP file produced).

CAM Makefile change:

Get rid of auto-promotion on Darwin compile (Mac-OS-X with Absoft IBM XLF/XLC compilers).


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_23
Originator: pworley ( Patrick H Worley)
Date: Thu Sep 29 15:42:12 MDT 2005
Model: CAM
Version: CAM3.2.23
One-line Summary: Explicitly typed variables and constants and deleted autopromotion of reals in Makefile.
cam-bugs Requests resolved: none
Requires change in build system: Yes - removed autopromotion flags from FFLAGS
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.shl script: yes 
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton, Art Mirin, Forrest Hoffman, Michael Ham
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes - Explicitly typed variables and constants
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Nearly every file in CAM standalone was modified, some extensively, but most
changes were "syntactic". Note that this includes most Fortran source in csm_share, ice,
lnd, and utils as well as in atm. Only the tool subdirectories were "spared".

The steps were as follows:

a) in atm/cam/src, the routines

chemistry/waccm_mozart/apex_subs.F
chemistry/waccm_mozart/svdcmp.F
chemistry/waccm_mozart/wei96.F
physics/waccm/msise00.F
utils/fft99.F
utils/sgexx.F

   were all changed from fixed format that used implicit typing
   to free free format with "implicit none"
   and explicitly typing of all variables. (The suffixes
   were all changed from .F to .F90 as well.)

b) Tom Henderson's tool "addrealkind" was used to
   change "real" declarations to "real(r8) and to add
   "_r8" to all floating point constants that weren't already typed.
   "use shr_kind_mod" was added where needed.
   (For csm_share/shr. SHR_KIND_R8 was used instead of r8.
    In csm_share/cpl, R8 was used. In ice/csim4, dbl_kind was used.)

  (For Tom's tool to work correctly, the name of the module was appended
   to "end module" in a number of files, and "end" was replaced
   by "end subroutine xxx" or "end function yyy" in a number of
   files as well.)

   complex declarations were also changed to complex(r8)

c) float(iii) and real(iii) were replaced by real(iii,r8).
   cmplx(xxx,yyy) was replaced by cmplx(xxx,yyy,r8).
   dble(iii) was replaced by real(iii,r16) if r16 was really necessary,
   otherwise it was replaced by real(iii,r8).
   Constants of the form xxx.yyyDeee were replaced by xxx.yyyEeee_r16
   if r16 was necessary, otherwise were replaced by xxx.yyy.Eeee_r8.

d) specific intrinsics were changed to generic intrinsics,
   e.g. alog10 was changed to log10, etc.

e) removed local definitions of r8 and r16 when they were identical to
   those in shr_kind_mod, but left the local definitions as is if they
   were different.

f) compiler flags that defined real variables to be double precision (or real*8)
   and/or promoted floating point constants and intrinsics to double precision
   were removed from the CAM makefile. (Something similar will need to
   be done in CCSM.)

Finally, a new command was added to phys_grid to indicated whether phys_grid
had been called or not. This logical function was used in camhub_comp.F90
in place of the existing error-prone tests for this condition.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_22
Originator: erik ( Erik Kluzek)
Date: Tue Sep 20 14:19:53 MDT 2005
Model: CAM
Version: CAM3.2.22
One-line Summary: Create cam_comp atmosphere component and make stepon a module, add Darwin (Mac-OS-X) as a platform
cam-bugs Requests resolved: none
Requires change in build system: no
	(Did add changes to configure/build system so that can compile on Mac-OS-X with 
	Absoft XLC/XLF compilers.
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton, mvertens
Restart files change: yes
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Interface with cam_comp changes
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Move the cam3_2_21_brnchT_chghilev_8 tag onto cam_dev.

Add changes to esmf, cam, scam, and cprnc to build/run on Darwin (Mac-OS-X) platform
with the ABSOFT IBM XLF/XLC compilers. On Darwin scam will compile, but not link
at this point. More work needs to be done for it to completely build and run.

Create a cam_comp component module to encapsulate the atmosphere part
of CAM. Make stepon into a module with initial, run and final methods.
Have scam interface with cam_comp rather than underlying subroutines.
Have scam interface with runtime_options in a more straightforward manner,
that won't require duplication of default settings for SCAM inside scam
initialization. Rename scam_inital to inital module a module for scam replacing
the Eulerian inital.

The next step is to make cam_comp have multiple run phases, and stepon have
multiple run phases (this is outlined in each stepon). Then bring the time-loop
out of stepon and up to the driver level. The driver is still called cam.F90, but
will soon be refered to as sequential CCSM to distinquish it from cam_comp the
atmosphere only component, of the stand-alone CAM modeling system.

This is documented as Stage-1.2-6 on the CCSM/ESMF webpages....

http://swiki.ucar.edu/start/83

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_21
Originator: mvr ( Mathew Rothstein)
Date: Mon Sep 12 14:34:15 MDT 2005
Model: CAM
Version: CAM3.2.21
One-line Summary: re-work of ccsm test within cam test suite; updated to latest version of share code; mods to help waccm work in ccsm mode
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM: yes
Tested to work with SCAM: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

A models/atm/cam/test/system/gen_test_table.sh
- utility to generate html file with table of tests currently included in cam test suite

A models/csm_share/cpl/cpl_fields_mod.F90.CO2A
A models/csm_share/cpl/cpl_fields_mod.F90.CO2B
A models/csm_share/cpl/cpl_fields_mod.F90.CO2_DMSA
A models/csm_share/shr/shr_map_mod.F90
A models/csm_share/shr/shr_ncread_mod.F90
A models/csm_share/shr/shr_stream_mod.F90
A models/csm_share/shr/shr_string_mod.F90
A models/csm_share/shr/shr_tInterp_mod.F90
- added as part of update of share code from share3_0_2 to share3_050909 

M models/atm/cam/bld/configure
- changed filepath for ccsm builds to correct location of waccm src 
M models/atm/cam/src/physics/waccm/msise00.F
- changed the name of variable MSS to avoid ccsm pre-processor confusion 
M models/atm/cam/test/system/TCB.ccsm.sh
- redirection of ccsm build test output to appropriate log file and some cleanup
M models/atm/cam/test/system/TCS.ccsm.sh
- re-working of ccsm test within cam test suite
M models/atm/cam/test/system/TMC.sh
- added some error checking to mass conservation test script
M models/atm/cam/test/system/TSB.ccsm.sh
- re-working of ccsm test within cam test suite
M models/atm/cam/test/system/test_driver.sh
- remove references to certain job log file if running interactively 

M models/csm_share/ChangeLog
M models/csm_share/ChangeSum
M models/csm_share/cpl/cpl_bundle_mod.F90
M models/csm_share/cpl/cpl_comm_mod.F90
M models/csm_share/cpl/cpl_contract_mod.F90
M models/csm_share/cpl/cpl_control_mod.F90
M models/csm_share/cpl/cpl_domain_mod.F90
M models/csm_share/cpl/cpl_fields_mod.F90
M models/csm_share/cpl/cpl_infobuf_mod.F90
M models/csm_share/cpl/cpl_interface_mod.F90
M models/csm_share/cpl/cpl_iobin_mod.F90
M models/csm_share/cpl/cpl_iocdf_mod.F90
M models/csm_share/cpl/cpl_map_mod.F90
M models/csm_share/cpl/cpl_mct_mod.F90
M models/csm_share/shr/shr_cal_mod.F90
M models/csm_share/shr/shr_msg_mod.F90
- modified as part of update of share code from share3_0_2 to share3_050909 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_20
Originator: jedwards ( James Edwards)
Date: Wed Sep  7 14:22:57 MDT 2005
Model: CAM
Version: CAM3.2.20
One-line Summary: removed the comhyb.h commonblock, made hycoef a module.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: 055 cs999 TCS.ccsm.sh ER.01a T31_gx3v5 K   
cam3_2_19 fails ccsm build, that failure is carried forward. 

Tested to work coupled with CCSM (create_ccsmcam): no - see above
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

changes made: removed the file comhyb.h and created a module hycoef.  subroutine hycoef is renamed hycoef_init and the common block variables from comhyb 
are now module variables.  Replaced #include <comhyb.h> with 
use hycoef, only : <varnames> 
this change affected a number of files across the structure.

===============================================================
===============================================================

cam3_2_19
Originator: pworley (Pat Worley), eaton ( Brian Eaton)
Date: Tue Sep  6 16:01:22 MDT 2005
Model: CAM
Version: CAM3.2.19
One-line Summary: cray performance, XT3 support, timing lib mods
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes - restore Cray performance to levels before commit of cam3_2_1;
 also, timing lib changes improve SGI Altix performance significantly.
Requires change in run script: no
Ran test_driver.sh script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: The CCSM test is failing because the CCSM scripts don't use CAM's Makefile.  Will fix
 the test by updating the appropriate CCSM template file.
Tested to work coupled with CCSM (create_ccsmcam): fails
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Worley, Eaton, Conley
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

> Makefile
>   - set default C compiler to mpcc_r for AIX (was "cc")
>   - added support for Cray XT3 in Linux section.
>     (For XT3, set
>       USER_FC := ftn
>       USER_CC := cc
>      and add -DCATAMOUNT to USER_CPPDEFS ).
> 
> control/cam.F90
>   - added four timer calls (mpi_wtime), to get basic
>     performance data (total, stepon, SYPD based on stepon time)
>     even when -DDISABLE_TIMERS is specified.
>   - moved first t_start calls to after spmdinit is called,
>     to allow mpi_wtime to be used in the timing library
>   - moved trunc call to after first t_start call, so as to
>     include in measured initialization phase
>   - #ifdef CATAMOUNT
>     ! Improve performance of writing to standard out and error on XT3
>     ! (using Catamount kernel) by increasing buffer size.
>     call usetlbuf()
>    #endif
> 
> control/get_memusage.c
>   -  Linux branch of get_memusage breaks the code on the XT3.
>      Disabled the routine when CATAMOUNT defined.
> 
>      #ifdef CATAMOUNT
>      return -1;
>      #else ...
> 
> dynamics/fv/cd_core.F90
>   - added CSD call (Cray Streaming Directive, for use on Cray X1(E) )
>     that was mistakenly not included in earlier check-in.
> 
> physics/cam1/aerosol_radiation_interface.F90
>   - promoted local 1D arrays to 2D; added CSD; moved diagnostic output
>     to separate loop; in order to recover vectorization and streaming
>     lost in cam3_2_1 check-in
> 
> physics/cam1/radsw.F90
>   - deleted hanging CSD region delimiter
> 
> utils/timing/gptl.c
>   - added support for using mpi_wtime instead of gettimeofday when
>     SPMD specified. (This improves performance on SGI Altix significantly,
>     and allows timers to be used on Cray XT3.)
>   - added call to rtcrate on Cray X1(E) systems, removing hardcoded
>     ticks_per_sec value (that is different on X1 and X1E).
>   - increased number of digits in timing data output
> 
> utils/timing/private.h
>   - defined fields needed when using mpi_wtime to measure time
> 
> 2 files added:
> 
> control/uselbuf.c
> 
>   - set system buffering for output to stdout and stderr.
>     Needed on Cray XT3 to workaround performance problem.
> 
> utils/timing/rtcrate.F90
> 
>   - C-callable Fortran function that calls irtc_rate intrinsic
>     and returns the value (when #ifdef UNICOSMP).



===============================================================
===============================================================

cam3_2_18
Originator: jedwards (Jim Edwards) eaton (Brian Eaton)
Date: Mon Sep  5 09:42:57 MDT 2005
Model: CAM
Version: CAM3.2.18
One-line Summary: spmd_utils module mods
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: jedwards, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Consolidate code into spmd_utils.F90 that sets up the generic spmd
environment.  In particular, move pmgrid variables masterproc and iam,
spmd_dyn variables npes, nsmps, proc_smp_map, and the subroutines from the
files spmdinit.F90 and swap_comm.F90 into the spmd_utils module.  The
subroutine spmdinit has been modified to initialize these public variables
whether SPMD is defined or not.  Hence the "ifdef SPMD" conditional has
been removed from the call to spmdinit in the main cam program.

Because these variables are so widely used this change touches about 150
files.  Most the changes are only one or two lines of modified "use"
association statements.

===============================================================
===============================================================

cam3_2_17
Originator: erik ( Erik Kluzek)
Date: Tue Aug 30 16:32:07 MDT 2005
Model: CAM
Version: CAM3.2.17
One-line Summary: Resolve special physics modes beneath driver, move surface restart to seperate call
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: ideal-phys bit-for-bit test
  029 bl335 TBL.sh f4dh idphys 9 ....................................FAIL! rc= 7
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton, mvertens
Restart files change: no
Changes answers: no (bit-for-bit) (Except FV ideal_phys test, because was previously broken)
Changes to CLM land-model: Add noland mode for adibatic,ideal_phys, aqua
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Resolve the non-physics modes of CAM (adiabatic, ideal_phys, and aquaplanet) 
below the driver level, so that components know the appropriate action, but 
the driver isn't aware of it. Continue to use the common block for the data 
that signals this behavior, but move the behavior completely inside of ice, 
ocean or land surface models.

Also move the read of surface initial data and restart information outside 
of cam_intial and read_restart to methods just before surface model 
initialization. This means breaking up the restart so that intht is called 
later, the read_history is called later, and the close of nrg is done at this 
later step as well. Move the nrg unit numbers to wholy contained within the
relevent restart modules.

This actually allows CCSM mode to make use of ideal_phys, or adiabatic,
unlike previously where it wasn't a possiblity.

Documentation fully spelled out at:

Pre-ESMF Stage-1.2.3 checkin from

    http://swiki.ucar.edu/start/82

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_16
Originator: jedwards ( James Edwards)
Date: Mon Aug 29 20:40:09 MDT 2005
Model: CAM
Version: CAM3.2.16
One-line Summary: added 'only' clause to some and removed other module statements
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no  (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Ran test_driver.sh script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none (Get clearance for failed tests, enter lines from td.*.status files that fail)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml

Changes Made:
        minor changes were made to a number of files which use modules from
        the dynamics directories.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_15
Originator: erik ( Erik Kluzek)
Date: Mon Aug 22 11:36:09 MDT 2005
Model: CAM
Version: CAM3.2.15
One-line Summary: Split comsrf into three parts move calls to surface models up to cam.F90 and stepon.F90 level
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.sh script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none (Get clearance for failed tests, enter lines from td.*.status files that fail)
	License problems with scamtest
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Pass in new structures to it
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Put cam3_2_14_brnchT_chghilev_2 on the main trunk (with some SCAM changes made so
that CRM should operate properly). Didn't test for anything beyond testscript.

Changes defined in pre-ESMF Stage-1-2

  http://swiki.ucar.edu/start/73

Make physpkg into a module with and initial and 2 run phase methods.
Move the initialization calls of the surface models to cam.F90.
Move the run calls of the surface models to stepon.F90.

Divide comsrf into 3 parts:

comsrf.F90  ------- miscellaneous 2D arrays that should be moved into relevant packages (physics,
		      ice, or ocean)
camhub_comp.F90 --- Responsible for merging surface models (land, ice, ocean) into a merged
		      surface state
camsrfexch_types -- definition of derived data types for exchange of surface information
		      between surface models

Move landfrac, ocnfrac and icefrac into merged surface derived type.

Move instantiation of surface exchange types to top driver level. Pass down data types
to relevant subroutines.

Make physpkg into a module with and initial and 2 run phase methods.
Move the initialization calls of the surface models to cam.F90.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_14
Originator: boville (Byron Boville), eaton (Brian Eaton)
Date: Fri Aug 12 16:12:13 MDT 2005
Model: CAM
Version: CAM3.2.14
One-line Summary: history module mods
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: boville, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Some cleanup of the history module - mainly moving addfld and add_default
calls to the modules that are responsible for defining a quantity and
making outfld calls for it.  This gets rid of most of bldfld and h_default.
What remains of those subroutines has been merged into bldfld, and bldfld
has been moved into history_defaults.F90 which we expect to eventually go
away.  Also, the SCAM specific routines have been put into
history_scam.F90.  What's left in the history module is intended to be the
generic history module interface.

The functionality of the history module has been extended so that the
defined history files don't have to be sequential, e.g., a user can now
remove fincl2 from a namelist that contains specifications for fincl2 and
fincl3 without having to rename fincl3 to fincl2.  Previously the renaming
would have been necessary because having the 2nd history file empty when
the 3rd file was not empty was not allowed.  However, this new
functionality was not motivated by increased user convenience which is
pretty negligible.  The real reason for this change was to allow more
flexibility in where the calls are made to add fields to the initial file
which is just a special history file which is always the last one in the
list.  By allowing the list to contain empty files, the index of initial
file can now be terminal list index which is known at compile time, rather
than being the index that follows the last user or code defined history
file which isn't known until after processing all the add_default calls
which can occur at any point during the physics initialization.

precc_thresh and precl_thresh have been removed from the namelist.


===============================================================
===============================================================

cam3_2_13
Originator: mvr ( Mathew Rothstein)
Date: Thu Aug 11 12:29:05 MDT 2005
Model: CAM
Version: CAM3.2.13
One-line Summary: Added tests to default CAM test suite; various bug fixes and cleanup 
cam-bugs Requests resolved: none
Requires change in build system: yes
Makefile changed for pathf90; added -ftpp option to handle directive 
embedded in multi-line data statement
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM: yes
Tested to work with SCAM: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

R models/atm/cam/test/system/create_ccsmcam
- most stuff was merged into TCB.ccsm.sh

A models/atm/cam/bld/run-lightning.csh
- new self-contained example run script specifically for lightning platform
A models/atm/cam/test/system/TMC.sh
- new script for the testing of mass conservation parameters 
A models/atm/cam/test/system/TSB.ccsm.sh
- new generic script that will submit a specified ccsm test and include a 
  baseline test if appropriate

M models/atm/cam/bld/Makefile
- added pathf90 compiler option -ftpp, needed to pre-process a directive 
  embedded in a multi-line data statement
M models/atm/cam/src/control/history.F90
- bug fix for the setting of time_bnds for branch runs
- bug fix for the writes of flag_xyfill and flag_isccplev to the restart file 
M models/atm/cam/src/control/time_manager.F90
- added method get_prev_time (analogous to get_curr_time) 
M models/atm/cam/src/physics/cam1/qneg3.F90
- made mods recommened by dave parks for NEC efficiency 
M models/atm/cam/test/system/TBL.sh
- will now skip entirely if not testing vs baseline
- bug fix for mkdir validation
M models/atm/cam/test/system/TBR.sh
- reordering of algorithm for efficiency
- bug fix for mkdir validation
M models/atm/cam/test/system/TCB.ccsm.sh
- complete overhaul; is now just a wrapper script for ccsm's create_test with 
  some sed commands 
M models/atm/cam/test/system/TCB.sh
- bug fix for mkdir validation
M models/atm/cam/test/system/TCS.ccsm.sh
- major overhaul to work with new script TSB.ccsm.sh
M models/atm/cam/test/system/TEQ.sh
- bug fix for mkdir validation
M models/atm/cam/test/system/TER.sh
- reordering of algorithm for efficiency
- bug fix for mkdir validation
M models/atm/cam/test/system/TRX.sh
- reordering of algorithm for efficiency
- bug fix for mkdir validation
M models/atm/cam/test/system/TSM.sh
- bug fix for mkdir validation
M models/atm/cam/test/system/input_tests_aix
- replaced TCB.ccsm.sh with TSB.ccsm.sh in default list
M models/atm/cam/test/system/input_tests_linux
- added the tests for mass conservation to defaul list
M models/atm/cam/test/system/input_tests_master
- added mass conservatin tests, ccsm submit test, most smoke tests now 9 steps
M models/atm/cam/test/system/scamtest.sh
- bug fix for mkdir validation
M models/atm/cam/test/system/test_driver.sh
- now using newcprnc - required to recognize isccp variables
M models/atm/cam/test/system/nl_files/ghgrmp
- added namelist variable to turn on isccp simulator for testing


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_12
Originator: erik ( Erik Kluzek)
Date: Wed Aug 10 12:53:31 MDT 2005
Model: CAM
Version: CAM3.2.12
One-line Summary: Get rid of #ifdefs refering to CAMSURF from cam3.2.3 commit
cam-bugs Requests resolved: none
Requires change in build system: no (but you can get rid of references to CAMSURF in misc.h)
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: Most bit-for-bit tests fail as this is an answer changing commit
On bangkok:
004 bl111 TBL.sh e8c8mdm ttrac 9 ..................................FAIL! rc= 7
007 bl112 TBL.sh e8sdm ghgrmp 9 ...................................FAIL! rc= 7
011 bl153 TBL.sh e64m outfrq24h -2 ................................FAIL! rc= 7
015 bl311 TBL.sh f10c8mdm ttrac 9 .................................FAIL! rc= 7
022 bl312 TBL.sh f10sdm ghgrmp 9 ..................................FAIL! rc= 7
026 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
030 bl511 TBL.sh s8c8mdm ttrac 9 ..................................FAIL! rc= 7
033 bl512 TBL.sh s8sdm ghgrmp 9 ...................................FAIL! rc= 7
037 bl553 TBL.sh s64m outfrq24h -2 ................................FAIL! rc= 7
On bluesky:
005 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
008 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
015 bl151 TBL.sh e64h outfrq24h -2 ................................FAIL! rc= 7
019 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
022 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
030 bl336 TBL.sh wm4h outfrq3s 9..................................FAIL! rc= 7
034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
037 bl354 TBL.sh fm2dh outfrq3s 9 .................................FAIL! rc= 7
040 bl355 TBL.sh fmo2dh off2x2.5 9 ................................FAIL! rc= 7
044 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
047 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
054 bl551 TBL.sh s64h outfrq24h -2 ................................FAIL! rc= 7
On tempest:
004 bl131 TBL.sh e32c11dh pghgsul 9 ...............................FAIL! rc= 7
007 bl132 TBL.sh e32sdh ghgrmp 9 ..................................FAIL! rc= 7
014 bl152 TBL.sh e64o outfrq24h -2................................FAIL! rc= 7
017 bl314 TBL.sh wg10dh outfrq3s 9 ................................FAIL! rc= 7
021 bl331 TBL.sh f4c11dh pghgsul 9 ................................FAIL! rc= 7
024 bl332 TBL.sh f4sdh ghgrmp 9 ...................................FAIL! rc= 7
031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
035 bl531 TBL.sh s32c11dh pghgsul 9 ...............................FAIL! rc= 7
038 bl532 TBL.sh s32sdh ghgrmp 9 ..................................FAIL! rc= 7
045 bl552 TBL.sh s64o outfrq24h -2 ................................FAIL! rc= 7
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, eaton
Restart files change: no
Changes answers: Yes (same-physics)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

	Get rid of all the #ifdef's refering to CAMSURF that went in with
	the cam3.2.3 tag.
	Basically, this tag gets the same answers as cam3.2.11 if you set

	#define CAMSURF CLIMATE_CAMSURF

	in misc.h and in configure script.

	The exception to this is that in this tag newiceproperties is
	still called at initialization
	in camice in camice_init. The reason for this is because there is
	some initializion
	that's important to do in newiceproperties.

	The code changes answers compared to cam3.2.11, and the changes
	were validated with
	simulations with FV and DOM at 4x5 resolution. Answers also change
	for SOM, but this
	wasn't verified.

	  /ERIK/csm/cam324_fv4x5dom_camsurf_1  --- Experiment based
		off cam3.2.4 (10 years)
	vs.
	  /ERIK/csm/cam321_fv4x5dom_1 -- control of cam3.2.1 (10
		years)

	Plots are available from

	http://www.cgd.ucar.edu/~erik/AMWG_diag/cam324_fv4x5dom_camsurf_1-cam321_fv4x5dom_1/

	The difference in the code is primarily to unify the merging of
	surface fields at
	timestep==0 with that done while time-stepping. And to unify how
	the ocean-ice
	diagnostic fluxes are calculated at time-step==0 with when
	time-stepping. Also in
	order to remove a dependency on the order that ocean and ice are
	called, I also use
	1-landfrac rather than ocnfrac as a mask for certain
	calculations. This changes
	answers for SOM at each time-step.

	The tests that fail have to do with bit-for-bit comparisions with
	cam3.2.11. Some
	of the bit-for-bit tests pass, if they run ideal-phys, adiabatic,
	or aqua-planet.
	Also error-growth tests are identical as error-growth is run in
	aqua-planet mode.

See:
http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_11
Originator: sawyer (Will Sawyer), eaton (Brian Eaton)
Date: Fri Aug  5 11:47:16 MDT 2005
Model: CAM
Version: CAM3.2.11
One-line Summary: Cleanup and performance mods for FV
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes (performance improvements for FV on Cray and NEC SX)
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail:
on bluesky:
030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 7
034 bl351 TBL.sh f2h outfrq24h -2 .................................FAIL! rc= 7
on bangkok:
026 bl353 TBL.sh f2m outfrq24h -2 .................................FAIL! rc= 7
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: sawyer, eaton
Restart files change: no
Changes answers: no, except roundoff introduce into FV
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Replace the original dynamics_vars.F90 by the new version.

Add performance mods for both Cray X1 and NEC SX (from Art Mirin and Pat Worley).

Clean up implementation of options for using platform optimized FFT
libraries (from Art Mirin and Pat Worley).

Remove SAVEd variables in cd_core.  This will come close to making the code
reentrant.

Explain failed tests:

These tests all failed due to a roundoff level changed introduced in the FV dycore.  Since no 
tests that had debug enabled failed, we assume this is an optimization issue.  The roundoff level
changes were verified by perturbation growth tests on both bluesky and bangkok, but only for
the configuration of tests bl351 and bl353.  Test bl336 is a waccm_mozart configuration and
the pergro test does not currently work there.

===============================================================
===============================================================

cam3_2_10
Originator: sawyer (Will Sawyer), eaton ( Brian Eaton)
Date: Tue Aug  2 18:02:15 MDT 2005
Model: CAM
Version: CAM3.2.10
One-line Summary: Bug fix for FV in OMP-only mode
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: sawyer, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

dynamics/fv/p_d_adjust.F90
. add "pole" to private variables in first OMP directive

===============================================================
===============================================================

cam3_2_9
Originator: dcn (David Noone), eaton ( Brian Eaton)
Date: Tue Jul 26 17:57:28 MDT 2005
Model: CAM
Version: CAM3.2.9
One-line Summary: mods for water isotopes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none (Get clearance for failed tests, enter lines from td.*.status files that fail)
on tempest:
031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: dcn, eaton
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

This is an incremental commit of mods to incorporate water isotopes into
CAM.  Added mods to manage the water isotope constituents.  Added mods to
allow the cloud sedimentation and ocean evaporation processes to act on
these constituents.

The regression test that fails is due to a bug in the FV dycore introduced
in cam3_2_8.  It has only been observed in pure OMP mode on the SGI.


===============================================================
===============================================================

cam3_2_8
Originator: sawyer, eaton ( Brian Eaton)
Date: Thu Jul 21 13:37:42 MDT 2005
Model: CAM
Version: CAM3.2.8
One-line Summary: update FV dycore, part 1
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no (only tested IBM)
Requires change in run script: no
Ran test_driver.sh script: yes
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: 
On tempest:
031 bl352 TBL.sh f2o outfrq24h -2 .................................FAIL! rc= 7
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: spectral dycores are bit-for-bit, fv has roundoff change
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Update the FV dycore to contain new code from the GEOS5 version.  The new
code includes derived types to encapsulate grid and state information.
Currently we've only used the grid type.  The dynamics state remains module
data in the prognostics module.  The new grid type replaces most of the
previous uses of the pmgrid and spmd_dyn modules although there is still
cleanup work to be done.  There was also a change in the polar filtering
code which introduces a roundoff level change in the FV simulations.  The
change was implemented as a bug fix to the problem that answers were
depending on the X decomposition when the 2D decomp option was used.


===============================================================
===============================================================

cam3_2_7
Originator: mvr ( Mathew Rothstein)
Date: Tue Jul 19 11:31:59 MDT 2005
Model: CAM
Version: CAM3.2.7
One-line Summary: Fix for CCSM testing within CAM test suite; other test suite enhancements, cleanup
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none 
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

R models/atm/cam/bld/CAM.pm
R models/atm/cam/bld/CAM_lab.pm
R models/atm/cam/bld/CAM_run.pm
R models/atm/cam/bld/Design.tex
R models/atm/cam/bld/Requirements.tex
R models/atm/cam/bld/bldtex.csh
R models/atm/cam/bld/condense-path.pl
R models/atm/cam/bld/fvtest.sh
R models/atm/cam/bld/graphgrowth.csh
R models/atm/cam/bld/lab_default.pm
R models/atm/cam/bld/run-model.pl
- cleaned up obsolete files from bld directory

R models/atm/cam/test/system/TER.ccsm.sh
- script made more generic and renamed - see the new file TCS.ccsm.sh

A models/atm/cam/test/system/TCS.ccsm.sh
- generic script to check the status of a coupled cam run 

M models/atm/cam/test/system/TBL.sh
- status file renamed for consistency, algorithm re-ordered for efficiency
M models/atm/cam/test/system/TBR.sh
- status file renamed for consistency, algorithm re-ordered for efficiency
M models/atm/cam/test/system/TCB.ccsm.sh
- will now configure build and submit ccsm run for specified test/config
M models/atm/cam/test/system/TCB.sh
- status file renamed for consistency
M models/atm/cam/test/system/TEQ.sh
- status file renamed for consistency
M models/atm/cam/test/system/TER.sh
- status file renamed for consistency, algorithm re-ordered for efficiency
M models/atm/cam/test/system/TRX.sh
- status file renamed for consistency, algorithm re-ordered for efficiency
M models/atm/cam/test/system/TSM.sh
- status file renamed for consistency
M models/atm/cam/test/system/create_ccsmcam
- modified to use CAM sandbox for coupled test rather than CAM of CCSM tag 
M models/atm/cam/test/system/input_tests_aix
- new testid for ccsm check status test
M models/atm/cam/test/system/input_tests_master
- new argument lists for ccsm tests (test, resolution, component set) 
M models/atm/cam/test/system/scamtest.sh
- status file renamed for consistency
M models/atm/cam/test/system/test_driver.sh
- now allows batch jobs to run from their own directory if env var CAMROOT set
M models/atm/cam/test/system/CAM_runcmnd.sh
- corrected documentation in the comments
M models/atm/cam/tools/scam/testscript
- removed unnecessary output file

M models/atm/cam/test/system/nl_files/adia
M models/atm/cam/test/system/nl_files/aqpgro
M models/atm/cam/test/system/nl_files/ghgrmp
M models/atm/cam/test/system/nl_files/idphys
M models/atm/cam/test/system/nl_files/no_ttrac
M models/atm/cam/test/system/nl_files/off2x2.5
M models/atm/cam/test/system/nl_files/outfrq24h
M models/atm/cam/test/system/nl_files/outfrq3s
M models/atm/cam/test/system/nl_files/ttrac
M models/atm/cam/test/system/nl_files/ttrac_lb1
M models/atm/cam/test/system/nl_files/ttrac_lb2
M models/atm/cam/test/system/nl_files/ttrac_lb3
- namelists now specify secondary history tape names, freqs, and use 64-bit

M models/atm/cam/bld/run-ibm.csh
M models/atm/cam/bld/run-pc.csh
M models/atm/cam/bld/run-sgi.csh
- updated the self-contained example run scripts 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_6
Originator: fvitt ( Francis Vitt)
Date: Wed Jul 13 09:34:52 MDT 2005
Model: CAM
Version: CAM3.2.6
One-line Summary: Fixed bug in earth-sun distance factor used in waccm
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no 
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
bluesky, tempest, bangkok
Test id's that fail: 
on bluesky -- bug fix in waccm resulted in failure of base line comparison
030 bl336 TBL.sh wm4h outfrq3s 9 ..................................FAIL! rc= 6
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Stacy Walters
Restart files change: no
Changes answers: no (bit-for-bit) or Yes 
bit-for-bit except for waccm 
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

models/atm/cam/src/chemistry/waccm_mozart/mo_gas_phase_chemdr.F90
models/atm/cam/src/chemistry/waccm_mozart/mo_waccm_hrates.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_5
Originator: mvr ( Mathew Rothstein)
Date: Mon Jul 11 15:56:16 MDT 2005
Model: CAM
Version: CAM3.2.5
One-line Summary: Removal of params.h and misc.h (clm code excluded) 
cam-bugs Requests resolved: none
Requires change in build system: yes
#defines of misc.h and params.h now passed to Makefile via cppdefs
Substantial timing or memory changes: no 
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: 
cb999, er999 (ccsm test on bluesky)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton, mvertens
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

M models/atm/cam/bld/configure
- moved #define's of params.h and misc.h into cppdefs 
- removed creation of params.h (misc.h still temporarily remains for clm code) 
M models/atm/cam/bld/Makefile
- no longer looks for SPMD specification in misc.h 

**also modified all fortran and c files to remove #include of misc.h and 
params.h (excluding clm code) 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_4
Originator: jeff ( Yen-Huei Lee)
Date: Sun Jul  3 13:48:55 MDT 2005
Model: CAM
Version: CAM3.2.4
One-line Summary: fix tro_mozart to allow extra tracers, bug fix to run in ccsm, output co2 fluxes to history tape, add index for fdms
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail: none (Get clearance for failed tests, enter lines from td.*.status files that fail)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

M models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
  allow trop_mozart to run with extra tracers, i.e. CO2.

M models/atm/cam/src/physics/cam1/physpkg.F90
  bug fix to allow ccsm to run

M models/atm/cam/src/physics/cam1/co2_cycle.F90
M models/atm/cam/src/control/ccsm_msg.F90
  output co2 fluxes to history tape

M models/atm/cam/src/physics/cam1/comsrf.F90
  add index for fdms

M models/atm/cam/src/dynamics/fv/fv_prints.F90
  bug fix

M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
  use new data sad_file for waccm_mozart
	
===============================================================
===============================================================

cam3_2_3
Originator: erik ( Erik Kluzek)
Date: Thu Jun 30 00:18:39 MDT 2005
Model: CAM
Version: CAM3.2.3
One-line Summary: Move cam3_2_2_brnchT_srfsimp6 to cam_dev -- makes surface (ocean, land, sea-ice) more modular
Requires change in build system: yes
(Requires CAMSURF defines in misc.h)
Substantial timing or memory changes: no
Requires change in run script: no
Ran test_driver.shl script: yes (does all of the following tests)
Machines tested: IBM, SGI, Linux-Lahey
Test id's that fail:  Bluesky: 1, 5,8,15,22,30,34,37,40,44,47,54,55
  5-54 fail because diagnostic fields change
  001 cb999 TCB.ccsm.sh .............................................FAIL! rc= 4
  055 er999 TER.ccsm.sh .............................................FAIL! rc= 2
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton, mvertens
Restart files change: yes
Changes answers: no (bit-for-bit) (some ocean/ice diagnostic fields 
	change to roundoff at time=0)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Add following to misc.h:

#define B4B_CAMSURF  -2
#define RND_CAMSURF  -1
#define CLIMATE_CAMSURF  0
#define CAMSURF         B4B_CAMSURF

This allows answers to be the same as current model, while allowing 
ifdefs that can provide changes to roundoff or climate-changing.

Move tsnam and plevmx to ice_constants

Shorten initext and remove tangled dependencies of surface models.
Create initialization methods for sea-ice and oceanm that are called by
initext.  Move surface methods in physpkg to run methods in ocean, and ice.

Make camice and somocn, and camocn into modules with various methods.
Move ice_read from inidat to camice. Move write_restart, read_restart
of ice to camice methods.

Make comsrf more modular. Move data specific to ocean, ice, or land
out of comsrf. Create merge method, and make some methods private.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_2
Originator: mvr ( Mathew Rothstein) jeff, mvertens, eaton
Date: Wed Jun 15 16:37:19 MDT 2005
Model: CAM
Version: CAM3.2.2
One-line Summary: configure/build-namelist mods for calls from ccsm and a plethora of bug fixes
cam-bugs Requests resolved: none
Requires change in build system: yes - now enabled for ccsm
Substantial timing or memory changes: no 
Requires change in run script: yes - now enabled for ccsm
Tested to work coupled with CCSM (create_ccsmcam): not create_ccsmcam, but other
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey,pgi
Ran test_driver.shl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself,eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: yes - logical restart writes changed to ints
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:
R models/atm/cam/tools/icesst/bcgen/namelist.T42
R models/atm/cam/tools/icesst/bcgen/namelist.T42.oldtt
R models/atm/cam/tools/icesst/bcgen/namelist.T5
- cleanup of files resulting from regeneration of sst datasets

A models/atm/cam/tools/icesst/bcgen/namelist
- new file required of modified method to generate sst datasets
A models/atm/cam/test/system/config_files/wm4h
- new configuration options file for waccm test without debug 

M models/atm/cam/bld/CAM_namelist.pm
M models/atm/cam/bld/build-namelist
M models/atm/cam/bld/namelist.pm
- mods required for CAM's build-namelist script to be called from within CCSM

M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
M models/atm/cam/bld/DefaultCLMEXPNamelist.xml
- new defaults for 1.9x2.5 topo datasets

M models/atm/cam/bld/configure
- mods required for CAM's configure script to be called from within CCSM

M models/atm/cam/src/chemistry/waccm_mozart/mo_setrxt.F90
- bug fix to achieve b4b restart of waccm_mozart

M models/atm/cam/src/control/ccsm_msg.F90
M models/atm/cam/src/control/history.F90
M models/atm/cam/src/control/restart.F90
M models/atm/cam/src/control/time_manager.F90
M models/lnd/clm2/src/main/histFileMod.F90
- all logical restart writes are now integers (workaround to pathscale bug)

M models/atm/cam/src/physics/cam1/co2_cycle.F90
M models/atm/cam/src/physics/cam1/radiation.F90
- change co2 tracer from moist to dry

M models/atm/cam/src/control/ccsm_msg.F90
- change unit of co2 flux from kgC/m2/s to kgCO2/m2/s

M models/atm/cam/src/physics/cam1/srfxfer.F90
- bug fix for computation of netsw in coupled mode

M models/atm/cam/test/system/input_tests_master
- modified to now test waccm_mozart in non-debug mode 

M models/atm/cam/test/system/scamtest.sh
- bug fix for output of test results

M models/atm/cam/tools/definesurf/fmain.f90
- land fractions < .001 set to zero; metadata now complies with CF conventions

M models/atm/cam/tools/icesst/README
- describe -g option for reading grid info from file

M models/atm/cam/tools/icesst/bcgen/bcgen.f90
- pass the history attribute to setup_outfile

M models/atm/cam/tools/icesst/bcgen/driver.f90
- input & output filepaths now specified on command-line 
- generate the history attribute

M models/atm/cam/tools/icesst/bcgen/setup_outfile.f90
- add history attribute to both output files

M models/atm/cam/tools/icesst/regrid/regrid.f90
- Modify so that output grid coordinates can be read from the new grid files

M models/atm/cam/tools/icesst/regrid/wrap_nf.f90
- add wrap_nf_put_var_int

M models/atm/cam/tools/scam/ui/crm.cpp
- updated aerosol optics file to be used for column radiation model test
M models/atm/cam/tools/scam/userdata/crmtest26.out 
- updated validation file for column radiation model test



See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_2_1
Originator: aconley ( Andrew J. Conley)
Date: Fri Jun  3 17:29:46 MDT 2005
Model: CAM
Version: CAM3.2.1
One-line Summary: Improve interface between radiation (LW and SW) and aerosols
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: Yes (problems for vector architecture)
Requires change in run script: Yes
 Added new data to AerosolsOptics file.  So CAM namelist has changed
Tested to work coupled with CCSM (create_ccsmcam): No: ccsm namelist is now out of date
Tested to work with SCAM (tools/scam/testscript): No: crm part of test fails now because of change to Aerosol Optics
Machines tested: IBM, SGI, Lahey
Ran test_driver.shl script: No: ran test_driver.sh
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: not for waccm
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: Yes (no change to climate, but larger than roundoff changes)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:


   New files: aerosol_radiation_interface.F90
              aerosol_index.F90
   Deleted:   volcrad.F90
   Changed: DefaultCAMExpNamelist
            runtime_opts.F90
            advnce.F90
            aer_optics.F90
            aerosol_intr.F90
            inti.F90
            prescribed_aerosols.F90
            radae.F90
            radiation.F90
            radsw.F90
            volcanicmass.F90


===============================================================
===============================================================

cam3_2_0
Originator: mvertens ( Mariana Vertenstein)
Date: Mon May 30 15:53:48 MDT 2005
Model: CAM
Version: CAM3.2.0
One-line Summary: incorporated clm3_expa_29 into stand-alone cam
cam-bugs Requests resolved: none
Requires change in build system: yes (new clm cpp variable added)
Substantial timing or memory changes: no (unless CN code is activated)
Requires change in run script: all clm surface datasets have changed
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test_driver.shl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, 
Restart files change: no
Changes answers: new-climate
Changes to CLM land-model: Yes (see below)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The following code changes accompany the incorporation
of new CLM code - clm_expa_29 - into the stand-alone CAM
development code base. As part of these changes, new CLM 
raw datasets were used to create the clm model surface
datasets. All CLM surface datasets were regenerated using 
the new raw datasets. In addition, clm3_expa_29 also contains the 
the incorporation of the carbon-nitrogen cycle into the CLM code base
(both Peter Thornton's CN model and the CASA carbon cycle model). 	
A detailed summary of climate changing modifications appears below.
Finally, clm3_expa_29, contains the flexibility, for the first time,
to run dynamic land use runs using prescribed land use datasets.
	
Note that generating clm surface datasets is now accomplished 
via an offline tool in mksrfdata/tools/mksrfdat. This is not 
part of the standard cam clm/tools directory yet
due to the current structure of the cam cvs module. 
This will be incorporated into cam in a subsequent cam checkin.
	
Validation simulations were carried out for 1979-2000 with annually varying SSTs.

The tags used for hyd_clm3_1 were cam3_1_7 and clm3_expa_29
(camroot = /fis/cgd/cseg/people/mvertens/src/cam/cam3_1_7_clm3_expa_29)

The changes between hyd_clm3_1 and hyd_con were:
o New SST dataset (amipbc_sst_T42_1949_2004.nc as opposed to sst_HadOIBl_bc_64x128_1949_2001_c020411.nc)
o Albedo calculation in CLM moved to end of second biophysics loop
o Peter Thornton's 2-leaf canopy model
o Peter Lawrence's MODIS-based surface dataset (distribution of plant
  functional types, LAI, and soil color)
o David Lawrence's and Peter Thornton's hydrology modifications (includes
  new formulations for interception, infiltration (surface runoff), soil
  moisture effects on stomatal conductance, soil to canopy air space transfer
  coefficients, soil hydraulic conductivity, and baseflow.

===============================================================
===============================================================

cam3_1_9
Originator: boville, eaton
Date: Fri May 27 09:55:54 MDT 2005
Model: CAM
Version: CAM3.1.9
One-line Summary: WACCM bugfix
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test_driver.shl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: boville
Restart files change: no
Changes answers: no (bit-for-bit) except WACCM_MOZART changes answers
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

chemistry/waccm_mozart/chemistry.F90
. Fix initialization of qmin.

===============================================================
===============================================================

cam3_1_8
Originator: boville, eaton ( Brian Eaton)
Date: Tue May 17 18:33:16 MDT 2005
Model: CAM
Version: CAM3.1.8
One-line Summary: Merge latest WACCM development code
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test_driver.shl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: boville, eaton
Restart files change: no
Changes answers: CAM is bit-for-bit, WACCM has a new climate.
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Merge latest WACCM development code.

There is a new feature in the FV tracer code (trac2d.F90) which allows the
timestep splitting to differ in different vertical layers.  This feature is
currently only enabled for the WACCM_MOZART configuration since it can
introduce answer changes into the standard CAM FV configurations.

Add LAPACK_LIBDIR macro to Makefile to allow specifying the location of the
LAPACK and BLAS libraries.  Optional use is made of these libraries in
WACCM specific code (on AIX only).

Add the use of the massv library to the AIX section of the Makefile.  The
use of this library introduces roundoff level differences into the
simulation when changing the parallel configuration.  This library is only
used in WACCM_MOZART specific code.

In the IRIX64 section of the Makefile the -cpp option was replaced with
-macro_expand.  A WACCM_MOZART ifdef which was including code in a
multi-line data statement was failing to compile otherwise.

===============================================================
===============================================================

cam3_1_7
Originator: mvr ( Mathew Rothstein)
Date: Wed May  4 12:14:23 MDT 2005
Model: CAM
Version: CAM3.1.7
One-line Summary: Updating the new cam test framework with new tests and other enhancements
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test_driver.shl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

A models/atm/cam/test/system/TEQ.sh
- new generic script to test the equivalence of two cam smoke runs
A models/atm/cam/test/system/TRX.sh
- new script to test the restart of cam using fv 2d decomposition 
A models/atm/cam/test/system/scamtest.sh
- new script to test scam and crm 
A models/atm/cam/test/system/config_files/f10dm
A models/atm/cam/test/system/config_files/fm2dh
A models/atm/cam/test/system/config_files/fmo2dh
A models/atm/cam/test/system/config_files/wg10dh
A models/atm/cam/test/system/config_files/wm4dh
- new configuration options files for added tests
A models/atm/cam/test/system/nl_files/no_ttrac
A models/atm/cam/test/system/nl_files/off2x2.5
A models/atm/cam/test/system/nl_files/ttrac_lb1
A models/atm/cam/test/system/nl_files/ttrac_lb2
A models/atm/cam/test/system/nl_files/ttrac_lb3
- new namelist options files for added tests

M models/atm/cam/test/system/CAM_compare.sh
M models/atm/cam/test/system/TBL.sh
M models/atm/cam/test/system/TBR.sh
M models/atm/cam/test/system/TCB.ccsm.sh
M models/atm/cam/test/system/TCB.sh
M models/atm/cam/test/system/TER.ccsm.sh
M models/atm/cam/test/system/TER.sh
M models/atm/cam/test/system/TSM.sh
M models/atm/cam/test/system/input_tests_aix
M models/atm/cam/test/system/input_tests_irix
M models/atm/cam/test/system/input_tests_linux
M models/atm/cam/test/system/input_tests_master
M models/atm/cam/test/system/test_driver.sh

mods and enhancements to the new cam test framework scripts including: 
- added waccm tests
- added test for load balancing
- added test for the fv offline driver
- added test for fv 2d decomposition
- moved scam/crm test into default tests
- will now stop on first failure for interactive runs by default and  
  added environment variable CAM_SOFF to override default behavior 
- cleaned up handling of shell string variables
- now backs up directories of failed tests when reattempting

M README
- updated with the wording used for release 


	(Put your detailed description of the changes you made here...)
       (You will get your edited copy e-mailed to you. It will also be)
	(sent to cam-dev@cgd.ucar.edu.)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_1_6
Originator: jeff ( Yen-Huei Lee)
Date: Sat Apr 30 12:25:17 MDT 2005
Model: CAM
Version: CAM3.1.6
One-line Summary: allow model year to be different from ghg data year
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test_driver.shl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Brian Eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

M models/atm/cam/src/control/ccsm_msg.F90
M models/atm/cam/src/control/runtime_opts.F90
M models/atm/cam/src/chemistry/waccm_mozart/chem_surfvals.F90
M models/atm/cam/src/physics/cam1/chem_surfvals.F90
M models/atm/cam/src/physics/cam1/advnce.F90
M models/atm/cam/src/physics/cam1/srfxfer.F90
M models/atm/cam/src/physics/cam1/radiation.F90
M models/atm/cam/src/physics/cam1/co2_cycle.F90
D models/atm/cam/src/physics/cam1/co2_data_scalar.F90

Function add:

use the following namelists to set model start year and ghg data start year,

     ghg_yearStart_model = 1
     ghg_yearStart_data  = 1950

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_1_5
Originator: eaton ( Brian Eaton)
Date: Mon Apr 25 18:17:11 MDT 2005
Model: CAM
Version: CAM3.1.5
One-line Summary: fix CCSM test, update definesurf tool
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): no
Machines tested: IBM
Ran test_driver.shl script: Only ran CCSM test
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None (one-line description)

Changes made:

Fix the CCSM test.

Also add some modifications to the definesurf tool from Byron.  These mods
relax the previous restriction that the same filter be applied to both SGH
and PHIS.

===============================================================
===============================================================

cam3_1_4
Originator: jeff ( Yen-Huei Lee)
Date: Sat Apr 23 11:20:36 MDT 2005
Model: CAM
Version: CAM3.1.4
One-line Summary: add co2 tracer transport and using 2D co2 for radiation
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no 
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): no
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test_driver.shl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Brian Eaton
Restart files change: no
Changes answers: Yes (same-to-roundoff)
(Note: test_driver.sh only does checks this -- if you run it with "env BL_ROOT=")
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

The constant co2 value used for radiation computation was replaced by
2D co2 distribution (column-mean). This is responsible for the roundoff.

Function added:

co2 tracer can be transported with co2 fluxes from land (through coupler),
from ocean (through data file) and from fossil fuel (through data file).

co2 scalar data can be read from data file and can be used as data-cycling
type operation.

M models/atm/cam/src/control/cam.F90
M models/atm/cam/src/control/initext.F90
M models/atm/cam/src/control/ccsm_msg.F90
M models/atm/cam/src/control/restart.F90
M models/atm/cam/src/control/runtime_opts.F90
M models/atm/cam/src/dynamics/fv/inidat.F90
M models/atm/cam/src/dynamics/sld/inidat.F90
M models/atm/cam/src/dynamics/eul/inidat.F90
M models/atm/cam/src/physics/cam1/advnce.F90
M models/atm/cam/src/physics/cam1/initindx.F90
M models/atm/cam/src/physics/cam1/restart_physics.F90
M models/atm/cam/src/physics/cam1/comsrf.F90
M models/atm/cam/src/physics/cam1/inti.F90
M models/atm/cam/src/physics/cam1/srfxfer.F90
M models/atm/cam/src/physics/cam1/rad_constituents.F90
M models/atm/cam/src/physics/cam1/radiation.F90
M models/atm/cam/src/physics/cam1/radsw.F90
M models/atm/cam/src/physics/cam1/radlw.F90
M models/atm/cam/src/physics/cam1/radae.F90
A models/atm/cam/src/physics/cam1/co2_cycle.F90
A models/atm/cam/src/physics/cam1/co2_data_flux.F90
A models/atm/cam/src/physics/cam1/co2_data_scalar.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_1_3
Originator: eaton ( Brian Eaton)
Date: Thu Mar 31 08:51:32 MST 2005
Model: CAM
Version: CAM3.1.3
One-line Summary: move control of rad calcs into rad module.  pathscale & g95 builds
cam-bugs Requests resolved: bugzilla IDs 4, 10, 13
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): no, currently broken
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Consolidate control of radiation calculations in the radiation module.
This includes resposibility for maintaining the namelist variables iradsw,
iradlw, iradae, and irad_always, and providing a function for the values
dosw, dolw, doabsems, and aeres.  These variables have all been removed
from comctl.h.

Add bugfix for turbulent mountain stress code.

Add files to DefaultCAMEXPNamelist.xml needed for WACCM runs at 1.9x2.5
resolution.

Add Makefile sections and ESMF build to support pathscale and g95 compilers
on linux systems.

Replace the PGF90 CPP macro with NO_R16.  The PGF90 macro was being used to
indicate that the compiler doesn't support quad precision.  But that's also
the case for the pathscale and g95 compilers.  The use of a generic CPP
token allows new compilers to be supported by modifying the the Makefile to
specify the compiler properties without requiring source code modification.

The g95 compiler doesn't recognize the cray pointer syntax in fv/geopk.F90.
The use of cray pointers there can't be trivially replaced by F90 pointers.
Since the cray pointers only appear in the geopk16 routine which is not
used by default, a CPP token NO_CRAY_POINTERS is defined for g95 and used
to stub out geopk16.  endrun is called if the user sets the namelist
variable (geopktrans) to use geopk16 when NO_CRAY_POINTERS is defined.

Add bugfix to cmfmca pointed out by David Noone.  This only affects the
simulation of tracers using dry mixing ratio (none by default).  The set of
test tracers enabled by setting the namelist variable
tracers_flag=.true. use a dry mixing ratio and are affected by this fix.


===============================================================
===============================================================

cam3_1_2
Originator: mvr ( Mathew Rothstein)
Date: Fri Mar 25 16:41:11 MST 2005
Model: CAM
Version: CAM3.1.2
One-line Summary: New testing framework for CAM - replaces test-model; and a few minor bug fixes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey, Linux-PGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
...and much, much more!
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:


R models/atm/cam/test/system/babyblue.test-model.pl.log
R models/atm/cam/test/system/CAM_test.pm
R models/atm/cam/test/system/cam_timing.pm
R models/atm/cam/test/system/check-timing.pl
R models/atm/cam/test/system/dao_batch.csh
R models/atm/cam/test/system/default_tests.test-model.xml
R models/atm/cam/test/system/llnl_blue.csh
R models/atm/cam/test/system/llnl_compass.csh
R models/atm/cam/test/system/llnl_frost.csh
R models/atm/cam/test/system/namelist-config.test-model.dbg.log
R models/atm/cam/test/system/ncar_batch.csh
R models/atm/cam/test/system/nersc_batch.csh
R models/atm/cam/test/system/ornl_batch.csh
R models/atm/cam/test/system/specs-testslist.test-model.xml
R models/atm/cam/test/system/test-examples.pl
R models/atm/cam/test/system/test-model.pl
R models/atm/cam/test/system/test-production.pl
- cleanup of old test-model files

A models/atm/cam/test/system/CAM_compare.sh
- utility script for comparison of results
A models/atm/cam/test/system/CAM_runcmnd.sh
- utility script for constructing platform dependent run command
A models/atm/cam/test/system/input_tests_aix
- required aix tests for cam commit
A models/atm/cam/test/system/input_tests_irix
- required irix tests for cam commit
A models/atm/cam/test/system/input_tests_linux
- required linux tests for cam commit
A models/atm/cam/test/system/input_tests_master
- master list of tests
A models/atm/cam/test/system/TBL.sh
- generic script for baseline tests
A models/atm/cam/test/system/TBR.sh
- generic script for branch tests
A models/atm/cam/test/system/TCB.ccsm.sh
- script for configure and build test of cam in coupled model
A models/atm/cam/test/system/TCB.sh
- generic script for configure and build tests
A models/atm/cam/test/system/TER.ccsm.sh
- script for exact restart test of cam in coupled model
A models/atm/cam/test/system/TER.sh
- generic script for exact restart tests
A models/atm/cam/test/system/test_driver.sh
- driver script for all tests
A models/atm/cam/test/system/TSM.sh
- generic script for smoke tests
A models/atm/cam/test/system/nl_files/adia
A models/atm/cam/test/system/nl_files/aqpgro
A models/atm/cam/test/system/nl_files/ghgrmp
A models/atm/cam/test/system/nl_files/idphys
A models/atm/cam/test/system/nl_files/outfrq24h
A models/atm/cam/test/system/nl_files/outfrq3s
A models/atm/cam/test/system/nl_files/pghgsul
A models/atm/cam/test/system/nl_files/ttrac
- files containing non-default namelist options being tested
A models/atm/cam/test/system/config_files/e32c11dh
A models/atm/cam/test/system/config_files/e32dh
A models/atm/cam/test/system/config_files/e32pdh
A models/atm/cam/test/system/config_files/e32sdh
A models/atm/cam/test/system/config_files/e64h
A models/atm/cam/test/system/config_files/e64m
A models/atm/cam/test/system/config_files/e64o
A models/atm/cam/test/system/config_files/e8c8mdm
A models/atm/cam/test/system/config_files/e8pdm
A models/atm/cam/test/system/config_files/e8sdm
A models/atm/cam/test/system/config_files/f10c8mdm
A models/atm/cam/test/system/config_files/f10pdm
A models/atm/cam/test/system/config_files/f10sdm
A models/atm/cam/test/system/config_files/f2h
A models/atm/cam/test/system/config_files/f2m
A models/atm/cam/test/system/config_files/f2o
A models/atm/cam/test/system/config_files/f4c11dh
A models/atm/cam/test/system/config_files/f4dh
A models/atm/cam/test/system/config_files/f4pdh
A models/atm/cam/test/system/config_files/f4sdh
A models/atm/cam/test/system/config_files/s32c11dh
A models/atm/cam/test/system/config_files/s32dh
A models/atm/cam/test/system/config_files/s32pdh
A models/atm/cam/test/system/config_files/s32sdh
A models/atm/cam/test/system/config_files/s64h
A models/atm/cam/test/system/config_files/s64m
A models/atm/cam/test/system/config_files/s64o
A models/atm/cam/test/system/config_files/s8c8mdm
A models/atm/cam/test/system/config_files/s8pdm
A models/atm/cam/test/system/config_files/s8sdm
- files containing configuration options being tested

M models/atm/cam/src/physics/cam1/sulfur_intr.F90
- fixed declaration and setting of array totcond
M models/atm/cam/src/physics/cam1/dmsbnd.F90
- initialized arrays dmsin and dms to 0._r8
M models/atm/cam/src/dynamics/eul/inidat.F90
- added explicit setting of phis_hires 
M models/atm/cam/src/dynamics/fv/inidat.F90
- modified the array assignments where it depended upon ncol
M models/atm/cam/src/dynamics/sld/inidat.F90
- added explicit setting of phis_hires
M models/atm/cam/src/control/initext.F90
- modified the array assignments where it depended upon ncol
M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
- modified the default settings for fv 4x5 sulpher datasets 




See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_1_1
Originator: fvitt ( Francis Vitt)
Date: Mon Mar 21 12:39:28 MST 2005
Model: CAM
Version: CAM3.1.1
One-line Summary: Added a tropospheric chemistry package.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Brian Eaton
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

Files added:

models/atm/cam/bld/config_trop_chem_mozart_defaults.xml
models/atm/cam/src/chemistry/trop_mozart/chem_mods.F90
models/atm/cam/src/chemistry/trop_mozart/chemistry.F90
models/atm/cam/src/chemistry/trop_mozart/m_het_id.F90
models/atm/cam/src/chemistry/trop_mozart/m_rxt_id.F90
models/atm/cam/src/chemistry/trop_mozart/m_spc_id.F90
models/atm/cam/src/chemistry/trop_mozart/mo_adjrxt.F90
models/atm/cam/src/chemistry/trop_mozart/mo_aerosols.F90
models/atm/cam/src/chemistry/trop_mozart/mo_airplane.F90
models/atm/cam/src/chemistry/trop_mozart/mo_ch4_lbc.F90
models/atm/cam/src/chemistry/trop_mozart/mo_chemini.F90
models/atm/cam/src/chemistry/trop_mozart/mo_drydep.F90
models/atm/cam/src/chemistry/trop_mozart/mo_exp_sol.F90
models/atm/cam/src/chemistry/trop_mozart/mo_gas_phase_chemdr.F90
models/atm/cam/src/chemistry/trop_mozart/mo_imp_sol.F90
models/atm/cam/src/chemistry/trop_mozart/mo_indprd.F90
models/atm/cam/src/chemistry/trop_mozart/mo_jlong.F90
models/atm/cam/src/chemistry/trop_mozart/mo_jpl.F90
models/atm/cam/src/chemistry/trop_mozart/mo_jshort.F90
models/atm/cam/src/chemistry/trop_mozart/mo_lb_vals.F90
models/atm/cam/src/chemistry/trop_mozart/mo_lightning.F90
models/atm/cam/src/chemistry/trop_mozart/mo_lin_matrix.F90
models/atm/cam/src/chemistry/trop_mozart/mo_lu_factor.F90
models/atm/cam/src/chemistry/trop_mozart/mo_lu_solve.F90
models/atm/cam/src/chemistry/trop_mozart/mo_mass_xforms.F90
models/atm/cam/src/chemistry/trop_mozart/mo_mean_mass.F90
models/atm/cam/src/chemistry/trop_mozart/mo_negtrc.F90
models/atm/cam/src/chemistry/trop_mozart/mo_nln_matrix.F90
models/atm/cam/src/chemistry/trop_mozart/mo_prod_loss.F90
models/atm/cam/src/chemistry/trop_mozart/mo_read_chm_sim.F90
models/atm/cam/src/chemistry/trop_mozart/mo_regrider.F90
models/atm/cam/src/chemistry/trop_mozart/mo_seasalt.F90
models/atm/cam/src/chemistry/trop_mozart/mo_setext.F90
models/atm/cam/src/chemistry/trop_mozart/mo_setinv.F90
models/atm/cam/src/chemistry/trop_mozart/mo_setrxt.F90
models/atm/cam/src/chemistry/trop_mozart/mo_setsoa.F90
models/atm/cam/src/chemistry/trop_mozart/mo_setsox.F90
models/atm/cam/src/chemistry/trop_mozart/mo_srf_emissions.F90
models/atm/cam/src/chemistry/trop_mozart/mo_sulf.F90
models/atm/cam/src/chemistry/trop_mozart/mo_tracname.F90
models/atm/cam/src/chemistry/trop_mozart/mo_ub_vals.F90
models/atm/cam/src/chemistry/trop_mozart/mo_usrrxt.F90
models/atm/cam/src/chemistry/trop_mozart/mo_waccm_photo.F90
models/atm/cam/src/chemistry/trop_mozart/mo_wetdep.F90
models/atm/cam/src/chemistry/trop_mozart/phtadj.F90
models/atm/cam/src/chemistry/trop_mozart/rxtmod.F90

Files modified:

models/atm/cam/bld/DefaultCAMEXPNamelist.xml
  - added files needed for trop_mozart chemistry package
models/atm/cam/bld/camexp.pm
  - added trop_mozart input files to the namelist
models/atm/cam/bld/configure
  - added trop_mozart chemistry package option
models/atm/cam/src/chemistry/waccm_mozart/chemistry.F90
  - changed interface to be consistent with trop_mozart chemistry
models/atm/cam/src/control/history.F90
  - increased tbl_hash_oflow_percent
models/atm/cam/src/control/runtime_opts.F90
  - added input files to namelist for trop_mozart chemistry
models/atm/cam/src/physics/cam1/aerosol_intr.F90
  - added aerosol feedback capability for trop_mozart chemistry
models/atm/cam/src/physics/cam1/chemistry.F90
  - changed interface to be consistent with trop_mozart chemistry
models/atm/cam/src/physics/cam1/physpkg.F90
  - enabled lightning production of NO for trop_mozart chemistry
models/atm/cam/src/physics/cam1/stratiform.F90
  - added total precip/evap fields to physics buffer needed by trop_mozart
models/atm/cam/src/physics/waccm/chemistry.F90
  - changed interface to be consistent with trop_mozart chemistry
models/atm/cam/tools/scam/testscript
  - removed "-test" option from configure invocation


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_1
Originator: eaton ( Brian Eaton)
Date: Tue Mar 15 20:14:48 MST 2005
Model: CAM
Version: CAM3.1
One-line Summary: cam3_1 same as cam3_0_34
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): no
Tested to work with SCAM (tools/scam/testscript): no
Machines tested: none
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB? no

Changes made: none.

Add tag cam3_1.  This is the branch point for the CAM3.1 release

===============================================================
===============================================================

cam3_0_34
Originator: pworley ( Patrick H Worley)
Date: Tue Mar 15 18:01:47 MST 2005
Model: CAM
Version: CAM3.0.34
One-line Summary: Cray X1 optimizations
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes on X1: recovers performance lost due to changes since cam3.0 
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): no - broken in earlier check-in
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes - added support for SSP execution mode
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

added models/utils/esmf/cray_x1_ssp/
  Identical to cray_x1 except that compiler options in the file base_variables were modified
  so that esmf routines could be used in SSP mode.

models/atm/cam/bld/Makefile
  - in UNICOSMP section: added support for SSP mode and higher optimization levels for 4 routines,
    recovering performance lost in earlier check-in that lowered optimization

models/atm/cam/src/control/history.F90, wrap_nf.F90
  - deleted CRAY ifdefs

models/atm/cam/src/physics/cam1/convect_deep.F90
  - modified calls to convtran, replacing ":" array indices with "1", to improve performance

models/atm/cam/src/physics/cam1/qneg3.F90
  - modified to improve vectorization and streaming

models/atm/cam/src/physics/cam1/radiation.F90
  - modified calls to radcswmx and radclwmx,
    replacing ":" array indices with "1", to improve performance
  - added Cray compiler directives

models/atm/cam/src/physics/cam1/zm_conv.F90
  - added Cray compiler directives

models/lnd/clm2/src/main/controlMod.F90
  - added ifdef to define default clump_pproc value for SSP mode

models/lnd/clm2/src/main/driver.F90
  - added ifdef to disable OpenMP directive around "loop2" for SSP mode (a bug work around)

models/utils/timing/gptl.c
  - added ifdef to not disable timers unnecessarily in SSP mode

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_33
Originator: rosinski ( Jim Rosinski)
Date: Thu Mar 10 14:05:47 MST 2005
Model: CAM
Version: CAM3.0.33
One-line Summary: Enable new timing lib.
cam-bugs Requests resolved: none
Requires change in build system: Maybe for CCSM.
Substantial timing or memory changes: Yes: on IBM timer overhead decreases
                                      by as much as 10x. On SGI by 2x. On
                                      Cray X1 by 3x. No speedup on Linux.
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes but it failed. Told 
                                                   to go ahead with commit.
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: timer init calls and fortran include file changed.
Have you filled out the pre-check-in documentation as required by the CAM CRB? yes

Changes made:

o Replace timer code in utils/timing with new more effecient version. Better
  performance results from replacing a linked list search for timer names
  with a simple hash table. The new library now prints per-timer overhead
  estimates. It can also interface with the PAPI low level performance 
  counter library. A brief description of how to do so is included in 
  utils/timing/README.

o The old interface names (t_xxx) were retained. But these should be changed
  to the new names (gptlxxx) as soon as possible.

o Modify CAM Makefile for optimal performance on Cray X1.

===============================================================
===============================================================

cam3_0_32
Originator: eaton ( Brian Eaton)
Date: Tue Mar  8 10:08:10 MST 2005
Model: CAM
Version: CAM3.0.32
One-line Summary: topo fields in separate file
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes
  namelist includes bnd_topo -- build-namelist provides defaults
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Topography fields (mods from Byron Boville)
===========================================

These mods are to read the topo fields (PHIS, SGH, SGH30, LANDFRAC,
LANDM_COSLAT) from their own file.  They are no longer written to the
output initial files.  Backwards compatibility is maintained by looking for
the topo fields on the initial file if a topo file is not specified using
the new namelist variable bnd_topo.  There are also mods to write the names
of the initial, topo, and sst files into global attributes of the history
files.

An initial set of topo files have been created by extracting the topo
fields from the initial files currently specified in
DefaultCAMEXPNamelist.xml.  The topo files are in the data directory
$CSMDATA/atm/cam/topo/.  These files will eventually be replaced by a set
of standard files that contain detailed metadata describing how the fields
were produced.

There are also modifications and cleanup in the definehires and definesurf
utilities.  Added alot of information to the README files for both utils.

Misc
====

. Re-insert a fix in phys_grid.F90 (transpose_chunk_to_block)
  changing the chunk_buffer arg to intent(in).

. In history.F90 increase pflds to 2000 and tbl_hash_oflow_percent to 10.



===============================================================
===============================================================

cam3_0_31
Originator: bundy ( Dani Bundy Coleman)
Date: Wed Mar  2 13:56:13 MST 2005
Model: CAM
Version: CAM3.0.31
One-line Summary: Add mass conservation for dry tracers in Eularian dycore; restore same in SLD
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes (bluesky)
Tested to work with SCAM (tools/scam/testscript): yes (bangkok)
Machines tested: IBM (bluesky), SGI (tempest), Linux-Lahey (bangkok)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton
Restart files change: no (pdeld added only when run with dry-type constituents)
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

A models/atm/cam/src/dynamics/eul/massfix.F90
Currently a module that just holds hw1, hw2, hw3, alpha. Could facilitate
a separation between mass fix and the timefilter.

M slt/qmassa.F90 
Now a module, old subroutine qmassa is now qmassarun. Added an
optional argument pdeld to be used to calculate hw1lat for dry
mixing-ratio constituents. 

M control/history.F90
moved addfld and add_defualt for PDELDRY from here to physics/cam1/diagnostics.F90

M eul/dp_coupling.F90
Added transfer of pdeld from p->d,d->p. Calculation of pdeld moved to
tfilt_massfix.F90 instead of call to set_state_pdry.

M eul/inital.F90
added initialization of dynamics variable pdeld

M eul/prognostics.F
added dynamics variable pdeld, only allocated when dry constituents
are present

M eul/restart_dynamics.F90
added pdeld to restart files

M eul/scan2.F90
moved public hw1, hw2, hw3, alpha to new module massfix.F90
pass pdeld to tfilt_massfixrun()

M eul/scandyn.F90
pass pdeld to qmassarun

M eul/scanslt.F90
pass pdeld to qmassarun

M eul/stepon.F90
pass pdeld to d_p_coupling

M eul/tfilt_massfix.F90
Calculate time filtered value of pdeldry; use this to time-filter dry
constituents conservatively.

M sld/scanslt.F90
change qmassa call to new name: qmassarun

M sld/tfilt_massfix.F90
save water vapor for use in next timestep; this was inadvertently
removed in cam3_0_28 and is necessary for dry mass conservation

M physics/constituents.F90
new public logical cnst_need_pdeldry. Default is flase, set to true if 
any constituents are dry.

M physics/convect_deep.F90
only use pdeldry when needed

M physics/diagnostics.F90
addfld and outfld calls for PSDRY and PDELDRY only when needed

M physics/icarus_scops.F90
added r8 to reals

M physics/physics_types.F90
added state%pdeldry  and related to methods only when needed
added optional argument pdeld_calc (default=true) to subroutine
set_state_pdry, setting false still calculates related fields but
doesn't change state%pdeldry itself.

M physics/physpkg.F90
diagnostic subroutine gavglook only calculates dry quantities when
needed

M physics/tracers_suite.F90
added missing r8
Now a module, old subroutine qmassa is now qmassarun. Added an
optional argument pdeld to be used to calculate hw1lat for dry
mixing-ratio constituents. 

M control/history.F90
moved addfld and add_defualt for PDELDRY from here to physics/cam1/diagnostics.F90

M eul/dp_coupling.F90
Added transfer of pdeld from p->d,d->p. Calculation of pdeld moved to
tfilt_massfix.F90 instead of call to set_state_pdry.

M eul/inital.F90
added initialization of dynamics variable pdeld

M eul/prognostics.F
added dynamics variable pdeld, only allocated when dry constituents
are present

M eul/restart_dynamics.F90
added pdeld to restart files

M eul/scan2.F90
moved public hw1, hw2, hw3, alpha to new module massfix.F90
pass pdeld to tfilt_massfixrun()

M eul/scandyn.F90
pass pdeld to qmassarun

M eul/scanslt.F90
pass pdeld to qmassarun

M eul/stepon.F90
pass pdeld to d_p_coupling

M eul/tfilt_massfix.F90
Calculate time filtered value of pdeldry; use this to time-filter dry
constituents conservatively.

M sld/scanslt.F90
change qmassa call to new name: qmassarun

M sld/tfilt_massfix.F90
save water vapor for use in next timestep; this was inadvertently
removed in cam3_0_28 and is necessary for dry mass conservation

M physics/constituents.F90
new public logical cnst_need_pdeldry. Default is flase, set to true if 
any constituents are dry.

M physics/convect_deep.F90
only use pdeldry when needed

M physics/diagnostics.F90
addfld and outfld calls for PSDRY and PDELDRY only when needed

M physics/icarus_scops.F90
added r8 to reals

M physics/physics_types.F90
added state%pdeldry  and related to methods only when needed
added optional argument pdeld_calc (default=true) to subroutine
set_state_pdry, setting false still calculates related fields but
doesn't change state%pdeldry itself.

M physics/physpkg.F90
diagnostic subroutine gavglook only calculates dry quantities when
needed

M physics/tracers_suite.F90
added missing r8



See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_30
Originator: mvr ( Mathew Rothstein)
Date: Wed Feb  9 16:34:12 MST 2005
Model: CAM
Version: CAM3.0.30
One-line Summary: Cleanup of copyright info; minor bug fixes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

R LICENSE
- update to the copyright info and renaming of the file for 
  consistency with ccsm
A Copyright
- new file to replace LICENSE file that was removed
M models/atm/cam/src/control/cam.F90
- slight mod to the info on where to find copyright notice 
M models/atm/cam/src/control/history.F90
- bug fix for the variable "vid" whose intent needed to be out rather than in
M models/atm/cam/src/physics/cam1/icarus_scops.F90
- removed copyright info already contained in Copyright file
M models/atm/cam/test/system/create_ccsmcam
- replaced blackforest with bluesky as default machine 
M models/atm/cam/test/system/ncar_batch.csh
- default load-leveller queue now for bluesky rather than blackforest
M models/atm/cam/tools/scam/testscript
- bug fix for how the TESTSCRIPTDIR was determined
M models/atm/cam/tools/scam/ui/Platform.Notes
- removed copyright info already contained in Copyright file
M models/atm/cam/tools/scam/ui/c.h
- removed copyright info already contained in Copyright file
M models/atm/cam/tools/scam/ui/ncarg/c.h
- removed copyright info already contained in Copyright file


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_29
Originator: rosinski ( Jim Rosinski)
Date: Sun Feb  6 12:50:13 MST 2005
Model: CAM
Version: CAM3.0.29
One-line Summary: Reduced grid mods for CAM and interpaerosols boundary dataset generation code.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Modify eul/initcom.F90 to abort in SCAM mode if reduced grid enabled.
o Enable "mkrgrid" utility to work under lf95, ifort, and Cray X1.
o Enable "interpaerosols" utility for reduced grid, and Cray X1.
o Add new utility "mkrgridnew", which can replace "mkrgrid" when IC files
  are xyz. The new utility is simpler, and unlike mkrgrid works on ISCCP
  history files and on Cray X1.
o Check for reduced grid in optional boundary dataset reading routines 
  for which reduced grid capability is not yet enabled (e.g. dust module) 
  and abort in reduced grid mode.
o When CAM reads SST and aerosol data, ensure that boundary dataset grids 
  match cam grid.
o Delete threading directives from ccsm_msg.F90 per mvertens.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_28
Originator: olson ( Jerry Olson)
Date: Thu Jan 27 11:11:47 MST 2005
Model: CAM
Version: CAM3.0.28
One-line Summary: Add new diagnostics to history file.  Other misc mods.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: 

- Changes are round-off for EUL (except for aqua-planet which has a new climate
                                   because of a change in the dry airmass constant)
    Changes are BFB for SLD (except for aqua-planet which has a new climate)
    Changes are BFB for FV (except for aqua-planet which has a new climate)

Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:


  - Add fields to the master field list which complete the heat, moisture, cloud
    liquid water, cloud liquid ice, and precip budgets

      (no new *default* fields are added to the History file)

  - Add an attribute ("sampling_seq") to those fields on a NetCDF History File
    which are *not* based on an every-time-step sampling frequency.  The
    attribute would have a descriptive value indicating its sampling sequence.
    Currently only one value is added:  "rad_lwsw" (for fields that are only
    sampled at LW/SW radiation time steps).  No code is currently being added to
    fill these fields with "missing" values.

  - Replace the "RAD_FIRST_HOUR" namelist variable with "IRAD_ALWAYS".
    "RAD_FIRST_HOUR" was a logical that was too inflexible.  "IRAD_ALWAYS" is an
    integer that specifies length of time in timesteps (positive) or hours
    (negative) that the SW/LW radiation will be run continuously from the start
    of an initial run.
 
  - For aqua-planet runs, dry mass is hard-wired to 101325.-245. ( = 101080.) Pa

  - Bug fixes:

      - Fix a potential bug in the history module that would end up clobbering
        the creation of the IC file if *all* the fields added to an auxiliary
        history file through "add_default" calls are then excluded via FEXCL in
        the namelist.

      - Fix bug that corrupts high resolution runs:  promote "n" to I8 when
        doing n**4 and n**3 math in hdinti, hordif1, and phcs.

      - Correct the logic in the aerosol data interpolator as reported by 
        Jim Boyle on the CGD forum

      - make "jstrt_p" private in SCAN2 and REALLOC7 loops
  
      - bugfix for adiabatic restarts


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_27
Originator: mvr ( Mathew Rothstein) and mirin
Date: Thu Jan 20 16:16:39 MST 2005
Model: CAM
Version: CAM3.0.27
One-line Summary: Vectorization mods for finite volume; clarification of pgf90 optimization level
cam-bugs Requests resolved: none
Requires change in build system: yes
set pgf90 optimization explicitly to -O1; vectorization mods (see below)
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey, Linux-pgi, cray x1
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mirin, eaton
Restart files change: no
Changes answers: b4b except for fv on cray x1, ibm, and linux-pgi, which are 
round-off (pergro test passed on ibm)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

M models/atm/cam/bld/Makefile
M models/atm/cam/src/control/cam.F90
M models/atm/cam/src/control/spmdinit.F90
M models/atm/cam/src/dynamics/fv/cd_core.F90
M models/atm/cam/src/dynamics/fv/dp_coupling.F90
M models/atm/cam/src/dynamics/fv/dynamics_vars.F90
M models/atm/cam/src/dynamics/fv/dynpkg.F90
M models/atm/cam/src/dynamics/fv/fill_module.F90
M models/atm/cam/src/dynamics/fv/fv_prints.F90
M models/atm/cam/src/dynamics/fv/mapz_module.F90
M models/atm/cam/src/dynamics/fv/pft_module.F90
M models/atm/cam/src/dynamics/fv/spmd_dyn.F90
M models/atm/cam/src/dynamics/fv/stepon.F90
M models/atm/cam/src/dynamics/fv/sw_core.F90
M models/atm/cam/src/dynamics/fv/te_map.F90
M models/atm/cam/src/dynamics/fv/tp_core.F90
M models/atm/cam/src/physics/cam1/check_energy.F90
M models/atm/cam/src/physics/cam1/constituents.F90
M models/csm_share/shr/shr_msg_mod.F90
M models/utils/pilgrim/mod_comm.F90

please reference corresponding documentation in cam checkin list for details


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_26
Originator: mvr ( Mathew Rothstein) and eaton
Date: Tue Jan 18 13:58:51 MST 2005
Model: CAM
Version: CAM3.0.26
One-line Summary: Collection of bug fixes and enhancements for Cray X1
cam-bugs Requests resolved: none
Requires change in build system: yes
pgi fortran optimization set to O by default; Cray X1 mods; dependency cleanup
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: yes
removal of equivalences; bug fix for offline mode
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

M cam1/models/atm/cam/bld/Makefile
- changed default optimization of pgi fortran compiler to O from O2
- added Cray X1 mods and cleaned up some dependencies
M cam1/models/atm/cam/src/control/ccsm_msg.F90
- added mods for Cray X1 
M cam1/models/atm/cam/src/control/history.F90
- removed equivalences; removed addfld for unused var; added gregorian 
  calendar type to output; removed some unneeded date checking
M cam1/models/atm/cam/src/control/runtime_opts.F90
- added code required with removal of equivalence in history.F90;
  added phys_buffer mods
M cam1/models/atm/cam/src/dynamics/fv/dp_coupling.F90
- removed beglev from declaration of var ps
M cam1/models/atm/cam/src/dynamics/fv/fv_prints.F90
- fixed bug in write statements
M cam1/models/atm/cam/src/dynamics/fv/stepon.F90
- add call to shr_sys_flush
M cam1/models/atm/cam/src/physics/cam1/phys_buffer.F90
- added mods to physics buffer
M cam1/models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
- fixed bug in date comparison
M cam1/models/atm/cam/tools/scam/configure
- fixed bug with input file location for scam (created with cam3_0_25)
M cam1/models/lnd/clm2/src/main/areaMod.F90
- bug fix for offline mode
M cam1/models/lnd/clm2/src/main/histFileMod.F90
- removal of equivalences 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_25
Originator: jet ( John Truesdale)
Date: Mon Jan 10 16:43:43 MST 2005
Model: CAM
Version: CAM3.0.25
One-line Summary: Updated SCAM INSTALL text and added data directory to fix bug with scam configure script.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): no
Tested to work with SCAM (tools/scam/testscript): no
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: n/a
Tested multiple constituents: n/a
Tested that different domain decompositions match bit-for-bit: n/a
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  no this is a nontesting tag, only edited text files (INSTALL and REAME) no code
modified.

Changes made:

Added words to the INSTALL file for SCAM to let the user know to set the
CSMDATA environment variable.  Also added a directory under scam (/data).
The scam configure script assumes this directory exists and links all
scam data files here.  The previous release didn't have this directory.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_24
Originator: pworley ( Patrick H Worley)
Date: Thu Jan  6 11:20:57 MST 2005
Model: CAM
Version: CAM3.0.24
One-line Summary: reduced grid support for spectral dycores and miscellaneous bug fixes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no for full grid, yes (improved) for reduced grid
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: fixed reduced grid support in one routine
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Fixed support for reduced grid (Jim Rosinski):
  - control/readinitial.F90
  - physics/cam1/prescribed_aerosols.F90
  - dynamics/eul/initcom.F90
  - lnd/clm2/src/main/surfFileMod.F90

Additional reduced grid support modifications (for the X1
only?). Zeroing out unused locations in the FFT buffers is required
on the X1. 
  - dynamics/eul/linemsdyn.F90
  - dynamics/eul/spegrd.F90
  - dynamics/sld/spegrd.F90
  - dynamics/sld/scanslt.F90

Added new runtime option, dyn_equi_by_col, to improve performance of
spectral dycores when using reduced grid. When set to .true., it
attempts to allocate the same number of columns to each process in the
dynamics rather than the same number of latitude lines. For a full
grid, these goals are identical. The option is on by default. However,
it is not necessarily the best choice when using a reduced grid on a
vector system. Setting it to .false. executes the old code,
equidistributing the number of latitude lines whether using a full or
a reduced grid. 
 1) Moved decompinit out of cam, into readinitial.F90 and restart.F90,
    so that reduced grid option could be identifed before computing
    dynamics decomposition 
    - control/cam.F90
    - control/readinitial.F90
    - control/restart.F90
 2) Added dyn_equi_by_col runtime option
    - control/runtime_opts.F90
    - dynamics/eul/spmd_dyn.F90 
    - dynamics/sld/spmd_dyn.F90 
    - dynamics/fv/spmd_dyn.F90
 3) Added dyn_equi_by_col domain decomposition
    - dynamics/eul/spmd_dyn.F90
    - dynamics/sld/spmd_dyn.F90

The SLD dycore does not have all of the modifications made to EUL in
Jan.-March, 2004 to, for example, decrease memory requirements in the
spectral domain. The following files were modified as a step toward
implementing these changes. The motivation is that including these
changes allows the SLD version of spmd_dyn.F90 to be almost identical
to that used in EUL.
  - dynamics/sld/comspe.F90
  - dynamics/sld/scanslt.F90

The current Co-Array Fortran logic in CAM requires that the two
communication buffers allocated in the spectral dycores be the same
size. This is currently true when the number of processors divides the
latitudes, but not otherwise. Since this may  be important for other
one-sided messaging systems as well, the following files have been
modified  to require that all processes allocate the same size
communcation buffers. Note that this has no performance impact in
normal CAM usage (and probably never has an impact). 
  - control/mpishorthand.F
  - control/spmdinit.F90
  - control/wrap_mpi.F90
  - dynamics/eul/spmd_dyn.F90
  - dynamics/sld/spmd_dyn.F90

Reinsert compiler directive fixing Cray X1 bug that was lost in
a previous check-in 
  - control/history.F90

The routine sort_chunks is called in create_chunks and
orders the columns assigned to a chunk.
It was added to phys_grid.F90 back when we were looking for
alternatives to the buffer copies introduced into radcswmx.F90 for
vectorization. A bug in this code was recently identified. Rather than
fix it, we have decided that sort_chunks does nothing useful even when
working correctly. Thus the routine sort_chunks has been removed.

 - physics/cam1/phys_grid.F90

Miscellaneous bug fixes:

 1) A typo in the existing "equidistribute by latitudes"
    decomposition logic was fixed. Fortunately, this bug 
    was never seen in practice.

    - dynamics/eul/spmd_dyn.F90
    - dynamics/sld/spmd_dyn.F90
    

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_23
Originator: fvitt ( Francis Vitt)
Date: Tue Dec 21 10:13:50 MST 2004
Model: CAM
Version: CAM3.0.23
One-line Summary: Add ability to use offline data to drive finite volume dynamics core.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: yse
Requires OFFLINE_DYN C preprocessor flag to be set.
Substantial timing or memory changes: no 
Requires change in run script: yes
Namelist varibles are added. See below.
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Brian Eaton
Restart files change: yes
Offline data file names added to restart file.
Changes answers: no (bit-for-bit) 
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

Added files:
  models/atm/cam/src/dynamics/fv/metdata.F90
  models/atm/cam/src/dynamics/fv/pfixer.F90

Modified files:
  models/atm/cam/src/dynamics/fv/cd_core.F90
  models/atm/cam/src/dynamics/fv/dp_coupling.F90
  models/atm/cam/src/dynamics/fv/dryairm.F90
  models/atm/cam/src/dynamics/fv/dynpkg.F90
  models/atm/cam/src/dynamics/fv/inidat.F90
  models/atm/cam/src/dynamics/fv/restart_dynamics.F90
  models/atm/cam/src/dynamics/fv/stepon.F90
  models/atm/cam/src/dynamics/fv/sw_core.F90
  models/atm/cam/src/dynamics/fv/uv3s_update.F90
  models/atm/cam/src/physics/cam1/inti.F90
  models/atm/cam/src/physics/cam1/physpkg.F90
  models/atm/cam/src/control/runtime_opts.F90
  models/atm/cam/src/control/string_utils.F90

Modifications are effective only if CAM is configured to use
offline meteorology data.  To configure to use offline data 
set OFFLINE_DYN C preprocessor flag.

Namelist variables added: 

  met_data_file        The filepath of the netCDF file
                       containing the meteorology data
  
  met_cell_wall_winds  Set to true if the meteorology winds are
                       defined on model cell walls.
                       Default is false.
  
  met_remove_file      Set to true to have the offline data file be 
                       removed from the local file system.
                       Default is false.

The offline meteorology data can be read from a sequence of files
provided the files are named stringNNN.nc, where NNN is an integer
of any number of digits.  If the data is contained in a series of
files, the files need to be named sequentially, e.g., metdata001.nc,
metdata002.nc, metdata003.nc, etc.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_22
Originator: jeff ( Yen-Huei Lee)
Date: Fri Dec 10 10:20:33 MST 2004
Model: CAM
Version: CAM3.0.22
One-line Summary: add WACCM physics and chemistry
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Brian Eaton
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

Add two new direstories for WACCM:
   models/atm/cam/src/physics/waccm/
   models/atm/cam/src/chemistry/waccm_mozart/

Change the following files:
 A models/atm/cam/bld/config_cam_eul_defaults.xml
 A models/atm/cam/bld/config_cam_fv_defaults.xml
 A models/atm/cam/bld/config_cam_sld_defaults.xml
 A models/atm/cam/bld/config_waccm_ghg_defaults.xml
 A models/atm/cam/bld/config_waccm_mozart_defaults.xml
 D models/atm/cam/bld/config_cache_defaults.xml
 M models/atm/cam/bld/CAM_config.pmonfig.pm
 M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
 M models/atm/cam/bld/DefaultCLMEXPNamelist.xml
 M models/atm/cam/bld/camexp.pm
 M models/atm/cam/bld/clm2exp.pm
 M models/atm/cam/bld/configure
 M models/atm/cam/bld/resolution_parameters.xml
 M models/atm/cam/src/dynamics/eul/dp_coupling.F90
 M models/atm/cam/src/dynamics/eul/inital.F90
 M models/atm/cam/src/dynamics/eul/stepon.F90
 M models/atm/cam/src/dynamics/sld/dp_coupling.F90
 M models/atm/cam/src/dynamics/sld/inital.F90
 M models/atm/cam/src/dynamics/fv/dp_coupling.F90 
 M models/atm/cam/src/dynamics/fv/dycore.F90
 M models/atm/cam/src/dynamics/fv/dynamics_vars.F90
 M models/atm/cam/src/dynamics/fv/inital.F90
 D models/atm/cam/src/physics/cam1/ghg_surfvals.F90
 A models/atm/cam/src/physica/cam1/chem_surfvals.F90
 M models/atm/cam/src/physics/cam1/advnce.F90
 M models/atm/cam/src/physics/cam1/aerosol_intr.F90
 M models/atm/cam/src/physics/cam1/check_energy.F90
 M models/atm/cam/src/physics/cam1/chemistry.F90
 M models/atm/cam/src/physics/cam1/cloud_fraction.F90
 M models/atm/cam/src/physics/cam1/constituents.F90
 M models/atm/cam/src/physics/cam1/convect_deep.F90
 M models/atm/cam/src/physics/cam1/convect_shallow.F90 
 M models/atm/cam/src/physics/cam1/diagnostics.F90
 M models/atm/cam/src/physics/cam1/diffusion_solver.F90
 M models/atm/cam/src/physics/cam1/ghg_defaults.F90 
 M models/atm/cam/src/physics/cam1/gw_drag.F90 
 M models/atm/cam/src/physics/cam1/initindx.F90
 M models/atm/cam/src/physics/cam1/inti.F90
 M models/atm/cam/src/physics/cam1/molec_diff.F90
 M models/atm/cam/src/physics/cam1/physics_types.F90
 M models/atm/cam/src/physics/cam1/physpkg.F90
 M models/atm/cam/src/physics/cam1/qneg3.F90
 M models/atm/cam/src/physics/cam1/rad_constituents.F90
 M models/atm/cam/src/physics/cam1/radae.F90
 M models/atm/cam/src/physics/cam1/radheat.F90
 M models/atm/cam/src/physics/cam1/radiation.F90
 M models/atm/cam/src/physics/cam1/radlw.F90
 M models/atm/cam/src/physics/cam1/radsw.F90
 M models/atm/cam/src/physics/cam1/stratiform.F90
 M models/atm/cam/src/physics/cam1/sulfur_intr.F90
 M models/atm/cam/src/physics/cam1/tphysac.F90
 M models/atm/cam/src/physics/cam1/tphysbc.F90
 M models/atm/cam/src/physics/cam1/tracers.F90
 M models/atm/cam/src/physics/cam1/upper_bc.F90
 M models/atm/cam/src/physics/cam1/vertical_diffusion.F90
 M models/atm/cam/src/control/history.F90
 M models/atm/cam/src/control/restart.F90
 M models/atm/cam/src/control/runtime_opts.F90
 M models/atm/cam/src/control/time_manager.F90
 M models/atm/cam/tools/scam/scm_init/scam_inital.F90
 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_21
Originator: pworley ( Patrick H Worley)
Date: Mon Nov  1 07:40:57 MST 2004
Model: CAM
Version: CAM3.0.21
One-line Summary: Communication optimizations (MPI1, MPI2, Co-Array Fortran) for spectral dycores and dp_coupling; physics chunking bug fix.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes, improves performance on Earth Simulator when using MPI-2 one-sided option; may improve performance on Cray X1
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): no
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

1) Fixed bug in assign_chunks identified by Steve Ghan and Tim Shippert. This
   bug did not affect execution in the standard modes of operation.

2) Fixed UNICOS/MP Makefile option for cam3_0_20 changes.

3) Communication optimizations:

  - eliminated overlap implementations of realloc and dp_coupling
    communications. All that was being overlapped was buffer copies,
    which did not appear to be useful on the current target platforms.

  - added "alternative" implementations of alltoall and allgather
    (used in realloc routines and dp_coupling), using
    1) one of a large number of MPI-2 point-to-point commands,
       controlled by swap_comm_order, swap_comm_protocol, and
       swap_comm_maxreq. The first two parameters have the same
       meaning as before. swap_comm_maxreq controls the maximum number
       of outstanding send/receive requests allowed in the
       implementation of alltoall/allgather. This can be used to tune
       performance or work around bugs on systems that do
       not tolerate large numbers of outstanding requests well.
    2) MPI-2 put commands
    3) Co-Array Fortran remote writes

    #2 is important for performance on the Earth Simulator. The others
    represent defensive programming, for situations in which the MPI
    collectives are not implemented efficiently. #2 also seems to be
    fastest on the Cray X1, but I haven't not done a careful study yet.

  - To support the MPI-2 implementation, replaced original
    communication buffer logic
    * call spmdbuf in spmdinit_dyn to allocate communication buffers;
      call spmdbuf_resize in d_p_coupling or in p-d_coupling to
      reallocate communication buffers is they are not large enough
    with
     * call spmdbuf in inital or in restart, after phys_grid_init, to
       allocate communication buffers of the appropriate size the
       first time, then use MPI_WINCREATE to enable remote
       read/write from/to these buffers.

  - For the SLD dycore, added minor modifications originally
    introduced into the EUL dycore to improve vectorization. This
    makes realloc5, realloc5, and realloc7 almost identical between
    the EUL and SLD dycores again, and should improve vectorization
    for the SLD dycore.

  The new runtime options for dyn_alltoall, dyn_allgather, and
  phys_alltoall are:

  0: use collectives
  1: use MPI-2 point-to-point, as specified by swap_comm_order,
     swap_comm_protocol, swap_comm_maxreq. (swap_comm_maxreq default
     is -1, meaning no limit; >0 sets the upper bound)
  2: if compiled with -DMPI2, then use MPI-2 put implementation, else
     use an MPI_SENDRECV implementation
  3: if compiled with -DCAF, then use Co-Array remote write
     implementation, else use an MPI_SENDRECV implementation

  Files modified are as follows:

control/restart.F90
  added call to spmdbuf
control/runtime_opts.F90
  added swap_comm_maxreq parameter
control/swap_comm.F90
  added swapm, swap_comm_maxreq; 
  removed swap1, swap2, swap3, swap1m, swap3m, do_swap1, do_swap3,
   delayed_swap_recv  
control/wrap_mpi.F90
  added mpialltoallint, altalltoallv, mpiwincreate
eul/dp_coupling.F90, sld/dp_coupling.F90
  added MPI2 window parameter to transpose call;
  replaced spmdbuf_resize call with an spmdbuf_size test
eul/inital.F90, sld/inital.F90
  added smpdbuf call
eul/realloc4.F90, sld/realloc4.F90
  added altalltoall, removed swap routine calls
eul/realloc7.F90, sld/realloc7.F90, eul/scan2.F90, sld/scan2.F90
  added altalltoall, removed swap routine calls
eul/spmd_dyn.F90, sld/spmd_dyn.F90
  removed spmdbuf_resize and modified spmdbuf;
  moved local_dp_map, block_buf_nrecs, and chunk_buf_nrecs from phys_grid;
  added support for MPI2 and CAF.
fv/dp_coupling.F90
  side effect of moving local_dp_map, block_buf_nrecs, and
   chunk_buf_nrecs from phys_grid to spmd_dyn
fv/spmd_dyn.F90
  moved local_dp_map, block_buf_nrecs, and chunk_buf_nrecs from phys_grid
sld/comspe.F90, scanslt.F90, spegrd.F90, trunc.F90
  vectorization modifications ported from EUL
physics/cam1/phys_grid.F90
  added altalltoall, removed swap routine calls
  fixed assign_chunk bug.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_20
Originator: jmccaa ( James McCaa)
Date: Mon Oct 18 11:58:59 MDT 2004
Model: CAM
Version: CAM3.0.20
One-line Summary: Refactored vertical diffusion module.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Brian Eaton
Restart files change: no
Changes answers: Yes (same-to-roundoff)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Refactored the vertical diffusion module:
 - new interface names
 - new molecular diffusion module
 - new turbulent mountain stress module
 - new eddy diffusion module
 - new diffusion solver module
 - removed turbulence module
 
Cleaned up unused variables from interfaces to convect_deep, 
convect_shallow, cloud_fraction, stratiform modules. 

Added a T42 30-level ic file to the CAM defaults file.

Added a function form of vqsatd to the wv_saturation module.

Assorted small fixed to scam, plus modified the scam 
configure and test scripts to allow running from a working 
directory outside the distribution.

Files added/deleted/modified:
M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
M models/atm/cam/doc/ChangeLog
M models/atm/cam/src/physics/cam1/advnce.F90
M models/atm/cam/src/physics/cam1/cloud_fraction.F90
M models/atm/cam/src/physics/cam1/convect_deep.F90
M models/atm/cam/src/physics/cam1/convect_shallow.F90
A models/atm/cam/src/physics/cam1/diffusion_solver.F90
A models/atm/cam/src/physics/cam1/hb_diff.F90
M models/atm/cam/src/physics/cam1/initindx.F90
M models/atm/cam/src/physics/cam1/inti.F90
A models/atm/cam/src/physics/cam1/molec_diff.F90
M models/atm/cam/src/physics/cam1/physconst.F90
M models/atm/cam/src/physics/cam1/stratiform.F90
M models/atm/cam/src/physics/cam1/tphysac.F90
M models/atm/cam/src/physics/cam1/tphysbc.F90
M models/atm/cam/src/physics/cam1/tphysidl.F90
A models/atm/cam/src/physics/cam1/trb_mtn_stress.F90
R models/atm/cam/src/physics/cam1/turbulence.F90
M models/atm/cam/src/physics/cam1/upper_bc.F90
M models/atm/cam/src/physics/cam1/vertical_diffusion.F90
M models/atm/cam/src/physics/cam1/wv_saturation.F90
M models/atm/cam/tools/scam/GNUmakefile
M models/atm/cam/tools/scam/configure
M models/atm/cam/tools/scam/testscript
M models/atm/cam/tools/scam/obj/Makefile
M models/atm/cam/tools/scam/scm_init/c_outfld.c
M models/atm/cam/tools/scam/scm_init/init_model.F90
M models/atm/cam/tools/scam/scm_init/scam.c
M models/atm/cam/tools/scam/ui/GNUmakefile
M models/atm/cam/tools/scam/ui/configure
M models/atm/cam/tools/scam/ui/ncfile.h

===============================================================
===============================================================

cam3_0_19
Originator: erik ( Erik Kluzek)
Date: Thu Sep 23 11:49:07 MDT 2004
Model: CAM
Version: CAM3.0.19
One-line Summary: Isolate extended grid information to just spectral dycores and just inside of SLT advection inside SLD and Eul dycores.
cam-bugs Requests resolved: 147
(See http://wreq.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: see below
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton, olson, mvr
Restart files change: yes (Eul and SLD)
Changes answers: bit-for-bit with Eul and FV dycores
		 same to roundoff for SLD dycore (on IBM and Linux/Lahey,
		 answers identical if you run with -debug compiler options)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Move cam3_0_18_brnchT_nohalo9 to cam_dev.

	Isolate extended grid information to SLT advection to only
	within Spectral dy-cores.

Use plon(regular grid) instead of plond(extended grid) except for 
SLT variables, inside of relevent dynamics.

Eulerian:

  scanslt becomes a module with alloc, initial, run and final phases.

  Remove comslt and move data to inside of scanslt or scan2.

  scanslt has a advection_state data-type to keep track of all extended 
  grid information. All data on the extended grid are kept inside of this 
  state. Dynamics data iscopied into and then out of this state for advection.

  New dimension for FFT -- plondfft.
       
  spetru has new temporary variables inside of it so it can be dimensioned 
  the right size for FFT (plondfft).

  linemsdyn becomes a module and scan2 becomes a module

  Make grdini, grdxy, sltb1, and sltini module subroutines of scanslt.

SLD:
  scanslt becomes a module with: alloc, initial, run_setup, run, and 
  final phases. Extended grid parameters moved from pmgrid and rgrid to
  inside of this module. Much of the data becomes private inside of 
  scanslt module. Create advection_state data type to keep track of all 
  extended grid data, copy data into this structure and then out of
  for the rest of the dynamics

  comslt removed and data moved to inside of scanslt. grmult becomes a module.
  Use inf instead of nan for initialization.

  Spmd_dyn data only used for bndexch moved as private data inside of scanslt.

  Make bndexch, grdini, grdxy, sltlinint, slttraj, sltwgts, and trajdp 
  module subroutines of scanslt.

test-model.pl

	Fix problem where couldn't change resolution on comand line
	with -skip option (cam-bug 147).

	Add -cppdefs option

	Restart tests done at default compiler option rather than explicitly
	set to production compiler settings. This allows the use of the "-debug"
	option to override the default setting for testing where this is
	useful.

SCAM:
	Improve readability of testscript, send output to log files
	and have the script clean up after itself better. Use plon instead
	of plond.

Performance changes: (Following tests were done with earlier versions
		      on no-halo branch based off of cam3_0_9 for eul and 
		      cam3_0_15 for sld test)
	Eul@T42 on IBM same
	Eul@T85 on IBM with 11 constituents 3% slower
	Sld@T42 on IBM 2% faster

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_18
Originator: mvr ( Mathew Rothstein), eaton, mirin
Date: Fri Sep 17 11:01:58 MDT 2004
Model: CAM
Version: CAM3.0.18
One-line Summary: A collection of bug fixes and portability enhancements
cam-bugs Requests resolved: none
Requires change in build system: yes
Makefile changed for pgi compile defaults
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: yes
mss system calls now go through csm_share code
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

M models/atm/cam/bld/Makefile
- mods to pgi compiler defaults: -O2 optimization (non-debug), -Mrecursive
  only in debug mode
- mod to ifort name for intel builds
M models/atm/cam/src/control/abortutils.F90
- fix for ibm jobs hanging in xl__trbk routine
M models/atm/cam/src/control/ccsm_msg.F90
- fix for ccsm with FV 2D composition
M models/atm/cam/src/control/ioFileMod.F90
- now calls csm_share code for mss system calls
M models/atm/cam/src/control/runtime_opts.F90
- fix to properly communicate the input vars kmxhdc, dif2, dif4
R models/atm/cam/src/control/system_cmd.c
- no longer needed - now using csm_share code
M models/atm/cam/src/physics/cam1/cldwat.F90
- fix for non-default vertical resolution extending top of model above 1mb
M models/atm/cam/src/physics/cam1/phys_grid.F90
- corrected routine argument from intent out to intent in
M models/atm/cam/test/system/CAM_test.pm
- bug fix for "-skip" options in test-model
M models/ice/csim4/ice_data.F90
- fixed out of bounds array reference
M models/lnd/clm2/src/main/fileutils.F90
- now call csm_share code for mss system calls
R models/lnd/clm2/src/main/system_cmd.c
- no longer needed - now using csm_share code

M models/utils/esmf/README
M models/utils/esmf/build/common
A models/utils/esmf/build/Darwin_absoft/ESMF_conf.h
A models/utils/esmf/build/Darwin_absoft/base
A models/utils/esmf/build/Darwin_absoft/base.site
A models/utils/esmf/build/Darwin_absoft/base_variables
A models/utils/esmf/build/Darwin_absoft/fix.h
A models/utils/esmf/build/Darwin_xlf/ESMF_conf.h
A models/utils/esmf/build/Darwin_xlf/base
A models/utils/esmf/build/Darwin_xlf/base.site
A models/utils/esmf/build/Darwin_xlf/base_variables
M models/utils/esmf/src/Infrastructure/Error/ESMC_Error.c
M models/utils/esmf/src/Infrastructure/TimeMgmt/ESMC_Alarm.c
M models/utils/esmf/src/Infrastructure/TimeMgmt/ESMC_Calendar.c
M models/utils/esmf/src/Infrastructure/TimeMgmt/ESMC_Date.c
M models/utils/esmf/src/Infrastructure/TimeMgmt/ESMC_TOD.c
M models/utils/esmf/src/Infrastructure/TimeMgmt/ESMC_Time.c
- upgrade to esmf_0_0_8

M models/utils/timing/t_pclstr.c
M models/utils/timing/t_stop.c


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_17
Originator: jeff ( Yen-Huei Lee)
Date: Mon Sep 13 14:41:57 MDT 2004
Model: CAM
Version: CAM3.0.17
One-line Summary: bug fix
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

	Add one file

        A models/atm/cam/src/physics/cam1/upper_bc.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_16
Originator: jeff ( Yen-Huei Lee)
Date: Mon Sep 13 13:22:44 MDT 2004
Model: CAM
Version: CAM3.0.16
One-line Summary: modified vertical diffusion
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Tested to work with SCAM (tools/scam/testscript): yes
Machines tested: IBM, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

	Modified the following files:
        M models/atm/cam/src/physics/cam1/vertical_diffusion.F90
        M models/atm/cam/src/physics/cam1/tphysac.F90
        M models/atm/cam/src/physics/cam1/rad_constituents.F90
        M models/atm/cam/src/physics/cam1/ghg_defaults.F90
        M models/atm/cam/src/physics/cam1/constitueadvnce.F90
	M models/atm/cam/src/physics/cam1/advnce.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_15
Originator: eaton ( Brian Eaton)
Date: Thu Sep  2 08:14:58 MDT 2004
Model: CAM
Version: CAM3.0.15
One-line Summary: new radiation/constituents interface
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, boville, conley
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Create an new radiation/constituent interface.  This functionality (for gas
phase constituents) previously resided in the chemistry module.  It has
been reimplemented in it's own module (rad_constituents.F90) to facilitate
swapping in new chemistry code without having to duplicate the control
logic in another chemistry module.  Also, the new module can be extended to
coordinate control of the aerosol constituents.

Modified the constituents module:
1) Add an optional argument to cnst_add to allow specifying that the
   default outfld calls for that constituent should not be made.  This
   allows, for example, the chemistry module to output volume mixing
   ratios rather than the default mass mixing ratios.
2) Add an optional argument to cnst_get_ind to allow it to return an error
   status rather than just aborting if the requested name is not found in
   the constituent array.

Add a bugfix to cldwat.F90.  Some variables needed initializers.  Only
caused a problem if the top of the model was above 1mb.

Create a new module (ghg_defaults.F90) for the default ghg distributions
computed by trcmix.

Added lat and lon (radians) to the physics_state data type.

Add a method to the ozone_data module to return a pointer to the
interpolated data.

Returned the chemistry module to its previous functionality of just
providing prognostic ghg distributions using a simple production/loss
chemistry.


===============================================================
===============================================================

cam3_0_14
Originator: jmccaa ( James Mccaa)
Date: Wed Aug 25 19:58:09 MDT 2004
Model: CAM
Version: CAM3.0.14
One-line Summary: Introduction of definehires utility and use of 30 second topographic variance (SGH30)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

This checkin introduces a new utility, definehires, that can be used to process
USGS 30 second topographic data and produce a 10-minute dataset suitable for 
use with definesurf.
It is located in the directory:
cam1/models/atm/cam/tools/definehires/README

The following files were modified to accomodate a new input dataset
      field (SGH30) that represents the variance of the 30-second
      height data on the 10-minute grid.  This supplements the field
      SGH, which represents the variance of the 10-minute mean heights
      on the model grid.  Both definesurf and CAM can still use the
      old datasets with no change in answers from the current code.
      In the case of CAM, if SGH30 is not present, the model will use
      SGH in its place (as it currently does), but SGH30 will be used
      if found.
>> cam1/models/atm/cam/src/dynamics/eul/inidat.F90
>> cam1/models/atm/cam/src/dynamics/sld/inidat.F90
>> cam1/models/atm/cam/src/dynamics/fv/inidat.F90
>> cam1/models/atm/cam/src/physics/cam1/comsrf.F90
>> cam1/models/atm/cam/src/physics/cam1/diagnostics.F90
>> cam1/models/atm/cam/src/physics/cam1/physpkg.F90
>> cam1/models/atm/cam/src/physics/cam1/restart_physics.F90
>> cam1/models/atm/cam/src/physics/cam1/tphysac.F90
>> cam1/models/atm/cam/src/control/history.F90
>> cam1/models/atm/cam/tools/definesurf/Makefile
>> cam1/models/atm/cam/tools/definesurf/fmain.f90
>> cam1/models/atm/cam/tools/definesurf/sghphis.f90


===============================================================
===============================================================

cam3_0_13
Originator: eaton ( Brian Eaton)
Date: Tue Aug 24 15:28:21 MDT 2004
Model: CAM
Version: CAM3.0.13
One-line Summary: add single interface for radiation to access trace gases
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes, same-to-roundoff
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The non-water gas phase constituents that are required by the radiation
codes are O3, CO2, CH4, N2O, CFC11, CFC12.  All these constituents, except
CO2, are now accessed only via the chemistry module.  A single method,
chem_get_cnst, returns constituent values regardless of whether they are
prognostic variables from the constituent array, or are diagnosed or
interpolated from a dataset.  So all the logic for determining where a
constituent comes from now lives in the top level chemistry interface and
not in the top level radiation interface.

CO2 is a special case because it is assumed by the radiation algorithms to
be a single global value.  For now it is still accessed directly from the
ghg_surfvals module.  We expect this to change in the future.

These changes are roundoff due to the decision that chem_get_cnst should
return values as mass mixing ratio.  Previously O3 values were accessed
from the interpolation routine as volume mixing ratio and converted to
mass mixing ratio as needed.  The change in where this conversion happens
introduced a roundoff level difference.


===============================================================
===============================================================

cam3_0_12
Originator: jmccaa ( James McCaa)
Date: Thu Aug 19 09:06:13 MDT 2004
Model: CAM
Version: CAM3.0.12
One-line Summary: Addition of a column radiation model and various fixes to SCAM.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

This checkin adds a column radiation model to the SCAM, and also
contains a variety of general fixes/enhancements to SCAM, mostly
centered around allowing it to work with nonstandard numbers of model
levels. Details follow...


Addition of the column radiation model:
---------------------------------------

The CRM can operate on old-style text CRM input files, or on a model
state initialized via any of scam's existing methods.

The CRM has both non-gui and gui modes.  The gui version is accessed
via a new page under scam's "Options" tab.  The non-gui version is
accessed via a shell script named crm.

I modified testscript to test the crm.
The following output from the test script indicates a pass (both lines
must be present):

scam passed its bfb test.
CRM passed.


General scam modifications:
---------------------------

Scam now honors the use_srfprop flag.

To facilitate running at nonstandard numbers of levels:
  scam now guesses the appropriate level-dependent pressure file to use.
  ncdio_atm.F90 has been modified to interpolate/extrapolate data to
    the scam levels if necessary.

Handling of defaults files and quickstart files is slightly more robust.

Scam now plots interface level fields correctly.

Buffer sizes have been increased to allow scam to use up to 300 levels.

The gui's configure script has been modified to remove an unnecessary
dependency on libg2c when not using ncar graphics

I fixed an unitialized value problem in readiopdata.F90.

I modified init_model.F90 to handle C-to-fortran string passing
according to the unix standard.

I modified the scam testscript to retry (up to 10 times) on
compilation failures to try to overcome our persisent license server
problems. 

I added a sanity check on precab(i) to cldwat.F90.

Updated init_model.F90 to reference ozone_data.F90 instead of comozp.F90.

Lastly, I removed 7 Mb of apparently unneeded ncar graphics files from
the repository.

===============================================================
===============================================================

cam3_0_11
Originator: eaton ( Brian Eaton)
Date: Fri Aug 13 12:06:12 MDT 2004
Model: CAM
Version: CAM3.0.11
One-line Summary: add fv 1.9x2.5 resolution; sst dataset generation tools
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Add 1.9x2.5 (96 lats, 144 lons) resolution for finite volume.  Configure
using:
        configure -dyn fv -res 1.9x2.5

Add sst dataset generation tools from Jim Rosinski.


===============================================================
===============================================================

cam3_0_10
Originator: eaton ( Brian Eaton)
Date: Mon Aug  9 12:11:12 MDT 2004
Model: CAM
Version: CAM3.0.10
One-line Summary: add new modules for radiation and ozone data
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

. Created modules for ozone datasets (ozone_data.F90), longwave radiation
  (radlw.F90), and shortwave radiation (radsw.F90).

  The old radini which initialized the old common block crdcon contained a
  couple of constants which differed from the share constants.  In order to
  have a bit-for-bit commit the old values have been maintained.

. Add pointer variables inside radiation_tend to provide flexible method of
  passing either prescribed or prognostic constituents to the radiation
  calcs.

. Removed the common block ptrrgrid.h which was not being used.

. Added some FV 10x15 datasets to the Default*Namelist.xml files.

. Added back 13 files that were lost during the cam3_0_9 commit.

===============================================================
===============================================================

cam3_0_9
Originator: rosinski ( Jim Rosinski)
Date: Sun Jul 25 14:14:34 MDT 2004
Model: CAM
Version: CAM3.0.9
One-line Summary: Enable CAM to build and run using Intel compiler suite
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): no
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, CLM changes by Vertenstein
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

CVS says:

M atm/cam/bld/Makefile
M lnd/clm2/src/biogeophys/Hydrology2Mod.F90
M lnd/clm2/src/main/decompMod.F90
M lnd/clm2/src/main/histFileMod.F90
A utils/esmf/build/linux_altix/ESMF_conf.h
A utils/esmf/build/linux_altix/base
A utils/esmf/build/linux_altix/base.site
A utils/esmf/build/linux_altix/base_variables
A utils/esmf/build/linux_altix/fix.h
A utils/esmf/build/linux_intel/ESMF_conf.h
A utils/esmf/build/linux_intel/base
A utils/esmf/build/linux_intel/base.site
A utils/esmf/build/linux_intel/base_variables
A utils/esmf/build/linux_intel/fix.h
M utils/timing/t_pr.c

Minor mods (listed above) to CAM Makefile, timing print routine, CLM
routines, and ESMF to enable CAM to build and run on Linux machines using
Intel compiler suite.  2-day error growth test using ifort and icc passed at
T42 in EUL configuration.

ESMF upgraded to ESMF_0_0_6 per Erik Kluzek.  No code changes, but support
added for linux_intel and linux_altix.  Note that linux_intel assumes that
Fortran and C compilers are both Intel (ifort and icc respectively).  Though
CAM can be configured (and will run) with gcc, there is little point in doing
this as of this commit since ESMF will still require icc.

Minor mods to CLM routines to allow compilation with ifort.

Addition of an "fclose" to timing print routine t_pr.c to force a buffer
flush.  Without it icc was truncating its printed output of model timers.


IMPORTANT: the only configurations of Intel compiler suite and underlying
glibc library that proved successful were:

ifort >= 8.0.046
icc >= 8.0.055
glibc >= 2.3.x

Tests in which not all these conditions were met resulted in various
failures, including general compiler errors, internal compiler errors, and
segmentation faults.

Notes:

o In general the Intel compilers create code that runs fast.  Compile times
for optimized code (-O2) can be fairly long.

o The debugger (idb) is line-based.  Hopefully it can be used in conjunction
with ddd to give a window-based option.

o Hybrid OpenMP/MPI configuration with Intel compilers was tested and does
work.  Little timing difference compared with pure-MPI was observed.
Depending on model conifiguration, manipulation of environment variable
KMP_STACKSIZE may be required to avoid seg faults when threading is enabled. 

o Tests enabling floating point traps (-fpe0) did not work in SPMD mode, so
this option was not included in Makefile mods.  Hopefully the code changes
required to enable this option will be minor.
	

===============================================================
===============================================================

cam3_0_8
Originator: jeff ( Yen-Huei Lee)
Date: Wed Jul 21 11:53:53 MDT 2004
Model: CAM
Version: CAM3.0.8
One-line Summary: ntoplw changes to radiation arrays
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)no
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)no
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

	M models/atm/cam/src/physics/cam1/crdcon.h
        M models/atm/cam/src/physics/cam1/radae.F90
        M models/atm/cam/src/physics/cam1/radclwmx.F90
        M models/atm/cam/src/physics/cam1/radini.F90
        M models/atm/cam/src/physics/cam1/restart_physics.F90
        M models/atm/cam/src/physics/cam1/trcplk.F90
        M models/atm/cam/src/physics/cam1/trcpth.F90
	
See: 	http://www.cgd.ucar.edu/cgi-binradae.F90/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_7
Originator: mvr ( Mathew Rothstein), eaton, bundy
Date: Tue Jul 20 10:03:47 MDT 2004
Model: CAM
Version: CAM3.0.7
One-line Summary: Added new physics interface (deep & shallow convection, stratiform, radiation)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: to be determined
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton, bundy
Restart files change: no
Changes answers: Yes (same-to-roundoff)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

R models/atm/cam/src/physics/cam1/cldcond.F90
R models/atm/cam/src/physics/cam1/cldnrh.F90
R models/atm/cam/src/physics/cam1/convtran.F90
R models/atm/cam/src/physics/cam1/moistconvection.F90
R models/atm/cam/src/physics/cam1/radctl.F90
A models/atm/cam/src/physics/cam1/convect_deep.F90
A models/atm/cam/src/physics/cam1/convect_shallow.F90
A models/atm/cam/src/physics/cam1/hk_conv.F90
A models/atm/cam/src/physics/cam1/radiation.F90
A models/atm/cam/src/physics/cam1/stratiform.F90
M models/atm/cam/src/control/history.F90
M models/atm/cam/src/dynamics/eul/inidat.F90
M models/atm/cam/src/dynamics/fv/inidat.F90
M models/atm/cam/src/dynamics/sld/inidat.F90
M models/atm/cam/src/physics/cam1/aerosol_intr.F90
M models/atm/cam/src/physics/cam1/buffer.F90
M models/atm/cam/src/physics/cam1/carbon_intr.F90
M models/atm/cam/src/physics/cam1/diagnostics.F90
M models/atm/cam/src/physics/cam1/dust_intr.F90
M models/atm/cam/src/physics/cam1/initindx.F90
M models/atm/cam/src/physics/cam1/inti.F90
M models/atm/cam/src/physics/cam1/param_cldoptics.F90
M models/atm/cam/src/physics/cam1/phys_adiabatic.F90
M models/atm/cam/src/physics/cam1/phys_idealized.F90
M models/atm/cam/src/physics/cam1/physics_types.F90
M models/atm/cam/src/physics/cam1/physpkg.F90
M models/atm/cam/src/physics/cam1/restart_physics.F90
M models/atm/cam/src/physics/cam1/srfxfer.F90
M models/atm/cam/src/physics/cam1/sulfur_intr.F90
M models/atm/cam/src/physics/cam1/tphysbc.F90
M models/atm/cam/src/physics/cam1/zm_conv.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_6
Originator: mvr ( Mathew Rothstein)
Date: Fri Jul 16 16:54:46 MDT 2004
Model: CAM
Version: CAM3.0.6
One-line Summary: Added SOM tools; Modified CLM log output to version 3.0; Bug fix for system command strings
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: yes...updated log output to version 3.0
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

---added files needed to create SOM tools
A models/atm/cam/tools/definemld/Makefile
A models/atm/cam/tools/definemld/README
A models/atm/cam/tools/definemld/binf2c.f90
A models/atm/cam/tools/definemld/definemld1x1.c
A models/atm/cam/tools/definemld/definemld1x1.h
A models/atm/cam/tools/definemld/definemldbdy.f90
A models/atm/cam/tools/definemld/err_exit.c
A models/atm/cam/tools/definemld/neighborfill.f90
A models/atm/cam/tools/definemld/precision.f90
A models/atm/cam/tools/definemld/sm121.f90
A models/atm/cam/tools/definemld/wrap_nc.c
A models/atm/cam/tools/definemld/wrap_nf.f90
A models/atm/cam/tools/defineqflux/Makefile
A models/atm/cam/tools/defineqflux/README
A models/atm/cam/tools/defineqflux/backsolve.c
A models/atm/cam/tools/defineqflux/check_consistent.c
A models/atm/cam/tools/defineqflux/defineqflux.c
A models/atm/cam/tools/defineqflux/defineqflux.h
A models/atm/cam/tools/defineqflux/definesomic.h
A models/atm/cam/tools/defineqflux/err_exit.c
A models/atm/cam/tools/defineqflux/gepp.c
A models/atm/cam/tools/defineqflux/mksith.c
A models/atm/cam/tools/defineqflux/printeq.c
A models/atm/cam/tools/defineqflux/timediddle_mavg.c
A models/atm/cam/tools/defineqflux/wrap_nc.c

M models/lnd/clm2/src/main/initializeMod.F90
 - updated log output to version 3.0
M models/atm/cam/src/control/system_cmd.c
 - bug fix for handling of system command strings

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_5
Originator: jet ( John Truesdale)
Date: Thu Jun 24 13:17:43 MDT 2004
Model: CAM
Version: CAM3.0.5
One-line Summary: Updated SCAM files to match cam3.0 distribution
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no
(one-line description of changes: mostly documentation)
(Detailed description below)
Tested to work coupled with CCSM (create_ccsmcam): no
Machines tested: none
Ran test-model.pl script: no
Tested on fv dynamics: na
Tested on eul dynamics:na
Tested on sld dynamics:na
Tested that restarts are bit-for-bit: na
Tested multiple constituents: na
Tested that different domain decompositions match bit-for-bit: na
Tested in adiabatic mode: na
Code reviewed by: myself
Restart files change: no
Changes answers: no 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM
CRB?  yes
	
Changes made:

Added data directory and README file
deleted duplicate INSTALL and scam.html file in html directory
updated userguide.html
corrected but in testscript
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_4
Originator: mvr ( Mathew Rothstein), truesdale, vertenstein
Date: Mon Jun 21 10:19:32 MDT 2004
Model: CAM
Version: CAM3.0.4
One-line Summary: Cleanup of default settings of CAM/CLM input datasets; SCAM updated; Fixed two CLM bugs
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, truesdale, vertenstein
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: yes
fixed bug in code to exclude fields from history tape; fixed bug in code that 
generates land surface datasets for fv
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

R models/atm/cam/tools/scam/scm_init/scam_rpc.h
A models/atm/cam/tools/scam/testscript
  - new validation test script
M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
  - modified entry for fv2x2.5 input dataset, removed references to linked 
    files, modified some comments
M models/atm/cam/bld/DefaultCLMEXPNamelist.xml
  - new entry for fv2x2.5 input dataset, modified some comments 
M models/atm/cam/tools/scam/.scam_defaults
M models/atm/cam/tools/scam/configure
M models/atm/cam/tools/scam/ui/configure
M models/atm/cam/tools/scam/ui/manager.cpp
M models/lnd/clm2/src/main/histFileMod.F90
  - fixed bug in code that allows user to exclude fields from primary 
    history tape
M models/lnd/clm2/src/mksrfdata/mksrfdatMod.F90
  - fixed bug in generation of land surface datasets for fv


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_3
Originator: olson ( Jerry Olson)
Date: Thu Jun 17 14:33:44 MDT 2004
Model: CAM
Version: CAM3.0.3
One-line Summary: new initial conditions input/output
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton
Restart files change: no
Changes answers: no (bit-for-bit) except:
	         a) answers change in aqua-planet mode for all dycores
	            (new climate)
	         b) round-off for SLD on IBMs
Changes to CLM land-model: yes.  trivial mods to comments
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:


--------------

   Description of changes:

 - The history.F90 module is modified to include the Initial Conditions file as
   part of the general history file build process.  Details:

     - the IC file is formatted exactly like a history file.
     - just as in other history files, the IC file is filled via calls to
       "outfld".
     - no time averaging;  fields are always instantaneous
     - only one time sample written to file
     - accumulation/output is in double precision
     - "ptapes" increased from 6 to 7
     - IC file is indexed "mtapes" in the history module (always at end of
       active history file list)
     - name of file includes ".i." rather than ".hX."

     - two namelist parameters control the building of the IC file:

           - INITHIST:  controls frequency of IC file writes (for both land and
                        atmosphere):  '6-HOURLY, 'DAILY', 'MONTHLY', 'YEARLY' or
                        'NONE'
           - INITHIST_ALL:  .false.:  dump ONLY required fields to IC file
                            .true. :  dump required AND optional fields to IC
                                      file (DEFAULT)
     - setting "EMPTY_HTAPES = .true." does NOT prevent the IC file from being
       created.
     - only setting INITHIST = 'NONE' prevents the IC file from being created.
     - no space allocated on history buffer if INITHIST = 'NONE'
     - the old IC file build routine, "write_inithist" is removed

     - Note: - In an Eulerian run, the new code does not produce identical IC
	       files as the old code.  The values for QCWAT, TCWAT, LCWAT, and
               CLD will be different.

             - In adiabatic mode, the FV dycore *still* does not create an IC
               file with the proper temperature on it.  In adiabatic mode, FV
               does not update temperature.  Therefore, the IC file will
               contain the wrong temperature.

 - History (and IC) fieldnames can be up to 16 characters long

 - inidat.F90 re-written for all dycores.  All fields are now read and processed
   one at a time, reducing memory costs.  All reads are done via a call to a
   single netCDF interface (modified version of module written for the Land
   Model by Mariana Vertenstein).

 - inidat.F90 is backward compatible with OLD IC files.

 - EUL and SLD spetru.F90 modules modified to be identical to eachother

 - another new namelist variable:  

    RAD_FIRST_HOUR:  Flag to force model to compute full radiation every
                     timestep in the first model hour (for use in
                     "forecast/analysis" runs)
	             Default:  .false.

 - restart files will change (because of extra characters for each field)

 - Removed code associated with HADVTEST and VADVTEST cpp tokens ("blob" test)

 - Bugfixes in aqua-planet mode:

     - the field "landm" is now set to 0.  Changes answers; new climate for
       aqua-planet.
     - fixed bug in analytical SST specification (in a branch of code not run
                                                  by default model)
 - Bugfix to test-model.pm provided by Erik.


--------------

   Files modified:

 M models/atm/cam/bld/CAM_run.pm
    - Bugfix provided by Erik
 M models/atm/cam/src/control/comctl.h
    - added namelist variable, "rad_first_hour"
 M models/atm/cam/src/control/filenames.F90
    - deleted old IC file logic
 M models/atm/cam/src/control/history.F90
    - extensive changes to add IC file as
      part of the history file set (ptapes = 7)
    - history file field names can be up to
      16 characters long
 M models/atm/cam/src/control/readinitial.F90
    - added logic to trap possible model and IC file inconsistencies in the
      grid/spectral resolutions
 M models/atm/cam/src/control/runtime_opts.F90
    - added new namelist variables
 M models/atm/cam/src/dynamics/eul/dyndrv.F90
    - removed blob test code
 M models/atm/cam/src/dynamics/eul/grmult.F90
    - removed blob test code
 M models/atm/cam/src/dynamics/eul/inidat.F90
    - cleanup
 M models/atm/cam/src/dynamics/eul/linemsdyn.F90
    - removed blob test code
 M models/atm/cam/src/dynamics/eul/spetru.F90
    - modified so that "eul" and "sld" spetru routines are identical
 M models/atm/cam/src/dynamics/eul/stepon.F90
    - removed logic associated with old IC file code
    - added call to dump state field values to IC file buffer
 M models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
    - removed blob test code
    - fix to qneg3 diagnostic print
 M models/atm/cam/src/dynamics/fv/inidat.F90
    - cleanup
 M models/atm/cam/src/dynamics/fv/inital.F90
    - modified a "use" statement
 M models/atm/cam/src/dynamics/fv/stepon.F90
    - removed logic associated with old IC file code
    - added call to dump state fields to IC file buffer
 M models/atm/cam/src/dynamics/sld/dyndrv.F90
    - removed blob test code
 M models/atm/cam/src/dynamics/sld/grmult.F90
    - removed blob test code
 M models/atm/cam/src/dynamics/sld/inidat.F90
    - cleanup
 M models/atm/cam/src/dynamics/sld/restart_dynamics.F90
    - removed unused fields from restart file
 M models/atm/cam/src/dynamics/sld/scan2.F90
    - removed logic associated with old IC file code
 M models/atm/cam/src/dynamics/sld/scanslt.F90
    - removed blob test code
 M models/atm/cam/src/dynamics/sld/sltwgts.F90
    - removed blob test code
 M models/atm/cam/src/dynamics/sld/spetru.F90
    - modified so that "eul" and "sld" spetru routines are identical
 M models/atm/cam/src/dynamics/sld/stepon.F90
    - added call to dump state fields to IC file buffer
 M models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
    - removed blob test code
    - fixed diagnostics bug in qneg3
 M models/atm/cam/src/ocnsice/dom/sst_data.F90
    - fixed bug in analytical SST specification (used in "aqua-planet" mode)
 M models/atm/cam/src/physics/cam1/advnce.F90
    - Do full radiation every timestep of first model hour if "rad_first_hour"
      is .true.
 M models/atm/cam/src/physics/cam1/diagnostics.F90
    - add routine to dump physics fields to IC file buffer
 M models/atm/cam/src/physics/cam1/phys_adiabatic.F90
    - cleanup
 M models/atm/cam/src/physics/cam1/physics_types.F90
    - fix to qneg3 diagnostic print
 M models/atm/cam/src/physics/cam1/phys_idealized.F90
    - cleanup
 M models/atm/cam/src/physics/cam1/physpkg.F90
    - call routine to dump physics fields to IC file buffer
 M models/atm/cam/src/physics/cam1/qneg3.F90
    - fix to qneg3 diagnostic print
 M models/atm/cam/src/physics/cam1/restart_physics.F90
    - fix to quell compiler complaint
 M models/atm/cam/src/physics/cam1/tphysbc.F90
    - fix to qneg3 diagnostic print
 M models/lnd/clm2/src/main/clm_varctl.F90
 M models/lnd/clm2/src/main/inicFileMod.F90

--------------

  Files added:

 A models/atm/cam/src/control/ncdio_atm.F90
    - Wrapper for reading a 2-D or 3-D field from a netCDF IC file
 A models/atm/cam/src/dynamics/eul/diag_dynvar_ic.F90
    - "outfld" dynamics state variables to history buffer (for IC file)
 A models/atm/cam/src/dynamics/fv/diag_dynvar_ic.F90
    - "outfld" dynamics state variables to history buffer (for IC file)
 A models/atm/cam/src/dynamics/sld/diag_dynvar_ic.F90
    - "outfld" dynamics state variables to history buffer (for IC file)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_2
Originator: erik ( Erik Kluzek)
Date: Wed Jun  9 10:29:42 MDT 2004
Model: CAM
Version: CAM3.0.2
One-line Summary: Major test-model.pl update, bug fix for DGVM in clm code
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton, Matt Rothstein, and Tom Henderson
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: DGVMMod.F90, and driver.F90 from Mariana for DGVM bug-fix
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Synopsis:

Overall this is a major refactoring of test-model.pl. This is the version
of test-model.pl that was on the subroutinization branch for the last year.
This improves the default behavior of test-model.pl and makes it easier
and more flexible to use. It also provides for the ability to test the
test-model.pl test harness.

Files changed and a description of the changes:

M models/atm/cam/bld/CAM.pm                                           
M models/atm/cam/bld/CAM_config.pm                                    
M models/atm/cam/bld/CAM_namelist.pm                                  
M models/atm/cam/bld/CAM_run.pm                                       
R models/atm/cam/bld/check-namelist.pl                                
R models/atm/cam/bld/lsmexp.pm                                        
M models/atm/cam/bld/run-model.pl

Add abilities needed by new test-model.pl. Don't delete *.f90 files.
Delete lsmexp.pm file. Make run options more clear. Add printlev and test
option to namelist. Build_namelist always does a new on a namelist
object. Get rid of check-namelist.pl as not used.
                                     
M models/atm/cam/test/system/CAM_test.pm                              
M models/atm/cam/test/system/README                                   
A models/atm/cam/test/system/babyblue.test-model.pl.log   ! testonly mode results                                                               
M models/atm/cam/test/system/dao_batch.csh                            
A models/atm/cam/test/system/default_tests.test-model.xml  ! XML default tests                                                         
A models/atm/cam/test/system/namelist-config.test-model.dbg.log  ! file of 
                       configuration/namelists from testonly mode  
M models/atm/cam/test/system/ncar_batch.csh                           
A models/atm/cam/test/system/specs-testslist.test-model.xml  ! XML file of 
                       specifications of fields expected in testslist XML files
M models/atm/cam/test/system/test-model.pl  

New version of test-model.pl as described below.

M models/atm/cam/tools/newcprnc/Makefile                  

Allow use of env variables needed by test-model.pl. Still not used in
test-model.pl as newcprnc doesn't do a proper mass weighting of the
differences.

M models/lnd/clm2/src/biogeochem/DGVMMod.F90                          
M models/lnd/clm2/src/main/driver.F90   

Bug-fixes from Mariana for DGVM.

Details of changes to test-model.pl

test-model.pl -- new version with XML files to control tests that     
        are run. This is the version of test-model.pl that was        
        used on the subroutinization branch. Modified batch scripts   
        to correspond to new command line options.                    
                                                                      
Default is changed so that if you are comparing and a test is         
NOT bit-for-bit to the comparision code -- test-model.pl will         
stop.                                                                 
                                                                      
New command line options to test-model.pl
                                                                      
-cleanonly           = only clean files out                                   
-help_defaults       = Create file with configuration/namelist information 
                       for all tests                                          -allow_nonb4bcompare = Allow comparisions not bit-for-bit to continue.
-[no]spmd            = Turn on [off] SPMD mode                       
-[no]smp             = Turn on [off] SMP mode
-nocompareifskipped  = If you are skipping tests a comparision will NOT
                       be run if a given test is skipped.                     -namelist "namelist" = Reads in namelist and adds these options to the 
                       namelists that are used.                            
-testonly            = Only test test-model.pl running configure and 
                       build-namelist for all tests to demonstrate what 
                       test-model.pl would have produced.
-testslist filename  = Use the given XML file of tests rather 
                       than the default file.                              

Information on all command-line options is given with

test-model.pl -help
                                                                      
newcprnc -- Add ability to use the env variables needed for test-model.pl
	VPATH, EXEDIR. To use this in test-model.pl change the path
	in test-model.pl and change CAM_test.pm to NOT use the "-m" option
	as the behavior of this flag was reversed in newcprnc from cprnc.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0_1
Originator: erik ( Erik Kluzek)
Date: Tue May 25 16:40:56 MDT 2004
Model: CAM
Version: CAM3.0.1
One-line Summary: Get rid of ncdata_vers stuff, and fix SOM comparision bug in test-model.pl
cam-bugs Requests resolved: 118
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes
(ncdata_vers is no longer needed)
Tested to work coupled with CCSM (create_ccsmcam): yes
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Get rid of ncdata_vers stuff in the build-namelist scripts.

Fix bug in SOM comparisions, so test-model.pl will flag a difference
if SOM code changes. Previously this aspect was broken and the comparisions
files were mislabled. Now the files are properly labeled, SOM control
tests are made in a seperate directory, and namelist and configuration
variables are consistent such that the comparision is valid. This problem
was documented as cam-bug #118.

No code was changed only build and configuration and test scripts.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam3_0
Originator: eaton ( Brian Eaton)
Date: Mon May 24 15:33:43 MDT 2004
Model: CAM
Version: CAM3.0
One-line Summary: remove old CAM2 documentation
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: none
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no

Changes made:

Remove old CAM2 documentation.

===============================================================
===============================================================

cam2_0_2_dev86
Originator: mvertens ( Mariana Vertenstein)
Date: Thu May 20 10:56:00 MDT 2004
Model: CAM
Version: CAM2.0_2.dev86
One-line Summary: updated clm code clm3_deva_14
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: yes (TER.01a.T31_gx3v5.K.blackforest)
Machines tested: IBM, SGI, Linux(lf95)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
1) Updated clm code to clm3_deva_14
2) Updated clm documentation to clm3_deva_14
3) One line modification to 
     atm/src/control/ioFileMod.F90
     clm2/src/main/fileutils.F90
   to fix file removal problem associated with mss writes	
	
===============================================================
===============================================================

cam2_0_2_dev85
Originator: jet ( John Truesdale)
Date: Tue May 18 14:53:15 MDT 2004
Model: CAM
Version: CAM2.0_2.dev85
One-line Summary: Added SCAM to cam_dev
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Added cpp delimeted code to allow clm to work
	in single column mode.
	
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

My check-in includes 3 sets of modifications to CAM code.
1) modifications to allow it to work in single column mode
2) additional source code and configuration files to create GUI
   for the Single-Column CAM (SCAM).
3) modification to CAM to allow it to produce a history file that
   can be used by SCAM to run in a pseudo-iop mode using model
   data.

Most of the modifications to CAM source have been delimited by cpp
tokens (#defined SCAM and #defined BFB_CAM_SCAM_IOP)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev84
Originator: mvr ( Mathew Rothstein)
Date: Fri May 14 09:43:26 MDT 2004
Model: CAM
Version: CAM2.0_2.dev84
One-line Summary: Replaced numerical recipes routines for random# generation and findvalue; modified Makefile to eliminate double comma problem; other small bug fixes
cam-bugs Requests resolved: none
Requires change in build system: yes
- replaced the use of function subst in Makefile with patsubst to eliminate 
  double comma problem
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, pjr
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
R models/atm/cam/src/utils/findvalue.F90
  - removing old find routine based on numerical recipe algorithm
A models/atm/cam/src/utils/marsaglia.F90
  - new random number generator for cloud simulator 
M models/atm/cam/src/physics/cam1/cloudsimulator.F90
  - modified to seed new random number generator
M models/atm/cam/src/physics/cam1/icarus_scops.F90
  - now uses new random number generator rather than algorithm from 
    numerical recipes
M models/atm/cam/src/physics/cam1/radclwmx.F90 
  - added r8 declaration to array aer_trn_ttl
M models/atm/cam/src/physics/cam1/radcswmx.F90
  - now uses fortran intrinsic for finding an array minimum rather 
    than a routine from numerical recipes
M models/atm/cam/bld/Makefile
  - replaced the use of function subst with patsubst to eliminate ,, 
M models/atm/cam/test/system/CAM_test.pm
  - modified error message in test-model 



See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev83
Originator: mvr ( Mathew Rothstein)
Date: Thu May 13 09:56:08 MDT 2004
Model: CAM
Version: CAM2.0_2.dev83
One-line Summary: Replaced sort routine; modified handling of namelist vars for computing run stop date; modifed input dataset path strings
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: same-to-roundoff
Changes to CLM land-model: yes 
- modified strings of default input datasets to include full path from csmdata
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

R models/atm/cam/src/utils/sortarray.F90
  - removing old sort routine based on numerical recipe algorithm
A models/atm/cam/src/utils/quicksort.F90
  - replacing sort routine with new quick-sort algorithm 
M models/atm/cam/src/physics/cam1/radclwmx.F90
  - modified to call new sort routine
M models/atm/cam/src/physics/cam1/radcswmx.F90
  - modified to call new sort routine
M models/atm/cam/src/control/time_manager.F90
  - modified handling of namelist parameters for computing stop date
M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
  - modified input dataset strings to include full path from csmdata 
M models/atm/cam/bld/DefaultCLMEXPNamelist.xml
  - modified input dataset strings to include full path from csmdata 
M models/atm/cam/bld/camexp.pm
  - modified to use new input dataset strings 
M models/atm/cam/bld/clm2exp.pm
  - modified to use new input dataset strings 



See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev82
Originator: jmccaa ( James Mccaa)
Date: Mon May 10 15:40:39 MDT 2004
Model: CAM
Version: CAM2.0_2.dev82
One-line Summary: Tuning modifications for the finite volume dycore.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes 
Machines tested: IBM, SGI, intel 
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers:  Yes, for FV -- bit-for-bit for EUL and SLD
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
Modified tuning for FV 2x2.5, and introduced tuning settings for FV 4x5
and FV 1x1.25.
A new i.c. file for FV 4x5 was introduced.
These files were modified:
M cam1/models/atm/cam/bld/DefaultCAMEXPNamelist.xml
M cam1/models/atm/cam/src/dynamics/fv/dycore.F90
M cam1/models/atm/cam/src/physics/cam1/cldwat.F90
M cam1/models/atm/cam/src/physics/cam1/cloud_fraction.F90
M cam1/models/atm/cam/src/physics/cam1/moistconvection.F90
M cam1/models/atm/cam/src/physics/cam1/zm_conv.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev81
Originator: mvertens ( Mariana Vertenstein)
Date: Tue May  4 10:40:20 MDT 2004
Model: CAM
Version: CAM2.0_2.dev81
One-line Summary: updated clm code to clm3_deva_10
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: yes (TER.01a.T31_gx3v5.K.blackforest)
Machines tested: IBM, SGI, Linux(lf95)
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Forrest Hoffman
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes (see below)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
1) Updated clm code to clm3_deva_10
   This primarily includes the addition of CrayX1 directives to the code
   as well as changes to DGVM to make it effectively work on the Cray X1
   Also changed the name of the clm file changed in cam2_0_2_dev80 back
   to its original name for the sake of cvs history continuity
2) Modified history.F90 to use (ieor,iand) rather than (xor,and)
	
===============================================================
===============================================================

cam2_0_2_dev80
Originator: eaton ( Brian Eaton) and Pat Worley
Date: Wed Apr 28 17:44:37 MDT 2004
Model: CAM
Version: CAM2.0_2.dev80
One-line Summary: merge vector branch
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux/lf95, Linux/pgi
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Pat Worley
Restart files change: no
Changes answers: Yes (same-to-roundoff)
Changes to CLM land-model: rename STATICEcosysDynMod.F90 --> STATICEcosystemDynMOD.F90
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

1. Merge of vector and scalar code branches:

The mods for the NEC that didn't change answers (bit-for-bit) were
committed previously.  This set of mods introduces a roundoff level
change into the simulation.  The main modifications are:

. A new version of radcswmx.  This code runs a little slower on the IBM
  (about 4% of total run time).  It introduces roundoff level changes
  which affects all dycores.

. Large sections of code have been changed which reorder the spectral
  calculations in the EUL dycore.  We observed no performance degradation
  on the IBM from this change.

. Most of the Cray optimizations have been included as well.  They are mainly
  compiler directives.

2. Rename a CLM file which didn't match the module name it contained (this
   breaks the dependency generator)

3. Some cleanup in ncar_batch.csh

===============================================================
===============================================================

cam2_0_2_dev79
Originator: eaton ( Brian Eaton)
Date: Fri Apr 23 07:56:47 MDT 2004
Model: CAM
Version: CAM2.0_2.dev79
One-line Summary: T31 tuning; T31 and T85 datasets; diagnostics
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, Linux/lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

. Tuning mods for T31
. New datasets for T31 and T85
. Diagnostics:
  - AIX specific traceback call added to abortutils
  - Check for NaNs in timeinterp

===============================================================
===============================================================

cam2_0_2_dev78
Originator: eaton ( Brian Eaton) and Mat Rothstein
Date: Tue Apr 20 10:52:58 MDT 2004
Model: CAM
Version: CAM2.0_2.dev78
One-line Summary: misc configure/Makefile/test-model changes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes, on Blackforest
Machines tested: IBM, Linux/lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvr
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

. Fix hack in test-model that set F_OPTIMIZATION_OVERRIDE for certain PGI
  tests.  The hack was broken by the inclusion of a commandline option to
  configure for setting the F_OPTIMIZATION_OVERRIDE macro in the Makefile.
. Add print in test-model output to tells which log contains NOT BFB
  message.
. Various configure/Makefile changes:
  - Temporarily remove -Mbounds from PGI debug options.  CLM2 is not working
    with this option.
  - Add -cppdefs option to configure for defining CPP tokens.  These cpp
    definitions are appended to the Makefile defaults.  Remove the -precomp
    option which was adding #define lines to misc.h.
  - Add capability to configure to determine the name of the MPI library
    being used.  This is currently most useful for Linux which may use
    either mpi or mpich as the library name.
  - Clean up Linux section of Makefile.  Fixed a bug which broke the build
    if the user specified the option '-fc pgf90' to configure.  Remove
    options for compilers that don't have corresponding builds of the ESMF
    library.
. Add missing addfld call for H2O2DRY in sulfur_intr.F90

===============================================================
===============================================================

cam2_0_2_dev77
Originator: mvr ( Mathew Rothstein) and Brian Eaton
Date: Tue Apr  6 10:38:51 MDT 2004
Model: CAM
Version: CAM2.0_2.dev77
One-line Summary: Update cloud simulator; T31 mods; Enable cloud overlap scenarios; Bug fix in masterlist lookups; Re-commit of infnan mods
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: yes 
replaced infnan mods of dev65, mistakenly removed
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
R models/atm/cam/src/physics/cam1/cloudsimulatorparms.F90
  - put data in icarus_scops.h, put doisccp into cloudsimulator.F90
A models/atm/cam/src/physics/cam1/icarus_scops.F90
  - new module containing subroutine isccp_cloud_types (converted to free 
    format) and subroutine ran0_vec
  - change output types to r8
  - replace "STOP" with endrun calls
  - add diagnostic for meanttop
  - add icarus_scops_init routine to read in tautab and invtau arrays
M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
  - added default value for dataset isccpdata, needed for isccp simulator
M models/atm/cam/bld/camexp.pm
  - modified to handle namelist parameters related to the isccp simulator
M models/atm/cam/src/control/cam.F90
  - remove call to initialization routine
M models/atm/cam/src/control/history.F90
  - use icarus_scops instead of use cloudsimulatorparms
  - remove addfld and add_default calls for diagnostic fields (move to 
    cloudsimulator_init)
  - remove unnecessary addfld for aermmr
  - added endrun calls for hash table lookups of fields not on masterlist
M models/atm/cam/src/control/runtime_opts.F90
  - use cloudsimulator instead of cloudsimulatorparms
M models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
  - removed outfield calls and related code for fields not on masterlist
M models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
  - removed outfield calls and related code for fields not on masterlist
M models/atm/cam/src/physics/cam1/check_energy.F90
  - removed unneeded code to fix bug identified by SX6 machine
M models/atm/cam/src/physics/cam1/cldwat.F90
  - added special setting of physical constants for T31 runs
M models/atm/cam/src/physics/cam1/cloud_fraction.F90
  - added special setting of physical constants for T31 runs
M models/atm/cam/src/physics/cam1/cloudsimulator.F90
  - rename isccptab --> cloudsimulator_init
  - rename ccm_isccp --> cloudsimulator_run
  - add state to cloudsimulator_run args
  - add addfld and add_default calls for diagnostic fields
  - change arguments to isccp_cloud_types from single columns to chunks 
  - use the totalcldarea diagnostic from isccp_cloud_types rather than the
    cltot diagnostic from cam to decide whether it's cloudy or not.  This
    avoids assigning fillvalues inside the isccp_cloud_types code
M models/atm/cam/src/physics/cam1/constituents.F90
  - commented out code for fields no longer in use
M models/atm/cam/src/physics/cam1/initindx.F90
  - commented out code for fields no longer in use
M models/atm/cam/src/physics/cam1/inti.F90
  - call cloudsimulator_init
M models/atm/cam/src/physics/cam1/moistconvection.F90
  - added special setting of physical constants for T31 runs
M models/atm/cam/src/physics/cam1/param_cldoptics.F90
  - add_default call for icldiwp
  - modify long name attribute for icldlwp
M models/atm/cam/src/physics/cam1/radclwmx.F90
  - uncommented line and modified associated array declaration in LW 
    cloud-overlap code (critical for certain cloud overlap assumptions)
M models/atm/cam/src/physics/cam1/tphysbc.F90
  - use cloudsimulator instead of cloudsimulatorparms
  - update cloudsimulator_run args
  - removed outfield calls and related code for fields not on masterlist
M models/atm/cam/src/physics/cam1/zm_conv.F90
  - added special setting of physical constants for T31 runs
M models/lnd/clm2/src/main/nanMod.F90
  - replaced mods for quiet/signalling NaN's of dev65 that were
    mistakenly overwritten with dev75 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev76
Originator: rosinski ( Jim Rosinski)
Date: Tue Mar 30 15:11:23 MST 2004
Model: CAM
Version: CAM2.0_2.dev76
One-line Summary: bit-for-bit NEC vector branch changes.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit).  PC is only roundoff
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Merged cam2.0.2.dev67.brnchT.nec15 (vector branch) changes that do not affect 
  answers onto cam_dev.  Opted for Pat Worley's dev68 communication mods over NEC
  communication mods where conflicts occurred.  A few NEC_SX ifdefs still
  exist in the committed code.  Most involve reversing "do k" and "do i"
  loops in dynamics routines for vectorization.  An inner loop over k results
  in a non-unit-stride situation on scalar machines and should be avoided.
  That is why these code portions were left ifdef'd

o Note 1: The code appears to be good to roundoff on IBM machines when NEC_SX is 
  #define'd.  To test this on an IBM, "! defined AIX" needs to be added in 2
  obvious places in cfort.h and abortutils.F90
  
o Note 2: An odd behavior was discovered whereby inconsistent chunck indices are
  printed from ice_srf.F90 at times when the ice temperature profile is reset to
  linear.  This behavior appears to only manifest when threads * tasks exceeds
  the number of physical CPUs available.  It was decided to commit without
  resolving this discrepancy because the behavior occurs in the base model and
  in earlier libraries, i.e. independent of the NEC vector mods.

===============================================================
===============================================================
cam2_0_2_dev75
Originator: mvertens ( Mariana Vertenstein)
Date: Fri Mar 26 15:07:40 MST 2004
Model: CAM
Version: CAM2.0_2.dev75
One-line Summary: updated clm to clm3_deva_08
cam-bugs Requests resolved: none
Requires change in build system: no (can removed atmlnd_share from Filepath howeer)
Substantial timing or memory changes: no 
Requires change in run script: no 
Tested to work coupled with CCSM: yes
Machines tested: IBM, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, (Brian Eaton revied cam time_manager.F90)
Restart files change: yes
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes - updated to clm3_deva_08
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
1) added perpetual model to cam-clm 
  - updated clm/src to clm3_deva_09 which had perpetual mode changes. 
  - modified models/atm/cam/src/control/time_manager.F90 to add offset argument to 
    subroutine get_perp_date(..) 
2) changes to models/atm/cam/bld/:
  - removed setting of reset_csim_iceprops in DefaultCAMEXPNamelist.xml
  - removed atmlnd_share from configure
3) chages to atmlnd_share/:
   atmlnd_share no longer needed 
   atmlnd_share/cfort.h updated and moved to models/atm/cam/src/control and models/lnd/clm2/src/main
   atmlnd_share/datetime.F90 moved to models/atm/cam/src/control 
   atmlnd_share/infnan.F90 moved to models/atm/cam/src/control 
   atmlnd_share/linebuf_stdout.c moved to models/atm/cam/src/control 
   atmlnd_share/mpishorthand.F moved to models/atm/cam/src/control 
   atmlnd_share/string_utils.F90 moved to models/atm/cam/src/control 
   atmlnd_share/wrap_nf.F90 moved to models/atm/cam/src/control 
4) other changes:
   removed all files in following directories - they are now obsolete:following obsolete files: 
   models/bld/
   scripts/gui/
   scripts/gui_run/
   scripts/system_test/
   scripts/test.a1/
   scripts/test.a2/
   scripts/tests/cpl_check/
   scripts/tests/gprof/
   scripts/tests/sub_sgi/
   scripts/tests/test_scripts/
   scripts/tests/timing/
===============================================================
===============================================================

cam2_0_2_dev74
Originator: mvr ( Mathew Rothstein)
Date: Thu Mar 18 11:51:59 MST 2004
Model: CAM
Version: CAM2.0_2.dev74
One-line Summary: Add fields to master list for radiation diagnostics; fixes to build-namelist for "naked decimal" and handling of raw land surface datasets
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: yes
clm2exp.pm: now properly handles user-specified raw land surface datasets
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

M cam1/models/atm/cam/bld/clm2exp.pm
  - now properly handles user-specified raw land surface datasets
M cam1/models/atm/cam/bld/namelist.pm
  - added ability to read "naked" decimal entries
M cam1/models/atm/cam/bld/script_tests/namelist.pl
  - added namelist tests for "naked" decimal entries and more
M cam1/models/atm/cam/src/control/history.F90
  - add addfld calls for ASDIR, ASDIF, ALDIR, ALDIF
  - remove old addfld call for REL
  - add addfld call for SST
M cam1/models/atm/cam/src/physics/cam1/comsrf.F90
  - init trefmxav, trefmnav
  - init lchnk and ncol in srfflx_state_2d
M cam1/models/atm/cam/src/physics/cam1/diagnostics.F90
  - change diag_surf to use srfflx_state and surface_state types
  - add outfld calls for ASDIR, ASDIF, ALDIR, ALDIF
  - add outfld call for SST
M cam1/models/atm/cam/src/physics/cam1/param_cldoptics.F90
  - add addfld and outfld calls for EMIS, CICEWP, REI, REL
M cam1/models/atm/cam/src/physics/cam1/physpkg.F90
  - pass srfflx_state and surface_state types to diag_surf instead of the
    individual fields
M cam1/models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
  - remove old outfld call for REL


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev73
Originator: mirin ( Arthur Andrew Mirin)
Date: Mon Mar 15 09:16:02 MST 2004
Model: CAM
Version: CAM2.0_2.dev73
One-line Summary: Mod_comm and related updates.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: new test on blackforest
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

(A) mod_comm has been significantly streamlined to make it easier to
understand the coding; module mod_irreg has been combined into mod_comm;
option to dynamically allocate target window has been added.
More work still needs to be done. Most of the changes in the FV routines
are due to the new linkage.

(B) the utils/pilgrim subdirectory can now be included for all 3 dycores;
this requires setting the if-def MODCM_DP_TRANSPOSE. Consequently,
the mod_comm option for the dynamics/physics transposes in phys_grid
is now operational with all 3 dycores;

(C) namelist variable modcomm_method has been fissioned into 2 new
namelist variables - modcomm_transpose and modcomm_geopk; these are
applicable to the FV dycore.

(D) the namelist variable phys_alltoall is now overloaded when applicable
to mod_comm; its new value is 11 + (mod_comm method), where (mod_comm method)
can have values from 0 to 3; see code documentation in phys_grid.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev72
Originator: bundy ( Danielle R. B. Coleman)
Date: Fri Mar 12 12:13:22 MST 2004
Model: CAM
Version: CAM2.0_2.dev72
One-line Summary: fix FV mass conservation problem
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux (Lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Phil Rasch
Restart files change: no
Changes answers: changes answers in FV only
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

models/atm/cam/src/dynamics/fv/fill_module.F90

fix mass conservation for small mixing ratios by scaling tiny fill value
to magnitude of mixing ratio. 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev71
Originator: bundy ( Danielle R. B. Coleman)
Date: Wed Mar 10 16:13:03 MST 2004
Model: CAM
Version: CAM2.0_2.dev71
One-line Summary: Add dry mixing ratio formulation, suite of test tracers
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux (Lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Phil Rasch
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

	a. A list of any subroutines eliminated;
models/atm/cam/src/physics/cam1/test_tracers.F90
models/atm/cam/src/physics/cam1/rnozunit.F90

	b. A list of any subroutines added and what they do; and
models/atm/cam/src/physics/cam1/tracers.F90 
replaces eliminated file test_tracers.F90
an interface for a generic suite of tracers specified in tracers_suite.F90

models/atm/cam/src/physics/cam1/tracers_suite.F90 
replaces eliminated rnozunit.F90
contains all the specifications for a suite
of tracers, and is interfaced to the model via tracers.F90.

	c. For existing files that have been modified, an itemized list
         of the changes and where they can be found

models/atm/cam/src/physics/cam1/advnce.F90
	add call to tracers_timestep_init
models/atm/cam/src/physics/cam1/check_energy.F90
	add check_tracers mass capability 
models/atm/cam/src/physics/cam1/constituents.F90
	add mixtype (wet or dry) field to constituent description
	add functions to get type by index or name
models/atm/cam/src/physics/cam1/convtran.F90
/models/atm/cam/src/physics/cam1/diagnostics.F90
	outfld call for PDELDRY
models/atm/cam/src/physics/cam1/initindx.F90
models/atm/cam/src/physics/cam1/inti.F90
	change namelist variables that control tracers
models/atm/cam/src/physics/cam1/moistconvection.F90
models/atm/cam/src/physics/cam1/physics_types.F90
	add capability for wet or dry mixtype tracers
models/atm/cam/src/physics/cam1/physpkg.F90
	calculates pdeldry for dry mixtypes
	added gavglook subroutine for checking mass conservation
models/atm/cam/src/physics/cam1/tphysac.F90
	change tracer namelist variables, subroutine calls
	check mass of tracers
	for LR dyn, convert dry to wet at end
models/atm/cam/src/physics/cam1/tphysbc.F90
	calculate and write out dry surface pressure PSDRY
	check mass of tracers
models/atm/cam/src/physics/cam1/vertical_diffusion.F90
	calculate tend wrt dry pressure for dry mixtype tracers
	by calling vdiff for again only if there are dry tracersm
models/atm/cam/src/physics/cam1/turbulence.F90:trbintr()
	add optional argument to skip outfld calls 
	( used on 2nd call to subroutine from 2nd call to vdiff)
models/atm/cam/src/control/filenames.F90
	add boundary file for test tracers: bndtvsf6
models/atm/cam/src/control/runtime_opts.F90
	change namelist variables for tracers:
	[new] bndtvsf6
	[mod] tracers_flag [replaces trace_test{1-3}]
models/atm/cam/src/control/history.F90
	addfld PSDRY
models/atm/cam/src/advection/slt/qmassa.F90
models/atm/cam/src/advection/slt/xqmass.F90
	add capability for dry mixtype tracers
models/atm/cam/src/dynamics/eul/dp_coupling.F90
models/atm/cam/src/dynamics/sld/dp_coupling.F90
	only change wet mixtype tracers to dry/wet mr for dyn/phys
models/atm/cam/src/dynamics/fv/dp_coupling.F90
	convert dry mixtype tracers to wet/dry for dyn/phys
models/atm/cam/src/dynamics/fv/stepon.F90
	before 1st call to dynamics, convert dry tracers to wet
models/atm/cam/src/dynamics/eul/inidat.F90
models/atm/cam/src/dynamics/sld/inidat.F90
models/atm/cam/src/dynamics/fv/inidat.F90
	name changes test_tracers -> tracers
models/atm/cam/src/dynamics/eul/scanslt.F90
models/atm/cam/src/dynamics/sld/scanslt.F90
	pass vars (n3,q3) to slt interface
models/atm/cam/src/dynamics/eul/tfilt_massfix.F90
models/atm/cam/src/dynamics/sld/tfilt_massfix.F90
	modify qneg threshold (corm) for dry mixtypes to conserve mass
/models/atm/cam/src/dynamics/eul/comslt.F90
	add trcavg variable

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev70
Originator: pworley ( Patrick H Worley)
Date: Tue Mar  9 08:30:43 MST 2004
Model: CAM
Version: CAM2.0_2.dev70
One-line Summary: replaced use of mpi_comm_world with mpicom in initialization of swap_comm module
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux/Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

modified control/swap_comm.F90:
  replaced mpi_comm_world with mpicom when duplicating communicators (for use in
  swap_comm module routines). Without this, CAM does not work with CCSM.

added test/system/create_ccsmcam:
  script provided by Mariana Vertenstein to test CAM with CCSM

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev69
Originator: mvr ( Mathew Rothstein)
Date: Thu Mar  4 17:35:12 MST 2004
Model: CAM
Version: CAM2.0_2.dev69
One-line Summary: Fix for DMS bug; Fix for co2 ramping with rate<0; Added co2vmr to history output
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

M models/atm/cam/src/physics/cam1/acbnd.F90
  - move allocate outside of masterproc conditional in acbndint()
M models/atm/cam/src/physics/cam1/dmsbnd.F90
  - fix bug reading new time sample in dmsbndint()
  - move allocate outside of masterproc conditional in dmsbndint()
M models/atm/cam/src/physics/cam1/soxbnd.F90
  - move allocate outside of masterproc conditional in soxbndint()
M models/atm/cam/src/physics/cam1/ghg_surfvals.F90
  - fixed the handling of co2 ramping when the rate is less than zero
M models/atm/cam/src/control/history.F90
  - added co2vmr (co2 volume mixing ratio) to the history output files


===============================================================
===============================================================

cam2_0_2_dev68
Originator: pworley ( Patrick H Worley)
Date: Wed Mar  3 12:55:10 MST 2004
Model: CAM
Version: CAM2.0_2.dev68
One-line Summary: communication optimizations and removal of PVP ifdefs
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: not with default settings
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux cluster
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself (earlier version reviewed by Tom Henderson)
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:


1) Removed PVP ifdefs (to make merge with vector branches cleaner). Files affected:
   control/cam.F90, rgrid.F90

   dynamics/eul/comspe.F90, dyn.F90, dyndrv.F90, grcalc.F90, hordif.F90,
                inital.F90, initcom.F90, quad.F90, settau.F90, spetru.F90,
                trunc.F90, tstep.F90

   dynamics/fv/initcom.F90
   
   dynamics/sld/dyn.F90, dyndrv.F90, dynpkg.F90, grcalc.F90, hordif.F90,
                initcom.F90, quad.F90, spetru.F90, trunc.F90, tstep.F90,
                tstep1.F90, vertnm.F90

2) Reimplemented communication algorithms in spectral dycore realloc routines
   and in the physics load balancing, using either MPI collectives or
   point-to-point implementations that use the swap_comm module. swap_comm
   was imported from PSTSWM and PCCM, and supports 28 different options. The default
   is to use collectives. When not using collectives, the default is to use the
   original point-to-point algorithm (using mpi_sendrecv). Runtime options
   dyn_alltoall, dyn_allgather, phys_alltoall, swap_comm_order, and swap_comm_protocol
   were added to runtime_options to specify these. For example,
   dyn_alltoall == 0 means to use MPI_Alltoallv in realloc4a and realloc4b.
   dyn_alltoall == 1 means to use one of the point-to-point algorithms.

   Physics load balancing was also changed to use the same communication buffer
   as that used by the realloc routines. Finally, the physics load balancing
   options were tweaked, primarily to remove a high complexity initialization algorithm
   that was dominating runtime for short runs at high resolution. Files affected:

   control/runtime_opts.F90, spmd_utils.F90, spmdinit.F90, swap_comm.F90, mpi_wrap.F90

   dynamics/eul/dp_coupling.F90, realloc4.F90, realloc7.F90, scan2.F90, spmd_dyn.F90

   dynamics/fv/spmd_dyn.F90

   dynamics/sld/dp_coupling.F90, realloc4.F90, realloc7.F90, scan2.F90, spmd_dyn.F90

   physics/cam1/phys_grid.F90
 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev67
Originator: mvr ( Mathew Rothstein)
Date: Fri Feb 27 08:53:27 MST 2004
Model: CAM
Version: CAM2.0_2.dev67
One-line Summary: Implemented co2 ramping; Enabled lf95/debug checking with sulfates on; fix for 200MB radiation diagnostics  
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI(pending), Compaq
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, eaton
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

M models/atm/cam/src/control/runtime_opts.F90
  - added new option to namelist var scenario_ghg: RAMP_CO2_ONLY
  - added new namelist variables: ramp_co2_annual_rate, ramp_co2_cap,
    ramp_co2_start_ymd
M models/atm/cam/src/control/time_manager.F90
  - added new routine to calculate #of days between dates: timemgr_datediff
M models/atm/cam/src/physics/cam1/acbnd.F90
  - mods to enable lf95/debug checking with sulfates on
M models/atm/cam/src/physics/cam1/dmsbnd.F90
  - mods to enable lf95/debug checking with sulfates on
M models/atm/cam/src/physics/cam1/soxbnd.F90
  - mods to enable lf95/debug checking with sulfates on
M models/atm/cam/src/physics/cam1/ghg_surfvals.F90
  - formally implemented ability to ramp co2 
M models/atm/cam/src/physics/cam1/radcswmx.F90
  - added fix for 200MB radiation diagnostics
  - uses new function to retrieve co2 mass mixing ratio
M models/atm/cam/src/physics/cam1/trcpth.F90
  - uses new function to retrieve co2 mass mixing ratio


===============================================================
===============================================================

cam2_0_2_dev66
Originator: eaton ( Brian Eaton)
Date: Mon Feb 23 16:40:39 MST 2004
Model: CAM
Version: CAM2.0_2.dev66
One-line Summary: misc performance improvements
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes (performance improvement validated by G. Carr)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Carr, Edwards
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

>> models/atm/cam/src/dynamics/eul/herxin.F90
>> . "rolled" a loop for better cache performance (Edwards)
>>
>> models/atm/cam/src/dynamics/eul/limdy.F90
>> models/atm/cam/src/dynamics/eul/limdz.F90
>> . inlined scm0 by hand into limdy and limdz (Carr)
>>
>> models/atm/cam/src/dynamics/eul/sltini.F90
>> . remove SPMD ifdefs and thread a loop that was previously unthreaded
>>   when SPMD was defined. (Eaton)

===============================================================
===============================================================

cam2_0_2_dev65
Originator: hender ( Tom Henderson)
Date: Thu Feb 12 16:18:09 MST 2004
Model: CAM
Version: CAM2.0_2.dev65
One-line Summary: IPCC performance upgrade in prognostic sulfate interpolation
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Intel-Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Jim McCaa, Brian Eaton, Jim Rosinski, Mathew Rothstein
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Restored signalling Nan except for pgf90
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
>> Performance fix to scale computations in linintp.  Speedup = ~12% for
>> stand-alone CAM at T85 with IPCC scenario configurations for prognostic
>> sulfates and greenhouse gasses:
>>   models/atm/cam/bld/run-ibm.csh
>>   models/atm/cam/src/physics/cam1/acbnd.F90
>>   models/atm/cam/src/physics/cam1/dmsbnd.F90
>>   models/atm/cam/src/physics/cam1/soxbnd.F90
>>   models/atm/cam/src/physics/cam1/sulchem.F90
>>   models/atm/cam/src/physics/cam1/sulemis.F90
>>   models/atm/cam/src/physics/cam1/sulfur_intr.F90
>>   models/atm/cam/src/control/error_messages.F90
>> Jim Rosinski's new timers:  
>>   models/atm/cam/src/physics/cam1/comsrf.F90
>>   models/atm/cam/src/physics/cam1/convtran.F90
>>   models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
>>   models/atm/cam/src/physics/cam1/tphysbc.F90
>>   models/atm/cam/src/control/intp_util.F90
>> Brian Eaton's change to remove broadcasts from chemistry.F90 that were
>> happening every time step:
>>   models/atm/cam/bld/DefaultCAMEXPNamelist.xml
>>   models/atm/cam/bld/DefaultCLMEXPNamelist.xml
>>   models/atm/cam/src/physics/cam1/chemistry.F90
>> Mathew Rothstein's change to use quiet NaN for pgf90 and signalling NaN for
>> all other compilers.
>>   models/lnd/clm2/src/main/nanMod.F90
>>   models/atmlnd_share/infnan.F90
>> Jim McCaa's addition of 200mb fields.
>>   models/atm/cam/src/physics/cam1/radclwmx.F90
>>   models/atm/cam/src/physics/cam1/radcswmx.F90
>>   models/atm/cam/src/physics/cam1/radctl.F90
>>   models/atm/cam/src/control/history.F90
>> By default, this change produces no new output fields; however, it allows
>> one to fincl the following:
>>   FSN200: Clearsky shortwave flux at 200 mb
>>   FSN200C: Shortwave flux at 200 mb
>>   FLN200: Clearsky longwave flux at 200 mb
>>   FLN200C: Longwave flux at 200 mb

===============================================================
===============================================================

cam2_0_2_dev64
Originator: mvr ( Mathew Rothstein)
Date: Mon Feb  2 11:13:05 MST 2004
Model: CAM
Version: CAM2.0_2.dev64
One-line Summary: patch to enable runs using portland group compiler; removal of mprun2d.pm 
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: yes
  - modified definition of parameter nan to enable runs using portland group compiler
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

M cam1/models/lnd/clm2/src/main/nanMod.F90
  - modified definition of parameter nan to enable run using portland 
    group comiler
R cam1/models/atm/cam/bld/mprun2d.pm


===============================================================
===============================================================

cam2_0_2_dev63
Originator: rosinski ( Jim Rosinski)
Date: Tue Jan 27 10:15:42 MST 2004
Model: CAM
Version: CAM2.0_2.dev63
One-line Summary: Eliminate dead code, more flexible endrun, more "intent" attributes,
                  better lf95 strict error checking compliancy
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Mariana checked this.
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Vertenstein
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o endrun is now in a module and takes an optional character string argument.
  If present, this string is printed before the model aborts.
o Eliminated dead code, including the old "dataicemodel".  Mods were made to
  ncar_batch.csh to eliminate the dataicemodel tests.  This was done by passing
  -skip all:1-17 to test-model.
o Also eliminated dead logic related to sulfur variables.
o Better strict error checking compliancy under lf95.  But "lf95 -x" cannot be
  used because lf95 warns that all underlying libraries must also be compiled
  with this option in order for it to work properly.
o Added "intent" clause to arguments where the proper value was clear.  The code 
  was already in pretty good shape w.r.t. all arguments having their intent 
  declared.  There are still a few places where intent needs to be added though.
===============================================================
===============================================================

cam2_0_2_dev62
Originator: hender ( Tom Henderson)
Date: Fri Jan 23 10:49:42 MST 2004
Model: CAM
Version: CAM2.0_2.dev62
One-line Summary: IPCC scenario changes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes, new namelist variables, new data files
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC-Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Conley, Bundy, Rosinski
Restart files change: no
Changes answers: no (bit-for-bit) for runs that do not use prognostic sulfates, 
Yes otherwise
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

   1. Complete documentation of the changes, including:
      a. A list of any subroutines eliminated;
>> cam1/models/atm/cam/src/physics/cam1/Population.F90
>> cam1/models/atm/cam/src/physics/cam1/aerosols.F90
>> cam1/models/atm/cam/src/physics/cam1/ramp_ghg_bau.h
>> cam1/models/atm/cam/src/physics/cam1/ramp_ghg_stab.h
>> cam1/models/atm/cam/src/physics/cam1/ramp_scon.h

      b. A list of any subroutines added and what they do; and
>> cam1/models/atm/cam/src/physics/cam1/carbonscales.F90
>>   Formerly Population.F90
>> cam1/models/atm/cam/src/physics/cam1/prescribed_aerosols.F90
>>   Formerly aerosols.F90
>> cam1/models/atm/cam/src/utils/timeinterp.F90
>>   Combined repeated code bits into a new subroutine.

      c. For existing files that have been modified, an itemized list
         of the changes and where they can be found
      (NOTE:  A cvs command that generates all of the above information can be
              provided in place of individual answers.  For example, "cvs -nq 
              update ..." or "cvs rdiff ...".)
>> cam1/models/atm/cam/bld/DefaultCAMEXPNamelist.xml
>> cam1/models/atm/cam/bld/camexp.pm
>> cam1/models/atm/cam/bld/run-model.pl
>> cam1/models/atm/cam/src/physics/cam1/advnce.F90
>> cam1/models/atm/cam/src/physics/cam1/aerosol_intr.F90
>> cam1/models/atm/cam/src/physics/cam1/chemistry.F90
>> cam1/models/atm/cam/src/physics/cam1/dmsbnd.F90
>> cam1/models/atm/cam/src/physics/cam1/ghg_surfvals.F90
>> cam1/models/atm/cam/src/physics/cam1/inti.F90
>> cam1/models/atm/cam/src/physics/cam1/radae.F90
>> cam1/models/atm/cam/src/physics/cam1/radcswmx.F90
>> cam1/models/atm/cam/src/physics/cam1/radctl.F90
>> cam1/models/atm/cam/src/physics/cam1/ramp.h
>> cam1/models/atm/cam/src/physics/cam1/ramp_scon.F90
>> cam1/models/atm/cam/src/physics/cam1/ramp_so4_mod.F90
>> cam1/models/atm/cam/src/physics/cam1/soxbnd.F90
>> cam1/models/atm/cam/src/physics/cam1/sulfur_intr.F90
>> cam1/models/atm/cam/src/physics/cam1/volcanicmass.F90
>> cam1/models/atm/cam/src/physics/cam1/volcrad.F90
>> cam1/models/atm/cam/src/control/filenames.F90
>> cam1/models/atm/cam/src/control/oznint.F90
>> cam1/models/atm/cam/src/control/runtime_opts.F90
>> cam1/models/atm/cam/src/control/so4bnd.F90
>> cam1/models/atm/cam/src/ocnsice/dom/sst_data.F90
>> cam1/models/atm/cam/src/ocnsice/som/somint.F90
>> cam1/models/lnd/clm2/src/main/lp_coupling.F90
>> 
>>  See below for details of changes.  

   2. Complete documentation of these changes in the code by comments.
>>  DONE

   3. On what machines did you successfully run test-model.pl?  
      a. blackforest
>>  YES
      b. chinook
>>  YES
      c. anchorage-lf95
>>  YES

   4. For all of the runs in #3 above, which version of cam did you 
      compare to (which tag)?  
>>  cam2_0_2_dev61, using hand-tests since test-model does not support 
>>  "-compare" when namelist has changed.  

   5. If bitwise differences were observed, how did you prove they were no 
      worse than roundoff?  
>>  bit-for-bit

   6. Does the CAM Users Guide need to be updated due to these changes?  
      (Possible reasons include changes to the namelist, history output, 
      configure script, build or run process, etc.)  
>>  Yes
      If so, has the CAM Users Guide been updated in the CVS repository?  
>>  No


>> 
>>  Source:  http://www.cgd.ucar.edu/cseg/plans/ipcc_plan2.txt  01/23/04
>>
>> IPCC Features in CAM
>> 
>> Requirements
>>  . thoroughly tested
>>  . releaseable, reproducible, community usable
>>  . usable for 1990, 1870, historicals, future, paleo
>>    (without changing source code, only namelist?)
>>  . no hacks, no magic dates in code
>>  . datasets available to support T85 resolution (T42?, T31?)
>>  . implementation must be general, namelist and dataset must be
>>    robust for the specified use cases below.  that means making
>>    sure that 1870-2000 datasets can be used robustly in the model
>>    on Jan 1, 1870 and Jan 1, 2000, and that future datasets can
>>    be used in the model robustly on Jan 1, 1990.
>> 
>> -------------------------------
>> 
>> Present 1870 control run mods relative to 1990 controls
>>   Add CAM namelists f11vmr, f12vmr, co2vmr, ch4vmr, n2ovmr
>>   Add CAM namelist carscl=0.3
>>   Add CAM namelist sulscl=0.0
>> 
>> -------------------------------
>> 
>> Dust, Sea Salt
>>   . seasonal cycle of monthly averages, data(x,y,z,12)
>>   . dataset is resolution dependent, requires T42 and T85 datasets
>>   . same datasets will be used for all runs
>>   . can be scaled, scaling will always be 1
>>   . this has always been on
>>   . file name AerosolMass*
>>   . file also includes carbon which is also always on
>>   Tasks
>>     + Review dataset, verify supports all resolutions; T85, T42, T31, 2x2.5
>>       (Andrew, Bill, Jim R)
>>     - Verify correct datasets in CAM scripts (Andrew, Tom)
>>     + Implement changes to CCSM scripts as needed (Tony, Mariana)
>>   Namelist
>>     bndtvaer
>> 
>> Carbon
>>   . carbon dataset is in same file as Dust, Sea Salt, same format (x,y,z,12)
>>   . in file AerosolMass
>>   . always on, carscl can scale, default 1.0
>>   . carscl=0.3 for 1870 run, continuous with pop dataset
>>   . historical will be based on population dataset (t)
>>   . time interpolation is flexible, can have varying dt in dataset
>>   . dataset "easy to generate"
>>   . endruns if date outside dataset
>>   . dataset will cover 1870 to 2000
>>   . 2000 to 2300 constant carscl at 2000 (1.0)
>>   . 1870 and future will use carscl, historical will use dataset
>>   . "ramp year" namelist implementation is defered  
>>   Tasks
>>     + Rename carbon_by_pop to scenario_carbon_scale, char string input
>> (Andrew)
>>     + Rename bndtvpop to bndtvcarbonscale (Andrew)
>>     + Generate a 1870-2000 dataset (Andrew)
>>     + Verify carbon will call endrun if date is outside dataset boundaries
>> (Andrew)
>>     - Verify correct datasets and namelist in CAM scripts (Andrew, Tom)
>>     + Implement changes to CCSM scripts as needed (Tony, Mariana)
>>   Namelist
>>     bndtvaer
>>     carscl
>>     scenario_carbon_scale  (RAMPED, FIXED), ramped will turn on use of
>> dataset, fixed
>>       means use carscl.
>>     bndtvcarbonscale
>> 
>> Solar
>>   . normally a constant, namelist (scon) can override default
>>   . can turn on ramping via scenario_scon
>>   . ramping data is implemented as data statement and include file
>>   . 1870-2000 dataset
>>   . all runs with using ramping feature, 1870 will use rampyear_scon
>>     set to 1870, future runs will use rampyear_scon set to "2005"
>>   Tasks
>>     - Create solar dataset, end solar cycle in middle of 11 year cycle
>>       around 2005, verify dataset, (Lawrence, Caspar)
>>     + Remove include file and data statement, add read of netcdf dataset (Tom)
>>     - Move datasets to inputdata and verify naming convention (Lawrence, Tom)
>>     + Verify solar calls endrun if using ramped feature and date is outside
>>       dataset range (Tom)
>>     + Implement in source code ability to use new namelist convention
>>       (bndtvscon)  (Tom)
>>     - Verify correct datasets and namelist in CAM scripts (Lawrence, Tom)
>>     + Implement changes to CCSM scripts as needed (Tony, Mariana, Lawrence)
>>     - Verify functionality of scenario and rampYear via code review
>>       or validation runs (Tom, Lawrence)
>>   Namelist
>>     scon  (won't be used)
>>     scenario_scon (RAMPED)
>>     bndtvscon 
>>     rampYear_scon 
>> 
>> GHGs
>>   . 5 tracers, f11, f12, co2, ch4, n2o
>>   . normally a constant, namelist can override the constants
>>   . can turn on ramping
>>   . ramping data is implemented as data statement and include file,
>>   . turns on some ghg chemistry, IPCC will use that feature, automatically
>>     turned on when ramped feature is used
>>   . future scenarios will be time varying
>>   . Use scenario_ghg = RAMPED always
>>   . set rampYear_ghg to 1870 for 1870 control
>>   . there will be multiple datasets, 1870-2000 for historical, several
>>     1990 to future datasets.
>>   . requires pcnst=pcnst+4
>>   Tasks
>>     + Talk to Byron or Jeff about ghg chemistry (Bill)
>>     + Generate 1870-2000 netcdf ghg dataset (Lawrence)
>>     - Generate 1990-future netcdf ghg datasets (Lawrence, Gary)
>>     + Remove include file and data statement, add a dataset (Tom)
>>     + Verify ghg code calls endrun if year outside dataset for ramped
>>       usage (Tom)
>>     + Implement in source code ability to use new namelist convention
>>       (bndtvghg)  (Tom)
>>     - Move datasets to inputdata and verify naming convention (Lawrence, Tom)
>>     - Verify correct datasets and namelist in CAM scripts (Lawrence, Tom)
>>     + Implement changes to CCSM scripts as needed (Tony, Mariana, Lawrence)
>>   Namelist
>>     f11vmr  (won't be used)
>>     f12vmr  (won't be used)
>>     co2vmr  (won't be used)
>>     ch4vmr  (won't be used)
>>     n2ovmr  (won't be used)
>>     scenario_ghg   (RAMPED)
>>     rampYear_ghg
>>     bndtvghg
>>     trace_gas
>>     read_trace
>> 
>> Volcanics
>>   . one field, mvolc(x,y,z,t), 1 sample per month
>>   . flexible time interpolation, won't handle years outside dataset bounds
>>   . turned off by default
>>   . should be on for historicals only, datafile for 1870-2000
>>   . will do spatial interpolation
>>   Tasks
>>     + Generate 1870-2000 dataset and review for historical runs, make
>>       sure volcanics go to 0.0 at edges of dataset, make sure model
>>       calls endrun if strat_volc=true and date is outside bounds of
>>       dataset (Andrew, Caspar)
>>     + Move datasets to inputdata and verify naming convention (Andrew)
>>     - Verify correct datasets and namelist in CAM scripts (Andrew, Tom)
>>     + Implement changes to CCSM scripts as needed (Tony, Mariana)
>>   Namelist
>>     strat_volc = .true.
>>     bndtvvolc = 'dataset'
>> 
>> Sulfate 
>>   . three different tracers in three datasets, dms, oxidants, sox
>>   . dms is f(x,y,t), seasonal cycle with 12 time samples
>>   . oxidants is f(x,y,z,t) seasonal cycle with 12 time samples
>>   . dms and oxidants are seasonally repeating, not a function of "year"
>>   . sox(x,y,2,t) is 4 samples/year, varying over different years
>>   . sox time interpolation works fine, no extrapolation currently
>>   . dataset must be generated on CAM grid
>>   . REQUIRES pcnst = pcnst+4 (not 3)
>>   . historical and future will use ramped feature with time varying data
>>   . 1870 run will use ramped feature with rampyear_prognostic_sulfur set to
>> 1870
>>   . some sort of huge(int) intrinsic value needs to be default for rampyear
>>   Tasks
>>     + Design new namelist, prescribed_sulfur and prognostic_sulfur
>>        and usage/features (Bill, Andrew, Phil)
>>     + Remove dead namelist, aero_sulfur, aero_feedback_sulfur, implement new 
>>       namelist and features (see below) (Andrew and Dani)
>>     + Remove (3) old dataset namelist (dms_emis, oxid, sox_emis) and add 
>>       (3) new dataset namelists (see below) (Dani)
>>     + Verify endrun is called if date outside sox datasets  (Dani)
>>     + Generate 1870-2000 sox dataset for T85 (Dani, Gary)
>>     + Generate future datasets for sulfur (Dani, Lawrence, Gary)
>>     + Move all datasets to inputdata and verify naming convention 
>>       (Andrew, Dani)
>>     - Verify correct datasets and namelist in CAM scripts (Andrew, Dani, Tom)
>>     + Implement changes to CCSM scripts as needed (Tony, Mariana)
>>   Namelist
>>     bndtvdms 
>>     bndtvoxid
>>     bndtvsox 
>>     scenario_prescribed_sulfur  (FIXED (DEFAULT), RAMPED)
>>     rampyear_prescribed_sulfur
>>     prescribed_sulfur  (off, passive, direct (DEFAULT))
>>     scenario_prognostic_sulfur  (FIXED (DEFAULT), RAMPED)
>>     rampyear_prognostic_sulfur
>>     prognostic_sulfur  (off (DEFAULT), passive, direct)
>> 
>> Ozone
>>   . ozone function of (x,y,z,t) with seasonal cycle
>>   . use T42 dataset with monthly data, 1870-2000, (850Mb)
>>   . ozone dataset not CAM grid dependent, does space interpolation
>>   . for 1870, use 1870 only dataset with cycling set to true
>>   . for historical, use 1870-2000 with cycling set to false
>>   . for future, use 2000 dataset with cycling set to true
>>   . tropopause consistency issue
>>   . defer namelist changes
>>   Tasks
>>     - Generate 1870-2000 monthly dataset on T42, spoof to 1870 (Lawrence)
>>     - Generate 1870 and 2000 cycling datasets (Lawrence)
>>     - Create, review, and validate datasets, dataset continuity between 
>>       1870 cycling dataset, 1870-2000 dataset, 2000 cycling dataset (Lawrence)
>>     - Move datasets to inputdata and verify naming convention (Lawrence, Tom)
>>     - Verify correct datasets and namelist in CAM scripts (Tom)
>>     + Implement changes to CCSM scripts as needed (Tony, Mariana)
>>   Namelist
>>     bndtvo
>>     ozncyc
>> 
>> -------------------------------
>> 
>> Tony will monitor overall task progress
>> Tom will collect code mods and CAM script mods and coordinate checkin
>> Tony will coordinate changes in CCSM scripts
>> 
>> -------------------------------
>> 
>> Use Cases:
>> 
>> 1990 control - runs out of the box without above turned on, 
>>   this is not the same as historical run at 1990 or 1990 control
>>   done similar to 1870.  use pcnst = 3
>> 
>> (no source code mods required to switch between 1870, 1990,
>> historical, future cases below, pcnst = 11 for all cases)
>> 
>> 1870 control, pcnst = 11 in build, standard namelist plus, 
>> X means not needed or current default inside model (included
>> for clarity)
>> 
>>    bndtvaer         = AerosolMass_V_128x256_clim_c031022.nc
>>  X scenario_carbon_scale  = 'FIXED'
>>    carscl           = 0.3
>>  X bndtvcarbonscale = carbonscaling_1870-1999_c040114.nc
>>    scenario_scon    = 'RAMPED'
>>    rampYear_scon    = 1870
>>    bndtvscon        = *.nc  (1870-2005 dataset TBD)
>>    scenario_ghg     = 'RAMPED'
>>    rampYear_ghg     = 1870
>>    bndtvghg         = ghg_1870_2100_c040122.nc
>>    trace_gas        = .true.
>>    read_trace       = .false.
>>  X strat_volcanic   = .false.
>>  X bndtvvolc        = VolcanicMass_1870-1999_64x1_L18_c040115.nc
>>    bndtvdms         = DMS_emissions_128x256_clim_c040122.nc
>>    bndtvoxid        = oxid_128x256_L26_clim_c040112.nc
>>    bndtvsox         = SOx_emissions_128x256_L2_c040109.nc
>>    scenario_prescribed_sulfur = 'FIXED'
>>    prescribed_sulfur = 'passive'
>>    scenario_prognostic_sulfur = 'RAMPED'
>>    rampYear_prognostic_sulfur = 1870
>>    prognostic_sulfur = 'direct'
>>  X ozncyc           = .true.
>>    bndtvo           = *.nc  (1870 dataset)
>> 
>> historical (1870-2000),  hybrid startup at year 1870, run to 2000
>> pcnst = 11 in build, set namelist as follows, X means not needed or 
>> current default, * indicate changes from 1870 control
>> 
>>    bndtvaer         = AerosolMass_V_128x256_clim_c031022.nc
>> *  scenario_carbon_scale  = 'RAMPED'
>> *X carscl             (remove)
>>    bndtvcarbonscale = carbonscaling_1870-1999_c040114.nc
>>    scenario_scon    = 'RAMPED'
>> *X rampYear_scon      (remove)
>>    bndtvscon        = *.nc  (1870-2005 dataset TBD)
>>    scenario_ghg     = 'RAMPED'
>> *X rampYear_ghg       (remove)
>>    bndtvghg         = ghg_1870_2100_c040122.nc
>>    trace_gas        = .true.
>> *  strat_volcanic   = .true.
>>    bndtvvolc        = VolcanicMass_1870-1999_64x1_L18_c040115.nc
>>    bndtvdms         = DMS_emissions_128x256_clim_c040122.nc
>>    bndtvoxid        = oxid_128x256_L26_clim_c040112.nc
>>    bndtvsox         = SOx_emissions_128x256_L2_c040109.nc
>>    scenario_prescribed_sulfur = 'FIXED'
>>    prescribed_sulfur = 'passive'
>>    scenario_prognostic_sulfur = 'RAMPED'
>> *  rampYear_prognostic_sulfur = (remove)
>>    prognostic_sulfur = 'direct'
>> *  ozncyc           = .false.
>> *  bndtvo           = *.nc  (1870-2000 dataset TBD)
>> 
>> future (1990-), hybrid startup at year 1990 from historical 1990,
>> pcnst = 11 in build, set namelist as follows, X means not needed or 
>> current default, * indicate change from historical run
>> 
>>    bndtvaer         = AerosolMass_V_128x256_clim_c031022.nc
>> *X scenario_carbon_scale  = 'FIXED'
>> *X carscl           = 1.0
>>  X bndtvcarbonscale = carbonscaling_1870-1999_c040114.nc
>>    scenario_scon    = 'RAMPED'
>> *  rampYear_scon    = 2005
>>    bndtvscon        = *.nc  (1870-2006 dataset TBD)
>>    scenario_ghg     = 'RAMPED'
>>  X rampYear_ghg       (remove)
>> *  bndtvghg         = *.nc  (future dataset TBD)
>>    trace_gas        = .true.
>> *X strat_volcanic   = .false.
>>  X bndtvvolc        = VolcanicMass_1870-1999_64x1_L18_c040115.nc
>>    bndtvdms         = DMS_emissions_128x256_clim_c040122.nc
>>    bndtvoxid        = oxid_128x256_L26_clim_c040112.nc
>>    bndtvsox         = SOX_T85_future
>>    scenario_prescribed_sulfur = 'FIXED'
>>    prescribed_sulfur = 'passive'
>>    scenario_prognostic_sulfur = 'RAMPED'
>>    prognostic_sulfur = 'direct'
>> *X ozncyc           = .true.
>> *  bndtvo           = *.nc  (2000 dataset TBD)
>> 
>> ---------------------------------
>> 
>> Available (and validated) Datasets:
>> 
>> bndtvaer: (rad dir)
>>  AerosolMass_V_128x256_clim_c031022.nc               T85
>>  AerosolMass_V_64x128_clim_c031022.nc                T42
>>  AerosolMass_V_48x96_clim_c031022.nc                 T31
>>  AerosolMass_V_2x2.5_clim_c031022.nc                 2x2.5
>> 
>> bndtvdms: (scyc dir)
>>  DMS_emissions_64x128_c030722.nc                     T42
>>  DMS_emissions_128x256_clim_c040122.nc               T85
>> 
>> bndtvoxid: (scyc dir)
>>  oxid_3d_64x128_L26_c030722.nc                       T42
>>  oxid_128x256_L26_clim_c040112.nc                    T85
>> 
>> bndtvsox: (scyc dir)
>>  SOx_emissions_64x128_L2_c031219.nc                  T42 (1870+historical)
>>  -                                                   T42 (A1)
>>  -                                                   T42 (A2)
>>  -                                                   T42 (B1)
>>  -                                                   T42 (B2)
>>  SOx_emissions_128x256_L2_c040109.nc                 T85 (1870+historical)
>>  SOx_emissions_A1_128x256_L26_1990-2100_c030121.nc   T85 (A1)
>>  SOx_emissions_A2_128x256_L26_1990-2100_c030121.nc   T85 (A2)
>>  SOx_emissions_B1_128x256_L26_1990-2100_c030121.nc   T85 (B1)
>>  SOx_emissions_B2_128x256_L26_1990-2100_c030121.nc   T85 (B2)
>> 
>> bndtvo: (ozone dir)
>>  pcmdio3.r8.64x1_L60_clim_c970515.nc                 (present day cycling
>> dataset)
>>  -                                                   (1870 cycling)
>>  -                                                   (1870-2000)
>>  -                                                   (2000 cycling)
>> 
>> bndtvvolc: (rad dir)
>>  VolcanicMass_1870-1999_64x1_L18_c040115.nc          (1870-2000 dataset)
>> 
>> bndtvcarbonscale: (rad dir)
>>  carbonscaling_1870-1999_c040114.nc                  (1870-2000 dataset)
>> 
>> bndtvscon: (rad dir)
>>  scon_1870_2100_c040122.nc                           (CAM default, do not 
>>                                                       use)
>>  -                                                   (1870-2006 dataset)
>> 
>> bndtvghg: (ggas dir)
>>  ghg_1870_2100_c040122.nc                            (CAM default,
>> 1870+historical)
>>  -                                                   (A1)
>>  -                                                   (A2)
>>  -                                                   (B1)
>>  -                                                   (B2)

===============================================================
===============================================================

cam2_0_2_dev61
Originator: mirin ( Arthur Andrew Mirin)
Date: Wed Jan 14 11:51:56 MST 2004
Model: CAM
Version: CAM2.0_2.dev61
One-line Summary: Finite Volume and Transpose Improvements (2 of 2)
This is the second of two successive archive updates. The only changed
routine is dynamics/fv/geopk.F90. Due to reordering of computations,
there are roundoff differences.

cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer
Restart files change: no
Changes answers: Yes (same to roundoff for FV), EUL and SLD are bit-for-bit.
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

Reordering of computations in FV geopk.F90 causes roundoff changes.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev60
Originator: mirin ( Arthur Andrew Mirin)
Date: Wed Jan 14 11:39:22 MST 2004
Model: CAM
Version: CAM2.0_2.dev60
One-line Summary: Finite Volume and transpose improvements (1 of 2)
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes
Mprun2d namelist no longer exists; relevant variables in CAMEXP namelist.
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer, Eaton
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

This is the first of two successive archive updates. These changes are
bit-fot-bit.

Summary of changes:

Removal of mprun2d namelist. This involved creating routines
spmd_dyn_defaultopts and spmd_dyn_setopts with optional arguments. I
mimicked the procedure in phys_grid.F90. In runtime_opts.F90 I put
"dycore_is" test around the calls, and I created dummy versions in
dynamics/eul and dynamics/sld. The initial dummy versions were just
subroutine and end statements, with no arguments. However, the code would
not compile; there were complaints about inaccessible routines and
needing explicit interfaces with optional arguments. I ended up putting
'public' declarations in the EUL and SLD versions and using the same
argument list as with the FV version. (I think the key problem was the
argument list more than the public declaration.) I know it is our
intention to have different versions (with different arguments) of these
routines for the different dycores, but that clearly didn't work; the
present solution is out of expediency. I suspect that the fact that the
arguments are optional is central to the problem. I used optional
arguments only because that is what was done in phys_grid.F90. Also, one
of the namelist variables (modcomm_method) will eventually apply outside
of FV once we use mod_comm transposes outside of FV, so it will
eventually have to be moved or replicated.

Single coding path for 1-D and 2-D decompositions for FV dycore. TWOD_YZ
ifdef eliminated. The "xy" variables are always invoked (e.g., ptxy). The
twod_decomp variable now refers to whether or not transposes (versus
copies) are called to go between yz and xy decompositions; naturally
copies are relevant only for 1-D decomposition; for debugging purposes,
one can force transposes even with 1-D decomposition (see new namelist
variable force_2d). Also, there is a new FV runtime diagnostic (not
input) variable (called spmd_on) that indicates SPMD versus non-SPMD.

Method for FV transposes now runtime rather than compile time (although
the choice between ordinary MPI and MPI-2 is still compile-time). For
ordinary MPI, the choice is between invoking temporary contiguous buffers
versus using MPI derived types. The relevant namelist variable is
modcomm_method (0 for contiguous buffers, 1 for derived types (default)).
MPI-2 presently has 4 options (0,1(default),2,3) (options 0,1,2 use
contiguous buffer at target; 0 is for contiguous source buffers; 1 is for
direct MPI_put's of contiguous segments, with threading over the
segments; 2 is for MPI derived types at the source with threading over
target; option 3 is for MPI derived types at source and target, with
threading over target; option 3 involves re-definition of windows and is
probably not optimal). For MPI-2, one specifies "USE_MPI2" precompile
flag when configuring.

New configure option "-precomp <string>", where string is a non-empty
list of precompile flags to be placed in misc.h. For example, one can
specify "-precomp USE_MPI2" for MPI-2 mod_comm transposes.

Option to use nested OpenMP constructs for FV dycore on IBM. This must be
specified at compile time using new configure option "-nested_omp"; this
has effect on misc.h and the Makefile. In sw_core.F90 and tp_core.F90
(which are already threaded with respect to z), latitude loops are
threaded. The number of inner threads is the new namelist variable
"ompnest", which must divide evenly into the total number of threads; the
number of outer threads will be the total number of threads divided by
"ompnest". IBM's implementation is non-standard.

Option to use mod_comm for dynamics/physics transposes when using
load-balanced chunking. In phys_grid.F90, the "alltoall" flag is replaced
by new namelist variable "phys_transpose" (1 for original alltoall
(default), 2 for Pat Worley's send_and_receive, 3 for mod_comm). Because
mod_comm is presently compiled and linked only for FV, the mod_comm
option is presently valid only for FV; it must be activated at compile
time with the MODCM_DP_TRANSPOSE if-def (use precomp option in
configure).

Miscellaneous transpose improvements and code cleaning.

Deletion of configure_fv.pl and script.m4.

I also created the necessary surface data and aerosol files to support
the FV 0.5x0.625 resolution. The CAM and CLM default namelists were
updated accordingly. This required updating
tools/interpaerosols/REGRID.pl as well.

*****************************************************************
With the removal of the TWOD_YZ if-def and mprun2d namelist, the
interactive configuration procedure no longer queries for the 2-D
decompositions, and test-model contains no references to 2-D
decompositions. The validity of 2-D decompositions is checked in
spmd_dyn.F90. To impart 2-D decompositions in test-model, one needs to
set the camexp namelist accordingly. A decision needs to be made on which
decompositions are to be used, and the necessary changes must be made in
the namelist specification.
*****************************************************************

Changed files:

utils/pilgrim: mod_comm.F90, mod_irreg.F90, parutilitiesmodule.F90

bld: CAM_config.pm, CAM_namelist.pm, CAM_run.pm, configure, Makefile,
DefaultCAMEXPNamelist.xml, DefaultCLMEXPNamelist.xml,
config_cache_defaults.xml, mprun2d.pm (deleted), configure_fv.pl
(deleted), script.m4 (deleted)

test/system: CAM_test.pm, test-model.pl

tools/interpaerosols: REGRID.pl

src/physics/cam1: phys_grid.F90

src/control: cam.F90, history.F90, runtime_opts.F90

src/dynamics/fv: cd_core.F90, d2a3dijk.F90, d2a3dikj.F90,
dp_coupling.F90, dyn_grid.F90, dynamics_vars.F90, dynpkg.F90, geopk.F90,
pmgrid.F90, spmd_dyn.F90, stepon.F90, sw_core.F90, te_map.F90,
tp_core.F90, trac2d.F90, uv3s_update.F90


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================
cam2_0_2_dev59
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Jan  8 13:52:37 MST 2004
Model: CAM
Version: CAM2.0_2.dev59
One-line Summary: updated clm code to clm3_deva_01 (vector version of clm)
  Requires change in build system: no (see below)
  ecosysdyn/ is no longer needed in clm Filepath (will not
  trigger error if it is there)
Substantial timing or memory changes: Yes (describe)
  3-5% performance improvement should be obtained	
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Forrest Hoffman, Dave Parks, Keith Oleson
Restart files change: yes (for clm)
  Backwards compatilibity with older restart files have been incorporated	
Changes answers: Yes (same-climate)
Changes to CLM land-model: Yes (see below)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  no, I plan to.
Changes made:
1) Updated the clm code to clm3_dev_01 (the vector version of clm).
   Both offline and cam-clm stand-alone runs showed that the new code
   resulted in the same climate. For the cam-clm validation diagnostic 
   results see:
      http://www.cgd.ucar.edu/tss/clm/diagnostics/cam_clm2/cam202d39clm2d47a-cam202d39clm2d36a/sets.htm
2) Modified models/atm/cam/bld/configure to removed ecosysdyn/ from
   the clm filepath.	  
===============================================================
===============================================================

cam2_0_2_dev58
Originator: aconley ( Andrew J. Conley)
Date: Wed Jan  7 13:53:42 MST 2004
Model: CAM
Version: CAM2.0_2.dev58
One-line Summary: added volcanic aerosols and population based carbonaceous aerosol scaling
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (same-to-roundoff, same-physics)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  no, I plan to.
Changes made:
New documentation:
UG-20.html
UG-20a.html
UG-27.html
UG-45.html
table_of_contents.html
                                                                                
addition of filenames for volcanic mass, new optics, and population data
as well as namelist variables for strat_volcanic and carbon_by_pop
filenames.F90
DefaultCAMEXPNamelist.xml
camexp.pm
runtime_opts.F90
                                                                                
advnce.F90      initialization for volcanics and population
                                                                                
aer_optics.F90 added volcanic optics
aerosols.F90  added massfields for volcanics
volcanicmass.F90 (new file) read, interpolate volcanic masses
radctl.F90  added diagnostics for volcanic masses and effects of volcanics
                                                                                
radcswmx.F90  added volcanic mass shortwave effects
                                                                                
                                                                                
Added effects of volcanics
radclwmx.F90
radae.F90
trcab.F90
trcabn.F90
trcems.F90
volcrad.F90 (new file)
                                                                                
Population.F90 (new file) read population history and provide carbonaceous aerosol scaling factor based on population
                                                                                
New data files
bndtvvolc: historical masses from volcanic eruptions
bndtvpop: estimates of global total population
                                                                                
appended new volcanic shortwave optics to aeroptics


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev57
Originator: mvr ( Mathew Rothstein)
Date: Fri Jan  2 12:03:34 MST 2004
Model: CAM
Version: CAM2.0_2.dev57
One-line Summary: Upgrade CSM share; Upgrade ESMF; Add namelist option brnch_retain_casename; Update ccsm_msg to remove chunks and knuhcs; caseid now length 80; Remove goto from aerosols.F90.
cam-bugs Requests resolved: none
Requires change in build system: yes 
-references to directory csm_share now point to csm_share/shr
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux (Lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, tcraig, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
- Updated ESMF to ESMF0_0_4
- Updated CSM_SHARE to share3_0_2
- added function get_chunk_owner_p in src/physics/cam1/phys_grid.F90: returns 
  the owner of a chunk given the lat, lon 
- modified bld/configure:  references to directory csm_share now point to 
  csm_share/shr
- modified bld/configure_fv.pl: references to directory csm_share now point 
  to csm_share/shr
- modified src/control/ccsm_msg.F90: utilize new function get_chunk_owner_p 
  rather than vars chunks, knuhcs
- modified src/control/filenames.F90: modified length of caseid to 80 from 33; 
  now using shr_kind_cs and shr_kind_cl for strings of length 80 and 256;
  defined new namelist var brnch_retain_casename
- modified src/control/restart.F90: modified var tcase to same length as 
  caseid (shr_kind_cs); implemented new namelist var brnch_retain_casename to
  allow branch runs without a change in casename
- modified src/control/runtime_opts.F90:  added var brnch_retain_casename to
  namelist camexp
- modified src/physics/cam1/phys_grid.F90:  added new function 
  get_chunk_owner_p
- modified src/physics/cam1/aerosols.F90: replaced "goto" statement with code 
  friendlier to compiler optimization 
- updated users guide to reflect new namelist option 

===============================================================
===============================================================

cam2_0_2_dev56
Originator: rosinski ( Jim Rosinski)
Date: Mon Dec 29 15:35:44 MST 2003
Model: CAM
Version: CAM2.0_2.dev56
One-line Summary: Enable restarting coupled model from dev51 restart file.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes (done by mvertens)
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes (in coupled mode they now look like dev51 restart files)
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Modified coupled-mode CAM restart file to be identical to dev51.
o NOTE: Standalone and SOM restart files are NOT the same.

===============================================================
===============================================================

cam2_0_2_dev55
Originator: jmccaa ( James McCaa)
Date: Mon Dec 22 14:11:07 MST 2003
Model: CAM
Version: CAM2.0_2.dev55
One-line Summary: Tuning mods for finite volume 2x2.5.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes - new-climate for FV
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Model parameters have been adjusted for runs using the finite volume
dycore.  Changes occurred in the following routines:
cldwat.F90
cloud_fraction.F90
gw_drag.F90
vertical_diffusion.F90
moistconvection.F90
zm_conv.F90

The turbulence mountain stress parameterization is now turned off.  Also, 
the parameters governing gravity wave drag are now the same for FV as for
the spectral dycores.

===============================================================
===============================================================

cam2_0_2_dev54
Originator: pworley ( Patrick H Worley)
Date: Thu Dec 18 09:27:25 MST 2003
Model: CAM
Version: CAM2.0_2.dev54
One-line Summary: Improved existing and added SMP-aware physics load balancing schemes
cam-bugs Requests resolved: none
Requires change in build system: maybe
To exploit alternative EUL and SLD latitude decomposition, need to add -DMIRROR_DECOMP to Makefile
Substantial timing or memory changes: Yes - benchmarks by Rory Kelley indicate that new opt=0 load balancing improves performance
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC cluster
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Tom Henderson
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

1) Added Henderson, et al's modification to call spmdinit_dyn after runtime_options,
   so that future modifications can use namelist input to decide how to decompose
   dynamics data structures.
    added: control/decompinit.F90
    modified: control/cam.F90, control/spmdinit.F90
2) Added Henderson, et al's modification to move duplicate code (ceil_2, pair)
   to a new spmd_util module.
    added: control/spmd_utils.F90
    modified: dynamics/eul - realloc4.F90, realloc7.F90, scan2.F90, spmd_dyn.F90
              dynamics/sld - realloc4.F90, realloc7.F90, scan2.F90, spmd_dyn.F90
              physics/cam1 - phys_grid.F90
3) Determined number of SMPs and process/SMP map. For EUL and SLD, equidistributed extra 
   latitudes (when mod(NLAT/npes) /= 0) over the SMPs. (This is useful when using option 1
   load balancing. See below.)
    modified: control/spmdinit.F90, dynamics/eul/spmd_dyn.F90, dynamics/sld/spmd_dyn.F90,
              dynamics/fv/spmd_dyn.F90
4) For EUL and SLD, added an option to assign latitudes to processes so that southern 
   hemisphere latitudes and their "mirrors" in the northern hemisphere are assigned 
   to consecutive processes. This is useful when using load balancing options 1 and 3 (see below).
   Currently, this is a compile time option. It will be changed to a runtime option
   in the near future. To enable now, the CPP token MIRROR_DECOMP must be added to the
   FPPFLAGS in the Makefile.
    modified: dynamics/eul - spmd_dyn.F90, bndexch.F90; dynamics/sld - spmd_dyn.F90, bndexch.F90
5) Redesigned load balancing options and implementation. The new options are
    -1: each latitude line is a single chunk, same as 1D dynamics decompositions.
        (UNCHANGED)
     0: split local longitude/latitude blocks into chunks,
        while attempting to create load-balanced chunks.
        (IMPROVED) 
     1: split SMP-local longitude/latitude blocks into chunks,
        while attempting to create load-balanced chunks.
        (NEW)
     2: load balance chunks with respect to diurnal and
        seaonsal cycles and wth respect to latitude, 
        and assign chunks to processor 
        in a way that attempts to minimize communication costs
        (UNCHANGED)
     3: load balance chunks with respect to diurnal and
        seasonal cycles (but not latitude), and assign chunks to 
        processor in a way that attempts to minimize communication 
        costs
        (NEW)

     The implementation was significantly modified. The heuristic for
     load balancing is now identical for options 0-3. The only difference
     between the options is which processes are allowed to communicate 
     when load balancing.`

     Performance comparisons on the IBM indicate that the new option 0 is an improvement
     over the old option 0. The other options (especially option 3) are now
     competitive with option 0, but are not noticeably better. These results are for T85L26
     on 128 processors of Bluesky, and different results may hold on other systems or
     for other problem sizes.

      modified: physics/cam1/phys_grid.F90
           
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev53
Originator: hender ( Tom Henderson)
Date: Mon Dec 15 11:55:00 MST 2003
Model: CAM
Version: CAM2.0_2.dev53
One-line Summary: Improve and extend prototype of new run-time options module.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, anchorage-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton.  Design reviewed by Eaton and Rosinski
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:
Files removed:
models/atm/cam/src/control/comhd.h
models/atm/cam/src/control/parse_namelist.F90
models/atm/cam/src/control/preset.F90

Files added:  
models/atm/cam/src/control/comhd.F90
models/atm/cam/src/control/runtime_opts.F90

Files Modified:
models/atm/cam/src/dynamics/eul/courlim.F90
models/atm/cam/src/dynamics/eul/grcalc.F90
models/atm/cam/src/dynamics/eul/hdinti.F90
models/atm/cam/src/dynamics/eul/hordif.F90
models/atm/cam/src/dynamics/eul/spegrd.F90
models/atm/cam/src/dynamics/sld/courlim.F90
models/atm/cam/src/dynamics/sld/grcalc.F90
models/atm/cam/src/dynamics/sld/hdinti.F90
models/atm/cam/src/dynamics/sld/hordif.F90
models/atm/cam/src/dynamics/sld/spegrd.F90
models/atm/cam/src/physics/cam1/aerosol_intr.F90
models/atm/cam/src/physics/cam1/phys_grid.F90
models/atm/cam/src/control/cam.F90
models/atm/cam/src/control/history.F90



===============================================================
===============================================================

cam2_0_2_dev52
Originator: rosinski ( Jim Rosinski) and John Truesdale
Date: Fri Dec 12 15:56:44 MST 2003
Model: CAM
Version: CAM2.0_2.dev52
One-line Summary: Improve handling of surface fractions, especially in coupled mode (SOM and CCSM)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Rosinski, Truesdale
Restart files change: yes
Changes answers: no (bit-for-bit) except SOM which is roundoff. There is a #define in somoce.F90
                 that if defined will make SOM bfb. If the "puny" criterion of ice_srf.F90 is
                 ever met (aice <= puny = 1.e-12) then there is a possibility that prescribed-ice 
                 mode could be good only to roundoff, but we were unable to generate such a case.
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Install a more permanent fix to erroneous surface fraction calculations
than the quick fix of dev50.  The original bug which dev50 addressed was that
surface fractions were being changed in an incorrect way by calls to
update_srf_fractions in coupled mode (both SOM and CCSM).  At various points
during a timestep, variable ICEFRAC contained either ice fraction of the grid
box or ice fraction of the non-land portion of the grid box.  Routine
update_srf_fractions implicity assumed it was being called to convert a
non-land fraction into a grid box fraction.  In coupled mode,
update_srf_fractions was being called by ccsmrcv every timestep after
receiving surface fraction information from the coupler.  Since ICEFRAC held
ice fraction of the grid box at this point, an erroneous calculation thus
resulted.  The dev50 quick fix was to install ifdefs around the ICEFRAC
recomputation in update_srf_fractions.  In the more permanent fix, array AICE
always represents ice fraction of the non-land portion of the grid box, and
ICEFRAC always represents the ice fraction of the entire grid box.

The updating of surface fractions and verifying their validity is now
segregated into two subroutines, comsrf.F90 routines update_ocnice and
verify_fractions, respectively.  ccsm_msg.F90 routines ccsmrcv and
ccsm_msg_getalb now call verify_fractions, instead of a routine which will
actually change the surface fractions.  If update_ocnice is ever called in
coupled mode it will result in an endrun() call.  Instead, ccsmrcv and
ccsm_msg_getalb now contain explicit code to compute new fractions
(correctly) rather than make calls to update_ocnice.  This resetting should
be unnecessary, but was retained to obtain bit-for-bit reproducibility with
earlier libraries and to avoid concerns about restartability.  We believe the
calls to update_srf_fractions were originally installed to address bizarre
restartability issues in the coupled model.  Ultimately the recomputation of
fractional information (especially landfrac every timestep) should be removed
from these routines. These spots are currently delimited with "bit-for-bit"
comments.

For further details see details on the CAM checkin list.
===============================================================
===============================================================

cam2_0_2_dev51
Originator: mvr ( Mathew Rothstein)
Date: Mon Dec  8 11:29:27 MST 2003
Model: CAM
Version: CAM2.0_2.dev51
One-line Summary: add -Q to Makefile for IBM, added XLSMPOPTS back into run-ibm.csh
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, hender
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:


>> Makefile:  
>>  Add "-Q" for ~1% speedup.  
>> 
>> run-ibm.csh:
>> Add XLSMPOPTS do avoid thread-stack limits that cause seg-fault when 
>> prognostic sulfates, carbon, sea salt, and dust are all turned on.  
>> 
>>   ## suggestion from Jim Edwards to reintroduce XLSMPOPTS on 11/13/03
>>   setenv XLSMPOPTS "stack=256000000"

===============================================================
===============================================================

cam2_0_2_dev50
Originator: jmccaa ( James Mccaa)
Date: Wed Dec  3 15:35:26 MST 2003
Model: CAM
Version: CAM2.0_2.dev50
One-line Summary: Small change to prevent CAM from incorrectly modifying sea ice fractions in SOM/CCSM mode.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

A small change was made to comsrf.F90 to prevent CAM from incorrectly 
modifying sea ice fractions in SOM/CCSM mode.  This corrects an error 
introduced in dev47, and therefore the tags dev47, dev48, and dev49 
should not be used for SOM or CCSM runs.

===============================================================
===============================================================

cam2_0_2_dev49
Originator: hender ( Tom Henderson)
Date: Tue Nov 18 12:26:08 MST 2003
Model: CAM
Version: CAM2.0_2.dev49
One-line Summary: New T85 surface data set with pre-computed fields, fixed SST data sets at T85 and T170, T85 tuning.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

- Modified DefaultCLMEXPNamelist.xml to point to new T85 surface data set from
  Jim McCaa.  This data set contains pre-computed surface fields and cuts more
  than 10 minutes off of T85 initialization.

- Modified DefaultCAMEXPNamelist.xml to point to new climatological sst files
  for T85 and T170 from Jim McCaa.
  Details from Jim McCaa:
  On Fri, 31 Oct 2003, Jim McCaa wrote:
> These two files are intended to replace broken climatological sst files for
> T85 and T170, respectively, in /fs/cgd/csm/inputdata/atm/cam2/sst.
>
>  /fs/cgd/data0/jmccaa/sst_HadOIBl_bc_128x256_clim_c031031.nc
>  /fs/cgd/data0/jmccaa/sst_HadOIBl_bc_256x512_clim_c031031.nc
>
>
> The defaults xml file should be updated to point to these new files,
> replacing> any entries pointing to either of
>  /fs/cgd/csm/inputdata/atm/cam2/sst/sst_HadOIBl_bc_128x256_clim_c020812.nc
>  /fs/cgd/csm/inputdata/atm/cam2/sst/sst_HadOIBl_bc_256x512_clim_c020812.nc
>
> This will primarily affect anyone trying to run Jim R.'s defineqflux
> program,
> i.e. anyone trying to set up a T85 or T170 SOM run.
>
> I produces these new files using the old ones and the command:
> ncks -d time,0,11 <oldsstfile.nc> <newsstfile.nc>

- T85 tuning in cloud_fraction.F90 from Jim McCaa:
49c49
<           rhminl = .92
---
>           rhminl = .91


===============================================================
===============================================================

cam2_0_2_dev48
Originator: rosinski ( Jim Rosinski)
Date: Tue Nov 11 09:12:51 MST 2003
Model: CAM
Version: CAM2_0_2_dev48
One-line Summary: Save memory in aerosol code by holding in-core only 2 time levels of data.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes. per MPI task memory saved @ T42 = 190 MB/ntask
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit), except only roundoff under PC/pgf90
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Revised aerosol reading to be like SST and ozone, keeping in-core only 2
  time levels of data to save memory.  Initialization should speed up lots,
  since 2 time levels of aerosol data are read in instead of 12.  

  It is now feasible from a memory use standpoint to run T85 using 2 MPI
  tasks on a machine with 2 GB of memory.

  BYPASS ifdef was removed since the speedup renders it unnecessary.

  Minor mods were made to sst and ozone interpolation routines for clarity
  and consistency.

  There are still some differences between the new code and ozone/SST
  handling.  There is no "aercyc = .false." namelist option.  Date info is
  gotten from an internal Fortran "data" statement rather than read from a
  boundary dataset.  Existing routine "aerosol_initialize" takes the role of
  what otherwise would be called "aerini" (instead of being named like
  "sstini" and "oznini"), and is called from "inti" instead of "initext".
  There is a new routine "aerint" in aerosols.F90 a la "sstint" and "oznint"
  which is called from "advnce".  Like these routines it reads in a new time
  slice of data when needed.  But the actual time interpolation is done in
  "get_aerosol".  The reasons for these differences have mainly to do with
  maintaining minimal intrusiveness, and the fact that there are plans
  to modify the way time and vertical interpolation of aerosols is done.


===============================================================
===============================================================

cam2_0_2_dev47
Originator: jet ( John Truesdale)
Date: Wed Nov  5 15:41:05 MST 2003
Model: CAM
Version: CAM2.0_2.dev47
One-line Summary: cam usage of  boundary dataset ice fraction made consistant with HADISST data.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no

Substantial timing or memory changes: no
Requires change in run script: no

Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: yes. Ice extent is now reduced around land. 

Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

After computing the ice area of the original datasets and comparing it to
the ice area produced by our t42 model, it became apparent that CAM was
over estimating the ice area. The ice fraction on the boundary dataset was
intrepreted as being the fraction of ice covering an entire gridbox.  A more
accurate way of determining the ice coverage is to regard the boundary
dataset ice fraction as the fraction of ice covering the *non-land* portion
of the grid box.  So

gridbox ice fraction = boundary dataset ice fraction * (1-land fraction)

The ice area produced by cam with this change is now very close to the
original datasets and to the ice area produced by CSM.  The overall effect
is a reduction of ice coverage in those grid boxes with some land fraction.

This change is a one line mod to comsrf.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev46
Originator: pworley ( Patrick H Worley)
Date: Tue Nov  4 15:26:37 MST 2003
Model: CAM
Version: CAM2.0_2.dev46
One-line Summary: Decreased memory requirements in dynamics/eul/inidat and added new load balancing scheme to phys_grid (same as dev39).
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes - decreased number of full 3D fields needed in inidat from 9+(pcnst+pnats) to 4
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Linux cluster
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes (same as dev39)
Changes made:

	The cam2_0_2_dev39 commit failed (on Sep. 29, 2003). This commit reintroduces those changes.
	The following is identical to the dev39 documentation ...

        1) restructured dynamics/eul/inidat.F90 to minimize the memory requirements.
           In the original version, masterproc allocates (9+pcnst+pnats) 3D fields 
           and 16 2D fields. It then reads in or generates the initial data,
           scatters the data, and finally deallocates the arrays. In the revised
           version, subsets of arrays are allocated, initialized, scattered, and
           deallocated together, decreasing the maximum memory requirements to 4 3D fields.
           Note that I implemented the logic that Brian Eaton used in FV inidat (for WACCM)
           to treat each species in q3 separately.

        2) added a new load balancing algorithm in physics/cam1/phys_grid.F90.
           The original global balancing algorithm (opt = 1) eliminates
           imbalances due to the diurnal and seasonal cycles. However, it still
           assigns all polar latitdues to the same processors, the mid-latitudes
           to the same processors, and the equatorial latitudes to the same processors.
           The new algorithm (opt = 2) mixes up the latitudes as well, achieving
           almost perfect load balance. It comes at a cost of increased communication cost
           compared to opt = 1, and may or may not be a performance enhancer for 
           a given system, problem size, and processor count.
						        
        3) added an option to physics/cam1/phys_grid.F90 to implement the transpose_block_to_chunk
           and transpose_chunk_to_block routines using point-to-point MPI commands rather 
           than mpi_alltoallv. This has been important on some systems in the past,
           and is included here as an aid to experimentation. This option is currently
           disabled in the code.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev45
Originator: hender ( Tom Henderson)
Date: Fri Oct 31 11:24:43 MST 2003
Model: CAM
Version: CAM2.0_2.dev45
One-line Summary: Performance optimization for IBM.
cam-bugs Requests resolved: none
Requires change in build system: yes
Fortran compiler optimization for IBM "xlf90" has changed from 
"-O2 -qmaxmem=-1 -Q" to "-O3 -qstrict".  The "-lmass" library is now 
linked in unless DEBUG is on.  
Substantial timing or memory changes: yes, it runs ~5% faster.
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Jim McCaa
Restart files change: no
Changes answers: Yes, same-physics
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Changed optimization in Makefile for IBM.
Changed "sanity checks" in pcond() (cldwat.F90) to make IBM compiler 
happy (bfb).  
Changed "rliq1 sanity check" in pcond() (cldwat.F90) to use Jim McCaa's 
fix (bfb).  

===============================================================
===============================================================

cam2_0_2_dev44
Originator: jmccaa ( James McCaa)
Date: Fri Oct 31 09:48:06 MST 2003
Model: CAM
Version: CAM2.0_2.dev44
One-line Summary: T85 tuning, removal of many default history file fields, modification of dif4 initialization.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit at all resolutions except T85)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
This tag supplies three changes to the model:

1) The tuning of the T85 Eulerian model has been modified through the
   addition of the relative humidity cloud threshold ramp in
   cloud_fraction.F90.  Tuning parameters were also modified in
   zm_conv.F90, moistconvection.F90, and cldwat.F90.   

2) The number of fields on the default monthly history files has been
   reduced substantially.  All fields continue to be available via the
   fincl namelist facility.  Also, default daily history files have
   been eliminated.  

3) The initialization of the diffusion parameters dif4 and dif2 have
   been moved out of build-namelist and into the model.  The default
   dif4 value for T85 has been modified.

The files that were modified are:
>> M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
>> M models/atm/cam/src/control/history.F90
>> M models/atm/cam/src/control/preset.F90
>> M models/atm/cam/src/dynamics/eul/dycore.F90
>> M models/atm/cam/src/dynamics/sld/dycore.F90
>> M models/atm/cam/src/physics/cam1/cldcond.F90
>> M models/atm/cam/src/physics/cam1/cldwat.F90
>> M models/atm/cam/src/physics/cam1/cloud_fraction.F90
>> M models/atm/cam/src/physics/cam1/gw_drag.F90
>> M models/atm/cam/src/physics/cam1/moistconvection.F90
>> M models/atm/cam/src/physics/cam1/vertical_diffusion.F90
>> M models/atm/cam/src/physics/cam1/zm_conv.F90

===============================================================
===============================================================

cam2_0_2_dev43
Originator: rosinski ( Jim Rosinski)
Date: Wed Oct 29 14:02:46 MST 2003
Model: CAM
Version: CAM2.0_2.dev43
One-line Summary: cos(lat) now applied to LANDM field offline.  Since all IC files now require this
                  field (LANDM_COSLAT), new IC fields were generated.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes. Same-to-roundoff T42.  Changes answers other resolutions (due to LANDM).
Changes to CLM land-model: None (except sfc datasets must be generated).
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Migrated multiplication of LANDM field by cos(lat) offline.  One reason to do this was that
model-written IC files were invalid, due to erroneous multiple applications of the above-mentioned
cosine function.  Also, for horizontal resolutions other than T42 there was an  undesirable
resolution-dependent behavior of the LANDM specification algorithm.  In the new approach,
linear interpolation to the target resolution is done from a "master" LANDM dataset, which was
built at T42 (per pjr).  The resulting LANDM_COSLAT field now looks similar regardless of resolution.

The "master" LANDM_COSLAT dataset lives in /fs/cgd/csm/inputdata/atm/cam2/hrtopo/landm_coslat.nc
It is read in by offline tool "definesurf", which has been modified to read it.

Since new IC files are now required for all resolutions, it was decided to introduce consistency 
to these files by using the newest 10-minute hi-res topography dataset when creating them.  The
newest topography file is /fs/cgd/csm/inputdata/atm/cam2/hrtopo/topo10min.merged_c030506.nc
As a consequence of using this new file, existing resolution-specific surface datasets and IC 
files for CLM also are invalid.  Thus for many resolutions (though not T42), CLM must be spun
up for any runs done with cam2.0.2.dev43 and beyond.  These changes are reflected in the xml
files which are used to build CAM and CLM namelists.

===============================================================
===============================================================

cam2_0_2_dev42
Originator: rosinski ( Jim Rosinski)
Date: Tue Oct 28 16:02:07 MST 2003
Model: CAM
Version: CAM2.0_2.dev42
One-line Summary: Eliminate global TS print from physpkg and other minor speedups.
                  Add T85 and 2x2.5 aerosol datasets to xml file.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Minor speedup (see below).
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Eliminated global TS calculation and printout from physpkg.  This code was left over 
from long ago and the output is now more easily obtainable by other means.  Minor speedup.

o Moved calculation of tsice_rad to threaded region.  Minor speedup on IBM, potentially
more significant when OMP_NUM_THREADS is a larger number (e.g. SGI). Unfortunately this 
calculation is needed to create v2 IC files so it cannot be eliminated entirely.  But it is 
only needed when an IC file is generated, not every timestep.  So further speedup is 
possible.

o Made srfflx_state_reset callable by chunk to enable fusing threaded loops.

o Added reference to T85 and 2x2.5 aerosol datasets to CAM namelist xml file.

===============================================================
===============================================================

cam2_0_2_dev41
Originator: jmccaa ( James Mccaa)
Date: Thu Oct 23 15:54:52 MDT 2003
Model: CAM
Version: CAM2.0_2.dev41
One-line Summary: Climate tuning mods for T42 and T85.

cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes, new-climate
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Modifications have been made to allow the code to run using different
physics tuning parameters for different dycores and resolutions.
The values of these parameters have been adjusted following numerous 
sensitivity experiments.

The file cldfrc.F90 has been converted to a module named cloud_fraction.F90, and
an initialization routine has been added.
The files closure.F90, guang.h, and q1q2.F90 have merged into zm_conv.F90.
Minor code modifications have been made to allow greater optimization levels on 
the IBM.

Changed files:
>> M models/atm/cam/src/advection/slt/hordif1.F90
>> M models/atm/cam/src/control/cam.F90
>> M models/atm/cam/src/control/history.F90
>> M models/atm/cam/src/control/preset.F90
>> M models/atm/cam/src/control/spmdinit.F90
>> M models/atm/cam/src/dynamics/eul/dycore.F90
>> M models/atm/cam/src/dynamics/fv/dycore.F90
>> M models/atm/cam/src/dynamics/sld/dycore.F90
>> M models/atm/cam/src/physics/cam1/cldnrh.F90
>> M models/atm/cam/src/physics/cam1/cldwat.F90
>> M models/atm/cam/src/physics/cam1/geopotential.F90
>> M models/atm/cam/src/physics/cam1/inti.F90
>> M models/atm/cam/src/physics/cam1/moistconvection.F90
>> M models/atm/cam/src/physics/cam1/pkg_cld_sediment.F90
>> M models/atm/cam/src/physics/cam1/radae.F90
>> M models/atm/cam/src/physics/cam1/sulchem.F90
>> M models/atm/cam/src/physics/cam1/tphysbc.F90
>> M models/atm/cam/src/physics/cam1/zm_conv.F90
>> M models/csm_share/shr_vmath_mod.F90

Removed files:
>> R models/atm/cam/src/physics/cam1/cldfrc.F90
>> R models/atm/cam/src/physics/cam1/closure.F90
>> R models/atm/cam/src/physics/cam1/guang.h
>> R models/atm/cam/src/physics/cam1/q1q2.F90

Added files:
>> A models/atm/cam/src/physics/cam1/cloud_fraction.F90

===============================================================
===============================================================

cam2_0_2_dev40
Originator: rosinski ( Jim Rosinski)
Date: Wed Oct 22 16:54:16 MDT 2003
Model: CAM
Version: CAM2.0_2.dev40
One-line Summary: Move horizontal aerosol interpolation offline.  Modify print_memusage for readability and portability.
cam-bugs Requests resolved: none
Requires change in build system: yes: resolution-specific aerosol dataset required
Substantial timing or memory changes: yes: faster, uses less memory
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Andrew Conley
Restart files change: no
Changes answers: Yes (same-to-roundoff)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

o Moved horizontal aerosol interpolation to CAM grid offline.  The main reason for
this was to speed up initialization and reduce memory usage when running CAM.  At T42 
using 2 MPI tasks, the memory hi-water mark for MPI task 0 is reduced by about 50%.  
Memory reduction for MPI task 1 is around 20%.

Since the boundary aerosol dataset is now resolution-specific, the amount of speedup vs. 
dev39 will be resolution-dependent, with lower resolutions seeing the biggest benefit.  
There will also be some speedup during the time-integration phase due to reordering loops
and array structure for cache efficiency in aerosol routine vert_interpolate.  Since 
the aerosol initialization code still reads a full 12 months of data, the startup time 
overhead and memory overheads are not insignificant.  We may want to further restructure
the code to read in aerosols the same way as SST and Ozone, keeping just 2 bounding
months of data in-core at any given time.  In the meantime, if time spent reading
the aerosol boundary data still proves to be an annoyance, things can be sped up dramatically
if the aerosol dataset is made local rather than read from an NFS-mounted file system.
Alternatively, #define BYPASS is still available from earlier libs.

The new boundary dataset generation code lives in cam/tools/interpaerosols.  A
README in that directory explains the procedure to generate an aerosol boundary
dataset at the target model resolution.  Resolution-specific aerosol datasets have
already been created for resolutions needed by test-model, and some other common
resolutions.

Mods were also made to the main CAM Makefile.  LAPACK/BLAS routines are only used by the
aerosol initialization procedure, so library references to these routines now only
exist in the offline code.


o Rewrote utility routine print_memusage for readability of output and portability.  It now
works on Linux as well as SGI and IBM.  The point of the routine is to print
memory use information at whatever point in the code the user wishes.  On most machines
the numbers printed refer to hi-water mark, but on Linux they refer to current use (i.e.
on Linux the numbers do not necessarily increase monotonically with time).  Also on
most machines, the printed numbers refer to KB of memory used.  But this is not necessarily
true on all machines (e.g. Linux).  Refer to "man getrusage" on most machines, and "man proc"
on Linux machines for details.  The output from print_memusage now goes to Fortran unit 0,
which in most cases translates to stderr.  So memory use information can be segregated from
stdout by for example: (cam < namelist >! out) >&! err.  This code is far from perfect, e.g.
printed output can still be jumbled between MPI tasks.


Misc. notes:

o To get bit for bit vs. dev39, created a 64-bit aerosol dataset, pasted lon and lat
coordinate variables from a dev39 run into the input/output file required by interpaerosols.
Under pgf90 this is bfb.  Unfortunately this procedure did not yield bfb results on IBM or SGI.

o Input aerosol dataset variable names and output history variable names are as before, but
with an "_V" appended to their name.  This reflects the fact that these variables have 
undergone a vertical sum. The different names will also cause the model to crash if an 
incorrect boundary dataset is used.

===============================================================
===============================================================

cam2_0_2_dev39
Originator: pworley ( Patrick H Worley)
Date: Mon Sep 29 13:44:01 MDT 2003
Model: CAM
Version: CAM2.0_2.dev39
One-line Summary: Decreased memory requirements in dynamics/eul/inidat and added new load balancing scheme to phys_grid.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes - decreased number of full 3D fields needed in inidat from 9+(pcnst+pnats) to 4
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux cluster
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

	1) restructured dynamics/eul/inidat.F90 to minimize the memory requirements.
	   In the original version, masterproc allocates (9+pcnst+pnats) 3D fields 
	   and 16 2D fields. It then reads in or generates the initial data,
	   scatters the data, and finally deallocates the arrays. In the revised
	   version, subsets of arrays are allocated, initialized, scattered, and
	   deallocated together, decreasing the maximum memory requirements to 4 3D fields.
	   Note that I implemented the logic that Brian Easton used in FV inidat (for WACCM)
	   to treat each species in q3 separately.

	2) added a new load balancing algorithm in physics/cam1/phys_grid.F90.
	   The original global balancing algorithm (opt = 1) eliminates
	   imbalances due to the diurnal and seasonal cycles. However, it still
	   assigns all polar latitdues to the same processors, the mid-latitudes
	   to the same processors, and the equatorial latitudes to the same processors.
	   The new algorithm (opt = 2) mixes up the latitudes as well, achieving
	   almost perfect load balance. It comes at a cost of increased communication cost
	   compared to opt = 1, and may or may not be a performance enhancer for 
	   a given system, problem size, and processor count.
	   
        3) added an option to physics/cam1/phys_grid.F90 to implement the transpose_block_to_chunk
	   and transpose_chunk_to_block routines using point-to-point MPI commands rather 
	   than mpi_alltoallv. This has been important on some systems in the past,
	   and is included here as an aid to experimentation. This option is currently
	   disabled in the code.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev38
Originator: hender ( Tom Henderson)
Date: Mon Sep 22 11:46:03 MDT 2003
Model: CAM
Version: CAM2.0_2.dev38
One-line Summary: Bug fix for prognostic aerosols, SE improvements.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Phil Rasch, Brian Eaton, Erik Kluzek
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Fixed bugs and added namelist variables to control prognostic aerosols.  
(Bug fix for prognostic aerosols was provided by Phil Rasch.)  
Improved design of parse_namelist(), prototype implementation is included 
subject to review.  So far design and implementation have been reviewed 
only by Brian Eaton and Erik Kluzek.  
Brought physics performance tuning parameters out to CAMEXP namelist.  

New namelist variables are:  

PHYSICS CONTROLS

AERO_SULFUR
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on sulfur prognostic aerosols.

AERO_FEEDBACK_SULFUR
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on feedback of sulfur prognostic aerosols. May
only be true if AERO_SULFUR is also true.

AERO_CARBON
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on carbon prognostic aerosols.

AERO_FEEDBACK_CARBON
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on feedback of carbon prognostic aerosols. May
only be true if AERO_CARBON is also true.

AERO_SEA_SALT
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on sea salt prognostic aerosols.

AERO_FEEDBACK_SEA_SALT
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on feedback of sea salt prognostic aerosols. May
only be true if AERO_SEA_SALT is also true.


PERFORMANCE TUNING

PHYS_LOADBALANCE
Type:  Integer
Default:   0
Description:   Select different options for organization of physics chunks.
Each uses a different scheme for static load balancing. 

PHYS_CHNK_PER_THD
Type:   Integer
Default:  1
Description:  Select target number of chunks per thread. Must be positive


CHANGED FILES:
  cam1/models/atm/cam/doc/UsersGuide/UG-20.html
  cam1/models/atm/cam/src/dynamics/eul/inidat.F90
  cam1/models/atm/cam/src/dynamics/sld/inidat.F90
  cam1/models/atm/cam/src/dynamics/fv/inidat.F90
  cam1/models/atm/cam/src/physics/cam1/aerosol_intr.F90
  cam1/models/atm/cam/src/physics/cam1/carbon_intr.F90
  cam1/models/atm/cam/src/physics/cam1/dust_intr.F90
  cam1/models/atm/cam/src/physics/cam1/phys_grid.F90
  cam1/models/atm/cam/src/physics/cam1/radctl.F90
  cam1/models/atm/cam/src/physics/cam1/seasalt_intr.F90
  cam1/models/atm/cam/src/physics/cam1/sulchem.F90
  cam1/models/atm/cam/src/physics/cam1/sulfur_intr.F90
  cam1/models/atm/cam/src/physics/cam1/wetdep.F90
  cam1/models/atm/cam/src/control/cam.F90
  cam1/models/atm/cam/src/control/comhd.h
  cam1/models/atm/cam/src/control/parse_namelist.F90



===============================================================
===============================================================

cam2_0_2_dev37
Originator: mirin ( Arthur Andrew Mirin)
Date: Wed Sep 17 16:30:30 MDT 2003
Model: CAM
Version: CAM2.0_2.dev37
One-line Summary: Transpose and other FV improvements
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no (unless test_model did that)
Code reviewed by: myself, Will Sawyer
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

This update accomplishes improvements to the finite-volume transposes and to
the FV dycore itself, as undertaken by Art Mirin and Will Sawyer. Specifically:

(A) The irregular communication routines of the mod_comm library
have been placed in their own module (mod_irreg), to enable use of a unified
version of mod_comm in CAM2 and FVGCM (NASA Goddard). This facilitates making use
of ongoing improvements at Goddard (such as support for SHMEM).

(B) The transpose calls directly reference mod_irreg routines as opposed to
going through the Pilgrim layer. This is true for use of mpi derived types as
well as contiguous buffers. Pilgrim's main function is to set up communication
patterns; mod_irreg then accomplishes the transposes.

By default, the transposes gather/scatter data from/to contiguous buffers. We
have found mpi derived types to be very slightly superior on the IBM.
One can implement use of mpi derived types at compile time by activating the line
"FPPFLAGS   += -WF,-DUSE_MPI_TYPES" in the AIX section of the Makefile.
Support for one-sided (MPI2) communications when using MPI derived types has not
yet been implemented.

(C) There have been other miscellaneous improvements to Pilgrim / mod_comm.

(D) The Held-Suarez, Rayleigh friction and high-pressure mode have been removed
from the FV dycore.

(E) The FV version of inidat.F90 has been rewritten to minimize use of global 3D
arrays.

(F) Additional sectional timing diagnostics have been added, as well as an additional
optional timing barrier in the physics.

(G) There have been other miscellaneous improvements.

The following routine was added:
   cam1/models/utils/pilgrim/mod_irreg.F90

The following routines were deleted:
   cam1/models/atm/cam/src/dynamics/fv: hswf.F90, highp2.F90, dry_adj.F90, rayl_fric.F90

The following routines were modified:
   cam1/models/utils/pilgrim: Makefile, mod_comm.F90, parutilitiesmodule.F90
   cam1/models/atm/cam/bld/Makefile
   cam1/models/atm/cam/src/physics/cam1/physpkg.F90
   cam1/models/atm/cam/src/dynamics/fv: cd_core.F90, d2a3dikj.F90, dp_coupling.F90,
        dynamics_vars.F90, dynpkg.F90, geopk.F90, inidat.F90, inital.F90, mapz_module.F90,
        p_d_adjust.F90, pft_module.F90, pmgrid.F90, restart_dynamics.F90, spmd_dyn.F90,
        stepon.F90, te_map.F90, uv3s_update.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev36
Originator: jmccaa ( James McCaa)
Date: Fri Sep 12 14:32:06 MDT 2003
Model: CAM
Version: CAM2.0_2.dev36
One-line Summary: Merge of physics tuning branch onto cam_dev branch.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux cluster
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers:Yes -- new climate
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The following changes apply to all dycores:
* The fall velocity of large (400 micron) ice crystals has been reduced
   from 3.5 m/s to 1 m/s.
* There is a lapse-rate reduction of the SST used for stratus diagnosis
   when the sea surface elevation is not 0.
* The temperature ramp used to compute the effective radius of warm
   clouds over land now goes from -20 C to 0 C.
* The land fraction ramp over the ocean goes from cos(lat) near the
   coast to 0 at 1000 km from the coast.
* The effective radius and CCN of warm clouds over land now depend
   on snow depth (linear ramp from 0 to 0.1 m liquid water equivalent).
* The evaporative efficiency for rain falling from cumulus has been
   lowered from 3.0e-6 to 2.0e-6.
* Formulae for cloud fraction associated with moist convection have
   been changed.
* Adjustments have been made to the aerosol optics.

The following modifications only apply to the finite volume dycore:
(They are in addition to the changes described above.)
* A new energy fixer has been added.
* The parameterization of gravity wave drag has been modified.
* A new parameterization of orographic form drag has been added.
* The Hack scheme now detrains cloud liquid.
* Evaporation efficiency for stratiform rain has been halved.
* Evaporation efficiency for convective rain has been halved.
* Formulae for cloud fraction associated with moist convection have
   been changed.

The following modififications have been made to keep the standalone
CAM consistent with recent coupled runs:
* The snow fraction on land as a function of snow depth has been
   changed.
* Both visible and near-ir albedos of snow on sea ice have been
   lowered by 0.02.
* Albedos of bare sea ice have been lowered by 0.10 for visible and
   0.06 for near-ir.

There is one infrastructure change:
* ncar_batch.csh now overrides any previously set values of the environment
   variables INC_NETCDF and LIB_NETCDF to point to 64 bit versions

===============================================================
===============================================================
cam2_0_2_dev35
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Sep 10 10:37:47 MDT 2003
Model: CAM
Version: CAM2.0_2.dev35
One-line Summary: fix clm bug that caused problems at very high mpi task number
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Forrest Hoffman
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
 Fixed bug in clm code (lnd_grid.F90) that caused problems to occur at very
 high mpi task number	  
===============================================================
===============================================================

cam2_0_2_dev34
Originator: hender ( Tom Henderson)
Date: Tue Sep  2 12:41:50 MDT 2003
Model: CAM
Version: CAM2.0_2.dev34
One-line Summary: AIX 64-bit addressing and a bunch of other stuff
cam-bugs Requests resolved: 98, (127), 128
Requires change in build system: AIX build now uses 64-bit addressing
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, contributors
Restart files change: no
Changes answers:  Yes (same-to-roundoff for AIX, bfb for all others)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
  Bunch-o-fixes II:
 - Jim Edwards' performance fix for estblf
   - wv_saturation.F90
 - change Makefile (etc.) to use 64-bit on AIX
   - Modified Makefile, run-ibm.csh, CAM_lab.pm
 - From Jim McCaa
   The code already exists in history.F90, but is CPPed out.  So, what I'm
   requesting is to remove the two CPP lines, thereby enabling the code.
   They are:
 line 2501: #if  ( defined CNTL_FORSOM )
 line 2506: #endif
   This won't affect answers, but will add fields to the monthly history
   tape.
 - From John Truesdale:
   In diagnostics.F90 the outfld call for TSICERAD needs to be removed (per
   Jerry O.)  In tphysbc.F90 the DQCOND outfld call needs to be removed
   (duplicate of outfld call using dcconnam).
 - Jim Rosinski kindly offered to add a summary message to cprnc indicating
   how many fields were compared and how many passed bfb.
   - only one file changed:
     /fs/cgd/data0/rosinski/newcprnc/cam1/models/atm/cam/tools/cprnc/cpr.F
 - Fixed bug in fv 2D decomposition (From Art Mirin)
   - Changed dp_coupling.F90 for fv
 - Fixed CAM bug #98 (originally reported by Woo Sun Yang)
   - Francis Vitt (ACD) provided the bug fix for writing staggered 'US' grid
     from history.F90.
 - Attempted to remove undocumented Lahey compiler option from Makefile as
   suggested by Jim Rosinski
 "For some reason the default CAM Makefile includes an undocumented compiler
  flag (-CcdRR8) when using lf95 on the PC.  The documented flag --dbl used
  to suffice for auto-promotion of real to real*8, and has been removed.
  Does anyone know why this was changed?  If not, I propose changing back to
  the documented flag if identical answers can be obtained.  Undocumented
  flags are a bad idea all around, I think.
  JR"
   - Can't make this change because "--dbl" promotes real*4's too (which
     will break MPI communications and history output).
   - Corrected misleading comments about this in Makefile.
 - Implemented Brian Eaton's fix for incorrect override of qmin from namelist
   - Modified all three flavors of initcom.F90
 - Removed ccm366 physics from Default*Namelist.xml.
 - Added new data file for Jerry Olson to DefaultCAMEXPNamelist.xml.
    eul/ncdata_vers=2:  cami_0000-09-01_64x128_L26_c030624.nc
    sld/ncdata_vers=2:  cami_0000-09-01_64x128_L26_c030624.nc
    eul/ncdata_vers=1:  cami_0000-09-01_64x128_L26_030506.nc
    sld/ncdata_vers=1:  cami_0000-09-01_64x128_L26_030506.nc
 - Fix CAM bug #128 (fv build problems on Compaq and SGI) with bug fixes
   from Tony Craig and Wei Yu.
   - Modified cd_core.F90, and ccsm_msg.F90 (physpkg.F90 already fixed)

  dev34 is bfb vs. dev33 on non-AIX machines, but
  roundoff on AIX machines.  AIX perturbation growth of cam2_0_2_dev33 is
  nearly identical to error growth of difference between cam2_0_2_dev33 and
  cam2_0_2_dev34 for all three dycores.  roundoff is entirely due to change
  in AIX compiler options to use 64-bit addressing in Makefile and in cprnc
  Makefile.  This was tested by comparing dev33+(new Makefiles) vs. dev33
  (roundoff differences observed) and comparing dev34-(new Makefiles) vs.
  dev33 (bfb exact).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================
cam2_0_2_dev33
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Aug 25 12:06:15 MDT 2003
Model: CAM
Version: CAM2.0_2.dev33
One-line Summary: updated clm code from clm2_deva_30 to clm2_deva_36
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (new-physics (clm only)
Changes to CLM land-model: Yes
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
Only clm changes have been made in this tag.
	
cam2_0_2_dev32 contains clm2_deva_30 (with some changes on the cam branch for dust
that are only invoked when the cpp variable DUST is defined).

cam_0_2_dev33 contains clm2_deva_36 (which has incorporated the above dust mods). 

The following summarizes the changes between clm2_deva_30 and clm2_deva_36. 
The changes that lead to greater than roundoff differences are denoted by (*).

 1)  Put in dust mods in cam2_0_2_dev32.
*2*) Put in bug fix to BareGroundFluxesMod.F90 so that z0hg and z0qg at the column
     level would not be set by pft level quantities. This changes answers to more
     than roundoff.
 3)  Put in bug fix in Biogeophysics2Mod.F90 so that would not divide by
     zero when calculating the ratio of soil evaporation for a pft relative 
     to the total of all evaporating PFTs. This would occur if the weight
     became 0. in the dgvm calculation. This results in bfb answers in non-dgvm mode.
 4)  Put in bug fix to BareGroundFluxesMod.F90 so that z0hg and z0qg at the column
     level would not be set by pft level quantities. This changes answers to more
     than roundoff.
 5)  Put in bug fix in Biogeophysics2Mod.F90 so that would not divide by
     zero when calculating the ratio of soil evaporation for a pft relative 
     to the total of all evaporating PFTs. This would occur if the weight
     became 0. in the dgvm calculation. This results in bfb answers in non-dgvm mode.
 6)  Put in a change to DGVMMod.F90 to fix a bug in history file output
     in compete mode (the default now).
*7*) Reversion to old fraction snow cover algorithm (clm2_deva_32)
 8)  Made clmtype variables relating to soil hydraulic and thermal properties 
     column physical state properties rather than land physical state properties 
 9)  Fixed DGVM restart problem in compete mode:
     Modified restFileMod.F90 and DGVMMod.F90 so that average over all
     column pfts for h2ocan (needed by begwb computation in routine
     driver.F90) is done in restfileMod.F90 only for non-DGVM mode and in
     resetWeightstDGVM (in module DGVMMod.F90) for DGVM mode (since this
     needs to be done after the weights are reset in the DGVM case).
 10) Modified tssbef dimension in clmtype.F90 to be consistent. 
===============================================================
	
===============================================================

cam2_0_2_dev32
Originator: pworley ( Patrick H Worley)
Date: Tue Aug 19 20:38:06 MDT 2003
Model: CAM
Version: CAM2.0_2.dev32
One-line Summary: Chunking data structures and optimizing interprocessor communication in ozone routines
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes (performance improves for large process counts)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The original version of oznini reads in two timelevels of ozone data
and saves them in masterproc. masterproc then interpolates the data to the
current timelevel and broadcasts the entire field to each process.
Each shortwave or longwave timestep, advnce calls oznint. 
In oznint, masterproc again interpolates the ozone data
to the current timelevel and broadcasts the entire field to each process.
(Every month or so, oznint also reads a new timelevel of 
ozone data into masterproc.)

In the new version, oznini reads in the two timelevels, then distributes
both timelevels to all of the processes, so that they can do the interpolation
on their own. Moreover, the ozone data has been chunked, and each process
holds only the data that it needs for the columns that it is responsible for.
The performance impact is a significant decrease in the number of times
masterproc sends ozone data to the other processes, and a decrease in the
amount of data sent in each remaining communication. Routines modified were
comozp.F90, oznini.F90, oznint.F90, and radozn.F90, all in control/ . 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev31
Originator: rosinski ( Jim Rosinski)
Date: Thu Aug 14 21:54:00 MDT 2003
Model: CAM
Version: CAM2.0_2.dev31
One-line Summary: Bugfix from Natalie M. for sulfur fields.  Consistent treatment of r4 vs. r8 in function calls
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

o Sulfur bugfix from Natalie M. addresses negative concentrations.
o Consistent treatment of constants as r8.

===============================================================
===============================================================

cam2_0_2_dev30
Originator: pworley ( Patrick H Worley)
Date: Wed Aug 13 15:23:59 MDT 2003
Model: CAM
Version: CAM2.0_2.dev30
One-line Summary: Replaced global spectral arrays and indices with local arrays in EUL dycore, to decrease memory requirements.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes:Yes (spectral memory requirements now decrease as number of MPI processes increase)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux cluster
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: No (bit-for-bit) for SGI and Linux cluster, Yes (same-to-roundoff) for IBM
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The primary goal of this update is to decrease the memory requirements
in the spectral Eulerian dycore by allocating space only for the
spectral coefficients that each processor is responsible for. While
we earlier decomposed the work, we have still been allocating the
full spectral arrays on each processor. This modification is important
for higher horizontal resolutions (T85, T170) as it decreases the memory
required for each process and may improve performance by improving memory
locality. To this end, the following files in dynamics/eul were modified:

comspe, spmd_dyn, trunc, initcom, inital, dynpkg, grcalc, hordif,
quad, and tstep

The routine spetru was also divided into 4 routines (in a new spetru module):
spetru_u., spetru_t, spetru_ps, and spetru_phis, spectrally truncating
the fields u and v, t, ps, and phis, respectively. The old spetru used
the global spectral arrays vz, d, t, and phis, which have been eliminated.
The new routines use at most a few single level global spectral arrays to
truncate the fields, again decreasing the required memory.

Finally a few random changes were included in this update:

Makefile - 
   Added -lcxml to the LDFLAGS for OSF, to link in DGETRF and DGETRS
   on the Pittsburgh AlphaServer SC (needed by aerosols.F90)

caerbnd.F90, dmsbnd.F90: 
   Moved declaration for ncol so that it appears before its use in 
   array declarations. (HP/Compaq compiler complained.)

physpkg.F90:
   Removed redundant USE of time_manager variables. (HP/Compaq compiler 
   complained.)

carbon_intr.F90, seasalt_intr.F90
   Removed redundant USE of shr_const_mod variables. (HP/Compaq compiler
   complained.)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev29
Originator: aconley ( Andrew J. Conley)
Date: Thu Aug  7 10:25:49 MDT 2003
Model: CAM
Version: CAM2.0_2.dev29
One-line Summary: linearly interp asym and ssa parameters, Do not extrap optics beyond rh = 1.0
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, chinooke, anchorage
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers:Yes new-physics ( < 10^-3 relative change in aerosol heating)

Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
  Aerosol optics are no longer extrapolated beyond rh = 1.0.
  Asymmetry and single scattering albedo are now linearly interpolated
   in rh rather than exponentially interpolated.
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev28
Originator: rosinski ( Jim Rosinski)
Date: Wed Aug  6 11:49:49 MDT 2003
Model: CAM
Version: CAM2.0_2.dev28
One-line Summary: Back out nf90 interface from sulfur codes.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

o Backed out the Fortran 90 interface from sulfur codes per CRB.
o IMPORTANT NOTE: There is a reproducibility problem on the IBM when the sulfur routines are
  enabled.  This problems exists both in the previous library (2.0.2.dev27) and this commit.
  Only the sulfur fields are affected, and the impact appears to be minor.  The problem is 
  likely related to threading, since 1-day test runs on IBM machines with OMP_NUM_THREADS=1
  give reproducible answers.  Threaded tests on chinook (SGI) were successful.  Note that
  test-model does not enable the sulfur routines, so results were bit-for-bit.

===============================================================
===============================================================

cam2_0_2_dev27
Originator: hender ( Tom Henderson)
Date: Wed Jul 30 15:10:50 MDT 2003
Model: CAM
Version: CAM2.0_2.dev27
One-line Summary: First cut at getting dust to work with physics chunking.
cam-bugs Requests resolved: none
Requires change in build system: no

Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, anchorage-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Hacks for dust, see "#if (defined DUST)"
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
Updated Natalie Mahowald's dust package (including her land model changes) to 
work with PCOLS=16.  It does not crash on anchorage but does crash on 
blakcforest when cpp token DUST is defined (by default, dust, sulfates, 
sea salt, and carbon packages are turned off via cpp tokens).  MORE WORK NEEDS 
TO BE DONE.  

This tag is identical to cam2_0_2_dev25_brnchT_paero7.  

Note that pgf90-pgcc and pgf90-gcc are known to fail because the Makefile has 
not been updated to deal with the new F90 netcdf interfaces used in the new 
code.  The next tag should replace the F90 interfaces with the standard CAM 
wrap_ncf() calls, if possible.  

===============================================================
===============================================================

cam2_0_2_dev26
Originator: hender ( Tom Henderson)
Date: Mon Jul 28 18:18:26 MDT 2003
Model: CAM
Version: CAM2.0_2.dev26
One-line Summary: Added Phil Rasch's prognostic SOx aerosols.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:
Added prognostic aerosols.  All four packages (sulfates, carbon, sea salt, and 
dust) are independently #ifdef'd out in aerosol_intr.F90.  Sulfates have 
been tested with the other three off.  Results are bfb with cam2_0_2_dev25 
when all four are off.  Feedback to radiation is disabled in radctl.F90 (see 
commented-out calls to set_aerosol_from_prognostics).  

Time constraints forced the choice of cpp and comments instead of namelist 
variables...  

NEW FILES:  
cam1/models/atm/cam/src/physics/cam1/acbnd.F90
cam1/models/atm/cam/src/physics/cam1/acsf.F
cam1/models/atm/cam/src/physics/cam1/aerosol_intr.F90
cam1/models/atm/cam/src/physics/cam1/caerbnd.F90
cam1/models/atm/cam/src/physics/cam1/caer.F90
cam1/models/atm/cam/src/physics/cam1/carbon_intr.F90
cam1/models/atm/cam/src/physics/cam1/dmsbnd.F90
cam1/models/atm/cam/src/physics/cam1/drydep_mod.F90
cam1/models/atm/cam/src/physics/cam1/dust.F90
cam1/models/atm/cam/src/physics/cam1/dust_intr.F90
cam1/models/atm/cam/src/physics/cam1/dust_sediment_mod.F90
cam1/models/atm/cam/src/physics/cam1/scyc.F90
cam1/models/atm/cam/src/physics/cam1/seasalt_intr.F90
cam1/models/atm/cam/src/physics/cam1/soxbnd.F90
cam1/models/atm/cam/src/physics/cam1/sulbnd.F90
cam1/models/atm/cam/src/physics/cam1/sulchem.F90
cam1/models/atm/cam/src/physics/cam1/sulemis.F90
cam1/models/atm/cam/src/physics/cam1/sulfur_intr.F90
cam1/models/atm/cam/src/physics/cam1/surface.F
cam1/models/atm/cam/src/physics/cam1/volcemission.F
cam1/models/atm/cam/src/physics/cam1/wetdep.F90

CHANGED FILES:
cam1/models/atm/cam/doc/UsersGuide/UG-20.html
cam1/models/atm/cam/bld/DefaultCAMEXPNamelist.xml
cam1/models/atm/cam/bld/camexp.pm
cam1/models/atm/cam/bld/run-ibm.csh
cam1/models/atm/cam/bld/run-pc.csh
cam1/models/atm/cam/src/dynamics/eul/inidat.F90
cam1/models/atm/cam/src/physics/cam1/advnce.F90
cam1/models/atm/cam/src/physics/cam1/aerosols.F90
cam1/models/atm/cam/src/physics/cam1/cldcond.F90
cam1/models/atm/cam/src/physics/cam1/comsrf.F90
cam1/models/atm/cam/src/physics/cam1/initindx.F90
cam1/models/atm/cam/src/physics/cam1/inti.F90
cam1/models/atm/cam/src/physics/cam1/physpkg.F90
cam1/models/atm/cam/src/physics/cam1/radctl.F90
cam1/models/atm/cam/src/physics/cam1/tphysac.F90
cam1/models/atm/cam/src/physics/cam1/tphysbc.F90
cam1/models/atm/cam/src/control/filenames.F90
cam1/models/atm/cam/src/control/intp_util.F90
cam1/models/atm/cam/src/control/parse_namelist.F90
cam1/models/atm/cam/test/system/ncar_batch.csh


===============================================================
===============================================================

cam2_0_2_dev25
Originator: jmccaa ( James Mccaa)
Date: Thu Jul 17 15:38:48 MDT 2003
Model: CAM
Version: CAM2.0_2.dev25
One-line Summary: Introduction of orographic form drag and modification of gravity wave drag routines.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, linux-lf95, linux-pgf90
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes, new-physics
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Modified three files:
models/atm/cam/src/physics/cam1/gw_drag.F90
models/atm/cam/src/physics/cam1/tphysac.F90
models/atm/cam/src/physics/cam1/vertical_diffusion.F90

Introduced orographic form drag in vertical_diffusion module.
Modified gravity wave drag in gw_drag module.
These changes necessitated changes to the interfaces in tphysac.

Form drag and the new gravity wave drag algorithm are implemented only 
when using the finite volume dycore.  However, for the spectral dycores
the gravity wave algorithm was changed to disallow the formation of 
gravity waves over pure ocean points with non-zero orographic standard
deviation.

====================================================
====================================================

cam2_0_2_dev24
Originator: eaton ( Brian Eaton)
Date: Fri Jul 11 12:48:54 MDT 2003
Model: CAM
Version: CAM2.0_2.dev24
One-line Summary: dycore independent energy fixer, only active for FV
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: roundoff changes in spectral dycores, fv has new physics
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Reinsert changes made at cam2_0_2_dev21 (dycore independent energy fixer active
for fv only).

Fix bad error growth (add PERGRO condition in cldfrc.F90)

Fix namelist problem for 64x128 sld (new dataset in DefaultCAMEXPNamelist.xml).


===============================================================
===============================================================

cam2_0_2_dev23
Originator: hender ( Tom Henderson)
Date: Sat Jun 21 09:41:17 MDT 2003
Model: CAM
Version: CAM2.0_2.dev23
One-line Summary: Fixes for coupled runs, removal of CCM366 and LSM, other minor fixes.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Intel-Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Tony Craig, Art Mirin, and a cast of thousands
Restart files change: no
Changes answers: no (bfb with dev22)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
   - Bug fix #122.  (outfld calls from Jerry Olson's commit)
       Modified routine diag_surf() in diagnostics.F90 so fields TSICE
       and TSICE_RAD are excluded from the history files during a coupled
       run.
   - bugfix for ccsm_msg from Tony for fractional land
       /fs/cgd/data0/tcraig/ccsm2_runs/f22.006/src.atm/ccsm_msg.F90
   - Strip out CCM366 code now that test-model tests are no longer run...
       Removed all files in models/atm/cam/src/physics/ccm366/ (CCM366
       physics) and models/lnd/lsm/src/ (LSM).
   - Deal with huge volume of print statements
       Commented out print of "TIMEFILTER" messages per CAM CRB meeting on
       6/20/03.  Modified tfilt_massfix.F90
   - Restore fv_prints.F90 as per Art Mirin's email
       Got new fv_prints.F90 from sunray3:/home/mirin/outgoing/.
   - Added Art Mirin's "one-line-change" to resolution_parameters.xml
       Added new line for resolution=".5x.625"


===============================================================
===============================================================

cam2_0_2_dev22
Originator: hender ( Tom Henderson)
Date: Fri Jun 20 15:50:11 MDT 2003
Model: CAM
Version: CAM2.0_2.dev22
One-line Summary: Rolled back dev21 changes (per CAM CRB).
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: none.  I verified that the entire cam1 module is identical to 
dev20.  Testing will be done for dev23
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: 
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:  dev22 is identical to dev20
===============================================================
===============================================================

cam2_0_2_dev21
Originator: eaton ( Brian Eaton)
Date: Wed Jun 18 13:15:50 MDT 2003
Model: CAM
Version: CAM2.0_2.dev21
One-line Summary: dycore independent energy fixer, only active for FV
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC/lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, boville
Restart files change: no
Changes answers: Yes. spectral dycores change to round-off.  FV dycore has a physics change.
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Add dycore independent energy fixer.  Currently it is only applying an energy fix when run
with the FV dycore.  For the spectral dycores it is diagnostic.

A round-off level change was introduced into the spectral dycores due to 2 changes:
1. The definition of dry static energy was changed to include the surface geopotential.
2. The conversion between dry and wet constituent mixing ratios was moved into the coupling layer,
   and an extraneous conversion that previously happened at the end of tphysbc and at the beginning
   of tphysac has been removed.

See http://www.cgd.ucar.edu/~cam/cam_checkins/ for details.

===============================================================
===============================================================

cam2_0_2_dev20
Originator: erik ( Erik Kluzek)
Date: Mon Jun 16 12:54:27 MDT 2003
Model: CAM
Version: CAM2.0_2.dev20
One-line Summary: Get rid of ccm366/lsm test in test-model.pl, clean more files in $MODEL_BLDDIR, send *.cprout files in test-model to $MODEL_EXEDIR
cam-bugs Requests resolved: 112, 118(partial)
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux(lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, hender
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?no

Got rid of the ccm366/lsm test in test-model.pl.

Clean more files in the $MODEL_BLDDIR when using test-model.pl or run-model.pl
(fixes bug #112)

Send all *.cprout files to $MODEL_EXEDIR instead of $SCRIPT_DIR this prevents
overwrites of files by different machines. This is a partial fix to bug #118.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev19
Originator: hender ( Tom Henderson)
Date: Fri Jun 13 10:28:19 MDT 2003
Model: CAM
Version: CAM2.0_2.dev19
One-line Summary: Merged "science" branch into "dev" branch.
cam-bugs Requests resolved: none
Requires change in build system: Yes (see science branch documentation)
Substantial timing or memory changes: Yes (see science branch documentation)
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: many
Restart files change: yes
Changes answers: Yes (new-climate)
Changes to CLM land-model: Yes
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:
See http://www.cgd.ucar.edu/~cam/cam_checkins/ for details of all changes 
made on the science branch.

===============================================================
===============================================================

cam2_0_2_dev18
Originator: rosinski ( Jim Rosinski)
Date: Tue Apr  8 17:09:30 MDT 2003
Model: CAM
Version: CAM2.0_2.dev18
One-line Summary: Speedup mods.  Particularly for large number of threads (e.g. typical SGI)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes. Speedup mods.  See below for details.
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  no but I will
Changes made:

o Speedup mods.  Should see order 10% speedup on SGI, 3% on IBM.  Even better than that for
  more than 32 threads on SGI.  Specifics were:
  - fuse threaded loops to minimize threading overhead
  - Don't dereference pointers in expensive history calculations.
  - Thread some calculations called from physpkg that were previously single-threaded.  This
    likely is the reason for such a big speedup on SGI.

o Changed ifdef DEBUG to HDEBUG inside history.F90.  Reason was model barfed somewhere in
  physics when DEBUG ifdef was set.

o Fix max/min combined with flag_xyfill=.true. pathological history case (prv commit).

===============================================================
===============================================================

cam2_0_2_dev17
Originator: rosinski ( Jim Rosinski)
Date: Sat Apr  5 11:48:41 MST 2003
Model: CAM
Version: CAM2.0_2.dev17
One-line Summary: Added ISCCP cloud simulator
cam-bugs Requests resolved: none
Requires change in build system: yes (new namelist variables)
Substantial timing or memory changes: history speedup.
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes 
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

o Added ISCCP cloud simulator.  Cost overhead is around 5%.  You need to set 
  namelist variable doisccp = .true. to enable the simulator.  Then
  isccpdata  = '/fs/cgd/csm/inputdata/atm/cam2/rad/isccp.tautab_invtau.nc'
  to tell the simulator where the required boundary dataset is.

  Had to set default doisccp = .false. because test-model will barf when cprnc
  gets confused at the different values of the "levels" coordinate variable.
  This needs to be fixed.

  Output from the simulator is 6 fields.  The key field is FISCCP1, dimensioned
  lon x 49 x lat x time.  The 49 is really 7 pressure levels by 7 optical 
  depths.  Pressure and optical depth of each "level" can be determined from
  dimension variable "isccp_prstau".  Pressure is the number to the left of
  the decimal point in mb.  Optical depth is the number to the right of the
  decimal point times 1000.

  The simulator is only called during daytime (coszrs > 0).  As a consequence,
  routine outfld in history.F90 was modified to ignore input array locations
  set to fillvalue.  To enable this feature, a new argument to addfld named
  flag_xyfill was added.  Set it to .true. to enable outfld ignoring fillvalue
  input.  Currently this is only done for appropriate ISCCP fields.  If this
  feature is enabled, for multilevel fields the setting of fillvalue MUST be
  invariant in the z-direction.  The reason is that the accumulator (nacs) is
  currently only dimensioned x-y.  The history handler checks for this 
  consistency and barfs if it is not met.  Changing the accumulator to be
  x-y-z capable would not be too hard, but might have severe performance
  ramifications.

===============================================================

cam2_0_2_dev16
Originator: tcraig ( Anthony Craig)
Date: Thu Apr  3 15:51:34 MST 2003
Model: CAM
Version: CAM2.0_2.dev16
One-line Summary: Updates for CCSM coupling with cpl6, CCSM coupling with FV, rain/snow in coupling
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

      ccsm_msg.F90 
        - Significant rewrite for cpl6, has no impact on stand-alone CAM
          (Rob Jacob).  
        - Fixed bug in outfld call for CPLRAIN*, CPLSNOW*, CPLPRCER
          (Mariana Vertenstein).
        - Removed artificial repartitioning of snow and rain in fields
          sent to coupler to be ready for CLM2.2.
        - Fixed bug in read/write of precca, precla, precsca, precsla
          (Mariana Vertenstein, Bryon Boville)
        - Modified coupling for LR dycore, removed special mods for LR
          dycore in sendgrid setting mask to zero at most pole latitudes.
          This was required for CCSM coupled runs with the LR dycore.

      spmdinit.F90
        - Removed the MPI_INIT call for COUP_CSM mode, cpl6 now handles this.
        - Removed use of shr_msg_comm_atm (cpl5).  Added a call to 
          cpl_interface_init (cpl6) to return the MPI communicator group.

      cam.F90
        - Modified some code on COUP_CSM definitions, remove calls to 
          shr_msg_init, shr_msg_groups, and shr_msg_finalize (cpl5).
          Added call to cpl_interface_finalize (cpl6).

      phys_grid.F90
        - Added two new routines, buff_to_chunk and chunk_to_buff (Rob Jacob).  
          These are used in ccsm_msg to rearrange data from a lon-lat buffer 
          into chunk structure.


===============================================================
===============================================================

cam2_0_2_dev15
Originator: jet ( John Truesdale)
Date: Wed Apr  2 08:27:51 MST 2003
Model: CAM
Version: CAM2.0_2.dev15
One-line Summary: Added capability to output history tape fields on a column by column basis
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:

I've added code and a set of namelist variables that allow fields for 
a particular history tape to be written on a column by column basis.  
The new namelist variables are named fincl1lonlat ... fincl6lonlat and 
are used in conjunction with the fincl1 ... fincl6 namelist variables.

Here is an example of how to use the new variables to define individual
columns or a lat/lon range of columns for output.

1. Define a history tape with a set of fields that you would like to see
   output at specific columns

    ex. fincl3 = 'LHFLX','SHFLX','PS','T','U'

2. Define the columns for that history tape using  fincl[1..6]lonlat
   Like the fincl[1..6] specifiers all of the column identifiers are strings.
   Specify the longitude in degrees followed by a single character
   (e)ast/(w)est modifier. Follow this with an underscore ('_') and then
   specify the latitude in degrees followed by a single character
   (n)orth/(s)outh modifier.

    ex. fincl3lonlat = '30.5e_45.5n'

        will output the model column closest to 30.5 degrees east longitude
        and 45.5 degrees north latitude for all fields defined by history tape
        3.

    You can specify a range of longitudes (or latitudes) by separating
    the min and max values with a colon (':') like so

    ex. fincl3lonlat = '30e:40e_45n'

        will output the closest model columns from 30 to 40 degrees east
        and at 45 degrees north for all fields defined on history tape 3.

    The latitudes/longitudes must be positive (real or integer).

        longitude values range from [0w to 180w] and [0e to 180e]
        latitude values range from [90s to 0s] and [0n to 90n]

3) Variables will be put on the history tape with the longitude and latitude
   coded as part of the name.

    Ex. Using these namelist variables

        fincl3 = 'LHFLX','SHFLX','PS','T','U'
        fincl3lonlat = '30.5e_45.5n','30e:40e_45n'

        will produce the following fields on history tape 3.

          LHFLX_30.5e_45.5n
          LHFLX_30e_to_40e_45n
          PS_30.5e_45.5n
          PS_30e_to_40e_45n
          SHFLX_30.5e_45.5n
          SHFLX_30e_to_40e_45n
          T_30.5e_45.5n
          T_30e_to_40e_45n
          U_30.5e_45.5n
          U_30e_to_40e_45n

   The netcdf attributes for each field will be set to include the
   actual latitude and longitude.  This allows tools like ferret
   to correctly plot the correct part of the world grid.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev14
Originator: eaton ( Brian Eaton)
Date: Thu Mar 27 15:07:31 MST 2003
Model: CAM
Version: CAM2.0_2.dev14
One-line Summary: fix fv restart under lf95/debug and fix bug in pseudo-ozone test tracer
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

>> physics/cam1/restart_physics.F90 - in subroutine read_restart_physics add
>>   calls to get_ncols_p inside the chunk loops and only assign the correct
>>   number of columns worth of restart data into srfflx_state2d and
>>   surface_state2d member arrays.
>> 
>> physics/cam1/test_tracers.F90 - fix bug in subroutine test_tracers_timestep_tend.
>>   All levels of the pseudo-O3 were being zeroed rather than just the bottom level.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev13
Originator: hender ( Tom Henderson)
Date: Tue Mar 25 10:17:12 MST 2003
Model: CAM
Version: CAM2.0_2.dev13
One-line Summary: Fixes and upgrades to test scripts, change for omega in history output.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik Kluzek, Jim McCaa
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

   1) Fixes to test-model.pl so -compare works (Kluzek).
   2) Shorten run length for SOM tests in test-model.pl (Kluzek).
   3) Script improvements to allow Wei to easily test lf95, pgf90-pgcc, and 
      pgf90-gcc in his automated runs (Henderson).
   4) Makefile changes to make pgf90 bfb restarts with different number of
      processes work with the fv dycore (Henderson).
   5) Makefile changes to add Fortran optimization override environment
      variable F_OPTIMIZATION_OVERRIDE (Henderson).
   6) test-model.pl upgrade to use F_OPTIMIZATION_OVERRIDE when pgf90 is
      used for fv04-fv06 and fv10-fv13 tests (Henderson).
   7) test-model.pl upgrade to allow multiple test-model.pl incarnations to
      be launched simultaneously from ncar_batch.csh (i.e. via queuing
      systems) (Henderson, Kluzek).
   8) Modified ncar_batch.csh to pass the "-unique_id" option to
      test-model.pl (Henderson).
   9) Changed $COMPARE_DIR/cam1 to $COMPARE_DIR in ncar_batch.csh to help
      folks who use non-standard directory naming (Henderson).
  10) Upgraded CAM XML parser to latest version (Kluzek).
  11) Modified history file output to replace Omega@600mb with Omega@500mb
      (McCaa and Henderson).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev12
Originator: erik ( Erik Kluzek)
Date: Thu Mar 20 15:48:06 MST 2003
Model: CAM
Version: CAM2.0_2.dev12
One-line Summary: Fix bug in test-model with -compare and update XML::Lite from 0.11 to 0.14
cam-bugs Requests resolved: 104
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Sun, Linux-PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, hender, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Update XML::Lite from 0.11 to 0.14. Creator of XML::Lite, gave us
a newer version as he said the old version had "a significant bug"
in it.

Fix bug in -compare option for test-model.pl (bug #104). Previously
worked ok if you specified the dynamics, or for eul dynamics. It would
fail when it changed dynamics.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev11
Originator: mirin ( Arthur Andrew Mirin)
Date: Thu Mar 13 17:21:11 MST 2003
Model: CAM
Version: CAM2.0_2.dev11
One-line Summary: Changes to transposes for 2D FV decomposition.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no; however one can now make with 64-bit addressing on IBM.
Substantial timing or memory changes: no
Requires change in run script: no; however, there are some new input options.
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes; however, bug in script, so could not verify.
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Will Sawyer
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None
Changes made:

        The main changes are in the area of transposes for the 2D FV decomposition.

        a. Transposes now include ghost points, which obviates extra ghost point
                communication following the transposes. This improves performance,
                but with limited impact because so few of the transposes involve ghost
                points.

        b. Transposes now use the NASA/Goddard mod_comm package, which lies underneath
                Pilgrim. This enables use of one-sided MPI-2 communications as well as
                standard MPI. NASA/Goddard personnel report substantial gains on
                the SGI when MPI-2 is used in place of standard MPI.

        c. Arrays containing extra points in any of the dimensions still cannot
                be handled and must be copied into (out of) arrays without extra
                points. Instead, the associated copies are, to the extent possible,
                overlapped with other messages. This improves performance.

        d. The number of tracers to be transposed simultaneously is now specifiable.
                Formerly, all tracers had to be transposed together. This facilitates
                overlapping copying with communication (see above point). If there are
                N tracers altogether, to be transposed in groups of M, one solves
                N = Q * M + R, and does Q groups of M and 1 group of R. Preliminary
                tests indicate that M=1 is good for coarse domain decompositions,
                but that as the decomposition becomes finer, the latency of multiple
                transpose calls outweighs the computation/communicaiton overlap
                benefit. The default is M=6.

        e. A new method for initializing the transposes has been implemented.
                Unlike the old methodology, this new method works for ghost points.
                The method scales fine spatially but very poorly with the number of
                tracers to be simultaneously transposed. Until this is fixed,
                one would best limit M (see above point) to 6 (the default).

        f. We have been experimenting with MPI derived types, versus the current
                method of copying data in and out of contiguous buffers. At present
                we are getting mixed results. This option has been implemented for
                MPI-1 only (not MPI-2). Further testing is underway.

        The files affected are:
                Directory ...../src/dynamics/fv, files cd_core.F90, dp_coupling.F90,
                        dynamics_vars.F90, dynpkg.F90, geopk.F90, inidat.F90,
                        p_d_adjust.F90, pmgrid.F90, spmd_dyn.F90, stepon.F90, trac2d.F90.                              These are virtually all transpose-related changes.

                Directory ...../src/control, files cam.F90, spmdinit.F90.
                        The change to cam.F90 is to make sure TWOD_YZ is not set when SPMD
                        is unset. The change to spmdinit.F90 has to do with MPI
                        initialization on SGI machines when using MPI-2.

                Directory ...../utils/pilgrim, files Makefile, Makefile.conf.AIX,
                        Makefile.conf.IRIX64, decompmodule.F90, ghostmodule.F90, memstuff.c,
                        mod_comm.F90, parutilitiesmodule.F90, puminterfaces.F90,
                        redistributemodule.F90.

                Directory ...../utils/pilgrim/unit_testers, files Makefile,
                        decomptest.F90, ghosttest.F90, parpatterntest.F90,
                        parutilitiestest.F90, redistributetest.F90, unstructured.F90.

                Directory ...../bld, files Makefile, configure_fv.pl, script.m4.
                        The change to Makefile is to provide option for 64-bit addressing
                        on IBM. To do so, switch actual and commented lines to set
                        ADDRESS    := Q64. The other two files are NASA/Goddard-specific.

                Directory ...../test/system, file llnl_frost.csh.

        A full diff of changes is on goldhill in ~mirin/diffs/diff_archive_cam2_0_2_dev10.

        Here is some information on new, as well as existing knobs:

        Two parameters have been added to the mprun2d namelist (used for 2D FV
                decomposition) - geopktrans and tracertrans. Geopktrans refers to the
                geopotential computation/communication method in geopk.F90. A value
                of 0 (default), which results in the setting of geopk16byte false,
                means that transposes are computed before and after the calls to
                geopk (from cd_core) in order to do the vertical indefinite integrals
                in geopk. A value of 1 causes geopk16byte to be set to true,
                meaning that instead of computing transposes, partial sums in each
                vertical subdomain are calculated and then communicated in z as
                needed; 16-byte arithmetic may be used to guarantee bit-for-bit agreement
                across domain decomposition; the default (for purposes of speed) is
                8-byte arithmethic. One can change to 16-byte arithmetic by editing
                geopk.F90 to change DSIZE from 8 to 16 (switch actual and commented
                statements). For performance purposes, the code should be used
                as is with geopktrans equal to 1. The other parameter, tracertrans,
                refers to the number of tracers simultaneously transposed (denoted by
                M above); the default is 6 and in general need not be changed.

        One can implement MPI derived types in the transposes by activating
                USE_MPI_TYPES in models/utils/pilgrim/parutilitiesmodule.F90.
                This is unsupported - do so at your own risk. This bypasses mod_comm
                and works for only MPI-1. One can make use of MPI-2 in mod_comm by
                activating MPI2 at the beginniing of mod_comm.F90. Use of this is
                definitely at your own risk.

        To run waccm configuration tests, please see instructions on goldhill
                in ~mirin/waccm.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev10
Originator: hender ( Erik Kluzek, tagged by Tom Henderson)
Date: Wed Mar 12 13:46:38 MST 2003
Model: CAM
Version: CAM2.0_2.dev10
One-line Summary: Added SOM test to test-model.pl.  Various bug fixes. Update to ESMF_0_0_2p8
cam-bugs Requests resolved: 101, 100, 99
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: yes, if running with new SOM
-som option in configure now works.  Default will behave as before.
Substantial timing or memory changes: no
Requires change in run script: yes, if running with new SOM
Must use initial and SST datasets that are compatible with SOM.  See
/ftp/pub/erik/cam2_0_2.scidac-atm.datasets.tar.gz
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Intel-Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Jim Rosinski, Erik Kluzek, Brian Eaton, Tom Henderson
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes to ESMF library: Update to ESMF_0_0_2p8, a pruned version of ESMF_0_0_2p5
Changes made:

Added SOM test to test-model.pl and fixed bugs:

Add a SOM test for all dycores and for the control library.
Add new datasets needed for running with SOM. Reset namelist
each test in test-model.pl to make test-model.pl more robust.
Add a no-fail option to cam_timing so that when using -nofail
if a simulation aborts test-model.pl won't stop. Fix reporting
problem of different history files with -nofail. Improve the
diagnostic output of test-model.pl especially for the -nofail
case. Also be more careful at cleaning up data, such that data files
are deleted only after needed comparisions are done.

New datasets are available under "datasets" on the cam developers
web page.

Put, support message about ESMF in Makefile.

U atm/cam/bld/DefaultCAMEXPNamelist.xml
U atm/cam/bld/Makefile
U atm/cam/doc/UsersGuide/test-model.html
U atm/cam/test/system/CAM_test.pm
U atm/cam/test/system/cam_timing.pm
U atm/cam/test/system/test-model.pl

Bug fixes to make Lahey compiler happy:
U atm/cam/src/ocnsice/som/ocn_srf.F90
U atm/cam/src/dynamics/fv/inidat.F90
U atm/cam/bld/configure

Changed these ESMF files to allow for removal of lots and lots of other
ESMF files:

Update to ESMF_0_0_2p8, so can prune out unused files and directories.
Also turn off dependency of OMP, PCL, and MPI libraries. This simplifies,
shortens, and makes the ESMF make more robust. It also removes half of the
amount of disk storage for ESMF than was used before, several of the unused
code directories were removed and only the minimal set needed for using
the ESMF time manager.

U utils/esmf/README
U utils/esmf/build/IRIX/ESMF_conf.h
U utils/esmf/build/IRIX64/ESMF_conf.h
U utils/esmf/build/alpha/ESMF_conf.h
U utils/esmf/build/linux_gnupgf90/ESMF_conf.h
U utils/esmf/build/linux_lf95/ESMF_conf.h
U utils/esmf/build/linux_pgi/ESMF_conf.h
U utils/esmf/build/rs6000_64/ESMF_conf.h
U utils/esmf/build/rs6000_64/base_variables
U utils/esmf/build/rs6000_sp/ESMF_conf.h
Ripped out lots and lots of ESMF files:
...

Upgraded to simplify automated testing on anchorage with pgf90-pgcc and
pgf90-gcc:
U atm/cam/test/system/ncar_batch.csh


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev9
Originator: rosinski ( Jim Rosinski)
Date: Wed Feb 26 17:59:48 MST 2003
Model: CAM
Version: CAM2.0_2.dev9
One-line Summary: Added SOM capability.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) except Linux-pgf90 is only roundoff
Changes to CLM land-model: None
Changes made:

o Added Slab Ocean Model (SOM) capability. To enable, change som/ to dom/
in Filepath, and add #define COUP_SOM in misc.h.

For prescribed-ice control runs that will create fluxes for SOM, to get
good results CNTL_FORSOM must also be #defined.

Climates have only been examined in EUL mode. SLD and FV do compile, but they
have not yet been tested.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev8
Originator: jet ( John Truesdale)
Date: Wed Feb 19 16:51:27 MST 2003
Model: CAM
Version: CAM2.0_2.dev8
One-line Summary: fix bug in srface diagnostic variables - fsnslnd fsnsocn etc
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no

Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:
These mods were to fix a bug with the newly added surface diagnostics.
They were not giving bit for bit when restarting fv and sld runs.  To
fix this I had to add some variables to the restart dataset
as well as put a n-1 timelevel of landfrac,ocnfrac,and icefrac into the
physics buffer.  These n-1 timelevel values are used from the physics
buffer on restart.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev7
Originator: hender ( Tom Henderson)
Date: Mon Feb 10 09:49:09 MST 2003
Model: CAM
Version: CAM2.0_2.dev7
One-line Summary: Grab bag -- Makefile, script, and source code fixes for SGI, Linux (PGI and Lahey), IBM
cam-bugs Requests resolved: 92, 88
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Lots of accumulated minor fixes for SGI, Linux, IBM.  All bfb.  Biggest change 
is support for Linux-Lahey in source code and ncar_batch.csh.  Brian Eaton, 
Pat Worley, John Truesdale, Jim Rosinski, and Erik Kluzek contributed various 
bits.  
Substantial timing or memory changes: no
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Makefile, run-ibm.csh, ncar_batch.csh, ice_srf.F90, comsrfdiag.F90, 
fv_prints.F90, test-model.pl (and files it uses)
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton (SGI bits in Makefile), Jim Rosinski 
(Linux-Lahey bits in Makefile), John Truesdale (John made the fixes for 
ice_srf.F90, comsrfdiag.F90, and fv_prints.F90), Erik Kluzek (Erik made the 
fixes for test-model.pl)
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:
Note:  This is item #018 on CAM Check-in List "Fix performance bug in Makefile 
       for SGI (formerly CAM task list #02.12.19.5)".  It's scope has expanded 
       a bit.  
A- Modified Makefile for SGI so LDFLAGS has options and libraries in the 
   correct order ( -mp -lmp -lmpi ) as described by Pat Worley.
B- Added Brian Eaton's fix for run-ibm.csh:
   "On the IBM there are 3 environment variables that allow you to specify the
    node/task configuration.  The 2 that are set in the run-ibm.csh file imply
    that the total number of mpi tasks (procs) is 2.  It's likely that your job
    has procs=1 due to the 3rd environment variable, MP_PROCS, being set
    somewhere else, like your .cshrc or .profile file (perhaps by the SCD
    supplied default version of these files).  The fix I'd suggest is to add
    the command "unsetenv MP_PROCS" to run-ibm.csh file in the POE Environment
    settings section."  -- Brian Eaton
C- Added Brian Eaton's fix for run-ibm.csh to ncar_batch.csh too.
D- Added support for the Lahey compiler on anchorage to ncar_batch.csh.  PGI
   becomes an option, Lahey the default.
E- Added John Truesdale's fixes for ice_srf.F90, comsrfdiag.F90, and
   fv_prints.F90.  This allows versions cam2_0_2_dev1 and later to work
   with the Lahey compiler.  Prior to these fixes, lf95 was complaining about
   unintialized variables (etc.).
F- Erik Kluzek fixed test-model.pl to work around a problem on bluesky.
G- Changed pgf90 optimization from -fast to -O1 in Makefile to fix bfb problem
   with test-model.pl test #fv06 (compare initial run to restart run with
   different number of processors for fv dycore).  All other tests were 
   passing bfb with -fast.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev6
Originator: pworley ( Patrick H Worley)
Date: Wed Feb  5 15:19:36 MST 2003
Model: CAM
Version: CAM2.0_2.dev6
One-line Summary: New 1D decomposition for Fourier and Spectral domains in SLD dycore, for improved performance
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes, faster for large processor counts
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: No (bit-for-bit) on SGI and Compaq; Yes (same-to-roundoff) on IBM
Changes to CLM land-model: changed division by parameter to division by local copy in lnd_grid, to eliminate compiler complaint
Changes made:

Implemented a consistent wavenumber decomposition for Fourier
and Spectral domains in SLD dycore, decreasing MPI communication and
storage requirements. Wavenumber decomposition also modified, 
to improve load balance and decrease amount of communication.
This modification is similar to that in cam2_0_1_dev3, except for
SLD instead of EUL.

Routines modified in dynamics/sld: comspe, courlim, dyn, dyndrv,
dynpkg, grcalc, hordif, quad, realloc4, realloc7, scan2, scandyn, 
scanslt, spegrd, spmd_dyn, trunc, tstep, tstep1, vertnm.
Routines deleted in dynamics/sld: realloc3, realloc6 .

Also, changed division by parameter to division by a local
copy of the parameter in two places in lnd_grid, to eliminate
a compilation failure with some versions of the IBM compiler.
(Fix provided by Art Mirin.)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev5
Originator: eaton ( Brian Eaton)
Date: Tue Jan 21 12:33:04 MST 2003
Model: CAM
Version: CAM2.0_2.dev5
One-line Summary: makefile/configure changes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Add ability to specify additional flags to the C compiler and to the loader
(this ability already exists for the Fortran compiler).  This provides
flexibility in porting to new platforms.

Change Makefile so that the Filepath, Srcfiles, and Depends files are
explicitly in the current directory.  This fixes a bug which occurs when
make finds a Srcfiles file in the VPATH, and that Srcfiles is newer than
the Filepath (which results in Srcfiles not being created in the current
directory and the command to build the Depends file fails).

Add an option to configure to allow the configuration cache file to be
created in a different directory than the CAM build directory.  The default
behavior of configure is unchanged.

Fix a broken configuration.  The combination of omp on linux using pgf90
and gcc resulted in the timing library being built without threading
enabled.  Removed the setting of the THREADED_PTHREADS and THREADED_OMP cpp
macros from utils/timing/gpt.h and set these in the Makefile.  This also
allows them to be set only when SMP is true.  They were previously set to
use threads whether the rest of the model was threaded or not.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev4
Originator: hender ( Tom Henderson)
Date: Fri Jan 17 11:23:15 MST 2003
Model: CAM
Version: CAM2.0_2.dev4
One-line Summary: ncar_batch.csh:  added support for test-model.pl with -compare option
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

The new ncar_batch.csh can be used to do bitwise comparison with a previous 
source version.  The test-model.pl script is run internally with the -compare 
option.  

For NQS or PBS, the new usage is: 
>> env SCRIPT_DIR=`pwd` COMPARE_DIR=$MYBASEDIR qsub ncar_batch.csh

For LoadLeveler, the new usage is:  
env SCRIPT_DIR=`pwd` COMPARE_DIR=$MYBASEDIR llsubmit ncar_batch.csh

In both cases, directory $MYBASEDIR should contain the source code for the 
previous version.  

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev3
Originator: jet ( John Truesdale)
Date: Mon Jan 13 08:53:33 MST 2003
Model: CAM
Version: CAM2.0_2.dev3
One-line Summary: Added diagnostics for surface budget calculation, moved sst/ocn interpolation to correct minor flux bug
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Apache
Ran test-model.pl script: yes: Only on IBM
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (new-physics)
Changes to CLM land-model: None (one-line description)
Changes made:

Added diagnostics to allow for surface energy budget calculations.  The
following diagnostics were added:

FSNSLND,FSNSOCN,FSNSICE,FLNSLND,FLNSOCN,FLNSICE,SHFLXLND,SHFLXOCN,SHFLXICE,
LHFLXLND,LHFLXOCN,LHFLXICE.

Also added the following diagnostics to provide ocean/ice forcing for som
model

FSNSOI,FLNSOI,SHFLXOI,LHFLXOI

Moved the interpolation of ocean and ice right before the surface routines
that use them.  SSTINT and ICEINT were previously at the top of the time
loop before tphysbc in the routine advnce.  I removed them from advnce and
placed them after tphysbc right before camocn and camice.  This corrected
a minor bug in the models use of fluxes calculated by camocn and camice.
Previously new fluxes were computed by camocn and camice with a set of 
land, ocean, and ice fractions.  The time loop ended, advnce was called,
new surface fractions computed and then tphysbc used the fluxes calculated
the previously time around only using the new fractions instead of the
surface fractions used to compute the fluxes.  tphysbc now uses the time
level of fractions appropriate for the fluxes that are being read in.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev2
Originator: rosinski ( Jim Rosinski)
Date: Thu Jan  9 17:16:38 MST 2003
Model: CAM
Version: CAM2.0_2.dev2
One-line Summary: Add evap bugfix to ice_srf.F90 per C. Bitz
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:

o One-line chage adds sublimation over sea ice to evaporative flux in ice model.
  Changes answers beyond roundoff.  Analysis of effects of this change available at:
  www.cgd.ucar.edu/cms/rosinski/analysis/20shrconstevap-cam20shrconst/sets.htm

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev1
Originator: hender ( Tom Henderson)
Date: Mon Jan  6 15:25:38 MST 2003
Model: CAM
Version: CAM2.0_2.dev1
One-line Summary: Minor improvements to batch execution of test-model and User's Guide updates
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Erik
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Description:
  CAM_lab.pm      Update linux defaults
  CAM_test.pm     Fixed bug so "FAIL" is printed when a test fails (instad of
                  "ran").  Only affected the -nofail option.
  ncar_batch.csh  Updated to chinook "ded_16" queue and added PBS stuff for
                  anchorage.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev17
Originator: erik ( Erik Kluzek)
Date: Fri Dec 20 15:42:18 MST 2002
Model: CAM
Version: CAM2.0_1.dev17
One-line Summary: Small script change for testing, Makefile change to run on Compaq
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, Sun, Linux-Lahey, Linux-PGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Point to new test-production.pl baseline.

Change Makefile to run on Compaq.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev16
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Dec 19 14:31:58 MST 2002
Model: CAM
Version: CAM2.0_1.dev16
One-line Summary: updated cam documentation for cam2_0_2 release
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: None
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Changes made:
Updated cam documentation for cam2_0_2 release.
Clm documentation has already been updated. 	
Did not modify any code. 
===============================================================
===============================================================

cam2_0_1_dev15
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Dec 18 21:19:12 MST 2002
Model: CAM
Version: CAM2.0_1.dev15
One-line Summary: updated clm to clm2_deva_08
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: (see below)
  tested that clm2_deva_08 worked with CCSM
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes
Changes made:
1) Updated clm user's guide to clm2.1 
2) Fixed restart problem for clm2.1 auxiliary history files
===============================================================
===============================================================

cam2_0_1_dev14
Originator: erik ( Erik Kluzek)
Date: Tue Dec 17 16:14:46 MST 2002
Model: CAM
Version: CAM2.0_1.dev14
One-line Summary: Fix script problems use new datasets, update to ccsm2_0_beta61
cam-bugs Requests resolved: 76, 79, 84, 85
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes (IBM)
Machines tested: IBM, SGI, Sun, Linux (PGI,Lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) -- Except Z050 field changes!
Changes to CLM land-model: None

New datasets:

	Add capability for 1x1.25 for FV. Use new datasets for FV 2x2.5.
	Download the new cam2.0.2 set of SCIDAC datasets for use with
	this version of the model.

Fix test-model.pl bug in comparision:

	Fix comparision problem in test-model.pl. Also fix so that
	doesn't use as much disk-space. And change so that does
	a error-growth test with the control code.

Fix build-namelist bug:

	Fix bug in writing out long lists.

Fix bug in Z050:

	Z050 was 5 mbar surface rather than 50 mbar surface.

Fix PGI bug for open-MP processing:

	Delete a specific OpenMP loop in dynamics/fv/inidat.F90 that
	caused answers to change with number of processors.

Update to ccsm2_0_beta61:

	Update models/bld and scripts to ccsm2_0_beta61.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================
	
cam2_0_1_dev13
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Dec  9 09:49:17 MST 2002
Model: CAM
Version: CAM2.0_1.dev13
One-line Summary: clm code updated to development tag clm2_deva_07 (clm2.1 code)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
New (converted) clm initial datasets must be used
see DefaultCLMEXPNamelist.xml 
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, Sun, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: Yes (for clm only)
Changes answers: Yes (same-to-roundoff, same-climate)
Changes to CLM land-model: YES (updated to clm2.1 data structures)
Changes made:
	
1) clm2.1 has replaced clm2.0 in the current code.
   updated models/lnd/clm to clm development tag clm2_deva_07 
   The differences are roundoff.
   Two climate simulations were done to verify this commit.
   case: /OLESON/csm/eul_201dev10    - cam2_0_1_dev10 (clm2.0)
   case: /OLESON/csm/eul_201dev10_06 - cam2_0_1_dev10 (clm2.1 - tag clm2_deva_06) 
   The two cases were been compared with the standard climatological SST simulation 
   using CAM2.0.dev24 (case eul20dev24_a) and show the same climate  
   Performance on blackforest is effectively the same.
	
2) initial clm datasets used with clm2.0 are no longer compatible with clm2.1
   surface datasets used with clm2.0 will work with clm2.1
   restart files used with clm2.0 are not compatible with clm2.1
   a conversion tool has been created (see directory models/lnd/clm2/tools/convert_inic)
   running gmake in this directory will generate the conversion tool executable, convert_inic
   datasets needed by configure have already been converted and have been placed in the 
   directory /fs/cgd/csm/inputdata/lnd/clm2/inidata_2.1/cam
	
3) the xml file DefaultCLMEXPNamelist.xml in models/atm/cam/bld has been modified 
   to point to the converted clm2.1 initial datasets
	
4) the following tests were done using test-model.pl:
    tests              platform                    status
    ------------------------------------------------------------------
    eul:1-6:64x128L26  ibm (blackforest)           success
    eul:1-6:64x128L26  sgi (chinookfe)             success
    eul:1-6:64x128L26  linux (apache) lf95, pgf90  success 
    eul:1-6:64x128L26  sun (flagstaf)              success 
    eul:1-6:64x128L26  compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    eul:1-6:48x96L26   ibm (blackforest)           success
    eul:1-6:48x96L26   sgi (chinookfe)             success
    eul:1-6:48x96L26   linux (apache) pgf90        success 
    eul:1-6:48x96L26   sun (flagstaf)              success
    eul:1-6:48x96L26   compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    fv:1-6:2x2.5L26    ibm (blackforest)           success
    fv:1-6:2x2.5L26    sgi (chinookfe)             success   
    fv:1-6:2x2.5L26    linux (apache) lf95         success (know problem with pgf90 on restart due to openmp)
    fv:4-6:2x2.5L26    sun (flagstaf)              success   
    fv:1-6:2x2.5L26    compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    sld:1-6            ibm (blackforest)           success
    sld:1-6            sgi (chinookfe)             success
    sld:1-6            linux (apache) lf95         success
    sld:1-6            sun (flagstaf)	           success
    sld:1-6            compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    sld:1-6:64x128L26  ibm (blackforest)           success 
    	
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev12
Originator: eaton ( Brian Eaton)
Date: Tue Nov 26 17:48:40 MST 2002
Model: CAM
Version: CAM2.0_1.dev12
One-line Summary: new physics buffer and misc makefile changes
cam-bugs Requests resolved: none
Requires change in build system: yes
ccm366 physics now requires pnats=0 (done by configure)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux-lf95
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes, one fewer timelevel saved for cld, tcwat, qcwat, 
and lcwat fields.
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Implement new physics buffer (phys_buffer.F90) to manage fields that
persist across timesteps or that are communicated between different physics
packages within a time step.  Eventually the buffer.F90 module will be
replaced.  For now only the fields used by the stratiform cloud condensate
scheme are being managed by the physics buffer.  

The new module in cldcond.F90 is the start of an implementation of the new
physics interface for the cloud condensate parameterization.  It currently
just deals with the fields that use the physics buffer.  These fields save
a dycore dependent number of timelevels in the buffer, and that number has
been reduced by one from the buffer.F90 implementation (i.e., eul saves 2
old timelevels while fv and sld just save one).

Removed the need to declare pnats=1 for a cloud water constituent which
wasn't used when running with ccm366 physics.  The configure script now
sets pnats=0 in that case.

Modify Makefile, configure, and config_cache_defaults.xml to support using
netCDF f90 interface.  The environment variable MOD_NETCDF should be set to 
the directory that contains the netCDF module files.  This capability is not yet
required as CAM isn't currently using the netCDF Fortran 90 interface.

Added -qmaxmem=-1 to the AIX fflags for optimization.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev11
Originator: eaton ( Brian Eaton)
Date: Thu Nov 21 19:12:10 MST 2002
Model: CAM
Version: CAM2.0_1.dev11
One-line Summary: constituent initialization mods
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux-lf95
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no, except for a specific non-production configuration described below
Changes to CLM land-model: None
Changes made:

Implemented mods to allow specifying for each constituent whether the
initial values are to be read from the initial file or set by an
initialization routine.  The namelist variable readtrace now serves to set
the default value for all constituents except water vapor (its default
value is .true.).  The default may be overridden by an optional argument in
the calls that register the constituents.  The optional argument may be set
by namelist variables that are managed by the constituent's package, or may
be hardwired in the call.  The ghg chemistry package uses the default value
determined by readtrace.  The test_tracers package hardwires the initial
values to be set by an initialization routine.  Thus it is no longer
necessary to set readtrace=.false. to run the test_tracer package in CAM.
The namelist variables nusr_adv and nusr_nad have been disabled.

In the FV dycore only, the initialization of constituents has been modified
to initialize one constituent at a time.  This is to reduce the memory
requirements since we couldn't fit the waccm configuration (2x2.5, 66
levels, 50 constituents) on the ibm-winterhawk2 nodes.

The mods do not change answers in the production model.  However the
following configuration has non-bfb changes: When the ghg chemistry is run
using initial values that are set by its initialization routine (rather
than being read from the initial file), the answers change due to changed
initial values.  The ghg initial values are set with uniform distributions
rather than having a decay in the stratosphere as was previously done.
Byron believes this distribution will spin up to an equilibrium state more
quickly than the previous initial distribution.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev10
Originator: eaton ( Brian Eaton)
Date: Thu Nov 14 19:03:59 MST 2002
Model: CAM
Version: CAM2.0_1.dev10
One-line Summary: fix some uninitialized variables so lf95 debug mode works
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, pc-linux-lf95
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself.  Pat Worley provided the mods.
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

These mods fix a couple of references to uninitialized variables that caused a
runtime error in executables built w/ lf95 and strict error checking.
The test-model.pl debug test (test 1) now works on all dycores with lf95.
Also fixed a couple of incorrect intent attributes.

Mods:
dynamics/{eul,sld}/linemsdyn.F90 - init vcour to 0.
vmax2d, vmax2dt, and vcour declared  intent(inout) in
1) sld/realloc7.F90
2) sld/dyndrv.F90 (in both PVP and nonPVP branches)
3) sld/courlim.F90
cam1/radctl.F90 - fix outfld call for qrl

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev9
Originator: eaton ( Brian Eaton)
Date: Thu Nov 14 09:31:24 MST 2002
Model: CAM
Version: CAM2.0_1.dev9
One-line Summary: change AIX optimization from O3 to O2
cam-bugs Requests resolved: 75
Requires change in build system: no
Substantial timing or memory changes: didn't do performance tests
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

Makefile changes for AIX only:
O3 --> O2, and remove -qstrict which is only needed with -O3
Use -qsmp=omp:noopt in debug mode.

Surprisingly (at least to me) the answers are bfb when changing from "-O3 -qstrict" to "-O2". 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev8
Originator: forrest ( Forrest Hoffman)
Date: Wed Nov 13 12:37:22 MST 2002
Model: CAM
Version: CAM2.0_1.dev8
One-line Summary: Fix for new code introduced in cam2_0_1_dev7 that caused run-time failures on SGI and Linux
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (cheetah), SGI (thanks to Mariana Vertenstein)
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Fixes to lp_coupling
Changes made:

Replaced intent(out) with intent(inout) for srfflx to avoid passing
undefined elements back to the atmosphere physics since only land point
values are filled.  This problem was exhibited under SGI IRIX and
Linux.

Added working scalars to the private clause of the OpenMP do parallel
statements to assure appropriate scope.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev7
Originator: forrest ( Forrest Hoffman)
Date: Fri Nov  8 15:46:07 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: introduced clump land model decomposition and implemented new alltoall comm between atm and lnd
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes, about 7x speedup in cam<->clm communications (only)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein, Pat Worley
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: New land model decomposition on clumps and alltoall comunication for CAM+CLM configuration
Changes made:

1. Added new subroutine get_chunk_coord_owner_p() to phys_grid for
   both cam1 and ccm366 versions.

2. Added lnd_grid module containing the following:

   public surface_grid_init          ! initializes land surface decomposition
   public get_nclumps                ! returns the number of clumps defined
   public get_clump_cell_id_coord    ! returns clump/cell ids based on lon/lat
   public get_clump_owner_id         ! returns clump owner based on clump id
   public get_clump_ncells_proc      ! returns number of cells for process
   public get_clump_ncells_id        ! returns number of cells in clump
   public get_clump_tpatch_proc      ! returns number of patches for process
   public get_clump_tpatch_id        ! returns number of patches in clump
   public get_clump_coord_id         ! returns lon/lat coordinates based on id
   public get_clump_patchinfo        ! returns patch id and number of patches
   public get_clump_patchwt          ! returns patch weight based on patch num

   surfage_grid_init() performs the land model domain decomposition into
   clumps of grid cells containing patches.  Clumps are private derived
   data types which may be accessed through a suite of functions and
   subroutines also contained in lnd_grid (see above).

3. Added lp_coupling module containing the following:

   public lp_coupling_init             ! initialize clump<-->chunk mapping
   public lp_coupling_finalize         ! destroy clump<-->chunk mapping
   public alltoall_clump_to_chunk_init ! communicate fluxes from lnd to atm
   public alltoall_clump_to_chunk      ! communicate fluxes from lnd to atm
   public alltoall_chunk_to_clump      ! communicate fluxes from atm to lnd

   lp_coupling_init() initializes the mapping between atmosphere
   physics chunks and land model clumps.  It also allocates buffers
   for use by subroutines within the module which perform the alltoallv
   communication/transposition of surface state and fluxes between the
   atmosphere and the land.  This coupling is used when CAM and CLM are
   run together as a single executable (when COUP_CAM is defined).

4. Removed lnd_atmMod module which previously did processor mapping
   for coupling.

5. Modified atm_lndMod module to use routines from lp_coupling for coupling.
   Added TIMING_BARRIERS barriers for communications timing tests.

6. Modified clm_map subroutine to call surface_grid_init() (lnd_grid) for
   domain decomposition and lp_coupling_init() (lp_coupling) to initialize
   the atm<->lnd coupling.

7. Added npes=1 definition even for the case when SPMD is undefined so
   that new domain decomposition works correctly when running SMP-only.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev6
Originator: pworley ( Patrick H Worley)
Date: Wed Nov  6 22:34:11 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: Fixed minor bugs introduced in cam2_0_1_dev3 that were found with Lahey and SGI compilers
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes 
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Changes made:

    All changes in dynamics/eul only:

    1) Modified courlim and dyndrv to change intent of vmax2d,
       vmax2dt, and vcour from in to inout.
    2) Modified grcalc to set dalpn(2) to zero on processors
       that do not calculate it. This eliminates a failure in
       the SGI test-model DEBUG tests from using an uninitialized 
       variable. (dalpn(2) is used to calculate zurcor, which is
       used only on the processor which also calculates dalpn(2). )
    3) Moved an array initialization using array syntax
       out of an OpenMP loop, as a 
       work around for a pgf90 compiler error.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev5
Originator: bshen ( Bo-Wen Shen)
Date: Wed Nov  6 09:22:18 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: Changed DAO scripts
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: Yes (in DAO scripts)
Tested to work coupled with CCSM: no
Machines tested:  SGI 
Ran test-model.pl script: no 
Tested on fv dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 

Changes to CLM land-model: None (one-line description)
Changes made:

	
  Modified DAO scripts (configure_fv.pl and script.m4) to run
the model on DAO SGI machines.

    1. Defined SMP in Make.macros when OpenMP is used
       to run a hybrid mode on SGI.
    2. Changed the way to call system_cmd, which is
       written in C and does not accept a function name
      (trim in this case) as an argument on DAO SGI.
    3. Modified mswrite/msread which will generated at run time
    4. Calculated total # of CPUs and passed the # to PBS
       directives


===============================================================
===============================================================

cam2_0_1_dev4
Originator: eaton ( Brian Eaton)
Date: Wed Oct 30 07:46:47 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: implement ghg surface values module
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, pc-linux
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

This set of mods is in preparation for further mods to implement the new
physics interface design for initializing constituents.  The current loop
to initialize constituents that are not read from the initial file (in
{eul,fv,sld}/inidat.F90) contains a call to ramp_ghg().  This function sets
surface values for the ghg constituents which are used by the radiation
codes as well as by the ghg chemistry code.  The mods being committed
gather the code which is responsible for setting surface values of the ghg
constituents, and time interpolating them (ramping) from an annual dataset
if requested, into the single module in the file ghg_surfvals.F90.

The new module ghg_surfvals does the following:
. maintains the values co2vmr, co2mmr, n2ovmr, ch4vmr, f11vmr, and f12vmr
  as public data
. maintains the namelist variables scenario_ghg and rampyear_ghg.  The
  meaning of these variables has not changed.
. provides ramping functionality (time interpolation) when scenario_ghg is
  set to 'RAMPED'.  The data used by the ramp is determined by an include
  statement in the module.  Either file ramp_ghg_bau.h or ramp_ghg_stab.h
  may be included.  These .h files contain data formated as module data.
  When using ramped data the default is to interpolate to the current
  time.  This may be modified by setting the rampyear_ghg variable to a
  valid year which is then used to produce values that will cycle within
  that fixed year.

Files added:
physics/{cam1,ccm366}/ghg_surfvals.F90

Files removed:
physics/{cam1,ccm366}/ramp_ghg.F90
physics/ccm366/comvmr.F90

Files changed:
control/preset.F90
control/parse_namelist.F90
control/comctl.h
control/restart.F90
physics/cam1/constituents.F90 
physics/cam1/{chemistry.F90,radae.F90,radini.F90,trcmix.F90}
physics/cam1/ramp.h
physics/cam1/{ramp_ghg_bau.h,ramp_ghg_stab.h}
physics/cam1/crdcon.h
physics/cam1/radini.F90
physics/cam1/{radcswmx.F90,trcpth.F90}
physics/cam1/advnce.F90
physics/ccm366/ramp_ghg.F90
physics/ccm366/{ramp_ghg_bau.F90,ramp_ghg_stab.F90}
physics/ccm366/constituents.F90
physics/ccm366/{radabs.F90,radems.F90,radinp.F90}
physics/ccm366/radini.F90
physics/ccm366/crdcon.h
physics/ccm366/{radcsw.F90,trcpth.F90}
physics/ccm366/trcmix.F90
physics/ccm366/chemistry.F90
physics/ccm366/physconst.F90
physics/ccm366/inidat.F90
physics/ccm366/advnce.F90
dynamics/{eul,fv,sld}/inital.F90
dynamics/{eul,fv,sld}/inidat.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev3
Originator: pworley ( Patrick H Worley)
Date: Sun Oct 27 18:17:22 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: New 1D decomposition for Fourier and Spectral domains in EUL dycore, for improved performance
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes, faster for large processor counts
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: John Drake, Michael Ham
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

    Implemented a consistent wavenumber decomposition for Fourier
    and Spectral domains in EUL dycore, decreasing MPI communication and
    storage requirements. Wavenumber decomposition also modified,
    to improve load balance and decrease amount of communication.
    Routines modified: comspe, dp_coupling, dyn, dyndrv,
    dynpkg, grcalc, hordif, linemsdyn, quad, realloc4, realloc7, scan2,
    scandyn, scanslt, spegrd, spmd_dyn, trunc, and tstep. Also,
    realloc3 and realloc6 no longer needed and deleted. 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev2
Originator: pworley ( Patrick H Worley)
Date: Sun Oct 27 09:10:31 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: In-lined two temporaries in grcalc, so that new EUL dom. decomp. will be bit_for_bit on the IBM in next check-in
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Jim Rosinski
Restart files change: no
Changes answers: no on Compaq, yes on IBM (same-to-roundoff, same-physics)
Changes to CLM land-model: None 
Changes made:

  Eliminated tmpr and tmpi in grcalcs and grcalca in dynamics/eul/grcalc.F90:

    tmpr = alps(ir)*alp(mr+n,irow)
    tmpi = alps(ii)*alp(mr+n,irow)

  in-lining the expressions in the two places where each
  of them is used.This causes roundoff level changes to the solution
  on the IBM, but not on the HP/Compaq. With this change, the restructuring
  of the domain decomposition used in the spectral Eulerian (next check-in)
  will be bit-for-bit. This check-in is used to isolate and document
  the source of the roundoff change.
 
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev1
Originator: sawyer ( William Barton Sawyer)
Date: Sun Oct 20 00:53:30 MDT 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: Bug fix for tracer advection (from S.-J. Lin)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit
Changes to CLM land-model: None
Changes made:

	Retagged cam2_0_dev26 to confirm with new tagging scheme.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev26
Originator: sawyer ( William Barton Sawyer)
Date: Fri Oct 18 07:48:14 MDT 2002
Model: CAM
Version: CAM2.0.dev26
One-line Summary: Bug fix from FVGCM for multiple advected constituents (S.-J. Lin)
cam-bugs Requests resolved: unlisted
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Lin
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv/trac2d.F90:  bug fix, dp2 copy to dp1
	moved from above label 5000 to between labels 5000 and 6000

	bld/script.m4:  changes to avoid runtime errors in DAO runs
	which resulted from bug fix 64 (shell cmd now returns error code).

	Note:  test-model.pl is successful but does not test the
	multiple advected constituent case.  This change will be 
	further tested by DAO runs.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev25
Originator: erik ( Erik Kluzek)
Date: Wed Oct  2 08:33:38 MDT 2002
Model: CAM
Version: CAM2.0.dev25
One-line Summary: Fix run-pc.csh script.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: Linux-PGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Fix run-pc.csh so will run without a core-dump on apache. To do this
I changed it from pur-SPMD to pure-OpenMP mode.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev24
Originator: erik ( Erik Kluzek)
Date: Tue Sep 24 22:42:42 MDT 2002
Model: CAM
Version: CAM2.0.dev24
One-line Summary: Fix minor problems (tau units, SGI system call, FV array)
cam-bugs Requests resolved: 64,65,66
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (SGI, IBM)
Machines tested: IBM, SGI, lf95, PGIF90, Solaris
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself,mvertens,boville (units)
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Use "C" wrapper for SGI system call
Changes made:

Units change: (cam-bugs 66)

	Surface stress was identified as N, consistently use N/m^2.

FV fix: (cam-bugs 65)

	Make cut array allocatable and dimension acording to npes.

SGI System routine: (cam-bugs 64)

	Use a "C" wrapper to system call on SGI so that the return
code can be queried.

INT long-name:

	Change long-name on PRECCINT and PRECLINT to note that to
get intensity (average precipitation of precipitating events), you 
divide by PRECCFRQ or PRECLFRQ respectively.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev23
Originator: eaton ( Brian Eaton)
Date: Fri Sep 20 15:41:12 MDT 2002
Model: CAM
Version: CAM2.0.dev23
One-line Summary: updates to User Guide
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: none
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

Made changes to the sections on configuring and building CAM.  Added new
material on the run scripts.  Edited details of config files and make
procedure in appendix B.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev22
Originator: rosinski ( Jim Rosinski)
Date: Fri Sep 20 14:50:14 MDT 2002
Model: CAM
Version: CAM2.0.dev22
One-line Summary: fix potential memory overwrite bug in radae.F90
cam-bugs Requests resolved: 63
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

o Fixed potential memory overwrite bug in radae.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev21
Originator: erik ( Erik Kluzek)
Date: Mon Sep 16 23:41:41 MDT 2002
Model: CAM
Version: CAM2.0.dev21
One-line Summary: Add new output fields: PRECCINT, PRECCFRQ, PRECLINT, PRECLFRQ, and Z050
cam-bugs Requests resolved: 46, 61
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (IBM)
Machines tested: IBM, SGI, Linux-PGI, Linux-Lahey, Solaris
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

New output fields and namelist items:

	PRECCINT, PRECCFRQ, PRECLINT, and PRECLFRQ. Precipitation that
exceeds a given threshold (PRECC_THRESH = 0.1mm/hr and PRECL_THRESH=0.05mm/hr
by default, both can be set on the namelist).

Fix minor problem with FV with Lahey:

Update ccsm scripts  to ccsm2_0_beta54:

Fix so Solaris would work:

	Reduce optimization level.

Minor changes to test-production.pl:

	Remove files after completion, new reference simulation.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev20
Originator: rosinski ( Jim Rosinski)
Date: Mon Sep 16 14:38:10 MDT 2002
Model: CAM
Version: CAM2.0.dev20
One-line Summary: Implement shared constants in ice code.  NOTE: no control run for this tag yet exists.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: not yet.
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode:no
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (new-climate)
Changes to CLM land-model: None (one-line description)
Changes made:

o Use shared constants in CSIM4 ice code.
o Have not yet run test-model, but will today.  Wanted to get commit in
  because folks are waiting for it.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev19
Originator: eaton ( Brian Eaton)
Date: Sat Sep 14 10:24:24 MDT 2002
Model: CAM
Version: CAM2.0.dev19
One-line Summary: implement the Makefile SMP option for linux-pgf90
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: pc-linux-pgf90
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

	Added SMP option to the pc-linux-pgf90 section of the Makefile.  Set
	the default value of SMP to true since that replicates previous Makefile 
	behavior (the -mp flags were hardwired into the pgf90 settings).  But
	note that the default in the configure script sets SMP false for pc-linux.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev18
Originator: olson ( Jerry Olson)
Date: Fri Sep  6 17:29:17 MDT 2002
Model: CAM
Version: CAM2.0.dev18
One-line Summary: bugfix in sld/scan2.F90
cam-bugs Requests resolved: none
Requires change in build system: no
(one-line description of changes: fixed treatment of non-advected tracers in sld/scan2.F90
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: no
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

	sld/scan2.F90 was copying cloud water from one time level to 
	another.  Loop was generalized to copy *all* non-advected 
	tracers.
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev17
Originator: sawyer ( William Barton Sawyer)
Date: Thu Sep  5 06:48:57 MDT 2002
Model: CAM
Version: CAM2.0.dev17
One-line Summary: Allowed 3 latitudes per process; improvements from fvgcm-1_3_71
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, S.-J. Lin
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	In src/dynamics/fv:

		spmd_dyn.F90    Test for >= 4 latitudes now 
				>= 3 latitudes per process; tested
				72x46x26 with 12 processes and 
				144x91x26 with 24 processes.  Works.
		cd_core.F90	Integrated optimizations and restructuring
				from fvgcm-1_3_71.  Zero diff changes.
				Note that some experimental changes 	
				from FVGCM (HIGH_P, value of tau)
				have not yet been integrated.
		sw_core.F90	Now includes upol5, vpol5
		upol5.F90	Removed
		vpol5.F90	Removed

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev16
Originator: erik ( Erik Kluzek)
Date: Wed Aug 28 11:22:02 MDT 2002
Model: CAM
Version: CAM2.0.dev16
One-line Summary: Fix deadlock with scenario_so4, fix various bugs, 
    T85, T170 in scripts, update to clm2_3_dev32, ccsm2_0_beta53
cam-bugs Requests resolved: 37, 49, 51, 52
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (IBM)
Machines tested: IBM, SGI, Compaq, Solaris, PGF90
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: update to clm2_3_dev32
Changes made:

Build changes:

	Fix bug in "configure -test", so that tests will be done
in cam_bld directory, and then return to pwd. Add ability to do
T85, and T170 resolutions. Change prun in CAM_lab.pm for running
in hybrid mode.

History restart fix:

	History restart files weren't going to mass store -- now
they do.

Decomposition set in phys_grid_init rather than in call to it:

	Previously there were four locations to determine the
chunking decomposition type.

	Also remove the "is_lsm" and "is_phys366" methods. Always
assume that lsm will ONLY be run with phys366 and CLM will ONLY be
run with the new physics.

Update CLM to CLM2_3_dev32

	This fixes a problem with getting clmi files at T170.

Fix deadlock problem with scenario_so4:

	A parameter was only set on masterproc that needed to be
set on all nodes.

Update to ccsm2_0_beta53 and scripts_a020822

	both scripts and models/bld directories. scripts_a020822 fixes
a minor problem in ccsm2_0_beta53 scripts.

Test scripts:

	Add test-example.pl script to run the examples from the
users guide. Does limited checking to ensure things work as expected.
This is setup to run on blackforest.

	Add ability to set the remote lab in the "-errgro" option
in test-model.pl. This allows for port validation for remote
machines. Also delete more files that test-model.pl produces when
running in the default "clean" configuration. This prevents having
lots of wasted disk space for test-model.pl tests.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev15
Originator: sawyer ( William Barton Sawyer)
Date: Wed Aug  7 07:58:09 MDT 2002
Model: CAM
Version: CAM2.0.dev15
One-line Summary: Completed merge of fvgcm-1_3_56 te_map, cleaned up remaining t3/tvm arrays
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv:

		te_map.F90:	completed merge of fvgcm-1_3_56 te_map.F90
				code is same except for 2D decomposition
			 	additions
		dynpkg.F90:  	removed tvm, tvmxy arguments (information is
			     	in pt, ptxy)
		dp_coupling.F90:Use pt/ptxy instead of t3/t3xy
		stepon.F90:	remove t3xy entirely, t3 from d_p_coupling
				arguments

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev14
Originator: sawyer ( William Barton Sawyer)
Date: Tue Aug  6 09:01:22 MDT 2002
Model: CAM
Version: CAM2.0.dev14
One-line Summary: Patched FV communicator bug in coupled mode; T3 reset to phys_state%t in p_d_coupling; config. improvments
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	models/utils/pilgrim:

		parutilitiesmodule.F90, mod_comm.F90: extended initialization
		routines to accept an optional communicator from which
		the FV global communicator is determined.

	models/atm/cam/bld

		configure_fv.pl, fvtest.sh, script.m4:  for DAO 
		code execution, renamed run script fvcam.j, 
		number of threads, processes renamed to DAO
		convention AGCM_N_PROCESSES, AGCM_N_THREADS_PER_PROCESS

	models/atm/cam/src/dynamics/fv

		dp_coupling.F90 :  t3 reset to phys_state%t in p_d_coupling
                                   (suggestion from Brian).

		stepon.F90 :       modified arg list to p_d_coupling, removed
				   explicit transpose of T3XY->T3 for 2D decomp.

		spmd_dyn.F90 :     pass mpicom to ParInit.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev13
Originator: jet ( John Truesdale)
Date: Thu Aug  1 16:03:16 MDT 2002
Model: CAM
Version: CAM2.0.dev13
One-line Summary: Fix  initialization problem with fractional land, doesn't affect climate, only for CAM not CCSM
cam-bugs Requests resolved: 43
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: no (does all of the following tests)
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: Yes ( new-physics)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:
initext now uses the ts value from the land initialization routine instead
of the value returned from the update surface fluxes routine.  I added an
array to save off these values and apply them after iceint is called.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev12
Originator: erik ( Erik Kluzek)
Date: Wed Jul 31 14:20:10 MDT 2002
Model: CAM
Version: CAM2.0.dev12
One-line Summary: Add 2D-decomp for FV to bld, Fix Solaris climate, add production test, add timing parser, fix various bugs
cam-bugs Requests resolved: 17, 20, 27, 30, 31, 33, 35, 36, 37, 39
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: yes
	(makes use of the _OPENMP CPP token when SMP on, compiler options 
	must set this)
Substantial timing or memory changes: no
Requires change in run script: Yes 
	(dif4 now required on namelist if Eulerian and not T42)
Tested to work coupled with CCSM: Yes! (IBM)
Machines tested: IBM, SGI, Solaris, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

FV 2D parallel decomposition option added to bld scripts:

	Requires a new namelist (mprun2d).
	Also added a "-fv2d" option to test-model.pl to run fv tests
	with 2D decompostion. Also fix the constraint in src/dynamics/fv
	so that the npr_yz array from the namelist is checked properly.

Solaris:
	Change Makefile so that model gives climate similar to IBM.

Makefile:
	Add CPPDEF for CPP definitions used by all platforms. Also
	include a new token "CAM" declared when compling code with CAM.
	Remove "-d" on AIX, and turn on "-g, -qfullpath" in 
	production mode so that when the model core-dumps you can 
	query the core files to find where it died.

dif4:
	Now require dif4 to be set on namelist for Eulerian dynamics not
	at T42 resolution.

restart-pointer files:
	Get rid of getfil for restart-pointer file and add an optional
	argument to opnfil, so that "old" can be given for type so that
	the model will die if a restart pointer file doesn't exist.

Fix some problems with using scenario_so4:
	Fix write statements before "call endrun" so that they will be
	written even if not on masterproc. Also broadcast sulfdata to all
	nodes. There still seems to be other problems with this configuration.

namelist:
	Fix namelist parsing so that repeat declarations can be used
	(i.e. mfilt = 4*1). Also update the change method so that it parses
	as a regular namelist which allows arrays to be entered and more
	complex namelist entries.
test/system:
	Add ccm366 test and SMP=FALSE test to test-model.pl (unless on 
	AIX, ensure that SMP test gives same answers as SPMD). Add "-fv2d"
	option to test-model.pl to check FV 2D decompostion. Add some simple
	performance checking to test-model.pl. Add test-production.pl
	a script to run the production model from Sep to Feb/1 weekly
	to ensure the model is running as expected.

check-timing.pl:
	Add a script to do straight forward parsing of timing.* files to
	look at performance. Simplist operation is as follows:

	check-timing.pl directory1 directory2

	Options also exist to load the log-files in, and casenames, as
	well as a list of timers to parse in the file. To get help invoke
	it with "-help" or without any arguments.

ESMF: 	Update to ESMF_0_0_2p5 (fixes problem with compiling on Sanitas)
	This small update changes the name of "conf.h" to ESMF_conf.h
	so that it won't find the wrong file in the search path. It also
	removes the hard-wired use of /usr/local/include. Also previous 
	model versions didn't have all files updated to ESMF_0_0_2p4, and
	this update fixes that problem.

FV now passes LF95 strict checking tests with test-model.pl:

	Arrays in restart_physics:write_restart were going over pcols
	rather than cols for FV. By having the arrays only go to ncols
	this worked with LF95 and FV.

phys_grid.F90:
	Change a difficult to understand OMP loop used to get the
	number of threads to a more straight-forward OMP subroutine call.
CCSM:
	Update to ccsm2_0_beta50. Add table for dif4 to atm.setup.csh.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev11
Originator: sawyer ( William Barton Sawyer)
Date: Tue Jul 30 09:22:20 MDT 2002
Model: CAM
Version: CAM2.0.dev11
One-line Summary: te_map.F90 aligned with latest FVGCM version; optimizations: overlapping communication/computation
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, W. Putman
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv/te_map.F90

		o  Removed CPP token OLDWAY
		o  Aligned with latest FVGCM version
		o  Restructured communication (particularly for 2D
		   decomposition) to overlap communication with computation
		   as much as possible.  Slight performance gains conceivable.
 
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev10
Originator: sawyer ( William Barton Sawyer)
Date: Mon Jul 15 10:20:32 MDT 2002
Model: CAM
Version: CAM2.0.dev10
One-line Summary: Merged latest work from DAO FVGCM version fvgcm-1_3_44 
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Lin, Putman, Shen
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	atm/cam/src/dynamics/fv

		sw_core.F90, tp_core.F90, upol5.F90, vpol5.F90 --
			changes by Putman allow runs with only 3
			latitudes per PE

		trac2d.F90 -- cache optimizations by Lin for tracer advection

	utils/pilgrim

		mod_comm.F90  -- latest version from FVGCM
		Makefile.conf.IRIX64 -- support recent change #include <file.h>
		unit_testers/Makefile   rather than #include "file.h"  

	atm/cam/test/system

		dao_batch.csh -- batch script to run test-model.pl on DAO
				 machines (currently tropic and dycore)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev9
Originator: sawyer ( William Barton Sawyer)
Date: Thu Jul  4 14:12:43 MDT 2002
Model: CAM
Version: CAM2.0.dev9
One-line Summary: Bug fixes for 2D domain decomposition, LF95 strict error checking
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:  

	in src/dynamics/fv:

	inidat.F90 : chunking patch suggested by Pat Worley

	restart_dynamics.F90: bufres now allocated on all PEs
		(for LF95 strict error checking)

	sw_core.F90, tp_core.F90 : revision by S.-J. Lin 
		crx in tpcc now ghosted +/- ng_c latitudes

	benergy.F90, cd_core.F90, trac2d.F90, uv3s_update.F90:
		fix for 2D domain decomposition on IBM --
		pole PEs now do not accidently send data
		to lower or upper levels.  Code still does
		not work on all IBM 2D configurations but 
		it is getting closer.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev8
Originator: sawyer ( William Barton Sawyer)
Date: Mon Jun 24 02:12:01 MDT 2002
Model: CAM
Version: CAM2.0.dev8
One-line Summary: FV patches for Lahey strict error checking
Requires change in build system: no
ubstantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv:

		mapz_module.F90:Q2 now INOUT in map1_ppm, mapn_ppm,
				because Q1 (IN) and Q2 (was OUT)
				were being passed same array

		sw_core.F90:  	crx now declared (im,jfirst-ng_d:jlast+ng_d)
				passed to tpcc crx(1,jfirst-ng_d).
				No error when ng_d == 0 (SMP-only)

		tp_core.F90:	In tpcc, dummy argument crx now declared
				crx(im,jfirst-ng:jlast+ng).  No error when
				ng (== ng_d) == 0.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev7
Originator: erik ( Erik Kluzek)
Date: Thu Jun 20 23:48:55 MDT 2002
Model: CAM
Version: CAM2.0.dev7
One-line Summary: #include "" to <>, Fix Solaris make, Fix SLD for Lahey, change   coupled restarts, fix sort, update csm_share/bld/scripts, fix clm restart
cam-bugs Requests resolved: 19, 18, 25, 26
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes! (IBM, restarts tested as well)
Machines tested: IBM, SGI (some testing on Solaris, and Linux/Lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, olson (sld)
Restart files change: yes (but only if COUP_CSM set)
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Fix restart pointer files for long casenames
Changes made:

SLD changes for Lahey strict error checking:

	Small changes to q arrays sent to a few routines so that
	dimension of arrays would pass strict error checking in Lahey
	compiler.

Restarts:

	Change restarts when running coupled (COUP_CSM on), so that
	data not used for coupled runs not output/read. This also allows
	model to use the restart files from the b20.007 simulation.

Sort routines:

	Change sort routines in responce to bug found by Phil Rasch.

csm_share:

	Update csm_share to share2.1.3.

Misc:

	#include "" to #include <>
	Initialize ctitle and let it be up to 256 characters.
	Put "if (masterproc)" around write(6 statements for ramping.
	test-model.pl, get rid of global data used for setting up tests.
		Replace it with methods. This is a better more robust solution.
	Add -qfullpath when debug on for IBM.
	Update models/bld, and scripts directories to ccsm2_0_beta47.
	Get coupled scripts to work with CAM directory structure, and
		change so that restart can work.

CLM:
	Don't limit length on string read in from restart pointer file, 
	as this causes problem when casenames are long.

Solaris:

	Change Makefile so that model will work, get rid of special
	F77 compilation and use new autopromotion flag in the new compiler.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev6
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Jun 20 15:31:15 MDT 2002
Model: CAM
Version: CAM2.0.dev6
One-line Summary: put chunking into coupled model
Requires change in build system: no
cam-bugs Requests resolved: 24
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Substantial timing or memory changes: Yes 
	(significant performance improvement when chunking is turned on)
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI
Ran test-model.pl script: no (does all of the following tests)
        Changes only affected coupled model model
Code reviewed by: myself, erik
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Changes made:

	Put chunking into coupled model
	
	Verified bfb with ccsm2_0 and that PCOLS=16 and PCOLS=128 was bfb the same
	on the SGI and IBM in coupled mode 
	
	Verified that coupled model restarts and branches correctly
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev5
Originator: eaton ( Brian Eaton)
Date: Wed Jun 19 19:49:37 MDT 2002
Model: CAM
Version: CAM2.0.dev5
One-line Summary: build procedure mods, memory allocation mods
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

  Remove ccm366/cldwat.F90 - not used

  Add capability to bld/build-namelist to build LSM namelists

  bld/configure
  Add -[no]smp option
  Add -pcols option

  Makefile:
  Add SMP macro to allow enabling/disabling openMP without having
    to edit Makefile.  Currently only implemented for AIX and SGI.
  Get rid of the -macro_expand option to SGI f90 because
    it's not needed when you use -cpp.

  physics/cam1/phys_grid.F90 - move globalfield allocation from stack to heap
    in write_field_from_chunk and read_chunk_from_field

  dynamics/{eul,fv,sld}/stepon.F90 - move stack memory allocation of
    3-D physics and dynamics data structures to heap

  models/ice/csim4/ice_tstm.F - change first character of comment lines
    starting with c to !

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev4
Originator: erik ( Erik Kluzek)
Date: Sat Jun 15 08:04:21 MDT 2002
Model: CAM
Version: CAM2.0.dev4
One-line Summary: Remove precision module, and use csm_share/shr_kind_mod 
	instead with renames to r8,r4,i8
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Yes, same change to precision as above.
Changes made:

Precision change:

	Remove precision module and use csm_share shr_kind_mod module
	to get precision types. Use the rename feature to get the names
	that were used in the precision module.

Tools change:

	Make same change to the tools: cprnc, definesurf, interpic, mkrgrid,
	and cprlndnc. In this case keep a local copy of shr_kind_mod for
	their use. Made sure each tool changed would build after the change.

Bug-Fix:

	Added definition of CPP_INTEGER4 to pilgrim.h as was needed to
	get fv to build.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev3
Originator: sawyer ( William Barton Sawyer)
Date: Thu Jun 13 07:39:36 MDT 2002
Model: CAM
Version: CAM2.0.dev3
One-line Summary: Solved SUN compilation problem; further merging of FVGCM into CAM; bug fix for SMP-only
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, SUN
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Putman, Mirin
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	models/atm/cam/bld:
		configure_fv.pl, script.m4, revised for cam2_0 data sets (Mirin)

	models/atm/cam/src/dynamics/fv:

		pft_module.F90 : merged from FVGCM (minor additions)
		sw_core.F90 :    merged from FVGCM
		cd_core.F90 :    bug fix in call of c_sw
				 modified to use pft_module and sw_core

	models/atmlnd_share:

		precision.F90 :	 added i4 needed by DAO (mod_comm)

	models/utils/pilgrim:

		mod_comm.F90 :	 fixed SUN compilation problem, upgrade (Putman)					 additions for STAND_ALONE mode (Sawyer)
		
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev2
Originator: sawyer ( William Barton Sawyer)
Date: Tue Jun  4 09:40:49 MDT 2002
Model: CAM
Version: CAM2.0.dev2
One-line Summary: Merge of FVGCM (DAO) software engineering improvements into CAM2
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (test-model.pl) SGI (DAO A26, B26 cases)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Bill Putman, others
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	This merges cam1_8_dev6_brnch_fvgcm_merge with cam2_0_dev1.

	models/utils/pilgrim:

		Newest version of mod_comm (but does not yet solve
		real -> real(r8) promotion problem on SUN).
		Upgrade of other modules for use in CAM-DAS
		restructuring and upgrades of unit testers.
 
	models/atm/cam/src/dynamics/fv:

		Software engineering improvements from FVGCM (DAO)

		benergy.F90 cd_core.F90 d2a3dijk.F90 d2a3dikj.F90
		dp_coupling.F90 dynpkg.F90 highp2.F90 hswf.F90 
		p_d_adjust.F90 te_map.F90 trac2d.F90 uv3s_update.F90
		use new mod_comm interface.  

		mod_mpi.F90 removed.

		mapz_module.F90 consolidates vertical interpolation routines:
		kmppm.F90 map1_ppm.F90 map3_ppm.F90 ppm2m.F90 steepz.F90

		inidat.F90 initcom.F90 pmgrid.F90 spmd_dyn.F90 trunc.F90 
		  minor structural changes
		

	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev1
Originator: erik ( Erik Kluzek)
Date: Mon Jun  3 14:10:23 MDT 2002
Model: CAM
Version: CAM2.0.dev1
One-line Summary: Fix test-model.pl problems, fix problems running Lahey 
	for Eul dy-core, add T31 namelist options
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (some testing on Linux with Lahey--lf95)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

T31:

	Add namelist options and datasets needed to run T31.

test-model.pl

	Fix a couple problems with test-model.pl. Will now properly
run through the list of all dynamics. Start refactoring to a more
general way to run through the tests with object methods rather than
global data. Put quotes around run env variables, allow setting of
interactive option in CAM_namelist, make sure CAM objects have everything 
properly set withe either setenv or setcfg.

Lahey fix:

	A few changes to dynamics/eul so that qfcst arrays can be properly
dimensioned. Inside spegrd and tfilt_massfix copy qfcst from i1 to nlon+i1-1,
so that strange things with memory don't have to be done. This allows
tests 1 and 2 with test-model.pl to work for Eulerian dynamics. Test 13 fails. 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev11
Originator: erik ( Erik Kluzek)
Date: Fri May 17 10:37:16 MDT 2002
Model: CAM
Version: CAM1.8.dev11
One-line Summary: License update, icefrac bug-fix, build fixes, dataset name changes, fix test-model.pl so that validation could be done
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes
	(dataset names change)
Tested to work coupled with CCSM: yes! (IBM)
Machines tested: IBM, SGI, Linux-PC-PGI 
	(some testing on Compaq, Linux-Lahey, and Solaris)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

License update:
	Update to CAM license as reviewed by Bill Collins and Catherine
	Shea (NCAR lawyer).

icefrac bug-fix:
	Fix problem introduced in cam1_8_dev10 on initialization of
	icefrac. 

Build fixes:
	Various fixes to build scripts to work on machines at ORNL.

Name changes:

	Dataset names change to be consistent with the following format:

	<model><file type>_YYYY-MM-DD_<resolution>_L<vertical levels>_<description>_<creation date>.nc

	resolution for spectral dycores is refered to as nlatxnlon, with
	the spectral truncation following. So for example, Eulerian T42 is
	refered to as: 64x128_T42, SLD T63 is 64x128_T63. Datasets that
	don't have a specific spectral truncation associated with them
	leave off the spectral truncation part (so initial datasets run
	through definesurf or most land datasets).

	Example:

	cami_0000-09-01_64x128_L26_c020514.nc

test-model.pl

	Fix test-model.pl so that release version of the model could be 
	validated.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev10
Originator: erik ( Erik Kluzek)
Date: Mon May 13 12:01:17 MDT 2002
Model: CAM
Version: CAM1.8.dev10
One-line Summary: Replace Numerical-Recipe code, Lahey fixes for multiple constituents, Update to ccsm2_0_beta45, update to clm2_3_dev30, some Solaris and Compaq fixes
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux-PGI, Linux-PGI/GCC
	Some testing with Solaris and Compaq, but not everything works.
Ran test-model.pl script: yes (does all of the following tests)
 (test-model.pl currently broken test-model ran with previous version)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Update to clm2_3_dev30
Changes made:

Known problem:
	This model core-dumps in the standard configuration due
to a problem with the initialization of icefrac.

Lahey fixes:

	Do some fixes for strict error checking with Lahey compiler when
using multiple constituents.

Numerical Recipes sorting routines replaced:

	Numerical Recipes routines CAN NOT be publically released, so
they were replaced by Tony Craig's implementation of the same alogrithm.

cprnc:

	Fix cprnc so it would work on Solaris. Solution was a Kludge to
get it to work. More work should be done to find the underlying problem.

CCSM2_0_beta45 update:

	Update models/bld and scripts to ccsm2_0_beta45.

CLM2_3_dev30 update:

	Update CLM to clm2_3_dev30.

test-model.pl

	With the new build stuff in place test-model.pl is currently
broken. It will be fixed as soon as possible (which may be after the
model release).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev9
Originator: eaton ( Brian Eaton)
Date: Mon May 13 11:22:15 MDT 2002
Model: CAM
Version: CAM1.8.dev9
One-line Summary: merge newbld branch
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: none
Ran test-model.pl script: no - it's officially broken
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself, Erik
Restart files change: no
Changes answers: no
Changes to CLM land-model: None (one-line description)
Changes made:

Added new build scripts and user docs.

atm/cam/bld/configure produces the Filepath, misc.h, params.h, preproc.h files,
and a Makefile.

atm/cam/bld/build-namelist produces a namelist file

test-model.pl is currently broken because Erik's mods to have it use CAM_namelist.pm
have not been completed.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev8
Originator: erik ( Erik Kluzek)
Date: Wed May  8 17:41:26 MDT 2002
Model: CAM
Version: CAM1.8.dev8
One-line Summary: Fix CCSM restart problem
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes! IBM
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes (eul coupled only)
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Fix problem where restarts when running coupled were not bit-for-bit.
All changes are isolated to ccsm_msg.F90.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev7
Originator: jet ( John Truesdale)
Date: Wed May  8 16:22:05 MDT 2002
Model: CAM
Version: CAM1.8.dev7
One-line Summary: definesurf to extend ross ice shelf by default, clean up csim error messages
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no 
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:
Fix to definesrf to make it extend ross ice shelf by default.  Non-land
below S79 is set to land so that land will treat the area as glacier.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev6
Originator: sawyer ( William Barton Sawyer)
Date: Wed May  8 07:59:26 MDT 2002
Model: CAM
Version: CAM1.8.dev6
One-line Summary: FV patches to help pass lf95 strict error checking, Erik's fix of tphysbc.F90 to pass FV test 1
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, erik 
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

	bld:   configure_fv.pl and script.m4 upgraded for cam1_8

	src/physics/cam1:  tphysbc.F90  fix by Erik to pass FV test 1

	src/dynamics/fv:

		avgc.F90 : retired
		cd_core.F90 : inlined avgc.F90 
		dp_coupling.F90 : intent(inout) u3s (it's updated during ghost)
		dynamics_vars.F90: temporary arrays allocated for SPMD only
		dynpkg.F90: 2D decomposition arrays now allocated consistently
		pmgrid.F90: initialize 2D decomp variables for non-2D case
		stepon.F90: 2D decomposition arrays now allocated consistently

	utils/pilgrim:

		mod_comm.F90:  intent(inout) q in BufferUnPack*D
	
Note:   it will pass lf95 strict error checking in SPMD mode on Linux
	only if following routines are compiled with DEBUG FALSE:
	fv_prints.F90, restart_dynamics.F90 and restart_physics.F90.
	Strict error checking yields errors in those routines which
	may be related to the chunking mechanism.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev5
Originator: erik ( Erik Kluzek)
Date: Tue May  7 13:03:41 MDT 2002
Model: CAM
Version: CAM1.8.dev5
One-line Summary: Fix problem with restarts when running coupled.
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes! IBM (full "K" test suite)
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: No -- not when running coupled!
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Change ONLY ccsm_msg.F90 so that restarts would work. Ran the
full CCSM test GUI on the BIM (blackforest).

This version has a bug in it where restarts are not exact when
running coupled. This problem is fixed in cam1_8_dev8.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev4
Originator: rosinski ( Jim Rosinski)
Date: Thu May  2 15:12:01 MDT 2002
Model: CAM
Version: CAM1.8.dev4
One-line Summary: xlf90 bugfix for h_override.  make clean deletes esmf.  flint complaints.  modified timing calls.  Added lf95 to definesurf makefile.
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

o Bug in xlf90 caused h_override to behave improperly.
o "make clean" now deletes esmf/ directory as well as .o, etc. files
o Fixed some flint complaints.
o Added lf95 entry to definesurf makefile.
o Modified some of the calls to the timing library.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev3
Originator: erik ( Erik Kluzek)
Date: Wed May  1 22:25:25 MDT 2002
Model: CAM
Version: CAM1.8.dev3
One-line Summary: Output field changes, cam1 to cam2, FLAND to LANDFRAC, 
	fix vertinterp, longname for constituents
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes
	(Restart pointer files are now cam2 instead of cam1, restart files have cam2 in name)
Tested to work coupled with CCSM: Yes! (SGI and IBM)
Machines tested: IBM, SGI, Linux-PGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens (and input from wcollins, pjr, and boville)
Restart files change: no
Changes answers: no (bit-for-bit) (although DTCOND different)
Changes made:

Output field changes:

	DTCOND -- Changed to be defined by dry static energy instead of
                 temperature to be more consistent with current alogrithms.
                 This change is from Fabrizio Sassi.
	New fields:
		WSPEED -- Wind speed (default maximum)
		FSDSC --- Clearsky downwelling solar flux at surface
		PRECTMX - Maximum precipitation rate
		(Add above to monthly files)
	Put TREFMNAV and TREFMXAV on output monthly files for non-coupled case.

	These changes are in ccsm-bugs as request 19.

Change instances of cam1 to cam2:

	Change occurances of cam1 to cam2 in output file names and code comments.

FLAND on initial files is now LANDFRAC:

	Have initial files that are produced use the name LANDFRAC instead
of FLAND to be consistent with history files. This also put attributes on
the field which didn't happen with the FLAND name. For backwards compatability
allow the names on the initial files to be either LANDFRAC or FLAND.

vertinterp:
	Apply a fix to vertinterp as found by Art Mirin. This fixes a problem
	if the interpolation pressure happens to exactly equal the pressure
	at a data-point.  Recorded in ccsm-bugs as request 29.

Constituents module now has longname data element:

	Add longname to constiuents module and set it as an optional argument
	in add_cnst. When add_cnst called if appropriate set longname to
	something useful.

Coupled:
	Change scripts to look at inputdata/atm/cam2 input directory.
	Fix log-file output problem by adding a if( masterproc) on 
	the "stopping at end of day" print.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev2
Originator: erik ( Erik Kluzek)
Date: Sat Apr 27 09:39:39 MDT 2002
Model: CAM
Version: CAM1.8.dev2
One-line Summary: Update to cam1_8_dev1_brnchT_esmfup4 -- 
   Update to ESMF_0_0_2p4, clm2_3_dev29, ccsm2_0_beta41, simple fixes, 
   nix scatter/gather aliasing for CCSM
Requires change in build system: Yes (ESMF build changes)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (SGI and IBM)
Machines tested: Some testing on all platforms: 
	IBM, SGI, Compaq, Solaris, Linux-PGI, Linux-Lahey, Linux-PGI/GCC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Update to clm2_3_dev29
Changes to ESMF: Update to ESMF_0_0_2p4
Changes made:

ESMF update: Update to newer version of ESMF with name changes from
	mf_ to esmf_. The newer ESMF simplifies the build by not needing
	dependence on OMP or MPI, so nothing is referenced outside the
	ESMF distribution.

CLM2 update: Update to clm2_3_dev29 which works with ESMF version above.

CCSM Update: Update models/bld and scripts directories to ccsm2_0_beta41
	version of the scripts. Also put PCOLS define in CCSM scripts rather
	than hardcoded in ppgrid.F90. Ran csm.csh test on babyblue and utefe.
	Bit-for-bit with non-SPMD version and bit-for-bit with previous
	model.

CCSM Scatter/Gather aliasing: Get rid of the aliasing (using the same array
	for input and output) in the mpigather and mpiscatter calls in 
	ccsm_msg.F90. In the process create a new allocatable array allocated
	on masterproc and an old array allocatable so that only dimensioned
	from beglat:endlat. This reduces the total amount of memory needed 
	for the mpi scatters and gathers.

Solaris: Fix a couple subscript problems caught on solaris in history.F90.
	Then as a particularly difficult problem was caught, turn subscript
	checking off for solaris when DEBUG=TRUE.

phys_grid.F90: Get updates from Pat Worley and Art Mirin to generalize 
	phys_grid.F90 in cam1 for odd numbers for FV dynamics. Tried same
	routine in ccm366 physics, but results in problems.

ORNL -Colt: Add settings needed to CAM_lab.pm to run on colt.ccs.ornl.gov.

Testing: Ran at least some test-model.pl tests on all platforms:

	Linux-PGI (Apache, longs), Linux-Lahey (Apache, compile test on longs)
	Linux-PGI/GCC (Apache, longs), SGI (utefe), IBM (babyblue, eagle@ornl),
	Solaris (sanitas, test 1 works), Compaq (colt@ornl tests 2-5 with SPDM off)

	There are problems with some of the standard tests in test-model.pl
	on particular platforms. These problems will need to be cleanup in
	before model release.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev1
Originator: erik ( Erik Kluzek)
Date: Mon Apr 22 13:11:18 MDT 2002
Model: CAM
Version: CAM1.8.dev1
One-line Summary: Move cam1_7_dev34_brnchT_fractional_8 branch to the development branch
Requires change in build system: Yes!
	Filepath requires new directories
Substantial timing or memory changes: Yes (running with new ice-model is slower)
Requires change in run script: Yes
	New set of SST and Initial condition files are required.
Tested to work coupled with CCSM: Yes! (IBM and SGI) 
	(bit-for-bit with ccsm2_0_beta38)
Machines tested: IBM, SGI, Compaq, Sun, Linux-Lahey, Linux-PGI
	(Sun compiles but doesn't run, Compaq core-dumps on error-growth
	test, Linux-PGI core-dumps on error-growth test with fv dynamics)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, John Truesdale, Mariana Vertenstein, Jim Rosinski
Restart files change: yes!
Changes answers: new-physics
Changes to CLM land-model: Interface changes
Control cases:
	/EATON/csm/fv2x-fland05   -- Finite-Volume with PCMDI SST's.
	/JET/csm/sldnewicefrac01  -- SLD dynamics with PCMDI SST's.
	/ROSINSKI/csm/newsstclim03 - Eulerian dynamics with Hurrell
		Hadley Center OI / Reynolds blended SST data climatology.
	/ROSINSKI/csm/newsstamip02 - Eulerian dynamics with Hurrell
		blended monthly SST data.
Changes made:

Physics:

	Fractional land and ocean: Old binary ORO flag is gone replaced
	by the fractions: landfrac, icefrac, and ocnfrac. Also the old
	flag on SST datasets is done away with and ice-cov is used for
	sea-ice concentrations. comsrf.F90 was reworked as part of this change.
	Also the offline tool "definesurf" was changed to work with the
	new datasets. "interpic" continues to work with IC files as well.

	New ice-model: A modified version of the CCSM Sea-Ice model
	Community Sea-Ice Model (csim4) is included with the model
        now in the "models/ice/csim4" directory. The old ice-model is
	included in the new directory "models/atm/cam/src/ocnsice/dataicemodel".

CCM3.6.6 Physics:

	The CCM3.6.6 physics is still supported although now it can ONLY
	be run with Eulerian dynamics/LSM and the old data ice/sst model.
	The old version of the data ice model codes are in the "physics/ccm366"
	directory.

Namelist changes:

	prognostic_icesnow -- If TRUE determine snow-depth over ice prognostically
		otherwise use a climatology.
	reset_csim_iceprops -- Reset the CSIM ice-model initial properties
		(used on a new initial run if the model blows up).

Script / Makefile changes:

	Filepath, datasets and new variable "ICEMODEL" added to deal with
	the two ice-models (CSIM4 or CCMDATA). Lahey error-checking added
	to Makefile. Initial datasets now require the land-fraction on
	them in the variable "FLAND". When using the new ice model 
	SST datasets are required to have the variables "SST_cpl" (for SST), 		and "ice_cov" for sea-ice concentration.

	"NEWBUILD=TRUE" option now the only way to use the standard makefile.
	The old "makdep" dependency generator logic ripped out of the Makefile
	and deleted from the "tools/makdep" directory.

	Users guide updated to reflect changes. DatasetLog updated with
	new datasets.

New datasets:
	To obtain the new tar-ball of datasets:

	ftp ftp.cgd.ucar.edu
	cd pub/erik
	bin
	get cam1_8.scidac-atm.datasets.tar.gz

Error-growth:

	Error-growth is much faster than previous versions of the model.
	Error-growth is still high using the dataicemodel and active-land.
	Using prognostic_icesnow=.false. improves error-growth, and using
	standard T42L26 datasets provides reasonable error-growth. Also
	running error-growth with aqua_planet on provides reasonable error-growth.

Coupled model:

	landfrac, and ocnfrac are now binary values of 0.0 or 1.0 in
	accordance to how ORO was previously assigned in the model. This
	should eventually be changed to use the values the coupler send
	explicitly.

test-model.pl:

	Change restart tests to restart after 5 time steps.
	Change error-growth full-physics test to use prognostic_icesnow=.false.
	and aqua_planet=.true. and use date from dataset rather than Dec/31.
	Delete the SOM test and add a new test to make sure using the
	dataicemodel works.
	Fix problem with recognizing old files.

interpsst gone:

	The old tools/interpsst code removed as it will not work with the
	new SST files. Also new tools for creating SST datasets are in 
	development. The new tools use the Hurrell SST datasets and also
	modify data so that when a linear time-interpolation is applied
	to the mid-monthly datapoints the observed monthly average is
	reconstructed. It's unclear when the new tools will become part
	of the distribution.

Changes to make most of the model Lahey compliant:

	Small changes to large amounts of the code so that strict error-checking
	with the Lahey compiler can be performed on most of the model. The
	files: binary_io.F90, wrap_nf.F90, wrap_mpi.F90 have not been converted.
	As part of this change the routines bouyan, and cldprp where moved
	to inside the zm_conv.F90 file.

Bug-fixes:

	Fix in phys_grid.F90 for SGI.
	Fix in filenames.F90 for IBM.

Known problems:

	IBM -- history.F90 still doesn't always compile when DEBUG=TRUE.
	Compaq -- Model core-dumps with "floating invalid" when running
		error-growth test on Compaq (Colt @ ORNL)
	The model compiles but has trouble running on the Sun. Subscript overflow
		problem when running compiler checking (Sanitas @ NCAR).
	Linux-PGI -- fv: When running FV dynamics and Error-growth the model
		aborts with an error 
                  "DEALLOCATE: memory at 43d18c10 not allocated"
                (Apache @ NCAR)

	SOM -- New model does not work with the slab-ocean model.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev34
Originator: rosinski ( Jim Rosinski)
Date: Fri Mar 29 16:44:22 MST 2002
Model: CAM
Version: CAM1.7.dev34
One-line Summary: Bugfix to tphysbc.F90 to keep uninitialized data (in ptend) from being used.
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: yes (does all of the following tests)
                          NOTE: fv tests on IBM failed for both this commit and the comparison
                          previous library due to compiler bugs.  But all ran OK on PC.
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) presuming the short tests are sufficient to ensure no garbage
                 from stack being used
Changes to CLM land-model: None
Changes made:

o Contents of local variable ptend in tphysbc were being used uninitialized. No ill symptoms were
  noticed in the dev branch, but the fractional branch was randomly seg faulting or encountering
  a floating point error when restarting on 16 nodes on blackforest.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev33
Originator: pworley ( Patrick H Worley)
Date: Tue Mar 12 14:30:32 MST 2002
Model: CAM
Version: CAM1.7.dev33
One-line Summary: load-balanced physics option; PCOLS cpp token for setting pcols; SOM chunking bug fix
Requires change in build system: yes
PCOLS cpp token required to set pcols in ppgrid.F90. params.h.in.csh modified to do this automatically. 
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM and Compaq at ORNL
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Marcia Branstetter
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

1) Changed phys_grid_init call. Instead of specifying number of
   columns per chunk, now specify number of chunks per thread.
   This then sets the number of columns per chunk appropriately, 
   guaranteeing that the same number of chunks can be assigned
   to each processor. Files affected:

  control/restart.F90
  control/wrap_mpi.F90
  dynamics/eul/inital.F90
  dynamics/sld/inital.F90
  dynamics/fv/inital.F90
  physics/cam1/phys_grid.F90
  physics/ccm366/phys_grid.F90

2) Augmented physics domain decomposition options:
   opt == -1: same as before (latitude-slice chunk, for compatibility
               with ccm366 physics, lsm1, and CSM)
   opt == 0:  For a given MPI process, all chunks have the same number
              of columns, and each thread associated with a process has
              the same number of chunks. Columns are assigned to chunks 
              to improve load balance between chunks (compared to
              the default ordering), but without requiring 
              interprocessor communication in dp_coupling.  
   opt == 1:  All chunks have the same number of columns and each
              thread has the same number of chunks, across all MPI
              processes. Columns are assigned to chunks to balance
              day/night, summer/winter "static" load imbalances. 
              Chunks are assigned to processes to minimize interprocessor
              communication in dp_coupling, but it will occur
              anyway unless the dynamics decomposition is compatbile.   
   Files affected:


   dynamics/eul/dp_coupling.F90
   dynamics/eul/dyn_grid.F90
   dynamics/eul/inital.F90

   dynamics/fv/dp_coupling.F90
   dynamics/fv/dyn_grid.F90
   dynamics/fv/inital.F90

   dynamics/sld/dp_coupling.F90
   dynamics/sld/dyn_grid.F90
   dynamics/sld/inital.F90

   physics/cam1/phys_grid.F90
   physics/ccm366/phys_grid.F90  

   control/wrap_mpi.F90
   control/restart.F90

3) Added PCOLS cpp token, used to set pcols parameter in ppgrid.F90 .
   When running coupled, pcols (still) set to PLOND. params.h.in.csh
   modified to set PCOLS default, taking care of LSM1 and CCM366 physics
   special cases. (Code courtesy of Erik Kluzek.)

   Files affected:  

   ../bld/README
   ../bld/params.h.in.csh
   physics/cam1/ppgrid.F90
   physics/ccm366/ppgrid.F90

4) Fixed chunking bug in SOM. Files affected:

   ocnsice/som/somoce.F90
   ocnsice/som/srfsomi.F90
   ocnsice/som/srfsomo.F90
   ocnsice/som/srftsbi.F90

5) Miscellaneous clean-up (removing pchnk and pchnkd parameters,
   renaming a phys_grid routine). Files affected:

   physics/cam1/physgrid.F90
   physics/cam1/ppgrid.F90
   physics/cam1/cldwat.F90
   physics/ccm366/physgrid.F90
   physics/ccm366/ppgrid.F90
   control/history.F90
 



See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev32
Originator: erik ( Erik Kluzek)
Date: Thu Mar  7 23:00:41 MST 2002
Model: CAM
Version: CAM1.7.dev32
One-line Summary: Bug-fix to cam1_7_dev30 snowfall rates, also fix interpret_filename_spec
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes!
Machines tested: IBM, SGI (some testing on Linux, SunOS as well)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, tcraig
Restart files change: no
Changes answers: Yes (fixes bug from cam1_7_dev30 where everything appears as snow)
Changes to CLM land-model: fix problem where numpatch was "use"'d twice
Changes made:

tphysbc.F90:

	Fix bad merge from cam1_7_dev30 that caused all precipitation to fall
as snow.

filenames.F90:

	Check if prev is present before using. Without this the SGI and Compaq
would seg-fault when running the model.

test-model.pl:

	Fix problem in test 6. Tests skipped don't build-namelist.

run-model.pl:

	Don't resubmit till year 1 after first simulation.

clm:

	Fix double "use" of numpatch.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev31
Originator: mirin ( Arthur Andrew Mirin)
Date: Thu Mar  7 10:11:37 MST 2002
Model: CAM
Version: CAM1.7.dev31
One-line Summary: Completed full history capability for 2D FV decomposition
Known bug: All precipitation appears as snowfall!
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Added 32-bit accumulation buffers and initial history file capability for 2D FV decomposition. This involved a number of changes to history.F90, minor changes to stepon.F90, enhancements to restart_dynamics.F90, and enhancements (made by Will Sawyer) to the Pilgrim library (puminterfaces.F90, pilgrim.h, parutilitiesmodule.F90, redistributemodule.F90). Also made a minor unrelated improvement to trac2d.F90 (elimination of 2D temporary array).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev30
Originator: erik ( Erik Kluzek)
Date: Wed Mar  6 08:58:37 MST 2002
Model: CAM
Version: CAM1.7.dev30
One-line Summary: Fix labels on monthly files, physics changes from mzh6, 
	fix CCSM logs, update to ccsm2_0_beta38
Known bug: All precipitation appears as snowfall!
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes!
Machines tested: IBM, Linux (PGI)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: Yes! (same-physics -- less snowfall, reduced Cn over sea-ice)
	Case names for changes: /CCSM/csm/b20.001
Changes made:

Bug introduced:

	This version introduces a bug where all precipitation appears as snow.
This was due to incorrectly resolving a conflict in the merge from mzh5 to
mzh6.

Fix labels on monthly files:

Monthly files were labeled with the current time-stamp. Now they are labeled
with the previous month. Also don't output a monthly file, if nstep == 0,
as it will just be an instantaneous time-sample rather than an average.

Get code updates from ccm3_12_47_brnchT_mzh6:

Snowfall is reduced by requring average temperature to be -2C. Reduce cloud
condensation nuclei over sea-ice from 40 to 5. These code changes were tested
coupled, but not stand-alone yet. Both a new coupled and uncoupled simulation
will be run shortly.

Fix log-files when running coupled:

Only redirect masterproc output to atm.log file. Redirecting all output was
causing conflicts in the log file and causing most of the information
to be lost. Also add more checks on masterproc for output when running coupled.

Update CCSM scripts to ccsm2_0_beta38:

Update the "models/bld" and "scripts" directories to point to the "beta38"
version of CCSM2.0.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev29
Originator: erik ( Erik Kluzek)
Date: Fri Mar  1 20:53:28 MST 2002
Model: CAM
Version: CAM1.7.dev29
One-line Summary: Fix initial filenames and increase caseid from 16 to 32 characters
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (eul,sld,fv), SGI (eul only)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Increase caseid from 16 to 32
Changes made:

Increase caseid from 16 to 32 characters.

Fix filenames of initial files (the .nc extension was dropped off).

Change test-model.pl. SOM test now run on all platforms (AIX was left
off before). $CASE is a little longer and more descriptive. Filewildcard
more explicit (solves a simple problem I ran into, where the old file
was found).

Ran run-model.pl with a 32-character caseid (both with CLM and LSM) 
producing initial files to make sure worked with long caseid, and 
initial files had proper name.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev28
Originator: erik ( Erik Kluzek)
Date: Fri Feb 15 17:56:56 MST 2002
Model: CAM
Version: CAM1.7.dev28
One-line Summary: Add new flexible filenames with CCSM names as defaults, update to CLM2.3.17
Requires change in build system: yes
	(SHELL_MSS is no longer required)
Substantial timing or memory changes: no
Requires change in run script: no
	(namelist options changed: rirt, nrmvn, nsmvn removed, irt => mss_irt, 
	nswrps => mss_wpass, add hfilename_spec, archive_dir option)
Tested to work coupled with CCSM: yes!
Machines tested: IBM, SGI (some testing on Linux PGI, Sun)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, eaton
Restart files change: yes!
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Update to CLM2.3.17, get to work with changes
Changes made:

Flexible filenames:

	New namelist option, hfilename_spec to specify filenames, newly
adopted CCSM standard filenames are the default. Filename specifiers set
the filenames, with the following interpretations:

	%c = casid
	%t = tape number
	%y = current year
	%m = month
	%d = day
	%s = seconds into current day
	%% = % character

By default non-monthly files have a hfilename_spec of: "%c.cam1.h%t.%y-%m-%d-%s.nc"
Hence, for example, with a caseid="test", tape number 2, writing it's first data
for 12/1 UT 0:0 for year 1, will have the filename: 
"test.cam1.h1.0001-12-01-00000.nc".

Namelist:

	nsmvn, nrmvn, and rirt removed from namelist.
	old irt renamed to mss_irt
	old nswrps renamed to mss_wpass

	Added hfilename_spec filename specifyer to history filenames.
	Added archive_dir to give MSS archive directory 

	(now defaults to /USERNAME/caseid/csm/atm).

Filenames module:

	New module to deal with filenames, and MSS options and interpret
filename specifiers (as above). Unit-test for this module was created.

Restarts:

	history and abs-ems restart full filepaths added to master restart file.
Restart pointer file changed to include information on all files needed to
successfully do a restart. Restart files are disposed to MSS when closed
rather than in wrapup.

History:

	History filenames are created and opened when data is first written to 
them. Added methods: get_mtapes, get_hist_restart_filepath, get_hfilepath
to get private data in history module. Increase length of filenames to 256.

CCSM scripts:

	models/bld updated to ccsm2_0_beta35, scripts updated to 
scripts_a011228_brnchT_a020201. system_test script updated to changes in these
scripts. atm.setup.csh updated for new namelist changes.

test-model.pl:

	New SOM dataset names added. Changed test-model.pl to use NEWBUILD
mechanism which should speedup build, changed so that error-growth tests
run without trace-gas, but with readtrace to exercise more code options. Set
nhtfrq(1) for restart tests so that all history files produce restart files.
Change Makefile so that explicit path to mkSrcfiles and mkDepends scripts
is given (using Rootdir).

CLM:

	CLM updated to CLM2.3.17 (uses new CCSM filename convention). Update
to filenames module and namelist change.

Move files unused by CLM from atmlnd_share to control:
	(Testing of files in atmlnd_share is insufficient to work with
	CLM2. So we are working on seperating the two.)
	ioFileMod.F90, gauaw_mod.F90, wrap_mpi.F90
	ioFileMod.F90 changes so that comments, and mvn is not needed, and
	SHELL_MSS option becomes standard.

MSS:

	Remove MSS comments when mswrite done, and remove SHELL_MSS CPP token,
since always used.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev27
Originator: eaton ( Brian Eaton)
Date: Fri Feb  8 18:19:23 MST 2002
Model: CAM
Version: CAM1.7.dev27
One-line Summary: bugfix for CAM makefile
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC-Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

The CAM build was failing when the new ESMF macro MF_BUILD was set to a
relative path.  Added fix to CAM makefile to convert the relative pathname
to an absolute one.

Misc:  modified bld/condense-path.pl to look for CAM.pm in $MODEL_CFGDIR.
This allows bld/configure.csh to be used in a directory other than bld.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev26
Originator: eaton ( Brian Eaton)
Date: Wed Feb  6 14:52:17 MST 2002
Model: CAM
Version: CAM1.7.dev26
One-line Summary: update esmf to MF_LLU_0_0_12p1 and add fixes for lf95
Requires change in build system: yes
CAM Makefile modified to set MF_BUILD macro used by esmf makefile.
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC-Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

David Neckels' summary of changes in MF_LLU_0_0_12p1:
> Version: MF_LLU_0.0.12
> One-line summary: Added relocatable build support.
> Changes made:
> 
> -Added variable MF_BUILD, which allows the code to be built in a 
> directory other than the default.  To use, invoke:
>    gmake BOPT=g MF_BUILD=/tmp/esmf_build 
> This will build the library under "/tmp/esmf_build".  The object files,
> the library and the mod files will all be created under the new
> directory.
> 
> -Added an install target to makefile.  The variables MF_LIB_INSTALL
> and MF_MOD_INSTALL determine where the libraries and mod files are
> copyed during the install:  (e.g)
>    gmake BOPT=g MF_BUILD=/tmp/esmf_build MF_LIB_INSTALL=/usr/lib \
>    MF_MOD_INSTALL=/usr/mod install
> (Notice that once the MF_BUILD is used, it must be passed to the
> subsequent make commands).

The CAM Makefile was changed to set the MF_BUILD directory to $(MODEL_EXEDIR)/esmf.

The latest lf95 compiler (lf9561) required the following changes to the source code:

physics/cam1/{radae.F90,chemistry.F90} - removed save attribute in variable
declarations that were in the same scope as a save statement.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev25
Originator: eaton ( Brian Eaton)
Date: Tue Feb  5 12:04:52 MST 2002
Model: CAM
Version: CAM1.7.dev25
One-line Summary: remove prognostic sulfur cycle stubs
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC-Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Only the interface to the prognostic sulfur cycle is being removed.  The
following independent features have not been removed: 1) a specified
sulfate aerosol distribution may be read from a dataset, 2) a ramp function
may be applied to the specified sulfate distribution, and 3) the indirect
radiative effects of sulfate aerosols may be estimated.

Modify files:
control/history.F90
control/initext.F90
control/parse_namelist.F90
control/restart.F90
dynamics/eul/inidat.F90
dynamics/fv/inidat.F90
dynamics/sld/inidat.F90
physics/cam1/advnce.F90
physics/cam1/initindx.F90
physics/cam1/inti.F90
physics/cam1/moistconvection.F90 - left icwmr in arg list of cmfmca.
physics/cam1/radctl.F90
physics/cam1/tphysac.F90
physics/cam1/tphysbc.F90
physics/cam1/tracers.F90
physics/cam1/zm_conv.F90
physics/ccm366/advnce.F90
physics/ccm366/initindx.F90
physics/ccm366/tracers.F90

Remove files:
control/acbnd.F90
control/clddiag.F90
control/dmsbnd.F90
control/drydep.F90
control/massbgt.F90
control/scyc.F90 - move the indirect flag into comctl.h.  Use this flag
                   directly rather than via the doindirect query method.
control/soxbnd.F90
control/sulbnd.F90
control/sulchem.F90
control/sulemis.F90
control/wetdep.F90

Misc:
  Change variable count to count1 in history.F90(wshist) to fix a problem
  with the pgf90 compiler.  count is the name of an F90 intrinsic function
  and apparently using it as a local variable was causing a problem.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev24
Originator: olson ( Jerry Olson)
Date: Thu Jan 31 17:06:44 MST 2002
Model: CAM
Version: CAM1.7.dev24
One-line Summary: modifications and bufixes to eulerian, sld, and physics
                  routines
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (IBM only)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: EUL: no  (bit-for-bit; unless "DIVDAMPN" is used in namelist)
	         SLD: Yes (same-physics)
Changes to CLM land-model: None
Changes made: 

    bugfixes:
       - divergence damper in Eulerian code
	      src/dynamics/eul/hordif.F90
       - SLD energy fixer
	      src/physics/cam1/comsrf.F90
	      src/physics/cam1/physpkg.F90
	      src/physics/cam1/radctl.F90
	      src/physics/cam1/tphysbc.F90

    other mods
	- SLD vector-field advection routine
	      src/dynamics/sld/nunv1.F90
	- src/advection/sld/engy_tdif.F90
	- removed an option from idealized physics
	      src/physics/cam1/phys_idealized.F90
	      src/physics/cam1/tphysidl.F90
	- modified "test_trace3" tracer
	      src/physics/cam1/tphysac.F90
	      
===============================================================
===============================================================

cam1_7_dev23
Originator: sawyer ( William Barton Sawyer)
Date: Wed Jan 16 13:46:35 MST 2002
Model: CAM
Version: CAM1.7.dev23
One-line Summary: Upgraded fvCAM to newest mod_comm primitives
Requires change in build system: no
Substantial timing or memory changes: possibly faster
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Putman (mod_comm primitives)
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:

	models/utils/pilgrim:

		removed bufferpack/unpack 2d,3d,4d primitives (in mod_comm)
		mod_comm.F90: added generic mp_send/recv primitives

	models/atm/cam/src/dynamics/fv

		cd_core.F90 d2a3dijk.F90  d2a3dikj.F90 dynpkg.F90  
		highp2.F90 hswf.F90 p_d_adjust.F90 te_map.F90  uv3s_update.F90

		replaced parbegin/endtransfer primitives with mp_send/recv
		primitives from mod_comm.  The only tricky part about this
		was determining the proper source and destination PE numbers:
		in the 2D decomposition this depends on the ordering of
		the mapping of the decomposition to the PEs (row-major or
		column-major).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev22
Originator: mirin ( Arthur Andrew Mirin)
Date: Tue Jan 15 14:49:36 MST 2002
Model: CAM
Version: CAM1.7.dev22
One-line Summary: Support history files for 2D FV decomposition
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation:not-applicable
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-c" option)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:

Changed history.F90, uv3s_update.F90 and restart_dynamics.F90.
Also changed CAM_lab.pm and script.m4.

Main changes were to history.F90, in order to support 2D FV decomposition.
The field_info structure was generalized to include a vertical extent. Support
for dynamics variables having global vertical extent 1, plev and plevp was added;
however, only tested variables had global extent plev. New coding supports 64-bit
accumulation buffers. 32-bit accumulation buffers are still not supported for
2D FV but are supported for 1D FV decomposition.

Previous coding had bug involving non-preservation of subscript array
range for associated pointers. That bug affected the hbuf_accum routines and
hbuf_compute_avg. Bug has been fixed; inside those routines relevant arrays
have beginning subscript equal to 1.

uv3s_update.F90 needed minor fix to properly call the history routine.

restart_dynamics.F90 had a minor bug involving 2D FV decomposition.

script.m4 (DAO) was given 1-line change involving ccm to cam transition.

CAM_lab.pm had 1-character change involving working directory on LLNL frost.




See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev21
Originator: sawyer ( William Barton Sawyer)
Date: Mon Jan  7 07:38:50 MST 2002
Model: CAM
Version: CAM1.7.dev21
One-line Summary: Merge of current DAO fvGCM FV dycore into CAM baseline: ghosting of variables, mod_comm for communication
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: no (test-model.pl -l dao not currently working)
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: n/a
Changes to CLM land-model: None (one-line description)
Changes made:

	Phase 2 of fvGCM-CAM fv dycore merge:  ghosted prognostic
	variables U3S, V3S, Q3.  Uses mod_comm for communication
	(as well as pilgrim).  More consistent use of "only" statement
	in "use" lines.  Upgrade of pilgrim (synchronized with DAO
	Chemistry Transport Model development) and mod_comm (should
	compile on Compaq now).  

	models/utils/pilgrim:

		pilgrim.h, parutilitiesmodule.F90, ghostmodule.F90:
			synchronized with DAO CTM development.
		mod_comm.F90 : should now compile on Compaq (sorry,
			not tested -- no access to a Compaq)

	models/atm/cam/src/control:

		history.F90: rather ugly code to support write of 
			ghosted U3S array.  Well be improved in later version.

	models/atm/cam/src/dynamics/fv

		prognostics : ghosted variables U3S, V3S, Q3

		cd_core.F90, trac2d.F90 : ghosting of U, V, Q3, replaced many
				pilgrim calls with mod_comm.

		benergy.F90, dryairm.F90, inidat.F90, restart_dynamics.F90
		map1_ppm.F90, d2a3dijk.F90, d2a3dikj.F90, dynpkg.F90,
		te_map.F90, fv_prints.F90, p_d_adjust.F90, dp_coupling.F90, 
		hswf.F90, uv3s_update.F90 :  accommodated ghosted variables.
		
		mod_mpi.F90 : retired (now uses mod_comm)

                dynamics_vars.F90 : new temporary unghosted variables as 
			interim solution for 2D decomposition redistributions.

 	        stepon.F90 : ghosted variable u3sxy


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev20
Originator: rosinski ( Jim Rosinski)
Date: Wed Jan  2 16:48:01 MST 2002
Model: CAM
Version: CAM1.7.dev20
One-line Summary: Mods to SOM: MLD renamed MLDANN on SST dataset., and contains
                  yearly values.  SPMD SOM indexing fix.  No resetting SICTHK,
                  SNOWH, TSSUB in SOMINI
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit) at least for non-SOM configurations
Changes to CLM land-model: None
Changes made:

NOTE: All changes are to slab ocean model (SOM) code.

o Changed name of mixed layer depths to MLDANN on SST boundary file
o Fixed indexing bug in SPMD mode (SOMINI, SOMINT)
o Removed code from SOMINI which reset SICTHK, SNOWH, TSSUB, ORO.

===============================================================

cam1_7_dev19
Originator: sawyer ( William Barton Sawyer)
Date: Thu Dec 27 07:47:01 MST 2001
Model: CAM
Version: CAM1.7.dev19
One-line Summary: FV core upgrade: Q3 indexing changed to (i,j,k,iq); no changes in order on history/restart files
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Art Mirin
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:

	Changed indexing of prognostic var. Q3 from (i,k,iq,j) to
	(i,j,k,iq) in FV dynamical core.  This change affected 
	numerous files in FV,

          cd_core.F90 fv_prints.F90 pmgrid.F90 stepon.F90
          dp_coupling.F90 inidat.F90 prognostics.F90 sw_core.F90
          dryairm.F90 mod_mpi.F90 restart_dynamics.F90 te_map.F90
          dynpkg.F90 p_d_adjust.F90 spmd_dyn.F90 trac2d.F90

        and one common file: src/control/history.F90.

	The section in history is protected by an "if ( dycore_is('LR) ) then"
	line (and is also embedded in an #ifdef STAGGERED CPP statement --
	does any other dycore use STAGGERED?)

	The order of Q3 on the initial/restart files has *not* changed.
	For the time-being there is logic to read and write Q3 in the
	original order.  This might change (in restart_dynamics.F90) later on.


	models/util/pilgrim/mod_comm.F90 has also been upgraded with
	new routines; which are not yet used by the FV core.  A code
	review/revision of these changes by Putman/Shen is pending.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev18
Originator: eaton ( Brian Eaton)
Date: Tue Dec 18 12:40:35 MST 2001
Model: CAM
Version: CAM1.7.dev18
One-line Summary: changes for share constants
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, sun, pc/linux/pgf
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Erik, myself, and Mariana
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: Yes, new constants sometimes agree to only 2 digits with old ones.  This tag requires scientific validation.
Name of tests cases on NCAR Mass-Store: Erik will do production runs.
Changes to CLM land-model: Updated to clm2_3_dev10.
Changes made:

  Update CLM to clm2_3_dev10.

  The following changes were implemented by Erik and reviewed by me.

  Use values of constants from models/csm_share/shr_const_mod.F90 for
  consistency with other CCSM component models.  The changes are mainly in
  the physics/cam1/physconst.F90 module.

  Also changed some hard-wired constants in individual parameterizations:

  ocnsice/dom/srftsb.F90
  cmair = cpair             (was 1.00e3)
  cmice = shr_const_cpice   (was 2.07e3)
  rhair = shr_const_rhodair (was 1.25)
  rhice = shr_const_rhoice  (was 9.20e2)

  ocnsice/som/oceanconst.F90
  tof    = shr_const_tkfrz -1.9_r8  (was 271.26)
  rhoocn = shr_const_rhosw          (was 1.026e3) same
  cpocn  = shr_const_cpsw           (now 3.996e3, was 3.930e3)
  tsm = shr_const_tkfrz             (was 273.16)

  physics/cam1/cldwat.F90
  rhonot = rhodair/1000.   (was 1.275e-3)
  t0 = tmelt                         (was 273.16)
  replace hard-wired 273.16 with t0

  physics/cam1/esinti.F90
  pass tmelt as an arg

  physics/cam1/gffgch.F90
  replace hard-wired 273.16 with tmelt

  physics/cam1/radae.F90
  amd = mwdry           (now 28.966, was 28.9644)

  Made some interface changes to provide initialization routines for
  setting constants in parameterizations.

  Moved routines for water vapor pressure calcs into new wv_saturation
  module.

  Moved routines for shallow convection into moistconvection module.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev17
Originator: sawyer ( William Barton Sawyer)
Date: Tue Dec 18 07:25:41 MST 2001
Model: CAM
Version: CAM1.7.dev17
One-line Summary: Bug fix of mod_comm library for AIX and Linux
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Linux
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself, Shen
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: N/A
Changes to CLM land-model: None 
Changes made:

	models/utils/pilgrim:  memstuff.c, mp_assign_to_cpu.c mod_comm.F90

	Minor bug fixes to get mod_comm to compile and run on AIX and Linux

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev16
Originator: sawyer ( William Barton Sawyer)
Date: Mon Dec 17 03:19:29 MST 2001
Model: CAM
Version: CAM1.7.dev16
One-line Summary: FV dycore improvements: mod_comm comm. library; more support for 2D decomposition
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Putman, Lin
Updated the DatasetLog (for new input data-files): no
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: N/A
Changes to CLM land-model: None
Changes made:

	model/utils/pilgrim: 

		mod_comm.F90: optimized comm. library (Lin, Putman, Shen)
		memstuff.c:   related utilities for MLP parallelism
		mp_assign_to_cpu.c:  CPU pinning utility (MLP and MPI modes)

	model/atm/cam/bld

		CAM_lab.pm: improvements for -l dao
		configure_fv.pl, script.m4: Additional support for 2D decomp.

	model/atm/cam/src/dynamics/fv

		benergy.F90, cd_core.F90, dynpkg.F90, geopk.F90, 
		hswf.F90. prognostics.F90, restart_dynamics.F90,
		spmd_dyn.F90, stepon.F90, te_map.F90:

			Phase 1 of transition to mod_comm library,
			mod_mpi replaced by mod_comm in cd_core.F90.
			Variable PT ghosted throughout various routines.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev15
Originator: rosinski ( Jim Rosinski)
Date: Thu Dec  6 11:47:59 MST 2001
Model: CAM
Version: CAM1.7.dev15
One-line Summary: Add per-tape averaging flag.  Delete inlining for SGI
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no or Yes or not-applicable
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None
Changes made:

o Added namelist option avgflag_pertape. Usage ex: if set avgflag_pertape(2) = 'I', 
  all fields on history file 2 will by default be instantaneous.  Can still
  be overridden (for example) with fincl2 = 'T:A'

o Deleted inlining for SGI (a mod to bld/Makefile). Inlining slowed compilation 
  down by 60% and resulted in zero or negative speedup.  Could also delete for
  other machines, but Makefile mods, compilation time and execution time effects
  of including inlining were not nearly as obnoxious as on SGI so left alone for now.

o Added addfld call for NSTEP. Writing this field to history file is often useful 
  for diagnosing mods to history.F90.  By default this field is not written.

o Moved dycore print from parse_namelist.F90 to cam.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev14
Originator: mvertens ( Mariana Vertenstein)
Date: Tue Dec  4 09:08:53 MST 2001
Model: CAM
Version: CAM1.7.dev14
One-line Summary: put in esmf calendar manager into clm2
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, erik
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation:  Yes (for clm2 only)
Changes answers: On utefe(sgi) and prospect (compaq) the result were
bfb when running test-model.pl with the -c option. On the ibm,
the changes were roundoff compared with cam1_7_dev13 when running with
the esmf libO version and bfb when running with the esmf libg version
(differences only appeared after 98 times steps and were due to
roundoff differences in the computation of the calendar day)
Changes to CLM land-model: Yes

1) Put in the esmf time manager into clm2 
   Brought cam code up to date with clm2_3_dev6.
   Only clm2 code was changed. 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
	
===============================================================

cam1_7_dev13
Originator: eaton ( Brian Eaton)
Date: Sun Dec  2 15:54:13 MST 2001
Model: CAM
Version: CAM1.7.dev13
One-line Summary: make history files conform to CF metadata conventions
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, sun, linux-pgf
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

  Changes are all in history.F90 except for some units changes in addfld
  calls in gw_drag.F90.  The modifications are:
  .Fix units attributes.
  .Fix convention attribute.
  .Fix description of hybrid vertical coordinates.
  .Write all coordinate variables as type double.
  .Fix description of time averaged values.
  .Add time interval boundaries.
  .Remove _FillValue attribute for variables on a full grid.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev12
Originator: eaton ( Brian Eaton)
Date: Thu Nov 29 19:08:09 MST 2001
Model: CAM
Version: CAM1.7.dev12
One-line Summary: update ESMF lib to MF_LLU_0_0_11p3
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, sun, linux/pgf
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: David Neckels
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

  Update the ESMF library from version MF_LLU_0_0_11p2 to MF_LLU_0_0_11p3.
  Date increment incorrectly normalized itself when on the first month of the
  year.  The time management increment function did not completely construct
  itself.  These bugs were uncovered during unit testing of the ESMF library
  by David Neckels.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev11
Originator: mirin ( Arthur Andrew Mirin)
Date: Wed Nov 28 23:02:45 MST 2001
Model: CAM
Version: CAM1.7.dev11
One-line Summary: Changes for multi-2D decomposition for FV dycore
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: Yes (minor roundoff differences in FV dycore routine te_map.F90)
(Note: test-model.pl only does checks this -- if you run it with the "-c" option)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:
Changed 13 files in dynamics/fv; most changes were fairly minor.
Changed control/spmdinit.F90.
Changes 3 files in physics/cam1, to allow more general chunking. These changes were actually made by Pat Worley.
Changed 2 files in Pilgrim (minor).
Added batch capability for test-model.pl for LLNL IBM Frost.
Minor change to CAM_lab.pm for LLNL Frost.
Minor changes to DAO scripts configure_fv.pl, script.m4.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev10
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Nov 26 08:32:45 MST 2001
Model: CAM
Version: CAM1.7.dev10
One-line Summary: changed mpi distribution of subgrid patches in clm2
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq 
Ran test-model.pl script: yes (does all of the following tests)
On Compaq only tested eul dynamics
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit) 
Ran test-model.pl with -compare optio
Changes to CLM land-model only: 
Brought cam code up to date with clm2_3_dev4
1) changed the distribution of subgrid patches among processors
   so that patches for a given land point must all be on the same processor
2) changed all mpi gather/scatter calls to mpi gatherv/scatterv calls
   and introduced subroutines to determine the asymmetric vector lengths
3) Put in CF1.0 conventions into clm history file
4) removed rtm_doavg from namelist - rtm averaging is now done
   if rtm_nsteps is set to greater than 1 (this does not appply
   to cam model unless cam is run with RTM - by default this is
   not the case)	
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev9
Originator: erik ( Erik Kluzek)
Date: Wed Nov 21 16:02:10 MST 2001
Model: CAM
Version: CAM1.7.dev9
One-line Summary: Get coupled model to work, update to scripts_a011121 
	and bld_b011121
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (IBM only)
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Terminate string in clm_csmMod.F90 so would compile.
Changes made:

Make changes needed to get CAM to work with coupled with CCSM. Update models/bld
to bld_b011121, and scripts/test.a1 to scripts_a011121. Run csm.csh on babyblue
to make sure would work. Also ran on utefe, but lnd.setup.csh failed due to
a "getdata" problem, the compile of CAM was successful however. Update "csm.csh"
coupled version to ccsm2_0_beta26.

Change ccsm_msg.F90 to use time_manager to get nstep (from Lawrence Buja).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev8
Originator: eaton ( Brian Eaton)
Date: Wed Nov 21 08:47:35 MST 2001
Model: CAM
Version: CAM1.7.dev8
One-line Summary: add perpetual calendar option to time manager
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, pc-linux, sun
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: Yes
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

Add namelist variables to enable perpetual calendar:

logical perpetual_run - Set to .true. to specify that a perpetual run is
                        being done (default is .false.).  If perpetual_ymd
                        is not set then read the perpetual date from the
                        initial file.

integer perpetual_ymd - Perpetual date specified as (year*1000 + month*100
                        + day).  This overrides value from initial file.

If aqua_planet=.true. then the values of perpetual_run and perpetual_ymd
are ignored.  aqua_planet mode uses a perpetual date of 321.

Modify files:

control/time_manager.F90 - add perpetual_run, perpetual_ymd to public data.
add is_perpetual method to indicate that perpetual calendar is in use.
Modify internal logic so that perpetual calendar doesn't depend on
aqua_planet mode.  Add an optional argument to specify an offset in the
get_curr_date method (needed by the CLM).

control/parse_namelist.F90 - add perpetual_run, perpetual_ymd.

Modify code in the following files to use the perpetual date when
interpolating boundary datasets if perpetual calendar is in use.
control/initext.F90
control/oznini.F90
control/oznint.F90
control/so4bnd.F90
dom/sst_data.F90
physics/advnce.F90
physics/chemistry.F90
physics/tphysac.F90

Misc:
control/initext.F90 - There was code in a #ifdef COUP_CSM section that was
nested inside a #if (!defined COUP_CSM) section.  Remove this code which
wasn't being executed anyway.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev7
Originator: eaton ( Brian Eaton)
Date: Fri Nov 16 17:35:37 MST 2001
Model: CAM
Version: CAM1.7.dev7
One-line Summary: update ESMF library
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, pc, sun
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and David Neckels
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

  Update the ESMF library from version MF_LLU_0_0_11 to MF_LLU_0_0_11p2.
  This includes bugfixes for the mfm_datedecrement and mfm_timemgrlaststep
  functions.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev6
Originator: erik ( Erik Kluzek)
Date: Fri Nov 16 09:37:28 MST 2001
Model: CAM
Version: CAM1.7.dev6
One-line Summary: Update ESMF to MF_LLU_0_0_11, change test-model.pl interface, 		fix problem with run-model.pl
Requires change in build system: Yes
(Changed Makefile on sun to be compatable with new ESMF)
(Changed Makefile for Linux-PGF90 so sgexx.F doesn't get compiled with -fast)
Substantial timing or memory changes: no
Requires change in run script: Yes (run-model.pl scripts need to use 
   setup_directories( "support" )
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, Sun, Linux-PGI (NERSC-IBM, ORNL-IBM)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes to ESMF: Update to MF_LLU_0_0_11
Changes made:

ESMF Update:

	Get newer version of ESMF library. This fixes a problem with calculating
the ending date (which fixes a problem that the CLM had in writing out restart
files at the end of the run). It also fixes problems in building on several
platforms. The previous version did not build on the DAO SGI (tropic) for 
example.

Makefile changes:

	SUN: Use -dalign for DEBUG, and otherwise -fast to be compatable
	with the new version of ESMF.

	Linux-PGF90: Set to compile sgexx.F withotu -fast, so that SLD 
	simulations won't hang.

run-model.pl change:
	Change so that CAM_run.pm sets up a directory to build makdep in
	like test-model.pl does. This allows run-model.pl to use the same
	source directory, but submit to different machines simultaneously.
	The change requires the setup_directories( "support" ) method to
	be called from run-model.pl type scripts.

test-model.pl changes:

	Change interface from mixed short names like "-l" and "-nofail" to
consistent longer names: "-lab", "-compare", "-help" etcetera.

	-l     ==> -lab
	-c     ==> -compare
	-h     ==> -help
	-t     ==> Eliminated you now get the list of test from -help
	-r     ==> -resume
	-dirty ==> -noclean
	-e     ==> -errgro
	-s     ==> -skip

For backwards compatability, -l, -c, -r, -e, and -s are still allowed, although
the longer names are prefered.

ornl: Change default CASE_DIR to a GPFS directory so that builds will work.
llnl: Change default SPMG_CMND depending on whether machine has prun or dmpirun.
      Will now automatically detect which exists and use the one that works.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev5
Originator: eaton ( Brian Eaton)
Date: Tue Nov 13 10:19:40 MST 2001
Model: CAM
Version: CAM1.7.dev5
One-line Summary: makefile changes for ESMF library build
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, PC/linux-pgf
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Erik 
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

Modified the CAM Makefile to prevent unnecessary rebuilding of the ESMF
library.

The ESMF Makefile has been improved (by David Neckels) to include support for
more Fortran compilers under Linux, and to allow simultaneous builds of the
library from different platforms with access to the same source on a shared
filesystem.  There is also a README file for the ESMF build in
top_dir/models/utils/esmf/README.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev4
Originator: erik ( Erik Kluzek)
Date: Fri Nov  9 11:44:51 MST 2001
Model: CAM
Version: CAM1.7.dev4
One-line Summary: Fix problem with run-model.pl, add condense-path utility, 
	update ESMF to MF_LLU_0_0_10p1
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq (partial tests on Linux and Sun)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Known problems: SOM test fails on AIX, LSM/phys366 test fails on Linux
	SLD test 3 (in test-model.pl) hangs on Linux-PGf90
Code reviewed by: myself, Brian Eaton
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes to ESMF: Update to MF_LLU_0_0_10p1
Changes made:

Fix path problems with run-model.pl

	Add a condense-path.pl utility to shorten pathnames with "/.." in them.
This is important since the longer directory names of CAM and the multiple
levels cause line length problems when building.

test-model.pl: Turn SOM test on for all platforms but AIX

	Let the SOM test happen for all platforms except the IBM where it fails.
Once this is fixed we should re-enable it.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev3
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Nov  7 13:00:31 MST 2001
Model: CAM
Version: CAM1.7.dev3
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit) 
Simulations:
		/ERIK/csm/eul17dev3_a ---- 5 year simulation with 
		PCMDI climatological SST's
Changes made:
	
1) put in restart consistency checks between cam and clm2
   i.e ensure that both models restart with same time step

===============================================================
===============================================================

cam1_7_dev2
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Nov  7 10:16:12 MST 2001
Model: CAM
Version: CAM1.7.dev2
One-line Summary: Put in three clm2 bug fixes that change answers
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: Yes
  CLM2 namelist must have the following changes:
  1) fpftcon = $LM_DATDIR/pftdata/pft-physiology-vegdyn-cleanup-ratio
  2) remove mksrf_firr from namelist
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik Kluzek
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers:  Yes (new-physics - bug fixes)
Changes to CLM land-model: YES
Changes made (CLM2 code):
Put in changes from clm2_2_12, clm2_2_13, clm_2_14	
	
clm2_2_12:
1) Update to clm2 changes from CCM3.12.62, from Brian Eaton 
   "Use public data and methods from time_manager mod for initialization."
	
clm2_2_13:
1) cleaned up pft physiology file and related code 
   removed anything related to biogeochemistry when DGVM is off (not defined)
2) used ratio of roughness length and displacement height to canopy top height
   instead of actual values for roughness lenght and displacement height
3) fixed openmp bug in RtmMod.F90
4) fixed branch bug in AccumulMod.F90
5) fixed DGVM bug in Fire.F90
	
clm2_2_14:	
The clm2 code in this tag is clm2_2_14 with Erik's cam1_7_1 mods
where ccm->cam in various files min the clm2/main directory	
1) (Biogeophysics_Lake.F90) - Fixed bug in lake model where latent heat of
   fusion was being used (incorrect) instead of latent heat of sublimation
   (correct).
   Also Fixed two "problems" noticed in the b202.20.0 simulations: 
2) (CombineSnowLayers.F90) -  Global water and ice contents in the 
   top soil layer were increasing with time. Eliminated ponding in 
   wetlands by assigning snow melt to runoff.
3) (SurfaceRunoff.F90) - Eliminated formation and growth of basal ice layer 
   beneath snow cover by assigning snow melt reaching impermeable ground 
   surface to surface runoff. 
   The above three fixes were tested by examining output from several single
   point and 21-year standalone simulations. No trends in surface soil
   water and ice were noted. Lake bug fix has small effects on surface
   fluxes from grid cells with lakes that have snow cover.
4) Put in volr in initial dataset
5) Put in restart id tag on restart file for consistency -
   if restart file is modified, the parameter rest_id in restFileMod.F90
   must be updated.
6) Set maximum number of auxillary history files to 2 to be
   consistent with parameter settings.

===============================================================
===============================================================

cam1_7_dev1
Originator: erik ( Erik Kluzek)
Date: Wed Nov  7 09:11:22 MST 2001
Model: CAM
Version: CAM1.7.dev1
One-line Summary: Move from CCM to CAM, mask error-growth problems by not 
	letting CLM see snowfall, Change build
Requires change in build system: Yes!
	(Change COUP_CCM to COUP_CAM for CLM, Makefile uses Rootdir file for
	ESMF build, ESMF build is done from within Makefile, directory 
	structure different)
Substantial timing or memory changes: no
Requires change in run script: Yes!
	(namelist is now camexp instead of ccmexp, input data files directory
	changed, Env variable for datasets is now $CSMDATA)
Tested to work coupled with CCSM: no (need to update CCSM build for ESMF)
Machines tested: IBM, SGI, Compaq, Sun, Linux-PGF90
	(SOM test fails on IBM, LSM/PHYS366 test fails on Linux)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein, Brian Eaton (som changes)
Updated the DatasetLog (for new input data-files): no (but need to)
	Did create 26 level T21 datasets for testing, and got test-datasets
	at T42L18 for SOM
	(new datasets at ftp.cgd.ucar; cd pub/erik; 
         get cam1_7.scidac-atm.datasets.tar.gz)
Updated the documentation: Yes (first pass at changes from CCM to CAM)
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Yes (COUP_CCM to COUP_CAM, nix references to ccm)
Changes made:

Change references from CCM to CAM.

datafiles: ccmr and ccmi files are now camr and cami
filenames: ccm3, conv_ccm, ccmoce, are now cam, conv_cam, camoce
lnd filenames: ccm_lndMod, lnd_ccmMod, are now atm_lndMod, and lnd_atmMod
CPP Tokens: COUP_CCM is now COUP_CAM
Directory structure: New directory structure compatable with the "cam1"
	cvs module rather than the "ccm" cvs module.
Other references in code and comments to CCM were changed to CAM.

New build:

	Build changed to create a Rootdir file with the top level directory
of "cam1". This is used by the Makefile to figure out the location of the ESMF
directory. The Makefile then builds the ESMF library directly from the 
Makefile. This new build system comes from David Neckels via Brian Eaton.
It is a much easier more robust way of building the model. The env variable 
DYNAMICS for Lin-Rood should now be set to "fv" in agreement with the new directory name. For the SUN take out the "-fast" option to be compatible with the
ESMF library build (put this back in when ESMF build is updated).

Run scripts:

Run scripts use "CSMDATA" instead of MODEL_DATDIR. AM_DATDIR, and LM_DATDIR 
env variables removed. New directory structure for cam with subdirectories
for: inic, ggas, rad, hrtopo, ozone, scyc, and sst for initial conditions, 
greenhouse gas, radiation, high-resolution topography, ozone, sulfur-cycle
and sea surface temperatures respectively. The environment variable OCEAN
was added to refer to the ocean model to use "dom" or "som". The env variable
PHYSICS now either should be "cam" or "ccm366" to refer to the type of physics
used.

Error-growth problem:

	Mask the current error-growth problem to some extent by only letting
CLM see rain and not snowfall. Error-growth for FV still seems to be large.

Remove Sulfur-cycle codes:

	Remove the sulfur-cycle codes (they are still accessible on the 
cam_brnch_scyc branch and with the cam1_scyc module). In their place the
dummy stubs from dscyc were put into the control directory. Eventually, we
will rip these out of the main development and only leave them on the 
sulfur-cycle branch.

Changes to test-model.pl:

	Change vertical resolution of the sld and eul tests to 26, in agreement
with the vertical resolution used for production simulations (the difference
in vertical resolution can have an impact on how changes to physics are 
perceived). Remove "-clean" option and make cleaning old directories out the
default, add the option "-dirty" to not clean files before the build. 

Users Guide:

	Users Guide now part of the distribution, first pass on moving from
CCM3.12 to CAM was completed. Namelist documentation is up to date, directory
structure is outlined. Further updates should update documentation at the
same time that code is changed.

SOM:

	SOM now part of the distribution, SOM was updated to use the new 
timing routines. "test-model.pl" has a test for SOM that is currently commented
out since it doesn't run on the IBM (does complete on other platforms however).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

ccm3_12
Originator: erik ( Erik Kluzek)
Date: Wed Jun 13 11:35:28 MDT 2001
Model: CCM
Version: CCM3.12
One-line Summary: New H2O LW abs/ems, geo-potential, precip evap, cloud-water changes, no oro-drag over ocean
Requires change in build system: no (but, Makefile updated for in-lining, see below)
Substantial timing or memory changes: no
Requires change in run script: Yes (New abs_ems_dataset, see below)
Tested to work coupled with CSM: Yes (IBM and SGI)
Machines tested: IBM, SGI, Compaq, Sun, Linux (see below)
Ran test-model.pl script: yes (does all of the following tests)
Tested on lr dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Updated the DatasetLog (for new input data-files): Yes
Updated the documentation: no (but need to)
Changes answers: Yes (new-physics)
Name of tests cases on NCAR Mass-Store:
	/JET/csm/zm31139evap06 ---- Climatological SST's T42L26, Eulerian dynamics
	/JET/csm/amipevap06 ------- AMIP2 SST's T42L26, Eulerian dynamics
	/JET/csm/amipevap06_3h ---- Daily output same as above.
	/CCSM/csm/b202.02 --------- Coupled simulations, T42L26, Eulerian dynamics	
Changes made:

IMPORTANT: Problems on SUN, and Linux, problems on batch submission to: 
           blue, eagle, gseaborg (see below). Need new datasets (see below).
----------------------------------------------------------------------------
Physical changes:
	Precipitation evaporation: 		J.J. Hack.
	Cloud water changes for mid-atm.:	P.J. Rasch
	LW water-vapor abs/ems changes: 	W.   Collins
	no orographic drag over ocean: 	B.B. Boville
	fix to geo-potential:		B.B. Boville

Land-model:
	Tested with both LSM1 and CLM2 land-models (see below). CLM2
	was updated to CLM2.1.20.
Interface changes:
	Makefile changed so that in-lining is done.
	radems/radabs became a module.
	LINUX CPP token changed to Linux (so you can use uname -s)
	Block data removed (except for phys366).
	Check that ORO is valid from IC file.
Testing:
	Code was tested both on many NCAR platforms and several off-site 
	platforms as well. test-model.pl was primarily used to validate 
	that the model started/restarted for all dynamics as well as 
	both the "physics" and "phys366" physics directories and "lsm1" 
	and "clm2" land models.  It also verified that restarts give exact 
	answers to the history files (both average and instant values), 
	and that changing the decomposition gives the same answers and 
	that SPMD and non-SPMD gives the same answers. It also checks 
	that the code can run with bounds checking on (on Sun and Linux), 
	and with the compiler initializing variables to indefinite.

	CCSM tests run ccm/test/csm.csh to ensure that the model works 
	with the CCSM coupler.  This version of the model works with 
	ccsm2_0_beta11.

Machine		lsm1-physics	CCSM	clm2-physics	clm2-phys366	lsm1-phys366
babyblue(aix)		X	X	X		X		X
blackforest(aix)	X	X	 		 		 
gseaborg(aix)		X
eagle(aix)		X
blue(aix)		X
longs(PC)		X		X				X
prospect(osf)		X		X		X		X
compass(osf)		X
utefe(sgi)		X	X	X				X
tropic(sgi)		X		X				X
sanitas(sun)		X		X				X

Error growth:
	The error-growth is faster than the previous model, especially 
	SLD but, it was deemed acceptable. HOWEVER, 
	THE ERROR-GROWTH ON THE SUN IN COMPARISON TO THE IBM IS 
	UNACCEPTABLE. Until this is fixed the Sun should not be 
	used for simulations.

Script changes: 
	test-model.pl was made more robust. Tests
	to compare SPMD non-SPMD were added and to check both avg
	and instant history files for restart tests, and new 
	input options added:

	set the env variables:

	LANDMODEL --- to define whether to use LSM1 or CLM2
	PHYSICS ----- to define whether to use "phys366" or "physics".

	skip option (-s) now allows an end-point and allows resolution
	to be specified. So

	-s eul:3-5:T42L26

	Will run tests 3-5 with Eulerian dynamics at T42 and 26 levels.

	Error-growth option. To do a port validation you can validate
	against a given trusted machine. To do this use something like:

	-e "blackforest.ucar.edu(aix)"

	This assumes you already ran test-model.pl on blackforest (and
	left everything in the standard locations). Then the "errg*.cprout"
	files will contain a comparison to the above machine.

New datasets:
	Bundle of datasets needed to run the model and use "test-model.pl".

		ftp.cgd.ucar.edu; cd pub/erik; bin; 
		get ccm3.12.acpi-atm.datasets.tar.gz

	abs_ems_factors_fastvx.052001.nc --- Required for use with 
						the new LW code.
	clm datasets  ---- 	In order to run with clm2.
	fv.4x5L18 -------- 	4x5 degree resolution dataset with 18 levels 
				for LR dynamics from Sharon Nebuda.
Known-Bugs:
	Linux: S.-J. had trouble with 10x15 on Linux with LR and the 
		Portland group compiler. I had trouble with Linux at 
		2x2.5 with LR.
	Sun: 	Error-growth was bad. Ran out of memory at some resolutions, 
		especially when doing SPMD, or when using CLM2.
	Batch: Had trouble with batch submission on the IBM-SP machines: 
		blue, gseaborg, and eagle.  Interactive, didn't have the 
		same trouble, so I'm unclear why this is the case.
	test-model.pl: When using "-s all:" option you can't give an 
			end-point or it will only run for the first dynamics.
Changes since CCM3.11:
	Many enhancements, bug-fixes, and progress on 2D-decompostion to LR
	dynamics. Update to F90 and initial Protex pass for LR.
	Replace Rayleigh friction with 1st order upwind transport.
	Revised mapping algorithm near the surface for winds.

	slaveio namelist item removed.  Namelist variable "IDEALDYN" 
	changed to "IDEAL_PHYS"	

	Support for Lahey and Fujitsu compilers on Linux. Work on chunking. 
	Columns given by phys_grid methods.  timing library added.
	Ability for bounds-checking added. FORTFFT cpp parameter deleted
	use USEFFTLIB if library available.  SPMD now doesn't require that 
	the number of MPI tasks evenly divide into the number of latitudes.

	History modularized. Progress on physics/dynamics split. Restart
	dyanmics and physics split out better.  Sulfur-cycle codes fixed.
	SLD energy fixer added.

	phys366 and clm2 directories added. Generic interface to both 
	land-models.

	Options added to scripts: PHYSICS, LANDMODEL, tests to run.
	NO_SWITCH option for LLNL Compaq. "-clean", "-nofail" and "-t"
	options added. Fix interpic for multiple times if available in file.

===============================================================
===============================================================

ccm3_11
Originator: erik ( Erik Kluzek)
Date: Thu Dec 21 16:22:20 MST 2000
Model: CCM
Version: CCM3.11
One-line Summary: New LW absorption,new vertical diffusion,SLD energy fixer,
	scripts,Lin/Rood fixes,split dynamics
Requires change in build system: yes, new build system, use 26 level model
Tested on lr dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested to work coupled with CSM: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no (currently broken)
Substantial timing or memory changes: no
Machines tested: IBM, SGI, Sun, PC
Requires change in run script: yes
	(New namelist parameter: absems_data)
	(New namelist parameter for Lin-Rood: nsplit)
	(New namelist parameter: empty_htapes)
	(New namelist parameter: aqua-planet)
	(New build/run environment provided)
	(Need to use new 26 level datasets)
Updated the DatasetLog (for new input data-files): Yes
Updated the documentation: no (will need to though)
Changes answers: Yes (improved physics)
Name of tests cases on NCAR Mass-Store: See CCM3.10.60 below
Changes made:

Physics changes from CCM3.10:

	New LW absorption of water vapor as per Dr. William Collins.
	New vertical diffusion on dry static energy as per Dr. Byron Boville.

	Energy fixer for SLD from Dr. David Williamson and Jerry Olson.
	Many bug-fixes to Lin/Rood dynamics.
	Many routines migrated to modules.

New build run environment provided:

	A completly new set of scripts provided to configure, build, and
	run the model. Also a test script provided for testing before
	committing code changes.

	A script provided to help with the process of interpolating and
	creating new initial condition datasets.

Code changes:

	Work to split dynamics and physics better.
	Initial work on 2D decomposition.
	Open MP works on PC.
	More platforms supported with LR.
	Add version, revision_id to history files.
	Fix floating point trapping on Compaq.
	Various bug-fixes.

===============================================================
===============================================================

ccm3_10
Originator: erik ( Erik Kluzek)
Date: Tue Jun 20 08:35:26 MDT 2000
Model: CCM
Version: CCM3.10
One-line Summary:	Update code to F90 and coding standard, 
			optimize radcsw, fix bugs, new LR core,
			Finish reduced grid tools
Requires change in build system: no
Tested on lr dynamics: Yes
Tested on eul dynamics: Yes
Tested on sld dynamics: Yes
Tested to work coupled with CSM: Yes
Requires change in run script: Yes (requires I/C files with LANDM)
Updated the DatasetLog (for new input data-files): Yes
Updated the documentation: Yes
Changes answers: Yes (different climate)
Name of tests cases on NCAR Mass-Store: 	/JET/csm/ccm3911 	 (full grid Eulerian)
						/ROSINSKI/csm/ccm3911_r1up (reduced grid Eul)
Changes made:

	Double tagged as CCM3.9.28.

	Update code to F90 free-form and coding standard.
	New optimized version of radcsw. Fix bug with CSM with flxave on. Fix bug
	with first time-step on Eulerian. Get offline tools to work with reduced
	grid and L/R dynamics. Change so LANDM is calculated in offline tool rather
	than inside model. Update L/R to new version, add "precision" changes. Fix
	Linux Makefile for F90 files. Fix bug with SLD and hortal smoothing and hordif. 
	Fix problems with SLD on Sun, IBM and Compaq. Fix PHIS filter bug.

===============================================================
===============================================================

ccm3_9
Originator: erik ( Erik Kluzek)
Date: Thu Apr 27 15:04:53 MDT 2000
Model: CCM
Version: CCM3.9
One-line Summary: New cloud overlap, reduced grid option, addition of Lin-Rood dynamics.
Requires change in build system: Yes 
Requires change in run script: Yes
(New options for reduced grid, or Lin-Rood)
Updated the DatasetLog (for new input data-files): not-applicable
Updated the CCM development schedule: no
Updated the documentation: Yes
Changes answers: Yes (new-climate)
Name of tests cases on NCAR Mass-Store: /JET/csm/bill30e
Changes made:

	Added new cloud overlap assumptions from Bill Collins (random overlap when gap 
	between clouds in column, maximum overlap when clouds exist in both adjoining
	layers).

	Added the reduced grid option from Dave Williamson.

	Added Lin-Rood dynamics as a new dynamics configuration.

	Output cleanup. Code cleanup. Two default output streams monthly and daily
	files.

	Support IBM and Compaq. Will compile/run on Cray, but radiation changes
	(which are highly scalar) make it run very slow. Cray will no longer be
	supported.

	Atmosphere determines partitioning of rain/snow.

	SPMD mode now works. Support hybrid SPMD/OMP memory running on IBM, Compaq.

===============================================================
===============================================================

ccm3_8
Originator: rosinski ( ROSINSKI JIM 1397 ML CGD)
Date: Fri Aug 20 11:24:07 MDT 1999
Model: CCM
Version: CCM3.8
One-line Summary: Merged netcdfhtape branch to trunk
Requires change in build system: Yes.  makdep now required.  New Makefile
Requires change in run script: Yes.  Namelist changes.
Run through comtest.spectral.csh and comtest.sld.csh: Yes
Run through csm.test.nqs: no
Updated the DatasetLog: no
Changes answers: no (bit-for-bit)
Changes made:

	o Model now writes netcdf history tapes.
	o Requires f90 compiler since modules and allocatable arrays are
	  used.  Code now should be fully f90-compliant.  No more Cray 
	  pointers or user-defined Fortran interfaces to malloc.
	o Cloud water is a non-advected tracer as opposed to advecting it
	  and throwing away the results of the advection (mvertens).
	o Model at least runs on IBM.  Have not done error growth analysis.
	o Moved time filter and mass fixer to scan2.  This became possible
	  with the time-split physics.
	o Precision now specified in code rather than relying on vendor flag
	  (e.g. -r8). This change has not yet been put in the library code 
	  (e.g. ecmfft), so -r8 flag (or equivalent) is still needed for 
	  these files.
	o Build procedure now REQUIRES use of the makdep routine provided
	  in tools/makdep.  The reason is that no standard UNIX tool I
	  know of can provide the full dependency analysis needed.
	o Eliminated out-of-core option.  History, radiation, and main
	  model buffers are now modules.  Integer pointers to buffer
	  locations are gone, as are /comgrd/ and points.F
	o Namelist changes:

old namelist                              new namelist
------------                              ------------

 &CCMEXP                                    &CCMEXP
 nlfilt   ! write extra time sample------>  <gone>
          ! to 1st volume
 stfnum   ! starting file number--------->  <gone>
 incorrad ! abs/ems in core-------------->  <gone>
 incorbuf ! model buffer in core--------->  <gone>
 incorhst ! history buffer in core------->  <gone>
 ndens = [1,2, or 4] ! packing density--->  ndens = [1 or 2]  ! double or float
 primary = 'T', 'Q',...------------------>  fincl1 = 'T', 'Q',...
 auxf    = '1', 'T', 'Q',...,------------>  fincl2 = 'T', 'Q',...
           '2', 'V', 'U',...------------->  fincl3 = 'V', 'U',...
 exclude = 'PS','PHIS',...--------------->  fexcl1 = 'PS','PHIS',...
 <didn't exist>-------------------------->  fexcl2 = 'CMFMCA','SOLIN',...
 <didn't exist>-------------------------->  xzy = [T or F] ! non-coords order
 /                                          /


===============================================================
===============================================================

ccm3_7
Originator: erik ( Erik Kluzek)
Date: Fri May 28 13:38:40 MDT 1999
Model: CCM
Version: CCM3.7
One-line Summary: Prognostic cloud-water and sulfur cycle
Requires change in build system: Yes 
(new directory scyc)
Requires change in run script: Yes
(need to use readtrace=.F. and cldw_adv=.T.)
Run through comtest.spectral.csh and comtest.sld.csh: Yes
Run through csm.test.nqs: Yes
Updated the DatasetLog (for new input data-files): Yes
Changes answers: yes
Name of tests cases on NCAR Mass-Store: /JET/csm/prgcld01
Changes made:

        Prognostic cloud-water and sulfur cycle put on the CCM development trunk.
Changes are huge, in essense this puts ccm3_6_20_brnchT_scycRad1_13 on the
trunk.  Standard mode to run is now with 30 levels and with the NOAA Ozone
dataset. So use: SEP1.T42L30_diffPHIS.0599.nc and noaao3.1990.21999.nc.
Using these datasets readtrace must be set to FALSE and normal operation
is with cldw_adv TRUE.  To build you must put the "src/scyc" directory in
your path (optionally you can checkout the dscyc module which has dummy
stub routines for the sulfur codes).  The default operation is without any
of the sulfur cycle stuff turned on.

        Caveat's:  MODEL DOES NOT WORK WITH SPMD MODE!
                    CSM was tested to ensure it works, but there were
        changes that haven't had a long simulation done to verify they
        are working correctly.

        SLD mode was tested to ensure it works, but long simulations 
        were not performed.

        Model tested on SGI, Cray, and Sun. But, the most extensive testing
        was on the SGI (ute).

        SOM not tested.  Only dom mode was tested.

        A change was put into the LSM for arbitrary initialization. The
        change is bit-for-bit when not using arbitrary initialization.
        But, new spin-up datasets have not been created nor long-simulations
        with the change (the change makes points southward of 60S land ice and 
        initializes them with a snow depth of 1m).

        Current version does not work with the 44 mid-atmosphere model.

        (a fix is on the way soon).

        Sulfur code has it's own version of the solar zenith angle.  This
        routine is incompatible with the version in csm_share.  This means
        the model should not be used for Paleo simulations, with sulfur cycle
        turned on.
        (a fix is on the way soon).

===============================================================
