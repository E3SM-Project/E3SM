













      module mo_lu_solve

      private
      public :: lu_slv

      contains
                                                                        
      subroutine lu_slv01( lu, b )
                                                                        

      use shr_kind_mod, only : r8 => shr_kind_r8
                                                                        
      implicit none
                                                                        
!-----------------------------------------------------------------------
!       ... Dummy args
!-----------------------------------------------------------------------
      real(r8), intent(in) ::   lu(:)
      real(r8), intent(inout) ::   b(:)
                                                                        
!-----------------------------------------------------------------------
!       ... Local variables
!-----------------------------------------------------------------------
                                                                        
!-----------------------------------------------------------------------
!       ... solve L * y = b
!-----------------------------------------------------------------------
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
         b(38) = b(38) - lu(31) * b(29)
                                                                        
         b(38) = b(38) - lu(35) * b(30)
         b(39) = b(39) - lu(36) * b(30)
                                                                        
         b(38) = b(38) - lu(38) * b(31)
         b(39) = b(39) - lu(39) * b(31)
                                                                        
         b(33) = b(33) - lu(41) * b(32)
         b(37) = b(37) - lu(42) * b(32)
         b(38) = b(38) - lu(43) * b(32)
         b(39) = b(39) - lu(44) * b(32)
         b(40) = b(40) - lu(45) * b(32)
                                                                        
         b(38) = b(38) - lu(47) * b(33)
         b(39) = b(39) - lu(48) * b(33)
                                                                        
         b(37) = b(37) - lu(51) * b(34)
         b(38) = b(38) - lu(52) * b(34)
         b(39) = b(39) - lu(53) * b(34)
                                                                        
         b(36) = b(36) - lu(56) * b(35)
         b(38) = b(38) - lu(57) * b(35)
         b(40) = b(40) - lu(58) * b(35)
                                                                        
         b(37) = b(37) - lu(62) * b(36)
         b(38) = b(38) - lu(63) * b(36)
         b(39) = b(39) - lu(64) * b(36)
         b(40) = b(40) - lu(65) * b(36)
                                                                        
         b(38) = b(38) - lu(71) * b(37)
         b(39) = b(39) - lu(72) * b(37)
         b(40) = b(40) - lu(73) * b(37)
                                                                        
         b(39) = b(39) - lu(86) * b(38)
         b(40) = b(40) - lu(87) * b(38)
                                                                        
         b(40) = b(40) - lu(95) * b(39)
                                                                        
                                                                        
      end subroutine lu_slv01
                                                                        
      subroutine lu_slv02( lu, b )
                                                                        

      use shr_kind_mod, only : r8 => shr_kind_r8
                                                                        
      implicit none
                                                                        
!-----------------------------------------------------------------------
!       ... Dummy args
!-----------------------------------------------------------------------
      real(r8), intent(in) ::   lu(:)
      real(r8), intent(inout) ::   b(:)
                                                                        
!-----------------------------------------------------------------------
!       ... Local variables
!-----------------------------------------------------------------------
                                                                        
!-----------------------------------------------------------------------
!       ... solve L * y = b
!-----------------------------------------------------------------------
                                                                        
!-----------------------------------------------------------------------
!       ... Solve U * x = y
!-----------------------------------------------------------------------
         b(40) = b(40) * lu(103)
         b(39) = b(39) - lu(102) * b(40)
         b(38) = b(38) - lu(101) * b(40)
         b(37) = b(37) - lu(100) * b(40)
         b(36) = b(36) - lu(99) * b(40)
         b(35) = b(35) - lu(98) * b(40)
         b(33) = b(33) - lu(97) * b(40)
         b(32) = b(32) - lu(96) * b(40)
                                                                        
         b(39) = b(39) * lu(94)
         b(38) = b(38) - lu(93) * b(39)
         b(37) = b(37) - lu(92) * b(39)
         b(36) = b(36) - lu(91) * b(39)
         b(35) = b(35) - lu(90) * b(39)
         b(34) = b(34) - lu(89) * b(39)
         b(31) = b(31) - lu(88) * b(39)
                                                                        
         b(38) = b(38) * lu(85)
         b(37) = b(37) - lu(84) * b(38)
         b(36) = b(36) - lu(83) * b(38)
         b(35) = b(35) - lu(82) * b(38)
         b(34) = b(34) - lu(81) * b(38)
         b(33) = b(33) - lu(80) * b(38)
         b(32) = b(32) - lu(79) * b(38)
         b(31) = b(31) - lu(78) * b(38)
         b(30) = b(30) - lu(77) * b(38)
         b(29) = b(29) - lu(76) * b(38)
         b(2) = b(2) - lu(75) * b(38)
         b(1) = b(1) - lu(74) * b(38)
                                                                        
         b(37) = b(37) * lu(70)
         b(36) = b(36) - lu(69) * b(37)
         b(35) = b(35) - lu(68) * b(37)
         b(34) = b(34) - lu(67) * b(37)
         b(33) = b(33) - lu(66) * b(37)
                                                                        
         b(36) = b(36) * lu(61)
         b(35) = b(35) - lu(60) * b(36)
         b(33) = b(33) - lu(59) * b(36)
                                                                        
         b(35) = b(35) * lu(55)
         b(1) = b(1) - lu(54) * b(35)
                                                                        
         b(34) = b(34) * lu(50)
         b(33) = b(33) - lu(49) * b(34)
                                                                        
         b(33) = b(33) * lu(46)
                                                                        
         b(32) = b(32) * lu(40)
                                                                        
         b(31) = b(31) * lu(37)
                                                                        
         b(30) = b(30) * lu(34)
         b(29) = b(29) - lu(33) * b(30)
         b(1) = b(1) - lu(32) * b(30)
                                                                        
         b(29) = b(29) * lu(30)
         b(2) = b(2) - lu(29) * b(29)
                                                                        
         b(28) = b(28) * lu(28)
                                                                        
         b(27) = b(27) * lu(27)
                                                                        
         b(26) = b(26) * lu(26)
                                                                        
         b(25) = b(25) * lu(25)
                                                                        
         b(24) = b(24) * lu(24)
                                                                        
         b(23) = b(23) * lu(23)
                                                                        
         b(22) = b(22) * lu(22)
                                                                        
         b(21) = b(21) * lu(21)
                                                                        
         b(20) = b(20) * lu(20)
                                                                        
         b(19) = b(19) * lu(19)
                                                                        
         b(18) = b(18) * lu(18)
                                                                        
         b(17) = b(17) * lu(17)
                                                                        
         b(16) = b(16) * lu(16)
                                                                        
         b(15) = b(15) * lu(15)
                                                                        
         b(14) = b(14) * lu(14)
                                                                        
         b(13) = b(13) * lu(13)
                                                                        
         b(12) = b(12) * lu(12)
                                                                        
         b(11) = b(11) * lu(11)
                                                                        
         b(10) = b(10) * lu(10)
                                                                        
         b(9) = b(9) * lu(9)
                                                                        
         b(8) = b(8) * lu(8)
                                                                        
         b(7) = b(7) * lu(7)
                                                                        
         b(6) = b(6) * lu(6)
                                                                        
         b(5) = b(5) * lu(5)
                                                                        
         b(4) = b(4) * lu(4)
                                                                        
         b(3) = b(3) * lu(3)
                                                                        
         b(2) = b(2) * lu(2)
                                                                        
         b(1) = b(1) * lu(1)
                                                                        
                                                                        
      end subroutine lu_slv02
                                                                        
      subroutine lu_slv( lu, b )
                                                                        

      use shr_kind_mod, only : r8 => shr_kind_r8
                                                                        
      implicit none
                                                                        
!-----------------------------------------------------------------------
!       ... Dummy args
!-----------------------------------------------------------------------
      real(r8), intent(in) ::   lu(:)
      real(r8), intent(inout) ::   b(:)
                                                                        
      call lu_slv01( lu, b )
      call lu_slv02( lu, b )
                                                                        
      end subroutine lu_slv
                                                                        
      end module mo_lu_solve
