\hypertarget{namespaceice__therm__vertical}{
\section{ice\_\-therm\_\-vertical Module Reference}
\label{namespaceice__therm__vertical}\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}}
}
\subsection*{Functions/Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a6a3853686daba96faa929c71f0a65cd6}{thermo\_\-vertical} (nx\_\-block, ny\_\-block, dt, icells, indxi, indxj, aicen, trcrn, vicen, vsnon, eicen, esnon, flw, potT, Qa, rhoa, fsnow, fbot, Tbot, lhcoef, shcoef, fswsfc, fswint, fswthrun, Sswabs, Iswabs, fsurfn, fcondtopn, fsensn, flatn, fswabsn, flwoutn, evapn, freshn, fsaltn, fhocnn, meltt, melts, meltb, congel, snoice, mlt\_\-onset, frz\_\-onset, yday, l\_\-stop, istop, jstop)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a1123b2b5ee24c8b82a26c5a831c88405}{init\_\-thermo\_\-vertical}
\item 
subroutine \hyperlink{namespaceice__therm__vertical_ae86ac5bb13d456664da2d8a1aae2f80c}{frzmlt\_\-bottom\_\-lateral} (nx\_\-block, ny\_\-block, ilo, ihi, jlo, jhi, dt, aice, frzmlt, eicen, esnon, sst, Tf, strocnxT, strocnyT, Tbot, fbot, rside)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a9e8915673a763c6533b1bf688775f02c}{init\_\-vertical\_\-profile} (nx\_\-block, ny\_\-block, my\_\-task, istep1, icells, indxi, indxj, aicen, vicen, vsnon, Tsfcn, eicen, esnon, hin, hilyr, hsn, hslyr, qin, Tin, qsn, Tsn, Tsf, einit, l\_\-stop, istop, jstop)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_afe7e9128dd994fd74827b779ddeaf789}{temperature\_\-changes} (nx\_\-block, ny\_\-block, my\_\-task, istep1, dt, icells, indxi, indxj, rhoa, flw, potT, Qa, shcoef, lhcoef, fswsfc, fswint, fswthrun, Sswabs, Iswabs, hilyr, hslyr, qin, Tin, qsn, Tsn, Tsf, Tbot, fsensn, flatn, fswabsn, flwoutn, fsurfn, fcondtopn, fcondbot, einit, l\_\-stop, istop, jstop)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_aeeb37e6f39ffa2d7269ac471d047a789}{conductivity} (nx\_\-block, ny\_\-block, l\_\-snow, icells, indxi, indxj, indxij, hilyr, hslyr, Tin, kh)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_aa2320460f9c52d821db02db2209fa888}{surface\_\-fluxes} (nx\_\-block, ny\_\-block, isolve, icells, indxii, indxjj, indxij, Tsf, fswsfc, rhoa, flw, potT, Qa, shcoef, lhcoef, flwoutn, fsensn, flatn, fsurfn, dflwout\_\-dT, dfsens\_\-dT, dflat\_\-dT, dfsurf\_\-dT)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a40c9d90a69710b5b555fd78ff83c3009}{get\_\-matrix\_\-elements\_\-calc\_\-Tsfc} (nx\_\-block, ny\_\-block, isolve, icells, indxii, indxjj, indxij, l\_\-snow, l\_\-cold, Tsf, Tbot, fsurfn, dfsurf\_\-dT, Tin\_\-init, Tsn\_\-init, kh, Sswabs, Iswabs, etai, etas, sbdiag, diag, spdiag, rhs)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_ad636d3bbc26f9737173a670b7c43bfec}{get\_\-matrix\_\-elements\_\-know\_\-Tsfc} (nx\_\-block, ny\_\-block, isolve, icells, indxii, indxjj, indxij, l\_\-snow, Tbot, Tin\_\-init, Tsn\_\-init, kh, Sswabs, Iswabs, etai, etas, sbdiag, diag, spdiag, rhs, fcondtopn)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_aa5780ef62e3f9b27790b7ba6c47116a0}{tridiag\_\-solver} (nx\_\-block, ny\_\-block, isolve, icells, indxii, indxjj, nmat, sbdiag, diag, spdiag, rhs, xout)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a862eb3ec0eaa2a5ae48961730e1ba7ce}{zerolayer\_\-temperature} (nx\_\-block, ny\_\-block, my\_\-task, istep1, dt, icells, indxi, indxj, rhoa, flw, potT, Qa, shcoef, lhcoef, fswsfc, fswthrun, hilyr, hslyr, Tsf, Tbot, fsensn, flatn, fswabsn, flwoutn, fsurfn, fcondtopn, fcondbot, l\_\-stop, istop, jstop)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_ad24b5fda2cb4af3cda6722209668aa77}{thickness\_\-changes} (nx\_\-block, ny\_\-block, dt, yday, icells, indxi, indxj, efinal, hin, hilyr, hsn, hslyr, qin, qsn, fbot, Tbot, flatn, fsurfn, fcondtopn, fcondbot, fsnow, hsn\_\-new, fhocnn, evapn, meltt, melts, meltb, iage, congel, snoice, mlt\_\-onset, frz\_\-onset)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_af560526921bc546f96377e533243089f}{freeboard} (nx\_\-block, ny\_\-block, icells, indxi, indxj, dt, snoice, iage, hin, hsn, qin, qsn, dzi, dzs)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a6845923f0ff5d01b9c66f9a41d0eb24d}{adjust\_\-enthalpy} (nx\_\-block, ny\_\-block, nlyr, icells, indxi, indxj, z1, z2, hlyr, hn, qn)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a4f2f790706910417fe9bbaaa1ad6efa3}{conservation\_\-check\_\-vthermo} (nx\_\-block, ny\_\-block, my\_\-task, istep1, dt, icells, indxi, indxj, fsurfn, flatn, fhocnn, fswint, fsnow, einit, efinal, l\_\-stop, istop, jstop)
\item 
subroutine \hyperlink{namespaceice__therm__vertical_a64f63f03c5a0e61472486ace19c6b9d5}{update\_\-state\_\-vthermo} (nx\_\-block, ny\_\-block, icells, indxi, indxj, Tf, Tsf, hin, hsn, qin, qsn, aicen, vicen, vsnon, Tsfcn, eicen, esnon)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
real(kind=dbl\_\-kind), parameter \hyperlink{namespaceice__therm__vertical_abca199468a09d7af2a96e7ceb456b8c4}{saltmax} = 3.2\_\-dbl\_\-kind
\item 
real(kind=dbl\_\-kind), parameter \hyperlink{namespaceice__therm__vertical_af7421836575fc4323bfe4b53fbc5f1ac}{hs\_\-min} = 1.e-\/4\_\-dbl\_\-kind
\item 
real(kind=dbl\_\-kind), parameter \hyperlink{namespaceice__therm__vertical_a5d1e969b838504de79a78a45daba6424}{betak} = 0.13\_\-dbl\_\-kind
\item 
real(kind=dbl\_\-kind), parameter \hyperlink{namespaceice__therm__vertical_ac9c4fb671c6d11d24a29369d6c7410fa}{kimin} = 0.10\_\-dbl\_\-kind
\item 
real(kind=dbl\_\-kind), dimension(nilyr+1) \hyperlink{namespaceice__therm__vertical_a484442c434b314140ae3763d41fc9075}{salin}
\item 
real(kind=dbl\_\-kind), dimension(nilyr+1) \hyperlink{namespaceice__therm__vertical_a25807d5de9fde0e10364d63e32691919}{Tmlt}
\item 
real(kind=dbl\_\-kind) \hyperlink{namespaceice__therm__vertical_a95faafaf9b21d14aa8dcf5fd91e50cac}{ustar\_\-scale}
\item 
real(kind=dbl\_\-kind), parameter \hyperlink{namespaceice__therm__vertical_a0721a294c629506af790049e6d607d53}{ferrmax} = 1.0e-\/3\_\-dbl\_\-kind
\item 
character(char\_\-len) \hyperlink{namespaceice__therm__vertical_a11814e124127a01f102f5b38e9ede650}{stoplabel}
\item 
logical(kind=log\_\-kind) \hyperlink{namespaceice__therm__vertical_aeb4df87d7011ce33c626c76f6a0dc063}{l\_\-brine}
\item 
logical(kind=log\_\-kind) \hyperlink{namespaceice__therm__vertical_a533694de6308b9a0b8839ba5dacc54af}{heat\_\-capacity}
\end{DoxyCompactItemize}


\subsection{Function/Subroutine Documentation}
\hypertarget{namespaceice__therm__vertical_a6845923f0ff5d01b9c66f9a41d0eb24d}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!adjust\_\-enthalpy@{adjust\_\-enthalpy}}
\index{adjust\_\-enthalpy@{adjust\_\-enthalpy}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{adjust\_\-enthalpy}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::adjust\_\-enthalpy (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em nlyr}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension (nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension (nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension (icells,nlyr+1),intent(in) {\em z1}, \/  real (kind=dbl\_\-kind),dimension (icells,nlyr+1),intent(in) {\em z2}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hlyr}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hn}, \/  real (kind=dbl\_\-kind),dimension (icells,nlyr),intent(inout) {\em qn})}}
\label{namespaceice__therm__vertical_a6845923f0ff5d01b9c66f9a41d0eb24d}


Definition at line 4283 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_aeeb37e6f39ffa2d7269ac471d047a789}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!conductivity@{conductivity}}
\index{conductivity@{conductivity}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{conductivity}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::conductivity (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  logical (kind=log\_\-kind),dimension(icells),intent(in) {\em l\_\-snow}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  integer (kind=int\_\-kind),dimension (icells),intent(in) {\em indxij}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hilyr}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hslyr}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(in) {\em Tin}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr+nslyr+1),intent(out) {\em kh})}}
\label{namespaceice__therm__vertical_aeeb37e6f39ffa2d7269ac471d047a789}


Definition at line 2084 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a4f2f790706910417fe9bbaaa1ad6efa3}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!conservation\_\-check\_\-vthermo@{conservation\_\-check\_\-vthermo}}
\index{conservation\_\-check\_\-vthermo@{conservation\_\-check\_\-vthermo}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{conservation\_\-check\_\-vthermo}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::conservation\_\-check\_\-vthermo (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em my\_\-task}, \/  integer (kind=int\_\-kind),intent(in) {\em istep1}, \/  real (kind=dbl\_\-kind),intent(in) {\em dt}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fsurfn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em flatn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fhocnn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fswint}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fsnow}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em einit}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em efinal}, \/  logical (kind=log\_\-kind),intent(inout) {\em l\_\-stop}, \/  integer (kind=int\_\-kind),intent(inout) {\em istop}, \/  integer (kind=int\_\-kind),intent(inout) {\em jstop})}}
\label{namespaceice__therm__vertical_a4f2f790706910417fe9bbaaa1ad6efa3}


Definition at line 4398 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_af560526921bc546f96377e533243089f}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!freeboard@{freeboard}}
\index{freeboard@{freeboard}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{freeboard}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::freeboard (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),intent(in) {\em dt}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em snoice}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em iage}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em hin}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em hsn}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(inout) {\em qin}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(in) {\em qsn}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(inout) {\em dzi}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(inout) {\em dzs})}}
\label{namespaceice__therm__vertical_af560526921bc546f96377e533243089f}


Definition at line 4131 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_ae86ac5bb13d456664da2d8a1aae2f80c}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!frzmlt\_\-bottom\_\-lateral@{frzmlt\_\-bottom\_\-lateral}}
\index{frzmlt\_\-bottom\_\-lateral@{frzmlt\_\-bottom\_\-lateral}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{frzmlt\_\-bottom\_\-lateral}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::frzmlt\_\-bottom\_\-lateral (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ilo}, \/  integer (kind=int\_\-kind),intent(in) {\em ihi}, \/  integer (kind=int\_\-kind),intent(in) {\em jlo}, \/  integer (kind=int\_\-kind),intent(in) {\em jhi}, \/  real (kind=dbl\_\-kind),intent(in) {\em dt}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(in) {\em aice}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(in) {\em frzmlt}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block,ntilyr),intent(in) {\em eicen}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block,ntslyr),intent(in) {\em esnon}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(in) {\em sst}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(in) {\em Tf}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(in) {\em strocnxT}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(in) {\em strocnyT}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(out) {\em Tbot}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(out) {\em fbot}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(out) {\em rside})}}
\label{namespaceice__therm__vertical_ae86ac5bb13d456664da2d8a1aae2f80c}


Definition at line 609 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a40c9d90a69710b5b555fd78ff83c3009}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!get\_\-matrix\_\-elements\_\-calc\_\-Tsfc@{get\_\-matrix\_\-elements\_\-calc\_\-Tsfc}}
\index{get\_\-matrix\_\-elements\_\-calc\_\-Tsfc@{get\_\-matrix\_\-elements\_\-calc\_\-Tsfc}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{get\_\-matrix\_\-elements\_\-calc\_\-Tsfc}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::get\_\-matrix\_\-elements\_\-calc\_\-Tsfc (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em isolve}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxii}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxjj}, \/  integer (kind=int\_\-kind),dimension (icells),intent(in) {\em indxij}, \/  logical (kind=log\_\-kind),dimension (icells),intent(in) {\em l\_\-snow}, \/  logical (kind=log\_\-kind),dimension (icells),intent(in) {\em l\_\-cold}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em Tsf}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Tbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fsurfn}, \/  real (kind=dbl\_\-kind),dimension (isolve),intent(in) {\em dfsurf\_\-dT}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(in) {\em Tin\_\-init}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(in) {\em Tsn\_\-init}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr+nilyr+1),intent(in) {\em kh}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nslyr),intent(in) {\em Sswabs}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nilyr),intent(in) {\em Iswabs}, \/  real (kind=dbl\_\-kind),dimension (isolve,nilyr),intent(in) {\em etai}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(in) {\em etas}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em sbdiag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em diag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em spdiag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em rhs})}}
\label{namespaceice__therm__vertical_a40c9d90a69710b5b555fd78ff83c3009}


Definition at line 2346 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_ad636d3bbc26f9737173a670b7c43bfec}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!get\_\-matrix\_\-elements\_\-know\_\-Tsfc@{get\_\-matrix\_\-elements\_\-know\_\-Tsfc}}
\index{get\_\-matrix\_\-elements\_\-know\_\-Tsfc@{get\_\-matrix\_\-elements\_\-know\_\-Tsfc}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{get\_\-matrix\_\-elements\_\-know\_\-Tsfc}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::get\_\-matrix\_\-elements\_\-know\_\-Tsfc (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em isolve}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxii}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxjj}, \/  integer (kind=int\_\-kind),dimension (icells),intent(in) {\em indxij}, \/  logical (kind=log\_\-kind),dimension (icells),intent(in) {\em l\_\-snow}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Tbot}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(in) {\em Tin\_\-init}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(in) {\em Tsn\_\-init}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr+nilyr+1),intent(in) {\em kh}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nslyr),intent(in) {\em Sswabs}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nilyr),intent(in) {\em Iswabs}, \/  real (kind=dbl\_\-kind),dimension (isolve,nilyr),intent(in) {\em etai}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(in) {\em etas}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em sbdiag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em diag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em spdiag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nslyr+nilyr+1),intent(inout) {\em rhs}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in),optional {\em fcondtopn})}}
\label{namespaceice__therm__vertical_ad636d3bbc26f9737173a670b7c43bfec}


Definition at line 2676 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a1123b2b5ee24c8b82a26c5a831c88405}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!init\_\-thermo\_\-vertical@{init\_\-thermo\_\-vertical}}
\index{init\_\-thermo\_\-vertical@{init\_\-thermo\_\-vertical}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{init\_\-thermo\_\-vertical}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::init\_\-thermo\_\-vertical ()}}
\label{namespaceice__therm__vertical_a1123b2b5ee24c8b82a26c5a831c88405}


Definition at line 536 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a9e8915673a763c6533b1bf688775f02c}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!init\_\-vertical\_\-profile@{init\_\-vertical\_\-profile}}
\index{init\_\-vertical\_\-profile@{init\_\-vertical\_\-profile}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{init\_\-vertical\_\-profile}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::init\_\-vertical\_\-profile (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em my\_\-task}, \/  integer (kind=int\_\-kind),intent(in) {\em istep1}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em aicen}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em vicen}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em vsnon}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Tsfcn}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block,nilyr),intent(in) {\em eicen}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block,nslyr),intent(in) {\em esnon}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(out) {\em hin}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(out) {\em hilyr}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(out) {\em hsn}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(out) {\em hslyr}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(out) {\em qin}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(out) {\em Tin}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(out) {\em qsn}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(out) {\em Tsn}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(out) {\em Tsf}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(out) {\em einit}, \/  logical (kind=log\_\-kind),intent(inout) {\em l\_\-stop}, \/  integer (kind=int\_\-kind),intent(inout) {\em istop}, \/  integer (kind=int\_\-kind),intent(inout) {\em jstop})}}
\label{namespaceice__therm__vertical_a9e8915673a763c6533b1bf688775f02c}


Definition at line 844 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_aa2320460f9c52d821db02db2209fa888}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!surface\_\-fluxes@{surface\_\-fluxes}}
\index{surface\_\-fluxes@{surface\_\-fluxes}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{surface\_\-fluxes}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::surface\_\-fluxes (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em isolve}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxii}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxjj}, \/  integer (kind=int\_\-kind),dimension (icells) {\em indxij}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em Tsf}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fswsfc}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em rhoa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em flw}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em potT}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Qa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em shcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em lhcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em flwoutn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fsensn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em flatn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fsurfn}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em dflwout\_\-dT}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em dfsens\_\-dT}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em dflat\_\-dT}, \/  real (kind=dbl\_\-kind),dimension (isolve),intent(inout) {\em dfsurf\_\-dT})}}
\label{namespaceice__therm__vertical_aa2320460f9c52d821db02db2209fa888}


Definition at line 2213 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_afe7e9128dd994fd74827b779ddeaf789}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!temperature\_\-changes@{temperature\_\-changes}}
\index{temperature\_\-changes@{temperature\_\-changes}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{temperature\_\-changes}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::temperature\_\-changes (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em my\_\-task}, \/  integer (kind=int\_\-kind),intent(in) {\em istep1}, \/  real (kind=dbl\_\-kind),intent(in) {\em dt}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em rhoa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em flw}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em potT}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Qa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em shcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em lhcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswsfc}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswint}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswthrun}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nslyr),intent(inout) {\em Sswabs}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nilyr),intent(inout) {\em Iswabs}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hilyr}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hslyr}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(inout) {\em qin}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(inout) {\em Tin}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(inout) {\em qsn}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(inout) {\em Tsn}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em Tsf}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Tbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fsensn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em flatn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswabsn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em flwoutn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fsurfn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fcondtopn}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(out) {\em fcondbot}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em einit}, \/  logical (kind=log\_\-kind),intent(inout) {\em l\_\-stop}, \/  integer (kind=int\_\-kind),intent(inout) {\em istop}, \/  integer (kind=int\_\-kind),intent(inout) {\em jstop})}}
\label{namespaceice__therm__vertical_afe7e9128dd994fd74827b779ddeaf789}


Definition at line 1243 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a6a3853686daba96faa929c71f0a65cd6}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!thermo\_\-vertical@{thermo\_\-vertical}}
\index{thermo\_\-vertical@{thermo\_\-vertical}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{thermo\_\-vertical}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::thermo\_\-vertical (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  real (kind=dbl\_\-kind),intent(in) {\em dt}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension (nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension (nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em aicen}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,ntrcr),intent(inout) {\em trcrn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em vicen}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em vsnon}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block,nilyr),intent(inout) {\em eicen}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block,nslyr),intent(inout) {\em esnon}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em flw}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em potT}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Qa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em rhoa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fsnow}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Tbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em lhcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em shcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswsfc}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswint}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswthrun}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nslyr),intent(inout) {\em Sswabs}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nilyr),intent(inout) {\em Iswabs}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fsurfn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fcondtopn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em fsensn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em flatn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em fswabsn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em flwoutn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em evapn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em freshn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em fsaltn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em fhocnn}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(inout) {\em meltt}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(inout) {\em melts}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(inout) {\em meltb}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(inout) {\em congel}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(inout) {\em snoice}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(inout) {\em mlt\_\-onset}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(inout) {\em frz\_\-onset}, \/  real (kind=dbl\_\-kind),intent(in) {\em yday}, \/  logical (kind=log\_\-kind),intent(out) {\em l\_\-stop}, \/  integer (kind=int\_\-kind),intent(out) {\em istop}, \/  integer (kind=int\_\-kind),intent(out) {\em jstop})}}
\label{namespaceice__therm__vertical_a6a3853686daba96faa929c71f0a65cd6}


Definition at line 98 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_ad24b5fda2cb4af3cda6722209668aa77}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!thickness\_\-changes@{thickness\_\-changes}}
\index{thickness\_\-changes@{thickness\_\-changes}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{thickness\_\-changes}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::thickness\_\-changes (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  real (kind=dbl\_\-kind),intent(in) {\em dt}, \/  real (kind=dbl\_\-kind),intent(in) {\em yday}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(out) {\em efinal}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em hin}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em hilyr}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em hsn}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em hslyr}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(inout) {\em qin}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(inout) {\em qsn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Tbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em flatn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fsurfn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fcondtopn}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em fcondbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fsnow}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(out) {\em hsn\_\-new}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em fhocnn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(out) {\em evapn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em meltt}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em melts}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em meltb}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em iage}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em congel}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em snoice}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em mlt\_\-onset}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em frz\_\-onset})}}
\label{namespaceice__therm__vertical_ad24b5fda2cb4af3cda6722209668aa77}


Definition at line 3521 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_aa5780ef62e3f9b27790b7ba6c47116a0}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!tridiag\_\-solver@{tridiag\_\-solver}}
\index{tridiag\_\-solver@{tridiag\_\-solver}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{tridiag\_\-solver}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::tridiag\_\-solver (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em isolve}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxii}, \/  integer (kind=int\_\-kind),dimension(icells),intent(in) {\em indxjj}, \/  integer (kind=int\_\-kind),intent(in) {\em nmat}, \/  real (kind=dbl\_\-kind),dimension (isolve,nmat),intent(in) {\em sbdiag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nmat),intent(in) {\em diag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nmat),intent(in) {\em spdiag}, \/  real (kind=dbl\_\-kind),dimension (isolve,nmat),intent(in) {\em rhs}, \/  real (kind=dbl\_\-kind),dimension (isolve,nmat),intent(inout) {\em xout})}}
\label{namespaceice__therm__vertical_aa5780ef62e3f9b27790b7ba6c47116a0}


Definition at line 2968 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a64f63f03c5a0e61472486ace19c6b9d5}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!update\_\-state\_\-vthermo@{update\_\-state\_\-vthermo}}
\index{update\_\-state\_\-vthermo@{update\_\-state\_\-vthermo}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{update\_\-state\_\-vthermo}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::update\_\-state\_\-vthermo (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension(nx\_\-block,ny\_\-block),intent(in) {\em Tf}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(in) {\em Tsf}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(in) {\em hin}, \/  real (kind=dbl\_\-kind),dimension(icells),intent(in) {\em hsn}, \/  real (kind=dbl\_\-kind),dimension (icells,nilyr),intent(in) {\em qin}, \/  real (kind=dbl\_\-kind),dimension (icells,nslyr),intent(in) {\em qsn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em aicen}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em vicen}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em vsnon}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em Tsfcn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nilyr),intent(inout) {\em eicen}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block,nslyr),intent(inout) {\em esnon})}}
\label{namespaceice__therm__vertical_a64f63f03c5a0e61472486ace19c6b9d5}


Definition at line 4518 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a862eb3ec0eaa2a5ae48961730e1ba7ce}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!zerolayer\_\-temperature@{zerolayer\_\-temperature}}
\index{zerolayer\_\-temperature@{zerolayer\_\-temperature}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{zerolayer\_\-temperature}]{\setlength{\rightskip}{0pt plus 5cm}subroutine ice\_\-therm\_\-vertical::zerolayer\_\-temperature (integer (kind=int\_\-kind),intent(in) {\em nx\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em ny\_\-block}, \/  integer (kind=int\_\-kind),intent(in) {\em my\_\-task}, \/  integer (kind=int\_\-kind),intent(in) {\em istep1}, \/  real (kind=dbl\_\-kind),intent(in) {\em dt}, \/  integer (kind=int\_\-kind),intent(in) {\em icells}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxi}, \/  integer (kind=int\_\-kind),dimension(nx\_\-block$\ast$ny\_\-block),intent(in) {\em indxj}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em rhoa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em flw}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em potT}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Qa}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em shcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em lhcoef}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fswsfc}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em fswthrun}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hilyr}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(in) {\em hslyr}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(inout) {\em Tsf}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(in) {\em Tbot}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fsensn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em flatn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fswabsn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em flwoutn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fsurfn}, \/  real (kind=dbl\_\-kind),dimension (nx\_\-block,ny\_\-block),intent(inout) {\em fcondtopn}, \/  real (kind=dbl\_\-kind),dimension (icells),intent(out) {\em fcondbot}, \/  logical (kind=log\_\-kind),intent(inout) {\em l\_\-stop}, \/  integer (kind=int\_\-kind),intent(inout) {\em istop}, \/  integer (kind=int\_\-kind),intent(inout) {\em jstop})}}
\label{namespaceice__therm__vertical_a862eb3ec0eaa2a5ae48961730e1ba7ce}


Definition at line 3067 of file ice\_\-therm\_\-vertical.F90.

\subsection{Variable Documentation}
\hypertarget{namespaceice__therm__vertical_a5d1e969b838504de79a78a45daba6424}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!betak@{betak}}
\index{betak@{betak}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{betak}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind),parameter {\bf ice\_\-therm\_\-vertical::betak} = 0.13\_\-dbl\_\-kind}}
\label{namespaceice__therm__vertical_a5d1e969b838504de79a78a45daba6424}


Definition at line 45 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a0721a294c629506af790049e6d607d53}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!ferrmax@{ferrmax}}
\index{ferrmax@{ferrmax}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{ferrmax}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind),parameter {\bf ice\_\-therm\_\-vertical::ferrmax} = 1.0e-\/3\_\-dbl\_\-kind}}
\label{namespaceice__therm__vertical_a0721a294c629506af790049e6d607d53}


Definition at line 59 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a533694de6308b9a0b8839ba5dacc54af}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!heat\_\-capacity@{heat\_\-capacity}}
\index{heat\_\-capacity@{heat\_\-capacity}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{heat\_\-capacity}]{\setlength{\rightskip}{0pt plus 5cm}logical (kind=log\_\-kind) {\bf ice\_\-therm\_\-vertical::heat\_\-capacity}}}
\label{namespaceice__therm__vertical_a533694de6308b9a0b8839ba5dacc54af}


Definition at line 68 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_af7421836575fc4323bfe4b53fbc5f1ac}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!hs\_\-min@{hs\_\-min}}
\index{hs\_\-min@{hs\_\-min}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{hs\_\-min}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind),parameter {\bf ice\_\-therm\_\-vertical::hs\_\-min} = 1.e-\/4\_\-dbl\_\-kind}}
\label{namespaceice__therm__vertical_af7421836575fc4323bfe4b53fbc5f1ac}


Definition at line 45 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_ac9c4fb671c6d11d24a29369d6c7410fa}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!kimin@{kimin}}
\index{kimin@{kimin}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{kimin}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind),parameter {\bf ice\_\-therm\_\-vertical::kimin} = 0.10\_\-dbl\_\-kind}}
\label{namespaceice__therm__vertical_ac9c4fb671c6d11d24a29369d6c7410fa}


Definition at line 45 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_aeb4df87d7011ce33c626c76f6a0dc063}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!l\_\-brine@{l\_\-brine}}
\index{l\_\-brine@{l\_\-brine}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{l\_\-brine}]{\setlength{\rightskip}{0pt plus 5cm}logical (kind=log\_\-kind) {\bf ice\_\-therm\_\-vertical::l\_\-brine}}}
\label{namespaceice__therm__vertical_aeb4df87d7011ce33c626c76f6a0dc063}


Definition at line 65 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a484442c434b314140ae3763d41fc9075}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!salin@{salin}}
\index{salin@{salin}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{salin}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind),dimension(nilyr+1) {\bf ice\_\-therm\_\-vertical::salin}}}
\label{namespaceice__therm__vertical_a484442c434b314140ae3763d41fc9075}


Definition at line 51 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_abca199468a09d7af2a96e7ceb456b8c4}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!saltmax@{saltmax}}
\index{saltmax@{saltmax}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{saltmax}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind),parameter {\bf ice\_\-therm\_\-vertical::saltmax} = 3.2\_\-dbl\_\-kind}}
\label{namespaceice__therm__vertical_abca199468a09d7af2a96e7ceb456b8c4}


Definition at line 45 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a11814e124127a01f102f5b38e9ede650}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!stoplabel@{stoplabel}}
\index{stoplabel@{stoplabel}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{stoplabel}]{\setlength{\rightskip}{0pt plus 5cm}character (char\_\-len) {\bf ice\_\-therm\_\-vertical::stoplabel}}}
\label{namespaceice__therm__vertical_a11814e124127a01f102f5b38e9ede650}


Definition at line 63 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a25807d5de9fde0e10364d63e32691919}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!Tmlt@{Tmlt}}
\index{Tmlt@{Tmlt}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{Tmlt}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind),dimension(nilyr+1) {\bf ice\_\-therm\_\-vertical::Tmlt}}}
\label{namespaceice__therm__vertical_a25807d5de9fde0e10364d63e32691919}


Definition at line 51 of file ice\_\-therm\_\-vertical.F90.\hypertarget{namespaceice__therm__vertical_a95faafaf9b21d14aa8dcf5fd91e50cac}{
\index{ice\_\-therm\_\-vertical@{ice\_\-therm\_\-vertical}!ustar\_\-scale@{ustar\_\-scale}}
\index{ustar\_\-scale@{ustar\_\-scale}!ice_therm_vertical@{ice\_\-therm\_\-vertical}}
\subsubsection[{ustar\_\-scale}]{\setlength{\rightskip}{0pt plus 5cm}real (kind=dbl\_\-kind) {\bf ice\_\-therm\_\-vertical::ustar\_\-scale}}}
\label{namespaceice__therm__vertical_a95faafaf9b21d14aa8dcf5fd91e50cac}


Definition at line 56 of file ice\_\-therm\_\-vertical.F90.