<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CICE: ice_history.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Types&nbsp;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>ice_history.F90</h1><a href="ice__history_8F90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">!=======================================================================</span>
<a name="l00002"></a>00002 <span class="comment">!</span>
<a name="l00003"></a>00003 <span class="comment">!BOP</span>
<a name="l00004"></a>00004 <span class="comment">!</span>
<a name="l00005"></a>00005 <span class="comment">! !MODULE: ice_history - ice model history files</span>
<a name="l00006"></a>00006 <span class="comment">!</span>
<a name="l00007"></a>00007 <span class="comment">! Output files: netCDF or binary data, Fortran unformatted dumps</span>
<a name="l00008"></a>00008 <span class="comment">!</span>
<a name="l00009"></a>00009 <span class="comment">! The following variables are currently hard-wired as snapshots </span>
<a name="l00010"></a>00010 <span class="comment">!   (instantaneous rather than time-averages):</span>
<a name="l00011"></a>00011 <span class="comment">!   divu, shear, sig1, sig2, trsig, mlt_onset, frz_onset, hisnap, aisnap</span>
<a name="l00012"></a>00012 <span class="comment">!</span>
<a name="l00013"></a>00013 <span class="comment">! Options for histfreq: &apos;1&apos;,&apos;h&apos;,&apos;d&apos;,&apos;m&apos;,&apos;y&apos;,&apos;x&apos;, where x means that</span>
<a name="l00014"></a>00014 <span class="comment">!   output stream will not be used (recommended for efficiency).  </span>
<a name="l00015"></a>00015 <span class="comment">! histfreq_n can be any nonnegative integer, where 0 means that the </span>
<a name="l00016"></a>00016 <span class="comment">!   corresponding histfreq frequency will not be used.</span>
<a name="l00017"></a>00017 <span class="comment">! The flags (f_&lt;field&gt;) can be set to &apos;1&apos;,&apos;h&apos;,&apos;d&apos;,&apos;m&apos;,&apos;y&apos; or &apos;x&apos;, where</span>
<a name="l00018"></a>00018 <span class="comment">!   n means the field will not be written.  To output the same field at</span>
<a name="l00019"></a>00019 <span class="comment">!   more than one frequency, for instance monthy and daily, set </span>
<a name="l00020"></a>00020 <span class="comment">!   f_&lt;field&gt; = &apos;md&apos;.</span>
<a name="l00021"></a>00021 <span class="comment">!</span>
<a name="l00022"></a>00022 <span class="comment">!</span>
<a name="l00023"></a>00023 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00024"></a>00024 <span class="comment">!  SVN:$Id: ice_history.F90 61 2007-04-25 17:50:16Z dbailey $</span>
<a name="l00025"></a>00025 <span class="comment">!</span>
<a name="l00026"></a>00026 <span class="comment">! authors Tony Craig and Bruce Briegleb, NCAR</span>
<a name="l00027"></a>00027 <span class="comment">!         Elizabeth C. Hunke and William H. Lipscomb, LANL</span>
<a name="l00028"></a>00028 <span class="comment">!         C. M. Bitz, UW</span>
<a name="l00029"></a>00029 <span class="comment">!</span>
<a name="l00030"></a>00030 <span class="comment">! 2004 WHL: Block structure added </span>
<a name="l00031"></a>00031 <span class="comment">! 2006 ECH: Accepted some CCSM code into mainstream CICE</span>
<a name="l00032"></a>00032 <span class="comment">!           Added ice_present, aicen, vicen; removed aice1...10, vice1...1.</span>
<a name="l00033"></a>00033 <span class="comment">!           Added histfreq_n and histfreq=&apos;h&apos; options, removed histfreq=&apos;w&apos;</span>
<a name="l00034"></a>00034 <span class="comment">!           Converted to free source form (F90)</span>
<a name="l00035"></a>00035 <span class="comment">!           Added option for binary output instead of netCDF</span>
<a name="l00036"></a>00036 <span class="comment">! 2009 D Bailey and ECH: Generalized for multiple frequency output</span>
<a name="l00037"></a>00037 <span class="comment">!</span>
<a name="l00038"></a>00038 <span class="comment">! !INTERFACE:</span>
<a name="l00039"></a>00039 <span class="comment">!</span>
<a name="l00040"></a><a class="code" href="namespaceice__history.html">00040</a>       <span class="keyword">module</span> ice_history
<a name="l00041"></a>00041 <span class="comment">!</span>
<a name="l00042"></a>00042 <span class="comment">! !USES:</span>
<a name="l00043"></a>00043 <span class="comment">!</span>
<a name="l00044"></a>00044       use <span class="keywordflow">ice_kinds_mod</span>
<a name="l00045"></a>00045       use <span class="keywordflow">ice_broadcast</span>
<a name="l00046"></a>00046       use <span class="keywordflow">ice_communicate</span>, only: my_task, master_task
<a name="l00047"></a>00047       use <span class="keywordflow">ice_blocks</span>
<a name="l00048"></a>00048       use <span class="keywordflow">ice_grid</span>
<a name="l00049"></a>00049       use <span class="keywordflow">ice_read_write</span>
<a name="l00050"></a>00050       use <span class="keywordflow">ice_fileunits</span>
<a name="l00051"></a>00051       use <span class="keywordflow">ice_history_fields</span>
<a name="l00052"></a>00052       use <span class="keywordflow">ice_history_write</span>
<a name="l00053"></a>00053 <span class="comment">!</span>
<a name="l00054"></a>00054 <span class="comment">!EOP</span>
<a name="l00055"></a>00055 <span class="comment">!</span>
<a name="l00056"></a>00056       <span class="keyword">implicit none</span>
<a name="l00057"></a>00057       <span class="keywordtype">save</span>
<a name="l00058"></a>00058       
<a name="l00059"></a><a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">00059</a>       <span class="keywordtype">character (len=16) </span>:: vname_in     <span class="comment">! variable name</span>
<a name="l00060"></a><a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">00060</a>       <span class="keywordtype">character (len=55) </span>:: vdesc_in     <span class="comment">! variable description</span>
<a name="l00061"></a><a class="code" href="namespaceice__history.html#ab6f7ee9f2623bb2e08b57018462544df">00061</a>       <span class="keywordtype">character (len=55) </span>:: vcomment_in  <span class="comment">! variable description</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063       <span class="comment">!---------------------------------------------------------------</span>
<a name="l00064"></a>00064       <span class="comment">! primary info for the history file</span>
<a name="l00065"></a>00065       <span class="comment">!---------------------------------------------------------------</span>
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">00067</a>       <span class="keywordtype">character (len=16)</span>, <span class="keywordtype">parameter</span> :: 
<a name="l00068"></a>00068          tstr  = <span class="stringliteral">&apos;TLON TLAT time&apos;</span>,  <span class="comment">! vcoord for T cell quantities</span>
<a name="l00069"></a>00069          ustr  = <span class="stringliteral">&apos;ULON ULAT time&apos;</span>,  <span class="comment">! vcoord for U cell quantities</span>
<a name="l00070"></a>00070          tcstr = <span class="stringliteral">&apos;area: tarea&apos;</span>   ,  <span class="comment">! vcellmeas for T cell quantities</span>
<a name="l00071"></a>00071          ucstr = <span class="stringliteral">&apos;area: uarea&apos;</span>       <span class="comment">! vcellmeas for U cell quantities</span>
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">00073</a>       <span class="keywordtype">real (kind=dbl_kind) </span>:: 
<a name="l00074"></a>00074          avgct(max_nstrm)            <span class="comment">! average sample counter</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076       <span class="comment">!---------------------------------------------------------------</span>
<a name="l00077"></a>00077       <span class="comment">! logical flags: write to output file if true</span>
<a name="l00078"></a>00078       <span class="comment">!---------------------------------------------------------------</span>
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="namespaceice__history.html#ac39fd46be06edb447fb96f16103e4d96">00080</a>        <span class="keywordtype">logical (kind=log_kind) </span>:: 
<a name="l00081"></a>00081            f_tmask     = .true., 
<a name="l00082"></a>00082            f_tarea     = .true., f_uarea      = .true., 
<a name="l00083"></a>00083            f_dxt       = .true., f_dyt        = .true., 
<a name="l00084"></a>00084            f_dxu       = .true., f_dyu        = .true., 
<a name="l00085"></a>00085            f_HTN       = .true., f_HTE        = .true., 
<a name="l00086"></a>00086            f_ANGLE     = .true., f_ANGLET     = .true.
<a name="l00087"></a>00087 
<a name="l00088"></a>00088       <span class="keywordtype">character (len=max_nstrm) </span>:: 
<a name="l00089"></a>00089 <span class="comment">!          f_example   = &apos;mdxxx&apos;, &amp;</span>
<a name="l00090"></a>00090            f_hi        = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_hs         = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00091"></a>00091            f_fs        = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00092"></a>00092            f_Tsfc      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_aice       = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00093"></a>00093            f_uvel      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_vvel       = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00094"></a>00094            f_transix   = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_transiy    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00095"></a>00095            f_fswdn     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fswup      = <span class="stringliteral">&apos;mxxxx&apos;</span>,  &amp;
<a name="l00096"></a>00096            f_flwdn     = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00097"></a>00097            f_snow      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_snow_ai    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00098"></a>00098            f_rain      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_rain_ai    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00099"></a>00099            f_faero_atm = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_faero_ocn  = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00100"></a>00100            f_sst       = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_sss        = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00101"></a>00101            f_uocn      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_vocn       = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00102"></a>00102            f_frzmlt    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00103"></a>00103            f_fswfac    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00104"></a>00104            f_fswabs    = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fswabs_ai  = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00105"></a>00105            f_alvdr     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_alidr      = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00106"></a>00106            f_albice    = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_albsno     = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00107"></a>00107            f_albpnd    = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_coszen     = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00108"></a>00108            f_flat      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_flat_ai    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00109"></a>00109            f_fsens     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fsens_ai   = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00110"></a>00110            f_flwup     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_flwup_ai   = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00111"></a>00111            f_evap      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_evap_ai    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00112"></a>00112            f_qi        = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_qs         = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00113"></a>00113            f_Tair      = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00114"></a>00114            f_Tref      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_Qref       = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00115"></a>00115            f_congel    = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_frazil     = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00116"></a>00116            f_snoice    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00117"></a>00117            f_meltt     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_melts      = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00118"></a>00118            f_meltb     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_meltl      = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00119"></a>00119            f_fresh     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fresh_ai   = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00120"></a>00120            f_fsalt     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fsalt_ai   = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00121"></a>00121            f_fhocn     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fhocn_ai   = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00122"></a>00122            f_fswthru   = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fswthru_ai = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00123"></a>00123            f_strairx   = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_strairy    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00124"></a>00124            f_strtltx   = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_strtlty    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00125"></a>00125            f_strcorx   = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_strcory    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00126"></a>00126            f_strocnx   = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_strocny    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00127"></a>00127            f_strintx   = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_strinty    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00128"></a>00128            f_strength  = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_opening    = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00129"></a>00129            f_divu      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_shear      = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00130"></a>00130            f_sig1      = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_sig2       = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00131"></a>00131            f_dvidtt    = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_dvidtd     = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00132"></a>00132            f_daidtt    = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_daidtd     = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00133"></a>00133            f_mlt_onset = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_frz_onset  = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00134"></a>00134            f_dardg1dt  = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_dardg2dt   = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00135"></a>00135            f_dvirdgdt  = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_iage       = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00136"></a>00136            f_FY        = <span class="stringliteral">&apos;mxxxx&apos;</span>,                     &amp;
<a name="l00137"></a>00137            f_aeron     = <span class="stringliteral">&apos;xxxxx&apos;</span>, f_aero       = <span class="stringliteral">&apos;xxxxx&apos;</span>, &amp;
<a name="l00138"></a>00138            f_apond     = <span class="stringliteral">&apos;xxxxx&apos;</span>, f_apondn     = <span class="stringliteral">&apos;xxxxx&apos;</span>, &amp;
<a name="l00139"></a>00139            f_hisnap    = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_aisnap     = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00140"></a>00140            f_aicen     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_vicen      = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00141"></a>00141            f_trsig     = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_icepresent = <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00142"></a>00142            f_fsurf_ai  = <span class="stringliteral">&apos;mxxxx&apos;</span>, f_fcondtop_ai= <span class="stringliteral">&apos;mxxxx&apos;</span>, &amp;
<a name="l00143"></a>00143            f_fmeltt_ai = <span class="stringliteral">&apos;xxxxx&apos;</span>,                     &amp;
<a name="l00144"></a>00144            f_fsurfn_ai = <span class="stringliteral">&apos;xxxxx&apos;</span>,f_fcondtopn_ai= <span class="stringliteral">&apos;xxxxx&apos;</span>, &amp;
<a name="l00145"></a>00145            f_fmelttn_ai= <span class="stringliteral">&apos;xxxxx&apos;</span>, f_flatn_ai   = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00146"></a>00146 
<a name="l00147"></a>00147       <span class="comment">!---------------------------------------------------------------</span>
<a name="l00148"></a>00148       <span class="comment">! namelist variables </span>
<a name="l00149"></a>00149       <span class="comment">!---------------------------------------------------------------</span>
<a name="l00150"></a>00150 
<a name="l00151"></a>00151       namelist / icefields_nml /     &amp;
<a name="l00152"></a>00152            <a class="code" href="namespaceice__history.html#ac6635a8bcde54a554d4b60c7c6566b26">f_tmask</a>    , &amp;
<a name="l00153"></a>00153            <a class="code" href="namespaceice__history.html#a7b8cc0a9e56bbe22f0015aa2062953d0">f_tarea</a>    , <a class="code" href="namespaceice__history.html#ac39fd46be06edb447fb96f16103e4d96">f_uarea</a>    , &amp;
<a name="l00154"></a>00154            <a class="code" href="namespaceice__history.html#a6effc6ebe9b5dc7d958341622f11530c">f_dxt</a>      , <a class="code" href="namespaceice__history.html#a7976eedce7471cfcf14fe54b09e5e2a0">f_dyt</a>      , &amp;
<a name="l00155"></a>00155            <a class="code" href="namespaceice__history.html#ac2cca9bb022f44a98a6cff9a59cd19e3">f_dxu</a>      , <a class="code" href="namespaceice__history.html#a5fe48a0bc8e7dcdbe8689feadd8cdd70">f_dyu</a>      , &amp;
<a name="l00156"></a>00156            <a class="code" href="namespaceice__history.html#a7e63313bc71fed15ff1d16cbaf4d74ea">f_HTN</a>      , <a class="code" href="namespaceice__history.html#ac61273f25f1bb3b60c8cc5c55c8fd490">f_HTE</a>      , &amp;
<a name="l00157"></a>00157            <a class="code" href="namespaceice__history.html#ae355872badcbed142dd282929330dae7">f_ANGLE</a>    , <a class="code" href="namespaceice__history.html#a31c241b97efeccd9b191577aa4bf3b4a">f_ANGLET</a>   , &amp;
<a name="l00158"></a>00158            <a class="code" href="namespaceice__history__fields.html#a2f3cd20e9232a9ef13482e90435469dc">f_bounds</a>   , &amp;
<a name="l00159"></a>00159 <span class="comment">!</span>
<a name="l00160"></a>00160 <span class="comment">!          f_example               , &amp;</span>
<a name="l00161"></a>00161            f_hi,        f_hs       , &amp;
<a name="l00162"></a>00162            f_fs,                     &amp;
<a name="l00163"></a>00163            f_Tsfc,      f_aice     , &amp;
<a name="l00164"></a>00164            f_uvel,      f_vvel     , &amp;
<a name="l00165"></a>00165            f_transix,   f_transiy  , &amp;
<a name="l00166"></a>00166            f_fswdn,     f_fswup    , &amp;
<a name="l00167"></a>00167            f_flwdn,                  &amp;
<a name="l00168"></a>00168            f_snow,      f_snow_ai  , &amp;     
<a name="l00169"></a>00169            f_rain,      f_rain_ai  , &amp;
<a name="l00170"></a>00170            f_faero_atm, f_faero_ocn, &amp;
<a name="l00171"></a>00171            f_sst,       f_sss      , &amp;
<a name="l00172"></a>00172            f_uocn,      f_vocn     , &amp;
<a name="l00173"></a>00173            f_frzmlt                , &amp;
<a name="l00174"></a>00174            f_fswfac                , &amp;
<a name="l00175"></a>00175            f_fswabs,    f_fswabs_ai, &amp;
<a name="l00176"></a>00176            f_alvdr,     f_alidr    , &amp;
<a name="l00177"></a>00177            f_albice,    f_albsno   , &amp;
<a name="l00178"></a>00178            f_albpnd,    f_coszen   , &amp;
<a name="l00179"></a>00179            f_flat,      f_flat_ai  , &amp;
<a name="l00180"></a>00180            f_fsens,     f_fsens_ai , &amp;
<a name="l00181"></a>00181            f_flwup,     f_flwup_ai , &amp;
<a name="l00182"></a>00182            f_evap,      f_evap_ai  , &amp;
<a name="l00183"></a>00183            f_qi,        f_qs       , &amp;
<a name="l00184"></a>00184            f_Tair                  , &amp;
<a name="l00185"></a>00185            f_Tref,      f_Qref     , &amp;
<a name="l00186"></a>00186            f_congel,    f_frazil   , &amp;
<a name="l00187"></a>00187            f_snoice,                 &amp; 
<a name="l00188"></a>00188            f_meltt,     f_melts    , &amp;
<a name="l00189"></a>00189            f_meltb,     f_meltl    , &amp;
<a name="l00190"></a>00190            f_fresh,     f_fresh_ai , &amp;  
<a name="l00191"></a>00191            f_fsalt,     f_fsalt_ai , &amp;
<a name="l00192"></a>00192            f_fhocn,     f_fhocn_ai , &amp;
<a name="l00193"></a>00193            f_fswthru,   f_fswthru_ai,&amp;
<a name="l00194"></a>00194            f_strairx,   f_strairy  , &amp;
<a name="l00195"></a>00195            f_strtltx,   f_strtlty  , &amp;
<a name="l00196"></a>00196            f_strcorx,   f_strcory  , &amp;
<a name="l00197"></a>00197            f_strocnx,   f_strocny  , &amp;
<a name="l00198"></a>00198            f_strintx,   f_strinty  , &amp;
<a name="l00199"></a>00199            f_strength,  f_opening  , &amp;
<a name="l00200"></a>00200            f_divu,      f_shear    , &amp;
<a name="l00201"></a>00201            f_sig1,      f_sig2     , &amp;
<a name="l00202"></a>00202            f_dvidtt,    f_dvidtd   , &amp;
<a name="l00203"></a>00203            f_daidtt,    f_daidtd   , &amp;
<a name="l00204"></a>00204            f_mlt_onset, f_frz_onset, &amp;
<a name="l00205"></a>00205            f_dardg1dt,  f_dardg2dt , &amp;
<a name="l00206"></a>00206            f_dvirdgdt              , &amp;
<a name="l00207"></a>00207            f_hisnap,    f_aisnap   , &amp;
<a name="l00208"></a>00208            f_aicen,     f_vicen    , &amp;
<a name="l00209"></a>00209            f_aeron,     f_aero     , &amp;
<a name="l00210"></a>00210            f_iage                  , &amp;
<a name="l00211"></a>00211            f_FY                    , &amp;
<a name="l00212"></a>00212            f_apond,     f_apondn   , &amp;
<a name="l00213"></a>00213            f_trsig,     f_icepresent,&amp;
<a name="l00214"></a>00214            f_fsurf_ai,  f_fcondtop_ai,&amp;
<a name="l00215"></a>00215            f_fmeltt_ai,              &amp;
<a name="l00216"></a>00216            f_fsurfn_ai,f_fcondtopn_ai,&amp;
<a name="l00217"></a>00217            f_fmelttn_ai,f_flatn_ai
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <span class="comment">!=======================================================================</span>
<a name="l00220"></a>00220 
<a name="l00221"></a>00221       <span class="keyword">contains</span>
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="comment">!=======================================================================</span>
<a name="l00224"></a>00224 <span class="comment">!</span>
<a name="l00225"></a>00225 <span class="comment">!BOP</span>
<a name="l00226"></a>00226 <span class="comment">!</span>
<a name="l00227"></a>00227 <span class="comment">! !IROUTINE: init_hist - initialize history files</span>
<a name="l00228"></a>00228 <span class="comment">!</span>
<a name="l00229"></a>00229 <span class="comment">! !INTERFACE:</span>
<a name="l00230"></a>00230 <span class="comment">!</span>
<a name="l00231"></a><a class="code" href="namespaceice__history.html#a99fbe7f0b61b42e909dad8bfff950536">00231</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__history.html#a99fbe7f0b61b42e909dad8bfff950536">init_hist</a> (dt)
<a name="l00232"></a>00232 <span class="comment">!</span>
<a name="l00233"></a>00233 <span class="comment">! !DESCRIPTION:</span>
<a name="l00234"></a>00234 <span class="comment">!</span>
<a name="l00235"></a>00235 <span class="comment">! Initialize history files</span>
<a name="l00236"></a>00236 <span class="comment">!</span>
<a name="l00237"></a>00237 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00238"></a>00238 <span class="comment">!</span>
<a name="l00239"></a>00239 <span class="comment">! authors Tony Craig, NCAR</span>
<a name="l00240"></a>00240 <span class="comment">!         Elizabeth C. Hunke, LANL</span>
<a name="l00241"></a>00241 <span class="comment">!         C.M. Bitz, UW</span>
<a name="l00242"></a>00242 <span class="comment">!         Bruce P. Briegleb, NCAR</span>
<a name="l00243"></a>00243 <span class="comment">!         William H. Lipscomb, LANL</span>
<a name="l00244"></a>00244 <span class="comment">!</span>
<a name="l00245"></a>00245 <span class="comment">! !USES:</span>
<a name="l00246"></a>00246 <span class="comment">!</span>
<a name="l00247"></a>00247       use <span class="keywordflow">ice_constants</span>
<a name="l00248"></a>00248       use <span class="keywordflow">ice_calendar</span>, only: yday, days_per_year, histfreq, &amp;
<a name="l00249"></a>00249                               histfreq_n, nstreams
<a name="l00250"></a>00250       use <span class="keywordflow">ice_flux</span>, only: mlt_onset, frz_onset
<a name="l00251"></a>00251       use <span class="keywordflow">ice_restart</span>, only: restart
<a name="l00252"></a>00252       use <span class="keywordflow">ice_state</span>, only: tr_aero, tr_iage, tr_FY, tr_pond
<a name="l00253"></a>00253       use <span class="keywordflow">ice_exit</span>
<a name="l00254"></a>00254 <span class="comment">!</span>
<a name="l00255"></a>00255 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00256"></a>00256 <span class="comment">!</span>
<a name="l00257"></a>00257       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l00258"></a>00258          dt      <span class="comment">! time step</span>
<a name="l00259"></a>00259 <span class="comment">!</span>
<a name="l00260"></a>00260 <span class="comment">!EOP</span>
<a name="l00261"></a>00261 <span class="comment">!</span>
<a name="l00262"></a>00262       <span class="keywordtype">integer (kind=int_kind) </span>:: n, k, ns, ns1, ns2, lenf
<a name="l00263"></a>00263       <span class="keywordtype">integer (kind=int_kind) </span>:: hfreqn
<a name="l00264"></a>00264       <span class="keywordtype">integer (kind=int_kind)</span>, <span class="keywordtype">dimension(max_nstrm) </span>:: 
<a name="l00265"></a>00265          ntmp
<a name="l00266"></a>00266       <span class="keywordtype">integer (kind=int_kind) </span>:: nml_error <span class="comment">! namelist i/o error flag</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268       <span class="keywordtype">character (len=3) </span>:: nchar
<a name="l00269"></a>00269       <span class="keywordtype">character (len=40) </span>:: stmp
<a name="l00270"></a>00270 
<a name="l00271"></a>00271       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00272"></a>00272       <span class="comment">! read namelist</span>
<a name="l00273"></a>00273       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00274"></a>00274 
<a name="l00275"></a>00275       call <a class="code" href="namespaceice__fileunits.html#ad6283e44cc881fd1d0d6250cbb83a2e2">get_fileunit</a>(<a class="code" href="namespaceice__fileunits.html#a1c0f914707e7a61a579be21df178f061">nu_nml</a>)
<a name="l00276"></a>00276       <span class="keyword">if</span> (<a class="code" href="namespaceice__communicate.html#a70e729e746e2e5ec592ccba505136002">my_task</a> == <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>) <span class="keyword">then</span>
<a name="l00277"></a>00277          <span class="keyword">open</span> (<a class="code" href="namespaceice__fileunits.html#a1c0f914707e7a61a579be21df178f061">nu_nml</a>, file=<a class="code" href="namespaceice__fileunits.html#aec528ed6b00fd0cb2d1e2c5892835bd1">nml_filename</a>, status=<span class="stringliteral">&apos;old&apos;</span>,iostat=nml_error)
<a name="l00278"></a>00278          <span class="keyword">if</span> (nml_error /= 0) <span class="keyword">then</span>
<a name="l00279"></a>00279             nml_error = -1
<a name="l00280"></a>00280          <span class="keyword">else</span>
<a name="l00281"></a>00281             nml_error =  1
<a name="l00282"></a>00282          <span class="keyword">endif</span>
<a name="l00283"></a>00283          <span class="keyword">do</span> <span class="keyword">while</span> (nml_error &gt; 0)
<a name="l00284"></a>00284             <span class="keyword">read</span>(<a class="code" href="namespaceice__fileunits.html#a1c0f914707e7a61a579be21df178f061">nu_nml</a>, nml=icefields_nml,iostat=nml_error)
<a name="l00285"></a>00285             <span class="keyword">if</span> (nml_error &gt; 0) <span class="keyword">read</span>(<a class="code" href="namespaceice__fileunits.html#a1c0f914707e7a61a579be21df178f061">nu_nml</a>,*)  <span class="comment">! for Nagware compiler</span>
<a name="l00286"></a>00286          <span class="keyword">end do</span>
<a name="l00287"></a>00287          <span class="keyword">if</span> (nml_error == 0) <span class="keyword">close</span>(<a class="code" href="namespaceice__fileunits.html#a1c0f914707e7a61a579be21df178f061">nu_nml</a>)
<a name="l00288"></a>00288       <span class="keyword">endif</span>
<a name="l00289"></a>00289       call <a class="code" href="namespaceice__fileunits.html#a6edc4f5f2fe087f5651f7d4b7f595eeb">release_fileunit</a>(<a class="code" href="namespaceice__fileunits.html#a1c0f914707e7a61a579be21df178f061">nu_nml</a>)
<a name="l00290"></a>00290 
<a name="l00291"></a>00291       call <a class="code" href="interfaceice__broadcast_1_1broadcast__scalar.html">broadcast_scalar</a>(nml_error, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00292"></a>00292       <span class="keyword">if</span> (nml_error /= 0) <span class="keyword">then</span>
<a name="l00293"></a>00293          <span class="keyword">close</span> (<a class="code" href="namespaceice__fileunits.html#a1c0f914707e7a61a579be21df178f061">nu_nml</a>)
<a name="l00294"></a>00294          call <a class="code" href="namespaceice__exit.html#a3fcf77109320e75f1268f41fe212d789">abort_ice</a>(<span class="stringliteral">&apos;ice: error reading icefields_nml&apos;</span>)
<a name="l00295"></a>00295       <span class="keyword">endif</span>
<a name="l00296"></a>00296 
<a name="l00297"></a>00297       <span class="comment">! histfreq options (&apos;1&apos;,&apos;h&apos;,&apos;d&apos;,&apos;m&apos;,&apos;y&apos;)</span>
<a name="l00298"></a>00298       nstreams = 0
<a name="l00299"></a>00299       <span class="keyword">do</span> ns = 1, max_nstrm
<a name="l00300"></a>00300          <span class="keyword">if</span> (<a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns) == <span class="stringliteral">&apos;1&apos;</span> .or. <a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns) == <span class="stringliteral">&apos;h&apos;</span> .or. &amp;
<a name="l00301"></a>00301              <a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns) == <span class="stringliteral">&apos;d&apos;</span> .or. <a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns) == <span class="stringliteral">&apos;m&apos;</span> .or. &amp;
<a name="l00302"></a>00302              <a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns) == <span class="stringliteral">&apos;y&apos;</span>) <span class="keyword">then</span>
<a name="l00303"></a>00303                 nstreams = nstreams + 1
<a name="l00304"></a>00304          <span class="keyword">else</span> <span class="keyword">if</span> (<a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l00305"></a>00305              call <a class="code" href="namespaceice__exit.html#a3fcf77109320e75f1268f41fe212d789">abort_ice</a>(<span class="stringliteral">&apos;ice: histfreq contains illegal element&apos;</span>)
<a name="l00306"></a>00306          <span class="keyword">endif</span>
<a name="l00307"></a>00307       <span class="keyword">enddo</span>
<a name="l00308"></a>00308       <span class="keyword">if</span> (nstreams == 0) <span class="keyword">write</span> (<a class="code" href="namespaceice__fileunits.html#a5a65f292ace9ba700843f3e293922842">nu_diag</a>,*) <span class="stringliteral">&apos;WARNING: No history output&apos;</span>
<a name="l00309"></a>00309       <span class="keyword">do</span> ns1 = 1, nstreams
<a name="l00310"></a>00310          <span class="keyword">do</span> ns2 = 1, nstreams
<a name="l00311"></a>00311             <span class="keyword">if</span> (<a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns1) == <a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns2) .and. ns1/=ns2 &amp;
<a name="l00312"></a>00312                .and. <a class="code" href="namespaceice__communicate.html#a70e729e746e2e5ec592ccba505136002">my_task</a> == <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>) <span class="keyword">then</span>
<a name="l00313"></a>00313                call <a class="code" href="namespaceice__exit.html#a3fcf77109320e75f1268f41fe212d789">abort_ice</a>(<span class="stringliteral">&apos;ice: histfreq elements must be unique&apos;</span>)
<a name="l00314"></a>00314             <span class="keyword">endif</span>
<a name="l00315"></a>00315          <span class="keyword">enddo</span>
<a name="l00316"></a>00316       <span class="keyword">enddo</span>
<a name="l00317"></a>00317 
<a name="l00318"></a>00318       <span class="keyword">if</span> (.not. <a class="code" href="namespaceice__state.html#adad96297f8eb0305b0e5ed4db6e6fbd3">tr_iage</a>) f_iage   = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00319"></a>00319       <span class="keyword">if</span> (.not. <a class="code" href="namespaceice__state.html#a086ac953805c6da5789990b53cb6b662">tr_FY</a>)   f_FY     = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00320"></a>00320       <span class="keyword">if</span> (.not. <a class="code" href="namespaceice__state.html#a56887007a4f4de6dd85325f308b9be48">tr_pond</a>) <span class="keyword">then</span>
<a name="l00321"></a>00321           f_apond  = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00322"></a>00322           f_apondn = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00323"></a>00323       <span class="keyword">endif</span>
<a name="l00324"></a>00324       <span class="keyword">if</span> (.not. <a class="code" href="namespaceice__state.html#a9a5f93f07c79fa1b586dbd336420fbfa">tr_aero</a>) <span class="keyword">then</span>
<a name="l00325"></a>00325          f_faero_atm = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00326"></a>00326          f_faero_ocn = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00327"></a>00327          f_aero = <span class="stringliteral">&apos;xxxxx&apos;</span> 
<a name="l00328"></a>00328          f_aeron = <span class="stringliteral">&apos;xxxxx&apos;</span>
<a name="l00329"></a>00329       <span class="keyword">endif</span>
<a name="l00330"></a>00330 
<a name="l00331"></a>00331       <span class="comment">! these must be output at the same frequency because of </span>
<a name="l00332"></a>00332       <span class="comment">! cos(zenith angle) averaging</span>
<a name="l00333"></a>00333       <span class="keyword">if</span> (f_albsno(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) f_albsno = f_albice
<a name="l00334"></a>00334       <span class="keyword">if</span> (f_albpnd(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) f_albpnd = f_albice
<a name="l00335"></a>00335       <span class="keyword">if</span> (f_coszen(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) f_coszen = f_albice
<a name="l00336"></a>00336 
<a name="l00337"></a>00337       <span class="comment">! to prevent array-out-of-bounds when aggregating</span>
<a name="l00338"></a>00338       <span class="keyword">if</span> (f_fmeltt_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) f_fmelttn_ai = f_fmeltt_ai
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="preprocessor">#ifndef ncdf</span>
<a name="l00341"></a>00341 <span class="preprocessor"></span>      <a class="code" href="namespaceice__history__fields.html#a2f3cd20e9232a9ef13482e90435469dc">f_bounds</a> = .false.
<a name="l00342"></a>00342 <span class="preprocessor">#endif</span>
<a name="l00343"></a>00343 <span class="preprocessor"></span>
<a name="l00344"></a>00344       call broadcast_scalar (<a class="code" href="namespaceice__history.html#ac6635a8bcde54a554d4b60c7c6566b26">f_tmask</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00345"></a>00345       call broadcast_scalar (<a class="code" href="namespaceice__history.html#a7b8cc0a9e56bbe22f0015aa2062953d0">f_tarea</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00346"></a>00346       call broadcast_scalar (<a class="code" href="namespaceice__history.html#ac39fd46be06edb447fb96f16103e4d96">f_uarea</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00347"></a>00347       call broadcast_scalar (<a class="code" href="namespaceice__history.html#a6effc6ebe9b5dc7d958341622f11530c">f_dxt</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00348"></a>00348       call broadcast_scalar (<a class="code" href="namespaceice__history.html#a7976eedce7471cfcf14fe54b09e5e2a0">f_dyt</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00349"></a>00349       call broadcast_scalar (<a class="code" href="namespaceice__history.html#ac2cca9bb022f44a98a6cff9a59cd19e3">f_dxu</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00350"></a>00350       call broadcast_scalar (<a class="code" href="namespaceice__history.html#a5fe48a0bc8e7dcdbe8689feadd8cdd70">f_dyu</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00351"></a>00351       call broadcast_scalar (<a class="code" href="namespaceice__history.html#a7e63313bc71fed15ff1d16cbaf4d74ea">f_HTN</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00352"></a>00352       call broadcast_scalar (<a class="code" href="namespaceice__history.html#ac61273f25f1bb3b60c8cc5c55c8fd490">f_HTE</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00353"></a>00353       call broadcast_scalar (<a class="code" href="namespaceice__history.html#ae355872badcbed142dd282929330dae7">f_ANGLE</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00354"></a>00354       call broadcast_scalar (<a class="code" href="namespaceice__history.html#a31c241b97efeccd9b191577aa4bf3b4a">f_ANGLET</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00355"></a>00355       call broadcast_scalar (<a class="code" href="namespaceice__history__fields.html#a2f3cd20e9232a9ef13482e90435469dc">f_bounds</a>, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="comment">!     call broadcast_scalar (f_example, master_task)</span>
<a name="l00358"></a>00358       call broadcast_scalar (f_hi, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00359"></a>00359       call broadcast_scalar (f_hs, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00360"></a>00360       call broadcast_scalar (f_fs, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00361"></a>00361       call broadcast_scalar (f_Tsfc, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00362"></a>00362       call broadcast_scalar (f_aice, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00363"></a>00363       call broadcast_scalar (f_uvel, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00364"></a>00364       call broadcast_scalar (f_vvel, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00365"></a>00365       call broadcast_scalar (f_transix, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00366"></a>00366       call broadcast_scalar (f_transiy, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00367"></a>00367       call broadcast_scalar (f_fswdn, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00368"></a>00368       call broadcast_scalar (f_fswup, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00369"></a>00369       call broadcast_scalar (f_flwdn, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00370"></a>00370       call broadcast_scalar (f_snow, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00371"></a>00371       call broadcast_scalar (f_snow_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00372"></a>00372       call broadcast_scalar (f_rain, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00373"></a>00373       call broadcast_scalar (f_rain_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00374"></a>00374       call broadcast_scalar (f_faero_atm, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00375"></a>00375       call broadcast_scalar (f_faero_ocn, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00376"></a>00376       call broadcast_scalar (f_sst, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00377"></a>00377       call broadcast_scalar (f_sss, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00378"></a>00378       call broadcast_scalar (f_uocn, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00379"></a>00379       call broadcast_scalar (f_vocn, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00380"></a>00380       call broadcast_scalar (f_frzmlt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00381"></a>00381       call broadcast_scalar (f_fswfac, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00382"></a>00382       call broadcast_scalar (f_fswabs, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00383"></a>00383       call broadcast_scalar (f_fswabs_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00384"></a>00384       call broadcast_scalar (f_alvdr, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00385"></a>00385       call broadcast_scalar (f_alidr, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00386"></a>00386       call broadcast_scalar (f_albice, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00387"></a>00387       call broadcast_scalar (f_albsno, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00388"></a>00388       call broadcast_scalar (f_albpnd, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00389"></a>00389       call broadcast_scalar (f_coszen, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00390"></a>00390       call broadcast_scalar (f_flat, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00391"></a>00391       call broadcast_scalar (f_flat_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00392"></a>00392       call broadcast_scalar (f_fsens, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00393"></a>00393       call broadcast_scalar (f_fsens_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00394"></a>00394       call broadcast_scalar (f_flwup, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00395"></a>00395       call broadcast_scalar (f_flwup_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00396"></a>00396       call broadcast_scalar (f_evap, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00397"></a>00397       call broadcast_scalar (f_evap_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00398"></a>00398       call broadcast_scalar (f_qi, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00399"></a>00399       call broadcast_scalar (f_qs, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00400"></a>00400       call broadcast_scalar (f_Tair, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00401"></a>00401       call broadcast_scalar (f_Tref, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00402"></a>00402       call broadcast_scalar (f_Qref, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00403"></a>00403       call broadcast_scalar (f_congel, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00404"></a>00404       call broadcast_scalar (f_frazil, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00405"></a>00405       call broadcast_scalar (f_snoice, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00406"></a>00406       call broadcast_scalar (f_meltt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00407"></a>00407       call broadcast_scalar (f_meltb, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00408"></a>00408       call broadcast_scalar (f_meltl, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00409"></a>00409       call broadcast_scalar (f_melts, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00410"></a>00410       call broadcast_scalar (f_fresh, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00411"></a>00411       call broadcast_scalar (f_fresh_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00412"></a>00412       call broadcast_scalar (f_fsalt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00413"></a>00413       call broadcast_scalar (f_fsalt_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00414"></a>00414       call broadcast_scalar (f_fhocn, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00415"></a>00415       call broadcast_scalar (f_fhocn_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00416"></a>00416       call broadcast_scalar (f_fswthru, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00417"></a>00417       call broadcast_scalar (f_fswthru_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00418"></a>00418       call broadcast_scalar (f_strairx, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00419"></a>00419       call broadcast_scalar (f_strairy, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00420"></a>00420       call broadcast_scalar (f_strtltx, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00421"></a>00421       call broadcast_scalar (f_strtlty, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00422"></a>00422       call broadcast_scalar (f_strcorx, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00423"></a>00423       call broadcast_scalar (f_strcory, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00424"></a>00424       call broadcast_scalar (f_strocnx, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00425"></a>00425       call broadcast_scalar (f_strocny, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00426"></a>00426       call broadcast_scalar (f_strintx, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00427"></a>00427       call broadcast_scalar (f_strinty, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00428"></a>00428       call broadcast_scalar (f_strength, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00429"></a>00429       call broadcast_scalar (f_opening, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00430"></a>00430       call broadcast_scalar (f_divu, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00431"></a>00431       call broadcast_scalar (f_shear, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00432"></a>00432       call broadcast_scalar (f_sig1, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00433"></a>00433       call broadcast_scalar (f_sig2, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00434"></a>00434       call broadcast_scalar (f_dvidtt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00435"></a>00435       call broadcast_scalar (f_dvidtd, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00436"></a>00436       call broadcast_scalar (f_daidtt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00437"></a>00437       call broadcast_scalar (f_daidtd, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00438"></a>00438       call broadcast_scalar (f_mlt_onset, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00439"></a>00439       call broadcast_scalar (f_frz_onset, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00440"></a>00440       call broadcast_scalar (f_dardg1dt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00441"></a>00441       call broadcast_scalar (f_dardg2dt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00442"></a>00442       call broadcast_scalar (f_dvirdgdt, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00443"></a>00443       call broadcast_scalar (f_aisnap, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00444"></a>00444       call broadcast_scalar (f_hisnap, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00445"></a>00445       call broadcast_scalar (f_aicen, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00446"></a>00446       call broadcast_scalar (f_vicen, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00447"></a>00447       call broadcast_scalar (f_trsig, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00448"></a>00448       call broadcast_scalar (f_icepresent, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00449"></a>00449       call broadcast_scalar (f_fsurf_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00450"></a>00450       call broadcast_scalar (f_fcondtop_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00451"></a>00451       call broadcast_scalar (f_fmeltt_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00452"></a>00452       call broadcast_scalar (f_fsurfn_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00453"></a>00453       call broadcast_scalar (f_fcondtopn_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00454"></a>00454       call broadcast_scalar (f_fmelttn_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00455"></a>00455       call broadcast_scalar (f_flatn_ai, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00456"></a>00456 
<a name="l00457"></a>00457       call broadcast_scalar (f_aero, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00458"></a>00458       call broadcast_scalar (f_aeron, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00459"></a>00459       call broadcast_scalar (f_iage, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00460"></a>00460       call broadcast_scalar (f_FY, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00461"></a>00461       call broadcast_scalar (f_apond, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00462"></a>00462       call broadcast_scalar (f_apondn, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l00463"></a>00463 
<a name="l00464"></a>00464       <span class="keyword">do</span> ns1 = 1, nstreams
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 <span class="comment">!!!!! begin example</span>
<a name="l00467"></a>00467 <span class="comment">!      if (f_example(1:1) /= &apos;x&apos;) &amp;</span>
<a name="l00468"></a>00468 <span class="comment">!         call define_hist_field(n_example,&quot;example&quot;,&quot;m&quot;,tstr, tcstr, &amp; </span>
<a name="l00469"></a>00469 <span class="comment">!            &quot;example: mean ice thickness&quot;,                           &amp;</span>
<a name="l00470"></a>00470 <span class="comment">!            &quot;ice volume per unit grid cell area&quot;, c1, c0,            &amp;</span>
<a name="l00471"></a>00471 <span class="comment">!            ns1, f_example)</span>
<a name="l00472"></a>00472 <span class="comment">!!!!! end example</span>
<a name="l00473"></a>00473 
<a name="l00474"></a>00474       <span class="keyword">if</span> (f_hi(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00475"></a>00475          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_hi,<span class="stringliteral">&quot;hi&quot;</span>,<span class="stringliteral">&quot;m&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,         &amp; 
<a name="l00476"></a>00476              <span class="stringliteral">&quot;grid cell mean ice thickness&quot;</span>,                       &amp;
<a name="l00477"></a>00477              <span class="stringliteral">&quot;ice volume per unit grid cell area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,         &amp;
<a name="l00478"></a>00478              ns1, f_hi)
<a name="l00479"></a>00479 
<a name="l00480"></a>00480       <span class="keyword">if</span> (f_hs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00481"></a>00481          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_hs,<span class="stringliteral">&quot;hs&quot;</span>,<span class="stringliteral">&quot;m&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,         &amp;
<a name="l00482"></a>00482              <span class="stringliteral">&quot;grid cell mean snow thickness&quot;</span>,                      &amp;
<a name="l00483"></a>00483              <span class="stringliteral">&quot;snow volume per unit grid cell area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,        &amp;
<a name="l00484"></a>00484              ns1, f_hs)
<a name="l00485"></a>00485 
<a name="l00486"></a>00486       <span class="keyword">if</span> (f_fs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00487"></a>00487          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fs,<span class="stringliteral">&quot;fs&quot;</span>,<span class="stringliteral">&quot; &quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,         &amp;
<a name="l00488"></a>00488              <span class="stringliteral">&quot;grid cell mean snow fraction&quot;</span>,                       &amp;
<a name="l00489"></a>00489              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                       &amp;
<a name="l00490"></a>00490              ns1, f_fs)
<a name="l00491"></a>00491 
<a name="l00492"></a>00492       <span class="keyword">if</span> (f_Tsfc(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00493"></a>00493          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_Tsfc,<span class="stringliteral">&quot;Tsfc&quot;</span>,<span class="stringliteral">&quot;degC&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,  &amp;
<a name="l00494"></a>00494              <span class="stringliteral">&quot;snow/ice surface temperature&quot;</span>,                       &amp;
<a name="l00495"></a>00495              <span class="stringliteral">&quot;averaged with Tf if no ice is present&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,      &amp;
<a name="l00496"></a>00496              ns1, f_Tsfc)
<a name="l00497"></a>00497 
<a name="l00498"></a>00498       <span class="keyword">if</span> (f_aice(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00499"></a>00499          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_aice,<span class="stringliteral">&quot;aice&quot;</span>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,     &amp;
<a name="l00500"></a>00500              <span class="stringliteral">&quot;ice area  (aggregate)&quot;</span>,                              &amp;
<a name="l00501"></a>00501              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                     &amp;
<a name="l00502"></a>00502              ns1, f_aice)
<a name="l00503"></a>00503 
<a name="l00504"></a>00504       <span class="keyword">if</span> (f_qi(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00505"></a>00505          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_qi,<span class="stringliteral">&quot;qi&quot;</span>,<span class="stringliteral">&quot;J&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00506"></a>00506              <span class="stringliteral">&quot;internal ice heat content&quot;</span>,                  &amp;
<a name="l00507"></a>00507              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00508"></a>00508              ns1, f_qi)
<a name="l00509"></a>00509       
<a name="l00510"></a>00510       <span class="keyword">if</span> (f_qs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00511"></a>00511          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_qs,<span class="stringliteral">&quot;qs&quot;</span>,<span class="stringliteral">&quot;J&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00512"></a>00512              <span class="stringliteral">&quot;internal snow heat content&quot;</span>,                 &amp;
<a name="l00513"></a>00513              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00514"></a>00514              ns1, f_qs)
<a name="l00515"></a>00515       
<a name="l00516"></a>00516       <span class="keyword">if</span> (f_uvel(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00517"></a>00517          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_uvel,<span class="stringliteral">&quot;uvel&quot;</span>,<span class="stringliteral">&quot;cm/s&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>,  &amp;
<a name="l00518"></a>00518              <span class="stringliteral">&quot;ice velocity (x)&quot;</span>,                                   &amp;
<a name="l00519"></a>00519              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a3f01424bceae75ecd2f26cdf208a89f6">m_to_cm</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,     &amp;
<a name="l00520"></a>00520              ns1, f_uvel)
<a name="l00521"></a>00521 
<a name="l00522"></a>00522       <span class="keyword">if</span> (f_vvel(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00523"></a>00523          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_vvel,<span class="stringliteral">&quot;vvel&quot;</span>,<span class="stringliteral">&quot;cm/s&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>,  &amp;
<a name="l00524"></a>00524              <span class="stringliteral">&quot;ice velocity (y)&quot;</span>,                                   &amp;
<a name="l00525"></a>00525              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a3f01424bceae75ecd2f26cdf208a89f6">m_to_cm</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,     &amp;
<a name="l00526"></a>00526              ns1, f_vvel)
<a name="l00527"></a>00527 
<a name="l00528"></a>00528       <span class="keyword">if</span> (f_transix(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00529"></a>00529          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_transix,<span class="stringliteral">&quot;transix&quot;</span>,<span class="stringliteral">&quot;kg/s&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,  &amp;
<a name="l00530"></a>00530              <span class="stringliteral">&quot;ice mass transport (x) on East side&quot;</span>,                      &amp;
<a name="l00531"></a>00531              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,     &amp;
<a name="l00532"></a>00532              ns1, f_transix)
<a name="l00533"></a>00533 
<a name="l00534"></a>00534       <span class="keyword">if</span> (f_transiy(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00535"></a>00535          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_transiy,<span class="stringliteral">&quot;transiy&quot;</span>,<span class="stringliteral">&quot;kg/s&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,  &amp;
<a name="l00536"></a>00536              <span class="stringliteral">&quot;ice mass transport (y) on North side&quot;</span>,                     &amp;
<a name="l00537"></a>00537              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,     &amp;
<a name="l00538"></a>00538              ns1, f_transiy)
<a name="l00539"></a>00539 
<a name="l00540"></a>00540       <span class="keyword">if</span> (f_fswdn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00541"></a>00541          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fswdn,<span class="stringliteral">&quot;fswdn&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00542"></a>00542              <span class="stringliteral">&quot;down solar flux&quot;</span>,                                      &amp;
<a name="l00543"></a>00543              <span class="stringliteral">&quot;positive downward&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                            &amp;
<a name="l00544"></a>00544              ns1, f_fswdn)
<a name="l00545"></a>00545 
<a name="l00546"></a>00546       <span class="keyword">if</span> (f_fswup(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00547"></a>00547          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fswup,<span class="stringliteral">&quot;fswup&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00548"></a>00548              <span class="stringliteral">&quot;upward solar flux&quot;</span>,                                    &amp;
<a name="l00549"></a>00549              <span class="stringliteral">&quot;positive downward&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                            &amp;
<a name="l00550"></a>00550              ns1, f_fswup)
<a name="l00551"></a>00551 
<a name="l00552"></a>00552       <span class="keyword">if</span> (f_flwdn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00553"></a>00553          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_flwdn,<span class="stringliteral">&quot;flwdn&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00554"></a>00554              <span class="stringliteral">&quot;down longwave flux&quot;</span>,                                   &amp;
<a name="l00555"></a>00555              <span class="stringliteral">&quot;positive downward&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                            &amp;
<a name="l00556"></a>00556              ns1, f_flwdn)
<a name="l00557"></a>00557 
<a name="l00558"></a>00558       <span class="keyword">if</span> (f_snow(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00559"></a>00559          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_snow,<span class="stringliteral">&quot;snow&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00560"></a>00560              <span class="stringliteral">&quot;snowfall rate (cpl)&quot;</span>,                                 &amp;
<a name="l00561"></a>00561              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                     &amp;
<a name="l00562"></a>00562              ns1, f_snow)
<a name="l00563"></a>00563 
<a name="l00564"></a>00564       <span class="keyword">if</span> (f_snow_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00565"></a>00565          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_snow_ai,<span class="stringliteral">&quot;snow_ai&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00566"></a>00566              <span class="stringliteral">&quot;snowfall rate&quot;</span>,                                             &amp;
<a name="l00567"></a>00567              <span class="stringliteral">&quot;weighted by ice&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00568"></a>00568              ns1, f_snow_ai)
<a name="l00569"></a>00569 
<a name="l00570"></a>00570       <span class="keyword">if</span> (f_rain(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00571"></a>00571          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_rain,<span class="stringliteral">&quot;rain&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00572"></a>00572              <span class="stringliteral">&quot;rainfall rate (cpl)&quot;</span>,                                 &amp;
<a name="l00573"></a>00573              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                     &amp;
<a name="l00574"></a>00574              ns1, f_rain)
<a name="l00575"></a>00575 
<a name="l00576"></a>00576       <span class="keyword">if</span> (f_rain_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00577"></a>00577          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_rain_ai,<span class="stringliteral">&quot;rain_ai&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00578"></a>00578              <span class="stringliteral">&quot;rainfall rate&quot;</span>,                                             &amp;
<a name="l00579"></a>00579              <span class="stringliteral">&quot;weighted by ice&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00580"></a>00580              ns1, f_rain_ai)
<a name="l00581"></a>00581 
<a name="l00582"></a>00582       <span class="keyword">if</span> (f_sst(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00583"></a>00583          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_sst,<span class="stringliteral">&quot;sst&quot;</span>,<span class="stringliteral">&quot;C&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00584"></a>00584              <span class="stringliteral">&quot;sea surface temperature&quot;</span>,                      &amp;
<a name="l00585"></a>00585              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                 &amp;
<a name="l00586"></a>00586              ns1, f_sst)
<a name="l00587"></a>00587 
<a name="l00588"></a>00588       <span class="keyword">if</span> (f_sss(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00589"></a>00589          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_sss,<span class="stringliteral">&quot;sss&quot;</span>,<span class="stringliteral">&quot;ppt&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00590"></a>00590              <span class="stringliteral">&quot;sea surface salinity&quot;</span>,                           &amp;
<a name="l00591"></a>00591              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                   &amp;
<a name="l00592"></a>00592              ns1, f_sss)
<a name="l00593"></a>00593 
<a name="l00594"></a>00594       <span class="keyword">if</span> (f_uocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00595"></a>00595          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_uocn,<span class="stringliteral">&quot;uocn&quot;</span>,<span class="stringliteral">&quot;cm/s&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00596"></a>00596              <span class="stringliteral">&quot;ocean current (x)&quot;</span>,                                 &amp;
<a name="l00597"></a>00597              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a3f01424bceae75ecd2f26cdf208a89f6">m_to_cm</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,    &amp;
<a name="l00598"></a>00598              ns1, f_uocn)
<a name="l00599"></a>00599 
<a name="l00600"></a>00600       <span class="keyword">if</span> (f_vocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00601"></a>00601          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_vocn,<span class="stringliteral">&quot;vocn&quot;</span>,<span class="stringliteral">&quot;cm/s&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00602"></a>00602              <span class="stringliteral">&quot;ocean current (y)&quot;</span>,                                 &amp;
<a name="l00603"></a>00603              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a3f01424bceae75ecd2f26cdf208a89f6">m_to_cm</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,    &amp;
<a name="l00604"></a>00604              ns1, f_vocn)
<a name="l00605"></a>00605 
<a name="l00606"></a>00606       <span class="keyword">if</span> (f_fswfac(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00607"></a>00607          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fswfac,<span class="stringliteral">&quot;fswfac&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00608"></a>00608              <span class="stringliteral">&quot;shortwave scaling factor&quot;</span>,                           &amp;
<a name="l00609"></a>00609              <span class="stringliteral">&quot;ratio of netsw new:old&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                     &amp;
<a name="l00610"></a>00610              ns1, f_fswfac)
<a name="l00611"></a>00611 
<a name="l00612"></a>00612       <span class="keyword">if</span> (f_frzmlt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00613"></a>00613          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_frzmlt,<span class="stringliteral">&quot;frzmlt&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00614"></a>00614              <span class="stringliteral">&quot;freeze/melt potential&quot;</span>,                                  &amp;
<a name="l00615"></a>00615              <span class="stringliteral">&quot;if &gt;0, new ice forms; if &lt;0, ice melts&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,         &amp;
<a name="l00616"></a>00616              ns1, f_frzmlt)
<a name="l00617"></a>00617 
<a name="l00618"></a>00618       <span class="keyword">if</span> (f_fswabs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00619"></a>00619          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fswabs,<span class="stringliteral">&quot;fswabs&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00620"></a>00620              <span class="stringliteral">&quot;snow/ice/ocn absorbed solar flux (cpl)&quot;</span>,                 &amp;
<a name="l00621"></a>00621              <span class="stringliteral">&quot;positive downward&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                              &amp;
<a name="l00622"></a>00622              ns1, f_fswabs)
<a name="l00623"></a>00623       
<a name="l00624"></a>00624       <span class="keyword">if</span> (f_fswabs_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00625"></a>00625          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fswabs_ai,<span class="stringliteral">&quot;fswabs_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00626"></a>00626              <span class="stringliteral">&quot;snow/ice/ocn absorbed solar flux&quot;</span>,                             &amp;
<a name="l00627"></a>00627              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                 &amp;
<a name="l00628"></a>00628              ns1, f_fswabs_ai)
<a name="l00629"></a>00629 
<a name="l00630"></a>00630       <span class="keyword">if</span> (f_alvdr(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00631"></a>00631          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_alvdr,<span class="stringliteral">&quot;alvdr&quot;</span>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00632"></a>00632              <span class="stringliteral">&quot;visible direct albedo&quot;</span>,                            &amp;
<a name="l00633"></a>00633              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                   &amp;
<a name="l00634"></a>00634              ns1, f_alvdr)
<a name="l00635"></a>00635       
<a name="l00636"></a>00636       <span class="keyword">if</span> (f_alidr(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00637"></a>00637          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_alidr,<span class="stringliteral">&quot;alidr&quot;</span>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00638"></a>00638              <span class="stringliteral">&quot;near IR direct albedo&quot;</span>,                            &amp;
<a name="l00639"></a>00639              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                   &amp;
<a name="l00640"></a>00640              ns1, f_alidr)
<a name="l00641"></a>00641       
<a name="l00642"></a>00642       <span class="keyword">if</span> (f_albice(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00643"></a>00643          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_albice,<span class="stringliteral">&quot;albice&quot;</span>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00644"></a>00644              <span class="stringliteral">&quot;bare ice albedo&quot;</span>,                                    &amp;
<a name="l00645"></a>00645              <span class="stringliteral">&quot;averaged for coszen&gt;0, weighted by aice&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,  &amp;
<a name="l00646"></a>00646              ns1, f_albice)
<a name="l00647"></a>00647       
<a name="l00648"></a>00648       <span class="keyword">if</span> (f_albsno(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00649"></a>00649          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_albsno,<span class="stringliteral">&quot;albsno&quot;</span>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00650"></a>00650              <span class="stringliteral">&quot;snow albedo&quot;</span>,                                        &amp;
<a name="l00651"></a>00651              <span class="stringliteral">&quot;averaged for coszen&gt;0, weighted by aice&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,  &amp;
<a name="l00652"></a>00652              ns1, f_albsno)
<a name="l00653"></a>00653       
<a name="l00654"></a>00654       <span class="keyword">if</span> (f_albpnd(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00655"></a>00655          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_albpnd,<span class="stringliteral">&quot;albpnd&quot;</span>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00656"></a>00656              <span class="stringliteral">&quot;melt pond albedo&quot;</span>,                                   &amp;
<a name="l00657"></a>00657              <span class="stringliteral">&quot;averaged for coszen&gt;0, weighted by aice&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,  &amp;
<a name="l00658"></a>00658              ns1, f_albpnd)
<a name="l00659"></a>00659       
<a name="l00660"></a>00660       <span class="keyword">if</span> (f_coszen(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00661"></a>00661          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_coszen,<span class="stringliteral">&quot;coszen&quot;</span>,<span class="stringliteral">&quot;radian&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00662"></a>00662              <span class="stringliteral">&quot;cosine of the zenith angle&quot;</span>,                              &amp;
<a name="l00663"></a>00663              <span class="stringliteral">&quot;negative below horizon&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                          &amp;
<a name="l00664"></a>00664              ns1, f_coszen)
<a name="l00665"></a>00665 
<a name="l00666"></a>00666       <span class="keyword">if</span> (f_flat(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00667"></a>00667          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_flat,<span class="stringliteral">&quot;flat&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00668"></a>00668              <span class="stringliteral">&quot;latent heat flux (cpl)&quot;</span>,                             &amp;
<a name="l00669"></a>00669              <span class="stringliteral">&quot;positive downward&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                          &amp;
<a name="l00670"></a>00670              ns1, f_flat)
<a name="l00671"></a>00671       
<a name="l00672"></a>00672       <span class="keyword">if</span> (f_flat_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00673"></a>00673          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_flat_ai,<span class="stringliteral">&quot;flat_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00674"></a>00674              <span class="stringliteral">&quot;latent heat flux&quot;</span>,                                         &amp;
<a name="l00675"></a>00675              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                             &amp;
<a name="l00676"></a>00676              ns1, f_flat_ai)
<a name="l00677"></a>00677       
<a name="l00678"></a>00678       <span class="keyword">if</span> (f_fsens(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00679"></a>00679          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fsens,<span class="stringliteral">&quot;fsens&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00680"></a>00680              <span class="stringliteral">&quot;sensible heat flux (cpl)&quot;</span>,                             &amp;
<a name="l00681"></a>00681              <span class="stringliteral">&quot;positive downward&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                            &amp;
<a name="l00682"></a>00682              ns1, f_fsens)
<a name="l00683"></a>00683       
<a name="l00684"></a>00684       <span class="keyword">if</span> (f_fsens_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00685"></a>00685          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fsens_ai,<span class="stringliteral">&quot;fsens_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00686"></a>00686              <span class="stringliteral">&quot;sensible heat flux&quot;</span>,                                         &amp;
<a name="l00687"></a>00687              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00688"></a>00688              ns1, f_fsens_ai)
<a name="l00689"></a>00689       
<a name="l00690"></a>00690       <span class="keyword">if</span> (f_flwup(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00691"></a>00691          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_flwup,<span class="stringliteral">&quot;flwup&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00692"></a>00692              <span class="stringliteral">&quot;upward longwave flux (cpl)&quot;</span>,                           &amp;
<a name="l00693"></a>00693              <span class="stringliteral">&quot;positive downward&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                            &amp;
<a name="l00694"></a>00694              ns1, f_flwup)
<a name="l00695"></a>00695       
<a name="l00696"></a>00696       <span class="keyword">if</span> (f_flwup_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00697"></a>00697          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_flwup_ai,<span class="stringliteral">&quot;flwup_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00698"></a>00698              <span class="stringliteral">&quot;upward longwave flux&quot;</span>,                                       &amp;
<a name="l00699"></a>00699              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00700"></a>00700              ns1, f_flwup_ai)
<a name="l00701"></a>00701       
<a name="l00702"></a>00702       <span class="keyword">if</span> (f_evap(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00703"></a>00703          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_evap,<span class="stringliteral">&quot;evap&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00704"></a>00704              <span class="stringliteral">&quot;evaporative water flux (cpl)&quot;</span>,                        &amp;
<a name="l00705"></a>00705              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                     &amp;
<a name="l00706"></a>00706              ns1, f_evap)
<a name="l00707"></a>00707       
<a name="l00708"></a>00708       <span class="keyword">if</span> (f_evap_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00709"></a>00709          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_evap_ai,<span class="stringliteral">&quot;evap_ai&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00710"></a>00710              <span class="stringliteral">&quot;evaporative water flux&quot;</span>,                                    &amp;
<a name="l00711"></a>00711              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,           &amp;
<a name="l00712"></a>00712              ns1, f_evap_ai)
<a name="l00713"></a>00713       
<a name="l00714"></a>00714       <span class="keyword">if</span> (f_Tair(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00715"></a>00715          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_Tair,<span class="stringliteral">&quot;Tair&quot;</span>,<span class="stringliteral">&quot;C&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00716"></a>00716             <span class="stringliteral">&quot;air temperature&quot;</span>,                                &amp;
<a name="l00717"></a>00717              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, -tffresh,                             &amp;
<a name="l00718"></a>00718              ns1, f_Tair)
<a name="l00719"></a>00719       
<a name="l00720"></a>00720       <span class="keyword">if</span> (f_Tref(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00721"></a>00721          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_Tref,<span class="stringliteral">&quot;Tref&quot;</span>,<span class="stringliteral">&quot;C&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00722"></a>00722              <span class="stringliteral">&quot;2m reference temperature&quot;</span>,                       &amp;
<a name="l00723"></a>00723              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                   &amp;
<a name="l00724"></a>00724              ns1, f_Tref)
<a name="l00725"></a>00725       
<a name="l00726"></a>00726       <span class="keyword">if</span> (f_Qref(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00727"></a>00727          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_Qref,<span class="stringliteral">&quot;Qref&quot;</span>,<span class="stringliteral">&quot;g/kg&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00728"></a>00728              <span class="stringliteral">&quot;2m reference specific humidity&quot;</span>,                    &amp;
<a name="l00729"></a>00729              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a8521dc2c82ea56e569469e82ad4780e2">kg_to_g</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                 &amp;
<a name="l00730"></a>00730              ns1, f_Qref)
<a name="l00731"></a>00731       
<a name="l00732"></a>00732       <span class="keyword">if</span> (f_congel(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00733"></a>00733          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_congel,<span class="stringliteral">&quot;congel&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00734"></a>00734              <span class="stringliteral">&quot;congelation ice growth&quot;</span>,                                  &amp;
<a name="l00735"></a>00735              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/dt, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00736"></a>00736              ns1, f_congel)
<a name="l00737"></a>00737       
<a name="l00738"></a>00738       <span class="keyword">if</span> (f_frazil(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00739"></a>00739          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_frazil,<span class="stringliteral">&quot;frazil&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00740"></a>00740              <span class="stringliteral">&quot;frazil ice growth&quot;</span>,                                       &amp;
<a name="l00741"></a>00741              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/dt, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00742"></a>00742              ns1, f_frazil)
<a name="l00743"></a>00743       
<a name="l00744"></a>00744       <span class="keyword">if</span> (f_snoice(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00745"></a>00745          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_snoice,<span class="stringliteral">&quot;snoice&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00746"></a>00746              <span class="stringliteral">&quot;snow-ice formation&quot;</span>,                                      &amp;
<a name="l00747"></a>00747              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/dt, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00748"></a>00748              ns1, f_snoice)
<a name="l00749"></a>00749       
<a name="l00750"></a>00750       <span class="keyword">if</span> (f_meltt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00751"></a>00751          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_meltt,<span class="stringliteral">&quot;meltt&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00752"></a>00752              <span class="stringliteral">&quot;top ice melt&quot;</span>,                                          &amp;
<a name="l00753"></a>00753              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/dt, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                             &amp;
<a name="l00754"></a>00754              ns1, f_meltt)
<a name="l00755"></a>00755       
<a name="l00756"></a>00756       <span class="keyword">if</span> (f_meltb(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00757"></a>00757          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_meltb,<span class="stringliteral">&quot;meltb&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00758"></a>00758              <span class="stringliteral">&quot;basal ice melt&quot;</span>,                                        &amp;
<a name="l00759"></a>00759              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/dt, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                             &amp;
<a name="l00760"></a>00760              ns1, f_meltb)
<a name="l00761"></a>00761       
<a name="l00762"></a>00762       <span class="keyword">if</span> (f_meltl(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00763"></a>00763          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_meltl,<span class="stringliteral">&quot;meltl&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00764"></a>00764              <span class="stringliteral">&quot;lateral ice melt&quot;</span>,                                      &amp;
<a name="l00765"></a>00765              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/dt, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                             &amp;
<a name="l00766"></a>00766              ns1, f_meltl)
<a name="l00767"></a>00767       
<a name="l00768"></a>00768       <span class="keyword">if</span> (f_melts(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00769"></a>00769          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_melts,<span class="stringliteral">&quot;melts&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00770"></a>00770              <span class="stringliteral">&quot;snow melt&quot;</span>,                                             &amp;
<a name="l00771"></a>00771              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/dt, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                             &amp;
<a name="l00772"></a>00772              ns1, f_melts)
<a name="l00773"></a>00773       
<a name="l00774"></a>00774       <span class="keyword">if</span> (f_fresh(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00775"></a>00775          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fresh,<span class="stringliteral">&quot;fresh&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,   &amp;
<a name="l00776"></a>00776              <span class="stringliteral">&quot;freshwtr flx ice to ocn (cpl)&quot;</span>,                           &amp;
<a name="l00777"></a>00777              <span class="stringliteral">&quot;if positive, ocean gains fresh water&quot;</span>,                    &amp;
<a name="l00778"></a>00778              <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                 &amp;
<a name="l00779"></a>00779              ns1, f_fresh)
<a name="l00780"></a>00780       
<a name="l00781"></a>00781       <span class="keyword">if</span> (f_fresh_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00782"></a>00782          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fresh_ai,<span class="stringliteral">&quot;fresh_ai&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00783"></a>00783              <span class="stringliteral">&quot;freshwtr flx ice to ocn&quot;</span>,                                     &amp;
<a name="l00784"></a>00784              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>/<a class="code" href="namespaceice__constants.html#a6aa217bd72fe4e73265e915de96c3665">rhofresh</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,             &amp;
<a name="l00785"></a>00785              ns1, f_fresh_ai)
<a name="l00786"></a>00786       
<a name="l00787"></a>00787       <span class="keyword">if</span> (f_fsalt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00788"></a>00788          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fsalt,<span class="stringliteral">&quot;fsalt&quot;</span>,<span class="stringliteral">&quot;kg/m^2/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00789"></a>00789              <span class="stringliteral">&quot;salt flux ice to ocn (cpl)&quot;</span>,                                &amp;
<a name="l00790"></a>00790              <span class="stringliteral">&quot;if positive, ocean gains salt&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                 &amp;
<a name="l00791"></a>00791              ns1, f_fsalt)
<a name="l00792"></a>00792       
<a name="l00793"></a>00793       <span class="keyword">if</span> (f_fsalt_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00794"></a>00794          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fsalt_ai,<span class="stringliteral">&quot;fsalt_ai&quot;</span>,<span class="stringliteral">&quot;kg/m^2/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,&amp;
<a name="l00795"></a>00795              <span class="stringliteral">&quot;salt flux ice to ocean&quot;</span>,                                         &amp;
<a name="l00796"></a>00796              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00797"></a>00797              ns1, f_fsalt_ai)
<a name="l00798"></a>00798       
<a name="l00799"></a>00799       <span class="keyword">if</span> (f_fhocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00800"></a>00800          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fhocn,<span class="stringliteral">&quot;fhocn&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00801"></a>00801              <span class="stringliteral">&quot;heat flux ice to ocn (cpl)&quot;</span>,                           &amp;
<a name="l00802"></a>00802              <span class="stringliteral">&quot;if positive, ocean gains heat&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00803"></a>00803              ns1, f_fhocn)
<a name="l00804"></a>00804       
<a name="l00805"></a>00805       <span class="keyword">if</span> (f_fhocn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00806"></a>00806          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fhocn_ai,<span class="stringliteral">&quot;fhocn_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00807"></a>00807              <span class="stringliteral">&quot;heat flux ice to ocean&quot;</span>,                                     &amp;
<a name="l00808"></a>00808              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l00809"></a>00809              ns1, f_fhocn_ai)
<a name="l00810"></a>00810       
<a name="l00811"></a>00811       <span class="keyword">if</span> (f_fswthru(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00812"></a>00812          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fswthru,<span class="stringliteral">&quot;fswthru&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00813"></a>00813              <span class="stringliteral">&quot;SW thru ice to ocean (cpl)&quot;</span>,                               &amp;
<a name="l00814"></a>00814              <span class="stringliteral">&quot;if positive, ocean gains heat&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                    &amp;
<a name="l00815"></a>00815              ns1, f_fswthru)
<a name="l00816"></a>00816       
<a name="l00817"></a>00817       <span class="keyword">if</span> (f_fswthru_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00818"></a>00818          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fswthru_ai,<span class="stringliteral">&quot;fswthru_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,&amp;
<a name="l00819"></a>00819              <span class="stringliteral">&quot;SW flux thru ice to ocean&quot;</span>,                                     &amp;
<a name="l00820"></a>00820              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                  &amp;
<a name="l00821"></a>00821              ns1, f_fswthru_ai)
<a name="l00822"></a>00822       
<a name="l00823"></a>00823       <span class="keyword">if</span> (f_strairx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00824"></a>00824          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strairx,<span class="stringliteral">&quot;strairx&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00825"></a>00825              <span class="stringliteral">&quot;atm/ice stress (x)&quot;</span>,                                       &amp;
<a name="l00826"></a>00826              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00827"></a>00827              ns1, f_strairx)
<a name="l00828"></a>00828       
<a name="l00829"></a>00829       <span class="keyword">if</span> (f_strairy(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00830"></a>00830          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strairy,<span class="stringliteral">&quot;strairy&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00831"></a>00831              <span class="stringliteral">&quot;atm/ice stress (y)&quot;</span>,                                       &amp;
<a name="l00832"></a>00832              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00833"></a>00833              ns1, f_strairy)
<a name="l00834"></a>00834       
<a name="l00835"></a>00835       <span class="keyword">if</span> (f_strtltx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00836"></a>00836          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strtltx,<span class="stringliteral">&quot;strtltx&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00837"></a>00837              <span class="stringliteral">&quot;sea sfc tilt stress (x)&quot;</span>,                                  &amp;
<a name="l00838"></a>00838              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00839"></a>00839              ns1, f_strtltx)
<a name="l00840"></a>00840       
<a name="l00841"></a>00841       <span class="keyword">if</span> (f_strtlty(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00842"></a>00842          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strtlty,<span class="stringliteral">&quot;strtlty&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00843"></a>00843              <span class="stringliteral">&quot;sea sfc tilt stress (y)&quot;</span>,                                  &amp;
<a name="l00844"></a>00844              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00845"></a>00845              ns1, f_strtlty)
<a name="l00846"></a>00846       
<a name="l00847"></a>00847       <span class="keyword">if</span> (f_strcorx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00848"></a>00848          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strcorx,<span class="stringliteral">&quot;strcorx&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00849"></a>00849              <span class="stringliteral">&quot;coriolis stress (x)&quot;</span>,                                      &amp;
<a name="l00850"></a>00850              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00851"></a>00851              ns1, f_strcorx)
<a name="l00852"></a>00852       
<a name="l00853"></a>00853       <span class="keyword">if</span> (f_strcory(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00854"></a>00854          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strcory,<span class="stringliteral">&quot;strcory&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00855"></a>00855              <span class="stringliteral">&quot;coriolis stress (y)&quot;</span>,                                      &amp;
<a name="l00856"></a>00856              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00857"></a>00857              ns1, f_strcory)
<a name="l00858"></a>00858       
<a name="l00859"></a>00859       <span class="keyword">if</span> (f_strocnx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00860"></a>00860          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strocnx,<span class="stringliteral">&quot;strocnx&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00861"></a>00861              <span class="stringliteral">&quot;ocean/ice stress (x)&quot;</span>,                                     &amp;
<a name="l00862"></a>00862              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00863"></a>00863              ns1, f_strocnx)
<a name="l00864"></a>00864       
<a name="l00865"></a>00865       <span class="keyword">if</span> (f_strocny(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00866"></a>00866          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strocny,<span class="stringliteral">&quot;strocny&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00867"></a>00867              <span class="stringliteral">&quot;ocean/ice stress (y)&quot;</span>,                                     &amp;
<a name="l00868"></a>00868              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00869"></a>00869              ns1, f_strocny)
<a name="l00870"></a>00870       
<a name="l00871"></a>00871       <span class="keyword">if</span> (f_strintx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00872"></a>00872          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strintx,<span class="stringliteral">&quot;strintx&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00873"></a>00873              <span class="stringliteral">&quot;internal ice stress (x)&quot;</span>,                                  &amp;
<a name="l00874"></a>00874              <span class="stringliteral">&quot;positive is x direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00875"></a>00875              ns1, f_strintx)
<a name="l00876"></a>00876       
<a name="l00877"></a>00877       <span class="keyword">if</span> (f_strinty(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00878"></a>00878          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strinty,<span class="stringliteral">&quot;strinty&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00879"></a>00879              <span class="stringliteral">&quot;internal ice stress (y)&quot;</span>,                                  &amp;
<a name="l00880"></a>00880              <span class="stringliteral">&quot;positive is y direction on U grid&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l00881"></a>00881              ns1, f_strinty)
<a name="l00882"></a>00882       
<a name="l00883"></a>00883       <span class="keyword">if</span> (f_strength(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00884"></a>00884          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_strength,<span class="stringliteral">&quot;strength&quot;</span>,<span class="stringliteral">&quot;N/m&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00885"></a>00885              <span class="stringliteral">&quot;compressive ice strength&quot;</span>,                                 &amp;
<a name="l00886"></a>00886              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                             &amp;
<a name="l00887"></a>00887              ns1, f_strength)
<a name="l00888"></a>00888       
<a name="l00889"></a>00889       <span class="keyword">if</span> (f_opening(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00890"></a>00890          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_opening,<span class="stringliteral">&quot;opening&quot;</span>,<span class="stringliteral">&quot;%/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00891"></a>00891              <span class="stringliteral">&quot;lead area opening rate&quot;</span>,                                   &amp;
<a name="l00892"></a>00892              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                    &amp;
<a name="l00893"></a>00893              ns1, f_opening)
<a name="l00894"></a>00894       
<a name="l00895"></a>00895       <span class="keyword">if</span> (f_divu(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00896"></a>00896          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_divu,<span class="stringliteral">&quot;divu&quot;</span>,<span class="stringliteral">&quot;%/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00897"></a>00897              <span class="stringliteral">&quot;strain rate (divergence)&quot;</span>,                           &amp;
<a name="l00898"></a>00898              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                              &amp;
<a name="l00899"></a>00899              ns1, f_divu)
<a name="l00900"></a>00900       
<a name="l00901"></a>00901       <span class="keyword">if</span> (f_shear(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00902"></a>00902          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_shear,<span class="stringliteral">&quot;shear&quot;</span>,<span class="stringliteral">&quot;%/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00903"></a>00903              <span class="stringliteral">&quot;strain rate (shear)&quot;</span>,                                  &amp;
<a name="l00904"></a>00904              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                &amp;
<a name="l00905"></a>00905              ns1, f_shear)
<a name="l00906"></a>00906       
<a name="l00907"></a>00907       <span class="keyword">if</span> (f_sig1(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00908"></a>00908          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_sig1,<span class="stringliteral">&quot;sig1&quot;</span>,<span class="stringliteral">&quot; &quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00909"></a>00909              <span class="stringliteral">&quot;norm. principal stress 1&quot;</span>,                       &amp;
<a name="l00910"></a>00910              <span class="stringliteral">&quot;sig1 is instantaneous&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                  &amp;
<a name="l00911"></a>00911              ns1, f_sig1)
<a name="l00912"></a>00912       
<a name="l00913"></a>00913       <span class="keyword">if</span> (f_sig2(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00914"></a>00914          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_sig2,<span class="stringliteral">&quot;sig2&quot;</span>,<span class="stringliteral">&quot; &quot;</span>,<a class="code" href="namespaceice__history.html#a2b8d89b4e6bf73f99efde8b74906cef9">ustr</a>, <a class="code" href="namespaceice__history.html#a6d6a4603e818d63fe00df57441c0a5fb">ucstr</a>, &amp;
<a name="l00915"></a>00915              <span class="stringliteral">&quot;norm. principal stress 2&quot;</span>,                       &amp;
<a name="l00916"></a>00916              <span class="stringliteral">&quot;sig2 is instantaneous&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                  &amp;
<a name="l00917"></a>00917              ns1, f_sig2)
<a name="l00918"></a>00918       
<a name="l00919"></a>00919       <span class="keyword">if</span> (f_dvidtt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00920"></a>00920          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_dvidtt,<span class="stringliteral">&quot;dvidtt&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00921"></a>00921              <span class="stringliteral">&quot;volume tendency thermo&quot;</span>,                                  &amp;
<a name="l00922"></a>00922              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                  &amp;
<a name="l00923"></a>00923              ns1, f_dvidtt)
<a name="l00924"></a>00924       
<a name="l00925"></a>00925       <span class="keyword">if</span> (f_dvidtd(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00926"></a>00926          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_dvidtd,<span class="stringliteral">&quot;dvidtd&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00927"></a>00927              <span class="stringliteral">&quot;volume tendency dynamics&quot;</span>,                                &amp;
<a name="l00928"></a>00928              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                  &amp;
<a name="l00929"></a>00929              ns1, f_dvidtd)
<a name="l00930"></a>00930       
<a name="l00931"></a>00931       <span class="keyword">if</span> (f_daidtt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00932"></a>00932          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_daidtt,<span class="stringliteral">&quot;daidtt&quot;</span>,<span class="stringliteral">&quot;%/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00933"></a>00933              <span class="stringliteral">&quot;area tendency thermo&quot;</span>,                                   &amp;
<a name="l00934"></a>00934              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                  &amp;
<a name="l00935"></a>00935              ns1, f_daidtt)
<a name="l00936"></a>00936       
<a name="l00937"></a>00937       <span class="keyword">if</span> (f_daidtd(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00938"></a>00938          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_daidtd,<span class="stringliteral">&quot;daidtd&quot;</span>,<span class="stringliteral">&quot;%/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00939"></a>00939              <span class="stringliteral">&quot;area tendency dynamics&quot;</span>,                                 &amp;
<a name="l00940"></a>00940              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                  &amp;
<a name="l00941"></a>00941              ns1, f_daidtd)
<a name="l00942"></a>00942       
<a name="l00943"></a>00943       <span class="keyword">if</span> (f_mlt_onset(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00944"></a>00944          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_mlt_onset,<span class="stringliteral">&quot;mlt_onset&quot;</span>,<span class="stringliteral">&quot;day of year&quot;</span>, &amp;
<a name="l00945"></a>00945              <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;melt onset date&quot;</span>,                            &amp;
<a name="l00946"></a>00946              <span class="stringliteral">&quot;midyear restart gives erroneous dates&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,          &amp;
<a name="l00947"></a>00947              ns1, f_mlt_onset)
<a name="l00948"></a>00948       
<a name="l00949"></a>00949       <span class="keyword">if</span> (f_frz_onset(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00950"></a>00950          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_frz_onset,<span class="stringliteral">&quot;frz_onset&quot;</span>,<span class="stringliteral">&quot;day of year&quot;</span>, &amp;
<a name="l00951"></a>00951              <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;freeze onset date&quot;</span>,                          &amp;
<a name="l00952"></a>00952              <span class="stringliteral">&quot;midyear restart gives erroneous dates&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,          &amp;
<a name="l00953"></a>00953              ns1, f_frz_onset)
<a name="l00954"></a>00954       
<a name="l00955"></a>00955       <span class="keyword">if</span> (f_dardg1dt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00956"></a>00956          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_dardg1dt,<span class="stringliteral">&quot;dardg1dt&quot;</span>,<span class="stringliteral">&quot;%/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00957"></a>00957              <span class="stringliteral">&quot;ice area ridging rate&quot;</span>,                                      &amp;
<a name="l00958"></a>00958              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                      &amp;
<a name="l00959"></a>00959              ns1, f_dardg1dt)
<a name="l00960"></a>00960       
<a name="l00961"></a>00961       <span class="keyword">if</span> (f_dardg2dt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00962"></a>00962          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_dardg2dt,<span class="stringliteral">&quot;dardg2dt&quot;</span>,<span class="stringliteral">&quot;%/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00963"></a>00963              <span class="stringliteral">&quot;ridge area formation rate&quot;</span>,                                  &amp;
<a name="l00964"></a>00964              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                      &amp;
<a name="l00965"></a>00965              ns1, f_dardg2dt)
<a name="l00966"></a>00966       
<a name="l00967"></a>00967       <span class="keyword">if</span> (f_dvirdgdt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00968"></a>00968          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_dvirdgdt,<span class="stringliteral">&quot;dvirdgdt&quot;</span>,<span class="stringliteral">&quot;cm/day&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00969"></a>00969              <span class="stringliteral">&quot;ice volume ridging rate&quot;</span>,                                     &amp;
<a name="l00970"></a>00970              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a0fed58f0622b835fd2cb734144ac46c7">mps_to_cmpdy</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                      &amp;
<a name="l00971"></a>00971              ns1, f_dvirdgdt)
<a name="l00972"></a>00972       
<a name="l00973"></a>00973       <span class="keyword">if</span> (f_hisnap(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00974"></a>00974          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_hisnap,<span class="stringliteral">&quot;hisnap&quot;</span>,<span class="stringliteral">&quot;m&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00975"></a>00975              <span class="stringliteral">&quot;ice volume snapshot&quot;</span>,                                &amp;
<a name="l00976"></a>00976              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                       &amp;
<a name="l00977"></a>00977              ns1, f_hisnap)
<a name="l00978"></a>00978       
<a name="l00979"></a>00979       <span class="keyword">if</span> (f_aisnap(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00980"></a>00980          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_aisnap,<span class="stringliteral">&quot;aisnap&quot;</span>,<span class="stringliteral">&quot; &quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00981"></a>00981              <span class="stringliteral">&quot;ice area snapshot&quot;</span>,                                  &amp;
<a name="l00982"></a>00982              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                       &amp;
<a name="l00983"></a>00983              ns1, f_aisnap)
<a name="l00984"></a>00984       
<a name="l00985"></a>00985       <span class="keyword">if</span> (f_trsig(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00986"></a>00986          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_trsig,<span class="stringliteral">&quot;trsig&quot;</span>,<span class="stringliteral">&quot;N/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00987"></a>00987              <span class="stringliteral">&quot;internal stress tensor trace&quot;</span>,                         &amp;
<a name="l00988"></a>00988              <span class="stringliteral">&quot;ice strength approximation&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                   &amp;
<a name="l00989"></a>00989              ns1, f_trsig)
<a name="l00990"></a>00990       
<a name="l00991"></a>00991       <span class="keyword">if</span> (f_icepresent(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00992"></a>00992          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_icepresent,<span class="stringliteral">&quot;ice_present&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00993"></a>00993              <span class="stringliteral">&quot;fraction of time-avg interval that any ice is present&quot;</span>,       &amp;
<a name="l00994"></a>00994              <span class="stringliteral">&quot;ice extent flag&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                     &amp;
<a name="l00995"></a>00995              ns1, f_icepresent)
<a name="l00996"></a>00996       
<a name="l00997"></a>00997       <span class="keyword">if</span> (f_fsurf_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l00998"></a>00998          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fsurf_ai,<span class="stringliteral">&quot;fsurf_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l00999"></a>00999              <span class="stringliteral">&quot;net surface heat flux&quot;</span>,                                      &amp;
<a name="l01000"></a>01000              <span class="stringliteral">&quot;positive downward, excludes conductive flux, weighted by ice area&quot;</span>, &amp;
<a name="l01001"></a>01001              <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>, ns1, f_fsurf_ai)
<a name="l01002"></a>01002       
<a name="l01003"></a>01003       <span class="keyword">if</span> (f_fcondtop_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01004"></a>01004          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fcondtop_ai,<span class="stringliteral">&quot;fcondtop_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>, &amp;
<a name="l01005"></a>01005              <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;top surface conductive heat flux&quot;</span>,         &amp;
<a name="l01006"></a>01006              <span class="stringliteral">&quot;positive downwards, weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,     &amp;
<a name="l01007"></a>01007              ns1, f_fcondtop_ai)
<a name="l01008"></a>01008       
<a name="l01009"></a>01009       <span class="keyword">if</span> (f_fmeltt_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01010"></a>01010          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_fmeltt_ai,<span class="stringliteral">&quot;fmeltt_ai&quot;</span>,<span class="stringliteral">&quot;W/m^2&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l01011"></a>01011              <span class="stringliteral">&quot;net surface heat flux causing melt&quot;</span>,                           &amp;
<a name="l01012"></a>01012              <span class="stringliteral">&quot;always &gt;= 0, weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                    &amp;
<a name="l01013"></a>01013              ns1, f_fmeltt_ai)
<a name="l01014"></a>01014       
<a name="l01015"></a>01015       <span class="comment">! Category variables</span>
<a name="l01016"></a>01016       <span class="keyword">if</span> (f_aicen(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01017"></a>01017          <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>
<a name="l01018"></a>01018             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01019"></a>01019             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;aicen&apos;</span>, trim(nchar) <span class="comment">! aicen</span>
<a name="l01020"></a>01020             stmp = <span class="stringliteral">&apos;ice area, category &apos;</span>   <span class="comment">! aicen</span>
<a name="l01021"></a>01021             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>,<span class="stringliteral">&apos;(a,2x,a)&apos;</span>) trim(stmp), trim(nchar)
<a name="l01022"></a>01022             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a31b00fc2e404e255f40cfa9144865c6f">n_aicen</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l01023"></a>01023                 <a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>, <span class="stringliteral">&quot;Ice range:&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                       &amp;
<a name="l01024"></a>01024                 ns1, f_aicen)
<a name="l01025"></a>01025          <span class="keyword">enddo</span>
<a name="l01026"></a>01026       <span class="keyword">endif</span>
<a name="l01027"></a>01027 
<a name="l01028"></a>01028       <span class="keyword">if</span> (f_vicen(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01029"></a>01029          <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>
<a name="l01030"></a>01030             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01031"></a>01031             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;vicen&apos;</span>, trim(nchar) <span class="comment">! vicen</span>
<a name="l01032"></a>01032             stmp = <span class="stringliteral">&apos;ice volume, category &apos;</span>   <span class="comment">! vicen</span>
<a name="l01033"></a>01033             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>,<span class="stringliteral">&apos;(a,2x,a)&apos;</span>) trim(stmp), trim(nchar)
<a name="l01034"></a>01034             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#afd312fa27e4e7c7979312795eaed3435">n_vicen</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;m&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l01035"></a>01035                 <a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>, <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                               &amp;
<a name="l01036"></a>01036                 ns1, f_vicen)
<a name="l01037"></a>01037          <span class="keyword">enddo</span>
<a name="l01038"></a>01038       <span class="keyword">endif</span>
<a name="l01039"></a>01039 
<a name="l01040"></a>01040       <span class="keyword">if</span> (f_fsurfn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01041"></a>01041          <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>
<a name="l01042"></a>01042             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01043"></a>01043             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;fsurfn_ai&apos;</span>, trim(nchar) <span class="comment">! fsurfn_ai</span>
<a name="l01044"></a>01044             stmp = <span class="stringliteral">&apos;net surface heat flux, category &apos;</span>   <span class="comment">! fsurfn_ai</span>
<a name="l01045"></a>01045             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>,<span class="stringliteral">&apos;(a,2x,a)&apos;</span>) trim(stmp), trim(nchar)
<a name="l01046"></a>01046             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a547e15c8d6d1890d8acb698c12ca6583">n_fsurfn_ai</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;W/m^2&quot;</span>,    &amp;
<a name="l01047"></a>01047                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, <a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>, <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>, &amp;
<a name="l01048"></a>01048                 ns1, f_fsurfn_ai)
<a name="l01049"></a>01049          <span class="keyword">enddo</span>
<a name="l01050"></a>01050       <span class="keyword">endif</span>
<a name="l01051"></a>01051 
<a name="l01052"></a>01052       <span class="keyword">if</span> (f_fcondtopn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01053"></a>01053          <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>
<a name="l01054"></a>01054             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01055"></a>01055             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;fcondtopn_ai&apos;</span>, trim(nchar) <span class="comment">! fcondtopn_ai</span>
<a name="l01056"></a>01056             stmp = <span class="stringliteral">&apos;top sfc conductive heat flux, cat &apos;</span>   <span class="comment">! fcondtopn_ai</span>
<a name="l01057"></a>01057             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>,<span class="stringliteral">&apos;(a,2x,a)&apos;</span>) trim(stmp), trim(nchar)
<a name="l01058"></a>01058             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a277bf94595092110d32c0719616159fc">n_fcondtopn_ai</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;W/m^2&quot;</span>, &amp;
<a name="l01059"></a>01059                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, <a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>, <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>, &amp;
<a name="l01060"></a>01060                 ns1, f_fcondtopn_ai)
<a name="l01061"></a>01061          <span class="keyword">enddo</span>
<a name="l01062"></a>01062       <span class="keyword">endif</span>
<a name="l01063"></a>01063 
<a name="l01064"></a>01064       <span class="keyword">if</span> (f_fmelttn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01065"></a>01065          <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>
<a name="l01066"></a>01066             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01067"></a>01067             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;fmelttn_ai&apos;</span>, trim(nchar) <span class="comment">! fmelttn_ai</span>
<a name="l01068"></a>01068             stmp = <span class="stringliteral">&apos;net sfc heat flux causing melt, cat &apos;</span>   <span class="comment">! fmelttn_ai</span>
<a name="l01069"></a>01069             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>,<span class="stringliteral">&apos;(a,2x,a)&apos;</span>) trim(stmp), trim(nchar)
<a name="l01070"></a>01070             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a950d3a5fcd1b660e07bdea0c7d67cecb">n_fmelttn_ai</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;W/m^2&quot;</span>,   &amp;
<a name="l01071"></a>01071                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, <a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>, <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>, &amp;
<a name="l01072"></a>01072                 ns1, f_fmelttn_ai)
<a name="l01073"></a>01073          <span class="keyword">enddo</span>
<a name="l01074"></a>01074       <span class="keyword">endif</span>
<a name="l01075"></a>01075 
<a name="l01076"></a>01076       <span class="keyword">if</span> (f_flatn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01077"></a>01077          <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>
<a name="l01078"></a>01078             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01079"></a>01079             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;flatn_ai&apos;</span>, trim(nchar) <span class="comment">! flatn_ai</span>
<a name="l01080"></a>01080             stmp = <span class="stringliteral">&apos;latent heat flux, category &apos;</span>   <span class="comment">! flatn_ai</span>
<a name="l01081"></a>01081             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>,<span class="stringliteral">&apos;(a,2x,a)&apos;</span>) trim(stmp), trim(nchar)
<a name="l01082"></a>01082             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#aeea32af91b4549502cf55fa0b93f1778">n_flatn_ai</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;W/m^2&quot;</span>, &amp;
<a name="l01083"></a>01083                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, <a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>, <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>, &amp;
<a name="l01084"></a>01084                 ns1, f_flatn_ai)
<a name="l01085"></a>01085          <span class="keyword">enddo</span>
<a name="l01086"></a>01086       <span class="keyword">endif</span>
<a name="l01087"></a>01087 
<a name="l01088"></a>01088       <span class="comment">! Tracers</span>
<a name="l01089"></a>01089 
<a name="l01090"></a>01090       <span class="comment">! Ice Age</span>
<a name="l01091"></a>01091       <span class="keyword">if</span> (f_iage(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01092"></a>01092          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_iage,<span class="stringliteral">&quot;iage&quot;</span>,<span class="stringliteral">&quot;years&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l01093"></a>01093              <span class="stringliteral">&quot;sea ice age&quot;</span>,                                        &amp;
<a name="l01094"></a>01094              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>/(<a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>*<a class="code" href="namespaceice__calendar.html#a1fa9382761e78de77e0109c55630554b">days_per_year</a>), <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                &amp;
<a name="l01095"></a>01095               ns1, f_iage)
<a name="l01096"></a>01096       <span class="keyword">endif</span>
<a name="l01097"></a>01097 
<a name="l01098"></a>01098       <span class="comment">! FY Ice Concentration</span>
<a name="l01099"></a>01099       <span class="keyword">if</span> (f_FY(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01100"></a>01100          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_FY,<span class="stringliteral">&quot;FYarea&quot;</span>,<span class="stringliteral">&quot; &quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l01101"></a>01101              <span class="stringliteral">&quot;first-year ice area&quot;</span>,                            &amp;
<a name="l01102"></a>01102              <span class="stringliteral">&quot;weighted by ice area&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                   &amp;
<a name="l01103"></a>01103               ns1, f_FY)
<a name="l01104"></a>01104       <span class="keyword">endif</span>
<a name="l01105"></a>01105 
<a name="l01106"></a>01106       <span class="comment">! Aerosols</span>
<a name="l01107"></a>01107       <span class="keyword">if</span> (f_aero(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01108"></a>01108          <span class="keyword">do</span> n=1,n_aero
<a name="l01109"></a>01109             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01110"></a>01110             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;aerosnossl&apos;</span>, trim(nchar)
<a name="l01111"></a>01111             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#afb0db2f3c0c14963f02057fbc84887bc">n_aerosn1</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;kg/kg&quot;</span>, &amp;
<a name="l01112"></a>01112                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;snow ssl aerosol mass&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>, &amp;
<a name="l01113"></a>01113                 ns1, f_aero)
<a name="l01114"></a>01114             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;aerosnoint&apos;</span>, trim(nchar)
<a name="l01115"></a>01115             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a4c7ca26f7fe5c329bea1bd5e4a301eed">n_aerosn2</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;kg/kg&quot;</span>, &amp;
<a name="l01116"></a>01116                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;snow int aerosol mass&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>, &amp;
<a name="l01117"></a>01117                 ns1, f_aero)
<a name="l01118"></a>01118             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;aeroicessl&apos;</span>, trim(nchar)
<a name="l01119"></a>01119             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ad6f36fcab3ebeaa42f44b63a39474c4a">n_aeroic1</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;kg/kg&quot;</span>, &amp;
<a name="l01120"></a>01120                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;ice ssl aerosol mass&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,  &amp;
<a name="l01121"></a>01121                 ns1, f_aero)
<a name="l01122"></a>01122             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;aeroiceint&apos;</span>, trim(nchar)
<a name="l01123"></a>01123             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ac48a9741b1cf192db287c558cb4fadb4">n_aeroic2</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;kg/kg&quot;</span>, &amp;
<a name="l01124"></a>01124                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;ice int aerosol mass&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,  &amp;
<a name="l01125"></a>01125                 ns1, f_aero)
<a name="l01126"></a>01126          <span class="keyword">enddo</span>
<a name="l01127"></a>01127       <span class="keyword">endif</span>
<a name="l01128"></a>01128 
<a name="l01129"></a>01129       <span class="keyword">if</span> (f_faero_atm(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01130"></a>01130          <span class="keyword">do</span> n=1,n_aero
<a name="l01131"></a>01131             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01132"></a>01132             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;faero_atm&apos;</span>, trim(nchar)
<a name="l01133"></a>01133             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ac09149d16d9045cc266eff8a26ff0d97">n_faero_atm</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;kg/m^2 s&quot;</span>, &amp;
<a name="l01134"></a>01134                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;aerosol deposition rate&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,    &amp;
<a name="l01135"></a>01135                 ns1, f_faero_atm)
<a name="l01136"></a>01136          <span class="keyword">enddo</span>
<a name="l01137"></a>01137       <span class="keyword">endif</span>
<a name="l01138"></a>01138 
<a name="l01139"></a>01139       <span class="keyword">if</span> (f_faero_ocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01140"></a>01140          <span class="keyword">do</span> n=1,n_aero
<a name="l01141"></a>01141             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01142"></a>01142             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;faero_ocn&apos;</span>, trim(nchar)
<a name="l01143"></a>01143             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ae402016c2d3706af277fb399ec8f5ec6">n_faero_ocn</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;kg/m^2 s&quot;</span>, &amp;
<a name="l01144"></a>01144                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>,<span class="stringliteral">&quot;aerosol flux to ocean&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,      &amp;
<a name="l01145"></a>01145                 ns1, f_faero_ocn)
<a name="l01146"></a>01146          <span class="keyword">enddo</span>
<a name="l01147"></a>01147       <span class="keyword">endif</span>
<a name="l01148"></a>01148 
<a name="l01149"></a>01149       <span class="comment">! Melt ponds</span>
<a name="l01150"></a>01150       <span class="keyword">if</span> (f_apond(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01151"></a>01151          call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(n_apond,<span class="stringliteral">&quot;apond&quot;</span>,<span class="stringliteral">&quot;%&quot;</span>,<a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, &amp;
<a name="l01152"></a>01152              <span class="stringliteral">&quot;melt pond concentration&quot;</span>,                          &amp;
<a name="l01153"></a>01153              <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,                                   &amp;
<a name="l01154"></a>01154              ns1, f_apond)
<a name="l01155"></a>01155       <span class="keyword">endif</span>
<a name="l01156"></a>01156 
<a name="l01157"></a>01157       <span class="keyword">if</span> (f_apondn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01158"></a>01158          <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>
<a name="l01159"></a>01159             <span class="keyword">write</span>(nchar,<span class="stringliteral">&apos;(i3.3)&apos;</span>) n
<a name="l01160"></a>01160             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&apos;(a,a)&apos;</span>) <span class="stringliteral">&apos;apond&apos;</span>, trim(nchar) <span class="comment">! apondn</span>
<a name="l01161"></a>01161             stmp = <span class="stringliteral">&apos;melt pond concentration, category &apos;</span>   <span class="comment">! apondn</span>
<a name="l01162"></a>01162             <span class="keyword">write</span>(<a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>,<span class="stringliteral">&apos;(a,2x,a)&apos;</span>) trim(stmp), trim(nchar)
<a name="l01163"></a>01163             call <a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a4d3b9e888569b2534dbceeaf3292b696">n_apondn</a>(n,:),<a class="code" href="namespaceice__history.html#a795d9a5379207bc00848c3d58be6fac2">vname_in</a>,<span class="stringliteral">&quot;%&quot;</span>, &amp;
<a name="l01164"></a>01164                 <a class="code" href="namespaceice__history.html#ab16190577859fe12663ca28b0690e5ec">tstr</a>, <a class="code" href="namespaceice__history.html#a56409d6f67844894d11f17ca553864bf">tcstr</a>, <a class="code" href="namespaceice__history.html#a000ee3af05f02fbff13085400a751e53">vdesc_in</a>, <span class="stringliteral">&quot;none&quot;</span>, <a class="code" href="namespaceice__constants.html#a64d8a1f5f872985a8ef291758a414275">c100</a>, <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>,       &amp;
<a name="l01165"></a>01165                 ns1, f_apondn)
<a name="l01166"></a>01166          <span class="keyword">enddo</span>
<a name="l01167"></a>01167       <span class="keyword">endif</span>
<a name="l01168"></a>01168 
<a name="l01169"></a>01169       <span class="keyword">enddo</span> <span class="comment">! ns1</span>
<a name="l01170"></a>01170 
<a name="l01171"></a>01171       <span class="keyword">allocate</span>(<a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(<a class="code" href="namespaceice__blocks.html#a130f3f9b102e86de209ee25eb36e44ba">nx_block</a>,<a class="code" href="namespaceice__blocks.html#a9ad40e7eeb19aeb81a3010e0dd997c43">ny_block</a>,<a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a>,max_blocks))
<a name="l01172"></a>01172 
<a name="l01173"></a>01173       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l01174"></a>01174       <span class="comment">! fill igrd array with namelist values</span>
<a name="l01175"></a>01175       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l01176"></a>01176 
<a name="l01177"></a>01177       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>=.true.
<a name="l01178"></a>01178 
<a name="l01179"></a>01179       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#a357c5d0fb7837fb0461704f23f46d101">n_tmask</a>     ) = <a class="code" href="namespaceice__history.html#ac6635a8bcde54a554d4b60c7c6566b26">f_tmask</a>
<a name="l01180"></a>01180       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#aede613891c36b6de42a6b5dfa94a6c47">n_tarea</a>     ) = <a class="code" href="namespaceice__history.html#a7b8cc0a9e56bbe22f0015aa2062953d0">f_tarea</a>
<a name="l01181"></a>01181       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#a40dda082d8b468c6159dfd8d7fe5763d">n_uarea</a>     ) = <a class="code" href="namespaceice__history.html#ac39fd46be06edb447fb96f16103e4d96">f_uarea</a>
<a name="l01182"></a>01182       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#a613db804c0915e1be10166a897ae5620">n_dxt</a>       ) = <a class="code" href="namespaceice__history.html#a6effc6ebe9b5dc7d958341622f11530c">f_dxt</a>
<a name="l01183"></a>01183       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#a7489b539895f4c90f2ac32cef942834d">n_dyt</a>       ) = <a class="code" href="namespaceice__history.html#a7976eedce7471cfcf14fe54b09e5e2a0">f_dyt</a>
<a name="l01184"></a>01184       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#abf7b5bd4ffe0fce783bbb9305b92e08c">n_dxu</a>       ) = <a class="code" href="namespaceice__history.html#ac2cca9bb022f44a98a6cff9a59cd19e3">f_dxu</a>
<a name="l01185"></a>01185       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#ae9ef4bdaa9a78373d8e7a64434e63832">n_dyu</a>       ) = <a class="code" href="namespaceice__history.html#a5fe48a0bc8e7dcdbe8689feadd8cdd70">f_dyu</a>
<a name="l01186"></a>01186       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#a2fd568cf96c89f8164ffb0a11143bdbe">n_HTN</a>       ) = <a class="code" href="namespaceice__history.html#a7e63313bc71fed15ff1d16cbaf4d74ea">f_HTN</a>
<a name="l01187"></a>01187       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#ae2441593355b72e80279087bc9b631c3">n_HTE</a>       ) = <a class="code" href="namespaceice__history.html#ac61273f25f1bb3b60c8cc5c55c8fd490">f_HTE</a>
<a name="l01188"></a>01188       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#a130bc8773e91330b2369823f37e4c9c3">n_ANGLE</a>     ) = <a class="code" href="namespaceice__history.html#ae355872badcbed142dd282929330dae7">f_ANGLE</a>
<a name="l01189"></a>01189       <a class="code" href="namespaceice__history__fields.html#a7efcc39b544df18b2e0d1952257eb758">igrd</a>(<a class="code" href="namespaceice__history__fields.html#a253f0d4683bb614814edffa539758e3f">n_ANGLET</a>    ) = <a class="code" href="namespaceice__history.html#a31c241b97efeccd9b191577aa4bf3b4a">f_ANGLET</a>
<a name="l01190"></a>01190 
<a name="l01191"></a>01191       ntmp(:) = 0
<a name="l01192"></a>01192       <span class="keyword">if</span> (<a class="code" href="namespaceice__communicate.html#a70e729e746e2e5ec592ccba505136002">my_task</a> == <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>) <span class="keyword">then</span>
<a name="l01193"></a>01193         <span class="keyword">write</span>(<a class="code" href="namespaceice__fileunits.html#a5a65f292ace9ba700843f3e293922842">nu_diag</a>,*) <span class="stringliteral">&apos; &apos;</span>
<a name="l01194"></a>01194         <span class="keyword">write</span>(<a class="code" href="namespaceice__fileunits.html#a5a65f292ace9ba700843f3e293922842">nu_diag</a>,*) <span class="stringliteral">&apos;The following variables will be &apos;</span>, &amp;
<a name="l01195"></a>01195                          <span class="stringliteral">&apos;written to the history tape: &apos;</span>
<a name="l01196"></a>01196         <span class="keyword">write</span>(<a class="code" href="namespaceice__fileunits.html#a5a65f292ace9ba700843f3e293922842">nu_diag</a>,101) <span class="stringliteral">&apos;description&apos;</span>,<span class="stringliteral">&apos;units&apos;</span>,<span class="stringliteral">&apos;variable&apos;</span>,<span class="stringliteral">&apos;frequency&apos;</span>,<span class="stringliteral">&apos;x&apos;</span>
<a name="l01197"></a>01197         <span class="keyword">do</span> n=1,<a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a>
<a name="l01198"></a>01198            <span class="keyword">if</span> (<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n)%vhistfreq_n /= 0) &amp;
<a name="l01199"></a>01199            <span class="keyword">write</span>(<a class="code" href="namespaceice__fileunits.html#a5a65f292ace9ba700843f3e293922842">nu_diag</a>,100) <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n)%vdesc, &amp;
<a name="l01200"></a>01200               <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n)%vunit, <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n)%vname, &amp;
<a name="l01201"></a>01201               <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n)%vhistfreq,<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n)%vhistfreq_n
<a name="l01202"></a>01202            <span class="keyword">do</span> ns = 1, nstreams
<a name="l01203"></a>01203               <span class="keyword">if</span> (<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n)%vhistfreq == <a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns)) &amp;
<a name="l01204"></a>01204                  ntmp(ns)=ntmp(ns)+1
<a name="l01205"></a>01205            <span class="keyword">enddo</span>
<a name="l01206"></a>01206         <span class="keyword">enddo</span> <span class="comment">! num_avail_hist_fields</span>
<a name="l01207"></a>01207         <span class="keyword">write</span>(<a class="code" href="namespaceice__fileunits.html#a5a65f292ace9ba700843f3e293922842">nu_diag</a>,*) <span class="stringliteral">&apos; &apos;</span>
<a name="l01208"></a>01208       <span class="keyword">endif</span>
<a name="l01209"></a>01209   100 format (1x,a40,2x,a12,2x,a12,1x,a1,2x,i6)
<a name="l01210"></a>01210   101 format (2x,a19,10x,a12,9x,a12,2x,a,3x,a1)
<a name="l01211"></a>01211 
<a name="l01212"></a>01212       call <a class="code" href="interfaceice__broadcast_1_1broadcast__array.html">broadcast_array</a>(ntmp, <a class="code" href="namespaceice__communicate.html#a769a45947743f12c592e4cef37a18b6c">master_task</a>)
<a name="l01213"></a>01213       <span class="keyword">do</span> ns = 1, nstreams
<a name="l01214"></a>01214          <span class="keyword">if</span> (ntmp(ns)==0) histfreq_n(ns) = 0
<a name="l01215"></a>01215       <span class="keyword">enddo</span>
<a name="l01216"></a>01216 
<a name="l01217"></a>01217       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l01218"></a>01218       <span class="comment">! initialize the history arrays</span>
<a name="l01219"></a>01219       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l01220"></a>01220       <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(:,:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01221"></a>01221       <a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01222"></a>01222 
<a name="l01223"></a>01223       <span class="keyword">if</span> (<a class="code" href="namespaceice__restart.html#a929c8d9ca4d216b9f6b0e99e89e714fb">restart</a> .and. <a class="code" href="namespaceice__calendar.html#a4b4393c99a1d82bc45fcee5d7f6c1eab">yday</a> &gt;= <a class="code" href="namespaceice__constants.html#a683e0c28523a17a5d2cd40066167570a">c2</a>) <span class="keyword">then</span>
<a name="l01224"></a>01224 <span class="comment">! restarting midyear gives erroneous onset dates</span>
<a name="l01225"></a>01225          <a class="code" href="namespaceice__flux.html#a9f86616260452938fcc37213fcb284f8">mlt_onset</a> = 999._dbl_kind 
<a name="l01226"></a>01226          <a class="code" href="namespaceice__flux.html#aa58df919e95f30bf2b824e6585dbd9e5">frz_onset</a> = 999._dbl_kind 
<a name="l01227"></a>01227       <span class="keyword">else</span>
<a name="l01228"></a>01228          <a class="code" href="namespaceice__flux.html#a9f86616260452938fcc37213fcb284f8">mlt_onset</a> = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01229"></a>01229          <a class="code" href="namespaceice__flux.html#aa58df919e95f30bf2b824e6585dbd9e5">frz_onset</a> = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01230"></a>01230       <span class="keyword">endif</span>
<a name="l01231"></a>01231 
<a name="l01232"></a>01232 <span class="keyword">      end subroutine init_hist</span>
<a name="l01233"></a>01233 
<a name="l01234"></a>01234 <span class="comment">!=======================================================================</span>
<a name="l01235"></a>01235 <span class="comment">!</span>
<a name="l01236"></a>01236 <span class="comment">!BOP</span>
<a name="l01237"></a>01237 <span class="comment">!</span>
<a name="l01238"></a>01238 <span class="comment">! !IROUTINE: ice_write_hist - write average ice quantities or snapshots</span>
<a name="l01239"></a>01239 <span class="comment">!</span>
<a name="l01240"></a>01240 <span class="comment">! !INTERFACE:</span>
<a name="l01241"></a>01241 <span class="comment">!</span>
<a name="l01242"></a><a class="code" href="namespaceice__history.html#a09981e8df56a439fdddc4fcbb1066ecd">01242</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__history.html#a09981e8df56a439fdddc4fcbb1066ecd">ice_write_hist</a> (dt)
<a name="l01243"></a>01243 <span class="comment">!</span>
<a name="l01244"></a>01244 <span class="comment">! !DESCRIPTION:</span>
<a name="l01245"></a>01245 <span class="comment">!</span>
<a name="l01246"></a>01246 <span class="comment">! write average ice quantities or snapshots</span>
<a name="l01247"></a>01247 <span class="comment">!</span>
<a name="l01248"></a>01248 <span class="comment">! !REVISION HISTORY:</span>
<a name="l01249"></a>01249 <span class="comment">!</span>
<a name="l01250"></a>01250 <span class="comment">! author:   Elizabeth C. Hunke, LANL</span>
<a name="l01251"></a>01251 <span class="comment">!</span>
<a name="l01252"></a>01252 <span class="comment">! !USES:</span>
<a name="l01253"></a>01253 <span class="comment">!</span>
<a name="l01254"></a>01254       use <span class="keywordflow">ice_blocks</span>
<a name="l01255"></a>01255       use <span class="keywordflow">ice_domain</span>
<a name="l01256"></a>01256       use <span class="keywordflow">ice_calendar</span>, only: new_year, secday, yday, write_history, &amp;
<a name="l01257"></a>01257                               write_ic, time, histfreq, nstreams
<a name="l01258"></a>01258       use <span class="keywordflow">ice_state</span>
<a name="l01259"></a>01259       use <span class="keywordflow">ice_constants</span>
<a name="l01260"></a>01260       use <span class="keywordflow">ice_flux</span>
<a name="l01261"></a>01261       use <span class="keywordflow">ice_dyn_evp</span>
<a name="l01262"></a>01262       use <span class="keywordflow">ice_itd</span>, only: ilyr1, slyr1
<a name="l01263"></a>01263       use <span class="keywordflow">ice_timers</span>
<a name="l01264"></a>01264 <span class="comment">!</span>
<a name="l01265"></a>01265 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l01266"></a>01266 <span class="comment">!</span>
<a name="l01267"></a>01267       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l01268"></a>01268          dt      <span class="comment">! time step</span>
<a name="l01269"></a>01269 <span class="comment">!EOP</span>
<a name="l01270"></a>01270 <span class="comment">!</span>
<a name="l01271"></a>01271       <span class="keywordtype">integer (kind=int_kind) </span>:: 
<a name="l01272"></a>01272            i,j,k,n,nct,ns   , 
<a name="l01273"></a>01273            iblk             ,  <span class="comment">! block index</span>
<a name="l01274"></a>01274            ilo,ihi,jlo,jhi  ,  <span class="comment">! beginning and end of physical domain</span>
<a name="l01275"></a>01275            nstrm                <span class="comment">! nstreams (1 if writing initial condition)</span>
<a name="l01276"></a>01276 
<a name="l01277"></a>01277       <span class="keywordtype">real (kind=dbl_kind) </span>:: 
<a name="l01278"></a>01278            ravgct            , <span class="comment">! 1/avgct</span>
<a name="l01279"></a>01279            ravgctz              <span class="comment">! 1/avgct</span>
<a name="l01280"></a>01280 
<a name="l01281"></a>01281       <span class="keywordtype">type (</span><a class="code" href="typeice__blocks_1_1block.html">block</a><span class="keywordtype">)</span> :: 
<a name="l01282"></a>01282          this_block             <span class="comment">! block information for current block</span>
<a name="l01283"></a>01283 
<a name="l01284"></a>01284       <span class="keywordtype">real (kind=dbl_kind) </span>:: 
<a name="l01285"></a>01285            worka(nx_block,ny_block), 
<a name="l01286"></a>01286            workb(nx_block,ny_block)
<a name="l01287"></a>01287 
<a name="l01288"></a>01288       <span class="keywordtype">real (kind=dbl_kind) </span>:: 
<a name="l01289"></a>01289            ai                , <span class="comment">! aice_init</span>
<a name="l01290"></a>01290            ain               , <span class="comment">! aicen_init</span>
<a name="l01291"></a>01291            hs                , <span class="comment">! snow depth</span>
<a name="l01292"></a>01292            qs                , <span class="comment">! snow heat content</span>
<a name="l01293"></a>01293            qi                , <span class="comment">! snow heat content</span>
<a name="l01294"></a>01294            uee, vnn          , <span class="comment">! velocity component on east and north edge</span>
<a name="l01295"></a>01295            hiee, hinn           <span class="comment">! ice volume on east and north edge</span>
<a name="l01296"></a>01296 
<a name="l01297"></a>01297       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01298"></a>01298       <span class="comment">! increment step counter</span>
<a name="l01299"></a>01299       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01300"></a>01300 
<a name="l01301"></a>01301       <span class="keyword">do</span> ns=1,nstreams
<a name="l01302"></a>01302          <span class="keyword">if</span> (.not. <a class="code" href="namespaceice__history__fields.html#ad443ef4b2750dd319f461697e217bec3">hist_avg</a> .or. histfreq(ns) == <span class="stringliteral">&apos;1&apos;</span>) <span class="keyword">then</span>  <span class="comment">! write snapshots</span>
<a name="l01303"></a>01303            <span class="keyword">do</span> k=1,<a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a>
<a name="l01304"></a>01304               <span class="keyword">if</span> (<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(k)%vhistfreq == histfreq(ns)) &amp;
<a name="l01305"></a>01305                   <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(:,:,k,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01306"></a>01306            <span class="keyword">enddo</span>
<a name="l01307"></a>01307            <a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns) = <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>
<a name="l01308"></a>01308          <span class="keyword">else</span>                      <span class="comment">! write averages over time histfreq</span>
<a name="l01309"></a>01309            <a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns) = <a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns) + <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>
<a name="l01310"></a>01310            <span class="keyword">if</span> (<a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns) == <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>) <a class="code" href="namespaceice__history__fields.html#af6acdcd2aad4d4b1e7de1048a0654b1b">time_beg</a>(ns) = (time-dt)/int(<a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>)
<a name="l01311"></a>01311          <span class="keyword">endif</span>
<a name="l01312"></a>01312       <span class="keyword">enddo</span>
<a name="l01313"></a>01313 
<a name="l01314"></a>01314       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01315"></a>01315       <span class="comment">! increment field</span>
<a name="l01316"></a>01316       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01317"></a>01317 
<a name="l01318"></a>01318      <span class="comment">!$OMP PARALLEL DO PRIVATE(iblk,this_block,ilo,ihi,jlo,jhi,worka,workb,i,j,k,n,nct,hs)</span>
<a name="l01319"></a>01319       <span class="keyword">do</span> iblk = 1, <a class="code" href="namespaceice__domain.html#aae3d2de717ee7a743c9635b3a9e35a95">nblocks</a>
<a name="l01320"></a>01320 
<a name="l01321"></a>01321          workb(:,:) = <a class="code" href="namespaceice__state.html#a02c92db0074e9bcdb95221ca85472f20">aice_init</a>(:,:,iblk)
<a name="l01322"></a>01322 
<a name="l01323"></a>01323          this_block = <a class="code" href="namespaceice__blocks.html#aa79bfef5022683234ed1b332af17f1de">get_block</a>(<a class="code" href="namespaceice__domain.html#a152cf5087ce1dccce8f5e147306320ae">blocks_ice</a>(iblk),iblk)
<a name="l01324"></a>01324          ilo = this_block%ilo
<a name="l01325"></a>01325          ihi = this_block%ihi
<a name="l01326"></a>01326          jlo = this_block%jlo
<a name="l01327"></a>01327          jhi = this_block%jhi
<a name="l01328"></a>01328 
<a name="l01329"></a>01329          <span class="keyword">if</span> (f_hi(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01330"></a>01330             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_hi,   iblk, <a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(:,:,iblk))
<a name="l01331"></a>01331          <span class="keyword">if</span> (f_hs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01332"></a>01332             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_hs,   iblk, <a class="code" href="namespaceice__state.html#ac2427022070069eb40ad5d21ad7a684e">vsno</a>(:,:,iblk))
<a name="l01333"></a>01333          <span class="keyword">if</span> (f_Tsfc(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01334"></a>01334             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_Tsfc, iblk, <a class="code" href="namespaceice__state.html#ad9117b5d7f02ca8a6a10db8afa75a6ef">trcr</a>(:,:,<a class="code" href="namespaceice__state.html#a40b462400c0ddbc648e6aa0dd6a417b7">nt_Tsfc</a>,iblk))
<a name="l01335"></a>01335          <span class="keyword">if</span> (f_aice(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01336"></a>01336             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_aice, iblk, <a class="code" href="namespaceice__state.html#a91eaa8dd8287c9640310a0aec0a85df8">aice</a>(:,:,iblk))
<a name="l01337"></a>01337          <span class="keyword">if</span> (f_uvel(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01338"></a>01338             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_uvel, iblk, <a class="code" href="namespaceice__state.html#a74f862ad20a4ee9051006a6db77c4bc5">uvel</a>(:,:,iblk))
<a name="l01339"></a>01339          <span class="keyword">if</span> (f_vvel(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01340"></a>01340             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_vvel, iblk, <a class="code" href="namespaceice__state.html#ae19e42c4089f6a3a8426fb5847cf748e">vvel</a>(:,:,iblk))
<a name="l01341"></a>01341          <span class="keyword">if</span> (f_transix(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01342"></a>01342             worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01343"></a>01343             <span class="keyword">do</span> j = jlo, jhi
<a name="l01344"></a>01344             <span class="keyword">do</span> i = ilo, ihi
<a name="l01345"></a>01345                uee = <a class="code" href="namespaceice__constants.html#a26872e9df91fb7484a1a2ddefd7b71b0">p5</a>*(<a class="code" href="namespaceice__state.html#a74f862ad20a4ee9051006a6db77c4bc5">uvel</a>(i,j,iblk)+<a class="code" href="namespaceice__state.html#a74f862ad20a4ee9051006a6db77c4bc5">uvel</a>(i,j-1,iblk))
<a name="l01346"></a>01346                hiee = <a class="code" href="namespaceice__constants.html#a26872e9df91fb7484a1a2ddefd7b71b0">p5</a>*(<a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(i,j,iblk)+<a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(i+1,j,iblk))
<a name="l01347"></a>01347                worka(i,j) = uee*hiee*<a class="code" href="namespaceice__grid.html#a881253aa819ce18c46c4bffb3d558616">HTE</a>(i,j,iblk)*<a class="code" href="namespaceice__constants.html#ab8aa44724cb8c314b55a09244600f68d">rhoi</a>
<a name="l01348"></a>01348             <span class="keyword">enddo</span>
<a name="l01349"></a>01349             <span class="keyword">enddo</span>
<a name="l01350"></a>01350             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_transix, iblk, worka(:,:))
<a name="l01351"></a>01351          <span class="keyword">endif</span>
<a name="l01352"></a>01352          <span class="keyword">if</span> (f_transiy(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01353"></a>01353             worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01354"></a>01354             <span class="keyword">do</span> j = jlo, jhi
<a name="l01355"></a>01355             <span class="keyword">do</span> i = ilo, ihi
<a name="l01356"></a>01356                vnn = <a class="code" href="namespaceice__constants.html#a26872e9df91fb7484a1a2ddefd7b71b0">p5</a>*(<a class="code" href="namespaceice__state.html#ae19e42c4089f6a3a8426fb5847cf748e">vvel</a>(i,j,iblk)+<a class="code" href="namespaceice__state.html#ae19e42c4089f6a3a8426fb5847cf748e">vvel</a>(i-1,j,iblk))
<a name="l01357"></a>01357                hinn = <a class="code" href="namespaceice__constants.html#a26872e9df91fb7484a1a2ddefd7b71b0">p5</a>*(<a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(i,j,iblk)+<a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(i,j+1,iblk))
<a name="l01358"></a>01358                worka(i,j) = vnn*hinn*<a class="code" href="namespaceice__grid.html#a6d5e0411ab66c52d72c0bcc75f794eab">HTN</a>(i,j,iblk)*<a class="code" href="namespaceice__constants.html#ab8aa44724cb8c314b55a09244600f68d">rhoi</a>
<a name="l01359"></a>01359             <span class="keyword">enddo</span>
<a name="l01360"></a>01360             <span class="keyword">enddo</span>
<a name="l01361"></a>01361             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_transiy, iblk, worka(:,:))
<a name="l01362"></a>01362          <span class="keyword">endif</span>
<a name="l01363"></a>01363 
<a name="l01364"></a>01364          <span class="keyword">if</span> (f_fswdn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01365"></a>01365             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fswdn, iblk, <a class="code" href="namespaceice__flux.html#acc02310f399ca37f700f432975393813">fsw</a>(:,:,iblk))
<a name="l01366"></a>01366          <span class="keyword">if</span> (f_fswup(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01367"></a>01367             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fswup, iblk, &amp;
<a name="l01368"></a>01368                  (<a class="code" href="namespaceice__flux.html#acc02310f399ca37f700f432975393813">fsw</a>(:,:,iblk)-<a class="code" href="namespaceice__flux.html#af3384816a4840e4df4c79f158e6e9762">fswabs</a>(:,:,iblk)*workb(:,:)))
<a name="l01369"></a>01369          <span class="keyword">if</span> (f_flwdn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01370"></a>01370             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_flwdn, iblk, <a class="code" href="namespaceice__flux.html#a5a996f0c777a83d0532daa407dae18e5">flw</a>(:,:,iblk))
<a name="l01371"></a>01371          <span class="keyword">if</span> (f_snow(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01372"></a>01372             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_snow,  iblk, <a class="code" href="namespaceice__flux.html#ada95784733af0019d97dc30baf7511b4">fsnow</a>(:,:,iblk))
<a name="l01373"></a>01373          <span class="keyword">if</span> (f_snow_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01374"></a>01374             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_snow_ai, iblk, <a class="code" href="namespaceice__flux.html#ada95784733af0019d97dc30baf7511b4">fsnow</a>(:,:,iblk)*workb(:,:))
<a name="l01375"></a>01375          <span class="keyword">if</span> (f_rain(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01376"></a>01376             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_rain,  iblk, <a class="code" href="namespaceice__flux.html#a82a0812de1a89016e9cdb1b60e3cab05">frain</a>(:,:,iblk))
<a name="l01377"></a>01377          <span class="keyword">if</span> (f_rain_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01378"></a>01378             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_rain_ai, iblk, <a class="code" href="namespaceice__flux.html#a82a0812de1a89016e9cdb1b60e3cab05">frain</a>(:,:,iblk)*workb(:,:))
<a name="l01379"></a>01379 
<a name="l01380"></a>01380          <span class="keyword">if</span> (f_sst(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01381"></a>01381             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_sst,  iblk, <a class="code" href="namespaceice__flux.html#a760acd33d8c9c15ba312e94fc8b6cdec">sst</a>(:,:,iblk))
<a name="l01382"></a>01382          <span class="keyword">if</span> (f_sss(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01383"></a>01383             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_sss,  iblk, <a class="code" href="namespaceice__flux.html#a0549ab71dd5d6a3d23fc54b03daa9aba">sss</a>(:,:,iblk))
<a name="l01384"></a>01384          <span class="keyword">if</span> (f_uocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01385"></a>01385             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_uocn, iblk, uocn(:,:,iblk))
<a name="l01386"></a>01386          <span class="keyword">if</span> (f_vocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01387"></a>01387             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_vocn, iblk, vocn(:,:,iblk))
<a name="l01388"></a>01388          <span class="keyword">if</span> (f_frzmlt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01389"></a>01389             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_frzmlt,  iblk, <a class="code" href="namespaceice__flux.html#af09eb2a499606f27cd8ba847a999df71">frzmlt</a>(:,:,iblk))
<a name="l01390"></a>01390 
<a name="l01391"></a>01391          <span class="keyword">if</span> (f_fswfac(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01392"></a>01392             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fswfac,  iblk, <a class="code" href="namespaceice__flux.html#a848ade46ff78dbaa4ff31b24abd7bd3c">fswfac</a>(:,:,iblk))
<a name="l01393"></a>01393          <span class="keyword">if</span> (f_fswabs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01394"></a>01394             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fswabs,  iblk, <a class="code" href="namespaceice__flux.html#af3384816a4840e4df4c79f158e6e9762">fswabs</a>(:,:,iblk))
<a name="l01395"></a>01395          <span class="keyword">if</span> (f_fswabs_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01396"></a>01396             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fswabs_ai,iblk,<a class="code" href="namespaceice__flux.html#af3384816a4840e4df4c79f158e6e9762">fswabs</a>(:,:,iblk)*workb(:,:))
<a name="l01397"></a>01397 
<a name="l01398"></a>01398          <span class="keyword">if</span> (f_alvdr(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01399"></a>01399             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_alvdr,  iblk, <a class="code" href="namespaceice__flux.html#a87ebd7f059dc2e9052efba54a0d361ec">alvdr</a>(:,:,iblk))
<a name="l01400"></a>01400          <span class="keyword">if</span> (f_alidr(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01401"></a>01401             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_alidr,  iblk, <a class="code" href="namespaceice__flux.html#a43c7f22f8888770c074c9affc70d5a6b">alidr</a>(:,:,iblk))
<a name="l01402"></a>01402 
<a name="l01403"></a>01403          <span class="keyword">if</span> (f_albice (1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01404"></a>01404              call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_albice, iblk, albice(:,:,iblk))
<a name="l01405"></a>01405          <span class="keyword">if</span> (f_albsno (1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01406"></a>01406              call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_albsno, iblk, albsno(:,:,iblk))
<a name="l01407"></a>01407          <span class="keyword">if</span> (f_albpnd (1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01408"></a>01408              call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_albpnd, iblk, albpnd(:,:,iblk))
<a name="l01409"></a>01409          <span class="keyword">if</span> (f_coszen (1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01410"></a>01410              call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_coszen, iblk, <a class="code" href="namespaceice__flux.html#af909ebcaf2c2e92389a7dfce1e42f5c7">coszen</a>(:,:,iblk))
<a name="l01411"></a>01411 
<a name="l01412"></a>01412          <span class="keyword">if</span> (f_flat(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01413"></a>01413             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_flat,   iblk, <a class="code" href="namespaceice__flux.html#ab2d967d4946f473fc077416bdd6cd13f">flat</a>(:,:,iblk))
<a name="l01414"></a>01414          <span class="keyword">if</span> (f_flat_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01415"></a>01415             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_flat_ai,iblk, <a class="code" href="namespaceice__flux.html#ab2d967d4946f473fc077416bdd6cd13f">flat</a>(:,:,iblk)*workb(:,:))
<a name="l01416"></a>01416          <span class="keyword">if</span> (f_fsens(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01417"></a>01417             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fsens,   iblk, <a class="code" href="namespaceice__flux.html#ad76df6df986573fcb622fb418d960f37">fsens</a>(:,:,iblk))
<a name="l01418"></a>01418          <span class="keyword">if</span> (f_fsens_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01419"></a>01419             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fsens_ai,iblk, <a class="code" href="namespaceice__flux.html#ad76df6df986573fcb622fb418d960f37">fsens</a>(:,:,iblk)*workb(:,:))
<a name="l01420"></a>01420          <span class="keyword">if</span> (f_flwup(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01421"></a>01421             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_flwup,   iblk, <a class="code" href="namespaceice__flux.html#a1ec39d9db775aa2496c0c0ad3ab9c8e4">flwout</a>(:,:,iblk))
<a name="l01422"></a>01422          <span class="keyword">if</span> (f_flwup_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01423"></a>01423             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_flwup_ai,iblk, <a class="code" href="namespaceice__flux.html#a1ec39d9db775aa2496c0c0ad3ab9c8e4">flwout</a>(:,:,iblk)*workb(:,:))
<a name="l01424"></a>01424          <span class="keyword">if</span> (f_evap(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01425"></a>01425             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_evap,   iblk, <a class="code" href="namespaceice__flux.html#abfe856f2125b879db70ba8a8a43aaefd">evap</a>(:,:,iblk))
<a name="l01426"></a>01426          <span class="keyword">if</span> (f_evap_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01427"></a>01427             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_evap_ai,iblk, <a class="code" href="namespaceice__flux.html#abfe856f2125b879db70ba8a8a43aaefd">evap</a>(:,:,iblk)*workb(:,:))
<a name="l01428"></a>01428 
<a name="l01429"></a>01429          <span class="keyword">if</span> (f_Tair(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01430"></a>01430             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_Tair,   iblk, <a class="code" href="namespaceice__flux.html#add98ec71fa0c35dbd9a7afcfa897081d">Tair</a>(:,:,iblk))
<a name="l01431"></a>01431          <span class="keyword">if</span> (f_Tref(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01432"></a>01432             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_Tref,   iblk, <a class="code" href="namespaceice__flux.html#a6a0b5fa95bab43f29f8cbd6cbd8f047f">Tref</a>(:,:,iblk))
<a name="l01433"></a>01433          <span class="keyword">if</span> (f_Qref(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01434"></a>01434             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_Qref,   iblk, <a class="code" href="namespaceice__flux.html#ac332e72481b7da42322f9e2581f09434">Qref</a>(:,:,iblk))
<a name="l01435"></a>01435          <span class="keyword">if</span> (f_congel(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01436"></a>01436             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_congel, iblk, <a class="code" href="namespaceice__flux.html#acb44c9e01061e258c35b8dbadf412741">congel</a>(:,:,iblk))
<a name="l01437"></a>01437          <span class="keyword">if</span> (f_frazil(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01438"></a>01438             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_frazil, iblk, <a class="code" href="namespaceice__flux.html#a5e63c63db5a472f4041fc150316b8c67">frazil</a>(:,:,iblk))
<a name="l01439"></a>01439          <span class="keyword">if</span> (f_snoice(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01440"></a>01440             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_snoice, iblk, <a class="code" href="namespaceice__flux.html#a081cc6f264496624fb6bce9e69e74d9c">snoice</a>(:,:,iblk))
<a name="l01441"></a>01441          <span class="keyword">if</span> (f_meltt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01442"></a>01442             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_meltt, iblk, <a class="code" href="namespaceice__flux.html#aa99daffd05f84f37a6036ce5901100af">meltt</a>(:,:,iblk))
<a name="l01443"></a>01443          <span class="keyword">if</span> (f_meltb(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01444"></a>01444             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_meltb, iblk, <a class="code" href="namespaceice__flux.html#acdba57f616cfb780f910b8214a5b6121">meltb</a>(:,:,iblk))
<a name="l01445"></a>01445          <span class="keyword">if</span> (f_meltl(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01446"></a>01446             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_meltl, iblk, <a class="code" href="namespaceice__flux.html#a6aafbe05e11bff91bc937c605cf9d121">meltl</a>(:,:,iblk))
<a name="l01447"></a>01447          <span class="keyword">if</span> (f_melts(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01448"></a>01448             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_melts, iblk, <a class="code" href="namespaceice__flux.html#aae0e112fe38b436d979dc7fe86cdcb8f">melts</a>(:,:,iblk))
<a name="l01449"></a>01449 
<a name="l01450"></a>01450          <span class="keyword">if</span> (f_fresh(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01451"></a>01451             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fresh, iblk, <a class="code" href="namespaceice__flux.html#adbdb875a7e468b890dba7204d972c05a">fresh</a>(:,:,iblk))
<a name="l01452"></a>01452          <span class="keyword">if</span> (f_fresh_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01453"></a>01453             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fresh_ai,iblk, <a class="code" href="namespaceice__flux.html#a962d1e42294e09b10fb22bc3554aa71b">fresh_gbm</a>(:,:,iblk))
<a name="l01454"></a>01454          <span class="keyword">if</span> (f_fsalt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01455"></a>01455             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fsalt, iblk, <a class="code" href="namespaceice__flux.html#a93da98d35da9e23e802edb93bcaf7477">fsalt</a>(:,:,iblk))
<a name="l01456"></a>01456          <span class="keyword">if</span> (f_fsalt_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01457"></a>01457             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fsalt_ai,iblk, <a class="code" href="namespaceice__flux.html#ac48af307927403704bd7ad20cb0d54b3">fsalt_gbm</a>(:,:,iblk))
<a name="l01458"></a>01458          <span class="keyword">if</span> (f_fhocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01459"></a>01459             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fhocn, iblk, <a class="code" href="namespaceice__flux.html#ad13e4555d29196de5e5e1130432c5a3a">fhocn</a>(:,:,iblk))
<a name="l01460"></a>01460          <span class="keyword">if</span> (f_fhocn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01461"></a>01461             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fhocn_ai,iblk, <a class="code" href="namespaceice__flux.html#a0262e88be5633673703d664fdb6e5123">fhocn_gbm</a>(:,:,iblk))
<a name="l01462"></a>01462          <span class="keyword">if</span> (f_fswthru(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01463"></a>01463             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fswthru, iblk, <a class="code" href="namespaceice__flux.html#a2b935c4127f16509133036f6cf544794">fswthru</a>(:,:,iblk))
<a name="l01464"></a>01464          <span class="keyword">if</span> (f_fswthru_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01465"></a>01465             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fswthru_ai,iblk, <a class="code" href="namespaceice__flux.html#ac9af65dc6cf70d6aed3b1eafc170c7a4">fswthru_gbm</a>(:,:,iblk))
<a name="l01466"></a>01466                
<a name="l01467"></a>01467          <span class="keyword">if</span> (f_strairx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01468"></a>01468             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strairx, iblk, <a class="code" href="namespaceice__flux.html#aee8a0e6c9637760d2b7153f40ffe0dc1">strairx</a>(:,:,iblk))
<a name="l01469"></a>01469          <span class="keyword">if</span> (f_strairy(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01470"></a>01470             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strairy, iblk, <a class="code" href="namespaceice__flux.html#af29d53fccf8950eaca0c31ea018640aa">strairy</a>(:,:,iblk))
<a name="l01471"></a>01471          <span class="keyword">if</span> (f_strtltx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01472"></a>01472             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strtltx, iblk, <a class="code" href="namespaceice__flux.html#a1380a09740e78ddbcc3abe4edc2b3e2f">strtltx</a>(:,:,iblk))
<a name="l01473"></a>01473          <span class="keyword">if</span> (f_strtlty(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01474"></a>01474             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strtlty, iblk, <a class="code" href="namespaceice__flux.html#ac9c1e92371b4e39d2aa9f38548b011ff">strtlty</a>(:,:,iblk))
<a name="l01475"></a>01475          <span class="keyword">if</span> (f_strcorx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01476"></a>01476             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strcorx, iblk, <a class="code" href="namespaceice__flux.html#aa2cb3a98eac5adcd5441f55fe26be618">fm</a>(:,:,iblk)*<a class="code" href="namespaceice__state.html#ae19e42c4089f6a3a8426fb5847cf748e">vvel</a>(:,:,iblk))
<a name="l01477"></a>01477          <span class="keyword">if</span> (f_strcory(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01478"></a>01478             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strcory, iblk,-<a class="code" href="namespaceice__flux.html#aa2cb3a98eac5adcd5441f55fe26be618">fm</a>(:,:,iblk)*<a class="code" href="namespaceice__state.html#a74f862ad20a4ee9051006a6db77c4bc5">uvel</a>(:,:,iblk))
<a name="l01479"></a>01479          <span class="keyword">if</span> (f_strocnx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01480"></a>01480             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strocnx, iblk, <a class="code" href="namespaceice__flux.html#a3302aaf2e5a99949808d98b685228ecf">strocnx</a>(:,:,iblk))
<a name="l01481"></a>01481          <span class="keyword">if</span> (f_strocny(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01482"></a>01482             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strocny, iblk, <a class="code" href="namespaceice__flux.html#a0e146ebf56010398ef99ba1539dbc1ce">strocny</a>(:,:,iblk))
<a name="l01483"></a>01483          <span class="keyword">if</span> (f_strintx(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01484"></a>01484             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strintx, iblk, <a class="code" href="namespaceice__flux.html#aff350f7a31d4c9cc9429ef1a14d1c91f">strintx</a>(:,:,iblk))
<a name="l01485"></a>01485          <span class="keyword">if</span> (f_strinty(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01486"></a>01486             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strinty, iblk, <a class="code" href="namespaceice__flux.html#a8bfac55007c715a028b0ac9b8e9daed5">strinty</a>(:,:,iblk))
<a name="l01487"></a>01487          <span class="keyword">if</span> (f_strength(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01488"></a>01488             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_strength, iblk, <a class="code" href="namespaceice__state.html#a4f093119aa04b4e413418f77e12f0cf6">strength</a>(:,:,iblk))
<a name="l01489"></a>01489 
<a name="l01490"></a>01490 <span class="comment">! The following fields (divu, shear, sig1, and sig2) will be smeared</span>
<a name="l01491"></a>01491 <span class="comment">!  if averaged over more than a few days.</span>
<a name="l01492"></a>01492 <span class="comment">! Snapshots may be more useful (see below).</span>
<a name="l01493"></a>01493 
<a name="l01494"></a>01494 <span class="comment">! Need divu and shear as monthly means for IPCC/CMIP.</span>
<a name="l01495"></a>01495          <span class="keyword">if</span> (f_divu(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01496"></a>01496             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_divu, iblk, <a class="code" href="namespaceice__state.html#a1d4ddf61ed16b9ab3bf546bfb006628b">divu</a>(:,:,iblk))
<a name="l01497"></a>01497          <span class="keyword">if</span> (f_shear(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01498"></a>01498             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_shear, iblk, <a class="code" href="namespaceice__state.html#aac4fe23f1dbcb435f711d8446d83dcca">shear</a>(:,:,iblk))
<a name="l01499"></a>01499 <span class="comment">!        if (f_sig1(1:1) /= &apos;x&apos;) &amp;</span>
<a name="l01500"></a>01500 <span class="comment">!           call accum_hist_field(n_sig1, iblk, sig1(:,:,iblk))</span>
<a name="l01501"></a>01501 <span class="comment">!        if (f_sig2(1:1) /= &apos;x&apos;) &amp;</span>
<a name="l01502"></a>01502 <span class="comment">!           call accum_hist_field(n_sig2, iblk, sig2(:,:,iblk))</span>
<a name="l01503"></a>01503 
<a name="l01504"></a>01504          <span class="keyword">if</span> (f_dvidtt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01505"></a>01505             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_dvidtt, iblk, <a class="code" href="namespaceice__flux.html#a7c8b98f21bf9431f5d2a10d6643f0752">dvidtt</a>(:,:,iblk))
<a name="l01506"></a>01506          <span class="keyword">if</span> (f_dvidtd(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01507"></a>01507             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_dvidtd, iblk, <a class="code" href="namespaceice__flux.html#ab2731d6607c7b88522d1a843d4a38a50">dvidtd</a>(:,:,iblk))
<a name="l01508"></a>01508          <span class="keyword">if</span> (f_daidtt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01509"></a>01509             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_daidtt, iblk, <a class="code" href="namespaceice__flux.html#aff988ec903f1e7908e7b8a176ea792ed">daidtt</a>(:,:,iblk))
<a name="l01510"></a>01510          <span class="keyword">if</span> (f_daidtd(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01511"></a>01511             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_daidtd, iblk, <a class="code" href="namespaceice__flux.html#a24c9cd15dee4efbf6d35e4bafb03a6e0">daidtd</a>(:,:,iblk))
<a name="l01512"></a>01512 
<a name="l01513"></a>01513          <span class="keyword">if</span> (f_opening(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01514"></a>01514             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_opening, iblk, <a class="code" href="namespaceice__flux.html#ae0a39366aa114290bad9340508d55fd7">opening</a>(:,:,iblk))
<a name="l01515"></a>01515          <span class="keyword">if</span> (f_dardg1dt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01516"></a>01516             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_dardg1dt, iblk, <a class="code" href="namespaceice__flux.html#ac0303bfce72171bb93ea1a621dc453eb">dardg1dt</a>(:,:,iblk))
<a name="l01517"></a>01517          <span class="keyword">if</span> (f_dardg2dt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01518"></a>01518             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_dardg2dt, iblk, <a class="code" href="namespaceice__flux.html#a8d3dec0f51ebd0b3aaf71909b190656a">dardg2dt</a>(:,:,iblk))
<a name="l01519"></a>01519          <span class="keyword">if</span> (f_dvirdgdt(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01520"></a>01520             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_dvirdgdt, iblk, <a class="code" href="namespaceice__flux.html#ade5480c0fdf0d8989ec199ab6c494df2">dvirdgdt</a>(:,:,iblk))
<a name="l01521"></a>01521 
<a name="l01522"></a>01522          <span class="keyword">if</span> (f_fsurf_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01523"></a>01523             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fsurf_ai, iblk, <a class="code" href="namespaceice__flux.html#a27dbd3d1fc36c0ddb4c39c806d935775">fsurf</a>(:,:,iblk)*workb(:,:))
<a name="l01524"></a>01524          <span class="keyword">if</span> (f_fcondtop_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01525"></a>01525             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fcondtop_ai, iblk, &amp;
<a name="l01526"></a>01526                                                  <a class="code" href="namespaceice__flux.html#a0ba73c84e3792cf8704a33f6d95e7f95">fcondtop</a>(:,:,iblk)*workb(:,:))
<a name="l01527"></a>01527 
<a name="l01528"></a>01528          <span class="keyword">if</span> (f_icepresent(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01529"></a>01529            worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01530"></a>01530            <span class="keyword">do</span> j = jlo, jhi
<a name="l01531"></a>01531            <span class="keyword">do</span> i = ilo, ihi
<a name="l01532"></a>01532               <span class="keyword">if</span> (<a class="code" href="namespaceice__state.html#a91eaa8dd8287c9640310a0aec0a85df8">aice</a>(i,j,iblk) &gt; <a class="code" href="namespaceice__constants.html#af5d2a72e22e7a53706b6a41ba932a67d">puny</a>) worka(i,j) = <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>
<a name="l01533"></a>01533            <span class="keyword">enddo</span>
<a name="l01534"></a>01534            <span class="keyword">enddo</span>
<a name="l01535"></a>01535            call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_icepresent, iblk, worka(:,:))
<a name="l01536"></a>01536          <span class="keyword">endif</span>
<a name="l01537"></a>01537 
<a name="l01538"></a>01538          nct = min(ncat, <a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>)
<a name="l01539"></a>01539          <span class="keyword">do</span> n=1,nct
<a name="l01540"></a>01540             workb(:,:) = <a class="code" href="namespaceice__state.html#abbaa812633c91cc57a5bad8a2b43920a">aicen_init</a>(:,:,n,iblk)
<a name="l01541"></a>01541             <span class="keyword">if</span> (f_aicen(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01542"></a>01542                call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a31b00fc2e404e255f40cfa9144865c6f">n_aicen</a>(n,:), iblk, <a class="code" href="namespaceice__state.html#a38df7a3870d9a3a425b31808503ba98e">aicen</a>(:,:,n,iblk))
<a name="l01543"></a>01543             <span class="keyword">if</span> (f_vicen(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01544"></a>01544                call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#afd312fa27e4e7c7979312795eaed3435">n_vicen</a>(n,:), iblk, <a class="code" href="namespaceice__state.html#aa85616e03769af4afb0166070aa7cc8f">vicen</a>(:,:,n,iblk))
<a name="l01545"></a>01545             <span class="keyword">if</span> (f_apondn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01546"></a>01546                call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a4d3b9e888569b2534dbceeaf3292b696">n_apondn</a>(n,:), iblk, <a class="code" href="namespaceice__state.html#aa2d9beee38aa0717dea2399d060d236d">apondn</a>(:,:,n,iblk))
<a name="l01547"></a>01547             <span class="keyword">if</span> (f_fsurfn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01548"></a>01548                call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a547e15c8d6d1890d8acb698c12ca6583">n_fsurfn_ai</a>(n,:), iblk, &amp;
<a name="l01549"></a>01549                <a class="code" href="namespaceice__flux.html#aa05e0fe10c9628c94efe017d79f0cd1e">fsurfn</a>(:,:,n,iblk)*workb(:,:))
<a name="l01550"></a>01550             <span class="keyword">if</span> (f_fcondtopn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01551"></a>01551                call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a277bf94595092110d32c0719616159fc">n_fcondtopn_ai</a>(n,:), iblk, &amp;
<a name="l01552"></a>01552                <a class="code" href="namespaceice__flux.html#a0f22ed9bcb531d5ea26305f27ed19d05">fcondtopn</a>(:,:,n,iblk)*workb(:,:))
<a name="l01553"></a>01553             <span class="keyword">if</span> (f_flatn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01554"></a>01554                call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#aeea32af91b4549502cf55fa0b93f1778">n_flatn_ai</a>(n,:), iblk, &amp;
<a name="l01555"></a>01555                <a class="code" href="namespaceice__flux.html#a43363f554cd27a966c89394ce573135e">flatn</a>(:,:,n,iblk)*workb(:,:))
<a name="l01556"></a>01556             <span class="comment">! Calculate surface heat flux that causes melt as this</span>
<a name="l01557"></a>01557             <span class="comment">! is what is calculated by the atmos in HadGEM3 so</span>
<a name="l01558"></a>01558             <span class="comment">! needed for checking purposes</span>
<a name="l01559"></a>01559             <span class="keyword">if</span> (f_fmelttn_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) &amp;
<a name="l01560"></a>01560                call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a950d3a5fcd1b660e07bdea0c7d67cecb">n_fmelttn_ai</a>(n,:), iblk, &amp;
<a name="l01561"></a>01561                max(<a class="code" href="namespaceice__flux.html#aa05e0fe10c9628c94efe017d79f0cd1e">fsurfn</a>(:,:,n,iblk) - <a class="code" href="namespaceice__flux.html#a0f22ed9bcb531d5ea26305f27ed19d05">fcondtopn</a>(:,:,n,iblk),<a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>)*workb(:,:))
<a name="l01562"></a>01562         <span class="keyword">enddo</span>                    <span class="comment">! n</span>
<a name="l01563"></a>01563         <span class="keyword">if</span> (f_fs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01564"></a>01564            worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01565"></a>01565            nct = min(ncat, <a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>)
<a name="l01566"></a>01566            <span class="keyword">do</span> n=1,nct
<a name="l01567"></a>01567               workb(:,:) = <a class="code" href="namespaceice__state.html#abbaa812633c91cc57a5bad8a2b43920a">aicen_init</a>(:,:,n,iblk)
<a name="l01568"></a>01568               <span class="keyword">do</span> j = jlo, jhi
<a name="l01569"></a>01569               <span class="keyword">do</span> i = ilo, ihi
<a name="l01570"></a>01570                  hs = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01571"></a>01571                  <span class="keyword">if</span> (workb(i,j) &gt; <a class="code" href="namespaceice__constants.html#af5d2a72e22e7a53706b6a41ba932a67d">puny</a>) &amp;
<a name="l01572"></a>01572                     hs = <a class="code" href="namespaceice__state.html#acd313a058964928092cbc75f7689cef5">vsnon</a>(i,j,n,iblk)/workb(i,j)
<a name="l01573"></a>01573                  <span class="keyword">if</span> (hs &gt;= <a class="code" href="namespaceice__constants.html#aabb18cc60f80f91072acd8182b2776af">hsmin</a>) &amp;
<a name="l01574"></a>01574                     worka(i,j) = worka(i,j) + workb(i,j)*min( hs/<a class="code" href="namespaceice__constants.html#afb193f4389586bacd30b4382b1ca21c5">hs0</a>, <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a> )
<a name="l01575"></a>01575               <span class="keyword">enddo</span>
<a name="l01576"></a>01576               <span class="keyword">enddo</span>
<a name="l01577"></a>01577            <span class="keyword">enddo</span>
<a name="l01578"></a>01578            call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_fs, iblk, worka(:,:))
<a name="l01579"></a>01579         <span class="keyword">endif</span>
<a name="l01580"></a>01580         <span class="comment">! Compute the internal heat content (enthalpy) of the ice </span>
<a name="l01581"></a>01581         <span class="keyword">if</span> (f_qi(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01582"></a>01582            worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01583"></a>01583            nct = min(ncat, <a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>)
<a name="l01584"></a>01584            <span class="keyword">do</span> n=1,nct
<a name="l01585"></a>01585               workb(:,:) = <a class="code" href="namespaceice__state.html#abbaa812633c91cc57a5bad8a2b43920a">aicen_init</a>(:,:,n,iblk)
<a name="l01586"></a>01586               <span class="keyword">do</span> k=1,nilyr
<a name="l01587"></a>01587                  <span class="keyword">do</span> j = jlo, jhi
<a name="l01588"></a>01588                  <span class="keyword">do</span> i = ilo, ihi
<a name="l01589"></a>01589                     qi = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01590"></a>01590                     <span class="keyword">if</span> (<a class="code" href="namespaceice__state.html#aa85616e03769af4afb0166070aa7cc8f">vicen</a>(i,j,n,iblk) &gt; <a class="code" href="namespaceice__constants.html#af5d2a72e22e7a53706b6a41ba932a67d">puny</a>) &amp;
<a name="l01591"></a>01591                        qi = <a class="code" href="namespaceice__state.html#ae98b075caabb73fcd86ce51eb76849b4">eicen</a>(i,j,ilyr1(n)+k-1,iblk)*<a class="code" href="namespaceice__grid.html#af9d3e2476e44dd679c4062b370f21ffa">tarea</a>(i,j,iblk)
<a name="l01592"></a>01592                     worka(i,j) = worka(i,j) + workb(i,j)*qi
<a name="l01593"></a>01593                  <span class="keyword">enddo</span>
<a name="l01594"></a>01594                  <span class="keyword">enddo</span>
<a name="l01595"></a>01595               <span class="keyword">enddo</span>
<a name="l01596"></a>01596            <span class="keyword">enddo</span>
<a name="l01597"></a>01597            call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_qi, iblk, worka(:,:))
<a name="l01598"></a>01598          <span class="keyword">endif</span>
<a name="l01599"></a>01599         <span class="comment">! Compute the internal heat content (enthalpy) of the snow</span>
<a name="l01600"></a>01600          <span class="keyword">if</span> (f_qs(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01601"></a>01601             worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01602"></a>01602             nct = min(ncat, <a class="code" href="namespaceice__history__fields.html#ad4675933f882f223e8ec25c5c938b13e">ncat_hist</a>)
<a name="l01603"></a>01603             <span class="keyword">do</span> n=1,nct
<a name="l01604"></a>01604               workb(:,:) = <a class="code" href="namespaceice__state.html#abbaa812633c91cc57a5bad8a2b43920a">aicen_init</a>(:,:,n,iblk)
<a name="l01605"></a>01605                <span class="keyword">do</span> k=1,nslyr
<a name="l01606"></a>01606                   <span class="keyword">do</span> j = jlo, jhi
<a name="l01607"></a>01607                   <span class="keyword">do</span> i = ilo, ihi
<a name="l01608"></a>01608                      qs = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01609"></a>01609                      <span class="keyword">if</span> (<a class="code" href="namespaceice__state.html#acd313a058964928092cbc75f7689cef5">vsnon</a>(i,j,n,iblk) &gt; <a class="code" href="namespaceice__constants.html#af5d2a72e22e7a53706b6a41ba932a67d">puny</a>) &amp;
<a name="l01610"></a>01610                         qs = <a class="code" href="namespaceice__state.html#aeb23ce1b6f981d016e447371d318a10c">esnon</a>(i,j,slyr1(n)+k-1,iblk)*<a class="code" href="namespaceice__grid.html#af9d3e2476e44dd679c4062b370f21ffa">tarea</a>(i,j,iblk)
<a name="l01611"></a>01611                      worka(i,j) = worka(i,j) + workb(i,j)*qs
<a name="l01612"></a>01612                   <span class="keyword">enddo</span>
<a name="l01613"></a>01613                   <span class="keyword">enddo</span>
<a name="l01614"></a>01614                <span class="keyword">enddo</span>
<a name="l01615"></a>01615             <span class="keyword">enddo</span>
<a name="l01616"></a>01616             call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(n_qs, iblk, worka(:,:))
<a name="l01617"></a>01617          <span class="keyword">endif</span>
<a name="l01618"></a>01618 
<a name="l01619"></a>01619         <span class="comment">! Calculate aggregate melt pond area by summing category values</span>
<a name="l01620"></a>01620         <span class="keyword">if</span> (f_apond(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01621"></a>01621            <span class="keyword">do</span> ns=1, nstreams
<a name="l01622"></a>01622               <span class="keyword">if</span> (n_apond(ns) /= 0) <span class="keyword">then</span>
<a name="l01623"></a>01623                  worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01624"></a>01624                  <span class="keyword">do</span> j = jlo, jhi
<a name="l01625"></a>01625                  <span class="keyword">do</span> i = ilo, ihi
<a name="l01626"></a>01626                   <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#a5de6731a3b8601be3495a4c306832bf0">tmask</a>(i,j,iblk)) <span class="keyword">then</span>
<a name="l01627"></a>01627                     <span class="keyword">do</span> n=1,nct
<a name="l01628"></a>01628                        worka(i,j)  = worka(i,j) + <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,<a class="code" href="namespaceice__history__fields.html#a4d3b9e888569b2534dbceeaf3292b696">n_apondn</a>(n,ns),iblk)
<a name="l01629"></a>01629                     <span class="keyword">enddo</span>            <span class="comment">! n</span>
<a name="l01630"></a>01630                   <span class="keyword">endif</span>              <span class="comment">! tmask</span>
<a name="l01631"></a>01631                  <span class="keyword">enddo</span>                <span class="comment">! i</span>
<a name="l01632"></a>01632                  <span class="keyword">enddo</span>                <span class="comment">! j</span>
<a name="l01633"></a>01633                  <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(:,:,n_apond(ns),iblk) = worka(:,:)
<a name="l01634"></a>01634               <span class="keyword">endif</span>
<a name="l01635"></a>01635            <span class="keyword">enddo</span>
<a name="l01636"></a>01636         <span class="keyword">endif</span>
<a name="l01637"></a>01637         <span class="comment">! Calculate aggregate surface melt flux by summing category values</span>
<a name="l01638"></a>01638         <span class="keyword">if</span> (f_fmeltt_ai(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01639"></a>01639            <span class="keyword">do</span> ns=1, nstreams
<a name="l01640"></a>01640               <span class="keyword">if</span> (n_fmeltt_ai(ns) /= 0) <span class="keyword">then</span>
<a name="l01641"></a>01641                  worka(:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01642"></a>01642                  <span class="keyword">do</span> j = jlo, jhi
<a name="l01643"></a>01643                  <span class="keyword">do</span> i = ilo, ihi
<a name="l01644"></a>01644                   <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#a5de6731a3b8601be3495a4c306832bf0">tmask</a>(i,j,iblk)) <span class="keyword">then</span>
<a name="l01645"></a>01645                     <span class="keyword">do</span> n=1,nct
<a name="l01646"></a>01646                        worka(i,j) = worka(i,j) + <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,<a class="code" href="namespaceice__history__fields.html#a950d3a5fcd1b660e07bdea0c7d67cecb">n_fmelttn_ai</a>(n,ns),iblk)
<a name="l01647"></a>01647                     <span class="keyword">enddo</span>            <span class="comment">! n</span>
<a name="l01648"></a>01648                   <span class="keyword">endif</span>              <span class="comment">! tmask</span>
<a name="l01649"></a>01649                  <span class="keyword">enddo</span>                <span class="comment">! i</span>
<a name="l01650"></a>01650                  <span class="keyword">enddo</span>                <span class="comment">! j</span>
<a name="l01651"></a>01651                  <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(:,:,n_fmeltt_ai(ns),iblk) = worka(:,:)
<a name="l01652"></a>01652               <span class="keyword">endif</span>
<a name="l01653"></a>01653            <span class="keyword">enddo</span>
<a name="l01654"></a>01654         <span class="keyword">endif</span>
<a name="l01655"></a>01655 
<a name="l01656"></a>01656         <span class="comment">! Aerosols</span>
<a name="l01657"></a>01657 
<a name="l01658"></a>01658         <span class="keyword">if</span> (f_faero_atm(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01659"></a>01659            <span class="keyword">do</span> n=1,n_aero
<a name="l01660"></a>01660               call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ac09149d16d9045cc266eff8a26ff0d97">n_faero_atm</a>(n,:), iblk, &amp;
<a name="l01661"></a>01661                                     <a class="code" href="namespaceice__flux.html#ad99dce71f61486e2450ba1fc5318abb9">faero</a>(:,:,n,iblk))
<a name="l01662"></a>01662            <span class="keyword">enddo</span>
<a name="l01663"></a>01663         <span class="keyword">endif</span>
<a name="l01664"></a>01664 
<a name="l01665"></a>01665         <span class="keyword">if</span> (f_faero_ocn(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01666"></a>01666            <span class="keyword">do</span> n=1,n_aero
<a name="l01667"></a>01667               call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ae402016c2d3706af277fb399ec8f5ec6">n_faero_ocn</a>(n,:), iblk, &amp;
<a name="l01668"></a>01668                                     <a class="code" href="namespaceice__flux.html#a7b0cfe6f97cfa89da6c797550ce6c4f0">fsoot</a>(:,:,n,iblk))
<a name="l01669"></a>01669            <span class="keyword">enddo</span>
<a name="l01670"></a>01670         <span class="keyword">endif</span>
<a name="l01671"></a>01671 
<a name="l01672"></a>01672         <span class="keyword">if</span> (f_aero(1:1) /= <span class="stringliteral">&apos;x&apos;</span>) <span class="keyword">then</span>
<a name="l01673"></a>01673            <span class="keyword">do</span> n=1,n_aero
<a name="l01674"></a>01674               call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#afb0db2f3c0c14963f02057fbc84887bc">n_aerosn1</a>(n,:), iblk, &amp;
<a name="l01675"></a>01675                                  <a class="code" href="namespaceice__state.html#ad9117b5d7f02ca8a6a10db8afa75a6ef">trcr</a>(:,:,<a class="code" href="namespaceice__state.html#a17498b6cf9c7353f2704a5cd0b579718">nt_aero</a>  +4*(n-1),iblk)/<a class="code" href="namespaceice__constants.html#ae2404a45dc46ecdb371055dd52dcfe1f">rhos</a>)
<a name="l01676"></a>01676               call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#a4c7ca26f7fe5c329bea1bd5e4a301eed">n_aerosn2</a>(n,:), iblk, &amp;
<a name="l01677"></a>01677                                  <a class="code" href="namespaceice__state.html#ad9117b5d7f02ca8a6a10db8afa75a6ef">trcr</a>(:,:,<a class="code" href="namespaceice__state.html#a17498b6cf9c7353f2704a5cd0b579718">nt_aero</a>+1+4*(n-1),iblk)/<a class="code" href="namespaceice__constants.html#ae2404a45dc46ecdb371055dd52dcfe1f">rhos</a>)
<a name="l01678"></a>01678               call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ad6f36fcab3ebeaa42f44b63a39474c4a">n_aeroic1</a>(n,:), iblk, &amp;
<a name="l01679"></a>01679                                  <a class="code" href="namespaceice__state.html#ad9117b5d7f02ca8a6a10db8afa75a6ef">trcr</a>(:,:,<a class="code" href="namespaceice__state.html#a17498b6cf9c7353f2704a5cd0b579718">nt_aero</a>+2+4*(n-1),iblk)/<a class="code" href="namespaceice__constants.html#ab8aa44724cb8c314b55a09244600f68d">rhoi</a>)
<a name="l01680"></a>01680               call <a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(<a class="code" href="namespaceice__history__fields.html#ac48a9741b1cf192db287c558cb4fadb4">n_aeroic2</a>(n,:), iblk, &amp;
<a name="l01681"></a>01681                                  <a class="code" href="namespaceice__state.html#ad9117b5d7f02ca8a6a10db8afa75a6ef">trcr</a>(:,:,<a class="code" href="namespaceice__state.html#a17498b6cf9c7353f2704a5cd0b579718">nt_aero</a>+3+4*(n-1),iblk)/<a class="code" href="namespaceice__constants.html#ab8aa44724cb8c314b55a09244600f68d">rhoi</a>)
<a name="l01682"></a>01682            <span class="keyword">enddo</span>
<a name="l01683"></a>01683         <span class="keyword">endif</span>
<a name="l01684"></a>01684 
<a name="l01685"></a>01685       <span class="keyword">enddo</span>                     <span class="comment">! iblk</span>
<a name="l01686"></a>01686       <span class="comment">!$OMP END PARALLEL DO</span>
<a name="l01687"></a>01687 
<a name="l01688"></a>01688       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01689"></a>01689       <span class="comment">! Write output files at prescribed intervals</span>
<a name="l01690"></a>01690       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01691"></a>01691 
<a name="l01692"></a>01692       nstrm = nstreams
<a name="l01693"></a>01693       <span class="keyword">if</span> (write_ic) nstrm = 1
<a name="l01694"></a>01694 
<a name="l01695"></a>01695       <span class="keyword">do</span> ns = 1, nstrm
<a name="l01696"></a>01696 
<a name="l01697"></a>01697       <span class="keyword">if</span> (<a class="code" href="namespaceice__calendar.html#a610c4039b3869befd73705569c033bef">write_history</a>(ns) .or. write_ic) <span class="keyword">then</span>
<a name="l01698"></a>01698 
<a name="l01699"></a>01699       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01700"></a>01700       <span class="comment">! Mask out land points and convert units </span>
<a name="l01701"></a>01701       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01702"></a>01702 
<a name="l01703"></a>01703         ravgct = <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>/<a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns)
<a name="l01704"></a>01704         <span class="comment">!$OMP PARALLEL DO PRIVATE(iblk,this_block,ilo,ihi,jlo,jhi,i,j,k)</span>
<a name="l01705"></a>01705         <span class="keyword">do</span> iblk = 1, <a class="code" href="namespaceice__domain.html#aae3d2de717ee7a743c9635b3a9e35a95">nblocks</a>
<a name="l01706"></a>01706            this_block = <a class="code" href="namespaceice__blocks.html#aa79bfef5022683234ed1b332af17f1de">get_block</a>(<a class="code" href="namespaceice__domain.html#a152cf5087ce1dccce8f5e147306320ae">blocks_ice</a>(iblk),iblk)         
<a name="l01707"></a>01707            ilo = this_block%ilo
<a name="l01708"></a>01708            ihi = this_block%ihi
<a name="l01709"></a>01709            jlo = this_block%jlo
<a name="l01710"></a>01710            jhi = this_block%jhi
<a name="l01711"></a>01711 
<a name="l01712"></a>01712            <span class="keyword">do</span> k = 1, <a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a>
<a name="l01713"></a>01713 
<a name="l01714"></a>01714               <span class="keyword">if</span> (<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(k)%vhistfreq == histfreq(ns)) <span class="keyword">then</span>
<a name="l01715"></a>01715 
<a name="l01716"></a>01716                  <span class="keyword">do</span> j = jlo, jhi
<a name="l01717"></a>01717                  <span class="keyword">do</span> i = ilo, ihi
<a name="l01718"></a>01718                     <span class="keyword">if</span> (.not. <a class="code" href="namespaceice__grid.html#a5de6731a3b8601be3495a4c306832bf0">tmask</a>(i,j,iblk)) <span class="keyword">then</span> <span class="comment">! mask out land points</span>
<a name="l01719"></a>01719                        <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,k,iblk) = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01720"></a>01720                     <span class="keyword">else</span>                            <span class="comment">! convert units</span>
<a name="l01721"></a>01721                        <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,k,iblk) &amp;
<a name="l01722"></a>01722                           = <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(k)%cona*<a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,k,iblk) &amp;
<a name="l01723"></a>01723                           * ravgct + <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(k)%conb
<a name="l01724"></a>01724                     <span class="keyword">endif</span>
<a name="l01725"></a>01725                  <span class="keyword">enddo</span>             <span class="comment">! i</span>
<a name="l01726"></a>01726                  <span class="keyword">enddo</span>             <span class="comment">! j</span>
<a name="l01727"></a>01727 
<a name="l01728"></a>01728                  <span class="comment">! back out albedo/zenith angle dependence</span>
<a name="l01729"></a>01729                  <span class="keyword">if</span> (<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(k)%vname == <span class="stringliteral">&apos;albice&apos;</span>) <span class="keyword">then</span>
<a name="l01730"></a>01730                     <span class="keyword">do</span> j = jlo, jhi
<a name="l01731"></a>01731                     <span class="keyword">do</span> i = ilo, ihi
<a name="l01732"></a>01732                        <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#a5de6731a3b8601be3495a4c306832bf0">tmask</a>(i,j,iblk)) <span class="keyword">then</span> 
<a name="l01733"></a>01733                           ravgctz = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01734"></a>01734                           <span class="keyword">if</span> (<a class="code" href="namespaceice__flux.html#a43a0dd63e5a473c4acb725f534c3192d">albcnt</a>(i,j,iblk,ns) &gt; <a class="code" href="namespaceice__constants.html#af5d2a72e22e7a53706b6a41ba932a67d">puny</a>) &amp;
<a name="l01735"></a>01735                               ravgctz = <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>/<a class="code" href="namespaceice__flux.html#a43a0dd63e5a473c4acb725f534c3192d">albcnt</a>(i,j,iblk,ns)
<a name="l01736"></a>01736                           <span class="keyword">if</span> (n_albice(ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_albice(ns),iblk) = &amp;
<a name="l01737"></a>01737                              <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_albice(ns),iblk)*<a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns)*ravgctz
<a name="l01738"></a>01738                           <span class="keyword">if</span> (n_albsno(ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_albsno(ns),iblk) = &amp;
<a name="l01739"></a>01739                              <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_albsno(ns),iblk)*<a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns)*ravgctz
<a name="l01740"></a>01740                           <span class="keyword">if</span> (n_albpnd(ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_albpnd(ns),iblk) = &amp;
<a name="l01741"></a>01741                              <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_albpnd(ns),iblk)*<a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns)*ravgctz
<a name="l01742"></a>01742                        <span class="keyword">endif</span>
<a name="l01743"></a>01743                     <span class="keyword">enddo</span>             <span class="comment">! i</span>
<a name="l01744"></a>01744                     <span class="keyword">enddo</span>             <span class="comment">! j</span>
<a name="l01745"></a>01745                  <span class="keyword">endif</span>
<a name="l01746"></a>01746 
<a name="l01747"></a>01747               <span class="keyword">endif</span>
<a name="l01748"></a>01748            <span class="keyword">enddo</span>                <span class="comment">! k</span>
<a name="l01749"></a>01749 
<a name="l01750"></a>01750       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01751"></a>01751       <span class="comment">! snapshots</span>
<a name="l01752"></a>01752       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01753"></a>01753 
<a name="l01754"></a>01754           <span class="comment">! compute sig1 and sig2</span>
<a name="l01755"></a>01755         
<a name="l01756"></a>01756            call <a class="code" href="namespaceice__dyn__evp.html#ad8621c859aae602cd6702347e2db568b">principal_stress </a>(nx_block,  ny_block,  &amp;
<a name="l01757"></a>01757                                   stressp_1 (:,:,iblk), &amp;
<a name="l01758"></a>01758                                   stressm_1 (:,:,iblk), &amp;
<a name="l01759"></a>01759                                   stress12_1(:,:,iblk), &amp;
<a name="l01760"></a>01760                                   <a class="code" href="namespaceice__flux.html#a4406d054e8437ab55dc01d6e5b9c8882">prs_sig   </a>(:,:,iblk), &amp;
<a name="l01761"></a>01761                                   <a class="code" href="namespaceice__flux.html#a4e0e291e34267f30266f8a41db36affb">sig1      </a>(:,:,iblk), &amp;
<a name="l01762"></a>01762                                   <a class="code" href="namespaceice__flux.html#a7bf5a07a0946af77cd35135d6ce11771">sig2      </a>(:,:,iblk))
<a name="l01763"></a>01763  
<a name="l01764"></a>01764            <span class="keyword">do</span> j = jlo, jhi
<a name="l01765"></a>01765            <span class="keyword">do</span> i = ilo, ihi
<a name="l01766"></a>01766               <span class="keyword">if</span> (.not. <a class="code" href="namespaceice__grid.html#a5de6731a3b8601be3495a4c306832bf0">tmask</a>(i,j,iblk)) <span class="keyword">then</span> <span class="comment">! mask out land points</span>
<a name="l01767"></a>01767 <span class="comment">!                if (n_divu     (ns) /= 0) aa(i,j,n_divu(ns),iblk)      = spval</span>
<a name="l01768"></a>01768 <span class="comment">!                if (n_shear    (ns) /= 0) aa(i,j,n_shear(ns),iblk)     = spval</span>
<a name="l01769"></a>01769                  <span class="keyword">if</span> (n_sig1     (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_sig1(ns),iblk )     = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01770"></a>01770                  <span class="keyword">if</span> (n_sig2     (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_sig2(ns),iblk )     = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01771"></a>01771                  <span class="keyword">if</span> (n_mlt_onset(ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_mlt_onset(ns),iblk) = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01772"></a>01772                  <span class="keyword">if</span> (n_frz_onset(ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_frz_onset(ns),iblk) = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01773"></a>01773                  <span class="keyword">if</span> (n_hisnap   (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_hisnap(ns),iblk)    = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01774"></a>01774                  <span class="keyword">if</span> (n_aisnap   (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_aisnap(ns),iblk)    = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01775"></a>01775                  <span class="keyword">if</span> (n_trsig    (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_trsig(ns),iblk )    = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01776"></a>01776                  <span class="keyword">if</span> (n_iage     (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_iage(ns),iblk )     = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01777"></a>01777                  <span class="keyword">if</span> (n_FY       (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_FY(ns),iblk )       = <a class="code" href="namespaceice__constants.html#a9c8695ae78220caf5148da03217658d9">spval</a>
<a name="l01778"></a>01778               <span class="keyword">else</span>
<a name="l01779"></a>01779 <span class="comment">!                if (n_divu     (ns) /= 0) aa(i,j,n_divu(ns),iblk)      = &amp;</span>
<a name="l01780"></a>01780 <span class="comment">!                      divu (i,j,iblk)*avail_hist_fields(n_divu(ns))%cona</span>
<a name="l01781"></a>01781 <span class="comment">!                if (n_shear    (ns) /= 0) aa(i,j,n_shear(ns),iblk)     = &amp;</span>
<a name="l01782"></a>01782 <span class="comment">!                      shear(i,j,iblk)*avail_hist_fields(n_shear(ns))%cona</span>
<a name="l01783"></a>01783                  <span class="keyword">if</span> (n_sig1     (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_sig1(ns),iblk)      = &amp;
<a name="l01784"></a>01784                        <a class="code" href="namespaceice__flux.html#a4e0e291e34267f30266f8a41db36affb">sig1 </a>(i,j,iblk)*<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n_sig1(ns))%cona
<a name="l01785"></a>01785                  <span class="keyword">if</span> (n_sig2     (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_sig2(ns),iblk)      = &amp;
<a name="l01786"></a>01786                        <a class="code" href="namespaceice__flux.html#a7bf5a07a0946af77cd35135d6ce11771">sig2 </a>(i,j,iblk)*<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n_sig2(ns))%cona
<a name="l01787"></a>01787                  <span class="keyword">if</span> (n_mlt_onset(ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_mlt_onset(ns),iblk) = &amp;
<a name="l01788"></a>01788                        <a class="code" href="namespaceice__flux.html#a9f86616260452938fcc37213fcb284f8">mlt_onset</a>(i,j,iblk)
<a name="l01789"></a>01789                  <span class="keyword">if</span> (n_frz_onset(ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_frz_onset(ns),iblk) = &amp;
<a name="l01790"></a>01790                        <a class="code" href="namespaceice__flux.html#aa58df919e95f30bf2b824e6585dbd9e5">frz_onset</a>(i,j,iblk)
<a name="l01791"></a>01791                  <span class="keyword">if</span> (n_hisnap   (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_hisnap(ns),iblk)    = &amp;
<a name="l01792"></a>01792                        <a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(i,j,iblk)
<a name="l01793"></a>01793                  <span class="keyword">if</span> (n_aisnap   (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_aisnap(ns),iblk)    = &amp;
<a name="l01794"></a>01794                        <a class="code" href="namespaceice__state.html#a91eaa8dd8287c9640310a0aec0a85df8">aice</a>(i,j,iblk)
<a name="l01795"></a>01795                  <span class="keyword">if</span> (n_trsig    (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_trsig(ns),iblk )    = &amp;
<a name="l01796"></a>01796                                        <a class="code" href="namespaceice__constants.html#acf8570fae8090e3892e40648fe1a0036">p25</a>*(stressp_1(i,j,iblk) &amp;
<a name="l01797"></a>01797                                           + stressp_2(i,j,iblk) &amp;
<a name="l01798"></a>01798                                           + stressp_3(i,j,iblk) &amp;
<a name="l01799"></a>01799                                           + stressp_4(i,j,iblk))
<a name="l01800"></a>01800                  <span class="keyword">if</span> (n_iage     (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_iage(ns),iblk)      = &amp;
<a name="l01801"></a>01801                        <a class="code" href="namespaceice__state.html#ad9117b5d7f02ca8a6a10db8afa75a6ef">trcr</a>(i,j,<a class="code" href="namespaceice__state.html#aeae23c004739caada7b1be2f39df0927">nt_iage</a>,iblk)*<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n_iage(ns))%cona
<a name="l01802"></a>01802                  <span class="keyword">if</span> (n_FY       (ns) /= 0) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,n_FY(ns),iblk)        = &amp;
<a name="l01803"></a>01803                        <a class="code" href="namespaceice__state.html#ad9117b5d7f02ca8a6a10db8afa75a6ef">trcr</a>(i,j,<a class="code" href="namespaceice__state.html#a346a7cc45c174f3f489ba2e253bcf86f">nt_FY</a>,iblk)*<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(n_FY(ns))%cona
<a name="l01804"></a>01804             <span class="keyword">endif</span>
<a name="l01805"></a>01805            <span class="keyword">enddo</span>                <span class="comment">! i</span>
<a name="l01806"></a>01806            <span class="keyword">enddo</span>                <span class="comment">! j</span>
<a name="l01807"></a>01807 
<a name="l01808"></a>01808         <span class="keyword">enddo</span>                   <span class="comment">! iblk</span>
<a name="l01809"></a>01809         <span class="comment">!$OMP END PARALLEL DO</span>
<a name="l01810"></a>01810 
<a name="l01811"></a>01811         <a class="code" href="namespaceice__history__fields.html#aaead8298e219c1e1308f21fc20ee5acd">time_end</a>(ns) = time/int(<a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>)
<a name="l01812"></a>01812 
<a name="l01813"></a>01813       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01814"></a>01814       <span class="comment">! write file</span>
<a name="l01815"></a>01815       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01816"></a>01816 
<a name="l01817"></a>01817         call <a class="code" href="namespaceice__timers.html#a308c3af934358cb1f050df7cce19ce79">ice_timer_start</a>(<a class="code" href="namespaceice__timers.html#af250a2fa78a031dcb6f923aa2afb2813">timer_readwrite</a>)  <span class="comment">! reading/writing</span>
<a name="l01818"></a>01818 
<a name="l01819"></a>01819         <span class="keyword">if</span> (trim(<a class="code" href="namespaceice__history__fields.html#a1f38b0cd52722e7ed80947313d84936a">history_format</a>) == <span class="stringliteral">&apos;nc&apos;</span>) <span class="keyword">then</span>
<a name="l01820"></a>01820            call <a class="code" href="namespaceice__history__write.html#af99cb89d79e815ff4c40abdfacc34cf9">icecdf</a>(ns)         <span class="comment">! netcdf output</span>
<a name="l01821"></a>01821         <span class="keyword">else</span>
<a name="l01822"></a>01822            call <a class="code" href="namespaceice__history__write.html#ab76a8fc642cb0db3916e0a9fb6a4d236">icebin</a>(ns)         <span class="comment">! binary output</span>
<a name="l01823"></a>01823         <span class="keyword">endif</span>
<a name="l01824"></a>01824 
<a name="l01825"></a>01825         call <a class="code" href="namespaceice__timers.html#ab483bb3b29e1839baf5a6bc2ad720ca8">ice_timer_stop</a>(<a class="code" href="namespaceice__timers.html#af250a2fa78a031dcb6f923aa2afb2813">timer_readwrite</a>)  <span class="comment">! reading/writing</span>
<a name="l01826"></a>01826 
<a name="l01827"></a>01827       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01828"></a>01828       <span class="comment">! reset to zero</span>
<a name="l01829"></a>01829       <span class="comment">!------------------------------------------------------------</span>
<a name="l01830"></a>01830         <span class="keyword">if</span> (write_ic) <span class="keyword">then</span>
<a name="l01831"></a>01831            <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(:,:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01832"></a>01832            <a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01833"></a>01833            write_ic = .false.        <span class="comment">! write initial condition once at most</span>
<a name="l01834"></a>01834         <span class="keyword">else</span>
<a name="l01835"></a>01835            <a class="code" href="namespaceice__history.html#a8f63bda9e9e4d0a76e49e17002210ae4">avgct</a>(ns) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01836"></a>01836         <span class="keyword">endif</span>
<a name="l01837"></a>01837 
<a name="l01838"></a>01838         <span class="keyword">do</span> k=1,<a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a>
<a name="l01839"></a>01839            <span class="keyword">if</span> (<a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(k)%vhistfreq == histfreq(ns)) <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(:,:,k,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01840"></a>01840         <span class="keyword">enddo</span>
<a name="l01841"></a>01841 
<a name="l01842"></a>01842       <span class="keyword">endif</span>  <span class="comment">! write_history or write_ic</span>
<a name="l01843"></a>01843       <span class="keyword">enddo</span>  <span class="comment">! nstreams</span>
<a name="l01844"></a>01844 
<a name="l01845"></a>01845       <span class="comment">!$OMP PARALLEL DO PRIVATE(iblk,this_block,ilo,ihi,jlo,jhi,i,j,k)</span>
<a name="l01846"></a>01846       <span class="keyword">do</span> iblk = 1, <a class="code" href="namespaceice__domain.html#aae3d2de717ee7a743c9635b3a9e35a95">nblocks</a>
<a name="l01847"></a>01847          this_block = <a class="code" href="namespaceice__blocks.html#aa79bfef5022683234ed1b332af17f1de">get_block</a>(<a class="code" href="namespaceice__domain.html#a152cf5087ce1dccce8f5e147306320ae">blocks_ice</a>(iblk),iblk)         
<a name="l01848"></a>01848          ilo = this_block%ilo
<a name="l01849"></a>01849          ihi = this_block%ihi
<a name="l01850"></a>01850          jlo = this_block%jlo
<a name="l01851"></a>01851          jhi = this_block%jhi
<a name="l01852"></a>01852 
<a name="l01853"></a>01853          <span class="keyword">if</span> (<a class="code" href="namespaceice__calendar.html#a2d0b7e0b5144d49dd2e39690c5cde21f">new_year</a>) <span class="keyword">then</span>
<a name="l01854"></a>01854 
<a name="l01855"></a>01855             <span class="keyword">do</span> j=jlo,jhi
<a name="l01856"></a>01856             <span class="keyword">do</span> i=ilo,ihi
<a name="l01857"></a>01857                <span class="comment">! reset NH Jan 1</span>
<a name="l01858"></a>01858                <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#ae9873cb5a374679eb9105cbd0b3adaef">lmask_n</a>(i,j,iblk)) <a class="code" href="namespaceice__flux.html#a9f86616260452938fcc37213fcb284f8">mlt_onset</a>(i,j,iblk) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01859"></a>01859                <span class="comment">! reset SH Jan 1 </span>
<a name="l01860"></a>01860                <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#aab33134c872608cbbcb505d3f788bb2d">lmask_s</a>(i,j,iblk)) <a class="code" href="namespaceice__flux.html#aa58df919e95f30bf2b824e6585dbd9e5">frz_onset</a>(i,j,iblk) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01861"></a>01861             <span class="keyword">enddo</span>
<a name="l01862"></a>01862             <span class="keyword">enddo</span>
<a name="l01863"></a>01863          <span class="keyword">endif</span>                  <span class="comment">! new_year</span>
<a name="l01864"></a>01864 
<a name="l01865"></a>01865          <span class="keyword">if</span> ((<a class="code" href="namespaceice__calendar.html#a4b4393c99a1d82bc45fcee5d7f6c1eab">yday</a> &gt;= 181._dbl_kind) .and. &amp;
<a name="l01866"></a>01866              (<a class="code" href="namespaceice__calendar.html#a4b4393c99a1d82bc45fcee5d7f6c1eab">yday</a> &lt;  181._dbl_kind+dt/<a class="code" href="namespaceice__constants.html#a4834c667201b1d05b8a0a0cf79b10742">secday</a>)) <span class="keyword">then</span>
<a name="l01867"></a>01867 
<a name="l01868"></a>01868             <span class="keyword">do</span> j=jlo,jhi
<a name="l01869"></a>01869             <span class="keyword">do</span> i=ilo,ihi
<a name="l01870"></a>01870 
<a name="l01871"></a>01871                <span class="comment">! reset SH Jul 1</span>
<a name="l01872"></a>01872                <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#aab33134c872608cbbcb505d3f788bb2d">lmask_s</a>(i,j,iblk)) <a class="code" href="namespaceice__flux.html#a9f86616260452938fcc37213fcb284f8">mlt_onset</a>(i,j,iblk) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01873"></a>01873 
<a name="l01874"></a>01874                <span class="comment">! reset NH Jul 1</span>
<a name="l01875"></a>01875                <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#ae9873cb5a374679eb9105cbd0b3adaef">lmask_n</a>(i,j,iblk)) <a class="code" href="namespaceice__flux.html#aa58df919e95f30bf2b824e6585dbd9e5">frz_onset</a>(i,j,iblk) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l01876"></a>01876             <span class="keyword">enddo</span>
<a name="l01877"></a>01877             <span class="keyword">enddo</span>
<a name="l01878"></a>01878 
<a name="l01879"></a>01879          <span class="keyword">endif</span>                  <span class="comment">! yday</span>
<a name="l01880"></a>01880       <span class="keyword">enddo</span>                     <span class="comment">! iblk</span>
<a name="l01881"></a>01881 
<a name="l01882"></a>01882       write_ic = .false.        <span class="comment">! write initial condition once at most</span>
<a name="l01883"></a>01883 
<a name="l01884"></a>01884 <span class="keyword">      end subroutine ice_write_hist</span>
<a name="l01885"></a>01885 
<a name="l01886"></a>01886 <span class="comment">!=======================================================================</span>
<a name="l01887"></a>01887 
<a name="l01888"></a><a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">01888</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__history.html#a97e4c9d297248bf62ca51169bf82a846">define_hist_field</a>(id, vname, vunit, vcoord, vcellmeas, &amp;
<a name="l01889"></a>01889                                    vdesc, vcomment, cona, conb, &amp;
<a name="l01890"></a>01890                                    ns1, vhistfreq)
<a name="l01891"></a>01891 
<a name="l01892"></a>01892 <span class="comment">!     !DESCRIPTION:</span>
<a name="l01893"></a>01893 <span class="comment">!     Initializes description of an available field and returns location</span>
<a name="l01894"></a>01894 <span class="comment">!     in the available fields array for use in later calls.</span>
<a name="l01895"></a>01895 <span class="comment">!</span>
<a name="l01896"></a>01896 <span class="comment">!     !REVISION HISTORY:</span>
<a name="l01897"></a>01897 <span class="comment">!     !REVISION HISTORY:</span>
<a name="l01898"></a>01898 <span class="comment">!     2009 Created by D. Bailey following POP</span>
<a name="l01899"></a>01899 
<a name="l01900"></a>01900 <span class="comment">!     !USES:</span>
<a name="l01901"></a>01901       use <span class="keywordflow">ice_exit</span>
<a name="l01902"></a>01902       use <span class="keywordflow">ice_calendar</span>, only: histfreq, histfreq_n, nstreams
<a name="l01903"></a>01903 
<a name="l01904"></a>01904 <span class="comment">!     !OUTPUT PARAMETERS:</span>
<a name="l01905"></a>01905 
<a name="l01906"></a>01906       <span class="keywordtype">integer (int_kind)</span>, <span class="keywordtype">dimension(max_nstrm)</span>, <span class="keywordtype">intent(out)</span> :: 
<a name="l01907"></a>01907          id                <span class="comment">! location in avail_fields array for use in</span>
<a name="l01908"></a>01908                            <span class="comment">! later routines</span>
<a name="l01909"></a>01909 
<a name="l01910"></a>01910 <span class="comment">!     !INPUT PARAMETERS</span>
<a name="l01911"></a>01911 
<a name="l01912"></a>01912       <span class="keywordtype">character (len=*)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l01913"></a>01913          vname      ,  <span class="comment">! variable names</span>
<a name="l01914"></a>01914          vunit      ,  <span class="comment">! variable units</span>
<a name="l01915"></a>01915          vcoord     ,  <span class="comment">! variable coordinates</span>
<a name="l01916"></a>01916          vcellmeas  ,  <span class="comment">! variables cell measures</span>
<a name="l01917"></a>01917          vdesc      ,  <span class="comment">! variable descriptions</span>
<a name="l01918"></a>01918          vcomment       <span class="comment">! variable comments</span>
<a name="l01919"></a>01919 
<a name="l01920"></a>01920       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l01921"></a>01921          cona       ,  <span class="comment">! multiplicative conversion factor</span>
<a name="l01922"></a>01922          conb           <span class="comment">! additive conversion factor</span>
<a name="l01923"></a>01923 
<a name="l01924"></a>01924       <span class="keywordtype">character (len=*)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l01925"></a>01925          vhistfreq      <span class="comment">! history frequency</span>
<a name="l01926"></a>01926  
<a name="l01927"></a>01927       <span class="keywordtype">integer (kind=int_kind)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l01928"></a>01928          ns1            <span class="comment">! stream index</span>
<a name="l01929"></a>01929 
<a name="l01930"></a>01930       <span class="keywordtype">integer (kind=int_kind) </span>:: 
<a name="l01931"></a>01931          ns         ,  <span class="comment">! loop index</span>
<a name="l01932"></a>01932          lenf           <span class="comment">! length of namelist string</span>
<a name="l01933"></a>01933 
<a name="l01934"></a>01934       <span class="keywordtype">character (len=40) </span>:: stmp
<a name="l01935"></a>01935 
<a name="l01936"></a>01936       lenf = len(trim(vhistfreq))
<a name="l01937"></a>01937       <span class="keyword">if</span> (ns1 == 1) id(:) = 0
<a name="l01938"></a>01938 
<a name="l01939"></a>01939       <span class="keyword">do</span> ns = 1, <a class="code" href="namespaceice__calendar.html#ae00ad28547110901c77d6d4f2d87a7ea">nstreams</a>
<a name="l01940"></a>01940          <span class="keyword">if</span> (vhistfreq(ns1:ns1) == <a class="code" href="namespaceice__calendar.html#a0502fca3c549cbfb5113eddd7de76b20">histfreq</a>(ns)) <span class="keyword">then</span>
<a name="l01941"></a>01941 
<a name="l01942"></a>01942             <a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a> = <a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a> + 1
<a name="l01943"></a>01943 
<a name="l01944"></a>01944             <span class="keyword">if</span> (<a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a> &gt; <a class="code" href="namespaceice__history__fields.html#abce9e6fec5b792ea13bd34332a858f16">max_avail_hist_fields</a>) &amp;
<a name="l01945"></a>01945                call <a class="code" href="namespaceice__exit.html#a3fcf77109320e75f1268f41fe212d789">abort_ice</a>(<span class="stringliteral">&quot;Need to increase max_avail_hist_fields&quot;</span>)
<a name="l01946"></a>01946 
<a name="l01947"></a>01947             id(ns) = <a class="code" href="namespaceice__history__fields.html#ae792c3e29c3220a23344fc57f0950944">num_avail_hist_fields</a>
<a name="l01948"></a>01948 
<a name="l01949"></a>01949             stmp = vname
<a name="l01950"></a>01950             <span class="keyword">if</span> (lenf &gt; 1 .and. ns1 &gt; 1) &amp;
<a name="l01951"></a>01951                <span class="keyword">write</span>(stmp,<span class="stringliteral">&apos;(a,a1,a1)&apos;</span>) trim(stmp),<span class="stringliteral">&apos;_&apos;</span>,vhistfreq(ns1:ns1)
<a name="l01952"></a>01952 
<a name="l01953"></a>01953             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vname = trim(stmp)
<a name="l01954"></a>01954             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vunit = trim(vunit)
<a name="l01955"></a>01955             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vcoord = trim(vcoord)
<a name="l01956"></a>01956             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vcellmeas = trim(vcellmeas)
<a name="l01957"></a>01957             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vdesc = trim(vdesc)
<a name="l01958"></a>01958             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vcomment = trim(vcomment)
<a name="l01959"></a>01959             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%cona = cona
<a name="l01960"></a>01960             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%conb = conb
<a name="l01961"></a>01961             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vhistfreq = vhistfreq(ns1:ns1)
<a name="l01962"></a>01962             <a class="code" href="namespaceice__history__fields.html#a9614b7f86e2f876b54ea179e0bd10b13">avail_hist_fields</a>(id(ns))%vhistfreq_n = <a class="code" href="namespaceice__calendar.html#ab7cea996ca05518dbde0dc027ee81c13">histfreq_n</a>(ns)
<a name="l01963"></a>01963 
<a name="l01964"></a>01964          <span class="keyword">endif</span>
<a name="l01965"></a>01965       <span class="keyword">enddo</span>
<a name="l01966"></a>01966 
<a name="l01967"></a>01967 <span class="keyword">      end subroutine define_hist_field</span>
<a name="l01968"></a>01968 
<a name="l01969"></a>01969 <span class="comment">!=======================================================================</span>
<a name="l01970"></a>01970 
<a name="l01971"></a><a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">01971</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__history.html#a16cf4059a24eed8a2908cecdba018383">accum_hist_field</a>(id, iblk, field_accum)
<a name="l01972"></a>01972 
<a name="l01973"></a>01973 <span class="comment">!     !DESCRIPTION:</span>
<a name="l01974"></a>01974 <span class="comment">!     Accumulates a history field</span>
<a name="l01975"></a>01975 <span class="comment">!</span>
<a name="l01976"></a>01976 <span class="comment">!     !REVISION HISTORY:</span>
<a name="l01977"></a>01977 <span class="comment">!     2009 Created by D. Bailey following POP</span>
<a name="l01978"></a>01978 
<a name="l01979"></a>01979       use <span class="keywordflow">ice_domain</span>
<a name="l01980"></a>01980       use <span class="keywordflow">ice_grid</span>, only: tmask
<a name="l01981"></a>01981       use <span class="keywordflow">ice_calendar</span>, only: nstreams
<a name="l01982"></a>01982 
<a name="l01983"></a>01983 <span class="comment">!     !OUTPUT PARAMETERS:</span>
<a name="l01984"></a>01984 
<a name="l01985"></a>01985       <span class="keywordtype">integer (int_kind)</span>, <span class="keywordtype">dimension(max_nstrm)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l01986"></a>01986          id                <span class="comment">! location in avail_fields array for use in</span>
<a name="l01987"></a>01987                            <span class="comment">! later routines</span>
<a name="l01988"></a>01988 
<a name="l01989"></a>01989       <span class="keywordtype">integer (kind=int_kind)</span>, <span class="keywordtype">intent(in)</span> :: iblk
<a name="l01990"></a>01990 
<a name="l01991"></a>01991       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">intent(in)</span> :: field_accum(nx_block,ny_block)
<a name="l01992"></a>01992 
<a name="l01993"></a>01993       <span class="keywordtype">type (</span><a class="code" href="typeice__blocks_1_1block.html">block</a><span class="keywordtype">)</span> :: 
<a name="l01994"></a>01994          this_block           <span class="comment">! block information for current block</span>
<a name="l01995"></a>01995 
<a name="l01996"></a>01996       <span class="keywordtype">integer (kind=int_kind) </span>:: i,j, ilo, ihi, jlo, jhi, ns, idns
<a name="l01997"></a>01997 
<a name="l01998"></a>01998       <span class="comment">!---------------------------------------------------------------</span>
<a name="l01999"></a>01999       <span class="comment">! increment field</span>
<a name="l02000"></a>02000       <span class="comment">!---------------------------------------------------------------</span>
<a name="l02001"></a>02001 
<a name="l02002"></a>02002       <span class="keyword">do</span> ns = 1, <a class="code" href="namespaceice__calendar.html#ae00ad28547110901c77d6d4f2d87a7ea">nstreams</a>
<a name="l02003"></a>02003          idns = id(ns)
<a name="l02004"></a>02004          <span class="keyword">if</span> (idns &gt; 0) <span class="keyword">then</span>
<a name="l02005"></a>02005 
<a name="l02006"></a>02006             this_block = <a class="code" href="namespaceice__blocks.html#aa79bfef5022683234ed1b332af17f1de">get_block</a>(<a class="code" href="namespaceice__domain.html#a152cf5087ce1dccce8f5e147306320ae">blocks_ice</a>(iblk),iblk)
<a name="l02007"></a>02007             ilo = this_block%ilo
<a name="l02008"></a>02008             ihi = this_block%ihi
<a name="l02009"></a>02009             jlo = this_block%jlo
<a name="l02010"></a>02010             jhi = this_block%jhi
<a name="l02011"></a>02011 
<a name="l02012"></a>02012             <span class="keyword">do</span> j = jlo, jhi
<a name="l02013"></a>02013             <span class="keyword">do</span> i = ilo, ihi
<a name="l02014"></a>02014                <span class="keyword">if</span> (<a class="code" href="namespaceice__grid.html#a5de6731a3b8601be3495a4c306832bf0">tmask</a>(i,j,iblk)) <span class="keyword">then</span>
<a name="l02015"></a>02015                   <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,idns, iblk) = <a class="code" href="namespaceice__history__fields.html#af5f594399a95ba6eccac351207392285">aa</a>(i,j,idns, iblk) + field_accum(i,j)
<a name="l02016"></a>02016                <span class="keyword">endif</span>
<a name="l02017"></a>02017             <span class="keyword">enddo</span>
<a name="l02018"></a>02018             <span class="keyword">enddo</span>
<a name="l02019"></a>02019 
<a name="l02020"></a>02020          <span class="keyword">endif</span>
<a name="l02021"></a>02021       <span class="keyword">enddo</span>
<a name="l02022"></a>02022 
<a name="l02023"></a>02023 <span class="keyword">      end subroutine accum_hist_field</span>
<a name="l02024"></a>02024 
<a name="l02025"></a>02025 <span class="comment">!=======================================================================</span>
<a name="l02026"></a>02026 
<a name="l02027"></a>02027 <span class="keyword">      end module ice_history</span>
<a name="l02028"></a>02028 
<a name="l02029"></a>02029 <span class="comment">!=======================================================================</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Oct 6 14:02:23 2009 for CICE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
