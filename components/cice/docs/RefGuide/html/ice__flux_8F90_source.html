<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CICE: ice_flux.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Types&nbsp;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>ice_flux.F90</h1><a href="ice__flux_8F90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">!=======================================================================</span>
<a name="l00002"></a>00002 <span class="comment">!BOP</span>
<a name="l00003"></a>00003 <span class="comment">!</span>
<a name="l00004"></a>00004 <span class="comment">! !MODULE: ice_flux - flux variable declarations: coupler, diagnostic and</span>
<a name="l00005"></a>00005 <span class="comment">!          internal</span>
<a name="l00006"></a>00006 <span class="comment">!</span>
<a name="l00007"></a>00007 <span class="comment">! !DESCRIPTION:</span>
<a name="l00008"></a>00008 <span class="comment">!</span>
<a name="l00009"></a>00009 <span class="comment">! Flux variable declarations; these include fields sent from the coupler</span>
<a name="l00010"></a>00010 <span class="comment">! (&quot;in&quot;), sent to the coupler (&quot;out&quot;), written to diagnostic history files</span>
<a name="l00011"></a>00011 <span class="comment">! (&quot;diagnostic&quot;), and used internally (&quot;internal&quot;).</span>
<a name="l00012"></a>00012 <span class="comment">!</span>
<a name="l00013"></a>00013 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00014"></a>00014 <span class="comment">!  SVN:$Id: ice_flux.F90 51 2007-01-29 22:25:24Z eclare $</span>
<a name="l00015"></a>00015 <span class="comment">!</span>
<a name="l00016"></a>00016 <span class="comment">! author Elizabeth C. Hunke, LANL</span>
<a name="l00017"></a>00017 <span class="comment">!</span>
<a name="l00018"></a>00018 <span class="comment">! 2004: Block structure added by William Lipscomb</span>
<a name="l00019"></a>00019 <span class="comment">!       Swappped, revised, and added some subroutines</span>
<a name="l00020"></a>00020 <span class="comment">! 2006: Converted to free source form (F90) by Elizabeth Hunke</span>
<a name="l00021"></a>00021 <span class="comment">!</span>
<a name="l00022"></a>00022 <span class="comment">! !INTERFACE:</span>
<a name="l00023"></a>00023 <span class="comment">!</span>
<a name="l00024"></a><a class="code" href="namespaceice__flux.html">00024</a>       <span class="keyword">module</span> ice_flux
<a name="l00025"></a>00025 <span class="comment">!</span>
<a name="l00026"></a>00026 <span class="comment">! !USES:</span>
<a name="l00027"></a>00027 <span class="comment">!</span>
<a name="l00028"></a>00028       use <span class="keywordflow">ice_kinds_mod</span>
<a name="l00029"></a>00029       use <span class="keywordflow">ice_blocks</span>
<a name="l00030"></a>00030       use <span class="keywordflow">ice_domain_size</span>
<a name="l00031"></a>00031       use <span class="keywordflow">ice_constants</span>
<a name="l00032"></a>00032 <span class="comment">!</span>
<a name="l00033"></a>00033 <span class="comment">!EOP</span>
<a name="l00034"></a>00034 <span class="comment">!</span>
<a name="l00035"></a>00035       <span class="keyword">implicit none</span>
<a name="l00036"></a>00036       <span class="keywordtype">save</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00039"></a>00039       <span class="comment">! Dynamics component</span>
<a name="l00040"></a>00040       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00043"></a>00043 
<a name="l00044"></a>00044        <span class="comment">! in from atmos (if .not.calc_strair)</span>
<a name="l00045"></a>00045          strax   , &amp; <span class="comment">! wind stress components (N/m^2)</span>
<a name="l00046"></a>00046          stray   , &amp; <span class="comment">!</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048        <span class="comment">! in from ocean</span>
<a name="l00049"></a>00049          uocn    , &amp; <span class="comment">! ocean current, x-direction (m/s)</span>
<a name="l00050"></a>00050          vocn    , &amp; <span class="comment">! ocean current, y-direction (m/s)</span>
<a name="l00051"></a>00051          ss_tltx , &amp; <span class="comment">! sea surface slope, x-direction (m/m)</span>
<a name="l00052"></a>00052          ss_tlty , &amp; <span class="comment">! sea surface slope, y-direction</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054        <span class="comment">! out to atmosphere (if calc_strair)</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056          strairxT, &amp; <span class="comment">! stress on ice by air, x-direction</span>
<a name="l00057"></a>00057          strairyT, &amp; <span class="comment">! stress on ice by air, y-direction</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059        <span class="comment">! use for super-cycling the dynamics</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061          strairxT_accum, &amp; <span class="comment">! stress on ice by air, x-direction</span>
<a name="l00062"></a>00062          strairyT_accum, &amp; <span class="comment">! stress on ice by air, y-direction</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064        <span class="comment">! out to ocean          T-cell (kg/m s^2)</span>
<a name="l00065"></a>00065        <span class="comment">! Note, CICE_IN_NEMO uses strocnx and strocny for coupling</span>
<a name="l00066"></a>00066          strocnxT, &amp; <span class="comment">! ice-ocean stress, x-direction</span>
<a name="l00067"></a>00067          strocnyT    <span class="comment">! ice-ocean stress, y-direction</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069        <span class="comment">! diagnostic</span>
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="namespaceice__flux.html#ac9c1e92371b4e39d2aa9f38548b011ff">00071</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00072"></a>00072          sig1    ,  <span class="comment">! principal stress component</span>
<a name="l00073"></a>00073          sig2    ,  <span class="comment">! principal stress component</span>
<a name="l00074"></a>00074          strairx ,  <span class="comment">! stress on ice by air, x-direction</span>
<a name="l00075"></a>00075          strairy ,  <span class="comment">! stress on ice by air, y-direction</span>
<a name="l00076"></a>00076          strocnx ,  <span class="comment">! ice-ocean stress, x-direction</span>
<a name="l00077"></a>00077          strocny ,  <span class="comment">! ice-ocean stress, y-direction</span>
<a name="l00078"></a>00078          strtltx ,  <span class="comment">! stress due to sea surface slope, x-direction</span>
<a name="l00079"></a>00079          strtlty ,  <span class="comment">! stress due to sea surface slope, y-direction</span>
<a name="l00080"></a>00080          strintx ,  <span class="comment">! divergence of internal ice stress, x (N/m^2)</span>
<a name="l00081"></a>00081          strinty ,  <span class="comment">! divergence of internal ice stress, y (N/m^2)</span>
<a name="l00082"></a>00082          daidtd  ,  <span class="comment">! ice area tendency due to transport   (1/s)</span>
<a name="l00083"></a>00083          dvidtd  ,  <span class="comment">! ice volume tendency due to transport (m/s)</span>
<a name="l00084"></a>00084          dardg1dt,  <span class="comment">! rate of area loss by ridging ice (1/s)</span>
<a name="l00085"></a>00085          dardg2dt,  <span class="comment">! rate of area gain by new ridges (1/s)</span>
<a name="l00086"></a>00086          dvirdgdt,  <span class="comment">! rate of ice volume ridged (m/s)</span>
<a name="l00087"></a>00087          opening     <span class="comment">! rate of opening due to divergence/shear (1/s)</span>
<a name="l00088"></a>00088 
<a name="l00089"></a>00089        <span class="comment">! restart</span>
<a name="l00090"></a>00090 
<a name="l00091"></a>00091       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00092"></a>00092        <span class="comment">! ice stress tensor in each corner of T cell (kg/s^2)</span>
<a name="l00093"></a>00093          stressp_1, stressp_2, stressp_3, stressp_4 , &amp; <span class="comment">! sigma11+sigma22</span>
<a name="l00094"></a>00094          stressm_1, stressm_2, stressm_3, stressm_4 , &amp; <span class="comment">! sigma11-sigma22</span>
<a name="l00095"></a>00095          stress12_1,stress12_2,stress12_3,stress12_4    <span class="comment">! sigma12</span>
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="namespaceice__flux.html#a2c8f3b751fc60ac7a93605e6bb887b0f">00097</a>       <span class="keywordtype">logical (kind=log_kind)</span>, 
<a name="l00098"></a>00098          <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00099"></a>00099          iceumask   <span class="comment">! ice extent mask (U-cell)</span>
<a name="l00100"></a>00100 
<a name="l00101"></a>00101        <span class="comment">! internal</span>
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="namespaceice__flux.html#a4406d054e8437ab55dc01d6e5b9c8882">00103</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00104"></a>00104          prs_sig  ,  <span class="comment">! replacement pressure, for stress calc</span>
<a name="l00105"></a>00105          fm           <span class="comment">! Coriolis param. * mass in U-cell (kg/s)</span>
<a name="l00106"></a>00106 
<a name="l00107"></a>00107       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00108"></a>00108       <span class="comment">! Thermodynamic component</span>
<a name="l00109"></a>00109       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111        <span class="comment">! in from atmosphere (if calc_Tsfc)</span>
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="namespaceice__flux.html#a760e7ef6ee3c277e293ab9a2f92685cb">00113</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00114"></a>00114          zlvl    ,  <span class="comment">! atm level height (m)</span>
<a name="l00115"></a>00115          uatm    ,  <span class="comment">! wind velocity components (m/s)</span>
<a name="l00116"></a>00116          vatm    , 
<a name="l00117"></a>00117          wind    ,  <span class="comment">! wind speed (m/s)</span>
<a name="l00118"></a>00118          potT    ,  <span class="comment">! air potential temperature  (K)</span>
<a name="l00119"></a>00119          Tair    ,  <span class="comment">! air temperature  (K)</span>
<a name="l00120"></a>00120          Qa      ,  <span class="comment">! specific humidity (kg/kg)</span>
<a name="l00121"></a>00121          rhoa    ,  <span class="comment">! air density (kg/m^3)</span>
<a name="l00122"></a>00122          swvdr   ,  <span class="comment">! sw down, visible, direct  (W/m^2)</span>
<a name="l00123"></a>00123          swvdf   ,  <span class="comment">! sw down, visible, diffuse (W/m^2)</span>
<a name="l00124"></a>00124          swidr   ,  <span class="comment">! sw down, near IR, direct  (W/m^2)</span>
<a name="l00125"></a>00125          swidf   ,  <span class="comment">! sw down, near IR, diffuse (W/m^2)</span>
<a name="l00126"></a>00126          flw         <span class="comment">! incoming longwave radiation (W/m^2)</span>
<a name="l00127"></a>00127 
<a name="l00128"></a>00128        <span class="comment">! in from atmosphere (if .not. Tsfc_calc)</span>
<a name="l00129"></a>00129        <span class="comment">! required for coupling to HadGEM3</span>
<a name="l00130"></a>00130        <span class="comment">! NOTE: when in CICE_IN_NEMO mode, these are gridbox mean fields,</span>
<a name="l00131"></a>00131        <span class="comment">! not per ice area. When in standalone mode, these are per ice area.</span>
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="namespaceice__flux.html#a248789dd1933e5c3a277f54582b46099">00133</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, 
<a name="l00134"></a>00134          <span class="keywordtype">dimension (nx_block,ny_block,ncat,max_blocks) </span>:: 
<a name="l00135"></a>00135          fsurfn_f   ,  <span class="comment">! net flux to top surface, excluding fcondtop</span>
<a name="l00136"></a>00136          fcondtopn_f,  <span class="comment">! downward cond flux at top surface (W m-2)</span>
<a name="l00137"></a>00137          flatn_f        <span class="comment">! latent heat flux (W m-2)</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139        <span class="comment">! in from atmosphere</span>
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="namespaceice__flux.html#ada95784733af0019d97dc30baf7511b4">00141</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00142"></a>00142          frain   ,  <span class="comment">! rainfall rate (kg/m^2 s)</span>
<a name="l00143"></a>00143          fsnow       <span class="comment">! snowfall rate (kg/m^2 s)</span>
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="namespaceice__flux.html#ad99dce71f61486e2450ba1fc5318abb9">00145</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, 
<a name="l00146"></a>00146          <span class="keywordtype">dimension (nx_block,ny_block,n_aeromx,max_blocks) </span>:: 
<a name="l00147"></a>00147          faero    <span class="comment">! aerosol deposition rate (kg/m^2 s)  MH</span>
<a name="l00148"></a>00148 
<a name="l00149"></a>00149        <span class="comment">! in from ocean</span>
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="namespaceice__flux.html#a3facf6772fad8bd7af98c69cd56db10c">00151</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00152"></a>00152          sss     ,  <span class="comment">! sea surface salinity (ppt)</span>
<a name="l00153"></a>00153          sst     ,  <span class="comment">! sea surface temperature (C)</span>
<a name="l00154"></a>00154          frzmlt  ,  <span class="comment">! freezing/melting potential (W/m^2)</span>
<a name="l00155"></a>00155          Tf      ,  <span class="comment">! freezing temperature (C)</span>
<a name="l00156"></a>00156          qdp     ,  <span class="comment">! deep ocean heat flux (W/m^2), negative upward</span>
<a name="l00157"></a>00157          hmix        <span class="comment">! mixed layer depth (m)</span>
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="namespaceice__flux.html#a230173f0ff542e8f4cdc68f1c6a469f9">00159</a>       <span class="keywordtype">character (char_len) </span>:: 
<a name="l00160"></a>00160          Tfrzpt      <span class="comment">! ocean freezing temperature formulation</span>
<a name="l00161"></a>00161                      <span class="comment">! &apos;constant&apos; (-1.8C), &apos;linear_S&apos;</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163        <span class="comment">! out to atmosphere (if calc_Tsfc)</span>
<a name="l00164"></a>00164        <span class="comment">! note Tsfc is in ice_state.F</span>
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="namespaceice__flux.html#a6a0b5fa95bab43f29f8cbd6cbd8f047f">00166</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00167"></a>00167          fsens   ,  <span class="comment">! sensible heat flux (W/m^2)</span>
<a name="l00168"></a>00168          flat    ,  <span class="comment">! latent heat flux   (W/m^2)</span>
<a name="l00169"></a>00169          fswabs  ,  <span class="comment">! shortwave flux absorbed in ice and ocean (W/m^2)</span>
<a name="l00170"></a>00170          flwout  ,  <span class="comment">! outgoing longwave radiation (W/m^2)</span>
<a name="l00171"></a>00171          Tref    ,  <span class="comment">! 2m atm reference temperature (K)</span>
<a name="l00172"></a>00172          Qref    ,  <span class="comment">! 2m atm reference spec humidity (kg/kg)</span>
<a name="l00173"></a>00173          evap        <span class="comment">! evaporative water flux (kg/m^2/s)</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175        <span class="comment">! albedos aggregated over categories (if calc_Tsfc)</span>
<a name="l00176"></a><a class="code" href="namespaceice__flux.html#a87ebd7f059dc2e9052efba54a0d361ec">00176</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension(nx_block,ny_block,max_blocks) </span>:: 
<a name="l00177"></a>00177          alvdr   ,  <span class="comment">! visible, direct   (fraction)</span>
<a name="l00178"></a>00178          alidr   ,  <span class="comment">! near-ir, direct   (fraction)</span>
<a name="l00179"></a>00179          alvdf   ,  <span class="comment">! visible, diffuse  (fraction)</span>
<a name="l00180"></a>00180          alidf   ,  <span class="comment">! near-ir, diffuse  (fraction)</span>
<a name="l00181"></a>00181          <span class="comment">! grid-box-mean versions</span>
<a name="l00182"></a>00182          alvdr_gbm, &amp; <span class="comment">! visible, direct   (fraction)</span>
<a name="l00183"></a>00183          alidr_gbm, &amp; <span class="comment">! near-ir, direct   (fraction)</span>
<a name="l00184"></a>00184          alvdf_gbm, &amp; <span class="comment">! visible, diffuse  (fraction)</span>
<a name="l00185"></a>00185          alidf_gbm, &amp; <span class="comment">! near-ir, diffuse  (fraction)</span>
<a name="l00186"></a>00186          <span class="comment">! components for history</span>
<a name="l00187"></a>00187          albice   , &amp; <span class="comment">! bare ice albedo</span>
<a name="l00188"></a>00188          albsno   , &amp; <span class="comment">! snow albedo</span>
<a name="l00189"></a>00189          albpnd       <span class="comment">! melt pond albedo</span>
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="namespaceice__flux.html#a43a0dd63e5a473c4acb725f534c3192d">00191</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, 
<a name="l00192"></a>00192          <span class="keywordtype">dimension(nx_block,ny_block,max_blocks,max_nstrm) </span>:: 
<a name="l00193"></a>00193          albcnt       <span class="comment">! counter for zenith angle</span>
<a name="l00194"></a>00194 
<a name="l00195"></a>00195        <span class="comment">! out to ocean</span>
<a name="l00196"></a>00196        <span class="comment">! (Note CICE_IN_NEMO does not use these for coupling.</span>
<a name="l00197"></a>00197        <span class="comment">!  It uses fresh_gbm,fsalt_gbm,fhocn_gbm and fswthru_gbm)</span>
<a name="l00198"></a><a class="code" href="namespaceice__flux.html#a2b935c4127f16509133036f6cf544794">00198</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00199"></a>00199          fresh   ,  <span class="comment">! fresh water flux to ocean (kg/m^2/s)</span>
<a name="l00200"></a>00200          fsalt   ,  <span class="comment">! salt flux to ocean (kg/m^2/s)</span>
<a name="l00201"></a>00201          fhocn   ,  <span class="comment">! net heat flux to ocean (W/m^2)</span>
<a name="l00202"></a>00202          fswthru     <span class="comment">! shortwave penetrating to ocean (W/m^2)</span>
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="namespaceice__flux.html#a7b0cfe6f97cfa89da6c797550ce6c4f0">00204</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, 
<a name="l00205"></a>00205         <span class="keywordtype">dimension (nx_block,ny_block,n_aeromx,max_blocks) </span>:: 
<a name="l00206"></a>00206          fsoot        
<a name="l00207"></a>00207 
<a name="l00208"></a>00208        <span class="comment">! internal</span>
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="namespaceice__flux.html#af1c56f1d4d98b83318a54b61776ea37e">00210</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, 
<a name="l00211"></a>00211          <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00212"></a>00212          fswfac  ,  <span class="comment">! for history</span>
<a name="l00213"></a>00213          scale_factor<span class="comment">! scaling factor for shortwave components</span>
<a name="l00214"></a>00214 
<a name="l00215"></a><a class="code" href="namespaceice__flux.html#ac97b083c2136cd4e0deb365a3a3f4f6b">00215</a>       <span class="keywordtype">logical (kind=log_kind) </span>:: 
<a name="l00216"></a>00216          update_ocn_f <span class="comment">! if true, update fresh water and salt fluxes</span>
<a name="l00217"></a>00217 
<a name="l00218"></a>00218       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00219"></a>00219       <span class="comment">! quantities passed from ocean mixed layer to atmosphere</span>
<a name="l00220"></a>00220       <span class="comment">! (for running with CAM)</span>
<a name="l00221"></a>00221       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="namespaceice__flux.html#af9f2e55cc441e661ab391bd3c4640ce4">00223</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00224"></a>00224          strairx_ocn ,  <span class="comment">! stress on ocean by air, x-direction</span>
<a name="l00225"></a>00225          strairy_ocn ,  <span class="comment">! stress on ocean by air, y-direction</span>
<a name="l00226"></a>00226          fsens_ocn   ,  <span class="comment">! sensible heat flux (W/m^2)</span>
<a name="l00227"></a>00227          flat_ocn    ,  <span class="comment">! latent heat flux   (W/m^2)</span>
<a name="l00228"></a>00228          flwout_ocn  ,  <span class="comment">! outgoing longwave radiation (W/m^2)</span>
<a name="l00229"></a>00229          evap_ocn    ,  <span class="comment">! evaporative water flux (kg/m^2/s)</span>
<a name="l00230"></a>00230          alvdr_ocn   ,  <span class="comment">! visible, direct   (fraction)</span>
<a name="l00231"></a>00231          alidr_ocn   ,  <span class="comment">! near-ir, direct   (fraction)</span>
<a name="l00232"></a>00232          alvdf_ocn   ,  <span class="comment">! visible, diffuse  (fraction)</span>
<a name="l00233"></a>00233          alidf_ocn   ,  <span class="comment">! near-ir, diffuse  (fraction)</span>
<a name="l00234"></a>00234          Tref_ocn    ,  <span class="comment">! 2m atm reference temperature (K)</span>
<a name="l00235"></a>00235          Qref_ocn        <span class="comment">! 2m atm reference spec humidity (kg/kg)</span>
<a name="l00236"></a>00236 
<a name="l00237"></a>00237       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00238"></a>00238       <span class="comment">! diagnostic</span>
<a name="l00239"></a>00239       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00240"></a>00240 
<a name="l00241"></a><a class="code" href="namespaceice__flux.html#a081cc6f264496624fb6bce9e69e74d9c">00241</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00242"></a>00242          fsurf ,  <span class="comment">! net surface heat flux (excluding fcondtop)(W/m^2)</span>
<a name="l00243"></a>00243          fcondtop,<span class="comment">! top surface conductive flux        (W/m^2)</span>
<a name="l00244"></a>00244          congel,  <span class="comment">! basal ice growth         (m/step--&gt;cm/day)</span>
<a name="l00245"></a>00245          frazil,  <span class="comment">! frazil ice growth        (m/step--&gt;cm/day)</span>
<a name="l00246"></a>00246          snoice,  <span class="comment">! snow-ice formation       (m/step--&gt;cm/day)</span>
<a name="l00247"></a>00247          meltt ,  <span class="comment">! top ice melt             (m/step--&gt;cm/day)</span>
<a name="l00248"></a>00248          melts ,  <span class="comment">! snow melt                (m/step--&gt;cm/day)</span>
<a name="l00249"></a>00249          meltb ,  <span class="comment">! basal ice melt           (m/step--&gt;cm/day)</span>
<a name="l00250"></a>00250          meltl ,  <span class="comment">! lateral ice melt         (m/step--&gt;cm/day)</span>
<a name="l00251"></a>00251          daidtt,  <span class="comment">! ice area tendency thermo.   (s^-1)</span>
<a name="l00252"></a>00252          dvidtt,  <span class="comment">! ice volume tendency thermo. (m/s)</span>
<a name="l00253"></a>00253          mlt_onset, <span class="comment">! day of year that sfc melting begins</span>
<a name="l00254"></a>00254          frz_onset   <span class="comment">! day of year that freezing begins (congel or frazil)</span>
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="namespaceice__flux.html#aa05e0fe10c9628c94efe017d79f0cd1e">00257</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, 
<a name="l00258"></a>00258          <span class="keywordtype">dimension (nx_block,ny_block,ncat,max_blocks) </span>:: 
<a name="l00259"></a>00259          fsurfn,    <span class="comment">! category fsurf</span>
<a name="l00260"></a>00260          fcondtopn, <span class="comment">! category fcondtop</span>
<a name="l00261"></a>00261          flatn       <span class="comment">! cagegory latent heat flux</span>
<a name="l00262"></a>00262 
<a name="l00263"></a>00263       <span class="comment">! As above but these remain grid box mean values i.e. they are not</span>
<a name="l00264"></a>00264       <span class="comment">! divided by aice at end of ice_dynamics.  These are used in</span>
<a name="l00265"></a>00265       <span class="comment">! CICE_IN_NEMO for coupling and also for generating</span>
<a name="l00266"></a>00266       <span class="comment">! ice diagnostics and history files as these are more accurate.</span>
<a name="l00267"></a>00267       <span class="comment">! (The others suffer from problem of incorrect values at grid boxes</span>
<a name="l00268"></a>00268       <span class="comment">!  that change from an ice free state to an icy state.)</span>
<a name="l00269"></a>00269 
<a name="l00270"></a><a class="code" href="namespaceice__flux.html#ac9af65dc6cf70d6aed3b1eafc170c7a4">00270</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00271"></a>00271          fresh_gbm,  <span class="comment">! fresh water flux to ocean (kg/m^2/s)</span>
<a name="l00272"></a>00272          fsalt_gbm,  <span class="comment">! salt flux to ocean (kg/m^2/s)</span>
<a name="l00273"></a>00273          fhocn_gbm,  <span class="comment">! net heat flux to ocean (W/m^2)</span>
<a name="l00274"></a>00274          fswthru_gbm  <span class="comment">! shortwave penetrating to ocean (W/m^2)</span>
<a name="l00275"></a>00275 
<a name="l00276"></a>00276       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00277"></a>00277       <span class="comment">! internal</span>
<a name="l00278"></a>00278       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00279"></a>00279 
<a name="l00280"></a><a class="code" href="namespaceice__flux.html#aaea76ee9c1cbdc7807e6de1b05378957">00280</a>       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block,max_blocks) </span>:: 
<a name="l00281"></a>00281          rside   ,  <span class="comment">! fraction of ice that melts laterally</span>
<a name="l00282"></a>00282          fsw     ,  <span class="comment">! incoming shortwave radiation (W/m^2)</span>
<a name="l00283"></a>00283          coszen  ,  <span class="comment">! cosine solar zenith angle, &lt; 0 for sun below horizon </span>
<a name="l00284"></a>00284          rdg_conv,  <span class="comment">! convergence term for ridging (1/s)</span>
<a name="l00285"></a>00285          rdg_shear   <span class="comment">! shear term for ridging (1/s)</span>
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="comment">!=======================================================================</span>
<a name="l00288"></a>00288 
<a name="l00289"></a>00289       <span class="keyword">contains</span>
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="comment">!=======================================================================</span>
<a name="l00292"></a>00292 <span class="comment">!BOP</span>
<a name="l00293"></a>00293 <span class="comment">!</span>
<a name="l00294"></a>00294 <span class="comment">! !IROUTINE: init_coupler_flux - initialize fluxes exchanged with coupler</span>
<a name="l00295"></a>00295 <span class="comment">!</span>
<a name="l00296"></a>00296 <span class="comment">! !INTERFACE:</span>
<a name="l00297"></a>00297 <span class="comment">!</span>
<a name="l00298"></a><a class="code" href="namespaceice__flux.html#ac74f9f7368cb2f65428e77204441ef67">00298</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__flux.html#ac74f9f7368cb2f65428e77204441ef67">init_coupler_flux</a>
<a name="l00299"></a>00299 <span class="comment">!</span>
<a name="l00300"></a>00300 <span class="comment">! !DESCRIPTION:</span>
<a name="l00301"></a>00301 <span class="comment">!</span>
<a name="l00302"></a>00302 <span class="comment">! Initialize all fluxes exchanged with flux coupler</span>
<a name="l00303"></a>00303 <span class="comment">! and some data-derived fields</span>
<a name="l00304"></a>00304 <span class="comment">!</span>
<a name="l00305"></a>00305 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00306"></a>00306 <span class="comment">!</span>
<a name="l00307"></a>00307 <span class="comment">! author Elizabeth C. Hunke, LANL</span>
<a name="l00308"></a>00308 <span class="comment">!</span>
<a name="l00309"></a>00309 <span class="comment">! !USES:</span>
<a name="l00310"></a>00310 <span class="comment">!</span>
<a name="l00311"></a>00311 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00312"></a>00312 <span class="comment">!</span>
<a name="l00313"></a>00313 <span class="comment">!EOP</span>
<a name="l00314"></a>00314 <span class="comment">!</span>
<a name="l00315"></a>00315       <span class="keywordtype">integer (kind=int_kind) </span>:: i, j, n, iblk
<a name="l00316"></a>00316 
<a name="l00317"></a>00317       <span class="keywordtype">logical (kind=log_kind)</span>, <span class="keywordtype">parameter</span> ::     
<a name="l00318"></a>00318 <span class="comment">!         l_winter = .true.   ! winter/summer default switch</span>
<a name="l00319"></a>00319          l_winter = .false.   <span class="comment">! winter/summer default switch</span>
<a name="l00320"></a>00320 
<a name="l00321"></a>00321       <span class="keywordtype">real (kind=dbl_kind) </span>:: fcondtopn_d(6), fsurfn_d(6)
<a name="l00322"></a>00322 
<a name="l00323"></a>00323       <span class="keyword">data</span> fcondtopn_d / -50.0_dbl_kind,-17.0_dbl_kind,-12.0_dbl_kind, &amp;
<a name="l00324"></a>00324                           -9.0_dbl_kind, -7.0_dbl_kind, -3.0_dbl_kind /
<a name="l00325"></a>00325       <span class="keyword">data</span> fsurfn_d    /  0.20_dbl_kind, 0.15_dbl_kind, 0.10_dbl_kind, &amp;
<a name="l00326"></a>00326                           0.05_dbl_kind, 0.01_dbl_kind, 0.01_dbl_kind /
<a name="l00327"></a>00327 
<a name="l00328"></a>00328       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00329"></a>00329       <span class="comment">! fluxes received from atmosphere</span>
<a name="l00330"></a>00330       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00331"></a>00331       <a class="code" href="namespaceice__flux.html#a760e7ef6ee3c277e293ab9a2f92685cb">zlvl  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a29dded1ebf63a0561a70a7d94d016fa7">c10</a>             <span class="comment">! atm level height (m)</span>
<a name="l00332"></a>00332       <a class="code" href="namespaceice__flux.html#ab8b07cf5accff1bc998fda8a9255f504">rhoa  </a>(:,:,:) = 1.3_dbl_kind    <span class="comment">! air density (kg/m^3)</span>
<a name="l00333"></a>00333       <a class="code" href="namespaceice__flux.html#accb62713c4d53aa9f56bccfa4faf6507">uatm  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#ad0d6a9a37c461f0151a268757a15c5a4">c5</a>              <span class="comment">! wind velocity    (m/s)</span>
<a name="l00334"></a>00334       <a class="code" href="namespaceice__flux.html#ace0435fd53553a1cae783a932576a39f">vatm  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#ad0d6a9a37c461f0151a268757a15c5a4">c5</a>
<a name="l00335"></a>00335       strax (:,:,:) = 0.05_dbl_kind
<a name="l00336"></a>00336       stray (:,:,:) = 0.05_dbl_kind
<a name="l00337"></a>00337       <span class="keyword">if</span> (l_winter) <span class="keyword">then</span>
<a name="l00338"></a>00338          <span class="comment">!typical winter values</span>
<a name="l00339"></a>00339          <a class="code" href="namespaceice__flux.html#a81beec3343cd05b99ad439d5586d6156">potT  </a>(:,:,:) = 253.0_dbl_kind  <span class="comment">! air potential temp (K)</span>
<a name="l00340"></a>00340          <a class="code" href="namespaceice__flux.html#add98ec71fa0c35dbd9a7afcfa897081d">Tair  </a>(:,:,:) = 253.0_dbl_kind  <span class="comment">! air temperature  (K)</span>
<a name="l00341"></a>00341          <a class="code" href="namespaceice__flux.html#af6a4cdca38aa449d2c23bd0faaead20a">Qa    </a>(:,:,:) = 0.0006_dbl_kind <span class="comment">! specific humidity (kg/kg)</span>
<a name="l00342"></a>00342          <a class="code" href="namespaceice__flux.html#af1a375e8ebfd339a67514570411f3562">swvdr </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00343"></a>00343          <a class="code" href="namespaceice__flux.html#a8c5ea2d2d5d2cd3a07df830e1b7df7c8">swvdf </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00344"></a>00344          <a class="code" href="namespaceice__flux.html#a9062bc1d6f167d11fe38ea7308cea20b">swidr </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00345"></a>00345          <a class="code" href="namespaceice__flux.html#aa83ef052badcc8ce13f5cdcfd363ae0d">swidf </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00346"></a>00346          <a class="code" href="namespaceice__flux.html#a5a996f0c777a83d0532daa407dae18e5">flw   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a4090f4acc886fcf5ff13e21846607eca">c180</a>            <span class="comment">! incoming longwave rad (W/m^2)</span>
<a name="l00347"></a>00347          <a class="code" href="namespaceice__flux.html#a82a0812de1a89016e9cdb1b60e3cab05">frain </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! rainfall rate (kg/m2/s)</span>
<a name="l00348"></a>00348          <a class="code" href="namespaceice__flux.html#ada95784733af0019d97dc30baf7511b4">fsnow </a>(:,:,:) = 4.0e-6_dbl_kind <span class="comment">! snowfall rate (kg/m2/s)</span>
<a name="l00349"></a>00349          <span class="keyword">do</span> n = 1, <a class="code" href="namespaceice__domain__size.html#af6426e75baee1427e99bac2564d5afd7">ncat</a>                  <span class="comment">! conductive heat flux (W/m^2)</span>
<a name="l00350"></a>00350             <a class="code" href="namespaceice__flux.html#af7ddfda012c0a29dc4624f3914ea09f9">fcondtopn_f</a>(:,:,n,:) = fcondtopn_d(n)
<a name="l00351"></a>00351          <span class="keyword">enddo</span>
<a name="l00352"></a>00352          <a class="code" href="namespaceice__flux.html#a248789dd1933e5c3a277f54582b46099">fsurfn_f</a> = <a class="code" href="namespaceice__flux.html#af7ddfda012c0a29dc4624f3914ea09f9">fcondtopn_f</a>          <span class="comment">! surface heat flux (W/m^2)</span>
<a name="l00353"></a>00353          <a class="code" href="namespaceice__flux.html#a5538859203f81cabe03440a3b69f69a4">flatn_f</a>(:,:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>           <span class="comment">! latent heat flux (kg/m2/s)</span>
<a name="l00354"></a>00354       <span class="keyword">else</span>
<a name="l00355"></a>00355          <span class="comment">!typical summer values</span>
<a name="l00356"></a>00356          <a class="code" href="namespaceice__flux.html#a81beec3343cd05b99ad439d5586d6156">potT  </a>(:,:,:) = 273.0_dbl_kind  <span class="comment">! air potential temp (K)</span>
<a name="l00357"></a>00357          <a class="code" href="namespaceice__flux.html#add98ec71fa0c35dbd9a7afcfa897081d">Tair  </a>(:,:,:) = 273.0_dbl_kind  <span class="comment">! air temperature  (K)</span>
<a name="l00358"></a>00358          <a class="code" href="namespaceice__flux.html#af6a4cdca38aa449d2c23bd0faaead20a">Qa    </a>(:,:,:) = 0.0035_dbl_kind <span class="comment">! specific humidity (kg/kg)</span>
<a name="l00359"></a>00359          <a class="code" href="namespaceice__flux.html#af1a375e8ebfd339a67514570411f3562">swvdr </a>(:,:,:) = 50._dbl_kind    <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00360"></a>00360          <a class="code" href="namespaceice__flux.html#a8c5ea2d2d5d2cd3a07df830e1b7df7c8">swvdf </a>(:,:,:) = 50._dbl_kind    <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00361"></a>00361          <a class="code" href="namespaceice__flux.html#a9062bc1d6f167d11fe38ea7308cea20b">swidr </a>(:,:,:) = 50._dbl_kind    <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00362"></a>00362          <a class="code" href="namespaceice__flux.html#aa83ef052badcc8ce13f5cdcfd363ae0d">swidf </a>(:,:,:) = 50._dbl_kind    <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00363"></a>00363          <a class="code" href="namespaceice__flux.html#a5a996f0c777a83d0532daa407dae18e5">flw   </a>(:,:,:) = 280.0_dbl_kind  <span class="comment">! incoming longwave rad (W/m^2)</span>
<a name="l00364"></a>00364          <a class="code" href="namespaceice__flux.html#a82a0812de1a89016e9cdb1b60e3cab05">frain </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! rainfall rate (kg/m2/s)</span>
<a name="l00365"></a>00365          <a class="code" href="namespaceice__flux.html#ada95784733af0019d97dc30baf7511b4">fsnow </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! snowfall rate (kg/m2/s)</span>
<a name="l00366"></a>00366          <span class="keyword">do</span> n = 1, <a class="code" href="namespaceice__domain__size.html#af6426e75baee1427e99bac2564d5afd7">ncat</a>                  <span class="comment">! surface heat flux (W/m^2)</span>
<a name="l00367"></a>00367             <a class="code" href="namespaceice__flux.html#a248789dd1933e5c3a277f54582b46099">fsurfn_f</a>(:,:,n,:) = fsurfn_d(n)
<a name="l00368"></a>00368          <span class="keyword">enddo</span>
<a name="l00369"></a>00369          <a class="code" href="namespaceice__flux.html#af7ddfda012c0a29dc4624f3914ea09f9">fcondtopn_f</a>(:,:,:,:) = 0.0_dbl_kind <span class="comment">! conductive heat flux (W/m^2)</span>
<a name="l00370"></a>00370          <a class="code" href="namespaceice__flux.html#a5538859203f81cabe03440a3b69f69a4">flatn_f</a>(:,:,:,:) = -2.0_dbl_kind    <span class="comment">! latent heat flux (W/m^2)</span>
<a name="l00371"></a>00371       <span class="keyword">endif</span> <span class="comment">!     l_winter</span>
<a name="l00372"></a>00372 
<a name="l00373"></a>00373       <a class="code" href="namespaceice__flux.html#ad99dce71f61486e2450ba1fc5318abb9">faero </a>(:,:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>            <span class="comment">! aerosol deposition rate (kg/m2/s) MH</span>
<a name="l00374"></a>00374 
<a name="l00375"></a>00375       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00376"></a>00376       <span class="comment">! fluxes received from ocean</span>
<a name="l00377"></a>00377       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00378"></a>00378 
<a name="l00379"></a>00379       ss_tltx(:,:,:)= <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! sea surface tilt (m/m)</span>
<a name="l00380"></a>00380       ss_tlty(:,:,:)= <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00381"></a>00381       uocn  (:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! surface ocean currents (m/s)</span>
<a name="l00382"></a>00382       vocn  (:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00383"></a>00383       <a class="code" href="namespaceice__flux.html#af09eb2a499606f27cd8ba847a999df71">frzmlt</a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! freezing/melting potential (W/m^2)</span>
<a name="l00384"></a>00384       <a class="code" href="namespaceice__flux.html#a0549ab71dd5d6a3d23fc54b03daa9aba">sss   </a>(:,:,:) = 34.0_dbl_kind   <span class="comment">! sea surface salinity (o/oo)</span>
<a name="l00385"></a>00385       <span class="keyword">if</span> (trim(<a class="code" href="namespaceice__flux.html#a230173f0ff542e8f4cdc68f1c6a469f9">Tfrzpt</a>) == <span class="stringliteral">&apos;constant&apos;</span>) <span class="keyword">then</span>
<a name="l00386"></a>00386          <a class="code" href="namespaceice__flux.html#a3facf6772fad8bd7af98c69cd56db10c">Tf    </a>(:,:,:) = -1.8_dbl_kind   <span class="comment">! freezing temp (C)</span>
<a name="l00387"></a>00387       <span class="keyword">else</span> <span class="comment">! default:  Tfrzpt = &apos;linear_S&apos;</span>
<a name="l00388"></a>00388          <a class="code" href="namespaceice__flux.html#a3facf6772fad8bd7af98c69cd56db10c">Tf    </a>(:,:,:) = -depressT*<a class="code" href="namespaceice__flux.html#a0549ab71dd5d6a3d23fc54b03daa9aba">sss</a>(:,:,:)  <span class="comment">! freezing temp (C)</span>
<a name="l00389"></a>00389       <span class="keyword">endif</span>
<a name="l00390"></a>00390 <span class="preprocessor">#ifndef CICE_IN_NEMO</span>
<a name="l00391"></a>00391 <span class="preprocessor"></span>      <a class="code" href="namespaceice__flux.html#a760acd33d8c9c15ba312e94fc8b6cdec">sst   </a>(:,:,:) = <a class="code" href="namespaceice__flux.html#a3facf6772fad8bd7af98c69cd56db10c">Tf</a>(:,:,:)       <span class="comment">! sea surface temp (C)</span>
<a name="l00392"></a>00392 <span class="preprocessor">#endif</span>
<a name="l00393"></a>00393 <span class="preprocessor"></span>      <a class="code" href="namespaceice__flux.html#a178c03fc7b766259d4b973b4d055aa1d">qdp   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>              <span class="comment">! deep ocean heat flux (W/m^2)</span>
<a name="l00394"></a>00394       <a class="code" href="namespaceice__flux.html#ab583d7ec90095ce5df9f425a98b70dbd">hmix  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a19a6a387f7968c6067c1ff9c1d5f0b45">c20</a>             <span class="comment">! ocean mixed layer depth</span>
<a name="l00395"></a>00395 
<a name="l00396"></a>00396       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00397"></a>00397       <span class="comment">! fluxes sent to atmosphere</span>
<a name="l00398"></a>00398       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="comment">!echmod - for rectangular grid tests without thermo</span>
<a name="l00401"></a>00401 <span class="comment">!      strairxT(:,:,:) = 0.15_dbl_kind</span>
<a name="l00402"></a>00402 <span class="comment">!      strairyT(:,:,:) = 0.15_dbl_kind</span>
<a name="l00403"></a>00403       strairxT(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>            <span class="comment">! wind stress, T grid</span>
<a name="l00404"></a>00404       strairyT(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00405"></a>00405 <span class="comment">!echmod</span>
<a name="l00406"></a>00406       <a class="code" href="namespaceice__flux.html#ad76df6df986573fcb622fb418d960f37">fsens   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00407"></a>00407       <a class="code" href="namespaceice__flux.html#ab2d967d4946f473fc077416bdd6cd13f">flat    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00408"></a>00408       <a class="code" href="namespaceice__flux.html#af3384816a4840e4df4c79f158e6e9762">fswabs  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00409"></a>00409       <a class="code" href="namespaceice__flux.html#a1ec39d9db775aa2496c0c0ad3ab9c8e4">flwout  </a>(:,:,:) = -stefan_boltzmann*Tffresh**4   
<a name="l00410"></a>00410                         <span class="comment">! in case atm model diagnoses Tsfc from flwout</span>
<a name="l00411"></a>00411       <a class="code" href="namespaceice__flux.html#abfe856f2125b879db70ba8a8a43aaefd">evap    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00412"></a>00412       <a class="code" href="namespaceice__flux.html#a6a0b5fa95bab43f29f8cbd6cbd8f047f">Tref    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00413"></a>00413       <a class="code" href="namespaceice__flux.html#ac332e72481b7da42322f9e2581f09434">Qref    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00414"></a>00414       <a class="code" href="namespaceice__flux.html#a87ebd7f059dc2e9052efba54a0d361ec">alvdr   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00415"></a>00415       <a class="code" href="namespaceice__flux.html#a43c7f22f8888770c074c9affc70d5a6b">alidr   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00416"></a>00416       <a class="code" href="namespaceice__flux.html#a2cb96fbc3ffddc795321900557ce8ff6">alvdf   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00417"></a>00417       <a class="code" href="namespaceice__flux.html#a18a9ac0e0bdd270272fbdc48beab2c8e">alidf   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00420"></a>00420       <span class="comment">! fluxes sent to ocean</span>
<a name="l00421"></a>00421       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00422"></a>00422 
<a name="l00423"></a>00423       strocnxT(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>    <span class="comment">! ice-ocean stress, x-direction (T-cell)</span>
<a name="l00424"></a>00424       strocnyT(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>    <span class="comment">! ice-ocean stress, y-direction (T-cell)</span>
<a name="l00425"></a>00425       <a class="code" href="namespaceice__flux.html#adbdb875a7e468b890dba7204d972c05a">fresh   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00426"></a>00426       <a class="code" href="namespaceice__flux.html#a93da98d35da9e23e802edb93bcaf7477">fsalt   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00427"></a>00427       <a class="code" href="namespaceice__flux.html#ad13e4555d29196de5e5e1130432c5a3a">fhocn   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00428"></a>00428       <a class="code" href="namespaceice__flux.html#a2b935c4127f16509133036f6cf544794">fswthru </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00429"></a>00429 
<a name="l00430"></a>00430       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00431"></a>00431       <span class="comment">! derived or computed fields</span>
<a name="l00432"></a>00432       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00433"></a>00433 
<a name="l00434"></a>00434       <a class="code" href="namespaceice__flux.html#acc02310f399ca37f700f432975393813">fsw     </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>            <span class="comment">! shortwave radiation (W/m^2)</span>
<a name="l00435"></a>00435       <a class="code" href="namespaceice__flux.html#af1c56f1d4d98b83318a54b61776ea37e">scale_factor</a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>        <span class="comment">! shortwave scaling factor</span>
<a name="l00436"></a>00436       <a class="code" href="namespaceice__flux.html#a1f1bd9712740289c1c1348265a70e838">wind    </a>(:,:,:) = sqrt(<a class="code" href="namespaceice__flux.html#accb62713c4d53aa9f56bccfa4faf6507">uatm</a>(:,:,:)**2 &amp;
<a name="l00437"></a>00437                            + <a class="code" href="namespaceice__flux.html#ace0435fd53553a1cae783a932576a39f">vatm</a>(:,:,:)**2)  <span class="comment">! wind speed, (m/s)</span>
<a name="l00438"></a>00438 
<a name="l00439"></a>00439       <a class="code" href="namespaceice__flux.html#af909ebcaf2c2e92389a7dfce1e42f5c7">coszen  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 <span class="keyword">      end subroutine init_coupler_flux</span>
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="comment">!=======================================================================</span>
<a name="l00444"></a>00444 <span class="comment">!BOP</span>
<a name="l00445"></a>00445 <span class="comment">!</span>
<a name="l00446"></a>00446 <span class="comment">! !IROUTINE: init_flux_atm - initialize all atmospheric fluxes sent to coupler</span>
<a name="l00447"></a>00447 <span class="comment">!</span>
<a name="l00448"></a>00448 <span class="comment">! !INTERFACE:</span>
<a name="l00449"></a>00449 <span class="comment">!</span>
<a name="l00450"></a><a class="code" href="namespaceice__flux.html#aa03a1e25e4227bda9639c5a178891acd">00450</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__flux.html#aa03a1e25e4227bda9639c5a178891acd">init_flux_atm</a>
<a name="l00451"></a>00451 <span class="comment">!</span>
<a name="l00452"></a>00452 <span class="comment">! !DESCRIPTION:</span>
<a name="l00453"></a>00453 <span class="comment">!</span>
<a name="l00454"></a>00454 <span class="comment">! Initialize some fluxes sent to coupler for use by the atm model</span>
<a name="l00455"></a>00455 <span class="comment">!</span>
<a name="l00456"></a>00456 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00457"></a>00457 <span class="comment">!</span>
<a name="l00458"></a>00458 <span class="comment">! author: Elizabeth C. Hunke, LANL</span>
<a name="l00459"></a>00459 <span class="comment">!</span>
<a name="l00460"></a>00460 <span class="comment">! !USES:</span>
<a name="l00461"></a>00461 <span class="comment">!</span>
<a name="l00462"></a>00462 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00463"></a>00463 <span class="comment">!</span>
<a name="l00464"></a>00464 <span class="comment">!</span>
<a name="l00465"></a>00465 <span class="comment">!EOP</span>
<a name="l00466"></a>00466 <span class="comment">!</span>
<a name="l00467"></a>00467       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00468"></a>00468       <span class="comment">! initialize albedo and fluxes</span>
<a name="l00469"></a>00469       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00470"></a>00470 
<a name="l00471"></a>00471       strairxT(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>      <span class="comment">! wind stress, T grid</span>
<a name="l00472"></a>00472       strairyT(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00473"></a>00473       <a class="code" href="namespaceice__flux.html#ad76df6df986573fcb622fb418d960f37">fsens   </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00474"></a>00474       <a class="code" href="namespaceice__flux.html#ab2d967d4946f473fc077416bdd6cd13f">flat    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00475"></a>00475       <a class="code" href="namespaceice__flux.html#af3384816a4840e4df4c79f158e6e9762">fswabs  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00476"></a>00476       <a class="code" href="namespaceice__flux.html#a1ec39d9db775aa2496c0c0ad3ab9c8e4">flwout  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00477"></a>00477       <a class="code" href="namespaceice__flux.html#abfe856f2125b879db70ba8a8a43aaefd">evap    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00478"></a>00478       <a class="code" href="namespaceice__flux.html#a6a0b5fa95bab43f29f8cbd6cbd8f047f">Tref    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00479"></a>00479       <a class="code" href="namespaceice__flux.html#ac332e72481b7da42322f9e2581f09434">Qref    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 <span class="keyword">      end subroutine init_flux_atm</span>
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 <span class="comment">!=======================================================================</span>
<a name="l00484"></a>00484 <span class="comment">!BOP</span>
<a name="l00485"></a>00485 <span class="comment">!</span>
<a name="l00486"></a>00486 <span class="comment">! !IROUTINE: init_flux_ocn - initialize ocean fluxes sent to coupler</span>
<a name="l00487"></a>00487 <span class="comment">!</span>
<a name="l00488"></a>00488 <span class="comment">! !INTERFACE:</span>
<a name="l00489"></a>00489 <span class="comment">!</span>
<a name="l00490"></a><a class="code" href="namespaceice__flux.html#a985af4afe9ebb697857f3f5eaf714545">00490</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__flux.html#a985af4afe9ebb697857f3f5eaf714545">init_flux_ocn</a>
<a name="l00491"></a>00491 <span class="comment">!</span>
<a name="l00492"></a>00492 <span class="comment">! !DESCRIPTION:</span>
<a name="l00493"></a>00493 <span class="comment">!</span>
<a name="l00494"></a>00494 <span class="comment">! Initialize some fluxes sent to coupler for use by the ocean model</span>
<a name="l00495"></a>00495 <span class="comment">!</span>
<a name="l00496"></a>00496 <span class="comment">! NOTE: These fluxes should be initialized immediately after the</span>
<a name="l00497"></a>00497 <span class="comment">!       call to the coupler.  The atmospheric fluxes can be initialized</span>
<a name="l00498"></a>00498 <span class="comment">!       at the beginning of the following time step because they are</span>
<a name="l00499"></a>00499 <span class="comment">!       not modified by any subroutines between the call to_coupler</span>
<a name="l00500"></a>00500 <span class="comment">!       and the end of the time step.</span>
<a name="l00501"></a>00501 <span class="comment">!</span>
<a name="l00502"></a>00502 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00503"></a>00503 <span class="comment">!</span>
<a name="l00504"></a>00504 <span class="comment">! author: Elizabeth C. Hunke, LANL</span>
<a name="l00505"></a>00505 <span class="comment">!</span>
<a name="l00506"></a>00506 <span class="comment">! !USES:</span>
<a name="l00507"></a>00507 <span class="comment">!</span>
<a name="l00508"></a>00508 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00509"></a>00509 <span class="comment">!</span>
<a name="l00510"></a>00510 <span class="comment">!</span>
<a name="l00511"></a>00511 <span class="comment">!EOP</span>
<a name="l00512"></a>00512 <span class="comment">!</span>
<a name="l00513"></a>00513       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00514"></a>00514       <span class="comment">! fluxes sent</span>
<a name="l00515"></a>00515       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00516"></a>00516 
<a name="l00517"></a>00517       <a class="code" href="namespaceice__flux.html#adbdb875a7e468b890dba7204d972c05a">fresh  </a>(:,:,:)  = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00518"></a>00518       <a class="code" href="namespaceice__flux.html#a93da98d35da9e23e802edb93bcaf7477">fsalt  </a>(:,:,:)  = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00519"></a>00519       <a class="code" href="namespaceice__flux.html#ad13e4555d29196de5e5e1130432c5a3a">fhocn  </a>(:,:,:)  = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00520"></a>00520       <a class="code" href="namespaceice__flux.html#a7b0cfe6f97cfa89da6c797550ce6c4f0">fsoot  </a>(:,:,:,:)  = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00521"></a>00521       <a class="code" href="namespaceice__flux.html#a2b935c4127f16509133036f6cf544794">fswthru</a>(:,:,:)  = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 <span class="keyword">      end subroutine init_flux_ocn</span>
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <span class="comment">!=======================================================================</span>
<a name="l00526"></a>00526 <span class="comment">!BOP</span>
<a name="l00527"></a>00527 <span class="comment">!</span>
<a name="l00528"></a>00528 <span class="comment">! !IROUTINE: init_history_therm - initialize thermo history fields</span>
<a name="l00529"></a>00529 <span class="comment">!</span>
<a name="l00530"></a>00530 <span class="comment">! !INTERFACE:</span>
<a name="l00531"></a>00531 <span class="comment">!</span>
<a name="l00532"></a><a class="code" href="namespaceice__flux.html#a510c385b0536089d8f4a00ff9c3701cb">00532</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__flux.html#a510c385b0536089d8f4a00ff9c3701cb">init_history_therm</a>
<a name="l00533"></a>00533 <span class="comment">!</span>
<a name="l00534"></a>00534 <span class="comment">! !DESCRIPTION:</span>
<a name="l00535"></a>00535 <span class="comment">!</span>
<a name="l00536"></a>00536 <span class="comment">! Initialize thermodynamic fields written to history files.</span>
<a name="l00537"></a>00537 <span class="comment">!</span>
<a name="l00538"></a>00538 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00539"></a>00539 <span class="comment">!</span>
<a name="l00540"></a>00540 <span class="comment">! authors: William H. Lipscomb, LANL</span>
<a name="l00541"></a>00541 <span class="comment">!          Elizabeth C. Hunke, LANL</span>
<a name="l00542"></a>00542 <span class="comment">!</span>
<a name="l00543"></a>00543 <span class="comment">! !USES:</span>
<a name="l00544"></a>00544 <span class="comment">!</span>
<a name="l00545"></a>00545 <span class="comment">!</span>
<a name="l00546"></a>00546 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00547"></a>00547 <span class="comment">!</span>
<a name="l00548"></a>00548 <span class="comment">!EOP</span>
<a name="l00549"></a>00549 <span class="comment">!</span>
<a name="l00550"></a>00550       use <span class="keywordflow">ice_state</span>, only: aice, vice
<a name="l00551"></a>00551 
<a name="l00552"></a>00552       <a class="code" href="namespaceice__flux.html#a27dbd3d1fc36c0ddb4c39c806d935775">fsurf  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00553"></a>00553       <a class="code" href="namespaceice__flux.html#a0ba73c84e3792cf8704a33f6d95e7f95">fcondtop</a>(:,:,:)= <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00554"></a>00554       <a class="code" href="namespaceice__flux.html#acb44c9e01061e258c35b8dbadf412741">congel </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00555"></a>00555       <a class="code" href="namespaceice__flux.html#a5e63c63db5a472f4041fc150316b8c67">frazil </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00556"></a>00556       <a class="code" href="namespaceice__flux.html#a081cc6f264496624fb6bce9e69e74d9c">snoice </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00557"></a>00557       <a class="code" href="namespaceice__flux.html#aa99daffd05f84f37a6036ce5901100af">meltt  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00558"></a>00558       <a class="code" href="namespaceice__flux.html#aae0e112fe38b436d979dc7fe86cdcb8f">melts  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00559"></a>00559       <a class="code" href="namespaceice__flux.html#acdba57f616cfb780f910b8214a5b6121">meltb  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00560"></a>00560       <a class="code" href="namespaceice__flux.html#a6aafbe05e11bff91bc937c605cf9d121">meltl  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00561"></a>00561       <a class="code" href="namespaceice__flux.html#aff988ec903f1e7908e7b8a176ea792ed">daidtt </a>(:,:,:) = <a class="code" href="namespaceice__state.html#a91eaa8dd8287c9640310a0aec0a85df8">aice</a>(:,:,:) <span class="comment">! temporary initial area</span>
<a name="l00562"></a>00562       <a class="code" href="namespaceice__flux.html#a7c8b98f21bf9431f5d2a10d6643f0752">dvidtt </a>(:,:,:) = <a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(:,:,:) <span class="comment">! temporary initial volume</span>
<a name="l00563"></a>00563       <a class="code" href="namespaceice__flux.html#aa05e0fe10c9628c94efe017d79f0cd1e">fsurfn    </a>(:,:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00564"></a>00564       <a class="code" href="namespaceice__flux.html#a0f22ed9bcb531d5ea26305f27ed19d05">fcondtopn </a>(:,:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00565"></a>00565       <a class="code" href="namespaceice__flux.html#a43363f554cd27a966c89394ce573135e">flatn     </a>(:,:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00566"></a>00566       <a class="code" href="namespaceice__flux.html#a962d1e42294e09b10fb22bc3554aa71b">fresh_gbm  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00567"></a>00567       <a class="code" href="namespaceice__flux.html#ac48af307927403704bd7ad20cb0d54b3">fsalt_gbm  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00568"></a>00568       <a class="code" href="namespaceice__flux.html#a0262e88be5633673703d664fdb6e5123">fhocn_gbm  </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00569"></a>00569       <a class="code" href="namespaceice__flux.html#ac9af65dc6cf70d6aed3b1eafc170c7a4">fswthru_gbm</a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00570"></a>00570       albice (:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00571"></a>00571       albsno (:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00572"></a>00572       albpnd (:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00573"></a>00573      
<a name="l00574"></a>00574 <span class="keyword">      end subroutine init_history_therm</span>
<a name="l00575"></a>00575 
<a name="l00576"></a>00576 <span class="comment">!=======================================================================</span>
<a name="l00577"></a>00577 <span class="comment">!BOP</span>
<a name="l00578"></a>00578 <span class="comment">!</span>
<a name="l00579"></a>00579 <span class="comment">! !IROUTINE: init_history_dyn - initialize dynamic history fields</span>
<a name="l00580"></a>00580 <span class="comment">!</span>
<a name="l00581"></a>00581 <span class="comment">! !INTERFACE:</span>
<a name="l00582"></a>00582 <span class="comment">!</span>
<a name="l00583"></a><a class="code" href="namespaceice__flux.html#adf87450fd972c99fd3d0d4514df29fa9">00583</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__flux.html#adf87450fd972c99fd3d0d4514df29fa9">init_history_dyn</a>
<a name="l00584"></a>00584 <span class="comment">!</span>
<a name="l00585"></a>00585 <span class="comment">! !DESCRIPTION:</span>
<a name="l00586"></a>00586 <span class="comment">!</span>
<a name="l00587"></a>00587 <span class="comment">! Initialize dynamic fields written to history files.</span>
<a name="l00588"></a>00588 <span class="comment">!</span>
<a name="l00589"></a>00589 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00590"></a>00590 <span class="comment">!</span>
<a name="l00591"></a>00591 <span class="comment">! authors: William H. Lipscomb, LANL</span>
<a name="l00592"></a>00592 <span class="comment">!          Elizabeth C. Hunke, LANL</span>
<a name="l00593"></a>00593 <span class="comment">!</span>
<a name="l00594"></a>00594 <span class="comment">! !USES:</span>
<a name="l00595"></a>00595 <span class="comment">!</span>
<a name="l00596"></a>00596       use <span class="keywordflow">ice_state</span>, only: aice, vice
<a name="l00597"></a>00597 <span class="comment">!</span>
<a name="l00598"></a>00598 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00599"></a>00599 <span class="comment">!</span>
<a name="l00600"></a>00600 <span class="comment">!EOP</span>
<a name="l00601"></a>00601 <span class="comment">!</span>
<a name="l00602"></a>00602       <a class="code" href="namespaceice__flux.html#a4e0e291e34267f30266f8a41db36affb">sig1    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00603"></a>00603       <a class="code" href="namespaceice__flux.html#a7bf5a07a0946af77cd35135d6ce11771">sig2    </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00604"></a>00604       <a class="code" href="namespaceice__flux.html#a3302aaf2e5a99949808d98b685228ecf">strocnx </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00605"></a>00605       <a class="code" href="namespaceice__flux.html#a0e146ebf56010398ef99ba1539dbc1ce">strocny </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00606"></a>00606       <a class="code" href="namespaceice__flux.html#aee8a0e6c9637760d2b7153f40ffe0dc1">strairx </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00607"></a>00607       <a class="code" href="namespaceice__flux.html#af29d53fccf8950eaca0c31ea018640aa">strairy </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00608"></a>00608       <a class="code" href="namespaceice__flux.html#a1380a09740e78ddbcc3abe4edc2b3e2f">strtltx </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00609"></a>00609       <a class="code" href="namespaceice__flux.html#ac9c1e92371b4e39d2aa9f38548b011ff">strtlty </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00610"></a>00610       <a class="code" href="namespaceice__flux.html#aff350f7a31d4c9cc9429ef1a14d1c91f">strintx </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00611"></a>00611       <a class="code" href="namespaceice__flux.html#a8bfac55007c715a028b0ac9b8e9daed5">strinty </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00612"></a>00612       <a class="code" href="namespaceice__flux.html#ac0303bfce72171bb93ea1a621dc453eb">dardg1dt</a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00613"></a>00613       <a class="code" href="namespaceice__flux.html#a8d3dec0f51ebd0b3aaf71909b190656a">dardg2dt</a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00614"></a>00614       <a class="code" href="namespaceice__flux.html#ade5480c0fdf0d8989ec199ab6c494df2">dvirdgdt</a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00615"></a>00615       <a class="code" href="namespaceice__flux.html#ae0a39366aa114290bad9340508d55fd7">opening </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00616"></a>00616       <a class="code" href="namespaceice__flux.html#a24c9cd15dee4efbf6d35e4bafb03a6e0">daidtd  </a>(:,:,:) = <a class="code" href="namespaceice__state.html#a91eaa8dd8287c9640310a0aec0a85df8">aice</a>(:,:,:) <span class="comment">! temporary initial area</span>
<a name="l00617"></a>00617       <a class="code" href="namespaceice__flux.html#ab2731d6607c7b88522d1a843d4a38a50">dvidtd  </a>(:,:,:) = <a class="code" href="namespaceice__state.html#a097435b3544c01705ca626cc43ee61b5">vice</a>(:,:,:) <span class="comment">! temporary initial volume</span>
<a name="l00618"></a>00618       <a class="code" href="namespaceice__flux.html#aa2cb3a98eac5adcd5441f55fe26be618">fm      </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00619"></a>00619       <a class="code" href="namespaceice__flux.html#a4406d054e8437ab55dc01d6e5b9c8882">prs_sig </a>(:,:,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 <span class="keyword">      end subroutine init_history_dyn</span>
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="comment">!=======================================================================</span>
<a name="l00624"></a>00624 <span class="comment">!BOP</span>
<a name="l00625"></a>00625 <span class="comment">!</span>
<a name="l00626"></a>00626 <span class="comment">! !IROUTINE: merge_fluxes - aggregate flux information over ITD</span>
<a name="l00627"></a>00627 <span class="comment">!</span>
<a name="l00628"></a>00628 <span class="comment">! !INTERFACE:</span>
<a name="l00629"></a>00629 <span class="comment">!</span>
<a name="l00630"></a><a class="code" href="namespaceice__flux.html#aef9c3629a862eb2f134c9aa6b7935acc">00630</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__flux.html#aef9c3629a862eb2f134c9aa6b7935acc">merge_fluxes</a> (nx_block, ny_block,   &amp;
<a name="l00631"></a>00631                                icells,               &amp;
<a name="l00632"></a>00632                                indxi,    indxj,      &amp;
<a name="l00633"></a>00633                                aicen,                &amp;    
<a name="l00634"></a>00634                                <a class="code" href="namespaceice__flux.html#a5a996f0c777a83d0532daa407dae18e5">flw</a>,      coszn,      &amp;
<a name="l00635"></a>00635                                strairxn, strairyn,   &amp;
<a name="l00636"></a>00636                                <a class="code" href="namespaceice__flux.html#aa05e0fe10c9628c94efe017d79f0cd1e">fsurfn</a>,   <a class="code" href="namespaceice__flux.html#a0f22ed9bcb531d5ea26305f27ed19d05">fcondtopn</a>,  &amp;
<a name="l00637"></a>00637                                fsensn,   <a class="code" href="namespaceice__flux.html#a43363f554cd27a966c89394ce573135e">flatn</a>,      &amp; 
<a name="l00638"></a>00638                                fswabsn,  flwoutn,    &amp;
<a name="l00639"></a>00639                                evapn,                &amp;
<a name="l00640"></a>00640                                Trefn,    Qrefn,      &amp;
<a name="l00641"></a>00641                                freshn,   fsaltn,     &amp;
<a name="l00642"></a>00642                                fhocnn,   fswthrun,   &amp;
<a name="l00643"></a>00643                                strairxT, strairyT,   &amp;  
<a name="l00644"></a>00644                                <a class="code" href="namespaceice__flux.html#a27dbd3d1fc36c0ddb4c39c806d935775">fsurf</a>,    <a class="code" href="namespaceice__flux.html#a0ba73c84e3792cf8704a33f6d95e7f95">fcondtop</a>,   &amp;
<a name="l00645"></a>00645                                <a class="code" href="namespaceice__flux.html#ad76df6df986573fcb622fb418d960f37">fsens</a>,    <a class="code" href="namespaceice__flux.html#ab2d967d4946f473fc077416bdd6cd13f">flat</a>,       &amp; 
<a name="l00646"></a>00646                                <a class="code" href="namespaceice__flux.html#af3384816a4840e4df4c79f158e6e9762">fswabs</a>,   <a class="code" href="namespaceice__flux.html#a1ec39d9db775aa2496c0c0ad3ab9c8e4">flwout</a>,     &amp;
<a name="l00647"></a>00647                                <a class="code" href="namespaceice__flux.html#abfe856f2125b879db70ba8a8a43aaefd">evap</a>,                 &amp; 
<a name="l00648"></a>00648                                <a class="code" href="namespaceice__flux.html#a6a0b5fa95bab43f29f8cbd6cbd8f047f">Tref</a>,     <a class="code" href="namespaceice__flux.html#ac332e72481b7da42322f9e2581f09434">Qref</a>,       &amp;
<a name="l00649"></a>00649                                <a class="code" href="namespaceice__flux.html#adbdb875a7e468b890dba7204d972c05a">fresh</a>,    <a class="code" href="namespaceice__flux.html#a93da98d35da9e23e802edb93bcaf7477">fsalt</a>,      &amp;
<a name="l00650"></a>00650                                <a class="code" href="namespaceice__flux.html#ad13e4555d29196de5e5e1130432c5a3a">fhocn</a>,    <a class="code" href="namespaceice__flux.html#a2b935c4127f16509133036f6cf544794">fswthru</a>,    &amp;
<a name="l00651"></a>00651                                melttn, meltsn, meltbn, congeln, snoicen, &amp;
<a name="l00652"></a>00652                                <a class="code" href="namespaceice__flux.html#aa99daffd05f84f37a6036ce5901100af">meltt</a>,  <a class="code" href="namespaceice__flux.html#aae0e112fe38b436d979dc7fe86cdcb8f">melts</a>,  &amp;
<a name="l00653"></a>00653                                <a class="code" href="namespaceice__flux.html#acdba57f616cfb780f910b8214a5b6121">meltb</a>,                       &amp;
<a name="l00654"></a>00654                                <a class="code" href="namespaceice__flux.html#acb44c9e01061e258c35b8dbadf412741">congel</a>,  <a class="code" href="namespaceice__flux.html#a081cc6f264496624fb6bce9e69e74d9c">snoice</a>)
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 <span class="comment">!</span>
<a name="l00657"></a>00657 <span class="comment">! !DESCRIPTION:</span>
<a name="l00658"></a>00658 <span class="comment">!</span>
<a name="l00659"></a>00659 <span class="comment">! Aggregate flux information from all ice thickness categories</span>
<a name="l00660"></a>00660 <span class="comment">!</span>
<a name="l00661"></a>00661 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00662"></a>00662 <span class="comment">!</span>
<a name="l00663"></a>00663 <span class="comment">! author: Elizabeth C. Hunke and William H. Lipscomb, LANL</span>
<a name="l00664"></a>00664 <span class="comment">!</span>
<a name="l00665"></a>00665 <span class="comment">! !USES:</span>
<a name="l00666"></a>00666 <span class="comment">!</span>
<a name="l00667"></a>00667 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00668"></a>00668 <span class="comment">!</span>
<a name="l00669"></a>00669       <span class="keywordtype">integer (kind=int_kind)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l00670"></a>00670           nx_block, ny_block,  <span class="comment">! block dimensions</span>
<a name="l00671"></a>00671           icells                <span class="comment">! number of cells with aicen &gt; puny</span>
<a name="l00672"></a>00672 
<a name="l00673"></a>00673       <span class="keywordtype">integer (kind=int_kind)</span>, <span class="keywordtype">dimension(nx_block*ny_block)</span>, 
<a name="l00674"></a>00674           <span class="keywordtype">intent(in)</span> :: 
<a name="l00675"></a>00675           indxi, indxj    <span class="comment">! compressed indices for cells with aicen &gt; puny</span>
<a name="l00676"></a>00676 
<a name="l00677"></a>00677       <span class="comment">! single category fluxes</span>
<a name="l00678"></a>00678       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension(nx_block,ny_block)</span>, <span class="keywordtype">intent(in)</span>:: 
<a name="l00679"></a>00679           aicen   ,  <span class="comment">! concentration of ice</span>
<a name="l00680"></a>00680           flw     ,  <span class="comment">! downward longwave flux          (W/m**2)</span>
<a name="l00681"></a>00681           coszn   ,  <span class="comment">! cosine of solar zenith angle </span>
<a name="l00682"></a>00682           strairxn,  <span class="comment">! air/ice zonal  strss,           (N/m**2)</span>
<a name="l00683"></a>00683           strairyn,  <span class="comment">! air/ice merdnl strss,           (N/m**2)</span>
<a name="l00684"></a>00684           fsurfn  ,  <span class="comment">! net heat flux to top surface    (W/m**2)</span>
<a name="l00685"></a>00685           fcondtopn, <span class="comment">! downward cond flux at top sfc   (W/m**2)</span>
<a name="l00686"></a>00686           fsensn  ,  <span class="comment">! sensible heat flx               (W/m**2)</span>
<a name="l00687"></a>00687           flatn   ,  <span class="comment">! latent   heat flx               (W/m**2)</span>
<a name="l00688"></a>00688           fswabsn ,  <span class="comment">! shortwave absorbed heat flx     (W/m**2)</span>
<a name="l00689"></a>00689           flwoutn ,  <span class="comment">! upwd lw emitted heat flx        (W/m**2)</span>
<a name="l00690"></a>00690           evapn   ,  <span class="comment">! evaporation                     (kg/m2/s)</span>
<a name="l00691"></a>00691           Trefn   ,  <span class="comment">! air tmp reference level         (K)</span>
<a name="l00692"></a>00692           Qrefn   ,  <span class="comment">! air sp hum reference level      (kg/kg)</span>
<a name="l00693"></a>00693           freshn  ,  <span class="comment">! fresh water flux to ocean       (kg/m2/s)</span>
<a name="l00694"></a>00694           fsaltn  ,  <span class="comment">! salt flux to ocean              (kg/m2/s)</span>
<a name="l00695"></a>00695           fhocnn  ,  <span class="comment">! actual ocn/ice heat flx         (W/m**2)</span>
<a name="l00696"></a>00696           fswthrun,  <span class="comment">! sw radiation through ice bot    (W/m**2)</span>
<a name="l00697"></a>00697           melttn  ,  <span class="comment">! top ice melt                    (m)</span>
<a name="l00698"></a>00698           meltbn  ,  <span class="comment">! bottom ice melt                 (m)</span>
<a name="l00699"></a>00699           meltsn  ,  <span class="comment">! snow melt                       (m)</span>
<a name="l00700"></a>00700           congeln ,  <span class="comment">! congelation ice growth          (m)</span>
<a name="l00701"></a>00701           snoicen     <span class="comment">! snow-ice growth                 (m)</span>
<a name="l00702"></a>00702 
<a name="l00703"></a>00703       <span class="comment">! cumulative fluxes</span>
<a name="l00704"></a>00704       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension(nx_block,ny_block)</span>, 
<a name="l00705"></a>00705           <span class="keywordtype">intent(inout)</span>:: 
<a name="l00706"></a>00706           strairxT,  <span class="comment">! air/ice zonal  strss,           (N/m**2)</span>
<a name="l00707"></a>00707           strairyT,  <span class="comment">! air/ice merdnl strss,           (N/m**2)</span>
<a name="l00708"></a>00708           fsurf   ,  <span class="comment">! net heat flux to top surface    (W/m**2)</span>
<a name="l00709"></a>00709           fcondtop,  <span class="comment">! downward cond flux at top sfc   (W/m**2)</span>
<a name="l00710"></a>00710           fsens   ,  <span class="comment">! sensible heat flx               (W/m**2)</span>
<a name="l00711"></a>00711           flat    ,  <span class="comment">! latent   heat flx               (W/m**2)</span>
<a name="l00712"></a>00712           fswabs  ,  <span class="comment">! shortwave absorbed heat flx     (W/m**2)</span>
<a name="l00713"></a>00713           flwout  ,  <span class="comment">! upwd lw emitted heat flx        (W/m**2)</span>
<a name="l00714"></a>00714           evap    ,  <span class="comment">! evaporation                     (kg/m2/s)</span>
<a name="l00715"></a>00715           Tref    ,  <span class="comment">! air tmp reference level         (K)</span>
<a name="l00716"></a>00716           Qref    ,  <span class="comment">! air sp hum reference level      (kg/kg)</span>
<a name="l00717"></a>00717           fresh   ,  <span class="comment">! fresh water flux to ocean       (kg/m2/s)</span>
<a name="l00718"></a>00718           fsalt   ,  <span class="comment">! salt flux to ocean              (kg/m2/s)</span>
<a name="l00719"></a>00719           fhocn   ,  <span class="comment">! actual ocn/ice heat flx         (W/m**2)</span>
<a name="l00720"></a>00720           fswthru ,  <span class="comment">! sw radiation through ice bot    (W/m**2)</span>
<a name="l00721"></a>00721           meltt   ,  <span class="comment">! top ice melt                    (m)</span>
<a name="l00722"></a>00722           meltb   ,  <span class="comment">! bottom ice melt                 (m)</span>
<a name="l00723"></a>00723           melts   ,  <span class="comment">! snow melt                       (m)</span>
<a name="l00724"></a>00724           congel  ,  <span class="comment">! congelation ice growth          (m)</span>
<a name="l00725"></a>00725           snoice      <span class="comment">! snow-ice growth                 (m)</span>
<a name="l00726"></a>00726 
<a name="l00727"></a>00727 <span class="comment">!</span>
<a name="l00728"></a>00728 <span class="comment">!EOP</span>
<a name="l00729"></a>00729 <span class="comment">!</span>
<a name="l00730"></a>00730       <span class="keywordtype">integer (kind=int_kind) </span>:: 
<a name="l00731"></a>00731           ij, i, j    <span class="comment">! horizontal indices</span>
<a name="l00732"></a>00732 
<a name="l00733"></a>00733       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00734"></a>00734       <span class="comment">! Merge fluxes</span>
<a name="l00735"></a>00735       <span class="comment">!-----------------------------------------------------------------</span>
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 <span class="comment">!DIR$ CONCURRENT !Cray</span>
<a name="l00738"></a>00738 <span class="comment">!cdir nodep      !NEC</span>
<a name="l00739"></a>00739 <span class="comment">!ocl novrec      !Fujitsu</span>
<a name="l00740"></a>00740       <span class="keyword">do</span> ij = 1, icells
<a name="l00741"></a>00741          i = indxi(ij)
<a name="l00742"></a>00742          j = indxj(ij)
<a name="l00743"></a>00743 
<a name="l00744"></a>00744          <span class="comment">! atmo fluxes</span>
<a name="l00745"></a>00745 
<a name="l00746"></a>00746          strairxT (i,j)  = strairxT(i,j) + strairxn(i,j)*aicen(i,j)
<a name="l00747"></a>00747          strairyT (i,j)  = strairyT(i,j) + strairyn(i,j)*aicen(i,j)
<a name="l00748"></a>00748          fsurf    (i,j)  = fsurf   (i,j) + fsurfn  (i,j)*aicen(i,j)
<a name="l00749"></a>00749          fcondtop (i,j)  = fcondtop(i,j) + fcondtopn(i,j)*aicen(i,j)
<a name="l00750"></a>00750          fsens    (i,j)  = fsens   (i,j) + fsensn  (i,j)*aicen(i,j)
<a name="l00751"></a>00751          flat     (i,j)  = flat    (i,j) + flatn   (i,j)*aicen(i,j)
<a name="l00752"></a>00752          fswabs   (i,j)  = fswabs  (i,j) + fswabsn (i,j)*aicen(i,j)
<a name="l00753"></a>00753          flwout   (i,j)  = flwout  (i,j) &amp;
<a name="l00754"></a>00754              + (flwoutn(i,j) - (<a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a>-emissivity)*flw(i,j))*aicen(i,j)
<a name="l00755"></a>00755          evap     (i,j)  = evap    (i,j) + evapn   (i,j)*aicen(i,j)
<a name="l00756"></a>00756          Tref     (i,j)  = Tref    (i,j) + Trefn   (i,j)*aicen(i,j)
<a name="l00757"></a>00757          Qref     (i,j)  = Qref    (i,j) + Qrefn   (i,j)*aicen(i,j)
<a name="l00758"></a>00758 
<a name="l00759"></a>00759          <span class="comment">! ocean fluxes</span>
<a name="l00760"></a>00760 
<a name="l00761"></a>00761          fresh    (i,j) = fresh     (i,j) + freshn  (i,j)*aicen(i,j)
<a name="l00762"></a>00762          fsalt    (i,j) = fsalt     (i,j) + fsaltn  (i,j)*aicen(i,j)
<a name="l00763"></a>00763          fhocn    (i,j) = fhocn     (i,j) + fhocnn  (i,j)*aicen(i,j)
<a name="l00764"></a>00764          fswthru  (i,j) = fswthru   (i,j) + fswthrun(i,j)*aicen(i,j)
<a name="l00765"></a>00765 
<a name="l00766"></a>00766          <span class="comment">! ice/snow thickness</span>
<a name="l00767"></a>00767 
<a name="l00768"></a>00768          meltt    (i,j) = meltt    (i,j) + melttn  (i,j)*aicen(i,j)
<a name="l00769"></a>00769          meltb    (i,j) = meltb    (i,j) + meltbn  (i,j)*aicen(i,j)
<a name="l00770"></a>00770          melts    (i,j) = melts    (i,j) + meltsn  (i,j)*aicen(i,j)
<a name="l00771"></a>00771          congel   (i,j) = congel   (i,j) + congeln (i,j)*aicen(i,j)
<a name="l00772"></a>00772          snoice   (i,j) = snoice   (i,j) + snoicen (i,j)*aicen(i,j)
<a name="l00773"></a>00773 
<a name="l00774"></a>00774       <span class="keyword">enddo</span>                     <span class="comment">! ij</span>
<a name="l00775"></a>00775       
<a name="l00776"></a>00776 <span class="keyword">      end subroutine merge_fluxes</span>
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 <span class="comment">!=======================================================================</span>
<a name="l00779"></a>00779 <span class="comment">!BOP</span>
<a name="l00780"></a>00780 <span class="comment">!</span>
<a name="l00781"></a>00781 <span class="comment">! !IROUTINE: scale_fluxes</span>
<a name="l00782"></a>00782 <span class="comment">!</span>
<a name="l00783"></a>00783 <span class="comment">! !DESCRIPTION:</span>
<a name="l00784"></a>00784 <span class="comment">!</span>
<a name="l00785"></a>00785 <span class="comment">!  Divide ice fluxes by ice area before sending them to the</span>
<a name="l00786"></a>00786 <span class="comment">!  coupler, since the coupler multiplies by ice area. This</span>
<a name="l00787"></a>00787 <span class="comment">!  is the ice area at the beginning of the timestep, i.e.</span>
<a name="l00788"></a>00788 <span class="comment">!  coupler, since the coupler multiplies by ice area.</span>
<a name="l00789"></a>00789 <span class="comment">!</span>
<a name="l00790"></a>00790 <span class="comment">! !INTERFACE:</span>
<a name="l00791"></a>00791 <span class="comment">!</span>
<a name="l00792"></a><a class="code" href="namespaceice__flux.html#a66344c677dd9f73743df68dcf3d203d9">00792</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceice__flux.html#a66344c677dd9f73743df68dcf3d203d9">scale_fluxes</a> (nx_block, ny_block, &amp;
<a name="l00793"></a>00793                                tmask,              &amp;
<a name="l00794"></a>00794                                aice,     <a class="code" href="namespaceice__flux.html#a3facf6772fad8bd7af98c69cd56db10c">Tf</a>,       &amp;
<a name="l00795"></a>00795                                <a class="code" href="namespaceice__flux.html#add98ec71fa0c35dbd9a7afcfa897081d">Tair</a>,     <a class="code" href="namespaceice__flux.html#af6a4cdca38aa449d2c23bd0faaead20a">Qa</a>,       &amp;
<a name="l00796"></a>00796                                strairxT, strairyT, &amp;
<a name="l00797"></a>00797                                <a class="code" href="namespaceice__flux.html#ad76df6df986573fcb622fb418d960f37">fsens</a>,    <a class="code" href="namespaceice__flux.html#ab2d967d4946f473fc077416bdd6cd13f">flat</a>,     &amp;
<a name="l00798"></a>00798                                <a class="code" href="namespaceice__flux.html#af3384816a4840e4df4c79f158e6e9762">fswabs</a>,   <a class="code" href="namespaceice__flux.html#a1ec39d9db775aa2496c0c0ad3ab9c8e4">flwout</a>,   &amp;
<a name="l00799"></a>00799                                <a class="code" href="namespaceice__flux.html#abfe856f2125b879db70ba8a8a43aaefd">evap</a>,               &amp;
<a name="l00800"></a>00800                                <a class="code" href="namespaceice__flux.html#a6a0b5fa95bab43f29f8cbd6cbd8f047f">Tref</a>,     <a class="code" href="namespaceice__flux.html#ac332e72481b7da42322f9e2581f09434">Qref</a>,     &amp;
<a name="l00801"></a>00801                                <a class="code" href="namespaceice__flux.html#adbdb875a7e468b890dba7204d972c05a">fresh</a>,    <a class="code" href="namespaceice__flux.html#a93da98d35da9e23e802edb93bcaf7477">fsalt</a>,    &amp;
<a name="l00802"></a>00802                                <a class="code" href="namespaceice__flux.html#ad13e4555d29196de5e5e1130432c5a3a">fhocn</a>,    <a class="code" href="namespaceice__flux.html#a2b935c4127f16509133036f6cf544794">fswthru</a>,  &amp;
<a name="l00803"></a>00803                                <a class="code" href="namespaceice__flux.html#a7b0cfe6f97cfa89da6c797550ce6c4f0">fsoot</a>,              &amp;
<a name="l00804"></a>00804                                <a class="code" href="namespaceice__flux.html#a87ebd7f059dc2e9052efba54a0d361ec">alvdr</a>,    <a class="code" href="namespaceice__flux.html#a43c7f22f8888770c074c9affc70d5a6b">alidr</a>,    &amp;
<a name="l00805"></a>00805                                <a class="code" href="namespaceice__flux.html#a2cb96fbc3ffddc795321900557ce8ff6">alvdf</a>,    <a class="code" href="namespaceice__flux.html#a18a9ac0e0bdd270272fbdc48beab2c8e">alidf</a>)
<a name="l00806"></a>00806 <span class="comment">!</span>
<a name="l00807"></a>00807 <span class="comment">! !REVISION HISTORY:</span>
<a name="l00808"></a>00808 <span class="comment">!</span>
<a name="l00809"></a>00809 <span class="comment">! authors: C.M.Bitz, William H. Lipscomb</span>
<a name="l00810"></a>00810 <span class="comment">!</span>
<a name="l00811"></a>00811 <span class="comment">! !USES:</span>
<a name="l00812"></a>00812 <span class="comment">!</span>
<a name="l00813"></a>00813 <span class="comment">! !INPUT/OUTPUT PARAMETERS:</span>
<a name="l00814"></a>00814 <span class="comment">!</span>
<a name="l00815"></a>00815       <span class="keywordtype">integer (kind=int_kind)</span>, <span class="keywordtype">intent(in)</span> :: 
<a name="l00816"></a>00816           nx_block, ny_block   <span class="comment">! block dimensions</span>
<a name="l00817"></a>00817 
<a name="l00818"></a>00818       <span class="keywordtype">logical (kind=log_kind)</span>, <span class="keywordtype">dimension (nx_block,ny_block)</span>, 
<a name="l00819"></a>00819           <span class="keywordtype">intent(in)</span> :: 
<a name="l00820"></a>00820           tmask     <span class="comment">! land/boundary mask, thickness (T-cell)</span>
<a name="l00821"></a>00821 
<a name="l00822"></a>00822 
<a name="l00823"></a>00823       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension(nx_block,ny_block)</span>, 
<a name="l00824"></a>00824           <span class="keywordtype">intent(in)</span>:: 
<a name="l00825"></a>00825           aice    ,  <span class="comment">! fractional ice area</span>
<a name="l00826"></a>00826           Tf      ,  <span class="comment">! freezing temperature            (C)</span>
<a name="l00827"></a>00827           Tair    ,  <span class="comment">! surface air temperature         (K)</span>
<a name="l00828"></a>00828           Qa          <span class="comment">! sfc air specific humidity       (kg/kg)</span>
<a name="l00829"></a>00829 
<a name="l00830"></a>00830       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension(nx_block,ny_block)</span>, 
<a name="l00831"></a>00831           <span class="keywordtype">intent(inout)</span>:: 
<a name="l00832"></a>00832           strairxT,  <span class="comment">! air/ice zonal  stress           (N/m**2)</span>
<a name="l00833"></a>00833           strairyT,  <span class="comment">! air/ice merdnl stress           (N/m**2)</span>
<a name="l00834"></a>00834           fsens   ,  <span class="comment">! sensible heat flx               (W/m**2)</span>
<a name="l00835"></a>00835           flat    ,  <span class="comment">! latent   heat flx               (W/m**2)</span>
<a name="l00836"></a>00836           fswabs  ,  <span class="comment">! shortwave absorbed heat flx     (W/m**2)</span>
<a name="l00837"></a>00837           flwout  ,  <span class="comment">! upwd lw emitted heat flx        (W/m**2)</span>
<a name="l00838"></a>00838           evap    ,  <span class="comment">! evaporation                     (kg/m2/s)</span>
<a name="l00839"></a>00839           Tref    ,  <span class="comment">! air tmp reference level         (K)</span>
<a name="l00840"></a>00840           Qref    ,  <span class="comment">! air sp hum reference level      (kg/kg)</span>
<a name="l00841"></a>00841           fresh   ,  <span class="comment">! fresh water flux to ocean       (kg/m2/s)</span>
<a name="l00842"></a>00842           fsalt   ,  <span class="comment">! salt flux to ocean              (kg/m2/s)</span>
<a name="l00843"></a>00843           fhocn   ,  <span class="comment">! actual ocn/ice heat flx         (W/m**2)</span>
<a name="l00844"></a>00844           fswthru ,  <span class="comment">! sw radiation through ice bot    (W/m**2)</span>
<a name="l00845"></a>00845           alvdr   ,  <span class="comment">! visible, direct   (fraction)</span>
<a name="l00846"></a>00846           alidr   ,  <span class="comment">! near-ir, direct   (fraction)</span>
<a name="l00847"></a>00847           alvdf   ,  <span class="comment">! visible, diffuse  (fraction)</span>
<a name="l00848"></a>00848           alidf       <span class="comment">! near-ir, diffuse  (fraction)</span>
<a name="l00849"></a>00849 
<a name="l00850"></a>00850       <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension(nx_block,ny_block,n_aeromx)</span>, 
<a name="l00851"></a>00851           <span class="keywordtype">intent(inout)</span>:: 
<a name="l00852"></a>00852           fsoot       <span class="comment">! </span>
<a name="l00853"></a>00853 <span class="comment">!</span>
<a name="l00854"></a>00854 <span class="comment">!EOP</span>
<a name="l00855"></a>00855 <span class="comment">!</span>
<a name="l00856"></a>00856       <span class="keywordtype">real (kind=dbl_kind) </span>:: ar   <span class="comment">! 1/aice</span>
<a name="l00857"></a>00857 
<a name="l00858"></a>00858       <span class="keywordtype">integer (kind=int_kind) </span>:: 
<a name="l00859"></a>00859           i, j    <span class="comment">! horizontal indices</span>
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 <span class="comment">!DIR$ CONCURRENT !Cray</span>
<a name="l00863"></a>00863 <span class="comment">!cdir nodep      !NEC</span>
<a name="l00864"></a>00864 <span class="comment">!ocl novrec      !Fujitsu</span>
<a name="l00865"></a>00865       <span class="keyword">do</span> j = 1, ny_block
<a name="l00866"></a>00866       <span class="keyword">do</span> i = 1, nx_block
<a name="l00867"></a>00867          <span class="keyword">if</span> (tmask(i,j) .and. aice(i,j) &gt; <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>) <span class="keyword">then</span>
<a name="l00868"></a>00868             ar = <a class="code" href="namespaceice__constants.html#a74c3f6d59942aec40dda487c6af99039">c1</a> / aice(i,j)
<a name="l00869"></a>00869             strairxT(i,j) = strairxT(i,j) * ar
<a name="l00870"></a>00870             strairyT(i,j) = strairyT(i,j) * ar
<a name="l00871"></a>00871             fsens   (i,j) = fsens   (i,j) * ar
<a name="l00872"></a>00872             flat    (i,j) = flat    (i,j) * ar
<a name="l00873"></a>00873             fswabs  (i,j) = fswabs  (i,j) * ar
<a name="l00874"></a>00874             flwout  (i,j) = flwout  (i,j) * ar
<a name="l00875"></a>00875             evap    (i,j) = evap    (i,j) * ar
<a name="l00876"></a>00876             Tref    (i,j) = Tref    (i,j) * ar
<a name="l00877"></a>00877             Qref    (i,j) = Qref    (i,j) * ar
<a name="l00878"></a>00878             fresh   (i,j) = fresh   (i,j) * ar
<a name="l00879"></a>00879             fsalt   (i,j) = fsalt   (i,j) * ar
<a name="l00880"></a>00880             fhocn   (i,j) = fhocn   (i,j) * ar
<a name="l00881"></a>00881             fswthru (i,j) = fswthru (i,j) * ar
<a name="l00882"></a>00882             alvdr   (i,j) = alvdr   (i,j) * ar
<a name="l00883"></a>00883             alidr   (i,j) = alidr   (i,j) * ar
<a name="l00884"></a>00884             alvdf   (i,j) = alvdf   (i,j) * ar
<a name="l00885"></a>00885             alidf   (i,j) = alidf   (i,j) * ar
<a name="l00886"></a>00886             fsoot   (i,j,:) = fsoot (i,j,:) * ar
<a name="l00887"></a>00887          <span class="keyword">else</span>                   <span class="comment">! zero out fluxes</span>
<a name="l00888"></a>00888             strairxT(i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00889"></a>00889             strairyT(i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00890"></a>00890             fsens   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00891"></a>00891             flat    (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00892"></a>00892             fswabs  (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00893"></a>00893             flwout  (i,j) = -stefan_boltzmann *(Tf(i,j) + Tffresh)**4
<a name="l00894"></a>00894                <span class="comment">! to make upward longwave over ocean reasonable for history file</span>
<a name="l00895"></a>00895             evap    (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00896"></a>00896             Tref    (i,j) = Tair(i,j)
<a name="l00897"></a>00897             Qref    (i,j) = Qa  (i,j)
<a name="l00898"></a>00898             fresh   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00899"></a>00899             fsalt   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00900"></a>00900             fhocn   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00901"></a>00901             fsoot   (i,j,:) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00902"></a>00902             fswthru (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00903"></a>00903             alvdr   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>  <span class="comment">! zero out albedo where ice is absent</span>
<a name="l00904"></a>00904             alidr   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00905"></a>00905             alvdf   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a> 
<a name="l00906"></a>00906             alidf   (i,j) = <a class="code" href="namespaceice__constants.html#a8320d3c058c4ae0e12bbf1b11305e51e">c0</a>
<a name="l00907"></a>00907          <span class="keyword">endif</span>                  <span class="comment">! tmask and aice &gt; 0</span>
<a name="l00908"></a>00908       <span class="keyword">enddo</span>                     <span class="comment">! i</span>
<a name="l00909"></a>00909       <span class="keyword">enddo</span>                     <span class="comment">! j</span>
<a name="l00910"></a>00910       
<a name="l00911"></a>00911 <span class="keyword">      end subroutine scale_fluxes</span>
<a name="l00912"></a>00912 
<a name="l00913"></a>00913 <span class="comment">!=======================================================================</span>
<a name="l00914"></a>00914 
<a name="l00915"></a>00915 <span class="keyword">      end module ice_flux</span>
<a name="l00916"></a>00916 
<a name="l00917"></a>00917 <span class="comment">!=======================================================================</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Oct 6 14:02:23 2009 for CICE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
