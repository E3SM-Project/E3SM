
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../code_structure/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Quick-start Guide - E3SM</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quick-start-guide-for-developers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="E3SM" class="md-header__button md-logo" aria-label="E3SM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            E3SM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Quick-start Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/E3SM-Project/E3SM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    E3SM-Project/E3SM
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="E3SM" class="md-nav__button md-logo" aria-label="E3SM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    E3SM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/E3SM-Project/E3SM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    E3SM-Project/E3SM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    E3SM Basics
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            E3SM Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../dev-guide/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev-guide/adding-grid-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding Support for New Grids
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Components
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Data-Models/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data-Models
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Data-Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Models/user-guide/data-atmos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atmosphere
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Models/user-guide/data-land/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Land
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-Models/user-guide/data-ocean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ocean
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../EAM/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EAM
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            EAM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../EAM/user-guide/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/user-guide/namelist_parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Namelist Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/user-guide/aerosol_phys_prop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aerosol Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/user-guide/emission_oxidant_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Emission Oxidants
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../EAM/tech-guide/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Technical Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            Technical Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/homme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High-Order Methods Modeling Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/atmosphere-grid-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atmosphere Grid Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/p3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Predicted Particle Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/clubb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud Layers Unified By Binormals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/zm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zhang and McFarlane deep convection scheme
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/rrtmg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RRTMG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/orodrag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Orographic drag scheme
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/mam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modal Aerosol Module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/vbs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Volatility Basis Set (VBS) approach for SOA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/dust/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dust aerosol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/oceanfilms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCEANFILMS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/chemUCIlinozv3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chemUCI and Linoz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/cosp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    COSP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/armdiags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARM diagnostics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EAMxx
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            EAMxx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../user/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/user_quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick-start Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/eamxx_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EAMxx case basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_4" >
        
          
          <label class="md-nav__link" for="__nav_3_3_2_4" id="__nav_3_3_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/user_testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/model_input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model input
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/model_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model output
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/nudging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nudging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/clean_clear_sky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extra radiation calls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/cosp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    COSP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/rrm_eamxx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regionally Refined EAMxx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/dp_eamxx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Doubly Periodic EAMxx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/pyscream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PySCREAM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user/io_metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO Metadata
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Quick-start Guide
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Quick-start Guide
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      Motivation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stratosphere-level-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Stratosphere-level Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stratosphere-level Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#note-on-computing-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Note on Computing Platforms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-get-started-quickly" class="md-nav__link">
    <span class="md-ellipsis">
      Let's Get Started (Quickly)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Let's Get Started (Quickly)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modifying-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Modifying Source Code
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modifying Source Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-the-new-process-to-cmake-build" class="md-nav__link">
    <span class="md-ellipsis">
      Add the New Process to CMake Build
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-verification-and-validation-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Verification and Validation Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding Verification and Validation Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-process-validation-test" class="md-nav__link">
    <span class="md-ellipsis">
      Single-process Validation Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-level-verification-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Function-level Verification Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-process-validation-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-process Validation Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-modifications-to-existing-code" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Modifications to Existing Code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-build-test-repeat" class="md-nav__link">
    <span class="md-ellipsis">
      Code, Build, Test, Repeat...
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code, Build, Test, Repeat...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selected-useful-testing-options" class="md-nav__link">
    <span class="md-ellipsis">
      Selected Useful Testing Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-on-supported-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Testing on Supported Machines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-locally" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Locally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suggested-very-thorough-and-conservative-testing-progression" class="md-nav__link">
    <span class="md-ellipsis">
      Suggested (Very Thorough and Conservative) Testing Progression
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submit-code-to-e3sm" class="md-nav__link">
    <span class="md-ellipsis">
      Submit Code to E3SM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Structure and Organization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../style_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Style Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../dev_testing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_3_6" id="__nav_3_3_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_6">
            <span class="md-nav__icon md-icon"></span>
            Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev_testing/full_model_testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Full model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev_testing/ci_nightly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI and Nightly Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev_testing/supported_machines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supported Computing Platforms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev_testing/test_all_scream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automated Standalone Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev_testing/local_test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing Locally
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kokkos_ekat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kokkos and EKAT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_8" id="__nav_3_3_3_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Important Computational Data Structures and Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_8">
            <span class="md-nav__icon md-icon"></span>
            Important Computational Data Structures and Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grids and Remappers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../processes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atmosphere Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    I/O
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../technical/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Technical Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_4" id="__nav_3_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_4">
            <span class="md-nav__icon md-icon"></span>
            Technical Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical/aerocom_cldtop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AeroCom cloud top
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ELM/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ELM
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            ELM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ELM/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ELM/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ELM/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../MOSART/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    MOSART
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            MOSART
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../MPAS-Ocean/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    MPAS-Ocean
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            MPAS-Ocean
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MPAS-Ocean/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users's Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MPAS-Ocean/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers's Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MPAS-Ocean/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../MPAS-seaice/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    MPAS-seaice
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            MPAS-seaice
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MPAS-seaice/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User's Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MPAS-seaice/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MPAS-seaice/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer's Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MPAS-seaice/references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../generate_domain_files/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    generate_domain_files
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            generate_domain_files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    More Information
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            More Information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="http://docs.e3sm.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    E3SM-Project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="http://e3sm.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    e3sm.org
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      Motivation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stratosphere-level-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Stratosphere-level Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stratosphere-level Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#note-on-computing-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Note on Computing Platforms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-get-started-quickly" class="md-nav__link">
    <span class="md-ellipsis">
      Let's Get Started (Quickly)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Let's Get Started (Quickly)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modifying-source-code" class="md-nav__link">
    <span class="md-ellipsis">
      Modifying Source Code
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modifying Source Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-the-new-process-to-cmake-build" class="md-nav__link">
    <span class="md-ellipsis">
      Add the New Process to CMake Build
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-verification-and-validation-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Verification and Validation Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding Verification and Validation Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-process-validation-test" class="md-nav__link">
    <span class="md-ellipsis">
      Single-process Validation Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-level-verification-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Function-level Verification Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-process-validation-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-process Validation Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-modifications-to-existing-code" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Modifications to Existing Code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-build-test-repeat" class="md-nav__link">
    <span class="md-ellipsis">
      Code, Build, Test, Repeat...
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code, Build, Test, Repeat...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selected-useful-testing-options" class="md-nav__link">
    <span class="md-ellipsis">
      Selected Useful Testing Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-on-supported-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Testing on Supported Machines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-locally" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Locally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suggested-very-thorough-and-conservative-testing-progression" class="md-nav__link">
    <span class="md-ellipsis">
      Suggested (Very Thorough and Conservative) Testing Progression
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submit-code-to-e3sm" class="md-nav__link">
    <span class="md-ellipsis">
      Submit Code to E3SM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  
    
      
    
    <a href="https://github.com/E3SM-Project/screamdeveloper/dev_quickstart.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="quick-start-guide-for-developers">Quick-start Guide for Developers</h1>
<h2 id="todo">TODO</h2>
<ul>
<li>Mention full-model, but don't go into detail</li>
</ul>
<h2 id="motivation">Motivation</h2>
<p>The intention of this guide is to provide a new developer with the most straightforward path toward productively building, running, and testing EAMxx.
Specifically, we will discuss building and testing in the EAMxx "standalone" configuration using the <code>test-all-scream</code> workflow.
Note that tests related to running the full E3SM model are discussed in <a href="../dev_testing/full_model_testing/">Full Model Testing</a>.</p>
<h2 id="stratosphere-level-overview">Stratosphere-level Overview</h2>
<p>At the most basic level, EAMxx is built and run using <a href="https://cmake.org">CMake</a>, a widely-used tool to "automatically"<sup id="fnref:automagic-cmake"><a class="footnote-ref" href="#fn:automagic-cmake">1</a></sup> configure, build, and test a project that will run on the system being employed.
Thus, one can certainly build and test EAMxx with their own customized CMake setup.
However, we would strongly advise against doing this unless you know what you're doing and have good reasons for choosing this option.
Instead, we recommend using the EAMxx-designed <code>test-all-scream</code> workflow that employs a variety of shell and python scripts to automate the series of tasks common to development.
More details on this are provided below in the <a href="#code-build-test-repeat">Testing Section</a>, and full details may be found in <a href="../dev_testing/test_all_scream/">EAMxx Automated Standalone Testing</a></p>
<h3 id="note-on-computing-platforms">Note on Computing Platforms</h3>
<p>EAMxx is tested and ==(unofficially?) supported== on the <a href="https://e3sm.org/model/running-e3sm/supported-machines/">E3SM-supported machines</a>.
This means that, if you have an account on one of these machines, EAMxx tests can be run with no extra configuration required.
However, many of the standalone EAMxx tests are able to be run on a reasonably-equipped laptop or personal workstation.<sup id="fnref:but-mac"><a class="footnote-ref" href="#fn:but-mac">2</a></sup>
This second choice requires some extra configurations but the effort required may be worth the potential speedup in development.</p>
<h2 id="lets-get-started-quickly">Let's Get Started (Quickly)</h2>
<p>For the purposes of this quick-start guide, we will employ the working example of adding a new <a href="../../common/glossary/#atmospheric-process">processes</a> to the MAM4xx aerosol library, specifically the not-real, example process "<strong>AshInjection</strong>."
The source files for this process will be found at <code>src/physics/mam/</code>.
Note that here, and for the remainder of this guide, we will denote all paths relative to the EAMxx root directory <code>E3SM/components/eamxx/</code> (see <a href="../code_structure/">Code Structure</a> for additional details on how EAMxx code is organized).</p>
<div class="admonition warning">
<p class="admonition-title">Disclaimer</p>
<p>We make use of many code snippets below for <strong><em>demonstrative purposes</em></strong>.
As such, we provide no guarantee that any of these are working code, and the author would be quite surprised if more than a couple of them run without edits.
If you should take the time to debug these examples, feel free to submit a PR with a working version, and we are sure some future developer will appreciate it!</p>
</div>
<h3 id="modifying-source-code">Modifying Source Code</h3>
<p>The minimum files required for a new process will be those defining the interface to EAMxx.
For our case, and following the current informal naming standard, these will be the <code>eamxx_aerosolve_process_interface.&lt;x&gt;pp</code> files, located at <code>src/physics/mam/</code>, and trivial skeleton examples are provided below.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">eamxx_inject_ash_process_interface.hpp</label><label for="__tabbed_1_2">eamxx_inject_ash_process_interface.cpp</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cp">#ifndef EAMXX_MAM_INJECT_ASH_HPP</span>
<span class="cp">#define EAMXX_MAM_INJECT_ASH_HPP</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;share/atm_process/atmosphere_process.hpp&quot;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">scream</span><span class="w"> </span><span class="p">{</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MAMInjectAsh</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">AtmosphereProcess</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">MAMInjectAsh</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ekat</span><span class="o">::</span><span class="n">Comm</span><span class="o">&amp;</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">ekat</span><span class="o">::</span><span class="n">ParameterList</span><span class="o">&amp;</span><span class="w"> </span><span class="n">params</span><span class="p">);</span>
<span class="w">  </span><span class="n">AtmosphereProcessType</span><span class="w"> </span><span class="nf">type</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">AtmosphereProcessType</span><span class="o">::</span><span class="n">Physics</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">name</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;MAMInjectAsh&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">set_grids</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">GridsManager</span><span class="o">&gt;</span><span class="w"> </span><span class="n">grids_manager</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="k">protected</span><span class="o">:</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initialize_impl</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RunType</span><span class="w"> </span><span class="n">run_type</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">run_impl</span><span class="w">        </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">finalize_impl</span><span class="w">   </span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* Nothing to do */</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="n">Field</span><span class="w"> </span><span class="n">source_mask</span><span class="p">;</span>
<span class="w">  </span><span class="n">Field</span><span class="w"> </span><span class="n">lat</span><span class="p">;</span>
<span class="w">  </span><span class="n">Field</span><span class="w"> </span><span class="n">lon</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// namespace scream</span>

<span class="cp">#endif  </span><span class="c1">// EAMXX_MAM_AEROSOLVE_HPP</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;eamxx_inject_ash_process_interface.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ash_source_calculation.hpp&quot;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">scream</span><span class="w"> </span><span class="p">{</span>

<span class="n">MAMInjectAsh</span><span class="o">::</span><span class="n">MAMInjectAsh</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ekat</span><span class="o">::</span><span class="n">Comm</span><span class="o">&amp;</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">ekat</span><span class="o">::</span><span class="n">ParameterList</span><span class="o">&amp;</span><span class="w"> </span><span class="n">params</span><span class="p">)</span>
<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">AtmosphereProcess</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">[...]</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="n">MAMInjectAsh</span><span class="o">::</span><span class="n">set_grids</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">GridsManager</span><span class="o">&gt;</span><span class="w"> </span><span class="n">grids_manager</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">kg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ekat</span><span class="o">::</span><span class="n">units</span><span class="o">::</span><span class="n">kg</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grids_manager</span><span class="o">-&gt;</span><span class="n">get_grid</span><span class="p">(</span><span class="s">&quot;Physics&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">add_tracer</span><span class="o">&lt;</span><span class="n">Updated</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;ash&quot;</span><span class="p">,</span><span class="n">grid</span><span class="p">,</span><span class="n">kg</span><span class="o">/</span><span class="n">kg</span><span class="p">);</span>
<span class="w">  </span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grid</span><span class="o">-&gt;</span><span class="n">get_geometry_data</span><span class="p">(</span><span class="s">&quot;lat&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grid</span><span class="o">-&gt;</span><span class="n">get_geometry_data</span><span class="p">(</span><span class="s">&quot;lon&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="n">MAM_AshInjection</span><span class="o">::</span><span class="n">initialize_impl</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RunType</span><span class="w"> </span><span class="n">run_type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">source_mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_field_out</span><span class="p">(</span><span class="s">&quot;ash&quot;</span><span class="p">).</span><span class="n">clone</span><span class="p">(</span><span class="s">&quot;source_mask&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">[...]</span><span class="w"> </span><span class="c1">// set source_mask=1 only on area of interest, using lat/lon field</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="n">MAM_AshInjection</span><span class="o">::</span><span class="n">run_impl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span><span class="w"> </span><span class="c1">// timestamp() is the START of step time</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">ash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_field_out</span><span class="p">(</span><span class="s">&quot;ash&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_ash_injection_rate</span><span class="p">(</span><span class="n">t</span><span class="p">);</span><span class="w"> </span><span class="c1">// defined in ash_source_calculation.hpp header</span>
<span class="w">  </span><span class="n">ash</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">source_mask</span><span class="p">,</span><span class="n">rate</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">decay</span><span class="p">);</span><span class="w"> </span><span class="c1">// ash = decay*ash + rate*dt*source_mask</span>
<span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// namespace scream</span>
</code></pre></div>
</div>
</div>
</div>
<h4 id="add-the-new-process-to-cmake-build">Add the New Process to CMake Build</h4>
<p>In order to ensure the code you've added is configured and built by CMake, we need to add to the relevant <code>CMakeLists.txt</code> file.
At minimum, we need to add <code>eamxx_aerosolve_process_interface.cpp</code> to the EAMxx library named <code>mam</code>, as shown below.
Of course, there may be additional configuration commands that are required for a proper build, but this is beyond the scope of this guide.</p>
<div class="highlight"><span class="filename">src/physics/mam/CMakeLists.txt</span><pre><span></span><code><span class="err">[...]</span>
<span class="c"># EAMxx mam4xx-based atmospheric processes</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">mam</span>
<span class="w">  </span><span class="s">eamxx_mam_microphysics_process_interface.cpp</span>
<span class="w">  </span><span class="s">eamxx_mam_optics_process_interface.cpp</span>
<span class="w">  </span><span class="s">[...]</span>
<span class="w">  </span><span class="s">eamxx_aerosolve_process_interface.cpp</span><span class="p">)</span>
<span class="err">[...]</span>
</code></pre></div>
<h3 id="adding-verification-and-validation-tests">Adding Verification and Validation Tests</h3>
<p>All new code that is added to EAMxx is required to be tested.
At minimum, a process must be <strong>Validation Tested</strong>.
That is, tested against known, trusted data, and this data can be samples taken by real-world instruments or comparable results generated by other code.
Ideally, any new and sufficiently complex functions should also have <strong>Verification Tests</strong> that test for mathematical or scientific "correctness".<sup id="fnref:correct-huh"><a class="footnote-ref" href="#fn:correct-huh">3</a></sup></p>
<h4 id="single-process-validation-test">Single-process Validation Test</h4>
<p>First, we add a validation test for (only) our new process to 
<div class="highlight"><pre><span></span><code>tests/single-process/mam/aerosolve/
</code></pre></div>
Defining the test behavior and pass/fail criteria requires 3 files:</p>
<ul>
<li><code>CMakeLists.txt</code><ul>
<li>Largely reusable boilerplate code but should be tailored to the proper test parameters.</li>
<li>Defines build and run behavior.</li>
<li>Enumerates the required NetCDF input files.</li>
</ul>
</li>
<li><code>input.yaml</code><ul>
<li>Defines key parameters for the model and test run.</li>
<li>Enumerates the keys (<code>std::string</code>) used to access the input files from within the process source code.</li>
<li>Provides information about the test's initial condition.<ul>
<li>Input file names/paths.</li>
<li>Other required input values.</li>
</ul>
</li>
</ul>
</li>
<li><code>output.yaml</code><ul>
<li>Defines the output fields used as pass/fail criteria.</li>
<li>Defines the tests runtime output behavior.</li>
</ul>
</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">CMakeLists.txt</label><label for="__tabbed_2_2">input.yaml</label><label for="__tabbed_2_3">output.yaml</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">include</span><span class="w"> </span><span class="p">(</span><span class="s">ScreamUtils</span><span class="p">)</span>

<span class="nb">set</span><span class="w"> </span><span class="p">(</span><span class="s">TEST_BASE_NAME</span><span class="w"> </span><span class="s">mam4_aerosolve_standalone</span><span class="p">)</span>
<span class="nb">set</span><span class="w"> </span><span class="p">(</span><span class="s">FIXTURES_BASE_NAME</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_BASE_NAME</span><span class="o">}</span><span class="s">_generate_output_nc_files</span><span class="p">)</span>
<span class="c"># Create the test</span>
<span class="nb">CreateADUnitTest</span><span class="p">(</span><span class="o">${</span><span class="nv">TEST_BASE_NAME</span><span class="o">}</span>
<span class="w">  </span><span class="s">LABELS</span><span class="w"> </span><span class="s">mam4_aerosolve</span><span class="w"> </span><span class="s">physics</span>
<span class="w">  </span><span class="s">LIBS</span><span class="w"> </span><span class="s">mam</span>
<span class="w">  </span><span class="s">MPI_RANKS</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_RANK_START</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_RANK_END</span><span class="o">}</span>
<span class="w">  </span><span class="s">FIXTURES_SETUP_INDIVIDUAL</span><span class="w"> </span><span class="o">${</span><span class="nv">FIXTURES_BASE_NAME</span><span class="o">}</span>
<span class="p">)</span>

<span class="c"># Set AD configurable options</span>
<span class="nb">set</span><span class="w"> </span><span class="p">(</span><span class="s">ATM_TIME_STEP</span><span class="w"> </span><span class="s">1800</span><span class="p">)</span>
<span class="nb">SetVarDependingOnTestSize</span><span class="p">(</span><span class="s">NUM_STEPS</span><span class="w"> </span><span class="s">2</span><span class="w"> </span><span class="s">5</span><span class="w"> </span><span class="s">48</span><span class="p">)</span><span class="w">  </span><span class="c"># 1h 2.5h 24h</span>
<span class="nb">set</span><span class="w"> </span><span class="p">(</span><span class="s">RUN_T0</span><span class="w"> </span><span class="s">2021-10-12-45000</span><span class="p">)</span>

<span class="c"># Copy (and configure) yaml files needed by tests</span>
<span class="nb">configure_file</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/input.yaml</span>
<span class="w">               </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="s">/input.yaml</span><span class="p">)</span>
<span class="nb">configure_file</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/output.yaml</span>
<span class="w">               </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="s">/output.yaml</span><span class="p">)</span>

<span class="c"># Ensure test input files are present in the data dir</span>
<span class="nb">set</span><span class="w"> </span><span class="p">(</span><span class="s">TEST_INPUT_FILES</span>
<span class="w">  </span><span class="s">scream/init/</span><span class="o">${</span><span class="nv">aerosolve_IC_file</span><span class="o">}</span>
<span class="w">  </span><span class="s">scream/mam4xx/.../aerosolve_input_data_file_ABC.nc</span>
<span class="w">  </span><span class="s">scream/mam4xx/.../aerosolve_input_data_file_XYZ.nc</span>
<span class="w">  </span><span class="s">[...]</span>
<span class="w">  </span><span class="s">&lt;path-to-required-input-file&gt;</span>
<span class="p">)</span>
<span class="nb">foreach</span><span class="w"> </span><span class="p">(</span><span class="s">file</span><span class="w"> </span><span class="s">IN</span><span class="w"> </span><span class="s">ITEMS</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_INPUT_FILES</span><span class="o">}</span><span class="p">)</span>
<span class="w">  </span><span class="nb">GetInputFile</span><span class="p">(</span><span class="o">${</span><span class="nv">file</span><span class="o">}</span><span class="p">)</span>
<span class="nb">endforeach</span><span class="p">()</span>

<span class="c"># Compare results between runs employing differing numbers of MPI ranks</span>
<span class="c"># to ensure they are bfb</span>
<span class="nb">include</span><span class="w"> </span><span class="p">(</span><span class="s">CompareNCFiles</span><span class="p">)</span>
<span class="nb">CompareNCFilesFamilyMpi</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="s">TEST_BASE_NAME</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_BASE_NAME</span><span class="o">}</span>
<span class="w">  </span><span class="s">FILE_META_NAME</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_BASE_NAME</span><span class="o">}</span><span class="s">_output.INSTANT.nsteps_x1.npMPIRANKS.</span><span class="o">${</span><span class="nv">RUN_T0</span><span class="o">}</span><span class="s">.nc</span>
<span class="w">  </span><span class="s">MPI_RANKS</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_RANK_START</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_RANK_END</span><span class="o">}</span>
<span class="w">  </span><span class="s">LABELS</span><span class="w"> </span><span class="s">mam4_aerosolve</span><span class="w"> </span><span class="s">physics</span>
<span class="w">  </span><span class="s">META_FIXTURES_REQUIRED</span><span class="w"> </span><span class="o">${</span><span class="nv">FIXTURES_BASE_NAME</span><span class="o">}</span><span class="s">_npMPIRANKS_omp1</span>
<span class="p">)</span>
<span class="c"># Compare one of the output files with the baselines.</span>
<span class="c"># Note: one is enough, since we already check that np1 is BFB with npX</span>
<span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">SCREAM_ENABLE_BASELINE_TESTS</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="w"> </span><span class="p">(</span><span class="s">OUT_FILE</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_BASE_NAME</span><span class="o">}</span><span class="s">_output.INSTANT.nsteps_x1.np</span><span class="o">${</span><span class="nv">TEST_RANK_END</span><span class="o">}</span><span class="s">.</span><span class="o">${</span><span class="nv">RUN_T0</span><span class="o">}</span><span class="s">.nc</span><span class="p">)</span>
<span class="w">  </span><span class="nb">CreateBaselineTest</span><span class="p">(</span><span class="o">${</span><span class="nv">TEST_BASE_NAME</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">TEST_RANK_END</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">OUT_FILE</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">FIXTURES_BASE_NAME</span><span class="o">}</span><span class="p">)</span><span class="w"> </span>
<span class="nb">endif</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">%YAML</span><span class="w"> </span><span class="m">1.1</span>
<span class="nn">---</span>
<span class="nt">driver_options</span><span class="p">:</span>
<span class="w">  </span><span class="nt">atmosphere_dag_verbosity_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">time_stepping</span><span class="p">:</span>
<span class="w">  </span><span class="nt">time_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${ATM_TIME_STEP}</span>
<span class="w">  </span><span class="nt">run_t0</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${RUN_T0}</span><span class="w">  </span><span class="c1"># YYYY-MM-DD-XXXXX</span>
<span class="w">  </span><span class="nt">number_of_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${NUM_STEPS}</span>
<span class="nt">atmosphere_processes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">atm_procs_list</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">mam4_aerosolve</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">mam4_aerosolve</span><span class="p">:</span>
<span class="w">    </span><span class="nt">aerosolve_ABC_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SCREAM_DATA_DIR}/mam4xx/.../aerosolve_input_data_file_ABC.nc</span>
<span class="w">    </span><span class="nt">aerosolve_XYZ_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SCREAM_DATA_DIR}/mam4xx/.../aerosolve_input_data_file_XYZ.nc</span>
<span class="w">    </span><span class="nt">&lt;identifying-string-used-by-aerosolve_xyz.xpp&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/.../data_file.nc</span>
<span class="nt">grids_manager</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mesh Free</span>
<span class="w">  </span><span class="nt">geo_data_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IC_FILE</span>
<span class="w">  </span><span class="nt">grids_names</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Physics GLL</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">Physics GLL</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">point_grid</span>
<span class="w">    </span><span class="nt">aliases</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Physics</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">number_of_global_columns</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">218</span>
<span class="w">    </span><span class="nt">number_of_vertical_levels</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">72</span>
<span class="nt">initial_conditions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># The name of the file containing the initial conditions for this test.</span>
<span class="w">  </span><span class="nt">Filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SCREAM_DATA_DIR}/init/${aerosolve_IC_file}</span>
<span class="w">  </span><span class="nt">topography_filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${TOPO_DATA_DIR}/${EAMxx_tests_TOPO_FILE}</span>

<span class="w">  </span><span class="c1"># other variables to pass as input</span>
<span class="w">  </span><span class="nt">num_ABC </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42.0</span>
<span class="w">  </span><span class="nt">num_XYZ </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.618</span>
<span class="w">  </span><span class="nt">&lt;input_variable&gt; </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;value&gt;</span>
<span class="c1"># The parameters for I/O control</span>
<span class="nt">Scorpio</span><span class="p">:</span>
<span class="w">  </span><span class="nt">output_yaml_files</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;output.yaml&quot;</span><span class="p p-Indicator">]</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">%YAML</span><span class="w"> </span><span class="m">1.1</span>
<span class="nn">---</span>
<span class="nt">filename_prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mam4_aerosolve_standalone_output</span>
<span class="nt">Averaging Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Instant</span>
<span class="nt">Fields</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Physics</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Field Names</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">answer_field</span>
<span class="nt">output_control</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Frequency</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">frequency_units</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nsteps</span>
<span class="nn">...</span>
</code></pre></div>
</div>
</div>
</div>
<h4 id="function-level-verification-tests">Function-level Verification Tests</h4>
<p>Next, because of the highly-technical nature of our new <code>compute_ash_injection_rate</code> function, we add a verification test to the 'tests/' subdirectory, co-located with the source code (<code>src/physics/mam/</code>).
This subdirectory contains a <code>CMakeLists.txt</code> that we modify to add our new test to the build system.
Any required data files should be placed here, and the preferred format for data is <a href="https://yaml.org">yaml</a>, though <a href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a> can also be used.</p>
<div class="highlight"><span class="filename">src/physics/mam/tests/ash_injection.cpp</span><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;catch2/catch.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ash_source_calculation.hpp&quot;</span>

<span class="k">namespace</span><span class="w"> </span><span class="p">{</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">scream</span><span class="p">;</span>
<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;verify aerosolver&quot;</span><span class="p">,</span><span class="s">&quot;mam&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">// initialize the data and test variables</span>
<span class="w">  </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-12</span><span class="p">;</span>
<span class="w">  </span><span class="n">util</span><span class="o">::</span><span class="n">TimeStamp</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<span class="w">  </span><span class="n">util</span><span class="o">::</span><span class="n">TimeStamp</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">86400</span><span class="o">*</span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="c1">// 100 days later</span>
<span class="w">  </span><span class="p">[...]</span>
<span class="w">  </span><span class="c1">// call the function we are testing</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">rate1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_ash_injection_rate</span><span class="p">(</span><span class="n">t1</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">rate2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_ash_injection_rate</span><span class="p">(</span><span class="n">t2</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// apply the REQUIRE() function from catch2/catch.hpp to test</span>
<span class="w">  </span><span class="c1">// whether the resulting test answer is within a set error tolerance</span>
<span class="w">  </span><span class="c1">// from the reference answer. Check all properties that are meaningful</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="w"> </span><span class="p">(</span><span class="n">rate1</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="w"> </span><span class="p">(</span><span class="n">rate2</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="w"> </span><span class="p">(</span><span class="n">rate2</span><span class="o">&lt;</span><span class="n">rate1</span><span class="p">);</span>
<span class="w">  </span><span class="p">[...]</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="multi-process-validation-tests">Multi-process Validation Tests</h4>
<p>Finally, because the <strong>AshInjection</strong> process is not called in isolation, we must validate the results generated when <strong>AshInjection</strong> is called in combination with other processes.
At time of writing, these tests are divided into the self-describing directories <code>physics_only</code> and <code>dynamics_physics</code>.
The subdirectories and test directories are named according to the convention of listing the names of included processes and potentially relevant grid information.
Generally speaking, these tests are configured in the same manner as the single-process tests, via the 3 files <code>CMakeLists.txt</code>, <code>input.yaml</code>, <code>output.yaml</code>, and for this reason we omit further details</p>
<h4 id="testing-modifications-to-existing-code">Testing Modifications to Existing Code</h4>
<p>Note that if you are merely modifying or augmenting existing code, you may not need to create additional tests, provided there is already a test that targets the piece of code that was edited.
However, one case for which you <strong><em>should</em></strong> create a test is when adding a new function to existing code.
In this case, a verification test should be added that checks the new functionality for correctness.</p>
<h3 id="code-build-test-repeat">Code, Build, Test, Repeat...</h3>
<p>Now that we've written all of the necessary code and there are no errors, we build EAMxx, run our tests, and watch them pass with flying colors.
:white_check_mark:</p>
<p>However, for those of us that are mere mortals, we may need to iterate on this process a bit until everything works perfectly.
In this case, the automated build and test workflow provided by <code>scripts/test-all-scream</code> is designed to make this cycle as painless as possible.</p>
<h4 id="selected-useful-testing-options">Selected Useful Testing Options</h4>
<p>We give an overview of common basic use cases here, and we provide full details on the various capabilities and options of <code>test-all-scream</code> in <a href="../dev_testing/test_all_scream/">EAMxx Automated Standalone Testing</a>.</p>
<details class="example">
<summary>Configure Only Without Build or Test</summary>
<p><strong>Useful for:</strong> Mid-development testing when debugging compilation, and it may be useful to confirm/debug changes to CMakeLists.txt, file dependencies, TPL availability, etc.</p>
<div class="copy highlight"><pre><span></span><code>$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span>--config-only
</code></pre></div>
</details>
<details class="tip">
<summary>Parallel Build and Test Execution</summary>
<p><strong>Note:</strong></p>
<ul>
<li>This is unnecessary when running on <a href="https://e3sm.org/model/running-e3sm/supported-machines/">supported machines</a> because efficient defaults are already set within <code>test-all-scream</code>.</li>
<li>If you are testing locally or on an otherwise unsupported machine, it is recommended to set these values manually.<ul>
<li>The reason for this is that the default value for each case is <code>0</code>, which should theoretically choose the optimal number of threads on modern systems, but there is no guarantee this will behave as expected or that it will not bog down your system.</li>
</ul>
</li>
</ul>
<div class="copy highlight"><pre><span></span><code>$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="c1"># if running multiple test configurations, this will launch those build stacks in parallel \</span>
<span class="w">    </span>--parallel<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="c1"># will compile using M threads (equivalent to a manual &#39;make -jM&#39;) \</span>
<span class="w">    </span>--make-parallel-level<span class="w"> </span>&lt;M&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="c1"># will run tests of the same configuration using N threads \</span>
<span class="w">    </span><span class="c1"># (FIXME: interaction with &#39;--parallel&#39; ?) \</span>
<span class="w">    </span>--ctest-parallel-level<span class="w"> </span>&lt;N&gt;<span class="w"> </span><span class="se">\</span>
</code></pre></div>
</details>
<details class="quote">
<summary>Only Run Requested Test Cases</summary>
<p>As a first step, you are likely to only be concerned with testing your specific modifications, so there is no need to run the full suite of EAMxx tests.
So, we may restrict the tests that will be run by using an appropriate <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expression</a> ("regex").<sup id="fnref:regex-tool"><a class="footnote-ref" href="#fn:regex-tool">4</a></sup></p>
<div class="copy highlight"><pre><span></span><code><span class="c1"># This example regex will match the exact substring &quot;aerosolve&quot;.</span>
<span class="c1"># That is, it will match &quot;aerosolve_validate_test&quot;,</span>
<span class="c1"># &quot;test_suite_aerosolve&quot;, and &quot;test_aerosolve_quick&quot; but not</span>
<span class="c1"># &quot;aeroplane_solver_test&quot; or &quot;aerosol_coagulation_test&quot;.</span>

$<span class="w"> </span><span class="nv">test_choice</span><span class="o">=</span><span class="s2">&quot;[^\s]*aerosolve[^\s]*&quot;</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--limit-test-regex<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_choice</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<details class="success">
<summary>Baseline Tests</summary>
<p><a href="../dev_testing/test_all_scream/#baseline-tests">Baseline tests</a> compare the current state of the code to some "baseline" value to ensure that the modifications do not negatively impact the current solutions provided by the model.
An example of this, provided below, is focused on testing the code with our new <strong>AshInjection</strong>-related modifications as compared to the code before we started working.</p>
<p><strong><em>Note</em></strong>, however, that any new <strong>AshInjection</strong>-specific tests or tests involving processes that interact with <strong>AshInjection</strong> may give different answers for perfectly good reasons.
Regardless, we would like to establish that our modifications do not cause any unexpected interactions, so all remaining baseline tests should pass.</p>
<div class="copy highlight"><pre><span></span><code><span class="c1"># For simplicity, we&#39;ll assume we begin at the most up-to-date</span>
<span class="c1"># commit on origin/master</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">eamxx_root</span><span class="si">}</span><span class="s2">&quot;</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>master
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">bl_loc</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/eamxx-baselines&quot;</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="c1"># set the location where we will save the baseline files we are about to generate \</span>
<span class="w">    </span>--baseline-dir<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">bl_loc</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\ </span>
<span class="w">    </span><span class="c1"># this flag indicates we will generate new baselines \</span>
<span class="w">    </span>--generate
<span class="o">[</span><span class="s2">&quot;one eternity later...&quot;</span><span class="o">]</span>
<span class="c1"># create a new branch to develop from</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>jane_dev/eamxx/aerosolve_proc
<span class="o">[</span><span class="s2">&quot;write all the code...&quot;</span><span class="o">]</span>
<span class="c1"># Note: the presence of the &#39;--baseline-dir&#39; flag indicates we will</span>
<span class="c1"># compare test results to the latest baselines found in that directory</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="c1"># set the location where we saved the previous baselines \</span>
<span class="w">    </span>--baseline-dir<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">bl_loc</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">[</span><span class="s2">&quot;mam4_aerosolve_standalone test fails... no baseline! (so do the others)&quot;</span><span class="o">]</span>
<span class="o">[</span><span class="s2">&quot;homme_standalone test passes! (so do other non-associated tests)&quot;</span><span class="o">]</span>
</code></pre></div>
</details>
<details class="tip">
<summary>"Quick-rerunning" Tests</summary>
<p>Rebuilding EAMxx can take quite some time, so <code>test-all-scream</code> has a couple of options to rerun tests quickly and avoiding configure or build costs.</p>
<p><code>--quick-rerun</code></p>
<ul>
<li><strong>Useful for:</strong> rerunning when there's no need to reconfigure.<ul>
<li>No edits made to any <code>CMakeLists.txt</code> files.</li>
<li>No relevant files renamed or moved to a different directory.</li>
<li>You plan to re-run tests that did not necessarily fail on the previous run.</li>
</ul>
</li>
</ul>
<div class="copy highlight"><pre><span></span><code>$<span class="w"> </span><span class="nv">test_choice</span><span class="o">=</span><span class="s2">&quot;[^\s]*aerosolve[^\s]*&quot;</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--limit-test-regex<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_choice</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">[</span><span class="s2">&quot;tests run...&quot;</span><span class="o">]</span>
<span class="o">[</span><span class="s2">&quot;modify aerosolve.cpp...&quot;</span><span class="o">]</span>
<span class="c1"># no need to reconfigure--let&#39;s be quick!</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--quick-rerun
</code></pre></div>
<p><code>--quick-rerun-failed</code></p>
<ul>
<li><strong>Useful for:</strong> rerunning only failed tests when there's no need to reconfigure or, potentially, no need to rebuild.<ul>
<li>No edits made to any <code>CMakeLists.txt</code> files.</li>
<li>No relevant files renamed or moved to a different directory.</li>
<li>In contrast to above, you only wish to rerun tests that failed the previous run.</li>
</ul>
</li>
</ul>
<div class="copy highlight"><pre><span></span><code><span class="c1"># run all of the eamxx tests</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span>
<span class="o">[</span><span class="s2">&quot;tests run...&quot;</span><span class="o">]</span>
<span class="o">[</span><span class="s2">&quot;aerosolve-related tests fail... so much output, though :(&quot;</span><span class="o">]</span>
<span class="c1"># no need to reconfigure or rebuild--rerun to make the output easier to parse.</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--quick-rerun
</code></pre></div>
</details>
<details class="example">
<summary>Efficiently Building for Multiple Architectures</summary>
<p>The default build directory employed by <code>test-all-scream</code> is <code>${eamxx_root}/ctest-build/&lt;test-configuration&gt;</code>, where <code>test-configuration</code> can be <code>full_debug</code>, <code>release</code>, etc.
The implication of this is that if we are testing for both CPU and GPU on the same machine, the default configuration will result in a GPU build overwriting the previous CPU build, or vice-versa.
This will result in long build times and make testing on both architectures inefficient.</p>
<p>For this reason, it is recommended to use the <code>--work-dir</code> flag to set separate build directories for each architecture.</p>
<div class="copy highlight"><pre><span></span><code><span class="c1"># we are on a machine with lots of cpu cores, so we will be extra clever</span>
<span class="c1"># and run simultaneously by using only a portion of cores for each build</span>

$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">total_cores</span><span class="si">}</span>
<span class="w">  </span><span class="m">100</span>

$<span class="w"> </span><span class="nv">build_loc_cpu</span><span class="o">=</span><span class="s2">&quot;ctest-cpu-build&quot;</span>
$<span class="w"> </span><span class="nv">build_threads_cpu</span><span class="o">=</span><span class="m">20</span>
$<span class="w"> </span><span class="nv">test_threads_cpu</span><span class="o">=</span><span class="m">20</span>
$<span class="w"> </span><span class="nv">build_loc_gpu</span><span class="o">=</span><span class="s2">&quot;ctest-gpu-build&quot;</span>
$<span class="w"> </span><span class="nv">build_threads_gpu</span><span class="o">=</span><span class="m">40</span>

<span class="c1"># Launch the cpu build/test</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--work-dir<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">build_loc_cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--make-parallel-level<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">build_threads_cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ctest-parallel-level<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_threads_cpu</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># launch the gpu build/test</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>&lt;required-args&gt;<span class="w"> </span><span class="o">[</span>optional-args<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--work-dir<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">build_loc_gpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--make-parallel-level<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">build_threads_gpu</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<h4 id="testing-on-supported-machines">Testing on Supported Machines</h4>
<p>When testing on a supported E3SM machine, the only configuration required is to set the proper "machine ID" flag indicating the machine name, and potentially desired device type (CPU, GPU).
This is because <code>test-all-scream</code> configures the run according to a "machine file" that sets an environment known to build and test successfully and efficiently<sup id="fnref:mach-file"><a class="footnote-ref" href="#fn:mach-file">5</a></sup>.</p>
<details class="example">
<summary>Example: Running on Perlmutter</summary>
<div class="copy highlight"><pre><span></span><code><span class="c1"># run tests on cpu</span>
<span class="o">[</span><span class="s2">&quot;start interactive session on cpu node (see below)...&quot;</span><span class="o">]</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>--machine<span class="w"> </span>pm-cpu
<span class="o">[</span><span class="s2">&quot;test runs...&quot;</span><span class="o">]</span>
<span class="o">[</span><span class="s2">&quot;logout from cpu node...&quot;</span><span class="o">]</span>
<span class="o">[</span><span class="s2">&quot;start interactive session on gpu node...&quot;</span><span class="o">]</span>
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>--machine<span class="w"> </span>pm-gpu
</code></pre></div>
</details>
<p>==FIXME: is the below correct?==</p>
<details class="warning">
<summary>Must Be Run Interactively on a Machine with Batch Scheduling</summary>
<p>The <code>test-all-scream</code> script assumes it is being run on a single, (interactive?) node.
This can be achieved by launching the job manually from an interactive session.
To illustrate, if the platform's batch scheduler is <code>slurm</code>, we would do</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>salloc<span class="w"> </span>--nodes<span class="w"> </span><span class="m">1</span><span class="w"> </span>--qos<span class="w"> </span>interactive<span class="w"> </span>--time<span class="w"> </span><span class="m">02</span>:00:00<span class="w"> </span><span class="o">[</span>...<span class="o">]</span>
&lt;response<span class="w"> </span>indicating<span class="w"> </span>interactive<span class="w"> </span>node<span class="w"> </span>name&gt;
$<span class="w"> </span>ssh<span class="w"> </span>&lt;node-id&gt;
$<span class="w"> </span>./scripts/test-all-scream<span class="w"> </span>--machine<span class="w"> </span>&lt;machine-id&gt;
</code></pre></div>
</details>
<!-- [Link to WIP](../WIP.md) -->

<h4 id="testing-locally">Testing Locally</h4>
<p>Requires <code>-l, --local</code> flag and correctly-configured files in <code>~/.cime</code>.
See <a href="../dev_testing/test_all_scream/#local-configuration-files">Local Configuration Files</a>.</p>
<h4 id="suggested-very-thorough-and-conservative-testing-progression">Suggested (Very Thorough and Conservative) Testing Progression</h4>
<p>To fully cover all the potential interactions of the <strong>AshInjection</strong> process, a reasonable series of tests is provided in the example script below.</p>
<p><strong>Note:</strong> There is no reason all of this could not be done at once, but we write the script in favor of being clear and explicit.</p>
<details class="abstract">
<summary>Thorough and Careful Testing Script</summary>
<p>For the purposes of this example, we assume we are on a non-supported local workstation named "bingo-pajama" that has 64 CPU cores and an NVIDIA GPU.
We also assume that we have working configuration files in <code>~/.cime/</code> for both CPU and GPU build configurations.</p>
<div class="copy highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># machine-related variables</span>
<span class="nv">machine_name</span><span class="o">=</span><span class="s2">&quot;bingo-pajama&quot;</span>
<span class="nv">total_ncores</span><span class="o">=</span><span class="m">64</span>
<span class="nv">id_cpu</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">machine_name</span><span class="si">}</span><span class="s2">-cpu&quot;</span>
<span class="nv">id_gpu</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">machine_name</span><span class="si">}</span><span class="s2">-gpu&quot;</span>

<span class="c1"># name of log file for conveniently capturing output</span>
<span class="nv">outfile_prefix</span><span class="o">=</span><span class="s2">&quot;aerosolve_buildNtest&quot;</span>
<span class="nv">ofile_cpu</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">outfile_prefix</span><span class="si">}</span><span class="s2">-</span><span class="si">${</span><span class="nv">id_cpu</span><span class="si">}</span><span class="s2">.log&quot;</span>
<span class="nv">ofile_gpu</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">outfile_prefix</span><span class="si">}</span><span class="s2">-</span><span class="si">${</span><span class="nv">id_gpu</span><span class="si">}</span><span class="s2">.log&quot;</span>

<span class="c1"># parallelism variables</span>
<span class="nv">make_ncores</span><span class="o">=</span><span class="m">60</span>
<span class="nv">test_ncores</span><span class="o">=</span><span class="m">60</span>
<span class="nv">pbuild</span><span class="o">=</span><span class="s2">&quot;-p --make-parallel-level </span><span class="si">${</span><span class="nv">make_ncores</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">ptest</span><span class="o">=</span><span class="s2">&quot;--ctest-parallel-level </span><span class="si">${</span><span class="nv">test_ncores</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># flags to assist with testing/debugging</span>
<span class="nv">vflag</span><span class="o">=</span><span class="s2">&quot;--extra-verbose&quot;</span>
<span class="c1"># limit test configuration to double-precision debug</span>
<span class="nv">test_config</span><span class="o">=</span><span class="s2">&quot;-t dbg&quot;</span>
<span class="nv">bl_loc</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/eamxx-baselines&quot;</span>

<span class="c1"># navigate to the root directory of eamxx</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">eamxx_root</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># switch to the master branch</span>
git<span class="w"> </span>checkout<span class="w"> </span>master
<span class="c1"># pull so we are at the latest commit (origin/HEAD)</span>
git<span class="w"> </span>pull<span class="w"> </span>origin<span class="w"> </span>master
<span class="c1"># update the submodules (the below is typically unnecessary, but thorough)</span>
git<span class="w"> </span>submodule<span class="w"> </span>sync<span class="w"> </span>--recursive<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive<span class="w"> </span>--progress

<span class="c1"># flags common to all tests</span>
<span class="nv">base_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pbuild</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">vflag</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">test_config</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># flags common to this stage of tests</span>
<span class="nv">test_base_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">base_flags</span><span class="si">}</span><span class="s2"> --baseline-dir </span><span class="si">${</span><span class="nv">bl_loc</span><span class="si">}</span><span class="s2"> --generate&quot;</span>
<span class="c1"># general test flags per architecture</span>
<span class="nv">cpu_flags</span><span class="o">=</span><span class="s2">&quot;--work-dir </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">id_cpu</span><span class="si">}</span><span class="s2"> --local </span><span class="si">${</span><span class="nv">id_cpu</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">ptest</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">gpu_flags</span><span class="o">=</span><span class="s2">&quot;--work-dir </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">id_gpu</span><span class="si">}</span><span class="s2"> --local </span><span class="si">${</span><span class="nv">id_gpu</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># specific flags for this test per architecture</span>
<span class="nv">cpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">cpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">gpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">gpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># generate baselines for cpu and gpu</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span>

<span class="c1"># Verify the &#39;aerosolver()&#39; function works as expected by running only that test</span>
<span class="nv">test_choice</span><span class="o">=</span><span class="s2">&quot;[^\s]*aerosolver_test[^\s]*&quot;</span>
<span class="nv">test_base_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">base_flags</span><span class="si">}</span><span class="s2"> --limit-test-regex </span><span class="si">${</span><span class="nv">test_choice</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">cpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">cpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">gpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">gpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># run verification tests</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># now that we&#39;re running tests that may fail, use &#39;tee&#39; to</span>
<span class="c1"># duplicate stdout and stderr to file so debugging is slightly easier</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_cpu</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_gpu</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Validate the AshInjection process generates the solutions we expect</span>
<span class="nv">test_choice</span><span class="o">=</span><span class="s2">&quot;[^\s]*mam4_aerosolve_standalone[^\s]*&quot;</span>
<span class="nv">test_base_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">base_flags</span><span class="si">}</span><span class="s2"> --limit-test-regex </span><span class="si">${</span><span class="nv">test_choice</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">cpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">cpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">gpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">gpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># run single-process verification tests</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_cpu</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_gpu</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># validate all the processes that interact with aerosolve generate</span>
<span class="c1"># expected solutions</span>
<span class="nv">aerosolve_multiproc_tests</span><span class="o">=(</span>
<span class="w">                           </span><span class="c1"># physics_only</span>
<span class="w">                           </span>shoc_mam4_aerosolve
<span class="w">                           </span>p3_mam4_aerosolve
<span class="w">                           </span><span class="c1"># dynamics_physics</span>
<span class="w">                           </span>homme_shoc_cld_p3_mam4_aerosolve_rrtmgp
<span class="w">                           </span>homme_shoc_cld_spa_p3_rrtmgp_mam4_aerosolve
<span class="w">                           </span><span class="o">)</span>
<span class="k">for</span><span class="w"> </span>tchoice<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="si">${</span><span class="nv">aerosolve_multiproc_tests</span><span class="p">[@]</span><span class="si">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="nv">test_choice</span><span class="o">=</span><span class="s2">&quot;[^\s]*</span><span class="si">${</span><span class="nv">tchoice</span><span class="si">}</span><span class="s2">[^\s]*&quot;</span>
<span class="w">  </span><span class="nv">test_base_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">base_flags</span><span class="si">}</span><span class="s2"> --limit-test-regex </span><span class="si">${</span><span class="nv">test_choice</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nv">cpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">cpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nv">gpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">test_base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">gpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="c1"># run single-process verification tests</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span>./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_cpu</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span>./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_gpu</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">done</span>
<span class="c1"># NOTE: just setting &#39;test_choice=&quot;[^\s]*_mam4_aerosolve^\s]*&quot;&#39; would also do</span>
<span class="c1">#       the trick in this case</span>

<span class="c1"># run full eamxx test suite against pre-AshInjection baselines for all</span>
<span class="c1"># test configurations (not just &#39;dbg&#39;)</span>
<span class="nv">base_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pbuild</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">vflag</span><span class="si">}</span><span class="s2"> --baseline-dir </span><span class="si">${</span><span class="nv">bl_loc</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">cpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">cpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">gpu_test_flags</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">base_flags</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">gpu_flags</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># run the full suite of eamxx baseline tests</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">cpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_cpu</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST FLAGS = </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="s2">&quot;</span>
./scripts/test-all-scream<span class="w"> </span><span class="si">${</span><span class="nv">gpu_test_flags</span><span class="si">}</span><span class="w"> </span><span class="p">|&amp;</span><span class="w"> </span>tee<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ofile_gpu</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<h3 id="submit-code-to-e3sm">Submit Code to E3SM</h3>
<ul>
<li>Link to RJ confluence pages</li>
<li>screenshots?</li>
</ul>
<!-- ======================================================================= -->

<div class="footnote">
<hr />
<ol>
<li id="fn:automagic-cmake">
<p>In reality, significant effort is involved in designing a project to build "automagically," but the idea is to take that process out of the user's hands.&#160;<a class="footnote-backref" href="#fnref:automagic-cmake" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:but-mac">
<p>Mac computers with an Apple silicon CPU (e.g., M1, M2...) are not officially supported and present challenges related to handling floating-point exceptions. However, some have had success building on this architecture, and if you achieve a robust build configuration for Mac please reach out to the development team!&#160;<a class="footnote-backref" href="#fnref:but-mac" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:correct-huh">
<p>Admittedly, "correctness" is a slippery concept, but at the very least we can always test for properties like mass conservation, non-negativity, etc.&#160;<a class="footnote-backref" href="#fnref:correct-huh" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:regex-tool">
<p>For those that are not regex ninjas (yet), there are useful tools only to construct or decode regex strings--e.g., <a href="https://regexr.com">RegExr</a>.&#160;<a class="footnote-backref" href="#fnref:regex-tool" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:mach-file">
<p>If you discover that a supported machine does not successfully build and test, please file an Issue ==with the tag <strong><em>xyz</em></strong>?==.
Also, no promises the standard configuration is perfectly efficient.&#160;<a class="footnote-backref" href="#fnref:mach-file" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.sections", "navigation.path", "navigation.tracking", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.select", "content.code.copy", "content.action.view", "content.tooltips"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>