{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"The Energy Exascale Earth System Model (E3SM)","text":"<p>E3SM is a state-of-the-art fully coupled model of the Earth's climate including important biogeochemical and cryospheric processes. It is intended to address the most challenging and demanding climate-change research problems and Department of Energy mission needs while efficiently using DOE Leadership Computing Facilities.</p> <p>Note</p> <p>This is the future home for all documentation specific to E3SM and its components. Until complete, some documentation will be found at the project's Confluence wiki</p>"},{"location":"#e3sm-basics","title":"E3SM Basics","text":"<ul> <li>Installation</li> <li>User Guide</li> <li>Development</li> </ul>"},{"location":"#component-models","title":"Component Models","text":"<ul> <li>EAM</li> <li>EAMxx \u2014 not yet supported.</li> <li>ELM</li> <li>MOSART</li> <li>MPAS-Ocean</li> <li>MPAS-seaice</li> </ul>"},{"location":"#tools","title":"Tools","text":"<ul> <li>generate_domain_files</li> </ul> <p>Please see Developing Docs to learn about how to contribute to the documentation.</p>"},{"location":"installation/","title":"Installation Guide","text":"<p>E3SM is not available as a pre-compiled binary.  You install E3SM by cloning the source code using git and building the executable on your local platform after making some choices on model configuration (addressed in the User Guide).</p> <p>It is recommended that you install E3SM on a supported platform. (See Hardware/Software Configuration)</p> <p>The E3SM Project can not assist with installation on an un-supported platform but can point you in the right direction. If you wish to port E3SM to your machine, first check that the target machine has the software prerequisites detailed in Hardware/Software Configuration.</p> <p>E3SM uses the CIME Case Control System (CCS) and a machine must be described to the CCS in order to build and run E3SM.  See the CIME Porting Guide.</p> <p>Once you are on a supported machine, clone the source code by following the first steps (2-4 and 6) in the Development Getting Started Guide.</p> <p>To start configuration cases and building the model, see the User Guide</p>"},{"location":"EAM/","title":"The E3SM Atmosphere Model (EAM)","text":"<p>EAM is the state-of-the-art atmospheric component of the E3SM model that uses a Spectral Element Dynamical Core and a suite of parameterizations to represent a range of atmospheric processes, which are described in the Technical Guide (see below). Its nominal resolution is roughly 100km in the horizontal, with a model time step of 1800 seconds, and runs with 80 layers in the vertical (model top of 60km).</p> <ul> <li>The EAM User Guide explains how to control EAM when its running within E3SM.</li> <li>The EAM Developer Guide explains EAM data structures and how to write new code.</li> <li>The EAM Technical Guide explains the science behind EAM's code</li> </ul>"},{"location":"EAM/dev-guide/","title":"EAM Developer Guide","text":"<p>coming soon.</p>"},{"location":"EAM/tech-guide/","title":"EAM Technical Guide","text":"<p>This Technical Guide describes the physics of version 3 of the E3SM Atmospheric Model</p>"},{"location":"EAM/tech-guide/#dynamics-and-physics","title":"Dynamics and Physics","text":"<ul> <li> <p>HOMME: Dynamical core.</p> </li> <li> <p>Atmospheric-Grid: Grid used with dynamical core</p> </li> <li> <p>P3: Stratiform cloud microphysics scheme.</p> </li> <li> <p>CLUBB: Parameterization of subgrid-scale turbulence and clouds.</p> </li> <li> <p>Zhang-McFarlane: Deep convection parameterization.</p> </li> <li> <p>RRTMG: Parameterization of radiation.</p> </li> <li> <p>MAM: Primary parameterization schemes used to represent aerosols.</p> </li> <li> <p>VBS: Parameterization of secondary organic aerosols.</p> </li> <li> <p>Dust: Parameterization of dust emissions.</p> </li> <li> <p>OCEANFILMS: Parameterization of sea soray irganic aerosol emissions.</p> </li> <li> <p>chemUCI + Linoz v3: Interactive atmospheric chemistry packages.</p> </li> </ul>"},{"location":"EAM/tech-guide/#diagnostic-outputs","title":"Diagnostic outputs","text":"<ul> <li> <p>COSP: Scheme that allows the model to output satellite simulator output.</p> </li> <li> <p>ARM Diags: Diagnostic package that allows the model output to be compared against ARM measurements.</p> </li> </ul>"},{"location":"EAM/tech-guide/armdiags/","title":"ARM diagnostics","text":""},{"location":"EAM/tech-guide/armdiags/#overview","title":"Overview","text":"<p>The ARM data-oriented metrics and diagnostics package (ARM Diags) was developed to facilitate the use of ARM data in climate model evaluation and model intercomparison (Zhang et al., 2020)<sup>1</sup>. It includes ARM data sets, compiled from multiple ARM data products, and a Python-based analysis toolkit for computation ad visualization. It also includes simulation data from models participating the CMIP, which allows climate-modeling groups to compare a new, candidate version of their model to existing CMIP models. The ARM Diags has been applied in several model evaluation studies to help address a range of issues in climate models (Zheng et al., 2023;<sup>2</sup> Emmenegger et al., 2022;<sup>3</sup> Zhang et al., 2018<sup>4</sup>). The Majority of ARM Diags sets are ported into E3SM Diags (Zhang et al., 2022)<sup>5</sup> for routine evaluation of the model.</p>"},{"location":"EAM/tech-guide/armdiags/#to-enable-the-use-of-arm-diags","title":"To enable the use of ARM Diags","text":"<p>To enable using ARM Diags for a simulation, often, a new tape that output at high-frequency over limited-area (nearest grid box to supported ARM site) needs to be included in the namelist file, an example as follows:</p> <pre><code>fincl7 = 'PS','Q','T','Z3','CLOUD','CONCLD','CLDICE',\n   'CLDLIQ','FREQR','REI','REL','PRECT','TMQ','PRECC',\n   'TREFHT','QREFHT','OMEGA','CLDTOT','LHFLX','SHFLX',\n   'FLDS','FSDS','FLNS','FSNS','FLNSC','FSDSC','FSNSC',\n   'AODVIS','AODABS','LS_FLXPRC','LS_FLXSNW',\n   'LS_REFFRAIN','ZMFLXPRC','ZMFLXSNW','CCN1','CCN2',\n   'CCN3','CCN4','CCN5','num_a1','num_a2','num_a3',\n   'num_a4','so4_a1','so4_a2','so4_a3','AREL','TGCLDLWP',\n   'AQRAIN','ANRAIN','FREQR','PRECL','RELHUM'\nfincl7lonlat='262.5e_36.6n','203.4e_71.3n','147.4e_2.0s',\n   '166.9e_0.5s','130.9e_12.4s','331.97e_39.09n'\n</code></pre> <p>Note that in this example fincl7 should set to write output at hourly (<code>nhtfrq = -1</code>). And here additional variables are included for ARM simulator analysis. The ARM site information is shown below:</p> <pre><code>    \"sgpc1\": [\"97.5W 36.4N Oklahoma ARM\"],\n\n    \"nsac1\": [\"156.6W 71.3N Barrow ARM\"],\n\n    \"twpc1\": [\"147.4E 2.1S Manus ARM\"],\n\n    \"twpc2\": [\"166.9E 0.5S Nauru ARM\"],\n\n    \"twpc3\": [\"130.9E 12.4S Darwin ARM\"],\n\n    \"enac1\": [\"28.0E 39.1N Graciosa Island ARM\"], \n</code></pre>"},{"location":"EAM/tech-guide/armdiags/#diagnostics-and-metrics-currently-implemented-in-the-arm-diags","title":"Diagnostics and metrics currently implemented in the ARM Diags","text":"Statistical Metrics Variables Time sampling Line plots and Taylor diagrams for annual cycle variability of each variable Precipitation, column water vapor, surface energy budget components, near-surface temperature and specific humidity, surface pressure, total cloud fraction, and aerosol optical depth. Monthly mean Contour and vertical profiles of annual cycle and diurnal cycle of cloud fraction Vertical profiles of cloud fraction Hourly mean Line and harmonic dial plots of diurnal cycle of precipitation Surface precipitation rate Hourly mean Probability density function (PDF) plots of precipitation rate Surface precipitation rate Hourly mean CCN Annual Cycles CCN number concentrations at 0.1%, 0.2%, 0.5% and 1.0% supersaturation levels Hourly mean Aerosol Annual Cycles Total aerosol number concentration Hourly mean Aerosol Chemical Annual Cycles Organic, sulfate, nitrate, ammonium, chloride mass concentration Hourly mean Process-oriented metrics Variables Time sampling Convection Onset 1. Surface precipitation rate   2. Column Precipitable Water Vapor Hourly mean Aerosol-CCN Activation 1. Total aerosol number concentration   2. CCN number concentrations at different supersaturation levels (0.1%, 0.2%, 0.5% and 1.0) Hourly mean <ol> <li> <p>C. Zhang, S. Xie, C. Tao, S. Tang, T. Emmenegger, J. D. Neelin, K. A. Schiro, W. Lin, and Z. Shaheen. The ARM Data-Oriented Metrics and Diagnostics Package for Climate Models: A New Tool for Evaluating Climate Models with Field Data. Bulletin of the American Meteorological Society, 101(10):E1619\u2013E1627, October 2020. URL: https://journals.ametsoc.org/view/journals/bams/101/10/bamsD190282.xml (visited on 2024-03-29), doi:10.1175/BAMS-D-19-0282.1.\u00a0\u21a9</p> </li> <li> <p>Xiaojian Zheng, Cheng Tao, Chengzhu Zhang, Shaocheng Xie, Yuying Zhang, Baike Xi, and Xiquan Dong. Assessment of CMIP5 and CMIP6 AMIP Simulated Clouds and Surface Shortwave Radiation Using ARM Observations over Different Climate Regions. Journal of Climate, 36(24):8475\u20138495, November 2023. URL: https://journals.ametsoc.org/view/journals/clim/36/24/JCLI-D-23-0247.1.xml (visited on 2024-03-29), doi:10.1175/JCLI-D-23-0247.1.\u00a0\u21a9</p> </li> <li> <p>Todd Emmenegger, Yi-Hung Kuo, Shaocheng Xie, Chengzhu Zhang, Cheng Tao, and J. David Neelin. Evaluating Tropical Precipitation Relations in CMIP6 Models with ARM Data. Journal of Climate, 35(19):6343\u20136360, October 2022. URL: https://journals.ametsoc.org/view/journals/clim/35/19/JCLI-D-21-0386.1.xml (visited on 2024-03-29), doi:10.1175/JCLI-D-21-0386.1.\u00a0\u21a9</p> </li> <li> <p>Chengzhu Zhang, Shaocheng Xie, Stephen A. Klein, Hsi\u2010yen Ma, Shuaiqi Tang, Kwinten Van Weverberg, Cyril J. Morcrette, and Jon Petch. CAUSES: Diagnosis of the Summertime Warm Bias in CMIP5 Climate Models at the ARM Southern Great Plains Site. Journal of Geophysical Research: Atmospheres, 123(6):2968\u20132992, March 2018. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1002/2017JD027200 (visited on 2024-03-29), doi:10.1002/2017JD027200.\u00a0\u21a9</p> </li> <li> <p>Chengzhu Zhang, Jean-Christophe Golaz, Ryan Forsyth, Tom Vo, Shaocheng Xie, Zeshawn Shaheen, Gerald L. Potter, Xylar S. Asay-Davis, Charles S. Zender, Wuyin Lin, Chih-Chieh Chen, Chris R. Terai, Salil Mahajan, Tian Zhou, Karthik Balaguru, Qi Tang, Cheng Tao, Yuying Zhang, Todd Emmenegger, Susannah Burrows, and Paul A. Ullrich. The E3SM Diagnostics Package (E3SM Diags v2.7): a Python-based diagnostics package for Earth system model evaluation. Geoscientific Model Development, 15(24):9031\u20139056, December 2022. URL: https://gmd.copernicus.org/articles/15/9031/2022/ (visited on 2024-03-29), doi:10.5194/gmd-15-9031-2022.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/atmosphere-grid-overview/","title":"Atmosphere Grid Overview","text":"<p>The E3SM atmosphere component uses a cube-sphere grid, partly to avoid the convergence of latitude lines at the poles. The grid is constructed by subdividing each cube face into NxN elements and then projecting these to a spherical geometry.</p>"},{"location":"EAM/tech-guide/atmosphere-grid-overview/#the-np4-gll-grid","title":"The np4 GLL Grid","text":"<p>The atmospheric dycore is based on the spectral element (SE) method using the Gauss-Lobatto-Legendre (GLL) quadrature aproach. An irregular grid of 4x4 GLL nodes (i.e. np4) is used to represent the model state within each element of the cube-sphere grid. The illustration below indicates the GLL nodes of the ne4np4 grid with green dots, while the elements are outlined in blue. Notice the irregular spacing of the GLL nodes, which causes them to cluster at the element corners.</p> <p>While the atmosphere history output is primarily on the physics grid (see below), it is possible to output on the np4 grid. The input topography and initial condition data must be on the np4 grid. When mapping between SE and FV grids TempestRemap should be used. SE GLL data does not naturally represent as FV type cell averages, and thus mapping tools which only work with cell centered data (ESMF, SCRIP) should be avoided.  </p> <p>For a np4 grid with N elements per cube edge the total number of unique GLL nodes can be calculated as: <code>N*(np-1)^2 + 2</code></p> <p></p>"},{"location":"EAM/tech-guide/atmosphere-grid-overview/#the-pg2-physgrid","title":"The pg2 \"physgrid\"","text":"<p>Starting in v2, physics calculations and history output in E3SM use a quasi-equal area finite volume (FV) grid, rather the GLL nodes of the spectral element grid. This FV grid is constructed byt dividing each spectral element of the cube-sphere into a grid of 2x2 subcells, referred to as \"pg2\" or \"physgrid\" (shown below). Finer divisions of the spectral element are possible, such as 3x3, but these grids do not seem to have any notable advantages (see Hannah et al. 2021). Quantities on the physgrid should be considered cell average values over each FV cell, rather than nodal values.</p> <p>For a pg2 grid with N elements per cube edge the total number of physics columns can be calculated as: <code>ncol = N*N*6*(2*2)</code></p> <p></p>"},{"location":"EAM/tech-guide/chemUCIlinozv3/","title":"chemUCI and Linoz","text":""},{"location":"EAM/tech-guide/chemUCIlinozv3/#overview","title":"Overview","text":"<p>Atmospheric interactive chemistry is handled by chemUCI (in the troposphere) and Linoz v3 (in the stratosphere). chemUCI consists of 28 advected tracers for the O3-CH4-HOx-NOx-NMVOCs chemistry. Compared to E3SMv2, the E3SMv3 linearized stratospheric chemistry scheme (Linoz v3) expends the interactive species to include O3, N2O, NOy, and CH4. The boundary between stratosphere and troposphere adopts the e90 tropopause algorithm.</p>"},{"location":"EAM/tech-guide/chemUCIlinozv3/#namelist-parameters","title":"Namelist parameters","text":"<p>chemUCI and Linoz Namelist Parameters</p>"},{"location":"EAM/tech-guide/clubb/","title":"Cloud Layers Unified By Binormals","text":""},{"location":"EAM/tech-guide/clubb/#overview","title":"Overview","text":"<p>The Cloud Layers Unified By Binormals (CLUBB) parameterization is a parameterization of subgrid-scale turbulence and clouds.<sup>1</sup><sup>2</sup><sup>3</sup><sup>4</sup> It prognoses turbulent fluxes of heat, moisture, and momentum, and it diagnoses the liquid cloud fraction and liquid water mixing ratio.  To do so, it prognoses higher-order turbulence moments and closes those prognostic equations by use of an assumed double-Gaussian shape of the subgrid probability density function.  CLUBB operates throughout the troposphere, but it contributes especially to the planetary boundary layer and low-cloud regimes, including stratocumulus and shallow cumulus regimes.  </p>"},{"location":"EAM/tech-guide/clubb/#namelist-parameters","title":"Namelist parameters","text":"<p>CLUBB Namelist Parameters</p> <ol> <li> <p>Vincent E. Larson. CLUBB-SILHS: A parameterization of subgrid variability in the atmosphere. March 2022. arXiv:1711.03675 [physics]. URL: http://arxiv.org/abs/1711.03675 (visited on 2024-03-29), doi:10.48550/arXiv.1711.03675.\u00a0\u21a9</p> </li> <li> <p>Peter A. Bogenschutz, Andrew Gettelman, Cecile Hannay, Vincent E. Larson, Richard B. Neale, Cheryl Craig, and Chih-Chieh Chen. The path to CAM6: coupled simulations with CAM5.4 and CAM5.5. Geoscientific Model Development, 11(1):235\u2013255, January 2018. URL: https://gmd.copernicus.org/articles/11/235/2018/ (visited on 2024-03-29), doi:10.5194/gmd-11-235-2018.\u00a0\u21a9</p> </li> <li> <p>Vincent E. Larson and Jean-Christophe Golaz. Using Probability Density Functions to Derive Consistent Closure Relationships among Higher-Order Moments. Monthly Weather Review, 133(4):1023\u20131042, April 2005. URL: https://journals.ametsoc.org/view/journals/mwre/133/4/mwr2902.1.xml (visited on 2024-03-29), doi:10.1175/MWR2902.1.\u00a0\u21a9</p> </li> <li> <p>Jean-Christophe Golaz, Vincent E. Larson, and William R. Cotton. A PDF-Based Model for Boundary Layer Clouds. Part I: Method and Model Description. Journal of the Atmospheric Sciences, 59(24):3540\u20133551, December 2002. URL: https://journals.ametsoc.org/view/journals/atsc/59/24/1520-0469_2002_059_3540_apbmfb_2.0.co_2.xml (visited on 2024-03-29), doi:10.1175/1520-0469(2002)059&lt;3540:APBMFB&gt;2.0.CO;2.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/cosp/","title":"Cloud Feedback Model Intercomparison Project (CFMIP) Observation Simulator Package","text":""},{"location":"EAM/tech-guide/cosp/#overview","title":"Overview","text":"<p>The Cloud Feedback Model Intercomparison Project (CFMIP) Observation Simulator Package (COSP; Bodas-Salcedo et al., 2011;<sup>1</sup> Swales et al., 2018;<sup>2</sup> Zhang et al., 2019;<sup>3</sup> Zhang et al., 2024<sup>4</sup>) was developed to improve the consistency between model clouds and satellite observations. COSP contains several independent satellite simulators for better comparing model clouds with satellite measurements collected by the International Satellite Cloud Climatology Project (ISCCP), the Moderate Resolution Imaging Spectroradiometer (MODIS), the Multi-angle Imaging SpectroRadiometer (MISR), Cloud-Aerosol Lidar and Infrared Pathfinder Satellite Observation (CALIPSO), and CloudSat. The use of satellite simulators will not only make a fairer comparison between model clouds and satellite data but also allow a more in-depth analysis of clouds. For example, clouds can be assessed in terms of their optical properties and vertical location, which dictate their radiative effects.</p>"},{"location":"EAM/tech-guide/cosp/#namelist-parameters","title":"Namelist parameters","text":"<p>COSP Namelist Parameters</p>"},{"location":"EAM/tech-guide/cosp/#to-turn-on-cosp-outputs","title":"To turn on COSP outputs","text":"<p>Run (add to the run script) the following command before running <code>./case.setup</code></p> <p><code>./xmlchange --id CAM_CONFIG_OPTS --append --val='-cosp'</code></p> Related Outputs Description <code>FISCCP1_COSP</code> Grid-box fraction covered by each ISCCP D level cloud type <code>CLMODIS</code> MODIS Cloud Area Fraction <code>CLD_MISR</code> Cloud Fraction from MISR Simulator <code>CLDTOT_CAL</code> Calipso Total Cloud Fraction <code>CLDHGH_CAL</code> Calipso High-level Cloud Fraction <code>CLDMED_CAL</code> Calipso Mid-level Cloud Fraction <code>CLDLOW_CAL</code> Calipso Low-level Cloud Fraction <code>CLD_CAL_TMPLIQ</code> Calipso Liquid Cloud Fraction as a function of temperature <code>CLD_CAL_TMPICE</code> Calipso Ice Cloud Fraction as a function of temperature <ol> <li> <p>A. Bodas-Salcedo, M. J. Webb, S. Bony, H. Chepfer, J.-L. Dufresne, S. A. Klein, Y. Zhang, R. Marchand, J. M. Haynes, R. Pincus, and V. O. John. COSP: Satellite simulation software for model assessment. Bulletin of the American Meteorological Society, 92(8):1023\u20131043, August 2011. URL: https://journals.ametsoc.org/doi/10.1175/2011BAMS2856.1 (visited on 2024-03-29), doi:10.1175/2011BAMS2856.1.\u00a0\u21a9</p> </li> <li> <p>Dustin J. Swales, Robert Pincus, and Alejandro Bodas-Salcedo. The Cloud Feedback Model Intercomparison Project Observational Simulator Package: Version 2. Geoscientific Model Development, 11(1):77\u201381, January 2018. URL: https://gmd.copernicus.org/articles/11/77/2018/ (visited on 2024-03-29), doi:10.5194/gmd-11-77-2018.\u00a0\u21a9</p> </li> <li> <p>Yuying Zhang, Shaocheng Xie, Wuyin Lin, Stephen A. Klein, Mark Zelinka, Po\u2010Lun Ma, Philip J. Rasch, Yun Qian, Qi Tang, and Hsi\u2010Yen Ma. Evaluation of Clouds in Version 1 of the E3SM Atmosphere Model With Satellite Simulators. Journal of Advances in Modeling Earth Systems, 11(5):1253\u20131268, May 2019. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2018MS001562 (visited on 2024-03-29), doi:10.1029/2018MS001562.\u00a0\u21a9</p> </li> <li> <p>Yuying Zhang, Shaocheng Xie, Yi Qin, Wuyin Lin, Jean-Christophe Golaz, Xue Zheng, Po-Lun Ma, Yun Qian, Qi Tang, Christopher R. Terai, and Meng Zhang. Understanding changes in cloud simulations from E3SM version 1 to version 2. Geoscientific Model Development, 17(1):169\u2013189, January 2024. URL: https://gmd.copernicus.org/articles/17/169/2024/ (visited on 2024-03-29), doi:10.5194/gmd-17-169-2024.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/dust/","title":"Dust aerosol","text":""},{"location":"EAM/tech-guide/dust/#overview","title":"Overview","text":"<p>Dust-related processes are represented in the E3SM atmosphere and land model components. In E3SMv3, dust deposition will also be coupled with the sea ice and ocean biogeochemistry in the ocean model. Total emission fluxes of dust particles are calculated at each model time step. A new dust emission scheme following Kok et al. (2014)<sup>1</sup> is implemented to E3SMv3, replacing the Zender scheme (Zender et al., 2003)<sup>2</sup> in E3SMv1 and v2 as the default option. The new dust emission scheme includes a time-varying soil erodibility factor for dust mobilization, and includes dust sources in high latitudes (e.g., &gt;60 degree N). A manuscript by Feng et al. is in prep to document the performance of the new emission scheme on dust life cycle and radiative effects in E3SMv3. Dust aerosol is represented in the accumulation and coarse aerosol modes of the MAM4 module following emission. Other dust properties such as optical properties and size distribution at emission are documented in Feng et al. (2022).<sup>3</sup></p>"},{"location":"EAM/tech-guide/dust/#namelist-parameters","title":"Namelist parameters","text":"<p>Dust Namelist Parameters</p> <ol> <li> <p>J. F. Kok, N. M. Mahowald, G. Fratini, J. A. Gillies, M. Ishizuka, J. F. Leys, M. Mikami, M.-S. Park, S.-U. Park, R. S. Van Pelt, and T. M. Zobeck. An improved dust emission model \u2013 Part 1: Model description and comparison against measurements. Atmospheric Chemistry and Physics, 14(23):13023\u201313041, December 2014. URL: https://acp.copernicus.org/articles/14/13023/2014/ (visited on 2024-03-29), doi:10.5194/acp-14-13023-2014.\u00a0\u21a9</p> </li> <li> <p>Charles S. Zender, Huisheng Bian, and David Newman. Mineral Dust Entrainment and Deposition (DEAD) model: Description and 1990s dust climatology. Journal of Geophysical Research: Atmospheres, 108(D14):2002JD002775, July 2003. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2002JD002775 (visited on 2024-03-29), doi:10.1029/2002JD002775.\u00a0\u21a9</p> </li> <li> <p>Y. Feng, H. Wang, P. J. Rasch, K. Zhang, W. Lin, Q. Tang, S. Xie, D. S. Hamilton, N. Mahowald, and H. Yu. Global Dust Cycle and Direct Radiative Effect in E3SM Version 1: Impact of Increasing Model Resolution. Journal of Advances in Modeling Earth Systems, 14(7):e2021MS002909, July 2022. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2021MS002909 (visited on 2024-03-29), doi:10.1029/2021MS002909.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/homme/","title":"High-Order Methods Modeling Environment","text":""},{"location":"EAM/tech-guide/homme/#overview","title":"Overview","text":"<p>EAM uses the a dynamical core (dycore) from the High Order Method Modeling Environment (HOMME).<sup>1</sup><sup>2</sup><sup>3</sup> The EAM dycore solves the atmospheric primitive equations governing the evolution of velocity, density, pressure and temperature, as well as the transport of water species and related hydrometers, aerosols and other atmospheric constituents.  The governing equations are written in a vertically lagrangian terrain following mass coordinate.  They are discretized with second order finite differences in the radial direction and spectral finite elements in the horizontal (surface of the sphere) directions, and advanced in time with a 3rd order accurate 5 stage Runge-Kutta method.  Dissipation is added through the use of monotoncity contraints on some advectiion terms, explicitly added hyperviscosity, and a Laplacian-based sponge layer in the first few layers at the model top.  The transported species  makes use of an efficient interpolatory semi-Lagrangian method.  EAMv3 uses 80 layers in the vertical.  The use of the spectral finite element method allows EAMv3 to run on fully unstructured grids, including the cubed-sphere grid (SE Atmosphere Grid Overview (EAM &amp; CAM)) which provides quasi-uniform resolution over the globe, and regionally refined meshes (RRM) which enhance horizontal resolution in regions of interest (Library of Regionally-Refined Model (RRM) Grids).</p>"},{"location":"EAM/tech-guide/homme/#namelist-parameters","title":"Namelist parameters","text":"<p>Many dynamical core parameters can not be changed independently.  For example, increasing the hyperviscosity coefficient may require reducing the hyperviscosity timestep.   Dycore timesteps are tuned for each resolution and the defaults are close to the CFL stability limit. For complete details, as well as their interactions, see EAM's HOMME dycore.</p> <p>HOMME Namelist Parameters</p> <ol> <li> <p>Mark A. Taylor and Aim\u00e9 Fournier. A compatible and conservative spectral element method on unstructured grids. Journal of Computational Physics, 229(17):5879\u20135895, August 2010. URL: https://linkinghub.elsevier.com/retrieve/pii/S0021999110001841 (visited on 2024-03-29), doi:10.1016/j.jcp.2010.04.008.\u00a0\u21a9</p> </li> <li> <p>O. Guba, M. A. Taylor, P. A. Ullrich, J. R. Overfelt, and M. N. Levy. The spectral element method on variable resolution grids: evaluating grid sensitivity and resolution-aware numerical viscosity. preprint, Numerical Methods, June 2014. URL: https://gmd.copernicus.org/preprints/7/4081/2014/gmdd-7-4081-2014.pdf (visited on 2024-03-29), doi:10.5194/gmdd-7-4081-2014.\u00a0\u21a9</p> </li> <li> <p>Mark A. Taylor, Oksana Guba, Andrew Steyer, Paul A. Ullrich, David M. Hall, and Christopher Eldred. An Energy Consistent Discretization of the Nonhydrostatic Equations in Primitive Variables. Journal of Advances in Modeling Earth Systems, 12(1):e2019MS001783, January 2020. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019MS001783 (visited on 2024-03-29), doi:10.1029/2019MS001783.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/mam/","title":"Modal Aerosol Module","text":""},{"location":"EAM/tech-guide/mam/#mam5-overview","title":"MAM5 Overview","text":"<p>The Five-mode Modal Aerosol Model (MAM5) supersedes the MAM4 utilized in previous iterations of E3SM (E3SM-V1 and -V2). MAM5 introduces a fifth mode, specifically designed to represent stratospheric coarse mode aerosols, primarily originating from volcanic eruptions and DMS decomposition. This mode exclusively comprises sulfate aerosols, characterized by a smaller standard deviation (STD) value of 1.2. The STD value denotes the width of the aerosol mode, where a higher STD implies a greater gravitational settling effect (Wang et al., 2020;<sup>1</sup> Liu et al., 2012<sup>2</sup>). By setting the STD to 1.2, the simulated properties of volcanic aerosols align closely with observational findings (Mills et al., 2016).<sup>3</sup> MAM5 represents a pioneering aerosol model, effectively segregating tropospheric and stratospheric aerosols (Ke et al., in preparation), thereby mitigating the risk of overestimating dust and sea salt aerosols within the stratosphere in previous MAM4 (Visioni et al., 2021).<sup>4</sup> Volcanic eruptions derived from Neely and Schmidt (2016).<sup>5</sup></p>"},{"location":"EAM/tech-guide/mam/#mam4-overview","title":"MAM4 Overview","text":"<p>The representation of atmospheric aerosols and their roles in the Earth system by EAMv1/v2/v3 was inherited from the global aerosol-climate model EAMv0 and its four-mode modal aerosol module (MAM4), including Aitken, primary-carbon, accumulation, and coarse modes (Liu et al., 2016).<sup>6</sup> It treats a combination of processes, controlling the evolution of aerosols that are either directly emitted or converted from precursor gases from a variety of natural and anthropogenic sources. The processes include transport (by grid-scale wind, subgrid turbulence, convection, and sedimentation), aerosol microphysics (i.e., particle nucleation, condensation/evaporation of trace gases, aging, and coagulation), cloud processing (i.e., aqueous chemistry, scavenging by hydrometeors, resuspension from evaporating hydrometeors, and wet deposition), and dry deposition. Aerosol species in the original MAM4 (Liu et al., 2016)<sup>6</sup> include sulfate, primary organic aerosol (POA) or particulate organic matter (POM), secondary organic aerosol (SOA), black carbon (BC), sea salt, and mineral dust. As described by Wang et al. (2020),<sup>1</sup> the enhanced MAM4 in EAMv1/v2 added marine organic aerosol (MOA) to all four modes (Burrows et al., 2022).<sup>7</sup> In MAM4 of EAMv3, the Aitken mode has sulfate, sea salt, SOA and MOA; the primary-carbon mode has BC, POA and MOA; the accumulation and coarse modes include all seven species. Ammonium (NH4) and nitrate (NO3) aerosols are also explicitly treated in EAMv3 (Wu et al., 2022),<sup>8</sup> as an optional feature for research, in which new species (NH4, NO3, Ca, CO3, Na, Cl) are introduced to the Aitken, accumulation and coarse modes. All aerosol species within each of the four individual modes the MAM4 is assumed to be internally mixed and represented by a single number concentration, while particles are externally mixed among the different modes.</p>"},{"location":"EAM/tech-guide/mam/#sea-salt","title":"Sea salt","text":"<p>In MAM4, sea salt aerosol is represented in the Aitken, accumulation, and coarse mode with particle emission size (diameter) ranges of 0.02-0.08, 0.08-1.0, and 1.0-10.0 \u03bcm, respectively. The emission flux of natural sea salt is first divided into 31 size bins, following the parameterization of M\u00e5rtensson et al. (2003)<sup>9</sup> and Monahan et al. (1986),<sup>10</sup> and then redistributed to the three MAM4 size modes.</p>"},{"location":"EAM/tech-guide/mam/#namelist-parameters","title":"Namelist parameters","text":"<p>MAM Namelist Parameters</p> <ol> <li> <p>Hailong Wang, Richard C. Easter, Rudong Zhang, Po\u2010Lun Ma, Balwinder Singh, Kai Zhang, Dilip Ganguly, Philip J. Rasch, Susannah M. Burrows, Steven J. Ghan, Sijia Lou, Yun Qian, Yang Yang, Yan Feng, Mark Flanner, L. Ruby Leung, Xiaohong Liu, Manish Shrivastava, Jian Sun, Qi Tang, Shaocheng Xie, and Jin\u2010Ho Yoon. Aerosols in the E3SM Version 1: New Developments and Their Impacts on Radiative Forcing. Journal of Advances in Modeling Earth Systems, 12(1):e2019MS001851, January 2020. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019MS001851 (visited on 2024-03-29), doi:10.1029/2019MS001851.\u00a0\u21a9\u21a9</p> </li> <li> <p>X. Liu, R. C. Easter, S. J. Ghan, R. Zaveri, P. Rasch, X. Shi, J.-F. Lamarque, A. Gettelman, H. Morrison, F. Vitt, A. Conley, S. Park, R. Neale, C. Hannay, A. M. L. Ekman, P. Hess, N. Mahowald, W. Collins, M. J. Iacono, C. S. Bretherton, M. G. Flanner, and D. Mitchell. Toward a minimal representation of aerosols in climate models: description and evaluation in the Community Atmosphere Model CAM5. Geoscientific Model Development, 5(3):709\u2013739, May 2012. URL: https://gmd.copernicus.org/articles/5/709/2012/ (visited on 2024-03-29), doi:10.5194/gmd-5-709-2012.\u00a0\u21a9</p> </li> <li> <p>Michael J. Mills, Anja Schmidt, Richard Easter, Susan Solomon, Douglas E. Kinnison, Steven J. Ghan, Ryan R. Neely, Daniel R. Marsh, Andrew Conley, Charles G. Bardeen, and Andrew Gettelman. Global volcanic aerosol properties derived from emissions, 1990\u20132014, using CESM1(WACCM). Journal of Geophysical Research: Atmospheres, 121(5):2332\u20132348, March 2016. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1002/2015JD024290 (visited on 2024-04-25), doi:10.1002/2015JD024290.\u00a0\u21a9</p> </li> <li> <p>Daniele Visioni, Simone Tilmes, Charles Bardeen, Michael Mills, Douglas G. MacMartin, Ben Kravitz, and Jadwiga H. Richter. Limitations of assuming internal mixing between different aerosol species: a case study with sulfate geoengineering simulations. Atmospheric Chemistry and Physics, 22(3):1739\u20131756, February 2022. URL: https://acp.copernicus.org/articles/22/1739/2022/ (visited on 2024-04-25), doi:10.5194/acp-22-1739-2022.\u00a0\u21a9</p> </li> <li> <p>R. R. Neely III and A. Schmidt. VolcanEESM: Global volcanic sulphur dioxide (SO2) emissions database from 1850 to present - Version 1.0. 2016. URL: https://catalogue.ceda.ac.uk/uuid/a8a7e52b299a46c9b09d8e56b283d385 (visited on 2024-04-25), doi:10.5285/76EBDC0B-0EED-4F70-B89E-55E606BCD568.\u00a0\u21a9</p> </li> <li> <p>X. Liu, P.-L. Ma, H. Wang, S. Tilmes, B. Singh, R. C. Easter, S. J. Ghan, and P. J. Rasch. Description and evaluation of a new four-mode version of the Modal Aerosol Module (MAM4) within version 5.3 of the Community Atmosphere Model. Geoscientific Model Development, 9(2):505\u2013522, February 2016. URL: https://gmd.copernicus.org/articles/9/505/2016/ (visited on 2024-03-29), doi:10.5194/gmd-9-505-2016.\u00a0\u21a9\u21a9</p> </li> <li> <p>Susannah M. Burrows, Richard C. Easter, Xiaohong Liu, Po-Lun Ma, Hailong Wang, Scott M. Elliott, Balwinder Singh, Kai Zhang, and Philip J. Rasch. OCEANFILMS (Organic Compounds from Ecosystems to Aerosols: Natural Films and Interfaces via Langmuir Molecular Surfactants) sea spray organic aerosol emissions \u2013 implementation in a global climate model and impacts on clouds. Atmospheric Chemistry and Physics, 22(8):5223\u20135251, April 2022. URL: https://acp.copernicus.org/articles/22/5223/2022/ (visited on 2024-03-29), doi:10.5194/acp-22-5223-2022.\u00a0\u21a9</p> </li> <li> <p>Mingxuan Wu, Hailong Wang, Richard C. Easter, Zheng Lu, Xiaohong Liu, Balwinder Singh, Po\u2010Lun Ma, Qi Tang, Rahul A. Zaveri, Ziming Ke, Rudong Zhang, Louisa K. Emmons, Simone Tilmes, Jack E. Dibb, Xue Zheng, Shaocheng Xie, and L. Ruby Leung. Development and Evaluation of E3SM\u2010MOSAIC: Spatial Distributions and Radiative Effects of Nitrate Aerosol. Journal of Advances in Modeling Earth Systems, 14(11):e2022MS003157, November 2022. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2022MS003157 (visited on 2024-03-29), doi:10.1029/2022MS003157.\u00a0\u21a9</p> </li> <li> <p>E. M. M\u00e5rtensson, E. D. Nilsson, G. De Leeuw, L. H. Cohen, and H.\u2010C. Hansson. Laboratory simulations and parameterization of the primary marine aerosol production. Journal of Geophysical Research: Atmospheres, 108(D9):2002JD002263, May 2003. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2002JD002263 (visited on 2024-03-29), doi:10.1029/2002JD002263.\u00a0\u21a9</p> </li> <li> <p>E. C. Monahan, D. E. Spiel, and K. L. Davidson. A Model of Marine Aerosol Generation Via Whitecaps and Wave Disruption. In Edward C. Monahan and Gear\u00f3id Mac Niocaill, editors, Oceanic Whitecaps: And Their Role in Air-Sea Exchange Processes, pages 167\u2013174. Springer Netherlands, Dordrecht, 1986. URL: https://doi.org/10.1007/978-94-009-4668-2_16 (visited on 2024-03-29), doi:10.1007/978-94-009-4668-2_16.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/oceanfilms/","title":"OCEANFILMS","text":""},{"location":"EAM/tech-guide/oceanfilms/#overview","title":"Overview","text":"<p>E3SM (v1-v3) uses the OCEANFILMS (Organic Compounds from Ecosystems to Aerosols: Natural Films and Interfaces via Langmuir Molecular Surfactants) parameterization to represent sea spray organic aerosol emissions.  OCEANFILMS is a physically based model that links sea spray chemistry with ocean biogeochemistry using a Langmuir partitioning approach.  The underlying physical assumptions and parameterization are described in Burrows et al. (2014);<sup>1</sup> the implementation in E3SM and impact on clouds and climate are documented in Burrows et al. (2022).<sup>2</sup></p>"},{"location":"EAM/tech-guide/oceanfilms/#namelist-parameters","title":"Namelist parameters","text":"<p>OCEANFILMS Namelist Parameters</p> <ol> <li> <p>S. M. Burrows, O. Ogunro, A. A. Frossard, L. M. Russell, P. J. Rasch, and S. M. Elliott. A physically based framework for modeling the organic fractionation of sea spray aerosol from bubble film Langmuir equilibria. Atmospheric Chemistry and Physics, 14(24):13601\u201313629, December 2014. URL: https://acp.copernicus.org/articles/14/13601/2014/ (visited on 2024-03-29), doi:10.5194/acp-14-13601-2014.\u00a0\u21a9</p> </li> <li> <p>Susannah M. Burrows, Richard C. Easter, Xiaohong Liu, Po-Lun Ma, Hailong Wang, Scott M. Elliott, Balwinder Singh, Kai Zhang, and Philip J. Rasch. OCEANFILMS (Organic Compounds from Ecosystems to Aerosols: Natural Films and Interfaces via Langmuir Molecular Surfactants) sea spray organic aerosol emissions \u2013 implementation in a global climate model and impacts on clouds. Atmospheric Chemistry and Physics, 22(8):5223\u20135251, April 2022. URL: https://acp.copernicus.org/articles/22/5223/2022/ (visited on 2024-03-29), doi:10.5194/acp-22-5223-2022.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/p3/","title":"Predicted Particle Properties","text":""},{"location":"EAM/tech-guide/p3/#overview","title":"Overview","text":"<p>The stratiform cloud microphysics scheme in v3 is Predicted Particle Properties (P3; Morrison &amp; Milbrandt, 2015;<sup>1</sup> Milbrandt &amp; Morrison, 2016<sup>2</sup>). P3 offers a new approach to representing the evolution of ice particles that is more physical than the traditional approach of using predefined ice categories. It has been implemented in E3SM (Wang et al., 2021)<sup>3</sup> to address the limitations in the original microphysics scheme- the lack of riming particles and the artificial conversion between ice crystals and snow particles. The current version in E3SM is a two-moment scheme with a single ice category (Morrison &amp; Milbrandt, 2015).<sup>1</sup> In addition to the total ice number and mass mixing ratios, P3 prognoses the rimed mass and rimed volume mixing ratios, which allows for the prediction of the continuous evolution of the rime fraction and particle density. It is worth noting that the ice nucleation parameterizations are changed to be aerosol-dependent in this study, with the heterogenous ice nucleation parameterizations from the Classical Nucleation Theory (Liu et al., 2012)<sup>4</sup> and the homogenous in-situ cirrus formation based on Liu and Penner (2005).<sup>5</sup> This differs from the P3 used in WRF and that used in the E3SM v1 in Wang et al. (2021)<sup>3</sup> where the heterogeneous ice nucleation parameterizations are temperature dependent only.</p>"},{"location":"EAM/tech-guide/p3/#namelist-parameters","title":"Namelist parameters","text":"<p>P3 Namelist Parameters</p> <ol> <li> <p>Hugh Morrison and Jason A. Milbrandt. Parameterization of Cloud Microphysics Based on the Prediction of Bulk Ice Particle Properties. Part I: Scheme Description and Idealized Tests. Journal of the Atmospheric Sciences, 72(1):287\u2013311, January 2015. URL: https://journals.ametsoc.org/view/journals/atsc/72/1/jas-d-14-0065.1.xml (visited on 2024-03-29), doi:10.1175/JAS-D-14-0065.1.\u00a0\u21a9\u21a9</p> </li> <li> <p>J. A. Milbrandt and H. Morrison. Parameterization of Cloud Microphysics Based on the Prediction of Bulk Ice Particle Properties. Part III: Introduction of Multiple Free Categories. Journal of the Atmospheric Sciences, 73(3):975\u2013995, March 2016. URL: https://journals.ametsoc.org/view/journals/atsc/73/3/jas-d-15-0204.1.xml (visited on 2024-03-29), doi:10.1175/JAS-D-15-0204.1.\u00a0\u21a9</p> </li> <li> <p>Jingyu Wang, Jiwen Fan, Zhe Feng, Kai Zhang, Erika Roesler, Benjamin Hillman, Jacob Shpund, Wuyin Lin, and Shaocheng Xie. Impact of a New Cloud Microphysics Parameterization on the Simulations of Mesoscale Convective Systems in E3SM. Journal of Advances in Modeling Earth Systems, 13(11):e2021MS002628, November 2021. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2021MS002628 (visited on 2024-03-29), doi:10.1029/2021MS002628.\u00a0\u21a9\u21a9</p> </li> <li> <p>X. Liu, R. C. Easter, S. J. Ghan, R. Zaveri, P. Rasch, X. Shi, J.-F. Lamarque, A. Gettelman, H. Morrison, F. Vitt, A. Conley, S. Park, R. Neale, C. Hannay, A. M. L. Ekman, P. Hess, N. Mahowald, W. Collins, M. J. Iacono, C. S. Bretherton, M. G. Flanner, and D. Mitchell. Toward a minimal representation of aerosols in climate models: description and evaluation in the Community Atmosphere Model CAM5. Geoscientific Model Development, 5(3):709\u2013739, May 2012. URL: https://gmd.copernicus.org/articles/5/709/2012/ (visited on 2024-03-29), doi:10.5194/gmd-5-709-2012.\u00a0\u21a9</p> </li> <li> <p>Xiaohong Liu and Joyce E. Penner. Ice nucleation parameterization for global models. Meteorologische Zeitschrift, pages 499\u2013514, September 2005. URL: https://www.schweizerbart.de/papers/metz/detail/14/54281/Ice_nucleation_parameterization_for_global_models (visited on 2024-03-29), doi:10.1127/0941-2948/2005/0059.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/rrtmg/","title":"Rapid Radiative Transfer Model for GCMs","text":""},{"location":"EAM/tech-guide/rrtmg/#overview","title":"Overview","text":"<p>The calculation of radiative energy flux through the atmosphere is done using the RRTMG radiation package (Iacono et al., 2008;<sup>1</sup> Mlawer et al., 1997<sup>2</sup>). The details are consistent with the implementation in CAM5 described in Neale et al. (2012).<sup>3</sup> Radiative fluxes are broadly split into shortwave and longwave and computed by separate codes. The shortwave solver uses the 2-stream approximation, while the longwave is an absorption/emission code. Both shortwave and longwave use the correlated k-distribution method for integration of fluxes. Subgrid cloud overlap is accounted for using the Monte Carlo Independent Column Approximation (MCICA; Pincus and Morcrette, 2003),<sup>4</sup> assuming the cloudy portions of the column are maximally overlapped in vertically contiguous layers and randomly overlapped when two layers are separated by a completely clear layer. Cloud optics are parameterized as described in Neale et al.(2010).<sup>3</sup></p>"},{"location":"EAM/tech-guide/rrtmg/#namelist-parameters","title":"Namelist parameters","text":"<p>RRTMG Namelist Parameters</p> <ol> <li> <p>Michael J. Iacono, Jennifer S. Delamere, Eli J. Mlawer, Mark W. Shephard, Shepard A. Clough, and William D. Collins. Radiative forcing by long\u2010lived greenhouse gases: Calculations with the AER radiative transfer models. Journal of Geophysical Research: Atmospheres, 113(D13):2008JD009944, July 2008. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2008JD009944 (visited on 2024-03-29), doi:10.1029/2008JD009944.\u00a0\u21a9</p> </li> <li> <p>Eli J. Mlawer, Steven J. Taubman, Patrick D. Brown, Michael J. Iacono, and Shepard A. Clough. Radiative transfer for inhomogeneous atmospheres: RRTM, a validated correlated\u2010k model for the longwave. Journal of Geophysical Research: Atmospheres, 102(D14):16663\u201316682, July 1997. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/97JD00237 (visited on 2024-03-29), doi:10.1029/97JD00237.\u00a0\u21a9</p> </li> <li> <p>Richard B. Neale, Andrew Gettelman, Sungsu Park, Chih-Chieh Chen, Peter H. Lauritzen, David L. Williamson, Andrew J. Conley, Doug Kinnison, Dan Marsh, Anne K. Smith, Francis M. Vitt, Rolando Garcia, Jean-Francois Lamarque, Michael J. Mills, Simone Tilmes, Hugh Morrison, Philip Cameron-Smith, William D. Collins, Michael J. Iacono, Richard C. Easter, Xiaohong Liu, Steven J. Ghan, Philip J. Rasch, and Mark A. Taylor. Description of the NCAR Community Atmosphere Model (CAM 5.0). UNKNOWN, 2012. URL: https://opensky.ucar.edu/islandora/object/technotes%3A594/ (visited on 2024-04-25), doi:10.5065/wgtk-4g06.\u00a0\u21a9\u21a9</p> </li> <li> <p>Robert Pincus, Howard W. Barker, and Jean\u2010Jacques Morcrette. A fast, flexible, approximate technique for computing radiative transfer in inhomogeneous cloud fields. Journal of Geophysical Research: Atmospheres, 108(D13):2002JD003322, July 2003. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2002JD003322 (visited on 2024-03-29), doi:10.1029/2002JD003322.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/vbs/","title":"Volatility Basis Set (VBS) approach for SOA","text":""},{"location":"EAM/tech-guide/vbs/#overview","title":"Overview","text":"<p>A modified volatility basis set (VBS) approach is used for both SOA precursor gases and particulate SOA that includes gas\u2010phase functionalization/fragmentation and particle\u2010phase oligomerization similar to FragNVSOA configuration of Shrivastava et al. (2015).<sup>1</sup> It includes a detailed treatment of SOA precursor gas chemistry including multigenerational aging via fragmentation and functionalization reactions, particle\u2010phase oligomerization that generates low \u201ceffective volatility\u201d SOA, and particle\u2010phase loss by photolysis. The sources of SOA include natural biogenic, anthropogenic and biomass burning organic gases that are oxidized to form lower volatility species and undergo dynamic gas-particle partitioning to form SOA. Biogenic SOA is formed by oxidation of isoprene (ISOP_VBS) and monoterpene (C10H16) volatile organic compounds (VOCs). Emissions of anthropogenic and biomass burning organic gases in the range of intermediate volatility organics (IVOCs, referred to as SOAG0) are estimated as total primary organic matter (POM) emitted from these sources multiplied by specified tunable factors. IVOCs undergo multigenerational aging with OH radicals forming SOA corresponding to anthropogenic and biomass burning sources. Photolysis of SOA is included as a chemical sink in the particle phase, in addition to dry and wet removal sinks. The photolysis rate constant of particle-phase SOA is assumed to be 0.04% of typical NO2 photolysis frequencies following Hodzic et al. (2016).<sup>2</sup> The emissions of VBS SOA related gas species and oxidants (prescribed) read from a file are documented in the User Guide.</p> <ol> <li> <p>Manish Shrivastava, Richard C. Easter, Xiaohong Liu, Alla Zelenyuk, Balwinder Singh, Kai Zhang, Po\u2010Lun Ma, Duli Chand, Steven Ghan, Jose L. Jimenez, Qi Zhang, Jerome Fast, Philip J. Rasch, and Petri Tiitta. Global transformation and fate of SOA: Implications of low\u2010volatility SOA and gas\u2010phase fragmentation reactions. Journal of Geophysical Research: Atmospheres, 120(9):4169\u20134195, May 2015. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1002/2014JD022563 (visited on 2024-03-29), doi:10.1002/2014JD022563.\u00a0\u21a9</p> </li> <li> <p>Alma Hodzic, Prasad S. Kasibhatla, Duseong S. Jo, Christopher D. Cappa, Jose L. Jimenez, Sasha Madronich, and Rokjin J. Park. Rethinking the global secondary organic aerosol (SOA) budget: stronger production, faster removal, shorter lifetime. Atmospheric Chemistry and Physics, 16(12):7917\u20137941, June 2016. URL: https://acp.copernicus.org/articles/16/7917/2016/ (visited on 2024-03-29), doi:10.5194/acp-16-7917-2016.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/tech-guide/zm/","title":"Zhang and McFarlane deep convection scheme","text":""},{"location":"EAM/tech-guide/zm/#overview","title":"Overview","text":"<p>The ZM scheme (Zhang and McFarlane, 1995)<sup>1</sup> used in E3SMv3 is a bulk mass flux-type scheme; it has three components: a trigger for convection initiation, a cloud model including both updrafts and downdrafts, and a closure. The original CAPE-based trigger for convection was replaced by a trigger function based on dynamic CAPE generation by Xie et al. (2019)<sup>2</sup> (see dCAPE-ULL description below for more details). The closure predicts cloud base mass flux using dilute CAPE (Neale et al., 2008).<sup>3</sup> The updraft model is a bulk entraining plume model. Both updrafts and downdrafts are assumed saturated, with downdraft mass flux at the downdraft initiation level set proportional to the updraft cloud base mass flux. The microphysical processes inside the updrafts are represented by a convective microphysics scheme (see ZM convective microphysics description below). An additional adjustment is made to cloud base mass flux to incorporate the effect of large-scale circulation (see mass flux adjustment description below).</p>"},{"location":"EAM/tech-guide/zm/#dcape-ull","title":"dCAPE-ULL","text":"<p>A notable update related to clouds and precipitation in E3SMv2 is the use of a new convective trigger function described by Xie et al. (2019)<sup>2</sup> in ZM to improve the simulation of precipitation and its diurnal cycle. The new convective trigger named as dCAPE-ULL uses the dynamic CAPE (dCAPE) trigger developed by Xie and Zhang (2000)<sup>4</sup> with an unrestricted air parcel launch level (ULL) approach used by Wang et al. (2015).<sup>5</sup> It was designed to address the unrealistically strong coupling of convection to the surface heating in ZM that often results in unrealistically too active model convection during the day in summer season over lands and improve the model capability to capture mid-level convection for nocturnal precipitation.</p>"},{"location":"EAM/tech-guide/zm/#zm-convective-microphysics","title":"ZM convective microphysics","text":"<p>The convective microphysics scheme is based on the work of Song and Zhang (2011)<sup>6</sup> to improve the representation of microphysical processes in convective clouds and their interaction with aerosol and stratiform clouds in GCMs. It explicitly treats the mass mixing ratio and number concentration of five hydrometeor species (cloud water, cloud ice, rain, snow, and graupel). The scheme is linked to stratiform cloud microphysics parameterization through convective detrainment of cloud liquid/ice water content and droplet/crystal number concentration, and to aerosols through cloud droplet activation and ice nucleation processes. Previous evaluations of the scheme showed that it improved the simulation of convective cloud properties and cloud hydrological cycle (Song et al., 2012;<sup>7</sup> Storer et al., 2015<sup>8</sup>). The assessment demonstrates that the convective microphysics scheme not only significantly improves the simulation of tropical variability across multiple scales but also enhances the simulation of climatological mean states.</p>"},{"location":"EAM/tech-guide/zm/#mass-flux-adjustment","title":"Mass flux adjustment","text":"<p>The convective mass flux adjustment (MAdj) is designed to represent the dynamical effects of large-scale vertical motion on convection. With MAdj, convection is enhanced (suppressed) when there is large-scale ascending (descending) motion at the planetary boundary layer top. The coupling of convection with the large-scale circulation significantly improves the simulation of climate variability across multiple scales from diurnal cycle, convectively coupled equatorial waves, to Madden-Julian oscillations (Song et al., 2023).<sup>9</sup></p>"},{"location":"EAM/tech-guide/zm/#mcsp","title":"MCSP","text":"<p>Due to inadequate model resolution, organized mesoscale convection cannot be resolved in general circulation models and thus needs to be parameterized. The Multiscale Coherent Structure Parameterization (MCSP) aims at representing the dynamical and physical effects of organized mesoscale convection.</p> <p>MCSP applies a sinusoidal baroclinic profile in the temperature, moisture, and momentum fields to represent the impact. Moncrieff et al. (2017)<sup>10</sup> and Chen et al. (2021)<sup>11</sup> have found that by adding MCSP, the both the representation of large-scale precipitation systems and the modes of variability from Tropical waves are improved.</p>"},{"location":"EAM/tech-guide/zm/#namelist-parameters","title":"Namelist parameters","text":"<p>ZM Namelist Parameters</p> <ol> <li> <p>G.J. Zhang and Norman A. McFarlane. Sensitivity of climate simulations to the parameterization of cumulus convection in the Canadian climate centre general circulation model. Atmosphere-Ocean, 33(3):407\u2013446, September 1995. URL: http://www.tandfonline.com/doi/abs/10.1080/07055900.1995.9649539 (visited on 2024-03-29), doi:10.1080/07055900.1995.9649539.\u00a0\u21a9</p> </li> <li> <p>Shaocheng Xie, Yi\u2010Chi Wang, Wuyin Lin, Hsi\u2010Yen Ma, Qi Tang, Shuaiqi Tang, Xue Zheng, Jean\u2010Christophe Golaz, Guang J. Zhang, and Minghua Zhang. Improved Diurnal Cycle of Precipitation in E3SM With a Revised Convective Triggering Function. Journal of Advances in Modeling Earth Systems, 11(7):2290\u20132310, July 2019. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019MS001702 (visited on 2024-03-29), doi:10.1029/2019MS001702.\u00a0\u21a9\u21a9</p> </li> <li> <p>Richard B. Neale, Jadwiga H. Richter, and Markus Jochum. The Impact of Convection on ENSO: From a Delayed Oscillator to a Series of Events. Journal of Climate, 21(22):5904\u20135924, November 2008. URL: https://journals.ametsoc.org/view/journals/clim/21/22/2008jcli2244.1.xml (visited on 2024-03-29), doi:10.1175/2008JCLI2244.1.\u00a0\u21a9</p> </li> <li> <p>Shaocheng Xie and Minghua Zhang. Impact of the convection triggering function on single\u2010column model simulations. Journal of Geophysical Research: Atmospheres, 105(D11):14983\u201314996, June 2000. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2000JD900170 (visited on 2024-03-29), doi:10.1029/2000JD900170.\u00a0\u21a9</p> </li> <li> <p>Yi-Chi Wang, Hua-Lu Pan, and Huang-Hsiung Hsu. Impacts of the triggering function of cumulus parameterization on warm-season diurnal rainfall cycles at the Atmospheric Radiation Measurement Southern Great Plains site: CONVECTIVE TRIGGER ON SGP NOCTURNAL RAIN. Journal of Geophysical Research: Atmospheres, 120(20):10,681\u201310,702, October 2015. URL: http://doi.wiley.com/10.1002/2015JD023337 (visited on 2024-03-29), doi:10.1002/2015JD023337.\u00a0\u21a9</p> </li> <li> <p>Xiaoliang Song and Guang J. Zhang. Microphysics parameterization for convective clouds in a global climate model: Description and single-column model tests. Journal of Geophysical Research, 116(D2):D02201, January 2011. URL: http://doi.wiley.com/10.1029/2010JD014833 (visited on 2024-03-29), doi:10.1029/2010JD014833.\u00a0\u21a9</p> </li> <li> <p>Xiaoliang Song, Guang J. Zhang, and J.-L. F. Li. Evaluation of Microphysics Parameterization for Convective Clouds in the NCAR Community Atmosphere Model CAM5. Journal of Climate, 25(24):8568\u20138590, December 2012. URL: http://journals.ametsoc.org/doi/10.1175/JCLI-D-11-00563.1 (visited on 2024-03-29), doi:10.1175/JCLI-D-11-00563.1.\u00a0\u21a9</p> </li> <li> <p>Rachel L. Storer, Guang J. Zhang, and Xiaoliang Song. Effects of Convective Microphysics Parameterization on Large-Scale Cloud Hydrological Cycle and Radiative Budget in Tropical and Midlatitude Convective Regions. Journal of Climate, 28(23):9277\u20139297, December 2015. URL: https://journals.ametsoc.org/view/journals/clim/28/23/jcli-d-15-0064.1.xml (visited on 2024-03-29), doi:10.1175/JCLI-D-15-0064.1.\u00a0\u21a9</p> </li> <li> <p>Xiaoliang Song, Guang Zhang, Hui Wan, and Shaocheng Xie. Incorporating the Effect of Large\u2010Scale Vertical Motion on Convection Through Convective Mass Flux Adjustment in E3SMv2. Journal of Advances in Modeling Earth Systems, 15(10):e2022MS003553, October 2023. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2022MS003553 (visited on 2024-03-29), doi:10.1029/2022MS003553.\u00a0\u21a9</p> </li> <li> <p>Mitchell W. Moncrieff, Changhai Liu, and Peter Bogenschutz. Simulation, Modeling, and Dynamically Based Parameterization of Organized Tropical Convection for Global Climate Models. Journal of the Atmospheric Sciences, 74(5):1363\u20131380, May 2017. URL: https://journals.ametsoc.org/view/journals/atsc/74/5/jas-d-16-0166.1.xml (visited on 2024-03-29), doi:10.1175/JAS-D-16-0166.1.\u00a0\u21a9</p> </li> <li> <p>C.\u2010C. Chen, J. H. Richter, C. Liu, M. W. Moncrieff, Q. Tang, W. Lin, S. Xie, and P. J. Rasch. Effects of Organized Convection Parameterization on the MJO and Precipitation in E3SMv1. Part I: Mesoscale Heating. Journal of Advances in Modeling Earth Systems, 13(6):e2020MS002401, June 2021. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2020MS002401 (visited on 2024-03-29), doi:10.1029/2020MS002401.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/user-guide/","title":"EAM User Guide","text":"<p>This User Guide describes how to set up and run EAM.</p>"},{"location":"EAM/user-guide/#steps-to-build-and-run-eam","title":"Steps to build and run EAM","text":"<p>EAM is not available as a standalone model.  Instead, EAM can be run in an atmosphere-only configuration. The difference when running in atmosphere-only mode (without an interactive ocean or sea-ice) would be to change the compset and grid. See the Case Control System Basic Usage for general descriptions of compsets and grids.</p> <p>Certain namelist paramaters, input data files, and output file specifcations can also be modified. These are described below as ways to customize runs.</p> <p>Step-by-step instructions on how to run and analyze E3SM with a script can be found at E3SM step-by-step guide</p>"},{"location":"EAM/user-guide/#scientifically-supported-compsets-and-grids","title":"Scientifically supported compsets and grids","text":""},{"location":"EAM/user-guide/#compsets","title":"Compsets","text":"<p>All of the compsets below run with the complete set of E3SM atmospheric configuration of EAMV3. For more information on the schemes in EAMv3, see the Technical Guide</p> <p><code>F2010</code> - Climatological present day climate (year 2010)</p> <p><code>F1850</code> - Climatological pre-industrial-day climate (year 1850)</p> <p><code>F20TR</code> - Historical EAM simulation with time varying sea-surface temperatures, aerosol emissions, and greenhouse gas forcings (year 1850-2014)</p>"},{"location":"EAM/user-guide/#grids","title":"Grids","text":"<p>Only one grid combination is currently supported for the above compsets:</p> <p><code>ne30pg2_r05_IcoswISC30E3r5</code> - ne30pg2 atmosphere, 0.5deg x 0.5deg land grid, and Icosahedral 30 km mesh with ice shelves cavities (wISC), E3SMv3 (E3) revision r5</p>"},{"location":"EAM/user-guide/#customizing-runs","title":"Customizing runs","text":""},{"location":"EAM/user-guide/#compile-time-options","title":"Compile-time options","text":"<p>Some customizations require making changes before the model is built.</p>"},{"location":"EAM/user-guide/#run-time-options","title":"Run-time options","text":"<p>Run-time customization is enabled by a Fortran namelist.</p> <p>Namelist parameters can be changed from default values by putting them in the <code>user_nl_eam</code> file in the case directory with the desired new value.</p> <p>This Table of Namelist Parameters includes many of the paramaters that control physics schemes described in the tech-guide</p>"},{"location":"EAM/user-guide/#history-file-namelist-parameters","title":"History File Namelist Parameters","text":"<p>By default, EAM will output a set of monthly-averaged variables. Additional output files can be specified using the following flags in the <code>user_nl_eam</code> file:</p> <p><code>finclX</code> - List of variables (in single quotes and separated by commas) that are added to tape X.</p> <p><code>fexclX</code> - List of variables (in single quotes and separated by commas) that will be excluded in tape X.</p> <p><code>nhtfrq</code> - List of write frequencies for each of the history files. A value of 0 denotes a monthly frequency. Negative values denote hourly frequencies (e.g., <code>-3</code> will write an output every 3 hours). Positive values denotes the frequency in model timesteps (e.g., <code>4</code> will write an output every 4 timesteps).</p> <p><code>mfilt</code> - List that sets the number of timesteps to write in a single file before starting a new file.</p> <p><code>avgflag_pertape</code> - List that sets the type of output to write. Choices are <code>'A'</code> for time-averaged output, <code>'A'</code> for instantaneous output, <code>'M'</code> for time-minimum output, and <code>'X'</code> for time-maximum output.</p>"},{"location":"EAM/user-guide/#example-output-specification","title":"Example output specification","text":"<pre><code>nhtfrq = 0,-24,-6,-3\nmfilt  = 1,30,120,24\navgflag_pertape = 'A','A','A','I'\n\nfexcl1 = 'U10' # Removes U10 output from monthly files\nfincl2 = 'PS','FLUT','PRECT','U200','V200','U850',\n          'V850','TCO','SCO','TREFHT','QREFHT'  # Output files of daily-averaged output, which includes 30 days of output in each file\nfincl3 = 'PS', 'PSL','PRECT','TUQ','TVQ','UBOT',\n          'VBOT','TREFHT','FLUT','OMEGA500','TBOT',\n          'U850','V850','U200','V200','T200','T500',\n          'Z700'  # Output files of 6-hour-averaged output, which includes 30 days of output in each file\nfincl4 = 'PRECT' # Output files of 3-hourly output with 3 days of output in every file\n</code></pre>"},{"location":"EAM/user-guide/#input-datasets","title":"Input datasets","text":"<p>Many properties of the simulated atmosphere are controlled by data sets read in by the model during initialization. Changing the content of these files is another way to customize a run.</p>"},{"location":"EAM/user-guide/#greenhouse-gases-non-reacting","title":"Greenhouse gases (non-reacting)","text":"<p>Greenhouse gas concentration inputs of non-reacting species are taken from CMIP6 Forcing Datasets provided from the input4MIPs data collection. In addition to what is provided by the input4MIPS, 2015 and 2016 have been added by extrapolating from 2013 and 2014.</p> <pre><code>inputdata/atm/cam/ggas/GHG_CMIP-1-2-0_Annual_Global_0000-2014_c20180105.nc\n</code></pre>"},{"location":"EAM/user-guide/#aerosol-physical-properties","title":"Aerosol physical properties","text":"<p>The aerosol properties files provide aerosol refractive index, density, and aerosol hygroscopicty information for each aerosol species, as well as information about lognormal mode definition and lookup tables of polynomial expression coefficients for aerosol optics calculation for each mode. These aerosol physical and chemical properties are used by the radiation, aerosol microphysics and other related source and sink processes, and droplet activation/ice nucleation schemes.</p>"},{"location":"EAM/user-guide/#aerosol-and-gas-emission-and-oxidant-files","title":"Aerosol and gas emission and oxidant files","text":"<p>Details of the aerosol and gas emission and oxidant files used in various historical, present-day, and future scenarios.</p>"},{"location":"EAM/user-guide/#linoz-v3-input-files","title":"Linoz v3 input files","text":"<p>Linozv3 uses the ozone tendency, (net production minus loss) calculated from its climatological mean state (function of month, latitude, altitude) and a first-order Taylor series expansion about the local ozone, temperature, and overhead ozone column. For historical simulation, Linozv3 uses the linozv3 data files with monthly resolution, spanning the dates 1849-01 -- 2014-12.</p>"},{"location":"EAM/user-guide/#historical-files","title":"Historical files","text":"<pre><code> linoz_data_file                = \u2018linv3_1849-2101_CMIP6_Hist_10deg_58km_c20231207.nc\u2019\n linoz_data_path                = '/lcrc/group/e3sm/data/inputdata/atm/cam/chem/trop_mozart/ub'\n linoz_data_type                = 'INTERP_MISSING_MONTHS'\n</code></pre> <p>Refer to this page for more details on Linoz v3 input files.</p>"},{"location":"EAM/user-guide/#topography","title":"Topography","text":"<p>The global elevation on the atmosphere grid is a key input dataset.  The dataset is grid dependent. It contains the geopotential data (on both the GLL dynamics and PG2 physics grids) and two surface roughness quantities, <code>SGH</code> and <code>SGH30</code>.</p> <p>EAMv3 NE30 data:</p> <pre><code>inputdata/atm/cam/topo/USGS-gtopo30_ne30np4pg2_x6t-SGH.c20210614.nc'\n</code></pre> <p>This file is computed via a complex procedure that starts with high resolution dataset (for EAMv3, we use the GTOPO30, a 30 arc-second resolution data set on a lat-lon grid) that is then downsampled to a 3km cubed-sphere grid (cube3000) and then downsampled to the atmosphere  grid on the (GLL nodes), and then smoothed with the same viscosity operator used by the dycore. The smoothed GLL topography is then mapped to the PG2 grid. Finally, two different surface roughness fields are computed:</p> <ul> <li><code>SGH30</code>: the variance between GTOPO30 and GTOPO30-downsampled-to-PG2 (independent of any dycore specific smoothing).     (used by CLUBB, TMS, vertical_diffusion)</li> <li><code>SGH</code>:  the variance between the cube3000 data and the smoothed PG2 data.  (used by GWD parameterizations)</li> </ul>"},{"location":"EAM/user-guide/#land-use-land-cover-change","title":"Land-use / land cover change","text":"<p>Info needed on land-use land cover change / land surface data</p> <p>Refer to ELM documentation.</p>"},{"location":"EAM/user-guide/#oceansea-ice","title":"Ocean/sea ice","text":"<p>The sea surface temperature and sea-ice coverage data used in F-case simulations are based on CMIP6 Forcing Datasets provided from the input4MIPs data collection. The file for the <code>F2010</code> compset is created from taking a monthly climatology of years 2005-2014. The file for the <code>F1850</code> compset is created from taking a monthly climatology of years 1870-1879.*</p> <p>*Provenenance for F1850 file</p> <p><code>F20TR</code></p> <pre><code>inputdata/ocn/docn7/SSTDATA/sst_ice_CMIP6_DECK_E3SM_1x1_c20180213.nc\n</code></pre> <p><code>F2010</code></p> <pre><code>inputdata/ocn/docn7/SSTDATA/sst_ice_CMIP6_DECK_E3SM_1x1_2010_clim_c20190821.nc \n</code></pre> <p><code>F1850</code></p> <pre><code>inputdata/ocn/docn7/SSTDATA/sst_ice_CMIP6_DECK_E3SM_1x1_1850_clim_c20190125.nc\n</code></pre>"},{"location":"EAM/user-guide/#solar-input","title":"Solar input","text":"<p>As with greenhouse gas emissions, solar input files are taken from the input4MIPs data collection that were prepared for CMIP6 Forcing Datasets.</p> <pre><code>inputdata/atm/cam/solar/Solar_1850-2299_input4MIPS_c20181106.nc\n</code></pre>"},{"location":"EAM/user-guide/aerosol_phys_prop/","title":"Aerosol physical properties","text":""},{"location":"EAM/user-guide/aerosol_phys_prop/#description","title":"Description","text":"<p>Key information</p> <ul> <li> <p>Original physical properties of aerosols are documented in Liu et al. (2012).<sup>1</sup> Detailed information is included in the supplement.</p> </li> <li> <p>Physical properties of aerosols used in E3SMv1 are documented in Wang et al. (2020).<sup>2</sup></p> </li> <li> <p>Marine organic aerosol properties are defined in Burrows et al. (2022).<sup>3</sup></p> </li> <li> <p>Dust refractive index and longwave absorption coefficients are updated by Feng et al. (2022).<sup>4</sup></p> </li> <li> <p>BC and POM hygroscopicity values are updated by Shan et al. (2024).</p> </li> <li> <p>Physical properties of the fifth mode aerosols are documented by Ke et al. (2024).</p> </li> </ul>"},{"location":"EAM/user-guide/aerosol_phys_prop/#included-fields","title":"Included fields","text":""},{"location":"EAM/user-guide/aerosol_phys_prop/#mode-properties","title":"Mode properties","text":"<ul> <li> <p>Geometric standard deviation of each lognormal mode</p> </li> <li> <p>Nominal geometric mean diameter and its lower/upper bound of values for each mode</p> </li> <li> <p>Coefficients of polynomial expression (lookup-table) for extinction, absorption, and asymmetry parameter calculations</p> </li> <li> <p>Aerosol refractive index table needed for interpolation (lookup-table) calculation (for different wavelengths)</p> </li> <li> <p>Crystalization and deliquesence relative humidity thresholds for aerosol wateruptake calculations</p> </li> </ul>"},{"location":"EAM/user-guide/aerosol_phys_prop/#species-properties","title":"Species properties","text":"<ul> <li> <p>Aerosol refractive index for each species</p> </li> <li> <p>Density for each species</p> </li> <li> <p>Aerosol hygroscopicity for each species</p> </li> <li> <p>Note that some of variables in the species property file are for bulk aerosols, so we ignore the description for them.</p> </li> </ul>"},{"location":"EAM/user-guide/aerosol_phys_prop/#files","title":"Files","text":"<p>Species properties</p> <pre><code>/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/sulfate_rrtmg_c080918.nc\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocpho_rrtmg_c130709_kPOM0.04.nc\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocphi_rrtmg_c100508.nc\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/bcpho_rrtmg_c100508.nc\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/dust_aeronet_rrtmg_c141106.nc\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ssam_rrtmg_c100508.nc\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/poly_rrtmg_c130816.nc\n</code></pre> <p>Mode properties</p> <pre><code>/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode1_rrtmg_aeronetdust_c141106.nc', \n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode2_rrtmg_c130628.nc',\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode3_rrtmg_aeronetdust_c141106.nc', \n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode4_rrtmg_c130628.nc',\n/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam5_mode5_rrtmg_sig1.2_dgnl.40_c03072023.nc'\n</code></pre>"},{"location":"EAM/user-guide/aerosol_phys_prop/#namelist","title":"Namelist","text":"<pre><code> mode_defs = 'mam5_mode1:accum:=', \n         'A:num_a1:N:num_c1:num_mr:+',\n         'A:so4_a1:N:so4_c1:sulfate:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/sulfate_rrtmg_c080918.nc:+', \n         'A:pom_a1:N:pom_c1:p-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocpho_rrtmg_c130709_kPOM0.04.nc:+',\n         'A:soa_a1:N:soa_c1:s-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocphi_rrtmg_c100508.nc:+', \n         'A:bc_a1:N:bc_c1:black-c:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/bcpho_rrtmg_c100508.nc:+',\n         'A:dst_a1:N:dst_c1:dust:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/dust_aeronet_rrtmg_c141106.nc:+', \n         'A:ncl_a1:N:ncl_c1:seasalt:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ssam_rrtmg_c100508.nc:+',\n         'A:mom_a1:N:mom_c1:m-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/poly_rrtmg_c130816.nc', \n         'mam5_mode2:aitken:=',\n         'A:num_a2:N:num_c2:num_mr:+', \n         'A:so4_a2:N:so4_c2:sulfate:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/sulfate_rrtmg_c080918.nc:+',\n         'A:soa_a2:N:soa_c2:s-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocphi_rrtmg_c100508.nc:+', \n         'A:ncl_a2:N:ncl_c2:seasalt:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ssam_rrtmg_c100508.nc:+',\n         'A:mom_a2:N:mom_c2:m-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/poly_rrtmg_c130816.nc', \n         'mam5_mode3:coarse:=',\n         'A:num_a3:N:num_c3:num_mr:+', \n         'A:dst_a3:N:dst_c3:dust:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/dust_aeronet_rrtmg_c141106.nc:+',\n         'A:ncl_a3:N:ncl_c3:seasalt:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ssam_rrtmg_c100508.nc:+', \n         'A:so4_a3:N:so4_c3:sulfate:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/sulfate_rrtmg_c080918.nc:+',\n         'A:bc_a3:N:bc_c3:black-c:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/bcpho_rrtmg_c100508.nc:+', \n         'A:pom_a3:N:pom_c3:p-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocpho_rrtmg_c130709_kPOM0.04.nc:+',\n         'A:soa_a3:N:soa_c3:s-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocphi_rrtmg_c100508.nc:+', \n         'A:mom_a3:N:mom_c3:m-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/poly_rrtmg_c130816.nc',\n         'mam5_mode4:primary_carbon:=', \n         'A:num_a4:N:num_c4:num_mr:+',\n         'A:pom_a4:N:pom_c4:p-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/ocpho_rrtmg_c130709_kPOM0.04.nc:+', \n         'A:bc_a4:N:bc_c4:black-c:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/bcpho_rrtmg_c100508.nc:+',\n         'A:mom_a4:N:mom_c4:m-organic:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/poly_rrtmg_c130816.nc', \n         'mam5_mode5:strat_coarse:=',\n         'A:num_a5:N:num_c5:num_mr:+', \n         'A:so4_a5:N:so4_c5:sulfate:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/sulfate_rrtmg_c080918.nc'\n rad_climate = 'A:H2OLNZ:H2O', 'N:O2:O2','N:CO2:CO2', 'A:O3:O3',\n         'A:N2OLNZ:N2O', 'A:CH4LNZ:CH4','N:CFC11:CFC11', 'N:CFC12:CFC12',\n         'M:mam5_mode1:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode1_rrtmg_aeronetdust_c141106.nc', \n         'M:mam5_mode2:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode2_rrtmg_c130628.nc',\n         'M:mam5_mode3:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode3_rrtmg_aeronetdust_c141106.nc', \n         'M:mam5_mode4:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam4_mode4_rrtmg_c130628.nc',\n         'M:mam5_mode5:/lcrc/group/e3sm/data/inputdata/atm/cam/physprops/mam5_mode5_rrtmg_sig1.2_dgnl.40_c03072023.nc'\n</code></pre> <ol> <li> <p>X. Liu, R. C. Easter, S. J. Ghan, R. Zaveri, P. Rasch, X. Shi, J.-F. Lamarque, A. Gettelman, H. Morrison, F. Vitt, A. Conley, S. Park, R. Neale, C. Hannay, A. M. L. Ekman, P. Hess, N. Mahowald, W. Collins, M. J. Iacono, C. S. Bretherton, M. G. Flanner, and D. Mitchell. Toward a minimal representation of aerosols in climate models: description and evaluation in the Community Atmosphere Model CAM5. Geoscientific Model Development, 5(3):709\u2013739, May 2012. URL: https://gmd.copernicus.org/articles/5/709/2012/ (visited on 2024-03-29), doi:10.5194/gmd-5-709-2012.\u00a0\u21a9</p> </li> <li> <p>Hailong Wang, Richard C. Easter, Rudong Zhang, Po\u2010Lun Ma, Balwinder Singh, Kai Zhang, Dilip Ganguly, Philip J. Rasch, Susannah M. Burrows, Steven J. Ghan, Sijia Lou, Yun Qian, Yang Yang, Yan Feng, Mark Flanner, L. Ruby Leung, Xiaohong Liu, Manish Shrivastava, Jian Sun, Qi Tang, Shaocheng Xie, and Jin\u2010Ho Yoon. Aerosols in the E3SM Version 1: New Developments and Their Impacts on Radiative Forcing. Journal of Advances in Modeling Earth Systems, 12(1):e2019MS001851, January 2020. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019MS001851 (visited on 2024-03-29), doi:10.1029/2019MS001851.\u00a0\u21a9</p> </li> <li> <p>Susannah M. Burrows, Richard C. Easter, Xiaohong Liu, Po-Lun Ma, Hailong Wang, Scott M. Elliott, Balwinder Singh, Kai Zhang, and Philip J. Rasch. OCEANFILMS (Organic Compounds from Ecosystems to Aerosols: Natural Films and Interfaces via Langmuir Molecular Surfactants) sea spray organic aerosol emissions \u2013 implementation in a global climate model and impacts on clouds. Atmospheric Chemistry and Physics, 22(8):5223\u20135251, April 2022. URL: https://acp.copernicus.org/articles/22/5223/2022/ (visited on 2024-03-29), doi:10.5194/acp-22-5223-2022.\u00a0\u21a9</p> </li> <li> <p>Y. Feng, H. Wang, P. J. Rasch, K. Zhang, W. Lin, Q. Tang, S. Xie, D. S. Hamilton, N. Mahowald, and H. Yu. Global Dust Cycle and Direct Radiative Effect in E3SM Version 1: Impact of Increasing Model Resolution. Journal of Advances in Modeling Earth Systems, 14(7):e2021MS002909, July 2022. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2021MS002909 (visited on 2024-03-29), doi:10.1029/2021MS002909.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/user-guide/emission_oxidant_files/","title":"Emission files for EAMv3 gas and aerosol species and oxidant file for VBS SOA and stratosphere sulfate formation","text":""},{"location":"EAM/user-guide/emission_oxidant_files/#overview","title":"Overview","text":"<p>This page documents emissions data for all required aerosols and precursor gases as well as oxidants input data for running EAMv3, mostly for the MAM4 aerosol scheme, from anthropogenic (i.e., industrial, energy, transportation, domestic, and agriculture activity sectors) and natural (i.e., sea spray, vegetation, fire smoke, volcano) sources. Sulfur from agriculture, domestic, transportation, waste, and shipping sectors is emitted at the surface while sulfur from energy and industry sectors is emitted at 100-300 m above the surface, and sulfur from forest fire and grass fire is emitted at higher elevations (0-6 km). POM and BC from forest fire and grass fire are emitted at 0-6 km, while those from other sources (domestic, energy, industry, transportation, waste, and shipping) are emitted at the surface. Injection height profiles for fire emissions are derived from the corresponding AeroCom profiles (Dentener et al., 2006)<sup>1</sup>, which give emissions in 6 altitude ranges (0-0.1, 0.1-0.5, 0.5-1, 1-2, 2-3, and 3-6 km). Otherwise, species emissions are assumed to be at the surface (bottom layer). Number emission fluxes each mode are calculated from mass emission fluxes based on AeroCom prescribed lognormal size distributions.</p>"},{"location":"EAM/user-guide/emission_oxidant_files/#aerosols-and-gas-precursors-common-for-eamv1v2v3","title":"Aerosols and gas precursors (common for EAMv1/v2/v3)","text":"<ul> <li>Species: SO2, SOAG0, DMS, bc_a4, pom_a4, so4_a1, so4_a2, num_a1, num_a2, num_a4</li> <li>Data sources</li> <li>Most of the original data are directly from input4MIPs with the following exceptions (E3SM specific treatments)</li> <li>SO2 takes 97.5% from the input4MIPs data (all SO2-em-anthro_input4MIPs sectors)</li> <li>SO4_a1 surf takes 2.5% from the corresponding surface sectors of input4MIPs data (SO2-em-anthro_input4MIPs sectors: AGR, SLV, WST, SHP)</li> <li>SO4_a2 surf takes 2.5% from the corresponding surface sectors of input4MIPs data (SO2-em-anthro_input4MIPs sectors: TRA, RCO)</li> <li>SO4_a1 elev takes 2.5% from the corresponding elevated sectors of input4MIPs data (SO2-em-anthro_input4MIPs sectors: ENE, IND)</li> <li>SO2 (97.5%) and SO4_a1 (2.5%) also take emissions from AR5 input file for sector contvolc (constant volcanic degassing)</li> <li>SOAG0 emissions are obtained by scaling OC (POM) emissions with a tunable factor.</li> <li>num_a1, num_a2 and num_a4 are determined by mass concentration of aerosols species in the corresponding sectors and modes.</li> </ul>"},{"location":"EAM/user-guide/emission_oxidant_files/#marine-organic-sea-spray","title":"Marine organic sea spray","text":"<p>Marine organic sea spray aerosol contributions are parameterized following the OCEANFILMS parameterization (E3SMv1; Burrows et al., 2014;<sup>2</sup> 2022<sup>3</sup>).  The input file for this parameterization provides a climatology of the ocean surface concentrations of several groups of organic macromolecules.  Briefly, the Parallel Ocean Program (POP; Maltrud et al., 1998)<sup>4</sup> and its biogeochemical elemental cycling (BEC) routines (Moore et al., 2004)<sup>5</sup> were used to simulate marine biogeochemistry fields, including particulate organic matter (POC), chlorophyll, and zooplankton concentrations; these fields were used to generate maps of the estimated surface distributions of classes of macromolecules following the methods described in Burrows et al. (2014).<sup>2</sup>  The scripts used to accomplish this translation are available here.</p> <p>The file used as an input to E3SM is available here: https://web.lcrc.anl.gov/public/e3sm/inputdata/atm/cam/chem/trop_mam/marine_BGC/monthly_macromolecules_0.1deg_bilinear_latlon_year01_merge_date.nc</p> <p>And is also published as a citeable dataset on Zenodo:</p> <p>Elliott, S. M., Maltrud, M., &amp; Burrows, S. M. (2015). Macromolecule distributions input file for the OCEANFILMS parameterization (Version v1) [Data set]. Zenodo.</p>"},{"location":"EAM/user-guide/emission_oxidant_files/#oceanic-dimethyl-sulfide-concentrations","title":"Oceanic dimethyl sulfide concentrations","text":"<p>Dimethyl sulfide (DMS) fluxes to the atmosphere are calculated in E3SM as a function of prescribed surface oceanic DMS concentrations, and an air-sea flux piston velocity that is a function of wind speed.</p> <p>E3SM uses a DMS surface concentration dataset developed from a dynamic ocean biogeochemistry simulation; the methods and underlying assumptions used to produce this dataset are documented in Wang, et al. (2015).  The resolution in the DMS dataset is 1.9x2.5 degrees.</p>"},{"location":"EAM/user-guide/emission_oxidant_files/#new-gas-species-for-chemuci-in-eamv3","title":"New gas species for chemUCI in EAMv3","text":"<ul> <li>Species: C2H4, C2H6, C3H8, CH2O, CH3CHO, CH3COCH3, CO, E90, ISOP, NO, NO2</li> <li>Data sources</li> <li>anthropogenic, biomass burning, and aircraft emissions (NO2) are regridded from NCAR CESM2 emission files. They  are time-dependent during historical period and in the future scenarios.</li> <li>biogenic emissions (C2H4, C2H6, C3H8, CH2O, CH3CHO, CH3COCH3, CO, ISOP) are from MEGAN-MACC offline data<ul> <li>1850-1979: monthly input cycled yearly from 30-year mean (1980-2009)</li> <li>1980-2014: time-varying MEGAN-MACC data (historical)</li> <li>2015-2100: monthly input cycled yearly from 30-year mean (1980-2009)</li> </ul> </li> <li>natural emissions from oceans (C2H4, C2H6, C3H8, CO) and soil (NO) are regridded from NCAR CESM2 emission files. Just cycled yearly during the historical period and in the future scenarios.</li> <li>E90 emissions?</li> </ul>"},{"location":"EAM/user-guide/emission_oxidant_files/#oxidants-file-needed-for-vbs-soa-and-stratosphere-sulfate-formation","title":"Oxidants file needed for VBS SOA and stratosphere sulfate formation","text":"<ul> <li>Species: prsd_O3, prsd_NO3, prsd_OH</li> <li>Data sources</li> <li>the file for historical simulation is the same as v1 and v2, inherited from CESM</li> <li>files for SSPs are regridded from NCAR CESM2 tracer files</li> </ul>"},{"location":"EAM/user-guide/emission_oxidant_files/#namelist-setting-for-emissions-input","title":"Namelist setting for emissions input","text":""},{"location":"EAM/user-guide/emission_oxidant_files/#historical-wcycl20tramip-f20tr","title":"Historical (WCYCL20TR)/AMIP (F20TR)","text":"<pre><code> ext_frc_specifier              = 'NO2         -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_NO2_aircraft_vertical_1750-2015_1.9x2.5_c20170608.nc',\n         'SO2         -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so2_elev_1850-2014_c180205_kzm_1850_2014_volcano.nc',\n         'SOAG0       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/emissions-cmip6_e3sm_SOAG0_elev_1850-2014_1.9x2.5_c20230201.nc',\n         'bc_a4       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_bc_a4_elev_1850-2014_c180205.nc',\n         'num_a1      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a1_elev_1850-2014_c180205.nc',\n         'num_a2      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a2_elev_1850-2014_c180205.nc',\n         'num_a4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a4_elev_1850-2014_c180205.nc',\n         'pom_a4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_pom_a4_elev_1850-2014_c180205.nc',\n         'so4_a1      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a1_elev_1850-2014_c180205.nc',\n         'so4_a2      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a2_elev_1850-2014_c180205.nc'\n\n srf_emis_specifier             = 'C10H16 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_MTERP_surface_1850-2014_1.9x2.5_c20230126.nc',\n         'C2H4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_C2H4_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'C2H6      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_C2H6_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'C3H8      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_C3H8_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'CH2O   -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CH2O_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'CH3CHO    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CH3CHO_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'CH3COCH3  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CH3COCH3_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'CO     -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CO_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'DMS    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DMSflux.1850-2100.1deg_latlon_conserv.POPmonthlyClimFromACES4BGC_c20160727.nc',\n         'E90       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions_E90_surface_1750-2015_1.9x2.5_c20210408.nc',\n         'ISOP   -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_ISOP_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'ISOP_VBS -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_ISOP_surface_1850-2014_1.9x2.5_c20210323.nc',\n         'NO     -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_NO_surface_1850-2014_1.9x2.5_c20220425.nc',\n         'SO2    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so2_surf_1850-2014_c180205.nc',\n         'SOAG0  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/emissions-cmip6_e3sm_SOAG0_surf_1850-2014_1.9x2.5_c20230201.nc',\n         'bc_a4  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_bc_a4_surf_1850-2014_c180205.nc',\n         'num_a1 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a1_surf_1850-2014_c180205.nc',\n         'num_a2 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a2_surf_1850-2014_c180205.nc',\n         'num_a4 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a4_surf_1850-2014_c180205.nc',\n         'pom_a4 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_pom_a4_surf_1850-2014_c180205.nc',\n         'so4_a1 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a1_surf_1850-2014_c180205.nc',\n         'so4_a2 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a2_surf_1850-2014_c180205.nc'\n\n tracer_cnst_datapath           = '\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/oxid'\n tracer_cnst_file               = 'oxid_1.9x2.5_L26_1850-2015_c20181106.nc'\n tracer_cnst_filelist           = ''\n tracer_cnst_specifier          = 'prsd_O3:O3','prsd_NO3:NO3','prsd_OH:OH'\n tracer_cnst_type               = 'INTERP_MISSING_MONTHS'\n</code></pre>"},{"location":"EAM/user-guide/emission_oxidant_files/#f2010","title":"F2010","text":"<pre><code> ext_frc_cycle_yr               = 2010\n ext_frc_specifier              = 'NO2         -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_NO2_aircraft_vertical_2010_clim_1.9x2.5_c20230213.nc',\n         'SO2         -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so2_elev_1x1_2010_clim_c20190821.nc',\n         'SOAG0       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/emissions-cmip6_e3sm_SOAG0_elev_2010_clim_1.9x2.5_c20230213.nc',\n         'bc_a4       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_bc_a4_elev_1x1_2010_clim_c20190821.nc',\n         'num_a1      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a1_elev_1x1_2010_clim_c20190821.nc',\n         'num_a2      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a2_elev_1x1_2010_clim_c20190821.nc',\n         'num_a4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a4_elev_1x1_2010_clim_c20190821.nc',\n         'pom_a4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_pom_a4_elev_1x1_2010_clim_c20190821.nc',\n         'so4_a1      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a1_elev_1x1_2010_clim_c20190821.nc',\n         'so4_a2      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a2_elev_1x1_2010_clim_c20190821.nc'\n ext_frc_type           = 'CYCLICAL'\n\n srf_emis_cycle_yr              = 2010\n srf_emis_specifier             = 'C10H16 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_MTERP_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'C2H4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_C2H4_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'C2H6      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_C2H6_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'C3H8      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_C3H8_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'CH2O   -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CH2O_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'CH3CHO    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CH3CHO_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'CH3COCH3  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CH3COCH3_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'CO     -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_CO_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'DMS    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DMSflux.2010.1deg_latlon_conserv.POPmonthlyClimFromACES4BGC_c20190220.nc',\n         'E90       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions_E90_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'ISOP   -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_ISOP_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'ISOP_VBS -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_ISOP_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'NO     -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/chem_gases/2degrees/emissions-cmip6_e3sm_NO_surface_2010_clim_1.9x2.5_c20230213.nc',\n         'SO2    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so2_surf_1x1_2010_clim_c20190821.nc',\n         'SOAG0  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/emissions-cmip6_e3sm_SOAG0_surf_2010_clim_1.9x2.5_c20230213.nc',\n         'bc_a4  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_bc_a4_surf_1x1_2010_clim_c20190821.nc',\n         'num_a1 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a1_surf_1x1_2010_clim_c20190821.nc',\n         'num_a2 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a2_surf_1x1_2010_clim_c20190821.nc',\n         'num_a4 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_num_a4_surf_1x1_2010_clim_c20190821.nc',\n         'pom_a4 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_pom_a4_surf_1x1_2010_clim_c20190821.nc',\n         'so4_a1 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a1_surf_1x1_2010_clim_c20190821.nc',\n         'so4_a2 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DECK_ne30/cmip6_mam4_so4_a2_surf_1x1_2010_clim_c20190821.nc'\n srf_emis_type          = 'CYCLICAL'\n\n tracer_cnst_cycle_yr           = 2015\n tracer_cnst_datapath           = '\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/oxid'\n tracer_cnst_file               = 'oxid_1.9x2.5_L26_1850-2015_c20181106.nc'\n tracer_cnst_filelist           = ''\n tracer_cnst_specifier          = 'prsd_O3:O3','prsd_NO3:NO3','prsd_OH:OH'\n tracer_cnst_type               = 'CYCLICAL'\n ```\n\n### Future Scenarios\n\n#### SSP370\n\n```fortran\next_frc_specifier              = 'NO2         -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_NO2_aircraft_vertical_2015-2100_1.9x2.5_c20240208.nc',\n         'SO2         -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so2_elev_2015-2100_c210216.nc',\n         'SOAG0       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_SOAG0_elev_2015-2100_1.9x2.5_c20240208.nc',\n         'bc_a4       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_bc_a4_elev_2015-2100_c210216.nc',\n         'num_a1      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a1_elev_2015-2100_c210216.nc',\n         'num_a2      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a2_elev_2015-2100_c210216.nc',\n         'num_a4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a4_elev_2015-2100_c210216.nc',\n         'pom_a4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_pom_a4_elev_2015-2100_c210216.nc',\n         'so4_a1      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a1_elev_2015-2100_c210216.nc',\n         'so4_a2      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a2_elev_2015-2100_c210216.nc'\n\nsrf_emis_specifier             = 'C10H16 -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_MTERP_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'C2H4      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_C2H4_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'C2H6      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_C2H6_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'C3H8      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_C3H8_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'CH2O      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CH2O_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'CH3CHO    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CH3CHO_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'CH3COCH3  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CH3COCH3_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'CO        -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CO_surface_2015-2100_1.9x2.5_c20240208.nc ',\n         'DMS       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DMSflux.1850-2100.1deg_latlon_conserv.POPmonthlyClimFromACES4BGC_c20160727.nc',\n         'E90       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/emissions_E90_surface_1750-2101_1.9x2.5_c20231222.nc',\n         'ISOP      -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'ISOP_VBS  -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'NO        -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_NO_surface_2015-2100_1.9x2.5_c20240208.nc',\n         'SO2       -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so2_surf_2015-2100_c210216.nc',\n         'SOAG0     -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_SOAG0_surf_2015-2100_1.9x2.5_c20240208.nc',\n         'bc_a4     -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_bc_a4_surf_2015-2100_c210216.nc',\n         'num_a1    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a1_surf_2015-2100_c210216.nc',\n         'num_a2    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a2_surf_2015-2100_c210216.nc',\n         'num_a4    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a4_surf_2015-2100_c210216.nc',\n         'pom_a4    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_pom_a4_surf_2015-2100_c210216.nc',\n         'so4_a1    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a1_surf_2015-2100_c210216.nc',\n         'so4_a2    -&gt; \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a2_surf_2015-2100_c210216.nc'\n\n tracer_cnst_datapath           = '\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/oxid'\n tracer_cnst_file               = 'oxid_SSP370_1.9x2.5_L70_1849-2101_c20240228.nc'\n tracer_cnst_filelist           = ''\n tracer_cnst_specifier          = 'prsd_O3:O3','prsd_NO3:NO3','prsd_OH:OH'\n tracer_cnst_type               = 'INTERP_MISSING_MONTHS'\n</code></pre> <ol> <li> <p>F. Dentener, S. Kinne, T. Bond, O. Boucher, J. Cofala, S. Generoso, P. Ginoux, S. Gong, J. J. Hoelzemann, A. Ito, L. Marelli, J. E. Penner, J.-P. Putaud, C. Textor, M. Schulz, G. R. van der Werf, and J. Wilson. Emissions of primary aerosol and precursor gases in the years 2000 and 1750 prescribed data-sets for AeroCom. Atmospheric Chemistry and Physics, 6(12):4321\u20134344, 2006. URL: https://acp.copernicus.org/articles/6/4321/2006/acp-6-4321-2006.html (visited on 2024-04-24), doi:10.5194/acp-6-4321-2006.\u00a0\u21a9</p> </li> <li> <p>S. M. Burrows, O. Ogunro, A. A. Frossard, L. M. Russell, P. J. Rasch, and S. M. Elliott. A physically based framework for modeling the organic fractionation of sea spray aerosol from bubble film Langmuir equilibria. Atmospheric Chemistry and Physics, 14(24):13601\u201313629, December 2014. URL: https://acp.copernicus.org/articles/14/13601/2014/ (visited on 2024-03-29), doi:10.5194/acp-14-13601-2014.\u00a0\u21a9\u21a9</p> </li> <li> <p>Susannah M. Burrows, Richard C. Easter, Xiaohong Liu, Po-Lun Ma, Hailong Wang, Scott M. Elliott, Balwinder Singh, Kai Zhang, and Philip J. Rasch. OCEANFILMS (Organic Compounds from Ecosystems to Aerosols: Natural Films and Interfaces via Langmuir Molecular Surfactants) sea spray organic aerosol emissions \u2013 implementation in a global climate model and impacts on clouds. Atmospheric Chemistry and Physics, 22(8):5223\u20135251, April 2022. URL: https://acp.copernicus.org/articles/22/5223/2022/ (visited on 2024-03-29), doi:10.5194/acp-22-5223-2022.\u00a0\u21a9</p> </li> <li> <p>Mathew E. Maltrud, Richard D. Smith, Albert J. Semtner, and Robert C. Malone. Global eddy\u2010resolving ocean simulations driven by 1985\u20131995 atmospheric winds. Journal of Geophysical Research: Oceans, 103(C13):30825\u201330853, December 1998. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/1998JC900013 (visited on 2024-03-29), doi:10.1029/1998JC900013.\u00a0\u21a9</p> </li> <li> <p>J. Keith Moore, Scott C. Doney, and Keith Lindsay. Upper ocean ecosystem dynamics and iron cycling in a global three\u2010dimensional model. Global Biogeochemical Cycles, 18(4):2004GB002220, December 2004. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2004GB002220 (visited on 2024-03-29), doi:10.1029/2004GB002220.\u00a0\u21a9</p> </li> </ol>"},{"location":"EAM/user-guide/namelist_parameters/","title":"Namelist parameters associated with atmosphere schemes","text":""},{"location":"EAM/user-guide/namelist_parameters/#chemuci-and-linoz-v3","title":"chemUCI and Linoz v3","text":"Parameter Description Default value* <code>airpl_emis_file</code> Aviation emission <code>chlorine_loading_file</code> Chlorine loading <code>chlorine_loading_fixed_ymd</code> <code>chlorine_loading_type</code> <code>ext_frc_specifier</code> 3-D emissions <code>ext_frc_cycle_yr</code> <code>ext_frc_type</code> <code>srf_emis_specifier</code> Surface emissions <code>srf_emis_cycle_yr</code> <code>srf_emis_type</code> Upper bound of mean raindrop diameter <code>linoz_data_file</code> Linoz data file <code>linoz_data_cycle_yr</code> <code>linoz_data_path</code> <code>linoz_data_type</code> <code>lght_no_prd_factor</code> Lightning NOx emission factor <code>5.0</code> <code>fstrat_efold_list</code> Tracer (from troposphere) list with e-folding decay in the stratosphere <ul> <li>Many of these namelist parameters specify input data files. Check the <code>atm_in</code> file for examples or refer to the Users' Guide.</li> </ul>"},{"location":"EAM/user-guide/namelist_parameters/#cloud-layers-unified-by-binormals","title":"Cloud Layers Unified By Binormals","text":"Parameter Description Default value <code>gamma_coef</code> Width of vertical velocity within a Gaussian PDF component at low skewness <code>0.12</code> <code>gamma_coefb</code> Width of vertical velocity within a Gaussian PDF component at high skewness <code>0.28</code> <code>C8</code> Coefficient of damping of third moment of vertical velocity, w\u20193 <code>5.2</code> <code>C1</code> Coefficient of damping of second vertical moment of vertical velocity, w\u20192, at low skewness <code>2.4</code> <code>C14</code> Coefficient of damping of second horizontal moments of vertical velocity, u\u20192 and v\u20192 <code>2.0</code> <code>c_k10</code> Ratio of diffusivity of momentum to heat <code>0.35</code>"},{"location":"EAM/user-guide/namelist_parameters/#dust-aerosol","title":"Dust aerosol","text":"Parameter Description Default value <code>dust_emis_scheme</code>* The v3 dust emission scheme (Kok et al., 2014) <code>2</code>  (set to 1 to switch to the v1/v2 scheme) <p>*This parameter is set in <code>user_nl_drv</code></p>"},{"location":"EAM/user-guide/namelist_parameters/#homme","title":"HOMME","text":"Parameter Description Default value <code>se_tstep</code> Main dycore timestep. Additional parameters control the hyper viscsosity, trancer and vertical remap timesteps, which are derived from se_tstep.  units = seconds Scales linearly with horizontal resolution.  NE30 default: <code>300</code> <code>nu</code> Tensor hyperviscosity coefficient, independent of spatial resolution.  units = 1/s <code>3.4e-8</code> <code>nu_top</code> Scalar viscosity at model top.  units = m^2/s Horizontal resolution dependent  NE30 default: <code>2.5e5</code> <code>transport_alg</code> Select between semi-lagrangian and Eulerian based transport schemes <code>12</code> = semi-lagranian method with monotinicity and mass preservation <code>statefreq</code> print a varieity of dycore metrics to the atm.log file every \u201cstatefreq\u201d timesteps <code>480</code> <code>vert_remap_alg</code> Algorithm used to remap the vertically lagrangian levels back to the reference levels <code>10</code> = strict monotonicity applied on top of a 2nd order accurate PPM method <code>se_ftype</code> Controls how physics tendencies are applied.  0=\u201ddribbled\u201d in during dynamics timesteps.  1=\u201dhard adjustment\u201d after each physics timestep.  2=hybrid approach: hard adjustment for tracers, dribbled for remaining tendencies <code>2</code>"},{"location":"EAM/user-guide/namelist_parameters/#modal-aerosol-module","title":"Modal Aerosol Module","text":"Parameter Description Default value <code>is_output_interactive_volc</code> Switch for diagnostic output of the stratospheric aerosol optics <code>.false.</code> <code>mam_amicphys_optaa</code> Recommended option of the new time-splitting treatment of H2SO4 production and loss <code>1</code>  (0 to turn it off) <code>n_so4_monolayers_pcage</code> Number of monolayers required to age primary-carbon mode particles <code>3</code> <code>seasalt_emis_scale</code> Tuning parameter for sea salt emission <code>0.55</code>"},{"location":"EAM/user-guide/namelist_parameters/#oceanfilms","title":"OCEANFILMS","text":"Parameter Description Default value <code>mam_mom_cycle_yr</code> <code>1</code> <code>mam_mom_datapath</code> Full pathname of the directory that contains the files specified in mam_mom_filelist <code>'atm/cam/chem/trop_mam/marine_BGC/'</code> <code>mam_mom_filename</code> Filename of file that contains a sequence of filenames for prescribed marine organic matter ocean concentrations.  The filenames in this file are relative to the directory specified by mam_mom_datapath. <code>'monthly_macromolecules_0.1deg_bilinear_latlon_year01_merge_date.nc'</code> <code>mam_mom_rmfile</code> Remove the file containing prescribed aerosol deposition fluxes from local disk when no longer needed. <code>FALSE</code> <code>mam_mom_specifier</code> Names of variables containing aerosol data in the prescribed aerosol datasets. <code>'chla:CHL1','mpoly:TRUEPOLYC','mprot:TRUEPROTC','mlip:TRUELIPC'</code> <code>mam_mom_datatype</code> Type of time interpolation for data in mam_mom files. Can be set to <code>'CYCLICAL'</code>, <code>'SERIAL'</code>, <code>'INTERP_MISSING_MONTHS'</code>, or <code>'FIXED'</code>. <code>'CYCLICAL'</code> <code>mam_mom_cycle_yr</code> The  cycle year of the prescribed aerosol flux data if mam_mom_type is <code>'CYCLICAL'</code>. Format: YYYY <code>1</code> <code>mam_mom_fixed_ymd</code> The date at which the prescribed aerosol flux data is fixed if mam_mom_type is <code>'FIXED'</code>. Format: YYYYMMDD <code>0</code> <code>mam_mom_fixed_tod</code> The time of day (seconds) corresponding to mam_mom_fixed_ymd at which the prescribed aerosol flux data is fixed if mam_mom_type is 'FIXED'. <code>0</code> <code>mam_mom_bubble_thickness</code> Bubble film thickness (in m) for marine organic aerosol emission mechanism.  The physically reasonable range is approximately (0.1 - 1) x 10^ -6. <code>0.1e-6</code> <code>mam_mom_mixing_state</code> Switch to select mixing state assumption in marine organic aerosol code. Currently implemented options: 0 : total external mixture, add to mass; 1 : total external mixture, replace mass; 2 : total internal mixture, add to mass; 3 : total internal mixture, replace mass. <code>0</code> [Note: set to 3 in the atm_in namelist] <code>mam_mom_parameterization</code> Selection of alternate parameterizations for marine organic matter emissions.  Set fmoa=1 for Burrows et al. (2014) <sup>1</sup> parameterization; fmoa=2 for Gantt et al. (2011) <sup>2</sup> parameterization; fmoa=3 for simple parameterization based on Quinn et al., 2014; <sup>3</sup> fmoa=4 for Rinaldi et al. (JGR, 2013).* <sup>4</sup> <code>1</code> <p>*Note: non-default values have not been carefully tested and may not work as expected.</p>"},{"location":"EAM/user-guide/namelist_parameters/#predicted-particle-properties","title":"Predicted Particle Properties","text":"Parameter Description Default value <code>do_prescribed_ccn</code> Turn on the prescribed CCN if true <code>false</code> <code>micro_aerosolactivation</code> Turn on aerosol activation if true <code>true</code> <code>micro_p3_lookup_dir</code> Directory of P3 look-up tables <code>inputdata/atm/cam/physprops</code> <code>micro_p3_tableversion</code> P3 look-up table Version <code>4.1.2</code> <code>micro_subgrid_cloud</code> Sub-grid cloud properties <code>true</code> <code>micro_tend_output</code> Output of P3 microphysical process rates <code>false</code> <code>p3_accret_coeff</code> Tunable parameter for adjusting rain accretion efficiency <code>117.25</code> <code>p3_autocon_coeff</code> Tunable parameter for adjusting droplet autoconversion efficiency <code>30500</code> <code>p3_embryonic_rain_size</code> Radius of embryomic raindrops from auto-conversion <code>0.000025</code> (m) <code>p3_max_mean_rain_size</code> Upper bound of mean raindrop diameter <code>0.005</code> (m) <code>p3_mincdnc</code> Lower bound of droplet number concentration <code>20.d6</code> (# m-3) <code>p3_nc_autocon_expon</code> Nc exponent in droplet auto-conversion <code>-1.1</code> <code>p3_qc_accret_expon</code> Qc exponent in rain accretion <code>1.15</code> <code>p3_qc_autocon_expon</code> Qc exponeent in droplet autoconversion <code>3.19</code> <code>p3_wbf_coeff</code> Tunable parameter for adjusting WBF efficiency <code>1.0</code> <code>do_cooper_inp3</code> Turn on Cooper ice nucleation scheme if true <code>false</code>"},{"location":"EAM/user-guide/namelist_parameters/#rapid-radiative-transfer-model-for-gcms","title":"Rapid Radiative Transfer Model for GCMs","text":"Parameter Description Default value <code>iradsw</code> Frequency for updating shortwave fluxes and heating rate; iradsw &gt; 0 interpreted as number of timesteps, iradsw &lt; 0 interpreted as hours; iradsw = 0 disables shortwave radiation entirely <code>-1</code> <code>iradlw</code> Frequency for updating longwave fluxes and heating rate; iradlw &gt; 0 interpreted as number of timesteps, iradlw &lt; 0 interpreted as hours; iradlw = 0 disables longwave radiation entirely <code>-1</code> <code>irad_always</code> Length of time in timesteps (irad_always &gt; 0) or in hours (irad_always &lt; 0) SW/LW radiation will be run continuously from the start of an initial or restart run <code>0</code> <code>use_rad_dt_cosz</code> If true, use the radiation dt for all cosz calculations; calculates solar zenith angle averaged over a time step. In default model solar zenith angle is held constant over time <code>.true.</code>  (set by namelist_defaults_eam.xml for default physics) <code>spectralflux</code> Calculate fluxes (up and down) per band <code>.false.</code> <code>liqcldoptics</code> Choice of cloud optical property parameterization for liquid clouds. Valid options are \u2018slingo\u2019 or \u2018gammadist\u2019 <code>gammadist</code> <code>icecldoptics</code> Choice of cloud optical property parameterization for ice clouds. Valid options are \u2018ebertcurry\u2019 or \u2018mitchell\u2019 <code>mitchell</code>"},{"location":"EAM/user-guide/namelist_parameters/#zhang-and-mcfarlane-deep-convection-scheme","title":"Zhang and McFarlane deep convection scheme","text":"ZM Parameters Description Default value <code>zmconv_ke</code> Tunable evaporation efficiency in ZM deep convection scheme <code>2.5E-6</code> <code>zmconv_tau</code> Relaxation time in ZM deep convection scheme <code>3600</code> <code>zmconv_dmpdz</code> Parcel fractional mass entrainment rate <code>-0.7E-3</code> <code>zmconv_alfa</code> Initial downdraft mass flux fraction <code>0.14D0</code> <code>zmconv_tiedke_add</code> Temperature perturbation of an air parcel <code>0.8D0</code> <code>zmconv_cape_cin</code> Number of negative buoyancy regions that are allowed <code>1</code> dCAPE-ULL Parameters Description Default value <code>zmconv_trigdcape_ull</code> DCAPE trigger along with unrestricted launching level for ZM deep convection scheme <code>.true.</code> <code>zmconv_trig_dcape_only</code> DCAPE only trigger for ZM deep convection scheme <code>.false.</code>  If true, zmconv_trigdcape_ull must be false to use the dcape only trigger. <code>zmconv_trig_ull_only</code> Use unrestricted launching level (ULL) only trigger for ZM deep convection scheme <code>.false.</code>  If true, zmconv_trigdcape_ull must be false to use the ull only trigger. Conv. micro. Parameters Description Default value <code>zmconv_microp</code> Convective microphysics option in ZM convection scheme <code>true</code> <code>zmconv_auto_fac</code> Cloud droplet-rain autoconversion enhancement factor in the convective microphysics scheme <code>7.0</code> <code>zmconv_accr_fac</code> Cloud droplet-rain accretion enhancement factor in the convective microphysics scheme <code>1.5</code> <code>zmconv_micro_dcs</code> Autoconversion size threshold for cloud ice to snow (m) <code>150.E-6</code> Mass flux adj. Parameters Description Default value <code>zmconv_clos_dyn_adj</code> Apply mass flux adjustment to ZM convection scheme <code>true</code> MCSP Parameters Description Default value <code>zmconv_mcsp_heat_coeff</code> MCSP heating coefficient <code>0.3</code> <code>zmconv_mcsp_moisture_coeff</code> MCSP moisture coefficient <code>0.0</code> <code>zmconv_mcsp_uwind_coeff</code> MCSP zonal wind coefficient <code>0.0</code> <code>zmconv_mcsp_vwind_coeff</code> MCSP meridional wind coefficient <code>0.0</code>"},{"location":"EAM/user-guide/namelist_parameters/#cloud-feedback-model-intercomparison-project-cfmip-observation-simulator-package","title":"Cloud Feedback Model Intercomparison Project (CFMIP) Observation Simulator Package","text":"Parameter Description Default value <code>cosp_lite</code> This namelist sets cosp_ncolumns=10 and cosp_nradsteps=3 (appropriate for COSP statistics derived from seasonal averages), and runs MISR, ISCCP, MODIS, and CALIPSO lidar simulators (cosp_lmisr_sim=.true.,cosp_lisccp_sim=.true., cosp_lmodis_sim=.true.,cosp_llidar_sim=.true.). <code>false</code> <ol> <li> <p>S. M. Burrows, O. Ogunro, A. A. Frossard, L. M. Russell, P. J. Rasch, and S. M. Elliott. A physically based framework for modeling the organic fractionation of sea spray aerosol from bubble film Langmuir equilibria. Atmospheric Chemistry and Physics, 14(24):13601\u201313629, December 2014. URL: https://acp.copernicus.org/articles/14/13601/2014/ (visited on 2024-03-29), doi:10.5194/acp-14-13601-2014.\u00a0\u21a9</p> </li> <li> <p>B. Gantt, N. Meskhidze, M. C. Facchini, M. Rinaldi, D. Ceburnis, and C. D. O'Dowd. Wind speed dependent size-resolved parameterization for the organic mass fraction of sea spray aerosol. Atmospheric Chemistry and Physics, 11(16):8777\u20138790, August 2011. URL: https://acp.copernicus.org/articles/11/8777/2011/acp-11-8777-2011.html (visited on 2024-04-25), doi:10.5194/acp-11-8777-2011.\u00a0\u21a9</p> </li> <li> <p>Patricia K. Quinn, Timothy S. Bates, Kristen S. Schulz, D. J. Coffman, A. A. Frossard, L. M. Russell, W. C. Keene, and D. J. Kieber. Contribution of sea surface carbon pool to organic matter enrichment in sea spray aerosol. Nature Geoscience, 7(3):228\u2013232, March 2014. URL: https://www.nature.com/articles/ngeo2092 (visited on 2024-04-25), doi:10.1038/ngeo2092.\u00a0\u21a9</p> </li> <li> <p>Matteo Rinaldi, Sandro Fuzzi, Stefano Decesari, Salvatore Marullo, Rosalia Santoleri, Antonello Provenzale, Jost Von Hardenberg, Darius Ceburnis, Aditya Vaishya, Colin D. O'Dowd, and Maria Cristina Facchini. Is chlorophyll\u2010 \\textit a the best surrogate for organic matter enrichment in submicron primary marine aerosol? Journal of Geophysical Research: Atmospheres, 118(10):4964\u20134973, May 2013. URL: https://agupubs.onlinelibrary.wiley.com/doi/10.1002/jgrd.50417 (visited on 2024-04-25), doi:10.1002/jgrd.50417.\u00a0\u21a9</p> </li> </ol>"},{"location":"ELM/","title":"The E3SM Land Model (ELM)","text":"<p>Some introductory text here</p> <ul> <li>The ELM User Guide explains how to control ELM when its running within E3SM and how to run in Coupler-bypass mode</li> <li>The ELM Developer Guide explains ELM data structures and how to develop new code.</li> <li>The ELM Technical Guide explains the science behind ELM's code</li> </ul>"},{"location":"ELM/dev-guide/","title":"Developer Guide","text":"<p>This guide contains information for developing ELM and MOSART.</p>"},{"location":"ELM/dev-guide/#_1","title":"Developer Guide","text":"<ul> <li>Testing development branches: Generating baselines and comparing new development against baselines</li> </ul>"},{"location":"ELM/dev-guide/testing/","title":"Testing","text":"<p>When a developer is ready to issue a PR to integrate their new developments into E3SM's <code>master</code> branch, they need to test their code development to ensure the new development does not introduce unexpected bugs. A land developer needs to atleast run the <code>e3sm_land_developer</code> test suite that involves following two steps: </p> <ul> <li>Step-1: Generate the baselines using the hash on <code>master</code> that was the starting point of the    development branch, and</li> <li>Step-2: Switch to the development branch and re-run the test suite to compare against    the baselines generated in Step-1.</li> </ul> <p>For the purpose of these document, let's assume the developer branch is <code>bishtgautam/lnd/emi-example</code>.</p>"},{"location":"ELM/dev-guide/testing/#step-1-generate-baselines","title":"Step-1: Generate Baselines","text":"<p>Find the starting hash on <code>master</code> by switching to the developer branch and looking at the Git graph.</p> <pre><code>cd &lt;e3sm-dir&gt;\n\n# Switch to your branch\ngit checkout bishtgautam/lnd/emi-example\n\n# Let's look at the graph\ngit log --oneline --decorate --graph\n* 9a2cd8459 (HEAD -&gt; bishtgautam/lnd/emi-example, origin/bishtgautam/lnd/emi-example) Updates the Stub EM code\n* d11fb8c52 Adds a readme and makefile for EMI Demo code\n* 15a0e4b8d Minor update to the EMI demo code\n* 63e2f6dcd Minor fix to ELM configure script\n* 551fc79cc Updates ELM stub and demo code to use CNCarbonStateType\n* 8c9d41f87 Adds code to exchange CNCarbonStateType\n* 0000ded51 Minor fix\n* 2baa4ebec Adds fixes to cmake\n* f77ae2cea Rename few cmake files\n* b48b66dd6 Adds a demo for a Stub EM\n* fa94aea0d Fixes length of variable to store name of EMI data\n* cca0e0be1 Adds capability to print all EMI Data in a list\n* beb1fe9ee Adds .gitignore files for EMI\n* 301acfe7a Renames ExternalModelInterfaceDataMod.F90\n* f0eb5b40b Renames ExternalModelInterfaceDataDimensionMod.F90\n* 076100882 Restructures ELM's EMI directory\n*   cfb7fc2b2 Merge branch 'qzhu-lbl/lnd/ch4_inundation_bugfix' (PR #2814)\n|\\\n| * ec99b1cb4 (origin/qzhu-lbl/lnd/ch4_inundation_bugfix)  - fix ch4 inundatation parameter read in bug\n* |   c59c98116 Merge branch 'darincomeau/mpaso/enable_eddystats' (PR #2821)\n|\\ \\\n| * | c21bb46a4 Turn on eddy stats for oEC60to30v3 and oEC60to30v3wLI ocn grids by default\n* | |   a2dd2fce5 Merge pull request #2811 from E3SM-Project/jayeshkrishna/pio2_cime_changes\n</code></pre> <p>The above Git graph tells us that <code>bishtgautam/lnd/emi-example</code> started with the <code>cfb7fc2b2</code> hash on the <code>master</code>. So, we will generate the baselines using <code>cfb7fc2b2</code>. Checkout <code>cfb7fc2b2</code> and update the submodels via:</p> <pre><code>git checkout cfb7fc2b2\nNote: checking out 'cfb7fc2b2'.\n\nYou are in 'detached HEAD' state. You can look around, make experimental\nchanges and commit them, and you can discard any commits you make in this\nstate without impacting any branches by performing another checkout.\n\nIf you want to create a new branch to retain commits you create, you may\ndo so (now or later) by using -b with the checkout command again. Example:\n\n  git checkout -b &lt;new-branch-name&gt;\n\nHEAD is now at cfb7fc2b2... Merge branch 'qzhu-lbl/lnd/ch4_inundation_bugfix' (PR #2814)\n\ngit submodule update --init\n</code></pre> <p>Now we will use <code>cime/scripts/create_test</code> to generate baseline for the <code>e3sm_land_developer</code> test suite.</p> <pre><code>cd cime/scripts\n</code></pre> <p>A few things that you need to decide at this stage include the directory location where the baselines will be saved, the name and ID for the baselines, the project allocation that you will use for running the simulation, if you would like to receive email notifications about tests, etc.</p> <pre><code># Define the directory to hold the baseline \nexport MY_BASELINE_DIR=/global/cscratch1/sd/gbisht/e3sm_baselines\n\n# Do you want to use a name for the baseline? \n# One choice could be the git hash that is being used to generate the baselines.\nexport BASELINE_NAME=cfb7fc2b2\n\n# Let's set TEST_ID to be same as BASELINE_NAME\nexport TEST_ID=${BASELINE_NAME}\n\n# If you are a member of E3SM, you could use 'e3sm' project allocation\nexport PROJECT=e3sm\n\n# Set your email\nexport MAIL_USER=&lt;your-mail@something&gt;\n</code></pre> <p>Use <code>./create_test --help</code> to get a complete list of arguments. Below are some additional useful arguments for <code>./create_test</code>:</p> <pre><code># Other arguments\n# -v         : Verbose option\n# -g         : Generate the baseline\n# -q         : If you want to use a particular job queue (e.g. 'debug' queue on NERSC)\n# --walltime : Specify the wall time for jobs (e.g. 30 min is max allowable for 'debug' queue on NERSC)\n# --mail-user: If you want to receive emails about your jobs\n# --mail-type: When to receive emails. Options are: never, all, begin, end, fail.\n# -j         : Number of parallel jobs\n</code></pre> <p>Now run the <code>e3sm_land_developer</code></p> <pre><code>./create_test e3sm_land_developer  \\\n--baseline-root ${MY_BASELINE_DIR} \\\n-b ${BASELINE_NAME}                \\\n-t ${TEST_ID}                      \\\n-q regular                         \\\n-p ${PROJECT}                      \\\n--walltime 00:30:00                \\\n--mail-user $MAIL_USER             \\\n--mail-type all                    \\\n-g                                 \\\n-v                                 \\\n-j 4\n</code></pre> <p>The cases would be named <code>*.G.*</code> to denote one is generating the baselines. It will take a while to compile all the cases and submit the code. It can take a long time (&gt;30mins) for the test suite to run. To avoid interrupting the test suite in the middle, one can run the test suite within a <code>screen</code> command. After the cases have been successfully compiled and submitted, you can check that  status of test by running the <code>cs.status.${TEST_ID}</code> file that was created in the scratch directory.</p>"},{"location":"ELM/dev-guide/testing/#step-2-compare-against-previously-generated-baselines","title":"Step-2: Compare against previously generated baselines","text":"<p>Now, switch to the development branch and be sure to update submodules.</p> <pre><code>cd &lt;e3sm-dir&gt;\ngit checkout bishtgautam/lnd/emi-example\nPrevious HEAD position was cfb7fc2b2... Merge branch 'qzhu-lbl/lnd/ch4_inundation_bugfix' (PR #2814)\nSwitched to branch 'bishtgautam/lnd/emi-example'\nYour branch is up-to-date with 'origin/bishtgautam/lnd/emi-example'.\n\n# Checkout the appropriate submodules\ngit submodule update --init\n</code></pre> <p>Again initialize few settings.</p> <pre><code>cd cime/scripts\n\n# Let's use the settings as the last time\nexport MY_BASELINE_DIR=/global/cscratch1/sd/gbisht/e3sm_baselines\n\n# IMPORTANT: One needs to use the same BASELINE_NAME as in Step-1 because one wants\n#            to compare against the baselines previously generated in Step-1.\nexport BASELINE_NAME=cfb7fc2b2\n\n# You can use the hash at the tip of your branch as the ID\nexport TEST_ID=9a2cd8459\n</code></pre> <p>Run the test suite and compare (via <code>-c</code>) against previously generated baselines.</p> <pre><code>./create_test e3sm_land_developer  \\\n--baseline-root ${MY_BASELINE_DIR} \\\n-b ${BASELINE_NAME}                \\\n-t ${TEST_ID}                      \\\n-q debug                           \\\n--walltime 00:30:00                \\\n--mail-user $MAIL_USER             \\\n--mail-type all                    \\\n-c                                 \\\n-v                                 \\\n-j 4\n</code></pre> <p>The cases would be named <code>*.C.*</code> to denote one is comparing against previously generated baselines. Similar to the last time, a new <code>cs.status.${TEST_ID}</code> would be created and you can check the status of test by running it.</p>"},{"location":"ELM/tech-guide/","title":"Technical Guide","text":"<p>This Technical Guide describes the physics of ELM.</p> <ul> <li>TOP Parameterization: Parameterization of sub-grid topographical effects on solar radiation.</li> </ul>"},{"location":"ELM/tech-guide/top_solar_parameterization/","title":"Top solar parameterization","text":"<p>The TOP solar radiation parameterization in ELM accounts for the effects of sub-grid topography on solar radiation flux, including the shadow effects and multi-scattering between adjacent terrain<sup>1</sup>.</p>"},{"location":"ELM/tech-guide/top_solar_parameterization/#overview","title":"Overview","text":"<p>The incoming solar radiation for a flat surface is composed of direct radiation (\\(F_{dir}^{PP}\\)) from sun, diffuse radiation (\\(F_{dif}^{PP}\\)) from sky, and coupled radiation (\\(F_{couple}^{PP}\\)) that represents surface reflected radiation that is further reflected or scattered by atmospheric particles. ELM v1.0 and ELM v2.0 assume flat surfaces and accounts for \\(F_{dir}^{PP}\\) and \\(F_{dif}^{PP}\\), while neglecting \\(F_{couple}^{PP}\\). The solar radiation scheme of ELM v1.0 and  ELM v2.0 uses the two-stream approximations<sup>2</sup>. In contrast, the incoming solar radiation parametrization of Lee et al. (2011)<sup>3</sup> over mountainous regions includes five components (illustrated in Fig. 1): </p> <ol> <li>direct flux (\\(F_{dir}^{TOP}\\)) represents photons that are transmitted from the sun to the ground surface without encountering any reflection or scattering, </li> <li>the direct-reflected flux (\\(F_{rdir}^{TOP}\\)) represents photons that are not scattered photons reflected by surrounding terrain, </li> <li>diffuse flux (\\(F_{dif}^{TOP}\\)) represents photons that are scattered by atmospheric particles but are not reflected by the ground surface, </li> <li>diffuse-reflected flux (\\(F_{rdif}^{TOP}\\)) represents scattered photons reflected by surrounding terrain, and </li> <li>coupled flux (\\(F_{couple}^{TOP}\\)) represents remaining photons that are reflected multiple times or scattered by ground surface and atmospheric particles.</li> </ol> <p> </p>    Fig 1.: A schematic diagram of the five components of incoming solar radiation over mountains adapted from Lee et al. (2011)[^3]. The components of incoming solar radiation included are (1) direct flux, (2) diffuse flux, (3) direct-reflected flux, (4) diffuse-reflected flux, and (5) coupled flux. Local solar zenith angle (\u03b8), sky view factor (V<sub>d</sub>), and terrain configuration factor (C<sub>T</sub>) are also marked.    <p>\\(F_{dir}^{TOP}\\) is different from \\(F_{dir}^{PP}\\) because of the adjustment of solar illumination geometry and shadowing effects. \\(F_{dif}^{PP}\\) is different from \\(F_{dif}^{TOP}\\) because the sky hemisphere is occluded by adjacent terrain. Lee et al. (2011)<sup>3</sup> used the radiation fluxes over flat surfaces (i.e., \\(F_{dir}^{PP}\\) and \\(F_{dif}^{PP}\\)) to calculate the radiation fluxes over mountainous terrain based on sub-grid topographic factors. The relative deviation (\\(f_{dir}\\)) of direct flux between flat surfaces and mountains under the same atmospheric condition is defined as follows</p> \\[ \\label{eqn_fdir} f_{dir} = \\frac{F_{dir}^{TOP} - F_{dir}^{PP}}{F_{dir}^{PP}} \\] <p>The relative deviation (\\(f_{rdir}\\)) of direct-reflected flux over mountains to direct flux over flat surfaces is defined as follows:</p> \\[ \\label{eqn_frdir} f_{rdir} = \\frac{F_{rdir}^{TOP}}{F_{dir}^{PP}} \\] <p>Similarly, the relative deviations (\\(f_{dif}\\) and \\(f_{rdif}\\)) of diffuse and diffuse-reflected fluxes are expressed as follows:</p> \\[ \\label{eqn_fdif} f_{dif} = \\frac{F_{dif}^{TOP} - F_{dif}^{PP}}{F_{dir}^{PP}} \\] \\[ \\label{eqn_frdif} f_{rdif} = \\frac{F_{rdif}^{TOP}}{F_{dif}^{PP}} \\]"},{"location":"ELM/tech-guide/top_solar_parameterization/#multiple-linear-regression-model-of-lee-et-al-2011","title":"Multiple Linear Regression Model of Lee et al. (2011)","text":"<p>In theory, these four relative deviations (i.e., \\(f_{dir}\\), \\(f_{rdir}\\), \\(f_{dif}\\) and \\(f_{rdif}\\)) depend on solar illumination geometry and sub-grid topographic distribution. Based on a series of 3D Monte Carlo photon tracing simulations, Lee et al. (2011)<sup>3</sup> built a multiple linear regression parameterization to predict these four relative deviations well. The parameterization of Lee et al. (2011)<sup>3</sup> uses four variables that include the standard deviation of elevation (\\(\\sigma_h\\)) within a grid cell, grid-averaged values of cosine of the local solar incident angle (\\(\\mu\\)), sky view factor (\\(\\overline{V_d}\\)), and terrain configuration factor (\\(\\overline{C_T}\\)). Lee et al. (2011)<sup>3</sup> parameterization is given as follows:</p> \\[\\begin{bmatrix} f_{dir} \\\\ f_{dif} \\\\ f_{rdir} \\\\ f_{rdif} \\end{bmatrix} = \\mathbf{A} \\cdot  \\begin{bmatrix} \\overline{\\mu} \\\\ \\sigma_h \\\\ \\overline{V_d} \\\\ \\overline{C_T} \\\\ 1 \\end{bmatrix} \\] <p>where \\(\\mathbf{A}\\) represents the fitted parameter matrix, which was obtained based on the data generated by the 3D Monte Carlo simulations. The sky view factor (\\(V_d\\)) represents the portion of visible sky limited by surrounding terrain<sup>4</sup>, while the terrain configuration factor (\\(C_T\\)), the counterpart of the sky view factor, represents the portion of surrounding terrain which is visible to the ground target<sup>5</sup>. For an unobstructed infinite slope with the slope of \\(\\alpha\\) and aspect of \\(\\beta\\) and a given solar illumination geometry (i.e., solar zenith angle, \\(SZA\\), and solar azimuth angle, \\(SAA\\)), the cosine of the local solar incident angle (\\(\\mu\\)) can be calculated by</p> \\[ \\mu = \\cos(SZA) \\cos(\\alpha) + \\sin(SZA) \\sin(\\alpha) \\cos(SAA-\\beta) \\] <p>The \\(SZA\\) and \\(SAA\\) are assumed to be constant within a grid cell, but \\(\\alpha\\) and \\(\\beta\\) vary within a grid cell. The grid cell average solar incident angle, , can be expressed as follows:</p> \\[ \\begin{eqnarray} \\overline{\\mu} &amp;=&amp; \\overline{\\cos(SZA) \\cos(\\alpha)} + \\overline{\\sin(SZA) \\sin(\\alpha) \\cos(SAA-\\beta)} \\nonumber \\\\ &amp;=&amp; \\cos(SZA)  \\overline{\\cos(\\alpha)} +  \\sin(SZA) \\cos(SAA) + \\overline{\\sin(\\alpha) \\cos(\\beta)} + \\nonumber \\\\ &amp; &amp; \\sin(SZA) \\sin(SAA) + \\overline{\\sin(\\alpha) \\sin(\\beta)} \\end{eqnarray} \\] <p>where overlines represent grid-averaged values. To further improve the regression parameterization, \\(\\mu\\), \\(V_d\\), and \\(C_T\\) are normalized by \\(\\cos(\\alpha)\\). The land surface albedo is adjusted, instead of modifying incoming solar radiation, to maintain the surface energy conservation and the consistency between the surface and the first levels of atmosphere above the surface (Lee et al., 2015). Specifically, to keep the absorbed solar radiation of the ground surface unchanged, Lee et al. (2015) built the relationship between direct (\\(\\alpha_{dir}^{TOP}\\)) and diffuse (\\(\\alpha_{dif}^{TOP}\\)) albedo over mountains and those (\\(\\alpha_{dir}^{PP}\\) and \\(\\alpha_{dif}^PP\\)) over flat surfaces as follows:</p> \\[ \\begin{eqnarray} F_{dir}^{PP} (1 - \\alpha_{dir}^{TOP}) &amp;=&amp; (F_{dir}^{TOP} + F_{rdir}^{TOP})(1 - \\alpha_{dir}^{PP}) \\label{eqn_fdir_pp} \\\\ F_{dif}^{PP} (1 - \\alpha_{dif}^{TOP}) &amp;=&amp; (F_{dif}^{TOP} + F_{rdif}^{TOP})(1 - \\alpha_{dif}^{PP}) \\label{eqn_fdif_pp} \\end{eqnarray} \\] <p>Substituting Eqns \\eqref{eqn_fdir}-\\eqref{eqn_frdif} into Eqs \\eqref{eqn_fdir_pp}-\\eqref{eqn_fdif_pp} leads to</p> \\[ \\begin{eqnarray} \\alpha_{dir}^{TOP} &amp;=&amp; 1 - (1 + f_{dir} + f_{rdir}) (1 - \\alpha_{dir}^{PP}) \\label{eqn_alb_dir_top} \\\\ \\alpha_{dif}^{TOP} &amp;=&amp; 1 - (1 + f_{dif} + f_{rdif}) (1 - \\alpha_{dif}^{PP}) \\label{eqn_alb_dif_top} \\end{eqnarray} \\] <p>The parameterizations represented by Eqs. \\eqref{eqn_linear_reg}, \\eqref{eqn_alb_dir_top}, and \\eqref{eqn_alb_dif_top} are implemented in ELM to account for the sub-grid topographic effects on solar radiation fluxes.</p> <ol> <li> <p>Dalei Hao, Gautam Bisht, Yu Gu, Wei-Liang Lee, Kuo-Nan Liou, and L Ruby Leung. A parameterization of sub-grid topographical effects on solar radiation in the e3sm land model (version 1.0): implementation and evaluation over the tibetan plateau. Geoscientific Model Development, 14(10):6273\u20136289, 2021. doi:https://doi.org/10.5194/gmd-14-6273-2021.\u00a0\u21a9</p> </li> <li> <p>K. Oleson, D. Lawrence, G. Bonan, B. Drewniak, M. Huang, C. Koven, Z. M. Subin, and S. C. Swenson. Technical description of version 4.5 of the community land model (clm), ncar technical note. Technical Report NCAR/TN-503+ STR, National Center for Atmospheric Research (NCAR), Boulder, CO, USA, 2013. doi:https://doi.org/10.5065/D6RR1W7M.\u00a0\u21a9</p> </li> <li> <p>Wei-Liang Lee, KN Liou, and Alex Hall. Parameterization of solar fluxes over mountain surfaces for application to climate models. Journal of Geophysical Research: Atmospheres, 2011. doi:https://doi.org/10.1029/2010JD014722.\u00a0\u21a9\u21a9\u21a9\u21a9\u21a9</p> </li> <li> <p>Klemen Zak\u0161ek, Kristof O\u0161tir, and \u017diga Kokalj. Sky-view factor as a relief visualization technique. Remote sensing, 3(2):398\u2013415, 2011. doi:https://doi.org/10.3390/rs3020398.\u00a0\u21a9</p> </li> <li> <p>Jeff Dozier and James Frew. Rapid calculation of terrain parameters for radiation modeling from digital elevation data. IEEE Transactions on geoscience and remote sensing, 28(5):963\u2013969, 1990. doi:https://doi.org/10.1109/36.58986.\u00a0\u21a9</p> </li> </ol>"},{"location":"ELM/user-guide/","title":"ELM User's Guide","text":"<p>This User's Guide describes how to set up and run ELM.</p>"},{"location":"ELM/user-guide/#steps-to-build-and-run-elm","title":"Steps to build and run ELM","text":"<p>A step-by-step instruction on how to run fully coupled E3SM can be found here. Here we describe running ELM driven by atmospheric forcings provided via the data atmosphere (DATM) model for configurations that are used in the E3SM water cycle v3 campaign.</p> <p>The water cycle campaigns of E3SM v1 and v2 used ELM's satellite phenology mode (SP-mode) in which a prescribed leaf area index is used in ELM. However, the E3SM v3 water cycle campaign uses an interactive phenology by including an active biogeochemistry (BGC) cycle in ELM. Additionally, a parameterization of sub-grid topographical effects on solar radiation is included within ELM.</p>"},{"location":"ELM/user-guide/#scientifically-supported-compsets","title":"Scientifically supported compsets","text":"<p>The land-only compsets are referred to as \"I\"-compset and are supported for the following time periods: pre-industrial (1850) and historical transient (20TR). Additionally, multiple atmospheric forcing datasets can be used to drive the ELM simulations. The supported compsets are:</p> <ol> <li><code>I1850GSWCNPRDCTCBCTOP</code>: Pre-industrial ELM simulation using atmospheric forcings from GSWP3 reanalysis dataset</li> <li><code>I20TRGSWCNPRDCTCBCTOP</code>: Historical ELM simulation using GSWP atmospheric forcings with time varying greenhouse gas forcing and land use, land cover dataset (year 1850-2014).</li> </ol> <p>The E3SM coupler output forcings are most commonly used as an offline land model spinup step, in preparation for a fully-coupled E3SM experiment.</p>"},{"location":"ELM/user-guide/#supported-grid","title":"Supported grid","text":"<p>The <code>r05_r05</code> is the supported grid resolution for performing offline ELM simulation.</p>"},{"location":"ELM/user-guide/#customizing-runs","title":"Customizing runs","text":"<p>Few useful changes to <code>user_nl_elm</code></p>"},{"location":"ELM/user-guide/#changing-monthly-output-file","title":"Changing monthly output file","text":"<p>ELM by default outputs monthly history file in <code>*elm.h0.**.nc</code> files that include many variables (&gt;200). At times, many of the default output variables may not be of interest, thus one could remove all default variables (via <code>hist_empty_htapes</code>) and only include select variables (via <code>hist_fincl1</code>) to the monthly history files by</p> <pre><code>   &amp;elm_inparm\n     hist_empty_htapes = .true.\n     hist_fincl1 = 'TG', 'TV', 'FSA'\n   /\n</code></pre>"},{"location":"ELM/user-guide/#saving-additional-output-files","title":"Saving additional output files","text":"<p>ELM can output additional history files (such as <code>*elm.h1.*.nc</code>, <code>*elm.h2.*.nc</code>) that have different temporal averaging (e.g. daily, hourly, every model timestep) via <code>hist_nhtfrq</code> where</p> <ul> <li><code>-24</code> corresponds to daily average</li> <li><code>-1</code> corresponds to hourly average</li> <li><code>0</code> corresponds to monthly average</li> <li><code>1</code> corresponds to each model time step</li> </ul> <p>The number of time slices in these additional files can be controlled vai <code>hist_mfilt</code>.</p> <pre><code>   &amp;elm_inparm\n     hist_fincl2 = 'TG'\n     hist_fincl3 = 'TV'\n     hist_fincl4 = 'TG', 'TV', 'FSA'\n     hist_nhtfrq = 0, -24, -1, 1\n     hist_mfilt  = 12, 30, 24, 48\n   /\n</code></pre> <p>Using the above-mentioned settings:</p> <ul> <li>Each <code>*.elm.h1.*.nc</code> will include 30 daily average values of <code>TG</code></li> <li>Each <code>*.elm.h2.*.nc</code> will include 24 hourly average values of <code>TV</code></li> <li>Each <code>*.elm.h3.*.nc</code> will include 48 values of <code>TG</code>, <code>TV</code>, and <code>FSA</code> at   each model time step, which is typically is 30 min.</li> </ul>"},{"location":"ELM/user-guide/#running-with-fates","title":"Running with FATES","text":"<p>FATES can be run in various modes with ELM through the use of namelist settings. The FATES User's Guide section on namelist options provides guidance on enabling these different FATES run modes.</p>"},{"location":"ELM/user-guide/fates/","title":"FATES","text":"<p>FATES (Functionally Assembled Terrestrial Ecosystem Simulator) is a numerical terrestrial ecosystem model hat can be utilized as a component with various host land models such as ELM.  It is incorporated as an external module, the development of which is primarily supported by the Department of Energy\u2019s Office of Science, through the Next Generation Ecosystem Experiment - Tropics (NGEE-T) project.</p> <p>The FATES code is hosted online through a github repository at https://github.com/NGEET/fates.</p>"},{"location":"ELM/user-guide/fates/#technical-document","title":"Technical Document","text":"<p>The full FATES documentation detailing the scientific underpinnings of the model can be found in the FATES Technical Document hosted on ReadTheDocs.</p>"},{"location":"ELM/user-guide/fates/#users-and-developers-guide","title":"User's and Developer's Guide","text":"<p>The FATES team also provides a User's guide and a Developer's guide also hosted on ReadTheDocs.  Both guides and the technical documentation can be reached from the top level User's Guide</p>"},{"location":"MOSART/","title":"Model for Scale Adaptive River Transport (MOSART)","text":"<p>MOSART is the river model of E3SM. It routes the runoff genrated by ELM and provides freshwater input to the ocean model.</p> <ul> <li>The MOSART User Guide explains how to control MOSART when its running within E3SM</li> <li>The MOSART Developer Guide explains MOSART data structures and how to develop new code.</li> <li>The MOSART Technical Guide explains the science behind MOSART's code</li> </ul>"},{"location":"MOSART/dev-guide/","title":"MOSART Developer's Guide","text":"<p>This guide provides MOSART data structures and how to develop new code for MOSART.</p> <p>Coming soon...</p>"},{"location":"MOSART/tech-guide/","title":"MOSART Technical Guide","text":"<p>This guide provides scientific and technical details about MOSART.</p>"},{"location":"MOSART/tech-guide/#physics","title":"Physics","text":"<p>MOSART is a one-dimension river transport model that is designed for river routing at local, regional, and global scales (Li et al., 2013). Its primary function is to supply freshwater inputs to ocean models within coupled Earth System Models.</p> <p>MOSART divides each spatial unit, such as a latitude/longitude grid or a sub-basin, into three hydrologic categories: hillslopes, tributaries, and a main channel (see figure below). The hillslopes receive runoff and send into tributaries, which then converge into a single main channel. This main channel connects adjacent upstream and downstream units through the river network. MOSART simplifies the multiple tributaries within a spatial unit into a single hypothetical sub-network channel, which has a transport capacity equivalent to all combined tributaries.</p> <p></p> <ul> <li> <p>Hillslope Routing: Within each spatial unit, surface runoff is directed as overland flow to the sub-network channel, while subsurface runoff enters the sub-network channel directly.</p> </li> <li> <p>Sub-network Channel Routing: This channel aggregates water from the hillslopes, routes it through the channel system, and discharges it into the main channel.</p> </li> <li> <p>Main Channel Routing: The main channel collects water from the sub-network channel and any inflow from upstream spatial units, eventually discharging the accumulated water downstream to the next spatial unit or directly to the ocean.</p> </li> </ul>"},{"location":"MOSART/tech-guide/#parameters","title":"Parameters","text":""},{"location":"MOSART/tech-guide/#main-parameters-required-in-the-mosart-parameter-file","title":"Main parameters required in the MOSART parameter file","text":"Variable Name Description [unit] fdir Flow direction [unitless] lat Latitude at cell center [degree] lon Longitude at cell center [degree] frac fraction of the unit draining to the outlet [0-1] rslp main channel slope [unitless] rlen main channel length [m] tslp mean tributary channel slope averaged through the unit [unitless] area local drainage area [m^2] areaTotal total upstream drainage area, local unit included; multi flow direction [m^2] areaTotal2 total upstream drainage area, local unit included; single flow direction [m^2] rdep bankfull depth of main channel [m] rwid bankfull width of main channel [m] rwid0 floodplain width linked to main channel [m] gxr drainage density [m^-1] hslp topographic slope [unitless] twid bankfull width of local tributaries [m] nr Manning''s roughness coefficient for main channel flow [unitless] nt Manning''s roughness coefficient for tributary channel flow [unitless] nh Manning''s roughness coefficient for overland flow [unitless]"},{"location":"MOSART/tech-guide/#parameters-required-by-additional-mosart-features","title":"Parameters required by additional MOSART features","text":"<p>Coming soon.</p>"},{"location":"MOSART/user-guide/","title":"MOSART User's Guide","text":"<p>This guide describes how to set up and run MOSART.</p>"},{"location":"MOSART/user-guide/#steps-to-build-and-run-mosart","title":"Steps to build and run MOSART","text":"<p>A step-by-step instruction on how to run fully coupled E3SM can be found here. Here we describe running MOSART driven by runoff forcings provided via the data land mode(DLND). Although the default runoff forcing is predefined by the DLND compsets, the users is able to use other runoff forcing to drive MOSART.</p> <p>MOSART in the water cycle campaigns of E3SM v1, v2, and v3 was.</p>"},{"location":"MOSART/user-guide/#scientifically-supported-compsets","title":"Scientifically supported compsets","text":"<p>The mosart-only compsets are supported for multiple runoff forcing datasets that covers different domains and time periods:</p> <ol> <li><code>RMOSQIAN</code>: A 57-year (1948-2004, no leap year) global Qian runoff forcings. The native resolutions are 192*288 at daily time scale. The path to the stream file is <code>$input_data_dir/lnd/dlnd7/hcru_hcru/QIAN.daily.1948-2004.nc</code></li> <li><code>RMOSGPCC</code>: A one-year (1979) global GPCC runoff forcing. The native resoultions are 192*288 at daily time scale. The path to the stream file is <code>$input_data_dir/lnd/dlnd7/hcru_hcru/GPCC.daily.nc</code></li> <li><code>RMOSNLDAS</code>: A one-year (1975) CLM runoff forcing for NLDAS domain (North America between 25N and 53N) and spatial resolution (1/8th degree). The time scale is 3-hourly. The path to the stream file is <code>$input_data_dir/lnd/dlnd7/NLDAS/mosart_nldas_hist_1975.clm2.h1.1975-01-01-00000.nc</code>.</li> </ol>"},{"location":"MOSART/user-guide/#supported-grid","title":"Supported grid","text":"<p>The <code>r05_r05</code>, <code>NLDAS_NLDAS</code>, and <code>MOS_USRDAT</code> are the supported grid resolutions for performing offline MOSART simulations.</p>"},{"location":"MOSART/user-guide/#user-defined-runoff-forcing","title":"User-defined runoff forcing","text":"<p>Once the case is created based on the above compsets. The users can create a <code>user_dlnd.streams.txt</code> file in the <code>case_scripts</code> directory following the format below:</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;file id=\"stream\" version=\"1.0\"&gt;\n&lt;dataSource&gt;\n  GENERIC\n&lt;/dataSource&gt;\n&lt;domainInfo&gt;\n  &lt;variableNames&gt;\n    time     time\n    lon      lon\n    lat      lat\n  &lt;/variableNames&gt;\n  &lt;filePath&gt;\n    /path/to/forcing/file\n  &lt;/filePath&gt;\n  &lt;fileNames&gt;\n    Runoff_forcing.nc\n  &lt;/fileNames&gt;\n&lt;/domainInfo&gt;\n&lt;fieldInfo&gt;\n   &lt;variableNames&gt;\n    QDRAI     rofsub\n    QOVER     rofsur\n   &lt;/variableNames&gt;\n   &lt;filePath&gt;\n    /path/to/forcing/file\n   &lt;/filePath&gt;\n   &lt;fileNames&gt;\n    Runoff_forcing.nc\n   &lt;/fileNames&gt;\n   &lt;offset&gt;\n    0\n   &lt;/offset&gt;\n&lt;/fieldInfo&gt;\n&lt;/file&gt;\n</code></pre>"},{"location":"MOSART/user-guide/#customizing-runs","title":"Customizing runs","text":"<p>For default river routing simulation in MOSART (i.e. natural flow routing), one parameter file defined by <code>frivinp_rtm</code> is required. The geographic domain and spatial resolution must match the domain defined in the simulation case. Additional parameter/input files will be needed for some extra features.</p>"},{"location":"MOSART/user-guide/#output-variables-and-frequency","title":"Output variables and frequency","text":"<p>MOSART by default outputs monthly history file in <code>*mosart.h0.**.nc</code> files that include all key variables. User could choose to output additional history files (such as <code>*mosart.h1.*.nc</code>, <code>*mosart.h2.*.nc</code>) that have different temporal averaging (e.g. daily, hourly, every model timestep) via <code>rtmhist_nhtfrq</code> where</p> <ul> <li><code>-24</code> corresponds to daily average</li> <li><code>-1</code> corresponds to hourly average</li> <li><code>0</code> corresponds to monthly average</li> <li><code>1</code> corresponds to each model time step</li> </ul> <p>The number of time slices in these additional files can be controlled vai <code>rtmhist_mfilt</code>.</p> <pre><code>   &amp;mosart_inparm\n     rtmhist_fincl2 = 'FLOODPLAIN_FRACTION'\n     rtmhist_fincl3 = 'RIVER_DISCHARGE_OVER_LAND_LIQ'\n     rtmhist_nhtfrq = 0, -24, -1\n     rtmhist_mfilt  = 12, 30, 24\n   /\n</code></pre> <p>Using the above-mentioned settings:</p> <ul> <li>Each <code>*.mosart.h1.*.nc</code> will include 30 daily average values of <code>FLOODPLAIN_FRACTION</code></li> <li>Each <code>*.mosart.h2.*.nc</code> will include 24 hourly average values of <code>RIVER_DISCHARGE_OVER_LAND_LIQ</code></li> </ul>"},{"location":"MOSART/user-guide/#additional-options","title":"Additional options","text":"<p>The table below lists avaiable options defined by users through <code>user_nl_mosart</code>.</p> Flag Name Description <code>routingmethod</code> <code>1</code> for kenematic wave routing (default); <code>2</code> for diffusion wave routing <code>wrmflag</code> <code>.true.</code> for active water management; <code>.false.</code> for no water management (default) <code>inundflag</code> <code>.true.</code> for active flood inundation; <code>.false.</code> for no flood inundation (default) <code>sediflag</code> <code>.true.</code> for active sediment transport; <code>.false.</code> for no sediment transport (default) <code>heatflag</code> <code>.true.</code> for active heat transport; <code>.false.</code> for no heat transport (default)"},{"location":"MOSART/user-guide/#additional-mosart-features","title":"Additional MOSART features","text":"<p>There are some options only made available for specific features. They can be defined through <code>user_nl_mosart</code>.</p>"},{"location":"MOSART/user-guide/#water-management","title":"Water management","text":"<ul> <li> <p>Parameter file: when water management is active, one additional parameter file <code>parafile</code> is required. This file defines the location and specifics for the dams/reservoirs simulated in this scheme.</p> </li> <li> <p><code>damconstructionflag</code>: <code>0</code> - dam always exist; <code>1</code> - dam construction year is considered.</p> </li> <li> <p><code>externaldemandflag</code>: <code>0</code> - no external water demand for the WM scheme; <code>1</code> - external water demand files are required.</p> </li> <li> <p>Note if <code>externaldemandflag</code> is set to <code>1</code>, paths to monthly water demand files are requried in the <code>usr_nl_mosart</code> file through <code>demandpath = '/path/to/demand/files/</code>.</p> </li> </ul>"},{"location":"MOSART/user-guide/#flood-inundation","title":"Flood inundation","text":"<ul> <li> <p><code>opt_eleprof</code>: <code>1</code> - use actural elevation profiles derived from DEM; <code>2</code> - use hypothetical elevation profile.</p> </li> <li> <p>Note if <code>opt_eleprof</code> is set to <code>1</code>, the elevation profile data must be included in the MOSART parameter file.</p> </li> </ul>"},{"location":"MOSART/user-guide/#sediment-transport","title":"Sediment transport","text":"<ul> <li>If sediment feature is activated, D50 data must be included in the MOSART parameter file. In addition, <code>rof_sed = .true.</code> has to be defined in <code>./user_nl_cpl</code> to allow sediment flux passing into the river model through the coupler.</li> </ul>"},{"location":"MPAS-Ocean/","title":"Model for Prediction Across Scales-Ocean","text":"<p>The Model for Prediction Across Scales-Ocean (MPAS-Ocean) is the ocean component of the Energy Exascale Earth System Model (E3SM), developed by the U.S. Department of Energy.</p> <ul> <li>The MPAS-Ocean User Guide explains how to run and customize MPAS-Ocean within E3SM.</li> <li>The MPAS-Ocean Developer Guide explains MPAS-Ocean data structures and how to write new code.</li> <li>The MPAS-Ocean Technical Guide explains the science behind MPAS-Ocean.</li> </ul>"},{"location":"MPAS-Ocean/dev-guide/","title":"MPAS-Ocean Developer Guide","text":"<p>The E3SM developer guide may be found at https://e3sm.org/model/running-e3sm/developing-e3sm/.</p> <p>The MPAS developers guide is at https://mpas-dev.github.io/files/documents/MPAS-DevelopersGuide.pdf.</p>"},{"location":"MPAS-Ocean/tech-guide/","title":"MPAS-Ocean Technical Guide","text":"<p>This Technical Guide describes the governing equations, physics, and numerical discretizations of MPAS-Ocean.</p>"},{"location":"MPAS-Ocean/tech-guide/#guides-design-documents-and-documentation","title":"Guides, Design Documents, and documentation","text":"<p>MPAS-Ocean may be run as either a stand-alone model, or within the E3SM coupled climate model. The MPAS-Ocean code for both stand-alone and coupled is housed in the repository https://github.com/E3SM-Project/E3SM within the directory <code>components/mpas-ocean</code>. The stand-alone executable may be built within that directory using the make command with the required libraries, as described in Chapter 1 of the User's Guide.</p> <p>The MPAS-Ocean User's Guide provides a description of the MPAS Framework in Part I, the Governing equations for MPAS-Ocean in Chapter 8, and describes the physics behind each term and parameterization in chapter 11.</p> <p>All new features are created with design documents. The location of these documents have moved over the years, but can still be found in these locations:</p> <ol> <li>MPAS Documents repository</li> <li>E3SM repository MPAS-Ocean docs</li> <li>Documents for the new Omega model are similar to MPAS-Ocean and may be found in the Omega documentation.</li> </ol> <p>All test cases are housed in the Compass repository and, more recently, the Polaris repository. The corresponding documentation is housed in the Compass docs and Polaris docs pages.</p>"},{"location":"MPAS-Ocean/tech-guide/#publications","title":"Publications","text":"<p>Beyond the documentation, there are many publications that describe the inner workings of MPAS-Ocean:</p> <p>Ringler, T., Petersen, M., Higdon, R.L., Jacobsen, D., Jones, P.W., Maltrud, M., 2013. A multi-resolution approach to global ocean modeling. Ocean Modelling 69, 211-232.</p> <p>Petersen, M.R., D.W. Jacobsen, T.D. Ringler, M.W. Hecht, M.E. Maltrud, Evaluation of the arbitrary Lagrangian\u2013Eulerian vertical coordinate method in the MPAS-Ocean model, Ocean Modelling, Volume 86, February 2015, Pages 93-113, ISSN 1463-5003.</p> <p>Petersen, M. R., Asay\u2010Davis, X. S., Berres, A. S., Chen, Q., Feige, N., Hoffman, M. J., et al. (2019). An evaluation of the ocean and sea ice climate of E3SM using MPAS and interannual CORE\u2010II forcing. Journal of Advances in Modeling Earth Systems, 11, 1438\u2013 1458.</p>"},{"location":"MPAS-Ocean/user-guide/","title":"MPAS-Ocean Quick Start","text":"<p>This MPAS-Ocean Quick Start Guide describes how to set up and run MPAS-Ocean within E3SM. More details can be found in the MPAS-Ocean User's Guide, as well as instructions on running the stand-alone ocean model.</p>"},{"location":"MPAS-Ocean/user-guide/#steps-to-build-and-run-mpas-ocean","title":"Steps to build and run MPAS-Ocean","text":"<p>Step-by-step instructions on how to run E3SM can be found at https://docs.e3sm.org/running-e3sm-guide.</p> <p>This MPAS-Ocean Quick Start guide provides the additional information to run configurations that are not fully-coupled (e.g. C-case: active ocean only; G-case: active ocean and sea ice) within E3SM. This is done by changing the compset. Certain parameters, including the mesh, namelist parameters, input data files, and output file specifcations can also be modified. These are described below as ways to customize runs.</p> <p>Templates of 1-month example E3SM run-scripts for a G-case and C-case are provided. Key information for the user to modify includes:</p> <ul> <li><code>MACHINE</code> and <code>PROJECT</code> if applicable</li> <li>Paths for code repository in <code>CODE_ROOT</code> and case directory in <code>CASE_ROOT</code>, which includes the run directory for output.</li> <li>Simulation compsets, resolution and name (see below)</li> <li>Wallclock duration in <code>WALLTIME</code> and simulation duration with <code>STOP_OPTION</code> and <code>STOP_N</code>.</li> </ul> <p>Additional runscript examples can be found here for v3.LR.</p>"},{"location":"MPAS-Ocean/user-guide/#scientifically-supported-compsets-and-meshes","title":"Scientifically supported compsets and meshes","text":""},{"location":"MPAS-Ocean/user-guide/#compsets","title":"Compsets","text":"<p>The compsets below are typical ocean and sea ice-focused compsets supported by E3SM:</p> <p><code>GMPAS-JRA1p5</code> - Active ocean-sea ice configuration forced by data atmosphere based on JRA55 v1.5 (covers 63 years, 1958-2020)</p> <p><code>GMPAS-IAF</code> - Active ocean-sea ice configuration forced by data atmosphere based on CORE-II (covers 62 years, 1948-2009)</p> <p><code>GMPAS-JRA1p5-DIB-DISMF</code> - Active ocean-sea ice configuration forced by JRA55 v1.5 atmosphere (as above), with data iceberg and data ice-shelf melt</p> <p><code>GMPAS-JRA1p5-DIB-PISMF</code> - Active ocean-sea ice configuration forced by JRA55 v1.5 atmosphere (as above), with data iceberg and prognostic ice-shelf melt</p> <p><code>CMPASO-JRA1p4</code> - Active ocean configuration forced by data atmosphere based on JRA55 v1.4 (covers 61 years, 1958-2018)</p> <p><code>CMPASO-IAF</code> - Active ocean configuration forced by data atmosphere based on CORE-II (covers 62 years, 1948-2009)</p> <p>Additional compsets can be found in the mpas-ocean <code>config_compsets.xml</code>. Note that the fully coupled compsets and their aliases can be found in the cime allactive <code>config_compsets.xml</code>. For more information on the schemes used within MPAS-Ocean, refer to the MPAS-Ocean User's Guide.</p> <p>A full list of Compsets in the current repository can be listed using</p> <pre><code>cd cime/scripts\n./query_config --compsets\n</code></pre>"},{"location":"MPAS-Ocean/user-guide/#meshes","title":"Meshes","text":"<p>Some supported meshes for G- and C-cases include:</p> <p><code>TL319_IcoswISC30E3r5</code> - Icosahedral 30 km mesh with ice shelves cavities (wISC), E3SMv3 (E3) revision r5, TL319 is the grid for JRA.</p> <p><code>T62_IcoswISC30E3r5</code> - Icosahedral 30 km mesh with ice shelves cavities (wISC), E3SMv3 (E3) revision r5, T62 is the grid for CORE-II.</p> <p><code>T62_oQU240</code> - Quasi uniform 2-degree ocean mesh, to be used with CORE-II only. Good for rapid testing, used in nightly testing not production runs.  This grid is not scientifically validated .</p> <p>Note: the mesh should be consistent with the compset (e.g. JRA vs CORE). Additional mesh information can be found here.</p> <p>A full list of Meshes in the current repository can be listed using</p> <pre><code>cd cime/scripts\n./query_config --grids\n</code></pre>"},{"location":"MPAS-Ocean/user-guide/#customizing-runs","title":"Customizing runs","text":""},{"location":"MPAS-Ocean/user-guide/#namelist-changes","title":"Namelist changes","text":"<p>Without additional input, E3SM will generate the namelist file <code>mpaso_in</code> in the run directory using the default values for the compset and mesh requested. Namelist parameters can be changed from default values by modifying the <code>user_nl_mpaso</code> file, found in the <code>case_scripts</code> directory. This is done by entering <code>[namelist option] = [changed value]</code> as separate lines in the <code>user_nl_mpaso</code> file. All other options will remain defaults. These changes can be added at run time and will take effect in the next submission.</p> <p>Refer to the MPAS-Ocean User's Guide (Chapter 10) for a comprehensive description of the namelist parameters and the options that they correspond to. Namelist options may also be found in the code repository in the file <code>components/mpas-ocean/src/Registry.xml</code> for general flags, <code>components/mpas-ocean/src/tracer_groups/Registry_*.xml</code> for specific tracer group flags, and <code>components/mpas-ocean/src/analysis_members/Registry_*.xml</code> for analysis member flags.</p>"},{"location":"MPAS-Ocean/user-guide/#example-of-a-namelist-change-via-user_nl_mpaso","title":"Example of a namelist change via <code>user_nl_mpaso</code>","text":"<pre><code> config_GM_closure = 'constant'\n config_gm_constant_kappa = 900\n config_time_integrator = 'split_explicit'\n config_am_timeseriesstatsmonthly_compute_interval = '00-00-01_00:00:00'\n</code></pre> <p>In this example, the namelist changes include changing the eddy closure (first 2 options for the type of closure and a parameter value), switching the time integration scheme, and modifying an analysis member (in this case, the interval from which the monthly analysis member is computed).</p> <p>Reminder: <code>user_nl_mpaso</code> can be empty. All options not specified are defaults (given the compset and mesh). Some options (like interior restoring) require extra fields to be present in the input file.  </p>"},{"location":"MPAS-Ocean/user-guide/#configuring-input-and-output-for-mpas-ocean","title":"Configuring input and output for MPAS-Ocean","text":"<p>The reading and writing of model fields in MPAS is handled by user-configurable streams. A stream represents a fixed set of model fields, together with dimensions and attributes, that are all written or read together to or from the same file or set of files. They are used for reading initial conditions, for writing and reading restart fields, and for writing additional model history fields. Streams are defined in XML configuration files that are created at build time for each model core. The name of this XML file for the ocean core is <code>streams.ocean</code> (the sea ice has a similar <code>streams.seaice</code>). Importantly, the stream file is generated in the run directory during the <code>./case.setup</code> step, but changes made into the run directory will not take effect. To make changes to the output fields, copy the <code>streams.ocean</code> file from the run directory into the<code>case_scripts/SourceMods/src.mpaso/</code> directory. Changes to the stream file made into the <code>SourceMods</code> sub-directory will take effect on the next case submission (there is no need to re-compile after making modifications to the XML file). Alternatively, changes to the streams file can be made directly in the code in <code>components/mpas-ocean/cime_config/buildnml</code>.</p>"},{"location":"MPAS-Ocean/user-guide/#checking-initial-conditions","title":"Checking initial conditions","text":"<p>Key information to check regarding the input data typically include:</p> <pre><code>&lt;immutable_stream name=\"mesh\"\n                  type=\"none\"\n                  io_type=\"pnetcdf\"\n                  filename_template=\"/lcrc/group/e3sm/data/inputdata/ocn/mpas-o/IcoswISC30E3r5/mpaso.IcoswISC30E3r5.20231120.nc\"\n/&gt;\n&lt;immutable_stream name=\"input\"\n                  type=\"input\"\n                  io_type=\"pnetcdf\"\n                  input_interval=\"initial_only\"\n                  filename_template=\"/lcrc/group/e3sm/data/inputdata/ocn/mpas-o/IcoswISC30E3r5/mpaso.IcoswISC30E3r5.20231120.nc\"\n/&gt;\n</code></pre> <p>The <code>mesh</code> filename points to the mesh file used. The <code>input</code> filename points to the file containing the ocean initial conditions (if the run type is <code>initial</code>). The streams file can be large, it is often useful to rely on the search function to navigate it. For larger meshes (millions of horizontal cells) the flag <code>io_type=\"pnetcdf\"</code> must be changed to <code>io_type=\"pnetcdf,cdf5\"</code>.</p>"},{"location":"MPAS-Ocean/user-guide/#checking-and-modifying-the-output-data","title":"Checking and modifying the output data","text":"<p>By default, MPAS-Ocean will output a set of monthly-averaged variables. The streams file can be modified to include additional variables in the existing output files, produce additional output files, or change the output frequency (e.g. high frequency files shifting between daily or 5-daily frequencies).</p> <p>The XML file is organized into blocks describing each stream. Typical streams for output include:</p> <p><code>timeSeriesStatsMonthlyOutput</code> - monthly averaged output</p> <p><code>highFrequencyOutput</code> - high frequency snapshots (not averaged) output with frequency <code>output_interval</code></p> <p>Under each block header is the list of variables (individual variables, variable structure, or variable arrays) that will be output within the relevant stream.</p>"},{"location":"MPAS-Ocean/user-guide/#example-workflow-for-modifying-the-output-fields","title":"Example workflow for modifying the output fields","text":"<ul> <li>copy the <code>streams.ocean</code> file from the run directory to the <code>SourceMods</code> directory (see above)</li> <li>identify the variable name for the variable of interest. You can find the variable name by searching the ocean Registry.xml (in the <code>src</code> directory) or Registry_package.xml in the <code>tracer</code> and <code>analysis_member</code> sub-directories. Note whether the variable of interest is included within a <code>var_array</code> or a <code>var_struct</code>.</li> <li>identify the output stream of interest (e.g. monthly averages, high frequency, others). You can search for a stream name, known output filename, or output interval.</li> <li>check whether the variable of interest is included in the <code>streams.ocean</code> file. Search for the <code>var name</code>, or the <code>var_array</code> and <code>var_struct</code> if applicable. If it is, copy the variable line from other streams into the stream of interest. If it is not included, copy it from the Registry.xml.</li> <li>check whether the relevant stream is turned on. This includes checking that <code>output_interval</code> in the stream header is not <code>None</code>.</li> <li>make further modifications: e.g. you can modify the <code>output_interval</code> for the high-frequency stream. If you are turning on a new stream, remove unnecessary variables from the stream.</li> </ul>"},{"location":"MPAS-Ocean/user-guide/#excerpts-from-a-streamsocean-file","title":"Excerpts from a <code>streams.ocean</code> file","text":"<pre><code>&lt;stream name=\"timeSeriesStatsMonthlyOutput\"\n        type=\"output\"\n        precision=\"single\"\n        io_type=\"pnetcdf\"\n        useMissingValMask=\"true\"\n        filename_template=\"GMPAS-JRA.TL319_IcoswISC30E3r5.anvil.mpaso.hist.am.timeSeriesStatsMonthly.$Y-$M-$D.nc\"\n        filename_interval=\"00-01-00_00:00:00\"\n        reference_time=\"01-01-01_00:00:00\"\n        output_interval=\"00-01-00_00:00:00\"\n        clobber_mode=\"truncate\"\n        packages=\"timeSeriesStatsMonthlyAMPKG\"\n        runtime_format=\"single_file\"&gt;\n\n    &lt;var name=\"daysSinceStartOfSim\"/&gt;\n    &lt;var name=\"binBoundaryMerHeatTrans\"/&gt;\n    &lt;var name=\"binBoundaryZonalMean\"/&gt;\n    &lt;var name=\"ssh\"/&gt;\n    &lt;var_struct name=\"tracers\"/&gt;\n    &lt;var name=\"velocityMeridional\"/&gt;\n    &lt;var name=\"velocityZonal\"/&gt;\n    &lt;var name=\"layerThickness\"/&gt;\n...\n&lt;/stream&gt;\n</code></pre> <pre><code>&lt;stream name=\"highFrequencyOutput\"\n        type=\"output\"\n        precision=\"single\"\n        io_type=\"pnetcdf\"\n        filename_template=\"GMPAS-JRA.TL319_IcoswISC30E3r5.anvil.mpaso.highFrequencyOutput.$Y-$M-$D_$h.$m.$s.nc\"\n        filename_interval=\"00-01-00_00:00:00\"\n        reference_time=\"01-01-01_00:00:00\"\n        output_interval=\"00-00-05_00:00:00\"\n        clobber_mode=\"truncate\"\n        packages=\"highFrequencyOutputAMPKG\"&gt;\n\n    &lt;var name=\"xtime\"/&gt;\n    &lt;var name=\"daysSinceStartOfSim\"/&gt;\n    &lt;var_array name=\"activeTracersAtSurface\"/&gt;\n    &lt;var_array name=\"activeTracersAt250m\"/&gt;\n    &lt;var_array name=\"activeTracersAtBottom\"/&gt;\n    &lt;var name=\"kineticEnergyAtSurface\"/&gt;\n    &lt;var name=\"kineticEnergyAt250m\"/&gt;\n    &lt;var name=\"relativeVorticityAt250m\"/&gt;\n    &lt;var name=\"ssh\"/&gt;\n    &lt;var name=\"pressureAdjustedSSH\"/&gt;\n    &lt;var name=\"boundaryLayerDepth\"/&gt;\n    &lt;var name=\"dThreshMLD\"/&gt;\n    &lt;var name=\"tThreshMLD\"/&gt;\n    &lt;var name=\"columnIntegratedSpeed\"/&gt;\n    &lt;var name=\"barotropicSpeed\"/&gt;\n    &lt;var name=\"landIceFreshwaterFlux\"/&gt;\n    &lt;var name=\"pressureAdjustedSSH\"/&gt;\n    &lt;var name=\"atmosphericPressure\"/&gt;\n&lt;/stream&gt;\n</code></pre> <p>A more comprehensive description of the streams options can be found in Chapter 6 of the MPAS-Ocean User's Guide.</p>"},{"location":"MPAS-seaice/","title":"The E3SM Sea Ice Model (MPAS-seaice)","text":"<p>MPAS-seaice is an unstructured-mesh sea-ice model that uses the Modeling for Prediction Across Scales (MPAS) framework, allowing enhanced horizontal resolution in regions of interest. MPAS-seaice incorporates many of the methods used in the Los Alamos CICE sea-ice model, but adapted to the Spherical Centroidal Vornoi Tesselation (SCVT) meshes used by the MPAS framework.</p> <ul> <li>The MPAS-seaice User's Guide outlines the MPAS Framework, on which MPAS-seaice is built, and Icepack, the column physics submodule in MPAS-seaice, and it provides guidance for controlling MPAS-seaice within E3SM.</li> <li>The MPAS-seaice Technical Guide describes the mesh and major physics components underlying MPAS-seaice code and its coupling to E3SM.</li> <li>The MPAS-seaice Developer's Guide provides additional information relevant for model development, including the Icepack interface and development/testing scripts.</li> </ul>"},{"location":"MPAS-seaice/#icepack","title":"Icepack","text":"<p>MPAS-seaice incorporates the Icepack software package for sea ice column physics, developed by the CICE Consortium, as a submodule. Icepack documentation. provides a complete description of the column physics and instructions for using Icepack as a standalone model. The source code for this documentation is maintained in E3SM's Icepack fork (navigate to the desired branch, then to doc/source/, etc).  This is the documentation associated with the latest Icepack version that has been merged into E3SM, plus any documentation changes made within E3SM itself. This documentation is fully rendered in E3SM's Icepack readthedocs.</p> <p>Guidance for developing Icepack documentation includes instructions for building the readthedocs documentation yourself.</p>"},{"location":"MPAS-seaice/#mpas-seaice-code-structure","title":"MPAS-seaice code structure","text":"<p>Some MPAS-seaice functionality is sourced from the MPAS Framework: <code>E3SM/components/mpas-framework</code>.  In particular, see <code>E3SM/components/mpas-framework/core_seaice</code>.</p> <p>Code structure within the <code>mpas-seaice/</code>component-level directory:</p> Directories Function <code>bld</code> namelist configuration files <code>cime_config</code> build and configuration scripts <code>docs</code> this documentation <code>driver</code> coupling modules <code>src</code> source code for the model physics and output <code>src/analysis_members</code> source code for model output <code>src/column</code> source code for the (original) <code>column_package</code> <code>src/icepack</code> link to the icepack submodule <code>src/model_forward</code> top-level mpas-seaice modules <code>src/shared</code> dynamics and general-purpose modules (e.g. mesh, constants) <code>testing</code> testing scripts"},{"location":"MPAS-seaice/references/","title":"References","text":"<p>Bitz, C. M., and W. H. Lipscomb (1999). An energy-conserving thermodynamic model of sea ice, Journal of Geophysical Research: Oceans, 104(C7), 15,669\u201315,677, doi: 10.1029/1999JC900100.</p> <p>Briegleb, B. P., and B. Light (2007). A Delta-Eddington multiple scattering parameterization for solar radiation in the sea ice component of the Community Climate Sys- tem Model, Tech. Rep. NCAR/TN-472+STR, National Center for Atmospheric Research, Boulder, Colorado USA.</p> <p>Dang, C., C. S. Zender, and M. G. Flanner (2019). Intercomparison and improvement of two-stream shortwave radiative transfer schemes in earth system models for a unified treatment of cryospheric surfaces. The Cryosphere, 13:2325\u20132343. doi:10.5194/tc-13-2325-2019.</p> <p>Dasgupta, G. (2003). Interpolants within convex polygons: Wachpress' shape functions. Journal of Aerospace Engineering, 16, 1\u20138. https://doi.org/10.1061/(ASCE)0893-1321(2003)16:1(1)</p> <p>Dukowicz, J. K., &amp; Baumgardner, J. R. (2000). Incremental remapping as a transport/advection algorithm. Journal of Computational Physics, 160(1), 318\u2013335. https://doi.org/10.1006/jcph.2000.6465</p> <p>Dunavant, D. A. (1985). High degree efficient symmetrical Gaussian quadrature rules for the triangle. International Journal for Numerical Methods in Engineering, 21(6), 1129\u20131148. https://doi.org/10.1002/nme.1620210612</p> <p>Flocco, D., D. L. Feltham, and A. K. Turner (2010). Incorporation of a physically based melt pond scheme into the sea ice component of a climate model, Journal of Geophysi- cal Research: Oceans, 115(C8), doi:10.1029/2009JC005568, C08012.</p> <p>Golaz, J.-C., Caldwell, P. M.,\u2028Van Roekel, L. P., Petersen, M. R., Tang, Q., Wolfe, J. D., et al. (2019). The DOE E3SM coupled model version 1: Overview and evaluation at\u2028standard resolution. Journal of Advances in Modeling Earth\u2028Systems, 11, 2089\u20132129. https://doi.org/10.1029/2018MS001603</p> <p>Golaz, J.-C., Van Roekel, L. P., Zheng, X., Roberts, A. F., Wolfe, J. D., Lin, W., et al. (2022). The DOE E3SM Model version 2: Overview of the physical model and initial model evaluation. Journal of Advances in Modeling Earth Systems, 14, e2022MS003156. https://doi.org/10.1029/2022MS003156</p> <p>Hibler, W. D. III (1979). A dynamic thermodynamic sea ice model. Journal of Physical Oceanography, 9(4), 815\u2013846. https://doi.org/10.1175/1520-0485(1979)009&lt;0815:ADTSIM&gt;2.0.CO;2</p> <p>Holland, M. M., D. A. Bailey, B. P. Briegleb, B. Light, and E. Hunke (2012). Improved sea ice shortwave radiation physics in CCSM4: The impact of melt ponds and aerosols on arctic sea ice, Journal of Climate, 25(5), 1413\u20131430, doi:10.1175/JCLI-D-11-00078.1.</p> <p>Hunke, E., et al. (2018). CICE-Consortium/Icepack. Zenodo. https://doi.org/10.5281/zenodo.1213462</p> <p>Hunke, E. C., &amp; Dukowicz, J. K. (1997). An elastic-viscous-plastic model for sea ice dynamics. Journal of Physical Oceanography, 27(9), 1849\u20131867. https://doi.org/10.1175/1520-0485(1997)027&lt;1849:AEVPMF&gt;2.0.CO;2</p> <p>Hunke, E. C., &amp; Dukowicz, J. K. (2002). The elastic-viscous-plastic sea ice dynamics model in general orthogonal curvilinear coordinates on a sphere\u2014Incorporation of metric terms. Monthly Weather Review, 130(7), 1848\u20131865.</p> <p>Hunke, E. C., Hebert, D. A., &amp; Lecomte, O. (2013). Level-ice melt ponds in the Los Alamos sea ice model, CICE. Ocean Modelling, 71, 26\u201342. https://doi.org/10.1016/j.ocemod.2012.11.008</p> <p>Lipscomb, W. H. (2001). Remapping the thickness distribution in sea ice models, Journal of Geophysical Research: Oceans, 106(C7), 13,989\u201314,000, doi:10.1029/2000JC000518.</p> <p>Lipscomb, W. H., &amp; Hunke, E. C. (2004). Modeling sea ice transport using incremental remapping. Monthly Weather Review, 132(6), 1341\u20131354.</p> <p>Lipscomb, W. H., Hunke, E. C., Maslowski, W., &amp; Jakacki, J. (2007). Ridging, strength, and stability in high-resolution sea ice models. Journal of Geophysical Research, 112. C03S91. https://doi.org/10.1029/2005JC003355</p> <p>Lipscomb, W. H., &amp; Ringler, T. D. (2005). An incremental remapping transport scheme on a spherical geodesic grid. Monthly Weather Review, 133(8), 2335\u20132350. https://doi.org/10.1175/MWR2983.1</p> <p>Turner, A. K., and E. C. Hunke (2015). Impacts of a mushy-layer thermodynamic ap- proach in global sea-ice simulations using the CICE sea-ice model, Journal of Geophys- ical Research: Oceans, 120(2), 1253\u20131275, doi:10.1002/2014JC010358.</p> <p>Turner, A. K., E. C. Hunke, and C. M. Bitz (2013). Two modes of sea-ice gravity drainage: A parameterization for large-scale modeling, Journal of Geophysical Research: Oceans, 118(5), 2279\u20132294, doi:10.1002/jgrc.20171.</p> <p>Turner, A. K., Lipscomb, W. H., Hunke, E. C., Jacobsen, D. W., Jeffery, N., Engwirda, D., Ringer, T. D., Wolfe, J. D. (2021). MPAS-seaice (v1.0.0): Sea-ice dynamics on unstructured Voronoi meshes. Geoscientific Model Development Discussions, 1\u201346. https://doi.org/10.5194/gmd-2021-355</p>"},{"location":"MPAS-seaice/dev-guide/","title":"Developer's Guide","text":"<p>Development of the MPAS-seaice component should follow the general procedures outlined by the E3SM project.</p> <p>Development Guide for E3SM Code Development Guide for E3SM Documentation</p>"},{"location":"MPAS-seaice/dev-guide/#configuration-controls","title":"Configuration Controls","text":"<p>MPAS-seaice is controlled using namelist options.  Namelist files for E3SM runs are found in <code>E3SM/components/mpas-seaice/bld/namelist_files/</code>.  However, the values in these files are drawn from the Registry, following the convention of all MPAS components. Registry files are used directly for stand-alone MPAS-seaice runs, and E3SM scripts pass information from them into E3SM's namelist files when a PR is merged.  E3SM's namelist files need to be changed for development purposes.  It's easiest to change all of them when needed, to keep them consistent, taking care not to unintentionally change standalone MPAS-seaice configurations.</p>"},{"location":"MPAS-seaice/dev-guide/#mpas-framework","title":"MPAS Framework","text":"<p>MPAS-seaice is built on the MPAS Framework.</p> <p>The MPAS Framework provides the foundation for a generalized geophysical fluid dynamics model on unstructured spherical and planar meshes. On top of the framework, implementations specific to the modeling of a particular physical system (e.g., sea ice, ocean) are created as MPAS cores. The MPAS design philosophy is to leverage the efforts of developers from the various MPAS cores to provide common framework functionality with minimal effort, allowing MPAS core developers to focus on development of the physics and features relevant to their application.</p> <p>The framework code includes shared modules for fundamental model operation. Significant capabilities include:</p> <ul> <li>Description of model data types. MPAS uses a handful of fundamental Fortran derived types for basic model functionality. Core-specific model variables are handled through custom groupings of model fields called pools, for which custom access routines exist. Core-specific variables are defined in XML syntax in a Registry, and the framework parses the Registry, defines variables, and allocates memory as needed.</li> <li>Mesh specification. MPAS requires 36 fields to fully describe the mesh used in a simulation. These include the position, area, orientation, and connectivity of all cells, edges, and vertices in the mesh. The mesh specification can flexibly describe both spherical and planar meshes. For more information about the meshes, see the Users Guide.</li> <li>Distributed memory parallelization and domain decomposition. The MPAS Framework provides needed routines for exchanging information between processors in a parallel environment using Message Passing Interface (MPI). This includes halo updates, global reductions, and global broadcasts. MPAS also supports decomposing multiple domain blocks on each processor to optimize model performance by minimizing transfer of data from disk to memory. Shared memory parallelization through OpenMP is also supported, but the implementation is left up to each core.</li> <li>Parallel input and output capabilities. MPAS performs parallel input and output of data from and to disk through the commonly used libraries of NetCDF, Parallel NetCDF (pnetcdf), and Parallel Input/Output (PIO). The Registry definitions control which fields can be input and/or output, and a framework \"streams\" functionality provides run-time configuration of what fields are to be written to what file name and at what frequency through an XML streams file. The MPAS framework includes additional functionality specific to providing a flexible model restart capability.</li> <li>Advanced timekeeping. MPAS uses a customized version of the timekeeping functionality of the Earth System Modeling Framework (ESMF), which includes a robust set of time and calendar tools used by many Earth System Models (ESMs). This allows explicit definition of model epochs in terms of years, months, days, hours, minutes, seconds, and fractional seconds and can be set to three different calendar types: Gregorian, Gregorian no leap, and 360 day. This flexibility helps enable multi-scale physics and simplifies coupling to ESMs. To manage the complex date/time types that ensue, MPAS framework provides routines for arithmetic of time intervals and the definition of alarm objects for handling events (e.g., when to write output, when the simulation should end).</li> <li>Run-time configurable control of model options. Model options are configured through namelist files that use standard Fortran namelist file format, and input/output are configured through streams files that use XML format. Both are completely adjustable at run time.</li> <li>Online, run-time analysis framework. A system for defining analysis of model states during run time, reducing the need for post-processing and model output.</li> </ul> <p>Additionally, a number of shared operators exist to perform common operations on model data. These include geometric operations (e.g., length, area, and angle operations on the sphere or the plane), interpolation (linear, barycentric, Wachspress, radial basis functions, spline), vector and tensor operations (e.g., cross products, divergence), and vector reconstruction (e.g., interpolating from cell edges to cell centers). Most operators work on both spherical and planar meshes.</p>"},{"location":"MPAS-seaice/dev-guide/#coupling-of-mpas-seaice-within-e3sm","title":"Coupling of MPAS-seaice within E3SM","text":"<p>Several files within MPAS-SI control the coupling of fields between MPAS-SI and other E3SM components via the coupler. A list of all variables being passed to and from MPAS-SI can be found in <code>components/mpas-seaice/driver/mpassi_cpl_indices.F</code>. Variables named with the prefix <code>x2i</code> are passed from the coupler to MPAS-SI, variables with the prefix <code>i2x</code> are passed from MPAS-SI to the coupler. For example, all coupled variables are named with the following convention: <code>index_i2x_Si_ithick</code> refers to a state variable of ice (<code>Si</code>) that gets passed from MPAS-SI to the coupler (<code>i2x</code>) for the ice thickness (<code>ithick</code>). <code>index_x2i_So_t</code> refers to an ocean state variable (<code>So</code>) passed from the the coupler to MPAS-SI (<code>x2i</code>) for ocean temperature (<code>t</code>).</p>"},{"location":"MPAS-seaice/dev-guide/#icepack","title":"Icepack","text":"<p>For changes to Icepack, please consult the CICE Consortium's recommendations for code contributions.</p> <p>To access the column physics in Icepack, MPAS-seaice uses methods defined in <code>icepack_intfc.F90</code>. The 'init' and 'query' methods are used to set and retrieve Icepack values. A 'write' method is also available for documenting these values. MPAS-seaice follows the 'icepack_warnings' methodology where <code>icepack_warnings_aborted</code> is checked and <code>icepack_warnings_flush</code> is called after every call to an Icepack method. It does not directly \u201cuse\u201d Icepack data, accessing Icepack data only through these interfaces.</p> <p>Basic Icepack development can be done in standalone mode using Icepack's testing scripts, directly in the submodule branch in MPAS-seaice. We recommend that Icepack developments be thoroughly tested within E3SM's coupled framework throughout the development process, including fully coupled simulations.</p>"},{"location":"MPAS-seaice/dev-guide/#e3sm-polar-developer-script","title":"E3SM-Polar-Developer Script","text":"<p>To accelerate early development stages, a script is available for configuring and testing MPAS-seaice (including the Icepack submodule) in D compsets, which have the sea ice component active and data models for the other components.</p>"},{"location":"MPAS-seaice/dev-guide/#view-helpful-information-including-default-values-for-duration-configuration-etc","title":"View helpful information, including default values for duration, configuration, etc","text":"<pre><code>git clone git@github.com:E3SM-Project/SimulationScripts.git\ncd SimulationScripts/archive/PolarGroup\n./E3SM-Polar-Developer.sh -h\n</code></pre> <p>For debugging E3SM, search the script for 'debug' and follow the instructions.</p> <p>The following examples describe how to use the script for development in Icepack.  Similar procedures could be used for any MPAS-SI physics development.</p>"},{"location":"MPAS-seaice/dev-guide/#set-up-and-run-baselines","title":"Set up and run baselines","text":"<p>Create a file containing modified namelist options. The file <code>nset01.nlk</code> in this example creates baselines for two types of column physics and turns off the <code>snicar_ad</code> radiation scheme.</p> <pre><code>$ less nset01.nlk\n[mpassi]\nconfig_column_physics_type = {'column_package','icepack'}\nconfig_use_snicar_ad = {.false.}\n</code></pre> <p>Notes:</p> <ul> <li>A .nlk file without any config settings will create a baseline using default settings.</li> <li>The <code>column_package</code> option is still available but is no longer being supported in MPAS-seaice.</li> </ul> <p>Fetch E3SM (choose any name for the directory baselines01):</p> <pre><code>./E3SM-Polar-Developer.sh -s baselines01 -f git@github.com:E3SM-Project/E3SM\n</code></pre> <p>Set up a new case and build it:</p> <pre><code>./E3SM-Polar-Developer.sh -s baselines01 -k nset01.nlk -e -n -b\n</code></pre> <p>Submit:</p> <pre><code>./E3SM-Polar-Developer.sh -s baselines01 -k nset01.nlk -e -q\n</code></pre> <p>Examine the diagnostic output (compares the icepack run with the column_package run in this example):</p> <pre><code>./E3SM-Polar-Developer.sh -s baselines01 -k nset01.nlk -e -a -v\n</code></pre>"},{"location":"MPAS-seaice/dev-guide/#set-up-a-sandbox-for-model-development-to-be-compared-with-the-baselines","title":"Set up a sandbox for model development, to be compared with the baselines","text":"<p>Fetch E3SM (choose any name for the directory newdev01):</p> <pre><code>./E3SM-Polar-Developer.sh -s newdev01 -f git@github.com:E3SM-Project/E3SM\n</code></pre> <p>Create a new development branch:</p> <pre><code>cd ~/E3SM-Polar/code/newdev01\ngit branch newbranch\ngit checkout newbranch\n</code></pre> <p>Set up a new case and build it:</p> <pre><code>./E3SM-Polar-Developer.sh -s newdev01 -k nset01.nlk -e -n -b\n</code></pre> <p>Develop and test... Build/compile:</p> <pre><code>./E3SM-Polar-Developer.sh -s newdev01 -k nset01.nlk -e -b\n</code></pre> <p>Submit:</p> <pre><code>./E3SM-Polar-Developer.sh -s newdev01 -k nset01.nlk -e -q\n</code></pre> <p>Examine the diagnostic output:</p> <pre><code>./E3SM-Polar-Developer.sh -s newdev01 -k nset01.nlk -e -a -v\n</code></pre> <p>Compare with the baselines case directory (use your D3 baselines directory):</p> <pre><code>./E3SM-Polar-Developer.sh -s newdev01 -k nset01.nlk -a D3.nset01.baselines01.master.E3SM-Project.anvil -v\n</code></pre>"},{"location":"MPAS-seaice/dev-guide/#make-changes-in-icepack-and-pr-to-the-consortium","title":"Make changes in Icepack and PR to the Consortium","text":"<p>We recommend PR\u2019ing Icepack changes first to the Consortium then to E3SM\u2019s icepack fork, in order to keep the repositories in sync and to ensure the changes are robust outside of E3SM.  Some changes to Icepack require extensive changes to the driver code (e.g. MPAS-seaice or CICE), making this process challenging.  Contact the CICE Consortium to discuss and identify a collaborative path forward.</p> <p>First, create a baseline (standalone) Icepack test suite using the E3SM icepack fork or, if the Consortium code is different, using Consortium icepack main (see Consortium documentation.)</p> <p>Similarly test your branch of Icepack within E3SM and compare with the baseline. When satisfied with E3SM testing, PR to Consortium icepack main:</p> <pre><code>git remote add consortium git@github.com:cice-consortium/icepack.git\ngit pull consortium main\n</code></pre> <p>Fix conflicts if needed, then</p> <pre><code>git add ...\ngit commit -m \"update from cice-consortium main\"\n</code></pre> <p>Continue testing. When satisfied,</p> <pre><code>git push origin branch\n</code></pre> <p>Create a PR from branch to cice-consortium/icepack -b main.</p> <p>Once the PR has been tested and merged into the main Icepack codebase, a new PR is submitted to E3SM.</p> <p>More extensive documentation of this workflow tool used for the Icepack merge project is available here.</p>"},{"location":"MPAS-seaice/dev-guide/#cice-qc-quality-control-testing","title":"CICE-QC Quality Control Testing","text":"<p>Example to run a CICE-QC comparison between two E3SM simulations with changes to the sea ice component.</p>"},{"location":"MPAS-seaice/dev-guide/#set-up-and-run-simulations-to-be-compared","title":"Set up and run simulations to be compared","text":"<pre><code>cd ~/SimulationScripts/archive/PolarGroup/\n</code></pre> <p>Create a <code>.nlk</code> file with namelist changes to include the thickness analysis member. Include changes to namelist values needed in both the baseline and the test here, if desired (append the last 3 lines here to the end of your standard D-case test .nlk).</p> <pre><code>$ less qcbase.nlk\n[mpassi]\nconfig_AM_thicknesses_enable = {.true.}\nconfig_AM_thicknesses_compute_on_startup = {.true.}\nconfig_AM_thicknesses_write_on_startup = {.true.}\n</code></pre> <p>Use test script to clone E3SM, and create a sandbox</p> <pre><code>./E3SM-Polar-Developer.sh -s qcbaseline -f git@github.com:E3SM-Project/E3SM\n</code></pre> <p>Edit <code>~/E3SM-Polar/code/qcbaseline/components/mpas-seaice/cime_config/buildnml</code> to change:</p> <pre><code>lines.append('        output_interval=\"none\"&gt;')\n</code></pre> <p>to</p> <pre><code>lines.append('        output_interval=\"00-00-01_00:00:00\"&gt;')\n</code></pre> <p>for <code>stream name=\u201coutput\u201d</code> and add</p> <pre><code>lines.append('    &lt;var name=\"iceThicknessCell\"/&gt;')\n</code></pre> <p>a few lines below that:</p> <pre><code>            lines.append('&lt;stream name=\"output\"')\n            lines.append('        type=\"output\"')\n            lines.append('        io_type=\"{}\"'.format(ice_pio_typename))\n            lines.append('        filename_template=\"{}.mpassi{}.hist.$Y-$M-$D_$\nS.nc\"'.format(casename, inst_string))\n            lines.append('        filename_interval=\"00-01-00_00:00:00\"')\n            lines.append('        clobber_mode=\"truncate\"')\n            lines.append('        reference_time=\"01-01-01_00:00:00\"')\n-           lines.append('        output_interval=\"none\"&gt;')\n+           lines.append('        output_interval=\"00-00-01_00:00:00\"&gt;')\n            lines.append('')\n            lines.append('    &lt;stream name=\"mesh\"/&gt;')\n            lines.append('    &lt;var name=\"xtime\"/&gt;')\n            lines.append('    &lt;var name=\"daysSinceStartOfSim\"/&gt;')\n            lines.append('    &lt;var name=\"iceAreaCell\"/&gt;')\n            lines.append('    &lt;var name=\"iceVolumeCell\"/&gt;')\n            lines.append('    &lt;var name=\"snowVolumeCell\"/&gt;')\n+           lines.append('    &lt;var name=\"iceThicknessCell\"/&gt;')\n            lines.append('    &lt;var name=\"uVelocityGeo\"/&gt;')\n            lines.append('    &lt;var name=\"vVelocityGeo\"/&gt;')\n            lines.append('')\n            lines.append('&lt;/stream&gt;')\n</code></pre> <p>Build and run baseline case for 5 years (60 months):</p> <pre><code>./E3SM-Polar-Developer.sh -s qcbaseline -k qcbase.nlk -e -d60 -nb\n./E3SM-Polar-Developer.sh -s qcbaseline -k qcbase.nlk -e -d60 -q\n</code></pre> <p>Copy the thickness analysis member changes into your development directory:</p> <pre><code>cd ~/E3SM-Polar/code/newdev01/components/mpas-seaice/cime_config/\ncp ~/E3SM-Polar/code/qcbaseline/components/mpas-seaice/cime_config/buildnml .\n</code></pre> <p>If your development case adds namelist parameters, add the thickness analysis member to your .nlk file as above. This example uses the default configuration.</p> <p>Build and run the development case:</p> <pre><code>cd ~/SimulationScripts/archive/PolarGroup/\n./E3SM-Polar-Developer.sh -s newdev01 -k qcbase.nlk -e -d60 -nb\n./E3SM-Polar-Developer.sh -s newdev01 -k qcbase.nlk -e -d60 -q\n</code></pre>"},{"location":"MPAS-seaice/dev-guide/#run-qc-comparison","title":"Run QC comparison","text":"<pre><code>cd ~/E3SM-Polar/code/newdev01/components/mpas-seaice/testing/cice-qc\n</code></pre> <p>See README.md.  This example is for anvil.</p> <p>Edit <code>job_script.cice-qc.anvil</code> to export (insert your username)</p> <pre><code>BASE = /lcrc/group/e3sm/[username]/E3SM-Polar/D12.qcbase.emc.qcbaseline.master.E3SM-Project.anvil/run.k000/\nTEST = /lcrc/group/e3sm/[username]/E3SM-Polar/D12.qcbase.emc.newdev01.branch.E3SM-Project.anvil/run.k000\n</code></pre> <p>Submit QC test. Test results will be in the file <code>qc_log.txt</code>.</p> <pre><code>sbatch job_script.qc-testing-mpassi.anvil\nless qc_log.txt\n</code></pre> <p>Example of desired result:</p> <pre><code>Running QC test on the following directories:\n  /lcrc/group/e3sm/ac.eclare/E3SM-Polar/D12.qcbase.emc.qcbaseline.master.E3SM-Project.anvil/run.k000/\n  /lcrc/group/e3sm/ac.eclare/E3SM-Polar/D12.qcbase.emc.newdev01.branch.E3SM-Project.anvil/run.k000\nNumber of files: 61\n2 Stage Test Passed\nQuadratic Skill Test Passed for Northern Hemisphere\nQuadratic Skill Test Passed for Southern Hemisphere\n</code></pre>"},{"location":"MPAS-seaice/dev-guide/#generate-statistics-from-the-cice-qc-runs","title":"Generate statistics from the CICE-QC runs","text":"<p>This only works if the .nlk filename is the same for both cases.  If comparing only namelist changes within MPAS-seaice, use the <code>./E3SM-Polar-Developer.sh</code> script with a single .nlk file that includes each option.</p> <pre><code>cd ~/SimulationScripts/archive/PolarGroup/\n$ ./E3SM-Polar-Developer.sh -s qcbaseline -k qcbase.nlk -e -d60 -a D12.qcbase.emc.newdev01.branch.E3SM-Project.anvil -v\n</code></pre>"},{"location":"MPAS-seaice/dev-guide/#create-comparison-plots","title":"Create comparison plots","text":"<p>To generate MPAS-Analysis plots from the CICE-QC runs and compare:</p> <p>Copy the scripts in the file MPAS-Analysis_scripts.zip to anvil or chrysalis.</p> <p>Edit each script for your run names, directories, etc (search for 'echmod' to find settings used for a QC comparison)</p> <p>Edit and submit (on chrysalis) the job script 3 times, once for icepack, once for column, and finally for the comparison.</p> <p>Browse the html output by navigating to the location indicated by <code>htmlSubdirectory</code> in the comparison script, e.g. <code>https://web.lcrc.anl.gov/public/e3sm/diagnostic_output/ac.eclare/icepack-testing/D12.qcPR19.emc.qcPR19.snicar_active.eclare108213.anvil/mpas_analysis_output/</code></p>"},{"location":"MPAS-seaice/tech-guide/","title":"Technical Guide","text":""},{"location":"MPAS-seaice/tech-guide/#primary-documentation-for-mpas-seaice","title":"Primary documentation for MPAS-seaice","text":"<p>See complete citations in References.</p> <p>E3SM v1 Overview: Golaz et al., JAMES 2019</p> <p>MPAS-seaice v1: Turner et al., GMD Discussions, 2021.</p> <p>E3SM v2 Overview: Golaz et al., JAMES 2022</p> <p>Icepack: Full documentation for E3SM's version of Icepack can be found in E3SM's Icepack readthedocs.  The most up-to-date documentation from the CICE Consortium's main Icepack repository is here.</p> <p>A comprehensive paper describing MPAS-seaice is in preparation.</p>"},{"location":"MPAS-seaice/tech-guide/#meshes","title":"Meshes","text":"<p>MPAS-Seaice is the sea ice component of E3SMv1. MPAS-Seaice and MPAS-Ocean share identical meshes, but MPAS-Seaice uses B-grid discretizations (Arakawa &amp; Lamb, 1977) with sea ice concentration, volume, and tracers defined at cell centers and velocity defined at cell vertices.</p> <p>The MPAS mesh system requires the definition of seven elements.  These seven elements are composed of two types of cells, two types of lines, and three types of points.  These elements can be defined on either the plane or the surface of the sphere.  The two types of cells form two meshes, a primal mesh composed of Voronoi regions and a dual mesh composed of Delaunay triangles.  Each corner of a primal mesh cell is uniquely associated with the \"center\" of a dual mesh cell and vice versa. The boundary of a given primal mesh cell is composed of the set of lines that connect the centers of the dual mesh cells.  Similarly, the boundary of a given dual mesh cell is composed of the set of lines that connect the center points of the associated primal mesh cells. A line segment that connects two primal mesh cell centers is uniquely associated with a line seqment that connects two dual mesh cell centers.  We assume that these two line seqments cross and are orthogonal.  Since the two line seqments crossing are othogonal, they form a convenient local coordinate system for each edge.  Figure: Sample from an MPAS mesh showing the primal mesh (solid lines), the dual mesh (dashed), and velocity components aligned with a locally Cartesian coordinate system (east/north).</p>"},{"location":"MPAS-seaice/tech-guide/#velocity-and-stresses","title":"Velocity and Stresses","text":"<p>Velocity components at cell vertices are not aligned with the mesh, as in sea ice models with structured meshes and quadrilateral cells. Instead, the velocity components are aligned with a spherical coordinate system that is locally Cartesian, eastwards (u) and northwards (v), irrespective of the orientation of edges joining that vertex. Such a definition, however, would result in a convergence of v components at the geographic North Pole and strong metric terms in the velocity solution. Consequently, in addition, these definitions of u and v are rotated so that their pole lies on the geographical equator at 0 deg longitude.</p> <p>Velocities are determined by solving the sea ice momentum equation (Hibler, 1979; Hunke &amp; Dukowicz, 1997). During coupled simulations the ocean model provides the ocean surface tilt term; the only other term that depends on the properties of the horizontal grid is the divergence of internal stress.  Therefore only this stress term must be adapted for use on MPAS meshes.  Otherwise the velocity solver is identical to that in CICE\u2019s standard EVP approach. Determination of the divergence of the internal stress can be broken down into three stages:</p> <ol> <li> <p>The strain rate tensor is determined from the velocity field.</p> </li> <li> <p>The stress tensor at a point is determined, through a constitutive relation, from the strain rate tensor at that point.</p> </li> <li> <p>The divergence of this stress tensor is calculated.</p> </li> </ol> <p>Two schemes to calculate the strain rate tensor and the divergence of internal stress on MPAS meshes are implemented in MPAS-Seaice, a variational scheme based on that used in CICE (Hunke and Dukowicz, 2002), and a weak scheme that uses the line integral forms of the symmetric gradient and divergence operators. The variational scheme is based on the fact that over the entire domain, \u03a9, and ignoring boundary effects, the total work done by the internal stress is equal to the dissipation of mechanical energy. Instead of the bilinear basis functions used by CICE, MPAS-Seaice uses Wachspress basis functions (Dasgupta, 2003), which are integrated with the quadrature rules of Dunavant (1985).</p>"},{"location":"MPAS-seaice/tech-guide/#horizontal-transport-of-ice-area-fraction-and-tracers","title":"Horizontal Transport of Ice Area Fraction and Tracers","text":"<p>Horizontal transport of ice concentration, volume, and tracers is achieved with an incremental remapping (IR) scheme similar to that described in Dukowicz and Baumgardner (2000), Lipscomb and Hunke (2004), and Lipscomb and Ringler (2005).  For MPAS-Seaice the IR scheme was generalized to work on either the standard MPAS mesh (hexagons and other n-gons of varying sizes, with a vertex degree of 3, or a quadrilateral mesh with a vertex degree of 4 as in CICE. Since MPAS meshes are unstructured, the IR scheme had to be rewritten from scratch. Most of the code is mesh-agnostic, but a small amount of code is specific to quad meshes. The transport equations describe conservation of quantities such as volume and energy.  Fractional ice area (also known as sea ice concentration) is a mass-like quantity whose transport equation forms the basis for all other transported quantities in the model.  In particular, ice volume is the product of ice area and thickness; therefore thickness is treated as a tracer on ice area, transported with the continuity equation for conservation of volume. Likewise, snow depth is carried as a tracer on ice area via a conservation of snow volume equation.  Ice thickness and snow depth are referred to as \u201ctype 1\u201d tracers (carried directly on ice area). Ice and snow enthalpy in each vertical layer are type 2 tracers, carried on ice and snow volume. When run with advanced options (e.g., active melt ponds and biogeochemistry), MPAS-Seaice advects tracers up to type 3. Thus, the mass-like field (area) is the \u201cparent field\u201d for type 1 tracers; type 1 tracers are parents of type 2; and type 2 tracers are parents of type 3.  Sources and sinks of mass and tracers (e.g., ice growth and melting) are treated separately from transport.</p> <p>The transport time step is limited by the requirement that trajectories projected backward from vertices are confined to the cells sharing the vertex (i.e., 3 cells for the standard MPAS mesh and 4 for the quad mesh). This is what is meant by incremental as opposed to general remapping. For highly divergent velocity fields, the maximum time step may have to be reduced by a factor of 2 to ensure that trajectories do not cross. The incremental remapping algorithm consists of the following steps:</p> <ol> <li>Given mean values of the ice area and tracer fields in each grid cell and thickness category, construct linear approximations of these fields. Limit the field gradients to preserve mono- tonicity.</li> <li>Given ice velocities at grid cell vertices, identify departure regions for the transport across each cell edge. Divide these departure regions into triangles and compute the coordinates of the triangle vertices.</li> <li>Integrate the area and tracer fields over the departure triangles to obtain the area, volume, and other conserved quantities transported across each cell edge.</li> <li>Given these transports, update the area and tracers.</li> </ol> <p>Since all fields are transported by the same velocity field, the second step is done only once per time step. The other steps are repeated for each field.</p> <p>With advanced physics and biogeochemistry (BGC) options, MPAS-Seaice can be configured to include numerous tracer fields, each of which is advected in every thickness category, and many of which are defined in each vertical ice or snow layer. In order to accommodate different tracer combinations and make it easy to add new tracers, the tracer fields are organized in a linked list that depends on which physics and BGC packages are active. The list is arranged with fractional ice area first, followed by the type 1 tracers, type 2 tracers, and finally type 3 tracers. In this way, values computed for parent tracers are always available when needed for computations involving child tracers.</p>"},{"location":"MPAS-seaice/tech-guide/#column-physics","title":"Column Physics","text":"<p>The Icepack software has replaced the original <code>colpkg</code> column physics code in MPAS-seaice. The <code>config_column_physics_type = 'column_package'</code> option is still available but is no longer being supported in MPAS-seaice.</p> <p>Because of the strong thermal gradients between the (cold) atmosphere and (relatively warm) oceans in polar regions, a large portion of the physics in sea ice models can be described in a vertical column, without reference to neighboring grid cells. MPAS-Seaice shares the same column physics code as CICE through the Icepack library (Hunke et al., 2018), which is maintained by the CICE Consortium. This code includes several options for simulating sea ice thermodynamics, mechanical redistribution (ridging) and associated area and thickness changes. In addition, the model supports a number of tracers, including thickness, enthalpy, ice age, first-year ice area, deformed ice area and volume, melt ponds, snow properties and biogeochemistry.</p> <p>Icepack is implemented in MPAS-seaice as a git submodule. Icepack consists of three independent parts, the column physics code, the Icepack driver that supports stand-alone testing of the column physics code, and the Icepack scripts that build and test the Icepack model.  E3SM uses only the column physics code, which is called for each ocean grid cell.  Icepack\u2019s own driver and testing scripts are used when preparing new developments to be merged back to the CICE Consortium\u2019s Icepack repository.</p> <p>Icepack includes sophisticated vertical physics and biogeochemical schemes, which include vertical thermodynamics schemes (Bitz and Lipscomb, 1999; Turner et al., 2013; Turner and Hunke, 2015), melt-pond parameterizations (Flocco et al., 2010; Hunke et al., 2013), a delta-Eddington radiation scheme (Briegleb and Light, 2007; Holland et al., 2012a), schemes for transport in thickness space (Lipscomb, 2001), and representations of mechanical redistribution (Lipscomb et al., 2007).</p> <p>Full documentation for E3SM's version of Icepack can be found in E3SM's Icepack readthedocs.  The most up-to-date documentation from the CICE Consortium's main Icepack repository is here.</p>"},{"location":"MPAS-seaice/tech-guide/#thermodynamics","title":"Thermodynamics","text":"<p>In its default configuration, MPAS-Seaice uses the \u201cmushy layer\u201d vertical thermodynamics scheme of Turner et al. (2013) and Turner and Hunke (2015).  The mushy layer formulation describes the sea ice as a two-phase system of crystalline, fresh ice and liquid brine. Enthalpy depends on temperature and salinity, all of which are prognostic variables.  The mushy layer equations are derived from conservation of energy, conservation of salt, an ice-brine liquidus relation that determines the temperature- and salinity-dependent phase, and Darcy flow through a porous medium to describe the vertical movement of brine within the ice.  When or where the ice is cold, brine pockets are isolated from each other, but warmer temperatures cause the brine pockets to expand and connect into vertical channels in which meltwater, seawater, biology and nutrients may move through the ice.</p>"},{"location":"MPAS-seaice/tech-guide/#melt-ponds","title":"Melt Ponds","text":"<p>MPAS-seaice uses the level-ice melt pond scheme of Hunke et al. (2013). The ponds are carried as tracers on the level (undeformed) ice area of each thickness category, thus limiting their spatial extent based on the simulated sea ice topography. This limiting is meant to approximate the horizontal drainage of melt water into depressions in ice floes. The ponds evolve according to physically based process descriptions, assuming a thickness-area ratio for changes in pond volume. Melt pond processes include addition of liquid water from rain, melting snow and melting surface ice, drainage of pond water when its weight pushes the ice surface below sea level or when the ice interior becomes permeable, and refreezing of the pond water. If snow falls after a layer of ice has formed on the ponds, the snow may block sunlight from reaching the ponds below. When melt water forms with snow still on the ice, the water is assumed to infiltrate the snow. If there is enough water to fill the air spaces within the snowpack, then the pond becomes visible above the snow, thus decreasing the albedo and ultimately causing the snow to melt faster. The albedo also decreases as snow depth decreases, and thus a thin layer of snow remaining above a pond-saturated layer of snow will have a lower albedo than if the melt water were not present. Level-ice melt ponds are \u201cvirtual\u201d in the sense that rain and meltwater is sent to the ocean immediately, and the tracers are only used thereafter to adjust the radiative calculations as if the ponds were present.  The delta-Eddington radiative transfer scheme must be active for this purpose.</p>"},{"location":"MPAS-seaice/tech-guide/#radiation","title":"Radiation","text":"<p>The Delta-Eddington radiation scheme of Briegleb &amp; Light (2007) has been updated to the Dang et al. (2019) SNICAR-AD model, to ensure radiative consistency across all snow surfaces in E3SM, including on land, ice sheets and sea ice. The SNICAR-AD radiative transfer code includes five-band snow single-scattering properties, two-stream Delta-Eddington approximation with the adding\u2013doubling technique, and parameterization for correcting the near-infrared (NIR) snow albedo biases when solar zenith angle exceeds 75 degrees (Dang et al., 2019).</p>"},{"location":"MPAS-seaice/tech-guide/#snow","title":"Snow","text":"<p>A new snow-on-sea-ice morphology has been added to E3SMv2 that includes the effects of wind redistribution: losses to leads and meltponds, and the piling of snow against ridges. Snow grain radius, now a prognosed tracer field on sea ice, evolves according to temperature gradient and wet snow metamorphism and feeds back to the SNICAR-AD radiative model up to a dry maximum of 2800 \u03bcm. Fresh snow falls at a grain radius of 54.5 \u03bcm, and five vertical snow layers replace the previous single snow layer atop each of the five sea ice thickness categories retained from E3SMv1.</p> <p>A paper describing the advanced snow physics is in preparation.</p>"},{"location":"MPAS-seaice/tech-guide/#biogeochemistry","title":"Biogeochemistry","text":"<p>This section is under construction, pending the full merge of BGC codes in Icepack and the older column physics package.</p>"},{"location":"MPAS-seaice/tech-guide/#coupling-of-mpas-seaice-within-e3sm","title":"Coupling of MPAS-seaice within E3SM","text":"<p>This description is taken from the v1 overview paper (Golaz et al. 2019).  Refer to that paper for further information.  Coupling of the sea ice component to the ocean takes advantage of z star ocean coordinates and is a departure from the coupling of CICE and POP (Parallel Ocean Program) in CESM1. The weight of sea ice contributes to the ocean's barotropic mode, notably affecting the free surface over continental shelves. In shallow water depths at or less than the floating ice draft, the weight passed to the ocean model is limited to prevent evacuation of the underlying liquid column. When frazil ice forms in the ocean model, the volume of newly formed crystals is passed to the sea ice model with a fixed salinity of 4 PSU, rather than exchanging a freezing potential as in other models. Future versions of E3SM will permit progressive brine drainage to the ocean from the mushy layer physics used in MPAS-Seaice. For E3SMv1, brine drainage occurs internally in MPAS-Seaice for thermodynamic calculations, but for the sake of freshwater coupling, the ocean model only receives mass fluxes back from melted sea ice at the fixed salinity that it originally passed to its cryospheric counterpart (4 PSU). The ocean temperature immediately under the ice is the same as the liquid phase in the lowest layer of the sea ice model and is not fixed at \u22121.8 \u25e6C as is typical of previous generation coupled models. For the current version, we have addressed these long-standing ocean-ice coupling issues identified by the modeling community: explicit sea ice mass and salt exchange, a pressure force of the ice on the ocean, a basal sea ice temperature consistent with the ocean model's equation of state, and resolved inertial oscillations.</p> <p>This paragraph, taken from the v2 overview paper (Golaz et al. 2022), describes changes since v1.  The most significant improvement to the sea ice climate since E3SMv1 was achieved with coupling changes associated with mushy-layer thermodynamics. Whereas the basal temperature of the ice was held fixed at -1.8\u25e6C in E3SMv1, the new version of the model assumes the mushy liquidus basal temperature from the sea ice as described by Turner\u00a0&amp; Hunke (2015). Conversion of frazil ice from MPAS-Ocean with a fixed reference salinity of 4 PSU to the mushy layer now conserves to computational accuracy over a 500-year control integration. This was achieved by exchanging additional mass between the upper ocean and sea ice model to accommodate an assumed 25% mushy liquid content, assumed from heat and mass transferred adiabatically from the MPAS-Ocean frazil scheme active from a depth of 100 m. In addition to achieving perfect heat and mass conservation between sea ice and ocean models, this improvement greatly reduces a negative sea ice thickness bias in the summer Arctic reported by Golaz et al. (2019) for E3SMv1; it only minimally impacts Southern Ocean sea ice mass that was better simulated as compared to northern hemisphere sea ice in E3SMv1. Note that E3SM does not use virtual ice-ocean fluxes, but instead full mass and heat flux exchange consistent with a Boussinesq ocean model. Radiative coupling with the atmosphere still integrates across just two bands (visible and NIR) separated at 700nm, which does not fully exploit the five-band capability available in the delta-Eddington scheme.</p>"},{"location":"MPAS-seaice/tech-guide/#prescribed-ice-mode","title":"Prescribed Ice Mode","text":"<p>E3SM also includes a prescribed-extent ice mode for MPAS-SeaIce based the CESM implementation. This mode is needed for Atmospheric Model Intercomparison Project (AMIP) style simulations where a full prognostic sea ice model is not desired but sea ice surface fluxes, albedos, snow depth, and surface temperature are needed by the atmosphere model. These fields are calculated by the vertical thermodynamics module of the sea ice component. The prescribed-ice mode is intended for atmosphere sensitivity experiments and does not conserve energy or mass. In this mode, sea ice thermodynamics is active but sea ice dynamics are disabled, and at each time step ice area and thickness are reset to specified values. Ice area is interpolated in time and space from an input data set, while ice thickness in grid cells containing sea ice is set to 2 m in the Northern hemisphere and 1 m in the Southern hemisphere. During each area and thickness adjustment, snow volume preserves the snow thickness prognosed in the previous time step. Snow temperatures are reset to the surface temperature, as prognosed in the previous time step, while ice temperatures are set so that the ice temperature gradient is linear, with the ice temperature at the top equal to the prognosed surface temperature, and equal to the sea freezing temperature at the base of the ice. The vertical ice salinity profile is reset to the profile from Bitz &amp; Lipscomb (1999). The prescribed-ice mode implemented in MPAS-SeaIce can now replace that in CICE in such configurations, but CICE continues to be used for those requiring exceptional computational efficiency.</p>"},{"location":"MPAS-seaice/user-guide/","title":"User's Guide","text":"<p>Guidance for using E3SM is available from E3SM's public web site.</p>"},{"location":"MPAS-seaice/user-guide/#configuring-mpas-seaice","title":"Configuring MPAS-seaice","text":"<p>MPAS-seaice is controlled using namelist options.</p> <ul> <li>Default namelist values are found in <code>E3SM/components/mpas-seaice/bld/namelist_files/namelist_defaults_mpassi.xml</code>.</li> <li>Namelist options are defined in <code>E3SM/components/mpas-seaice/bld/namelist_files/namelist_definitions_mpassi.xml</code>, including type, category (<code>seaice_model</code>), group, valid values and a brief description. Each namelist variable is defined in an <code>entry</code> element.  The content of the element is the documentation of how the variable is used.  Other aspects of the variable's definition are expressed as attributes of the <code>entry</code> element.</li> <li>Users can change namelist options from defaults by entering <code>[namelist option] = [changed value]</code> as separate lines in the <code>user_nl_mpassi</code> file in the case directory.</li> <li>Some namelist values or combinations are not allowed and will generate warnings and often abort the code.  The consistency checks for using MPAS-seaice within E3SM are in <code>mpas_seaice_initialize</code> (subroutines <code>seaice_check_configs_coupled</code>, <code>seaice_check_constants_coupled</code>), and those specific to Icepack can be found in subroutine <code>check_column_package_configs</code> in <code>mpas_seaice_icepack.F</code>.</li> </ul> <p>Related namelist variables are grouped according to their application.</p> Namelist Groups Relevant application <code>seaice_model</code> general options <code>io</code> input/output <code>decomposition</code> mesh parallelization <code>restart</code> restarting the code <code>dimensions</code> column physics dimensions (layers, categories) <code>initialize</code> initialization <code>use_sections</code> turn entire parameterizations on and off <code>forcing</code> forcing for standalone configurations <code>velocity_solver</code> algorithms for solving the dynamics (velocity and stress) equations <code>advection</code> advection <code>column_package</code> general column package software configurations <code>biogeochemistry</code> biogeochemistry <code>shortwave</code> radiation <code>snow</code> advanced snow physics <code>meltponds</code> melt pond parameterization flags and parameters <code>thermodynamics</code> basic thermodynamics <code>itd</code> ice thickness distribution <code>floesize</code> floe size distribution <code>ridging</code> mechanical redistribution <code>atmosphere</code> atmospheric boundary layer and coupling <code>ocean</code> oceanic boundary layer and coupling <code>diagnostics</code> diagnostic output <code>prescribed_ice</code> for testing atmosphere simulations"},{"location":"MPAS-seaice/user-guide/#icepack","title":"Icepack","text":"<p>The Icepack software has replaced the original <code>colpkg</code> column physics code in MPAS-seaice. The <code>column_package</code> option is still available but is no longer being supported in MPAS-seaice.</p> <p>Full documentation for E3SM's version of Icepack can be found in E3SM's Icepack readthedocs.  The most up-to-date documentation from the CICE Consortium's main Icepack repository is here.</p> <p>The MPAS-seaice driver for Icepack is</p> <p><code>E3SM/components/mpas-seaice/src/shared/mpas_seaice_icepack.f</code></p> <p>and the mapping between the names of Icepack's namelist options and those in MPAS-seaice can be found in subroutine <code>init_icepack_package_configs</code> (see the argument list for calls to subroutine <code>icepack_init_parameters</code> and comments at the end of <code>init_icepack_package_configs</code>.</p>"},{"location":"MPAS-seaice/user-guide/#configuring-model-input-and-output","title":"Configuring Model Input and Output","text":"<p>The reading and writing of model fields in MPAS is handled by user-configurable streams. A stream represents a fixed set of model fields, together with dimensions and attributes, that are all written or read together to or from the same file or set of files. Besides these default streams, users may define new streams to, e.g., write certain diagnostic fields at a higher temporal frequency than the usual model history fields.</p> <p>Streams are defined in XML configuration files that are created at build time for each model core. The name of this XML file is simply \u2018streams.\u2019 suffixed with the name of the core. For example, the streams for the sea-ice core are defined in a file named \u2018streams.seaice\u2019. An XML stream file may further reference other text files that contain lists of the model fields that are read or written in each of the streams defined in the XML stream file.</p> <p>The stream file can be modified by copying the <code>streams.seaice</code> file (generated during <code>./case.setup</code>) from the run directory to the case directory under <code>SourceMods/src.mpassi/</code>, and making changes to the stream file there. Changes to the stream file will take effect on the next case submission. Alternatively, changes to the streams file can be made directly in the code in <code>components/mpas-seaice/cime_config/buildnml</code>.</p> <p>Two classes of streams exist in MPAS: immutable streams and mutable streams. Immutable streams are those for which the set of fields that belong to the stream may not be modified at model run-time; however, it is possible to modify the interval at which the stream is read or written, the filename template describing the files containing the stream on disk, and several other parameters of the stream. In contrast, all aspects of mutable streams, including the set of fields that belong to the stream, may be modified at run-time. The motivation for the creation of two stream classes is the idea that an MPAS core may not function correctly if certain fields are not read in upon model start-up or written to restart files, and it is therefore not reasonable for users to modify this set of required fields at run-time. An MPAS core developer may choose to implement such streams as immutable streams. Since fields may not be added to an immutable stream at run-time, new immutable streams may not be defined at run-time, and the only type of new stream that may be defined at run-time is the mutable stream type.</p>"},{"location":"dev-guide/","title":"Development Guide","text":"<p>Development of E3SM is carefully planned and tied to goals in the proposals that fund work on E3SM.</p>"},{"location":"dev-guide/#code-development","title":"Code development","text":"<p>Most code development occurs within one component and developers should consult the relevant component's development guide.</p> <p>More information on code development.</p> <ul> <li>Development Big Picture</li> <li>Getting Started</li> <li>Development Reference</li> </ul>"},{"location":"dev-guide/#creating-new-input","title":"Creating new input","text":"<p>E3SM's public input data directory contains initial and boundary conditions for many cases. Creating new initial or boundary conditions typically starts with creating a new grid.</p> <ul> <li>Adding Support for New Grids</li> </ul>"},{"location":"dev-guide/adding-grid-support/","title":"Adding Support for New Grids","text":"<ul> <li>Atmosphere Grid Overview                 </li> <li>Grid Description File Overview           </li> <li>Step-by-Step Guide to Support a New Grid </li> </ul>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-grid-types/","title":"Types of Grid Description Files","text":"<ul> <li> <p>Exodus file: ex. \"ne4.g\".   This is a netcdf file following Exodus conventions.  It gives the corner locations of all elements on the sphere and their connectivity.  It is independent of the polynomial order used inside the element (\"np\").  This file is used by TempestRemap (TR) to generate mapping files.  The polynomial order is a command line option and the GLL nodes are internally generated by TR.  </p> </li> <li> <p>SCRIP file:  ex. \"ne4pg2.scrip.nc\".   This file contains a description of the atmosphere physics grid in the format used by the original incremental remap tool SCRIP.  It is used for most output and also used to generate mapping files between components and for post-processing of most output.</p> </li> </ul> <p>Less common \u201cGLL\u201d metadata files needed for specialized purposes:</p> <ul> <li> <p>\"dual grid\" SCRIP file:  ex. \"ne4np4_scrip.nc\".   This file contains a SCRIP format description of the GLL grid.  It includes the locations of the GLL nodes and artificial bounding polygons around those nodes.   Ideally the spherical area of each polygon will match the GLL weight (\"exact GLL areas\"), but not all tools can achieve exact areas.  Inexact areas does not impact the accuracy of the resulting mapping algorithm, it just means that mass will not be exactly conserved by the mapping algorithm. These files are often problematic to generate, so it is advised to avoid using workflows that require this. This was previously needed in E3SMv2 configurations by the cube_to_target topography dataset generation tool, but effort has been made to eliminate this requirement. It was also historically used in E3SMv1 to create ocean/atm mapping files (exact GLL areas was important here to conserve fluxes).</p> </li> <li> <p>\"latlon\" file: ex. \"ne4np4_latlon.nc\".   This file contains a list of all the GLL nodes in the mesh (in latitude/longitude coordinates).   The list of GLL nodes must be in the the internal HOMME global id ordering, matching the ordering used in EAM GLL grid output.   It also contains the connectivity of the GLL subcell grid. This file is no longer needed for any E3SM workflow.</p> </li> <li> <p>\"pentagons\" file: ex. \"ne30np4_pentagons.nc\". These files represent a mostly outdated approach of dealing with data on the np4 grid. While the np4 grid provides a spectral element representation of data with weights on GLL nodes, the term \"dual grid\" refers to a finite volume approximation of the same data by constructing polygons around each GLL node such that the cell area matches the weight of each node. The word \"pentagons\" was used because that is the most number of sides used by the polygons. These files are increasingly difficult to generate as the global resolution becomes finer because the polygon construction is a costly iterative process. Some tools to generate these files were either the NCL code <code>HOMME2SCRIP.ncl</code> or the matlab code <code>dualgridgenerate.m</code>. These types of files are no longer needed for any E3SM workflow, although some of these files can still be found in the E3SM data repository.</p> </li> </ul>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/","title":"Adding Support for New Grids","text":"<p>The purpose of this guide is to outline all the necessary steps for running E3SM on a new grid for the atmosphere and land components. The process is similar for uniform and regionally refined grids, although regionally refined cases will likely require some special considerations which will be noted where appropriate.</p> <p>If you wish to add a new ocean and sea-ice mesh you will need to use the compass tool to generate the mesh and dynamically adjusted initial condition. This procedure is detailed in a separate tutorial: https://mpas-dev.github.io/compass/latest/tutorials/dev_add_rrm.html</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/#step-by-step-guide","title":"Step-by-Step Guide","text":"<ol> <li>Generate a new grid<ol> <li>Generate a uniform grid file                       </li> <li>Generate a RRM grid file                           </li> </ol> </li> <li>Generate mapping files                                 </li> <li>Generate domain files                                  </li> <li>Generate a topography file                             </li> <li>Generate atmospheric initial condition                 </li> <li>Generate land input data (fsurdat)                   </li> <li>Generate land initial condition (finidat)            </li> <li>Generate a dry deposition file (depends on use case) </li> <li>Add new grid configuration to E3SM                     </li> </ol>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/add-grid-config/","title":"Add New Grid Configuration to E3SM","text":"<p>Back to Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-RRM-grid-file/","title":"Generate a RRM Grid File with SQuadGen","text":"<p>There are three ways to create a regionally refined grid file for E3SM using SQuadGen, which are outlined below.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-RRM-grid-file/#using-a-png-image-file","title":"Using a PNG Image File","text":"<p>The most common is to create a grayscale <code>.png</code> image file with the correct aspect ratio that defines one or more refinement areas.</p> <p>The input PNG is a grayscale representation of a regular latitude-longitude grid (i.e. equiangular projection) with the level of shading determining the level of refinement: white for the coarse grid and black where maximum refinement is desired.  Shades of gray can be used to impose intermediate levels of refinement.  To determine the refinement region on the cubed-sphere mesh, each volume on the cubed-sphere grid is sampled from the PNG image to determine the desired level of refinement on that grid.  The transition region is then built around each refinement region using \"paving\" tiles, with optional smoothing of edges.</p> <p>Once the PNG file is created it can be used to generate the new exodus file. The example below creates a 3x refinement based on the ne30 grid that, which it typically used for production runs.</p> <pre><code>./SQuadGen --refine_file ${GRIDNAME}.png --resolution 30 --refine_level 3 --refine_type LOWCONN --smooth_type SPRING --smooth_dist 3 --smooth_iter 20 --output ${DATA_PATH}/${GRIDNAME}.g\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-RRM-grid-file/#creating-the-png-file-with-an-image-editor","title":"Creating the PNG file with an image editor","text":"<p>It is often useful to start with a background image that already has the correct aspect ratio and is centered on 0 degrees longitude. The following PNG image (with base grid ne16) can be used as a template for drawing your refinement region so that grid lines are parallel to cubed-sphere arcs. This PNG file can be set as a background image in an editor like Photoshop or GIMP.</p> <p></p> <p>The refined region is then drawn on top of this image in a separate layer.  You can set the transparency between layers at, i.e. 50% with the grayscale image in front of the template.  When you are ready to save the image, you can change the transparency to 0% and export the image as a PNG.</p> <p>If a different \"base grid\" image is desired with more or less detail, this can be generated with:</p> <pre><code>./SQuadGen --resolution &lt;ne&gt; --output base_grid.g\n</code></pre> <p>where <code>ne</code> is your desired base grid resolution.  The grid image can then be plotted with the <code>gridplot.ncl</code> script that is included with SQuadGen. Alternatively, PyNGL is a python replacement for NCL that also has good support for plotting unstructured meshes (despite being in \"maintenance mode\").</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-RRM-grid-file/#creating-the-png-file-with-a-python-script","title":"Creating the PNG file with a python script","text":"<p>The previous method of using an image editor can be somewhat cumbersome and inaccurate. Scripted generation of the refinement region is possible with python.</p> <p>In the first example below a SCRIP format grid file is used so that individual elements can be shaded, but this method was intended for the cell shading capability of PyNGL. The SCRIP file used in these examples can be generated with 3 simple TempestRemap commands:</p> <pre><code>NE=30\nGenerateCSMesh --alt --res ${NE} --file ${GRID_FILE_PATH}/ne${NE}.g\nGenerateVolumetricMesh --in ${GRID_FILE_PATH}/ne${NE}.g --out ${GRID_FILE_PATH}/ne${NE}pg2.g --np 2 --uniform\nConvertMeshToSCRIP --in ${GRID_FILE_PATH}/ne${NE}pg2.g --out ${GRID_FILE_PATH}/ne${NE}pg2_scrip.nc\n</code></pre> <p>For other plotting libraries it may be preferrable to use an equiangular SCRIP grid file, which can be generated with a simple NCO command. Here is an example of a 1 degree grid:</p> <pre><code>ncremap -G ttl=Equi-Angular grid 1x1 degree, dimensions 180x360, cell edges on Poles/Equator and Prime Meridian/Date Line#latlon=180,360#lat_typ=uni#lon_typ=grn_wst -g /Users/zender/data/grids/cmip6_180x360_scrip.nc\n</code></pre> <p>Below is some example python code to generate a \"feathered\" refined region around a given central point. The resulting numpy array can then be plotted with your preferred plotting library (ex. matplotlib, pyngl)</p> generate_RRM_png_feathered.py <pre><code>import os, ngl, numpy as np, xarray as xr\ntarget_lat, target_lon = 39.7392, 360-104.9903 # Denver, CO\n#-------------------------------------------------------------------------------\nscrip_ds = xr.open_dataset(os.getenv('HOME')+'/E3SM/data_grid/ne30pg2_scrip.nc')\nncol = len(scrip_ds['grid_area'])\ndeg_to_rad,rad_to_deg = np.pi/180., 180./np.pi\n#-------------------------------------------------------------------------------\n# method for calculating the length of great circle arcs\ndef calc_great_circle_distance(lat1,lat2,lon1,lon2):\n  ''' input should be in degrees '''\n  dlon = lon2 - lon1\n  cos_dist = np.sin(lat1*deg_to_rad)*np.sin(lat2*deg_to_rad) + \\\n             np.cos(lat1*deg_to_rad)*np.cos(lat2*deg_to_rad)*np.cos(dlon*deg_to_rad)\n  # print( str(cos_dist.min()) +\"   \"+ str(cos_dist.max()) )\n  cos_dist = np.where(cos_dist&gt; 1.0, 1.0,cos_dist)\n  cos_dist = np.where(cos_dist&lt;-1.0,-1.0,cos_dist)\n  dist = np.arccos( cos_dist )\n  return dist\n#-------------------------------------------------------------------------------\n# method for defining a feathered refinement region\ndef define_refinement( ncol, dmin, dmax,\n                      target_lat, target_lon,\n                      center_lat, center_lon,\n                      refine_level):\n  # loop through all points and calculate distance to center\n  # NOTE - distance units are in radians (max value = pi)\n  for n in range(ncol):\n    d = calc_great_circle_distance(target_lat, center_lat[n] ,target_lon, center_lon[n])\n    if d&lt;=dmin:            refine_level[n] = 1\n    if d&gt;dmin and d&lt;=dmax: refine_level[n] = ( dmax - d ) / ( dmax - dmin )\n    if d&gt;dmax:             refine_level[n] = 0\n  return refine_level\n#-------------------------------------------------------------------------------\n# define refinement regions - distance thesholds in radians\nmin_threshold =  1*deg_to_rad\nmax_threshold = 10*deg_to_rad\nrefine_level = np.zeros(ncol)\n# define continuous refinement based on distance\ndefine_refinement( ncol, min_threshold, max_threshold,\n                 target_lat, target_lon,\n                 scrip_ds['grid_center_lat'].values,\n                 scrip_ds['grid_center_lon'].values,\n                 refine_level )\n#-------------------------------------------------------------------------------\n# create PNG image using PyNGL\nwkres = ngl.Resources()\nnpix = 4096; wkres.wkWidth,wkres.wkHeight=npix,npix\nwkres.wkForegroundColor = [1.,1.,1.]\nwkres.wkBackgroundColor = [1.,1.,1.]\nwks = ngl.open_wks('png',fig_file,wkres)\n# Create custom colormap\nnum_clr = 50\nfill_clr = np.zeros((num_clr,3))\nfor n in range(num_clr): fill_clr[n,:] = float(n) / float(num_clr)\n# define plot resources\nres = ngl.Resources()\nres.nglDraw               = False\nres.nglFrame              = False\nres.tmXTOn                = False\nres.tmXBOn                = False\nres.tmYLOn                = False\nres.tmYROn                = False\nres.cnFillOn              = True\nres.cnLinesOn             = False\nres.cnLineLabelsOn        = False\nres.cnInfoLabelOn         = False\nres.mpGridAndLimbOn       = False\nres.mpPerimOn             = False\nres.mpOutlineBoundarySets = 'NoBoundaries'\nres.lbLabelBarOn          = False\nres.cnFillPalette         = fill_clr\nres.tfPolyDrawOrder = 'PreDraw'\nres.sfXArray      = scrip_ds['grid_center_lon'].values\nres.sfYArray      = scrip_ds['grid_center_lat'].values\n#-------------------------------------------------------------------------------\n# Use Raster fill mode instead of cell fill\nres.cnFillMode          = 'RasterFill'\nplot = ngl.contour_map(wks,refine_level,res)\n#-------------------------------------------------------------------------------\n# use pre-draw polygon to fill in white areas near poles\n#-------------------------------------------------------------------------------\ngsres             = ngl.Resources()\ngsres.gsFillColor = 'black'\ngsres.gsEdgesOn   = False\npy = [ -89.9,  89.9, 89.9,-89.9, -89.9]\npx = [ 360. , 360. ,  0. ,  0. , 360. ]\nngl.polygon(wks, plot, px, py, gsres)\n#-------------------------------------------------------------------------------\nngl.draw(plot)\nngl.frame(wks)\nngl.end()\n#-------------------------------------------------------------------------------\n# crop white space from png file\nif os.path.isfile(f'{fig_file}.png') :\n  cmd = f'convert -trim +repage {fig_file}.png {fig_file}.png'\n  os.system(cmd)\n  os.system(cmd) # second call helps remove gray lines at edge\n  # if npix = 4096:\nelse:\n  raise FileNotFoundError(f'\\n{fig_file}.png does not exist?!\\n')\n#-------------------------------------------------------------------------------\n# apply gaussian blur\nfrom PIL import Image, ImageFilter\nimage = Image.open(f'{fig_file}.png')\nfor n in range(nsmooth): image = image.filter(ImageFilter.GaussianBlur(radius=6))\nimage = image.save(f'{fig_file}.png')\n#-------------------------------------------------------------------------------\nprint(); print(f'  {fig_file}.png'); print()\n#-------------------------------------------------------------------------------\n</code></pre> <p>The next example creates a refinement region based on land fraction.</p> generate_RRM_png_landfrac.py <pre><code>import os, ngl, numpy as np, xarray as xr\nrefine_level = 1\nnsmooth      = 4\nland_data_file = 'inputdata/atm/cam/topo/USGS-gtopo30_0.9x1.25_remap_c051027.nc'\nds = xr.open_dataset(land_data_file)\nlat = ds['lat']\nlon = ds['lon']\nlandfrac = ds['LANDFRAC']\nnlat,nlon = len(lat),len(lon)\n#-------------------------------------------------------------------------------\n# switch to center data on prime meridian\nlon_tmp = np.zeros(nlon)\nlon_tmp[:int(nlon/2)] = lon[-int(nlon/2):].values - 360.\nlon_tmp[int(nlon/2):] = lon[ :int(nlon/2)].values\nlon = xr.DataArray(lon_tmp,dims={'lon':lon})\nlandfrac_tmp = np.zeros(landfrac.shape)\nlandfrac_tmp[:,:int(nlon/2)] = landfrac[:,-int(nlon/2):].values\nlandfrac_tmp[:,int(nlon/2):] = landfrac[:, :int(nlon/2)].values\nlandfrac = xr.DataArray(landfrac_tmp,dims={'lat':lat,'lon':lon})\n#-------------------------------------------------------------------------------\n# mask out anarctica\nfor j in range(nlat):\n  if lat[j]&lt;-60: landfrac[j,:] = 0.0\n#-------------------------------------------------------------------------------\n# Apply 2D smoothing to feather edges at coastlines\nif nsmooth&gt;0:\n  for s in range(nsmooth):\n    tmp = np.copy(landfrac)\n    for j in range(1,nlat-2):\n      for i in range(nlon):\n        im1 = nlon-1 if i==0      else i-1\n        ip1 = 0      if i==nlon-1 else i+1\n        smooth_y  = ( 0.25*tmp[j-1,i  ] + 0.5*tmp[j,i] + 0.25*tmp[j+1,i  ] )\n        smooth_x  = ( 0.25*tmp[j  ,im1] + 0.5*tmp[j,i] + 0.25*tmp[j  ,ip1] )\n        smooth_d1 = ( 0.25*tmp[j-1,im1] + 0.5*tmp[j,i] + 0.25*tmp[j+1,ip1] )\n        smooth_d2 = ( 0.25*tmp[j-1,ip1] + 0.5*tmp[j,i] + 0.25*tmp[j+1,im1] )\n        landfrac[j,i] = ( smooth_y + smooth_x + smooth_d1 + smooth_d2 ) / 4.\n  for j in range(nlat):\n    for i in range(nlon):\n      if landfrac[j,i]&lt;0.8: landfrac[j,i] = 0.0\n#-------------------------------------------------------------------------------\n# Generate image of refined region using MPL\nfig = plt.figure(figsize=(36/4,18/4))\nax = fig.add_subplot(1,1,1)\ncs = ax.contourf(lon, lat, landfrac, levels=[0.0,0.5,1.0],colors=['#000000','#FFFFFF','#FFFFFF'])\nax.xaxis.set_major_locator(plt.NullLocator())\nax.yaxis.set_major_locator(plt.NullLocator())\nfig.tight_layout()\nplt.axis('off')\nplt.savefig(refine_png_file,pad_inches=0,bbox_inches='tight')\nprint(f'\\nrefine_png_file: {refine_png_file}\\n')\n#-------------------------------------------------------------------------------\n# more smoothing via gaussian blur from the pillow package\nfrom PIL import Image, ImageFilter\nimage = Image.open(f'{refine_png_file}')\nfor n in range(nsmooth): image = image.filter(ImageFilter.GaussianBlur(radius=3))\nimage = image.save(f'{refine_png_file}')\n#-------------------------------------------------------------------------------\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-RRM-grid-file/#using-a-refinement-map","title":"Using a Refinement Map","text":"<p>If <code>--loadcsrefinementmap</code> is specified the refinement map will be reloaded from a previously generated refine_map.dat file.  This option allows for manual editing of the cubed-sphere refine map.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-RRM-grid-file/#using-rectangular-patches","title":"Using Rectangular Patches","text":"<p>SQuadGen can now be used with the <code>--refine_rect</code> argument to define rectangular patches on the fly without the need for an image file. This argument takes the latitude and longitude corner locations that define the quadralateral, as well as the desirec refinement level:</p> <pre><code>--refine_rect \"&lt;lon0&gt;,&lt;lat0&gt;,&lt;lon1&gt;,&lt;lat1&gt;,&lt;refinement level&gt;\"\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-RRM-grid-file/#a-note-on-testing-rrm-quality","title":"A Note on testing RRM Quality","text":"<p>RRM \"quality\" can be measured with the \u201cMax Dinv-based element distortion\u201d metric.  This will be printed in the log file for standalone HOMME or EAM simulations and can be obtained from the log files during the topography generation process.  </p> <p>This metric measures how distorted the elements become in the mesh transition region.  It is the ratio of the two singular values of the 2x2 derivative matrix of the element map to the unit square, representing the ration of the largest length scale to the smallest length scale.  </p> <p>A grid of perfect quadrilaterals will have a value of 1.0.  The equal-angle cubed-sphere grid has a value of 1.7.   A high quality regionally refined grid will have a value less than 4.  With a high quality grid, usually one can run with the timesteps used in a uniform grid with matching fine resolution.  RRM grids with a value &gt; 4 may require smaller timesteps for stability.   Very large values indicate a problem with the grid and it should be redesigned.</p> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-atm-initial-condition/","title":"Generate Atmospheric Initial Condition","text":"<p>Warning</p> <p>This page is still under construction</p> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-dry-deposition/","title":"Generate a Dry Deposition File","text":"<p>Warning</p> <p>This page is still under construction</p> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-lnd-initial-condition/","title":"Generate Land Initial Condition (finidat)","text":"<p>Warning</p> <p>This page is still under construction</p> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-lnd-input-data/","title":"Generate Land Input Data (fsurdat)","text":"<p>Warning</p> <p>This page is still under construction</p> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-mapping-files/","title":"Generate mapping files","text":"<p>In order to pass data between different components at runtime, a set of mapping files between each component is generated offline.</p> <p>See Recommended Mapping Procedures for E3SM Atmosphere Grids for a discussion of different remap algorithms and when to use each.</p> <p>TempestRemap and ESMF are the backends that generate the mapping weights, but this is all nicely encapsulated using ncremap. Tempest is the preferred method for creating mapping files. ncremap will call TempestRemap or ESMF depending on the algorithm argument and input file types. If exodus files are provided (i.e. <code>*.g</code>) then TempestRemap commands will be used. The ESMF tools are adequate for making atmosphere-only-type component sets for E3SM, but this tool is less conservative than TempestRemap. If you are making grids for a coupled run, then TempestRemap should be used wherever possible. Currently, TempestRemap has trouble with masked grids, such those that are needed for land data generation, so ESMF is still required for certain tasks.</p> <p>Note</p> <p>This page is still under construction</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-mapping-files/#activate-the-e3sm-unified-env","title":"Activate the E3SM Unified Env","text":"<p>Perlmutter (NERSC):</p> <pre><code>source /global/common/software/e3sm/anaconda_envs/load_latest_e3sm_unified_pm-cpu.sh\n</code></pre> <p>Chrysalis (LCRC):</p> <pre><code>source /lcrc/soft/climate/e3sm-unified/load_latest_e3sm_unified_chrysalis.sh\n</code></pre> <p>For unsupported machines you may need to build the unified environment:</p> <pre><code>conda install -c conda-forge -c e3sm e3sm-unified\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-mapping-files/#specify-the-input-data-path","title":"Specify the Input Data Path","text":"<p>Perlmutter (NERSC):</p> <p>Chrysalis (LCRC):</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-mapping-files/#create-mapping-files","title":"Create Mapping Files","text":"<p>ncremap provides a convient</p> <p>We can use ncremap to generate ALL the needed mapping files between two grids, in this example the ne4 atmosphere and the oQU240 ocean grid (for the moment, we will put the land on the same grid as the atmosphere):</p> <pre><code>atm_grid_file=ne4.g\nocn_grid_file=/global/cfs/cdirs/e3sm/inputdata/cpl/gridmaps/oQU240/ocean.QU.240km.scrip.151209.nc\ncd ${output_root} &amp;&amp; ncremap -P mwf -s $ocn_grid_file -g $atm_grid_file --nm_src=oQU240 --nm_dst=ne4np4 --dt_sng=20181114\n</code></pre> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/","title":"Generate a Topography File","text":"<p>Topography needs to be interpolated from a high resolution dataset, and then doctored a bit to allow the model to run stably with the new topography. More information can be found in the following paper:  </p> <p>P.H. Lauritzen, J.T. Bacmeister, P.F. Callaghan, M. Taylor,  NCAR_Topo (v1.0): NCAR global model topography generation software for unstructured grids, Geosci. Model Dev., 8, 3975-3986, 2015.</p> <p>Typically, input topography data generation for E3SM starts with a high resolution source dataset (<code>USGS-topo-cube3000.nc</code>). This is a high-resolution topography dataset on a 3km cubed sphere grid derived from 1 km resolution source data.  This file is located in the CESM inputdata server here.</p> <p>For target resolutions of 3 km or finer it is recommended to use an even higher resolution source dataset (<code>USGS-topo-cube12000.nc</code>), which was created by Jishi Zhang in 2024. This file has a resolution of 750m created from a  500m/250m USGS GMTED2010 source DEM dataset (see here for more information).</p> <p>For testing the topography workflow the mapping between the ne3000 data is too burdensome, so a ne90pg1 (i.e. 1-degree) version of this data was created to allow efficient testing. This file can be found on various supported machines at <code>${DIN_LOC_ROOT}/atm/cam/hrtopo/USGS-topo-cube90.nc</code>.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#data-processing-requirements","title":"Data Processing Requirements","text":"<p>The workflow to generate topography data for the atmosphere model must address the following requirements:</p> <ul> <li>The dycore needs surface geopotential (<code>phi_s</code>) at GLL nodes (np4)</li> <li>The physics needs various things at FV cell centers (pg2)<ul> <li>surface geopotential (<code>phi_s</code>)</li> <li>sub-grid variance of topography (<code>SGH</code> and <code>SGH30</code>)</li> <li>Land area fraction (<code>LANDFRAC</code>)</li> </ul> </li> <li>The np4 to pg2 map of <code>phi_s</code> data must be equal to the FV <code>phi_s</code> data</li> <li>HOMME's smoothing operator must be used on <code>phi_s</code> for stability</li> </ul>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#topography-smoothing","title":"Topography Smoothing","text":"<p>Smoothing of the input surface geopotential (<code>phi_s</code>) is an essential step to ensure numerical stability of the atmospheric dynamics, but the smoothing much be done in a way that is consistent with the internal Laplacian used by the HOMME dycor. To accomplish this we use <code>homme_tool</code>, which is a standalone build of the HOMME dycor.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#building-homme_tool","title":"Building homme_tool","text":"<p>Note</p> <p>homme_tool is not routinely tested on all supported machines, and the build can be broken without anyone noticing. If you encounter problems building homme_tool please reach out on the e3sm_help slack channel and include a detailed description of the error and the commands you used to produce the error.</p> <p>Building <code>homme_tool</code> is a critical preliminary step to the topography generation workflow described below. The build process requires the user to select the appropriate cmake file that contains machine-specific settings (see <code>mach_file</code> below).</p> <pre><code># Set the machine specific environment\ncd ${e3sm_root}/components/homme\n${e3sm_root}/cime/CIME/scripts/configure &amp;&amp; source .env_mach_specific.sh\n\n# Specify machine configuration file\nmach_file=${e3sm_root}/components/homme/cmake/machineFiles/perlmutter-gnu.cmake\n# mach_file=${e3sm_root}/components/homme/cmake/machineFiles/chrysalis.cmake\n\ncmake -C ${mach_file} \\\n-DBUILD_HOMME_THETA_KOKKOS=FALSE \\\n-DBUILD_HOMME_PREQX_KOKKOS=FALSE \\\n-DHOMME_ENABLE_COMPOSE=FALSE \\\n-DHOMME_BUILD_EXECS=FALSE \\\n-DBUILD_HOMME_TOOL=TRUE \\\n-DBUILD_HOMME_WITHOUT_PIOLIBRARY=FALSE \\\n-DPREQX_PLEV=26 \\\n${e3sm_root}/components/homme\n\nmake -j4 homme_tool\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#sub-grid-topography-variations","title":"Sub-Grid Topography Variations","text":"<p>Certain physics calculations in the atmosphere require a characterization of the unresolved topography. This is provided in the input data as <code>SGH</code> and <code>SGH30</code>. These quantities need to be calculated by the <code>cube_to_target</code> tool that is included in the E3SM source  code. Similar to <code>homme_tool</code>, this tool can often be broken when the user goes to use it. Luckily, this tool is much simpler with fewer dependencies. Nevertheless, it is good to make sure the tools builds successfully before creating a new topography file.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#building-cube_to_target","title":"Building cube_to_target","text":"<p>The following commands were working on both Perlmutter/NERSC and Chrysalis/LCRC machines as of 2024.</p> <pre><code>cd ${e3sm_root}/components/eam/tools/topo_tool/cube_to_target\n\n${e3sm_root}/cime/CIME/scripts/configure &amp;&amp; source .env_mach_specific.sh\n\nmake\n</code></pre> <p>Note</p> <p>You can safely ignore compiler warnings that look like <code>Warning: Rank mismatch...</code>. These are a result of how we interface with the netcdf fortran routines, but fixing the warnings by switching from <code>#include &lt;netcdf.inc&gt;</code> to <code>use netcdf</code> can lead to other problems on certain machines.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#step-by-step-topography-generation","title":"Step-by-Step Topography Generation","text":"<p>Note</p> <p>Copying and pasting the relevant steps below is an easy way to step through the blocks of commands. Alternatively, a batch script is provided below that can be used to execute all steps at once in a batch job.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#activate-the-e3sm-unified-env","title":"Activate the E3SM Unified Env","text":"<p>Perlmutter (NERSC):</p> <pre><code>source /global/common/software/e3sm/anaconda_envs/load_latest_e3sm_unified_pm-cpu.sh\n</code></pre> <p>Chrysalis (LCRC):</p> <pre><code>source /lcrc/soft/climate/e3sm-unified/load_latest_e3sm_unified_chrysalis.sh\n</code></pre> <p>For unsupported machines you may need to build the unified environment:</p> <pre><code>conda install -c conda-forge -c e3sm e3sm-unified\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#specify-source-and-target-resolution","title":"Specify Source and Target Resolution","text":"<p>We will environement variables to specify the source and target grid resolutions based on the \"ne\" value of the cubed sphere grid (\"ne\" is the number of elements along a cube edge). A Typical use case will be mapping data from <code>ne3000pg1</code> to a chosen target resolution, in this case <code>ne30</code>:</p> <pre><code>NE_SRC=3000\nNE_DST=30\n</code></pre> <p>For testing use a special <code>ne90pg1</code> dataset:</p> <pre><code>NE_SRC=90\nNE_DST=4\n</code></pre> <p>Note</p> <p>For grids with regional refinement (RRM) there is no corresponding \"ne\" value - so a slightly modified workflow is needed. This entails modifying the grid file generation step, and then modifying topo and map file paths to accomodate the new RRM grid name.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#specify-file-paths","title":"Specify File Paths","text":"<p>First we need to set some enviroment variables that point to various \"root\" directories where we will be writing and/or reading files. It</p> <pre><code>e3sm_root=?    # path to E3SM source\ngrid_root=?    # path to write grid files\nmap_root=?     # path to write map files\ntopo_root=?    # path to write new topo files\nDIN_LOC_ROOT=? # path to E3SM inputdata\n</code></pre> <p>Example path settings:</p> <ul> <li> <p>Perlmutter (NERSC):</p> <pre><code>e3sm_root=${SCRATCH}/tmp_e3sm_src # make sure this contains an up-to-date clone of E3SM\ngrid_root=${SCRATCH}/e3sm_scratch/files_grid\nmap_root=${SCRATCH}/e3sm_scratch/files_map\ntopo_root=${SCRATCH}/e3sm_scratch/files_topo\nDIN_LOC_ROOT=/global/cfs/cdirs/e3sm/inputdata\n</code></pre> </li> <li> <p>Chrysalis (ANL/LCRC):</p> <pre><code>SCRATCH=/lcrc/group/e3sm/${USER}/scratch/chrys\ne3sm_root=${SCRATCH}/tmp_e3sm_src # make sure this contains an up-to-date clone of E3SM\ngrid_root=${SCRATCH}/files_grid\nmap_root=${SCRATCH}/files_map\ntopo_root=${SCRATCH}/files_topo\nDIN_LOC_ROOT=/lcrc/group/e3sm/data/inputdata\n</code></pre> </li> </ul> <p>Make sure the root directories exist:</p> <pre><code>mkdir -p ${grid_root} ${map_root} ${topo_root}\nls -ld ${grid_root} ${map_root} ${topo_root} ${e3sm_root} ${DIN_LOC_ROOT}\n</code></pre> <p>Now specify all the files that we will need for, including map files and temporary topo data.</p> <pre><code>timestamp=$(date +%Y%m%d)\ntopo_file_0=${DIN_LOC_ROOT}/atm/cam/hrtopo/USGS-topo-cube${NE_SRC}.nc\ntopo_file_1=${topo_root}/tmp_USGS-topo_ne${NE_DST}np4.nc\ntopo_file_2=${topo_root}/tmp_USGS-topo_ne${NE_DST}np4_smoothedx6t.nc\ntopo_file_3=${topo_root}/USGS-topo_ne${NE_DST}np4_smoothedx6t_${timestamp}.nc\n\nmap_file_src_to_np4=${map_root}/map_ne${NE_SRC}pg1_to_ne${NE_DST}np4_fv2se_flx.nc\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#create-grid-files","title":"Create Grid Files","text":"<pre><code># Grid for source high res topo\nGenerateCSMesh --alt --res ${NE_SRC}  --file ${grid_root}/exodus_ne${NE_SRC}.g\nConvertMeshToSCRIP --in ${grid_root}/exodus_ne${NE_SRC}.g  --out ${grid_root}/scrip_ne${NE_SRC}pg1.nc\n\n# Grid for target EAM grid\nGenerateCSMesh --alt --res ${NE_DST} --file ${grid_root}/exodus_ne${NE_DST}.g\nGenerateVolumetricMesh --in ${grid_root}/exodus_ne${NE_DST}.g --out ${grid_root}/exodus_ne${NE_DST}pg2.g --np 2 --uniform\nConvertMeshToSCRIP --in ${grid_root}/exodus_ne${NE_DST}pg2.g --out ${grid_root}/scrip_ne${NE_DST}pg2.nc\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#create-map-files","title":"Create Map Files","text":"<p>Warning</p> <p>This step can potentially take a very long time - several hours for each map file in some cases! The use of <code>--mpi_nbr=32</code> will leverage parallelization via <code>mbtemptest</code> to dramatically reduce the time to generate mapping files, but this may not work on all machines. Feel free to experiment with a different number of tasks to optimize for the machine you are using. You can also drop this argument entirely if it is causing problems, but be sure to plan for hours of execution time.</p> <p>Note</p> <p>If you see an error from these <code>ncremap</code> commands that looks like: <code>srun: error: Job request does not match any supported policy.</code> and you are on a login node then you will need to either launch an interactive compute node or use a batch job script.</p> <pre><code># Create map from source to target np4 \nncremap ${MAP_ARGS} -a fv2se_flx \\\n--src_grd=${grid_root}/scrip_ne${NE_SRC}pg1.nc  \\\n--dst_grd=${grid_root}/exodus_ne${NE_DST}.g \\\n--map_file=${map_file_src_to_np4} \\\n--tmp_dir=${map_root}\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#remap-topograpy","title":"Remap Topograpy","text":"<p>The first command here will essentially create a copy of the source data, which is needed later on when calculating SGH.</p> <pre><code># Map high-res topo to target np4 grid\nncremap -m ${map_file_src_to_np4} -i ${topo_file_0} -o ${topo_file_1}\n\n# Compute phi_s on the target np4 grid\nncap2 -O -s 'PHIS=terr*9.80616' ${topo_file_1} ${topo_file_1}\n\n# rename the column dimension to be \"ncol\"\nncrename -d grid_size,ncol ${topo_file_1}\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#apply-smoothing","title":"Apply Smoothing","text":"<p>Make sure <code>homme_tool</code> has been built following the instructions above.</p> <pre><code>cd ${e3sm_root}/components/homme\n${e3sm_root}/cime/CIME/scripts/configure &amp;&amp; source .env_mach_specific.sh\n\ncat &lt;&lt;EOF &gt; input.nl\n&amp;ctl_nl\nmesh_file = \"${grid_root}/exodus_ne${NE_DST}.g\"\nsmooth_phis_p2filt = 0\nsmooth_phis_numcycle = 6 ! v2/v3 uses 12/6 for more/less smoothing\nsmooth_phis_nudt = 4e-16\nhypervis_scaling = 2\nse_ftype = 2 ! actually output NPHYS; overloaded use of ftype\n/\n&amp;vert_nl\n/\n&amp;analysis_nl\ntool = 'topo_pgn_to_smoothed'\ninfilenames = '${topo_file_1}', '${topo_file_2}'\n/\nEOF\n\nmpirun -np 8 ${e3sm_root}/components/homme/src/tool/homme_tool &lt; input.nl\n\n# rename output file to remove \"1.nc\" suffix\nmv ${topo_file_2}1.nc ${topo_file_2}\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#compute-sgh","title":"Compute SGH","text":"<pre><code>${e3sm_root}/components/eam/tools/topo_tool/cube_to_target/cube_to_target \\\n  --target-grid ${grid_root}/scrip_ne${NE_DST}pg2.nc \\\n  --input-topography ${topo_file_0} \\\n  --smoothed-topography ${topo_file_2} \\\n  --output-topography ${topo_file_3}\n\n# Append the GLL phi_s data to the output of step 4.\nncks -A ${topo_file_2} ${topo_file_3}\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#clean-up-temporary-files","title":"Clean up Temporary Files","text":"<pre><code>rm ${topo_root}/tmp_USGS-topo_ne${NE_DST}*\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-topo-file/#batch-script-to-streamline-all-steps","title":"Batch script to streamline all steps","text":"<p>Running through all the steps above can be tedious and time-consuming. The batch scripts below include all these steps as well as batch system directives. The only step that is omitted is building homme_tool, since its better to do this manually in case problems arise.</p> <p>Here is a check list of things to do before submitting this script:</p> <ul> <li>Build <code>homme_tool</code></li> <li>Build <code>cube_to_target</code></li> <li>Update batch allocation code (i.e. <code>--account</code>)</li> <li>Update batch job wallclock time (i.e. <code>--time</code>)</li> <li>Update paths at the top of the batch script</li> <li>Comment out any sections that were completed in advance (i.e. grid and map file creation)</li> </ul> <p>To submit the slurm batch job use <code>sbatch &lt;script&gt;</code></p> batch_topo_slurm_lcrc.sh <pre><code>#!/bin/bash\n#SBATCH --account=e3sm\n#SBATCH --job-name=generate_topo\n#SBATCH --output=slurm-%x-%j.out\n#SBATCH --time=24:00:00\n#SBATCH --nodes=1\n#SBATCH --mail-type=END,FAIL\n#---------------------------------------------------------------------------\n# Make sure all these lines are correct for the machine\nsource /lcrc/soft/climate/e3sm-unified/load_latest_e3sm_unified_chrysalis.sh\n# Specify source and target resolutions\nNE_SRC=3000 ; NE_DST=30\n# NE_SRC=90 ; NE_DST=30 # low-res grid combination for testing\n# Specify time stamp for creation date\ntimestamp=$(date +%Y%m%d)\n# Specify E3SM source code path - preferably a fresh clone\nSCRATCH=/lcrc/group/e3sm/${USER}/scratch/chrys\ne3sm_root=${SCRATCH}/tmp_e3sm_src\n# Specify root paths\ngrid_root=${SCRATCH}/files_grid\nmap_root=${SCRATCH}/files_map\ntopo_root=${SCRATCH}/files_topo\nDIN_LOC_ROOT=/lcrc/group/e3sm/data/inputdata\n# argument for ncremap to select TempestRemap or mbtempest backend\nMAP_ARGS=\n# MAP_ARGS+=\"--mpi_nbr=32\"\n#---------------------------------------------------------------------------\n# Stop script execution on error\nset -e\n# ANSI color codes for highlighting terminal output\nRED='\\033[0;31m' ; GRN='\\033[0;32m' CYN='\\033[0;36m' ; NC='\\033[0m'\n# start timer for entire script\nstart=`date +%s`\n#---------------------------------------------------------------------------\n# Specify topo file names - including temporary files that will be deleted\ntopo_file_0=${DIN_LOC_ROOT}/atm/cam/hrtopo/USGS-topo-cube${NE_SRC}.nc\ntopo_file_1=${topo_root}/tmp_USGS-topo_ne${NE_DST}np4.nc\ntopo_file_2=${topo_root}/tmp_USGS-topo_ne${NE_DST}np4_smoothedx6t.nc\ntopo_file_3=${topo_root}/USGS-topo_ne${NE_DST}np4_smoothedx6t_${timestamp}.nc\n# Specify map file name\nmap_file_src_to_np4=${map_root}/map_ne${NE_SRC}pg1_to_ne${NE_DST}np4_fv2se_flx.nc\n#---------------------------------------------------------------------------  \n# print some useful things\necho --------------------------------------------------------------------------------\necho --------------------------------------------------------------------------------\necho\necho   NE_SRC              = $NE_SRC\necho   NE_DST              = $NE_DST\necho\necho   e3sm_root           = $e3sm_root\necho   grid_root           = $grid_root\necho   map_root            = $map_root\necho   topo_root           = $topo_root\necho   DIN_LOC_ROOT        = $DIN_LOC_ROOT\necho\necho   topo_file_0         = $topo_file_0\necho   topo_file_1         = $topo_file_1\necho   topo_file_2         = $topo_file_2\necho   topo_file_3         = $topo_file_3\necho\necho   map_file_src_to_np4 = $map_file_src_to_np4\necho\necho --------------------------------------------------------------------------------\necho --------------------------------------------------------------------------------\n#---------------------------------------------------------------------------\n# Make sure paths exist\nmkdir -p ${grid_root} ${map_root} ${topo_root}\nif [ ! -d ${DIN_LOC_ROOT} ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${DIN_LOC_ROOT} ; fi\nif [ ! -d ${e3sm_root}    ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${e3sm_root} ; fi\nif [ ! -d ${grid_root}    ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${grid_root} ; fi\nif [ ! -d ${map_root}     ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${map_root} ; fi\nif [ ! -d ${topo_root}    ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${topo_root} ; fi\n#---------------------------------------------------------------------------\n# set to echo commands\nset -x\n#---------------------------------------------------------------------------\n# Create grid for source high res topo\nGenerateCSMesh --alt --res ${NE_SRC} --file ${grid_root}/exodus_ne${NE_SRC}.g\nConvertMeshToSCRIP --in ${grid_root}/exodus_ne${NE_SRC}.g  --out ${grid_root}/scrip_ne${NE_SRC}pg1.nc\n# Create grid for target EAM grid\nGenerateCSMesh --alt --res ${NE_DST} --file ${grid_root}/exodus_ne${NE_DST}.g\nGenerateVolumetricMesh --in ${grid_root}/exodus_ne${NE_DST}.g --out ${grid_root}/exodus_ne${NE_DST}pg2.g --np 2 --uniform\nConvertMeshToSCRIP --in ${grid_root}/exodus_ne${NE_DST}pg2.g --out ${grid_root}/scrip_ne${NE_DST}pg2.nc\n#---------------------------------------------------------------------------\n# Create map from source to target np4\ntime ncremap ${MAP_ARGS} -a fv2se_flx \\\n  --src_grd=${grid_root}/scrip_ne${NE_SRC}pg1.nc \\\n  --dst_grd=${grid_root}/exodus_ne${NE_DST}.g \\\n  --map_file=${map_file_src_to_np4} \\\n  --tmp_dir=${map_root}\n#---------------------------------------------------------------------------\n# Remap high-res topo to target np4 grid\nncremap -m ${map_file_src_to_np4} -i ${topo_file_0} -o ${topo_file_1}\n# Compute phi_s on the target np4 grid\nncap2 -O -s 'PHIS=terr*9.80616' ${topo_file_1} ${topo_file_1}\n# rename the column dimension to be \"ncol\"\nncrename -d grid_size,ncol ${topo_file_1}\n#---------------------------------------------------------------------------\n# Apply Smoothing\ncd ${e3sm_root}/components/homme\n${e3sm_root}/cime/CIME/scripts/configure &amp;&amp; source .env_mach_specific.sh\n# Create namelist file for HOMME\ncat &lt;&lt;EOF &gt; input.nl\n&amp;ctl_nl\nmesh_file = \"${grid_root}/exodus_ne${NE_DST}.g\"\nsmooth_phis_p2filt = 0\nsmooth_phis_numcycle = 6 ! v2/v3 uses 12/6 for more/less smoothing\nsmooth_phis_nudt = 4e-16\nhypervis_scaling = 2\nse_ftype = 2 ! actually output NPHYS; overloaded use of ftype\n/\n&amp;vert_nl\n/\n&amp;analysis_nl\ntool = 'topo_pgn_to_smoothed'\ninfilenames = '${topo_file_1}', '${topo_file_2}'\n/\nEOF\n# run homme_tool for topography smoothing\nsrun -n 8 ${e3sm_root}/components/homme/src/tool/homme_tool &lt; input.nl\n# rename output file to remove \"1.nc\" suffix\nmv ${topo_file_2}1.nc ${topo_file_2}\n#---------------------------------------------------------------------------\n# Compute SGH with cube_to_target\n${e3sm_root}/components/eam/tools/topo_tool/cube_to_target/cube_to_target \\\n  --target-grid ${grid_root}/scrip_ne${NE_DST}pg2.nc \\\n  --input-topography ${topo_file_0} \\\n  --smoothed-topography ${topo_file_2} \\\n  --output-topography ${topo_file_3}\n# Append the GLL phi_s data to the output\nncks -A ${topo_file_2} ${topo_file_3}\n#---------------------------------------------------------------------------\n# Clean up Temporary Files\nrm ${topo_root}/tmp_USGS-topo_ne${NE_DST}*\n#---------------------------------------------------------------------------\n# stop echoing commands\nset +x\n#---------------------------------------------------------------------------\n# Check that final topo output file was created\nif [ ! -f ${topo_file_3} ]; then\n  echo\n  echo -e ${RED} Failed to create topography file - Errors ocurred ${NC}\n  echo\nelse\n  echo\n  echo -e ${GRN} Sucessfully created new topography file  ${NC}\n  echo $topo_file_3\n  echo\nfi\n#---------------------------------------------------------------------------\n# Indicate overall run time for this script\nend=`date +%s`\nruntime_sc=$(( end - start ))\nruntime_mn=$(( runtime_sc/60 ))\nruntime_hr=$(( runtime_mn/60 ))\necho -e    ${CYN} overall runtime: ${NC} ${runtime_sc} seconds / ${runtime_mn} minutes / ${runtime_hr} hours\necho\n#---------------------------------------------------------------------------\n</code></pre> batch_topo_slurm_nersc.sh <pre><code>#!/bin/bash\n#SBATCH --account=e3sm\n#SBATCH --constraint=cpu\n#SBATCH --qos=regular\n#SBATCH --job-name=generate_topo\n#SBATCH --output=slurm-%x-%j.out\n#SBATCH --time=24:00:00\n#SBATCH --nodes=1\n#SBATCH --mail-type=END,FAIL\n#---------------------------------------------------------------------------\n# Make sure all these lines are correct for the machine\nsource /global/common/software/e3sm/anaconda_envs/load_latest_e3sm_unified_pm-cpu.sh\n# Specify source and target resolutions\nNE_SRC=3000 ; NE_DST=30\n# NE_SRC=90 ; NE_DST=30 # low-res grid combination for testing\n# Specify time stamp for creation date\ntimestamp=$(date +%Y%m%d)\n# Specify E3SM source code path - preferably a fresh clone\ne3sm_root=${SCRATCH}/tmp_e3sm_src\n# Specify root paths\ngrid_root=${SCRATCH}/files_grid\nmap_root=${SCRATCH}/files_map\ntopo_root=${SCRATCH}/files_topo\nDIN_LOC_ROOT=/global/cfs/cdirs/e3sm/inputdata\n# argument for ncremap to select TempestRemap or mbtempest backend\nMAP_ARGS=\n# MAP_ARGS+=\"--mpi_nbr=32\"\n#---------------------------------------------------------------------------\n# Stop script execution on error\nset -e\n# ANSI color codes for highlighting terminal output\nRED='\\033[0;31m' ; GRN='\\033[0;32m' CYN='\\033[0;36m' ; NC='\\033[0m'\n# start timer for entire script\nstart=`date +%s`\n#---------------------------------------------------------------------------\n# Specify topo file names - including temporary files that will be deleted\ntopo_file_0=${DIN_LOC_ROOT}/atm/cam/hrtopo/USGS-topo-cube${NE_SRC}.nc\ntopo_file_1=${topo_root}/tmp_USGS-topo_ne${NE_DST}np4.nc\ntopo_file_2=${topo_root}/tmp_USGS-topo_ne${NE_DST}np4_smoothedx6t.nc\ntopo_file_3=${topo_root}/USGS-topo_ne${NE_DST}np4_smoothedx6t_${timestamp}.nc\n# Specify map file name\nmap_file_src_to_np4=${map_root}/map_ne${NE_SRC}pg1_to_ne${NE_DST}np4_fv2se_flx.nc\n#---------------------------------------------------------------------------  \n# print some useful things\necho --------------------------------------------------------------------------------\necho --------------------------------------------------------------------------------\necho\necho   NE_SRC              = $NE_SRC\necho   NE_DST              = $NE_DST\necho\necho   e3sm_root           = $e3sm_root\necho   grid_root           = $grid_root\necho   map_root            = $map_root\necho   topo_root           = $topo_root\necho   DIN_LOC_ROOT        = $DIN_LOC_ROOT\necho\necho   topo_file_0         = $topo_file_0\necho   topo_file_1         = $topo_file_1\necho   topo_file_2         = $topo_file_2\necho   topo_file_3         = $topo_file_3\necho\necho   map_file_src_to_np4 = $map_file_src_to_np4\necho\necho --------------------------------------------------------------------------------\necho --------------------------------------------------------------------------------\n#---------------------------------------------------------------------------\n# Make sure paths exist\nmkdir -p ${grid_root} ${map_root} ${topo_root}\nif [ ! -d ${DIN_LOC_ROOT} ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${DIN_LOC_ROOT} ; fi\nif [ ! -d ${e3sm_root}    ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${e3sm_root} ; fi\nif [ ! -d ${grid_root}    ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${grid_root} ; fi\nif [ ! -d ${map_root}     ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${map_root} ; fi\nif [ ! -d ${topo_root}    ]; then echo -e ${RED}ERROR directory does not exist:${NC} ${topo_root} ; fi\n#---------------------------------------------------------------------------\n# set to echo commands\nset -x\n#---------------------------------------------------------------------------\n# Create grid for source high res topo\nGenerateCSMesh --alt --res ${NE_SRC} --file ${grid_root}/exodus_ne${NE_SRC}.g\nConvertMeshToSCRIP --in ${grid_root}/exodus_ne${NE_SRC}.g  --out ${grid_root}/scrip_ne${NE_SRC}pg1.nc\n# Create grid for target EAM grid\nGenerateCSMesh --alt --res ${NE_DST} --file ${grid_root}/exodus_ne${NE_DST}.g\nGenerateVolumetricMesh --in ${grid_root}/exodus_ne${NE_DST}.g --out ${grid_root}/exodus_ne${NE_DST}pg2.g --np 2 --uniform\nConvertMeshToSCRIP --in ${grid_root}/exodus_ne${NE_DST}pg2.g --out ${grid_root}/scrip_ne${NE_DST}pg2.nc\n#---------------------------------------------------------------------------\n# Create map from source to target np4\ntime ncremap ${MAP_ARGS} -a fv2se_flx \\\n  --src_grd=${grid_root}/scrip_ne${NE_SRC}pg1.nc \\\n  --dst_grd=${grid_root}/exodus_ne${NE_DST}.g \\\n  --map_file=${map_file_src_to_np4} \\\n  --tmp_dir=${map_root}\n#---------------------------------------------------------------------------\n# Remap high-res topo to target np4 grid\nncremap -m ${map_file_src_to_np4} -i ${topo_file_0} -o ${topo_file_1}\n# Compute phi_s on the target np4 grid\nncap2 -O -s 'PHIS=terr*9.80616' ${topo_file_1} ${topo_file_1}\n# rename the column dimension to be \"ncol\"\nncrename -d grid_size,ncol ${topo_file_1}\n#---------------------------------------------------------------------------\n# Apply Smoothing\ncd ${e3sm_root}/components/homme\n${e3sm_root}/cime/CIME/scripts/configure &amp;&amp; source .env_mach_specific.sh\n# Create namelist file for HOMME\ncat &lt;&lt;EOF &gt; input.nl\n&amp;ctl_nl\nmesh_file = \"${grid_root}/exodus_ne${NE_DST}.g\"\nsmooth_phis_p2filt = 0\nsmooth_phis_numcycle = 6 ! v2/v3 uses 12/6 for more/less smoothing\nsmooth_phis_nudt = 4e-16\nhypervis_scaling = 2\nse_ftype = 2 ! actually output NPHYS; overloaded use of ftype\n/\n&amp;vert_nl\n/\n&amp;analysis_nl\ntool = 'topo_pgn_to_smoothed'\ninfilenames = '${topo_file_1}', '${topo_file_2}'\n/\nEOF\n# run homme_tool for topography smoothing\nsrun -n 8 ${e3sm_root}/components/homme/src/tool/homme_tool &lt; input.nl\n# rename output file to remove \"1.nc\" suffix\nmv ${topo_file_2}1.nc ${topo_file_2}\n#---------------------------------------------------------------------------\n# Compute SGH with cube_to_target\n${e3sm_root}/components/eam/tools/topo_tool/cube_to_target/cube_to_target \\\n  --target-grid ${grid_root}/scrip_ne${NE_DST}pg2.nc \\\n  --input-topography ${topo_file_0} \\\n  --smoothed-topography ${topo_file_2} \\\n  --output-topography ${topo_file_3}\n# Append the GLL phi_s data to the output\nncks -A ${topo_file_2} ${topo_file_3}\n#---------------------------------------------------------------------------\n# Clean up Temporary Files\nrm ${topo_root}/tmp_USGS-topo_ne${NE_DST}*\n#---------------------------------------------------------------------------\n# stop echoing commands\nset +x\n#---------------------------------------------------------------------------\n# Check that final topo output file was created\nif [ ! -f ${topo_file_3} ]; then\n  echo\n  echo -e ${RED} Failed to create topography file - Errors ocurred ${NC}\n  echo\nelse\n  echo\n  echo -e ${GRN} Sucessfully created new topography file  ${NC}\n  echo $topo_file_3\n  echo\nfi\n#---------------------------------------------------------------------------\n# Indicate overall run time for this script\nend=`date +%s`\nruntime_sc=$(( end - start ))\nruntime_mn=$(( runtime_sc/60 ))\nruntime_hr=$(( runtime_mn/60 ))\necho -e    ${CYN} overall runtime: ${NC} ${runtime_sc} seconds / ${runtime_mn} minutes / ${runtime_hr} hours\necho\n#---------------------------------------------------------------------------\n</code></pre> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-uniform-grid-file/","title":"Generate a new Grid File","text":"<p>In order to generate mapping files between a new atmosphere grid and the surface component grids, we need a file that describes the new grid. TempestRemap is our preferred tool for grid file generation because it can handle the spectral element grids used by the atmosphere dycore. The initial grid file will be saved in an \"exodus\" file with a <code>.g</code> extension (see Types of Grid Description Files for more info). TempestRemap can be installed via conda.</p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-uniform-grid-file/#generating-a-standard-exodus-grid-file","title":"Generating a Standard Exodus Grid File","text":"<p>Once TempestRemap is in our environment we can easily generate an exodus file by calling TempestRemap directly:</p> <pre><code>GenerateCSMesh --alt --res 4 --file ne4.g\n</code></pre>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-uniform-grid-file/#generating-a-regionally-refined-grid-file","title":"Generating a Regionally Refined Grid File","text":"<p>For a regionally refined mesh (RRM) SQuadGen is used to define the refined area(s). This tutorial includes details and examples of using SQuadGen to generate RRM grid files.</p> <p>The naming convention for RRM grid files should follow:</p> <pre><code>&lt;refined_area_name&gt;_&lt;base_resolution&gt;x&lt;refinement_level&gt;.g\n</code></pre> <p>For example, for a RRM with 4x refinement from ne30 to ne120 over CONUS, we should use the convention conus_ne30x4.g (note that existing meshes may have used the old naming convention <code>&lt;area of refinement&gt;x&lt;refinement level&gt;v&lt;version&gt;.g</code>, but future meshes should use the new naming convention).</p> <p>The Exodus file contains only information about the position of the spectral element on the sphere. For SE aware utilities such as TempestRemap, they can use the polynomial order and the reference element map to fill in necessary data such as the locations of the nodal GLL points. For non-SE aware utilities, we need additional meta data, described in the next section.  </p>"},{"location":"dev-guide/adding-grid-support/adding-grid-support-step-by-step-guide/generate-uniform-grid-file/#generating-a-pg2-scrip-grid-file","title":"Generating a \"pg2\" SCRIP Grid File","text":"<p>Starting in E3SMv2 the physics calculations and standard history output use a finite volume (FV) \"pg2\" grid. Online mapping within the component coupler between the atmosphere and surface components requires FV-to-FV type maps, and generating these maps will require a grid file for pg2 grid. These are easily generated with TempestRemap commands as follows:</p> <pre><code>NE=30\nGenerateCSMesh --alt --res ${NE} --file ${GRID_FILE_PATH}/ne${NE}.g\nGenerateVolumetricMesh --in ${GRID_FILE_PATH}/ne${NE}.g --out ${GRID_FILE_PATH}/ne${NE}pg2.g --np 2 --uniform\nConvertMeshToSCRIP --in ${GRID_FILE_PATH}/ne${NE}pg2.g --out ${GRID_FILE_PATH}/ne${NE}pg2_scrip.nc\n</code></pre> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"generate_domain_files/","title":"Generating Domain Files","text":"<p>Domain files are needed at runtime by the coupler, data models, and land model. The land model uses the mask to determine where to run and the coupler use the land fraction to merge fluxes from multiple surface types to the atmosphere above them.</p> <p>Domain files are created from a conservative, monotone mapping file from the ocean grid (where the mask is defined) to the atmosphere grid.</p>"},{"location":"generate_domain_files/#environment","title":"Environment","text":"<p>The new domain generation tool requires a few special packages, such as xarray, numba, and itertools. These are all included in the E3SM unified environment: https://e3sm.org/resources/tools/other-tools/e3sm-unified-environment/</p> <p>Alternatively, a simple conda environment can be created with the following command:</p> <pre><code>conda create --name example_env --channel conda-forge xarray numpy numba scikit-learn netcdf4\n</code></pre>"},{"location":"generate_domain_files/#map-file-generation","title":"Map File Generation","text":"<p>The map file used to generate the domain files can be created a few different ways. For a typical E3SM configuration we recommend using a conservative, monotone map. Here is an example command that can be used to generate one (as of NCO version 5.2.2)</p> <pre><code>ncremap -5 -a traave --src_grd=${OCN_GRID} --dst_grd=${ATM_GRID} --map_file=${MAP_FILE}\n</code></pre> <p>Note that existing ocean grid files can be found in the inputdata repository: <code>inputdata/ocn/mpas-o/&lt;ocn_grid_name&gt;/</code></p> <p>The atmosphere grid file should be on the \"pg2\" grid. These grid files are easily generated with three TempestRemap commands as follows:</p> <pre><code>NE=30\nGenerateCSMesh --alt --res ${NE} --file ${GRID_FILE_PATH}/ne${NE}.g\nGenerateVolumetricMesh --in ${GRID_FILE_PATH}/ne${NE}.g --out ${GRID_FILE_PATH}/ne${NE}pg2.g --np 2 --uniform\nConvertMeshToSCRIP --in ${GRID_FILE_PATH}/ne${NE}pg2.g --out ${GRID_FILE_PATH}/ne${NE}pg2_scrip.nc\n</code></pre> <p>For RRM grids the last two commands would be used on the exodus file produced by SQuadGen (See the Adding Support for New Grids tutorial for more information.).</p>"},{"location":"generate_domain_files/#running-the-domain-generation-tool","title":"Running the Domain Generation Tool","text":"<p>Below is a typical example of how to invoke the domain generation tool from the command line:</p> <pre><code>NE=30\nMAP_FILE=${MAP_FILE_ROOT}/map_oEC60to30v3_to_ne${NE}pg2_traave.20240313.nc\npython generate_domain_files_E3SM.py -m ${MAP_FILE} -o oEC60to30v3 -l ne${NE}pg2 --date-stamp=9999 --output-root=${OUTPUT_ROOT}\n</code></pre> <p>Back to step-by-step guide for Adding Support for New Grids</p>"},{"location":"user-guide/","title":"User Guide","text":"<p>E3SM is not just one climate model but a modeling system that allows many different configurations of atmosphere, ocean, land and other components with both full model and data model options. Also, the configurations of model components can run at different resolutions.  Some configurations can run easily on a laptop.  Other's require the most powerful supercomputers.</p> <p>Using the model requires first deciding what configuration to use and creating a case with that configuration. The configuration options are managed by the Case Control System (CCS) within the Community Infrastructure for Modeling the Earth (CIME).</p> <p>Before reading the rest of this guide, you should become familiar with cases, compsets and grids by reading the Case Control System Basic Usage</p> <p>A step-by-step guide for running E3SM with a run script is available.</p>"},{"location":"user-guide/#supported-coupled-compsets","title":"Supported Coupled Compsets","text":"<p>A fully coupled compset is one which has active components for at least the atmosphere, ocean, land surface, ocean and sea-ice all interacting.  Each compset is associated with a specific forcing condition. Coupled compsets in E3SM are developed  for three science-driven simulation campaigns:  <code>water cycle change and impacts</code>, <code>human-earth system feedbacks</code>, and <code>polar processes, sea-level rise and coastal impacts</code>. The standard coupled configurations -- which consist of prognostic atmosphere, land, river, ocean and sea-ice components -- form the base physical coupled system and are mainly designed for <code>water cycle change and impacts</code> simulation campaign. Below list the standard configuration compsets supported in the current version of E3SM:</p> Compset alias Description <code>WCYCL1850</code> Standard configuration with pre-industrial climatological forcings <code>WCYCL1850-4xCO2</code> Same as <code>WCYCL1850</code> except with abrupt (then persistent) 4xCO2 forcing. <code>WCYCL1850-1pctCO2</code> Same as <code>WCYCL1850</code> except with 1 percent per year increase of CO2 concentration <code>WCYCL1950</code> Standard configuration with perpetual 1950 forcings <code>WCYCL20TR</code> Standard configuration with prescribed transient forcings over the historical period (1850-2014) <code>WCYCLSSP245</code> Standard configuration with prescribed SSP-245 forcings <code>WCYCLSSP370</code> Standard configuration with prescribed SSP-370 forcings <code>WCYCLSSP585</code> Standard configuration with prescribed SSP-585 forcings <p>The compsets for the other two science simulation campaigns are being finalized, with additional components and/or features. The compset naming follows the same convention, e.g., <code>CRYO1850</code> and <code>CRYO1850-4xCO2</code> are with prognostic ice-shelf melt fluxes for the <code>polar processes</code> simulation campaign.</p> <p>Compsets are also available for standalone component model configurations, See the User Guides for the components for more information.</p>"},{"location":"user-guide/#supported-resolution","title":"Supported resolution","text":"<p>Currently two grid sets are supported for the above compsets, including a nominal low-resosluton confiuguration and one regionally refined mesh. Additional regionally refined meshes and a high-resolution grid will become available in the near future.</p> Grid Alias Description ne30pg2_r05_IcoswISC30E3r5 For this grid set, the atmosphere is on the ne30pg2 cubed-sphere mesh with approximately 100km resolution, the land and river are on a 0.5deg x 0.5deg structured grid, and the ocean and sea ice are on a hexagonal mesh dervied from the dual of a 30km resolution icosahedral mesh with ice shelf cavities (wISC) around Antarctica. northamericax4v1pg2_r025_IcoswISC30E3r5 The atmosphere for this grid set uses North America regionally refined mesh from about 110 km down to 25 km over the refined region. The land and river are on 0.25deg x 0.25deg structured grid. The ocean and sea ice are on the same icosahedral mesh as for <code>ne30pg2_r05_IcoswISC30E3r5</code>."},{"location":"user-guide/#input-data","title":"Input data","text":"<p>Inputdata for coupled compsets at component model levels are the same as for the standalone component configurations for a given forcing scenario (e.g., <code>1850</code> for the pre-industrial period,  <code>20TR</code> for the historical period, <code>2010</code> for present-day condition, and <code>SSPs</code> for Shared Socioeconomic Pathways of climate change scenarios). Between the coupled compsets, the differences are in the prescribed solar forcing, volcanic emissions, atmospheric forcing data, and land use and land cover. The required inputdata for the pre-industrial and the historical periods as well as the present-day condition are described in the EAM User's Guide and the ELM's User's Guide. Below are the prescribed forcing data for the SSP scenarios.</p>"},{"location":"user-guide/#ssp245-forcing-data","title":"SSP245 forcing data","text":""},{"location":"user-guide/#ssp370-forcing-data","title":"SSP370 forcing data","text":""},{"location":"user-guide/#ssp585-forcing-data","title":"SSP585 forcing data","text":""},{"location":"user-guide/ssp245-forcings/","title":"SSP245 Forcing data","text":"<p>These are the prescribed inputdata specifically for the SSP245 scenario, in place of the files for the historical period.</p>"},{"location":"user-guide/ssp245-forcings/#solar-constant","title":"Solar constant","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/solar/Solar_1850-2299_input4MIPS_c20181106.nc</code></p>"},{"location":"user-guide/ssp245-forcings/#greenhouse-gas-concentrations","title":"Greenhouse gas concentrations","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/ggas/GHG_CMIP_SSP245-1-2-1_Annual_Global_2015-2500_c20200807.nc</code></p>"},{"location":"user-guide/ssp245-forcings/#elevated-external-forcings","title":"Elevated external forcings","text":"<pre><code>NO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_NO2_aircraft_vertical_2015-2100_1.9x2.5_c20240219.nc \nSO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_so2_volc_elev_2015-2100_c240331.nc \nSOAG0       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_SOAG0_elev_2015-2100_1.9x2.5_c20240219.nc \nbc_a4       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_bc_a4_elev_2015-2100_c200716.nc \nnum_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_num_a1_elev_2015-2100_c200716.nc \nnum_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_num_a2_elev_2015-2100_c200716.nc \nnum_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_num_a4_elev_2015-2100_c200716.nc \npom_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_pom_a4_elev_2015-2100_c200716.nc \nso4_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_so4_a1_elev_2015-2100_c200716.nc \nso4_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_so4_a2_elev_2015-2100_c200716.nc \n</code></pre>"},{"location":"user-guide/ssp245-forcings/#surface-emissions","title":"Surface emissions","text":"<pre><code>C2H4        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_C2H4_surface_2015-2100_1.9x2.5_c20240219.nc \nC2H6        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_C2H6_surface_2015-2100_1.9x2.5_c20240219.nc \nC3H8        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_C3H8_surface_2015-2100_1.9x2.5_c20240219.nc \nCH2O        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_CH2O_surface_2015-2100_1.9x2.5_c20240219.nc \nCH3CHO      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_CH3CHO_surface_2015-2100_1.9x2.5_c20240219.nc \nCH3COCH3    \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_CH3COCH3_surface_2015-2100_1.9x2.5_c20240219.nc \nCO          \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_CO_surface_2015-2100_1.9x2.5_c20240219.nc \nISOP        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240219.nc \nISOP_VBS    \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240219.nc \nC10H16      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_MTERP_surface_2015-2100_1.9x2.5_c20240219.nc \nNOX         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_NO_surface_2015-2100_1.9x2.5_c20240219.nc \nDMS         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DMSflux.1850-2100.1deg_latlon_conserv.POPmonthlyClimFromACES4BGC_c20160727.nc\nSO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_so2_surf_2015-2100_c200716.nc \nSOAG0       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/emissions-cmip6_ssp245_e3sm_SOAG0_surf_2015-2100_1.9x2.5_c20240219.nc \nbc_a4       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_bc_a4_surf_2015-2100_c200716.nc \nnum_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_num_a1_surf_2015-2100_c200716.nc \nnum_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_num_a2_surf_2015-2100_c200716.nc \nnum_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_num_a4_surf_2015-2100_c200716.nc \npom_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_pom_a4_surf_2015-2100_c200716.nc \nso4_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_so4_a1_surf_2015-2100_c200716.nc \nso4_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP245_ne30/cmip6_ssp245_mam4_so4_a2_surf_2015-2100_c200716.nc \nE90         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/emissions_E90_surface_1750-2101_1.9x2.5_c20231222.nc \n</code></pre>"},{"location":"user-guide/ssp245-forcings/#prescribed-oxidant-for-aerosol-chemistry","title":"Prescribed oxidant for aerosol chemistry","text":"<p><code>$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/oxid/oxid_SSP245_1.9x2.5_L70_1849-2101_c20240228.nc</code></p>"},{"location":"user-guide/ssp245-forcings/#stratospheric-ozone-linoz-and-chlorine-loading-data","title":"Stratospheric ozone (linoz) and chlorine loading data","text":"<pre><code>\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/Linoz_Chlorine_Loading_CMIP6_Hist_SSP245_0003-2503_c20200808.nc\n\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/linv3_1849-2101_CMIP6_Hist_SSP245_10deg_58km_c20230705.nc\n</code></pre>"},{"location":"user-guide/ssp245-forcings/#land-use-and-land-cover","title":"Land use and land cover","text":"<p><code>\\$DIN_LOC_ROOT/lnd/clm2/surfdata_map/landuse.timeseries_0.5x0.5_ssp2_rcp45_simyr2015-2100_c240408.nc</code></p>"},{"location":"user-guide/ssp370-forcings/","title":"SSP370 Forcing data","text":"<p>These are the prescribed inputdata specifically for the SSP370 scenario, in place of the files for the historical period.</p>"},{"location":"user-guide/ssp370-forcings/#solar-constant","title":"Solar constant","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/solar/Solar_1850-2299_input4MIPS_c20181106.nc</code></p>"},{"location":"user-guide/ssp370-forcings/#greenhouse-gas-concentrations","title":"Greenhouse gas concentrations","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/ggas/GHG_CMIP_SSP370-1-2-1_Annual_Global_2015-2500_c20210509.nc</code></p>"},{"location":"user-guide/ssp370-forcings/#elevated-external-forcings","title":"Elevated external forcings","text":"<pre><code>NO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_NO2_aircraft_vertical_2015-2100_1.9x2.5_c20240208.nc \nSO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so2_volc_elev_2015-2100_c240331.nc \nSOAG0       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_SOAG0_elev_2015-2100_1.9x2.5_c20240208.nc \nbc_a4       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_bc_a4_elev_2015-2100_c210216.nc \nnum_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a1_elev_2015-2100_c210216.nc \nnum_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a2_elev_2015-2100_c210216.nc \nnum_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a4_elev_2015-2100_c210216.nc \npom_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_pom_a4_elev_2015-2100_c210216.nc \nso4_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a1_elev_2015-2100_c210216.nc \nso4_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a2_elev_2015-2100_c210216.nc \n</code></pre>"},{"location":"user-guide/ssp370-forcings/#surface-emissions","title":"Surface emissions","text":"<pre><code>C2H4        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_C2H4_surface_2015-2100_1.9x2.5_c20240208.nc \nC2H6        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_C2H6_surface_2015-2100_1.9x2.5_c20240208.nc \nC3H8        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_C3H8_surface_2015-2100_1.9x2.5_c20240208.nc \nCH2O        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CH2O_surface_2015-2100_1.9x2.5_c20240208.nc \nCH3CHO      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CH3CHO_surface_2015-2100_1.9x2.5_c20240208.nc \nCH3COCH3    \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CH3COCH3_surface_2015-2100_1.9x2.5_c20240208.nc \nCO          \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_CO_surface_2015-2100_1.9x2.5_c20240208.nc \nISOP        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240208.nc \nISOP_VBS    \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240208.nc \nC10H16      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_MTERP_surface_2015-2100_1.9x2.5_c20240208.nc \nNOX         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_NO_surface_2015-2100_1.9x2.5_c20240208.nc \nDMS         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DMSflux.1850-2100.1deg_latlon_conserv.POPmonthlyClimFromACES4BGC_c20160727.nc\nSO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so2_surf_2015-2100_c210216.nc \nSOAG0       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/emissions-cmip6_ssp370_e3sm_SOAG0_surf_2015-2100_1.9x2.5_c20240208.nc \nbc_a4       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_bc_a4_surf_2015-2100_c210216.nc \nnum_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a1_surf_2015-2100_c210216.nc \nnum_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a2_surf_2015-2100_c210216.nc \nnum_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_num_a4_surf_2015-2100_c210216.nc \npom_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_pom_a4_surf_2015-2100_c210216.nc \nso4_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a1_surf_2015-2100_c210216.nc \nso4_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP370_ne30/cmip6_ssp370_mam4_so4_a2_surf_2015-2100_c210216.nc \nE90         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/emissions_E90_surface_1750-2101_1.9x2.5_c20231222.nc \n</code></pre>"},{"location":"user-guide/ssp370-forcings/#prescribed-oxidant-for-aerosol-chemistry","title":"Prescribed oxidant for aerosol chemistry","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/oxid/oxid_SSP370_1.9x2.5_L70_1849-2101_c20240228.nc</code></p>"},{"location":"user-guide/ssp370-forcings/#stratospheric-ozone-linoz-and-chlorine-loading-data","title":"Stratospheric ozone (linoz) and chlorine loading data","text":"<pre><code>\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/Linoz_Chlorine_Loading_CMIP6_Hist_SSP370_0003-2503_c20210202.nc\n\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/linv3_1849-2101_CMIP6_Hist_SSP370_10deg_58km_c20230705.nc\n</code></pre>"},{"location":"user-guide/ssp370-forcings/#land-use-and-land-cover","title":"Land use and land cover","text":"<p><code>\\$DIN_LOC_ROOT/lnd/clm2/surfdata_map/landuse.timeseries_0.5x0.5_ssp3_rcp70_simyr2015-2100_c240308.nc</code></p>"},{"location":"user-guide/ssp585-forcings/","title":"SSP585 Forcing data","text":"<p>These are the prescribed inputdata specifically for the SSP585 scenario, in place of the files for the historical period.</p>"},{"location":"user-guide/ssp585-forcings/#solar-constant","title":"Solar constant","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/solar/Solar_1850-2299_input4MIPS_c20181106.nc</code></p>"},{"location":"user-guide/ssp585-forcings/#greenhouse-gas-concentrations","title":"Greenhouse gas concentrations","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/ggas/GHG_CMIP_SSP585-1-2-1_Annual_Global_2015-2500_c20190310.nc</code></p>"},{"location":"user-guide/ssp585-forcings/#elevated-external-forcings","title":"Elevated external forcings","text":"<pre><code>NO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_NO2_aircraft_vertical_2015-2100_1.9x2.5_c20240304.nc \nSO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_so2_volc_elev_2015-2100_c240331.nc \nSOAG0       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_SOAG0_elev_2015-2100_1.9x2.5_c20240304.nc \nbc_a4       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_bc_a4_elev_2015-2100_c190828.nc \nnum_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_num_a1_elev_2015-2100_c190828.nc \nnum_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_num_a2_elev_2015-2100_c190828.nc \nnum_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_num_a4_elev_2015-2100_c190828.nc \npom_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_pom_a4_elev_2015-2100_c190828.nc \nso4_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_so4_a1_elev_2015-2100_c190828.nc \nso4_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_so4_a2_elev_2015-2100_c190828.nc \n</code></pre>"},{"location":"user-guide/ssp585-forcings/#surface-emissions","title":"Surface emissions","text":"<pre><code>C2H4        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_C2H4_surface_2015-2100_1.9x2.5_c20240304.nc \nC2H6        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_C2H6_surface_2015-2100_1.9x2.5_c20240304.nc \nC3H8        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_C3H8_surface_2015-2100_1.9x2.5_c20240304.nc \nCH2O        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_CH2O_surface_2015-2100_1.9x2.5_c20240304.nc \nCH3CHO      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_CH3CHO_surface_2015-2100_1.9x2.5_c20240304.nc \nCH3COCH3    \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_CH3COCH3_surface_2015-2100_1.9x2.5_c20240304.nc \nCO          \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_CO_surface_2015-2100_1.9x2.5_c20240304.nc \nISOP        \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240304.nc \nISOP_VBS    \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_ISOP_surface_2015-2100_1.9x2.5_c20240304.nc \nC10H16      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_MTERP_surface_2015-2100_1.9x2.5_c20240304.nc \nNOX         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_NO_surface_2015-2100_1.9x2.5_c20240304.nc \nDMS         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/DMSflux.1850-2100.1deg_latlon_conserv.POPmonthlyClimFromACES4BGC_c20160727.nc\nSO2         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_so2_surf_2015-2100_c190828.nc \nSOAG0       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/emissions-cmip6_ssp585_e3sm_SOAG0_surf_2015-2100_1.9x2.5_c20240304.nc \nbc_a4       \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_bc_a4_surf_2015-2100_c190828.nc \nnum_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_num_a1_surf_2015-2100_c190828.nc \nnum_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_num_a2_surf_2015-2100_c190828.nc \nnum_a3      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_num_a4_surf_2015-2100_c190828.nc \npom_a4      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_pom_a4_surf_2015-2100_c190828.nc \nso4_a1      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_so4_a1_surf_2015-2100_c190828.nc \nso4_a2      \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/emis/CMIP6_SSP585_ne30/cmip6_ssp585_mam4_so4_a2_surf_2015-2100_c190828.nc \nE90         \\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/emissions_E90_surface_1750-2101_1.9x2.5_c20231222.nc \n</code></pre>"},{"location":"user-guide/ssp585-forcings/#prescribed-oxidant-for-aerosol-chemistry","title":"Prescribed oxidant for aerosol chemistry","text":"<p><code>\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart_aero/oxid/oxid_SSP585_1.9x2.5_L70_2014-2101_c20240228.nc</code></p>"},{"location":"user-guide/ssp585-forcings/#stratospheric-ozone-linoz-and-chlorine-loading-data","title":"Stratospheric ozone (linoz) and chlorine loading data","text":"<pre><code>\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/Linoz_Chlorine_Loading_CMIP6_Hist_SSP585_0003-2503_c20190414.nc\n\\$DIN_LOC_ROOT/atm/cam/chem/trop_mozart/ub/linv3_1849-2101_CMIP6_Hist_SSP585_10deg_58km_c20230705.nc\n</code></pre>"},{"location":"user-guide/ssp585-forcings/#land-use-and-land-cover","title":"Land use and land cover","text":"<p><code>\\$DIN_LOC_ROOT/lnd/clm2/surfdata_map/landuse.timeseries_0.5x0.5_ssp5_rcp85_simyr2015-2100_c240408.nc</code></p>"}]}