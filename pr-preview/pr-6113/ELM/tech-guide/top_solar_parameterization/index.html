
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.0">
    
    
      
        <title>Top solar parameterization - E3SM</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.45e1311d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="E3SM" class="md-header__button md-logo" aria-label="E3SM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            E3SM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Top solar parameterization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="E3SM" class="md-nav__button md-logo" aria-label="E3SM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    E3SM
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    EAM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            EAM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ELM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            ELM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MOSART
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            MOSART
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-linear-regression-model-of-lee-et-al-2011" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Linear Regression Model of Lee et al. (2011)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Top solar parameterization</h1>

<p>The TOP solar radiation parameterization in ELM accounts for the effects of sub-grid topography on solar radiation flux, including the shadow effects and multi-scattering between adjacent terrain<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<h2 id="overview">Overview</h2>
<p>The incoming solar radiation for a flat surface is composed of direct radiation (<span class="arithmatex">\(F_{dir}^{PP}\)</span>) from sun, diffuse radiation (<span class="arithmatex">\(F_{dif}^{PP}\)</span>) from sky, and coupled radiation (<span class="arithmatex">\(F_{couple}^{PP}\)</span>) that represents surface reflected radiation that is further reflected or scattered by atmospheric particles. ELM v1.0 and ELM v2.0 assume flat surfaces and accounts for <span class="arithmatex">\(F_{dir}^{PP}\)</span> and <span class="arithmatex">\(F_{dif}^{PP}\)</span>, while neglecting <span class="arithmatex">\(F_{couple}^{PP}\)</span>. The solar radiation scheme of ELM v1.0 and  ELM v2.0 uses the two-stream approximations<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>. In contrast, the incoming solar radiation parametrization of Lee et al. (2011)<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> over mountainous regions includes five components (illustrated in Fig. 1): </p>
<ol>
<li>direct flux (<span class="arithmatex">\(F_{dir}^{TOP}\)</span>) represents photons that are transmitted from the sun to the ground surface without encountering any reflection or scattering, </li>
<li>the direct-reflected flux (<span class="arithmatex">\(F_{rdir}^{TOP}\)</span>) represents photons that are not scattered photons reflected by surrounding terrain, </li>
<li>diffuse flux (<span class="arithmatex">\(F_{dif}^{TOP}\)</span>) represents photons that are scattered by atmospheric particles but are not reflected by the ground surface, </li>
<li>diffuse-reflected flux (<span class="arithmatex">\(F_{rdif}^{TOP}\)</span>) represents scattered photons reflected by surrounding terrain, and </li>
<li>coupled flux (<span class="arithmatex">\(F_{couple}^{TOP}\)</span>) represents remaining photons that are reflected multiple times or scattered by ground surface and atmospheric particles.</li>
</ol>
<figure>
<p><img alt="Image title" src="../../figures/TOP_schematic.jpg" />
  </p>
<figcaption>
  Fig 1.: A schematic diagram of the five components of incoming solar radiation over mountains adapted from Lee et al. (2011)[^3]. The components of incoming solar radiation included are (1) direct flux, (2) diffuse flux, (3) direct-reflected flux, (4) diffuse-reflected flux, and (5) coupled flux. Local solar zenith angle (θ), sky view factor (V<sub>d</sub>), and terrain configuration factor (C<sub>T</sub>) are also marked.
  </figcaption>
</figure>
<p><span class="arithmatex">\(F_{dir}^{TOP}\)</span> is different from <span class="arithmatex">\(F_{dir}^{PP}\)</span> because of the adjustment of solar illumination geometry and shadowing effects. <span class="arithmatex">\(F_{dif}^{PP}\)</span> is different from <span class="arithmatex">\(F_{dif}^{TOP}\)</span> because the sky hemisphere is occluded by adjacent terrain. Lee et al. (2011)<sup id="fnref2:3"><a class="footnote-ref" href="#fn:3">3</a></sup> used the radiation fluxes over flat surfaces (i.e., <span class="arithmatex">\(F_{dir}^{PP}\)</span> and <span class="arithmatex">\(F_{dif}^{PP}\)</span>) to calculate the radiation fluxes over mountainous terrain based on sub-grid topographic factors. The relative deviation (<span class="arithmatex">\(f_{dir}\)</span>) of direct flux between flat surfaces and mountains under the same atmospheric condition is defined as follows</p>
<div class="arithmatex">\[
\label{eqn_fdir}
f_{dir} = \frac{F_{dir}^{TOP} - F_{dir}^{PP}}{F_{dir}^{PP}}
\]</div>
<p>The relative deviation (<span class="arithmatex">\(f_{rdir}\)</span>) of direct-reflected flux over mountains to direct flux over flat surfaces is defined as follows:</p>
<div class="arithmatex">\[
\label{eqn_frdir}
f_{rdir} = \frac{F_{rdir}^{TOP}}{F_{dir}^{PP}}
\]</div>
<p>Similarly, the relative deviations (<span class="arithmatex">\(f_{dif}\)</span> and <span class="arithmatex">\(f_{rdif}\)</span>) of diffuse and diffuse-reflected fluxes are expressed as follows:</p>
<div class="arithmatex">\[
\label{eqn_fdif}
f_{dif} = \frac{F_{dif}^{TOP} - F_{dif}^{PP}}{F_{dir}^{PP}}
\]</div>
<div class="arithmatex">\[
\label{eqn_frdif}
f_{rdif} = \frac{F_{rdif}^{TOP}}{F_{dif}^{PP}}
\]</div>
<h2 id="multiple-linear-regression-model-of-lee-et-al-2011">Multiple Linear Regression Model of Lee et al. (2011)</h2>
<p>In theory, these four relative deviations (i.e., <span class="arithmatex">\(f_{dir}\)</span>, <span class="arithmatex">\(f_{rdir}\)</span>, <span class="arithmatex">\(f_{dif}\)</span> and <span class="arithmatex">\(f_{rdif}\)</span>) depend on solar illumination geometry and sub-grid topographic distribution. Based on a series of 3D Monte Carlo photon tracing simulations, Lee et al. (2011)<sup id="fnref3:3"><a class="footnote-ref" href="#fn:3">3</a></sup> built a multiple linear regression parameterization to predict these four relative deviations well. The parameterization of Lee et al. (2011)<sup id="fnref4:3"><a class="footnote-ref" href="#fn:3">3</a></sup> uses four variables that include the standard deviation of elevation (<span class="arithmatex">\(\sigma_h\)</span>) within a grid cell, grid-averaged values of cosine of the local solar incident angle (<span class="arithmatex">\(\mu\)</span>), sky view factor (<span class="arithmatex">\(\overline{V_d}\)</span>), and terrain configuration factor (<span class="arithmatex">\(\overline{C_T}\)</span>). Lee et al. (2011)<sup id="fnref5:3"><a class="footnote-ref" href="#fn:3">3</a></sup> parameterization is given as follows:</p>
<div class="arithmatex">\[\begin{bmatrix}
f_{dir} \\
f_{dif} \\
f_{rdir} \\
f_{rdif}
\end{bmatrix}
= \mathbf{A} \cdot 
\begin{bmatrix}
\overline{\mu} \\
\sigma_h \\
\overline{V_d} \\
\overline{C_T} \\
1
\end{bmatrix}
\]</div>
<p>where <span class="arithmatex">\(\mathbf{A}\)</span> represents the fitted parameter matrix, which was obtained based on the data generated by the 3D Monte Carlo simulations. The sky view factor (<span class="arithmatex">\(V_d\)</span>) represents the portion of visible sky limited by surrounding terrain<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>, while the terrain configuration factor (<span class="arithmatex">\(C_T\)</span>), the counterpart of the sky view factor, represents the portion of surrounding terrain which is visible to the ground target<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup>. For an unobstructed infinite slope with the slope of <span class="arithmatex">\(\alpha\)</span> and aspect of <span class="arithmatex">\(\beta\)</span> and a given solar illumination geometry (i.e., solar zenith angle, <span class="arithmatex">\(SZA\)</span>, and solar azimuth angle, <span class="arithmatex">\(SAA\)</span>), the cosine of the local solar incident angle (<span class="arithmatex">\(\mu\)</span>) can be calculated by</p>
<div class="arithmatex">\[
\mu = \cos(SZA) \cos(\alpha) + \sin(SZA) \sin(\alpha) \cos(SAA-\beta)
\]</div>
<p>The <span class="arithmatex">\(SZA\)</span> and <span class="arithmatex">\(SAA\)</span> are assumed to be constant within a grid cell, but <span class="arithmatex">\(\alpha\)</span> and <span class="arithmatex">\(\beta\)</span> vary within a grid cell. The grid cell average solar incident angle, , can be expressed as follows:</p>
<div class="arithmatex">\[
\begin{eqnarray}
\overline{\mu} &amp;=&amp; \overline{\cos(SZA) \cos(\alpha)} + \overline{\sin(SZA) \sin(\alpha) \cos(SAA-\beta)} \nonumber \\
&amp;=&amp; \cos(SZA)  \overline{\cos(\alpha)} + 
\sin(SZA) \cos(SAA) +
\overline{\sin(\alpha) \cos(\beta)} + \nonumber \\
&amp; &amp; \sin(SZA) \sin(SAA) +
\overline{\sin(\alpha) \sin(\beta)}
\end{eqnarray}
\]</div>
<p>where overlines represent grid-averaged values. To further improve the regression parameterization, <span class="arithmatex">\(\mu\)</span>, <span class="arithmatex">\(V_d\)</span>, and <span class="arithmatex">\(C_T\)</span> are normalized by <span class="arithmatex">\(\cos(\alpha)\)</span>. The land surface albedo is adjusted, instead of modifying incoming solar radiation, to maintain the surface energy conservation and the consistency between the surface and the first levels of atmosphere above the surface (Lee et al., 2015). Specifically, to keep the absorbed solar radiation of the ground surface unchanged, Lee et al. (2015) built the relationship between direct (<span class="arithmatex">\(\alpha_{dir}^{TOP}\)</span>) and diffuse (<span class="arithmatex">\(\alpha_{dif}^{TOP}\)</span>) albedo over mountains and those (<span class="arithmatex">\(\alpha_{dir}^{PP}\)</span> and <span class="arithmatex">\(\alpha_{dif}^PP\)</span>) over flat surfaces as follows:</p>
<div class="arithmatex">\[
\begin{eqnarray}
F_{dir}^{PP} (1 - \alpha_{dir}^{TOP}) &amp;=&amp; (F_{dir}^{TOP} + F_{rdir}^{TOP})(1 - \alpha_{dir}^{PP}) \label{eqn_fdir_pp} \\
F_{dif}^{PP} (1 - \alpha_{dif}^{TOP}) &amp;=&amp; (F_{dif}^{TOP} + F_{rdif}^{TOP})(1 - \alpha_{dif}^{PP}) \label{eqn_fdif_pp}
\end{eqnarray}
\]</div>
<p>Substituting Eqns \eqref{eqn_fdir}-\eqref{eqn_frdif} into Eqs \eqref{eqn_fdir_pp}-\eqref{eqn_fdif_pp} leads to</p>
<div class="arithmatex">\[
\begin{eqnarray}
\alpha_{dir}^{TOP} &amp;=&amp; 1 - (1 + f_{dir} + f_{rdir}) (1 - \alpha_{dir}^{PP}) \label{eqn_alb_dir_top} \\
\alpha_{dif}^{TOP} &amp;=&amp; 1 - (1 + f_{dif} + f_{rdif}) (1 - \alpha_{dif}^{PP}) \label{eqn_alb_dif_top}
\end{eqnarray}
\]</div>
<p>The parameterizations represented by Eqs. \eqref{eqn_linear_reg}, \eqref{eqn_alb_dir_top}, and \eqref{eqn_alb_dif_top} are implemented in ELM to account for the sub-grid topographic effects on solar radiation fluxes.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Dalei Hao, Gautam Bisht, Yu Gu, Wei-Liang Lee, Kuo-Nan Liou, and L Ruby Leung. A parameterization of sub-grid topographical effects on solar radiation in the e3sm land model (version 1.0): implementation and evaluation over the tibetan plateau. <em>Geoscientific Model Development</em>, 14(10):6273–6289, 2021. <a href="https://doi.org/https://doi.org/10.5194/gmd-14-6273-2021">doi:https://doi.org/10.5194/gmd-14-6273-2021</a>.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>K. Oleson, D. Lawrence, G. Bonan, B. Drewniak, M. Huang, C. Koven, Z. M. Subin, and S. C. Swenson. Technical description of version 4.5 of the community land model (clm), ncar technical note. Technical Report NCAR/TN-503+ STR, National Center for Atmospheric Research (NCAR), Boulder, CO, USA, 2013. <a href="https://doi.org/https://doi.org/10.5065/D6RR1W7M">doi:https://doi.org/10.5065/D6RR1W7M</a>.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Wei-Liang Lee, KN Liou, and Alex Hall. Parameterization of solar fluxes over mountain surfaces for application to climate models. <em>Journal of Geophysical Research: Atmospheres</em>, 2011. <a href="https://doi.org/https://doi.org/10.1029/2010JD014722">doi:https://doi.org/10.1029/2010JD014722</a>.&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:3" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:3" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:3" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Klemen Zakšek, Kristof Oštir, and Žiga Kokalj. Sky-view factor as a relief visualization technique. <em>Remote sensing</em>, 3(2):398–415, 2011. <a href="https://doi.org/https://doi.org/10.3390/rs3020398">doi:https://doi.org/10.3390/rs3020398</a>.&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>Jeff Dozier and James Frew. Rapid calculation of terrain parameters for radiation modeling from digital elevation data. <em>IEEE Transactions on geoscience and remote sensing</em>, 28(5):963–969, 1990. <a href="https://doi.org/https://doi.org/10.1109/36.58986">doi:https://doi.org/10.1109/36.58986</a>.&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indices", "navigation.instant", "navigation.sections", "navigation.top"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>