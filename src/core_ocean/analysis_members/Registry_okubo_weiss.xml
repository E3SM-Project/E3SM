<nml_record name="okubo_weiss" in_defaults="true">
	<nml_option name="config_use_okubo_weiss" type="logical" default_value=".false." units="unitless"
			description="If true, ocean analysis member okubo_weiss is called."
			possible_values=".true. or .false."
	/>
	<nml_option name="config_okubo_weiss_compute_interval" type="character" default_value="same_as_output" units="unitless"
			description="Timestamp determining how often analysis member computation should be performed."
			possible_values="'DDDD_HH:MM:SS', 'same_as_output'"
	/>
	<nml_option name="config_okubo_weiss_compute_startup" type="logical" default_value=".true." units="unitless"
			description="Logical flag determining if an analysis member computation occurs on start-up."
			possible_values=".true. or .false."
	/>
	<nml_option name="config_okubo_weiss_threshold_value" type="real" default_value="-0.2" units="s^{-2}"
			description="Threshold below which normalized OW values are counted as eddies, typically -0.2"
			possible_values="any negative real value"
	/>
	<nml_option name="config_okubo_weiss_normalization" type="real" default_value="1e-10" units="unitless"
			description="Parameter by which the OW values are normalized, typically the standard deviation of OW"
			possible_values="any positive real value"
	/>
	<nml_option name="config_okubo_weiss_lambda2_normalization" type="real" default_value="1e-10" units="unitless"
			description="Parameter by which the lambda_2 values are normalized, typically the standard deviation of lambda_2"
			possible_values="any positive real value"
	/>
	<nml_option name="config_okubo_weiss_use_lat_lon_coords" type="logical" default_value=".true." units="unitless"
			description="If true, latitude/longitude coordinates are output for eddy statistics. Otherwise x/y/z coordinates are used. Ignored if not on a sphere."
			possible_values=".true. or .false."
	/>
	<nml_option name="config_okubo_weiss_compute_connected_components" type="logical" default_value=".true." units="unitless"
			description="If true, connected components of thresholded OW values are computed."
			possible_values=".true. or .false."
	/>
</nml_record>

<packages>
	<package name="amOkuboWeiss" description="This package includes variables required for the amOkuboWeiss analysis member."/>
</packages>

<streams>
    <stream name="okuboWeissOutput"
    	type="none"
        filename_template="analysis_members/okuboWeiss.$Y-$M-$D_$h.$m.$s.nc"
        output_interval="00-00-05_00:00:00"
        filename_interval="01-00-00_00:00:00"
        packages="amOkuboWeiss"
        clobber_mode="truncate"
        runtime_format="single_file">

	<stream name="mesh"/>

        <var name="xtime"/>
        <var name="okuboWeiss"/>
	<var name="vorticity"/>
	<var name="eddyID"/>
    </stream>
</streams>

<var_struct name="okuboWeissScratch" time_levs="1">
	<var name="thresholdedOkuboWeiss" 
	     persistence="scratch"
	     type="integer" 
	     dimensions="nVertLevels nCells Time" 
	     units="none" 
	     description="Thresholded Okubo-Weiss value"
	/>
	<var name="velocityGradient"
	     persistence="scratch"
	     type="real" 
	     dimensions="R3 R3 nVertLevels nCells Time" 
	     units="s^{-1}" 
	     description="Gradient of velocity field"
	/>
	<var name="shearAndStrain" 
	     persistence="scratch"
	     type="real" 
	     dimensions="nVertLevels nCells Time" 
	     units="s^{-1}" 
	     description="Shear and strain"
	/>
	<var name="lambda1" 
	     persistence="scratch"
	     type="real" 
	     dimensions="nVertLevels nCells Time" 
	     units="s^{-2}" 
	     description="Lambda 1, first eigenvalue of 2d strain rate tensor"
	/>
	<var name="lambda2" 
	     persistence="scratch"
	     type="real" 
	     dimensions="nVertLevels nCells Time" 
	     units="s^{-2}" 
	     description="Lambda 2, second eigenvalue of 2d strain rate tensor"
	/>
	<var name="lambda2R3" 
	     persistence="scratch"
	     type="real" 
	     dimensions="nVertLevels nCells Time" 
	     units="s^{-2}" 
	     description="Lambda 2, second eigenvalue of full 3d strain rate tensor"
	/>
</var_struct>

<var_struct name="amOkuboWeiss" time_levs="1" packages="amOkuboWeiss">
	<var name="okuboWeiss" 
	     type="real" i
	     dimensions="nVertLevels nCells Time" i
	     units="s^{-2}"
	     description="The Okubo-Weiss value"
	/>
	<var name="eddyID" 
	     type="integer" 
	     dimensions="nVertLevels nCells Time" 
	     units="none" 
	     description="ID of eddy connected component"
	/>
	<var name="vorticity" 
	     type="real" 
	     dimensions="nVertLevels nCells Time" 
	     units="s^{-1}" 
	     description="Vorticity"
	/>
</var_struct>
