
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.0">
    
    
      
        <title>Testing - E3SM</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.45e1311d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-1-generate-baselines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="E3SM" class="md-header__button md-logo" aria-label="E3SM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            E3SM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="E3SM" class="md-nav__button md-logo" aria-label="E3SM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    E3SM
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    EAM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            EAM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EAM/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ELM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            ELM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MOSART
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            MOSART
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/dev-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers's Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MOSART/tech-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-generate-baselines" class="md-nav__link">
    <span class="md-ellipsis">
      Step-1: Generate Baselines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-compare-against-previously-generated-baselines" class="md-nav__link">
    <span class="md-ellipsis">
      Step-2: Compare against previously generated baselines
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Testing</h1>

<p>When a developer is ready to issue a PR to integrate their new developments into E3SM's <code>master</code> branch, they need to test their code development to ensure the new development does not introduce unexpected bugs. A land developer needs to atleast run the <code>e3sm_land_developer</code> test suite that involves following two steps: </p>
<ul>
<li><strong>Step-1</strong>: Generate the baselines using the hash on <code>master</code> that was the starting point of the 
  development branch, and</li>
<li><strong>Step-2</strong>: Switch to the development branch and re-run the test suite to compare against 
  the baselines generated in Step-1.</li>
</ul>
<p>For the purpose of these document, let's assume the developer branch is <code>bishtgautam/lnd/emi-example</code>.</p>
<h2 id="step-1-generate-baselines">Step-1: Generate Baselines</h2>
<p>Find the starting hash on <code>master</code> by switching to the developer branch and looking at the Git
graph.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;e3sm-dir&gt;

<span class="c1"># Switch to your branch</span>
git<span class="w"> </span>checkout<span class="w"> </span>bishtgautam/lnd/emi-example

<span class="c1"># Let&#39;s look at the graph</span>
git<span class="w"> </span>log<span class="w"> </span>--oneline<span class="w"> </span>--decorate<span class="w"> </span>--graph
*<span class="w"> </span>9a2cd8459<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>bishtgautam/lnd/emi-example,<span class="w"> </span>origin/bishtgautam/lnd/emi-example<span class="o">)</span><span class="w"> </span>Updates<span class="w"> </span>the<span class="w"> </span>Stub<span class="w"> </span>EM<span class="w"> </span>code
*<span class="w"> </span>d11fb8c52<span class="w"> </span>Adds<span class="w"> </span>a<span class="w"> </span>readme<span class="w"> </span>and<span class="w"> </span>makefile<span class="w"> </span><span class="k">for</span><span class="w"> </span>EMI<span class="w"> </span>Demo<span class="w"> </span>code
*<span class="w"> </span>15a0e4b8d<span class="w"> </span>Minor<span class="w"> </span>update<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>EMI<span class="w"> </span>demo<span class="w"> </span>code
*<span class="w"> </span>63e2f6dcd<span class="w"> </span>Minor<span class="w"> </span>fix<span class="w"> </span>to<span class="w"> </span>ELM<span class="w"> </span>configure<span class="w"> </span>script
*<span class="w"> </span>551fc79cc<span class="w"> </span>Updates<span class="w"> </span>ELM<span class="w"> </span>stub<span class="w"> </span>and<span class="w"> </span>demo<span class="w"> </span>code<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>CNCarbonStateType
*<span class="w"> </span>8c9d41f87<span class="w"> </span>Adds<span class="w"> </span>code<span class="w"> </span>to<span class="w"> </span>exchange<span class="w"> </span>CNCarbonStateType
*<span class="w"> </span>0000ded51<span class="w"> </span>Minor<span class="w"> </span>fix
*<span class="w"> </span>2baa4ebec<span class="w"> </span>Adds<span class="w"> </span>fixes<span class="w"> </span>to<span class="w"> </span>cmake
*<span class="w"> </span>f77ae2cea<span class="w"> </span>Rename<span class="w"> </span>few<span class="w"> </span>cmake<span class="w"> </span>files
*<span class="w"> </span>b48b66dd6<span class="w"> </span>Adds<span class="w"> </span>a<span class="w"> </span>demo<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>Stub<span class="w"> </span>EM
*<span class="w"> </span>fa94aea0d<span class="w"> </span>Fixes<span class="w"> </span>length<span class="w"> </span>of<span class="w"> </span>variable<span class="w"> </span>to<span class="w"> </span>store<span class="w"> </span>name<span class="w"> </span>of<span class="w"> </span>EMI<span class="w"> </span>data
*<span class="w"> </span>cca0e0be1<span class="w"> </span>Adds<span class="w"> </span>capability<span class="w"> </span>to<span class="w"> </span>print<span class="w"> </span>all<span class="w"> </span>EMI<span class="w"> </span>Data<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>list
*<span class="w"> </span>beb1fe9ee<span class="w"> </span>Adds<span class="w"> </span>.gitignore<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>EMI
*<span class="w"> </span>301acfe7a<span class="w"> </span>Renames<span class="w"> </span>ExternalModelInterfaceDataMod.F90
*<span class="w"> </span>f0eb5b40b<span class="w"> </span>Renames<span class="w"> </span>ExternalModelInterfaceDataDimensionMod.F90
*<span class="w"> </span><span class="m">076100882</span><span class="w"> </span>Restructures<span class="w"> </span>ELM<span class="s1">&#39;s EMI directory</span>
<span class="s1">*   cfb7fc2b2 Merge branch &#39;</span>qzhu-lbl/lnd/ch4_inundation_bugfix<span class="s1">&#39; (PR #2814)</span>
<span class="s1">|\</span>
<span class="s1">| * ec99b1cb4 (origin/qzhu-lbl/lnd/ch4_inundation_bugfix)  - fix ch4 inundatation parameter read in bug</span>
<span class="s1">* |   c59c98116 Merge branch &#39;</span>darincomeau/mpaso/enable_eddystats<span class="err">&#39;</span><span class="w"> </span><span class="o">(</span>PR<span class="w"> </span><span class="c1">#2821)</span>
<span class="p">|</span><span class="se">\ \</span>
<span class="p">|</span><span class="w"> </span>*<span class="w"> </span><span class="p">|</span><span class="w"> </span>c21bb46a4<span class="w"> </span>Turn<span class="w"> </span>on<span class="w"> </span>eddy<span class="w"> </span>stats<span class="w"> </span><span class="k">for</span><span class="w"> </span>oEC60to30v3<span class="w"> </span>and<span class="w"> </span>oEC60to30v3wLI<span class="w"> </span>ocn<span class="w"> </span>grids<span class="w"> </span>by<span class="w"> </span>default
*<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">   </span>a2dd2fce5<span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#2811 from E3SM-Project/jayeshkrishna/pio2_cime_changes</span>
</code></pre></div>
<p>The above Git graph tells us that <code>bishtgautam/lnd/emi-example</code> started with the <code>cfb7fc2b2</code> hash on the <code>master</code>. So, we will generate the baselines using <code>cfb7fc2b2</code>. Checkout <code>cfb7fc2b2</code> and update the submodels via:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>checkout<span class="w"> </span>cfb7fc2b2
Note:<span class="w"> </span>checking<span class="w"> </span>out<span class="w"> </span><span class="s1">&#39;cfb7fc2b2&#39;</span>.

You<span class="w"> </span>are<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s1">&#39;detached HEAD&#39;</span><span class="w"> </span>state.<span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>look<span class="w"> </span>around,<span class="w"> </span>make<span class="w"> </span>experimental
changes<span class="w"> </span>and<span class="w"> </span>commit<span class="w"> </span>them,<span class="w"> </span>and<span class="w"> </span>you<span class="w"> </span>can<span class="w"> </span>discard<span class="w"> </span>any<span class="w"> </span>commits<span class="w"> </span>you<span class="w"> </span>make<span class="w"> </span><span class="k">in</span><span class="w"> </span>this
state<span class="w"> </span>without<span class="w"> </span>impacting<span class="w"> </span>any<span class="w"> </span>branches<span class="w"> </span>by<span class="w"> </span>performing<span class="w"> </span>another<span class="w"> </span>checkout.

If<span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>create<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>branch<span class="w"> </span>to<span class="w"> </span>retain<span class="w"> </span>commits<span class="w"> </span>you<span class="w"> </span>create,<span class="w"> </span>you<span class="w"> </span>may
<span class="k">do</span><span class="w"> </span>so<span class="w"> </span><span class="o">(</span>now<span class="w"> </span>or<span class="w"> </span>later<span class="o">)</span><span class="w"> </span>by<span class="w"> </span>using<span class="w"> </span>-b<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>checkout<span class="w"> </span><span class="nb">command</span><span class="w"> </span>again.<span class="w"> </span>Example:

<span class="w">  </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>&lt;new-branch-name&gt;

HEAD<span class="w"> </span>is<span class="w"> </span>now<span class="w"> </span>at<span class="w"> </span>cfb7fc2b2...<span class="w"> </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">&#39;qzhu-lbl/lnd/ch4_inundation_bugfix&#39;</span><span class="w"> </span><span class="o">(</span>PR<span class="w"> </span><span class="c1">#2814)</span>

git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init
</code></pre></div>
<p>Now we will use <code>cime/scripts/create_test</code> to generate baseline for the <code>e3sm_land_developer</code>
test suite.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>cime/scripts
</code></pre></div>
<p>A few things that you need to decide at this stage include the directory location where the baselines will be saved, the name and ID for the baselines, the project allocation that you will use for running the simulation, if you would like to receive email notifications about tests, etc.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define the directory to hold the baseline </span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MY_BASELINE_DIR</span><span class="o">=</span>/global/cscratch1/sd/gbisht/e3sm_baselines

<span class="c1"># Do you want to use a name for the baseline? </span>
<span class="c1"># One choice could be the git hash that is being used to generate the baselines.</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">BASELINE_NAME</span><span class="o">=</span>cfb7fc2b2

<span class="c1"># Let&#39;s set TEST_ID to be same as BASELINE_NAME</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TEST_ID</span><span class="o">=</span><span class="si">${</span><span class="nv">BASELINE_NAME</span><span class="si">}</span>

<span class="c1"># If you are a member of E3SM, you could use &#39;e3sm&#39; project allocation</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PROJECT</span><span class="o">=</span>e3sm

<span class="c1"># Set your email</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MAIL_USER</span><span class="o">=</span>&lt;your-mail@something&gt;
</code></pre></div>
<p>Use <code>./create_test --help</code> to get a complete list of arguments. Below are some additional
useful arguments for <code>./create_test</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Other arguments</span>
<span class="c1"># -v         : Verbose option</span>
<span class="c1"># -g         : Generate the baseline</span>
<span class="c1"># -q         : If you want to use a particular job queue (e.g. &#39;debug&#39; queue on NERSC)</span>
<span class="c1"># --walltime : Specify the wall time for jobs (e.g. 30 min is max allowable for &#39;debug&#39; queue on NERSC)</span>
<span class="c1"># --mail-user: If you want to receive emails about your jobs</span>
<span class="c1"># --mail-type: When to receive emails. Options are: never, all, begin, end, fail.</span>
<span class="c1"># -j         : Number of parallel jobs</span>
</code></pre></div>
<p>Now run the <code>e3sm_land_developer</code></p>
<div class="highlight"><pre><span></span><code>./create_test<span class="w"> </span>e3sm_land_developer<span class="w">  </span><span class="se">\</span>
--baseline-root<span class="w"> </span><span class="si">${</span><span class="nv">MY_BASELINE_DIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
-b<span class="w"> </span><span class="si">${</span><span class="nv">BASELINE_NAME</span><span class="si">}</span><span class="w">                </span><span class="se">\</span>
-t<span class="w"> </span><span class="si">${</span><span class="nv">TEST_ID</span><span class="si">}</span><span class="w">                      </span><span class="se">\</span>
-q<span class="w"> </span>regular<span class="w">                         </span><span class="se">\</span>
-p<span class="w"> </span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="w">                      </span><span class="se">\</span>
--walltime<span class="w"> </span><span class="m">00</span>:30:00<span class="w">                </span><span class="se">\</span>
--mail-user<span class="w"> </span><span class="nv">$MAIL_USER</span><span class="w">             </span><span class="se">\</span>
--mail-type<span class="w"> </span>all<span class="w">                    </span><span class="se">\</span>
-g<span class="w">                                 </span><span class="se">\</span>
-v<span class="w">                                 </span><span class="se">\</span>
-j<span class="w"> </span><span class="m">4</span>
</code></pre></div>
<p>The cases would be named <code>*.G.*</code> to denote one is generating the baselines.
It will take a while to compile all the cases and submit the code.
It can take a long time (&gt;30mins) for the test suite to run. To avoid interrupting the test suite
in the middle, one can run the test suite within a <code>screen</code> command.
After the cases have been successfully compiled and submitted, you can check that 
status of test by running the <code>cs.status.${TEST_ID}</code> file that was created in the scratch directory.</p>
<h2 id="step-2-compare-against-previously-generated-baselines">Step-2: Compare against previously generated baselines</h2>
<p>Now, switch to the development branch and be sure to update submodules.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;e3sm-dir&gt;
git<span class="w"> </span>checkout<span class="w"> </span>bishtgautam/lnd/emi-example
Previous<span class="w"> </span>HEAD<span class="w"> </span>position<span class="w"> </span>was<span class="w"> </span>cfb7fc2b2...<span class="w"> </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">&#39;qzhu-lbl/lnd/ch4_inundation_bugfix&#39;</span><span class="w"> </span><span class="o">(</span>PR<span class="w"> </span><span class="c1">#2814)</span>
Switched<span class="w"> </span>to<span class="w"> </span>branch<span class="w"> </span><span class="s1">&#39;bishtgautam/lnd/emi-example&#39;</span>
Your<span class="w"> </span>branch<span class="w"> </span>is<span class="w"> </span>up-to-date<span class="w"> </span>with<span class="w"> </span><span class="s1">&#39;origin/bishtgautam/lnd/emi-example&#39;</span>.

<span class="c1"># Checkout the appropriate submodules</span>
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init
</code></pre></div>
<p>Again initialize few settings.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>cime/scripts

<span class="c1"># Let&#39;s use the settings as the last time</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MY_BASELINE_DIR</span><span class="o">=</span>/global/cscratch1/sd/gbisht/e3sm_baselines

<span class="c1"># IMPORTANT: One needs to use the same BASELINE_NAME as in Step-1 because one wants</span>
<span class="c1">#            to compare against the baselines previously generated in Step-1.</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">BASELINE_NAME</span><span class="o">=</span>cfb7fc2b2

<span class="c1"># You can use the hash at the tip of your branch as the ID</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TEST_ID</span><span class="o">=</span>9a2cd8459
</code></pre></div>
<p>Run the test suite and compare (via <code>-c</code>) against previously generated baselines.</p>
<div class="highlight"><pre><span></span><code>./create_test<span class="w"> </span>e3sm_land_developer<span class="w">  </span><span class="se">\</span>
--baseline-root<span class="w"> </span><span class="si">${</span><span class="nv">MY_BASELINE_DIR</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
-b<span class="w"> </span><span class="si">${</span><span class="nv">BASELINE_NAME</span><span class="si">}</span><span class="w">                </span><span class="se">\</span>
-t<span class="w"> </span><span class="si">${</span><span class="nv">TEST_ID</span><span class="si">}</span><span class="w">                      </span><span class="se">\</span>
-q<span class="w"> </span>debug<span class="w">                           </span><span class="se">\</span>
--walltime<span class="w"> </span><span class="m">00</span>:30:00<span class="w">                </span><span class="se">\</span>
--mail-user<span class="w"> </span><span class="nv">$MAIL_USER</span><span class="w">             </span><span class="se">\</span>
--mail-type<span class="w"> </span>all<span class="w">                    </span><span class="se">\</span>
-c<span class="w">                                 </span><span class="se">\</span>
-v<span class="w">                                 </span><span class="se">\</span>
-j<span class="w"> </span><span class="m">4</span>
</code></pre></div>
<p>The cases would be named <code>*.C.*</code> to denote one is comparing against previously generated baselines. Similar to the last time, a new <code>cs.status.${TEST_ID}</code> would be created and
you can check the status of test by running it.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indices", "navigation.instant", "navigation.sections", "navigation.top"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>